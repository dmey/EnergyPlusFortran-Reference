<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>PlantCondLoopTowers.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>PlantCondLoopTowers.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.0% of total for source files.">3717 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/PlantCondLoopTowers.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">PlantCondLoopTowers.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/condenserlooptowers.html">CondenserLoopTowers</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html#src">PlantCondLoopTowers.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~plantcondlooptowers.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileplantcondlooptowersf90EfferentGraph" width="641pt" height="890pt"
 viewBox="0.00 0.00 641.00 890.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph" class="graph" transform="scale(.281 .281) rotate(0) translate(4 3163.5013)">
<title>sourcefile~~plantcondlooptowers.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-3163.5013 2276.7336,-3163.5013 2276.7336,4 -4,4"/>
<!-- sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~plantcondlooptowers.f90</title>
<polygon fill="none" stroke="#000000" points="2272.8161,-2343.9776 2137.4863,-2343.9776 2137.4863,-2321.9667 2272.8161,-2321.9667 2272.8161,-2343.9776"/>
<text text-anchor="middle" x="2205.1512" y="-2329.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantCondLoopTowers.f90</text>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="658.8752,-493.9776 543.4891,-493.9776 543.4891,-471.9667 658.8752,-471.9667 658.8752,-493.9776"/>
<text text-anchor="middle" x="601.1821" y="-479.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-638.9722C1727.1419,-749.892 1724.957,-792.6884 1803.1578,-906.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-292.9722C1340.5723,-305.5605 1350.9297,-298.7547 1382.3269,-306.9722 1457.7179,-326.704 1493.3676,-307.2176 1548.821,-361.9722 1641.4758,-453.4592 1566.2851,-534.6745 1644.2388,-638.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602.2655,-471.7752C607.161,-427.1174 631.0749,-259.6701 721.3989,-166.9722 783.4824,-103.257 819.2914,-108.1864 906.5706,-90.9722 1035.9665,-65.4511 1092.0826,-33.5982 1202.9897,-104.9722 1283.9599,-157.0802 1227.4988,-244.4344 1310.6583,-292.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.1578,-906.9722C1825.4326,-939.5248 1847.5456,-934.4684 1866.6592,-968.9722 1941.3789,-1103.8559 1868.0028,-1171.866 1940.4719,-1307.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1940.4719,-1307.9722C1949.8268,-1325.5418 1967.4991,-1315.2426 1978.2847,-1331.9722 2115.6955,-1545.1105 1970.3576,-1658.9777 2057.9268,-1896.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2057.9268,-1896.9722C2116.2144,-2055.3857 2178.5703,-2249.2911 2198.5783,-2312.2061"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2195.255,-2313.3054 2201.6166,-2321.7778 2201.927,-2311.1875 2195.255,-2313.3054"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1359.6578,-686.9776 1261.6588,-686.9776 1261.6588,-664.9667 1359.6578,-664.9667 1359.6578,-686.9776"/>
<text text-anchor="middle" x="1310.6583" y="-672.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M795.9847,-294.9722C843.9362,-263.56 1003.0099,-290.6079 1052.825,-318.9722 1113.9514,-353.777 1089.3223,-405.1875 1145.9073,-446.9722"/>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M1145.9073,-446.9722C1216.0018,-497.7092 1184.9654,-550.3789 1238.9897,-617.9722 1251.8548,-634.0685 1269.9044,-648.643 1284.6708,-659.1558"/>
<polygon fill="#3fff00" stroke="#3fff00" points="1282.705,-662.0518 1292.9217,-664.8571 1286.6844,-656.2929 1282.705,-662.0518"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="829.3535,-1675.9776 762.616,-1675.9776 762.616,-1653.9667 829.3535,-1653.9667 829.3535,-1675.9776"/>
<text text-anchor="middle" x="795.9847" y="-1661.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M614.8129,-494.1084C634.6092,-511.2316 670.5675,-546.143 685.3989,-584.9722 757.6129,-774.0303 675.9516,-1297.7607 721.3989,-1494.9722 734.5911,-1552.2177 766.8089,-1614.1268 784.2718,-1645.0377"/>
<polygon fill="#0000ff" stroke="#0000ff" points="781.3672,-1647.0082 789.3803,-1653.9393 787.4385,-1643.524 781.3672,-1647.0082"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1866.6605,-2363.9776 1739.6552,-2363.9776 1739.6552,-2341.9667 1866.6605,-2341.9667 1866.6605,-2363.9776"/>
<text text-anchor="middle" x="1803.1578" y="-2349.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M610.1162,-471.6633C635.8123,-439.7952 713.3763,-348.126 795.9847,-294.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-1096.9722C1702.9815,-1213.2352 1687.9164,-1254.6661 1703.6565,-1383.9722 1709.9983,-1436.0702 1709.2936,-2285.1643 1739.6565,-2327.9722 1741.8778,-2331.1039 1744.5543,-2333.8434 1747.5351,-2336.2397"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1745.7518,-2339.2557 1756.0328,-2341.8153 1749.5919,-2333.4031 1745.7518,-2339.2557"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-294.9722C949.0328,-196.4944 1053.2258,-146.5683 1202.9897,-249.9722 1240.1458,-275.6264 1212.3678,-308.5031 1238.9897,-344.9722 1286.9818,-410.716 1342.1842,-388.1622 1382.3269,-458.9722 1442.0312,-564.2879 1351.1756,-628.2413 1418.3269,-728.9722 1455.5555,-784.8172 1510.9608,-749.5534 1548.821,-804.9722 1607.1864,-890.4056 1538.9152,-942.2466 1584.821,-1034.9722 1601.7547,-1069.1765 1627.0271,-1062.9069 1644.2388,-1096.9722"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-2060.9776 344.7839,-2060.9776 344.7839,-2038.9667 453.3838,-2038.9667 453.3838,-2060.9776"/>
<text text-anchor="middle" x="399.0839" y="-2046.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.2729,-2047.3104C526.8359,-2044.9288 652.8808,-2045.6175 685.3989,-2075.9722 759.1084,-2144.7778 657.0993,-2222.3007 721.3989,-2299.9722 820.3686,-2419.5236 919.0249,-2331.3267 1052.825,-2409.9722 1152.8477,-2468.7638 1148.4459,-2520.4268 1238.9897,-2592.9722 1243.6198,-2596.6818 1413.2576,-2705.8897 1418.3269,-2708.9722 1427.4262,-2714.5051 1574.8011,-2800.365 1584.821,-2803.9722 1735.7874,-2858.3198 1781.4807,-2844.3785 1940.4719,-2865.9722"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.0877,-2440.9776 930.3078,-2440.9776 930.3078,-2418.9667 1029.0877,-2418.9667 1029.0877,-2440.9776"/>
<text text-anchor="middle" x="979.6978" y="-2426.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M453.4164,-2060.9734C518.9567,-2077.2042 627.5237,-2114.1097 685.3989,-2188.9722 735.298,-2253.5173 667.0878,-2308.0928 721.3989,-2368.9722 744.5809,-2394.9577 767.248,-2373.3037 795.9847,-2392.9722"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1203.0723,-1526.9776 1088.7424,-1526.9776 1088.7424,-1504.9667 1203.0723,-1504.9667 1203.0723,-1526.9776"/>
<text text-anchor="middle" x="1145.9073" y="-1512.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M601.1821,-1932.9722C634.6457,-1907.5476 658.5918,-1922.3387 685.3989,-1889.9722 721.7317,-1846.1045 681.661,-1807.7807 721.3989,-1766.9722 769.9874,-1717.0746 807.5301,-1748.578 870.5706,-1718.9722 957.4806,-1678.1563 986.3276,-1672.2354 1052.825,-1602.9722 1074.8925,-1579.9867 1065.0545,-1562.1919 1088.825,-1540.9722 1092.7595,-1537.4598 1097.2656,-1534.3786 1101.9828,-1531.6916"/>
<polygon fill="#003fff" stroke="#003fff" points="1103.8883,-1534.6495 1111.2197,-1527.0008 1100.7187,-1528.4081 1103.8883,-1534.6495"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-1932.9722C638.191,-1904.8539 660.4431,-1910.1831 685.3989,-1870.9722 729.2039,-1802.1454 667.8255,-1752.5017 721.3989,-1690.9722 729.4893,-1681.6803 741.0875,-1675.7081 752.735,-1671.8699"/>
<polygon fill="#0000ff" stroke="#0000ff" points="753.7841,-1675.2106 762.4545,-1669.1217 751.8794,-1668.4747 753.7841,-1675.2106"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M422.3703,-2038.8984C461.2319,-2019.9047 540.9768,-1978.7143 601.1821,-1932.9722"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.7412,-2022.9776 551.623,-2022.9776 551.623,-2000.9667 650.7412,-2000.9667 650.7412,-2022.9776"/>
<text text-anchor="middle" x="601.1821" y="-2008.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003f" stroke-dasharray="5,2" d="M453.2425,-2039.7888C480.4213,-2034.6785 513.4153,-2028.4747 541.3419,-2023.2237"/>
<polygon fill="#ff003f" stroke="#ff003f" points="542.2003,-2026.6238 551.3812,-2021.3361 540.9067,-2019.7443 542.2003,-2026.6238"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1537.2997,-1414.9776 1429.8483,-1414.9776 1429.8483,-1392.9667 1537.2997,-1392.9667 1537.2997,-1414.9776"/>
<text text-anchor="middle" x="1483.574" y="-1400.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1932.9722C657.781,-1889.9701 1140.8558,-1750.4972 1202.9897,-1715.9722 1256.2827,-1686.3596 1276.6749,-1681.59 1310.6583,-1630.9722"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2101.7114,-2343.9776 2014.1421,-2343.9776 2014.1421,-2321.9667 2101.7114,-2321.9667 2101.7114,-2343.9776"/>
<text text-anchor="middle" x="2057.9268" y="-2329.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2101.7003,-2332.9722C2109.8911,-2332.9722 2118.6751,-2332.9722 2127.5367,-2332.9722"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2127.5472,-2336.4723 2137.5471,-2332.9722 2127.5471,-2329.4723 2127.5472,-2336.4723"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-2747.9776 358.7923,-2747.9776 358.7923,-2725.9667 439.3754,-2725.9667 439.3754,-2747.9776"/>
<text text-anchor="middle" x="399.0839" y="-2733.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-3112.9722C1201.2686,-3149.6186 1259.6662,-3133.5963 1483.574,-3150.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-2998.9722C634.0174,-3019.8673 648.0731,-3011.9474 685.3989,-3022.9722 816.5756,-3061.7172 843.7666,-3097.7658 979.6978,-3112.9722"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M979.6978,-2998.9722C1091.9064,-3004.1615 1576.8649,-2977.2832 1644.2388,-2960.9722"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1978.0983,-2343.9776 1902.8455,-2343.9776 1902.8455,-2321.9667 1978.0983,-2321.9667 1978.0983,-2343.9776"/>
<text text-anchor="middle" x="1940.4719" y="-2329.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M601.1821,-2998.9722C672.7506,-3043.1674 896.1138,-2989.5391 979.6978,-2998.9722"/>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M979.6978,-2998.9722C1168.2201,-3014.5568 1205.4402,-2928.0144 1382.3269,-2860.9722 1500.2263,-2816.2868 1518.5919,-2762.4562 1644.2388,-2751.9722"/>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M404.137,-2748.1326C423.2629,-2789.0204 495.5284,-2931.738 601.1821,-2998.9722"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003f" stroke-dasharray="5,2" d="M405.5997,-2725.7523C420.8914,-2698.9756 459.4117,-2628.871 480.9653,-2565.9722 550.0032,-2364.5021 588.2231,-2107.7974 598.3972,-2033.1854"/>
<polygon fill="#ff003f" stroke="#ff003f" points="601.8805,-2033.5434 599.7427,-2023.1665 594.9428,-2032.6116 601.8805,-2033.5434"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.5865,-2744.6152C572.7333,-2767.6749 1005.8028,-2826.1287 1310.6583,-2675.9722"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-1733.9776 350.2841,-1733.9776 350.2841,-1711.9667 447.8836,-1711.9667 447.8836,-1733.9776"/>
<text text-anchor="middle" x="399.0839" y="-1719.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2390.9722C1172.4912,-2406.3792 1183.6247,-2406.1169 1202.9897,-2429.9722 1229.3635,-2462.4612 1210.8412,-2486.0081 1238.9897,-2516.9722 1287.4931,-2570.327 1329.445,-2543.9535 1382.3269,-2592.9722 1404.3014,-2613.3413 1395.7227,-2630.3042 1418.3269,-2649.9722 1466.3446,-2691.7526 1500.8034,-2667.1917 1548.821,-2708.9722 1571.4252,-2728.6401 1559.4106,-2750.0948 1584.821,-2765.9722 1667.6113,-2817.7025 1711.7804,-2755.6149 1803.1578,-2789.9722"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M601.1821,-1702.9722C638.2595,-1712.8493 655.2584,-1698.2269 685.3989,-1721.9722 713.8151,-1744.3589 700.4659,-1765.4687 721.3989,-1794.9722 776.1706,-1872.1687 822.5085,-1865.429 870.5706,-1946.9722 899.0602,-1995.3083 863.229,-2032.3413 906.5706,-2067.9722 945.2203,-2099.7459 1756.5895,-2171.2687 1803.1578,-2152.9722"/>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M1803.1578,-2152.9722C1882.3993,-2115.1796 1865.4683,-1965.3438 1940.4719,-2010.9722"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1549.0691,-954.9776 1418.0789,-954.9776 1418.0789,-932.9667 1549.0691,-932.9667 1549.0691,-954.9776"/>
<text text-anchor="middle" x="1483.574" y="-940.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#bfff00" stroke-dasharray="5,2" d="M795.9847,-1169.9722C810.5467,-1171.9221 1041.9053,-1116.8013 1052.825,-1106.9722 1087.9334,-1075.3698 1055.6693,-1040.6175 1088.825,-1006.9722 1126.882,-968.3531 1153.7229,-986.6118 1202.9897,-963.9722 1252.5716,-941.1877 1256.0927,-905.2616 1310.6583,-904.9722"/>
<path fill="none" stroke="#bfff00" stroke-dasharray="5,2" d="M601.1821,-1093.9722C633.9601,-1065.5777 785.2306,-1168.5909 795.9847,-1169.9722"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M601.1821,-1093.9722C630.6311,-1068.5258 649.1954,-1084.2572 685.3989,-1069.9722 771.4406,-1036.0222 802.5557,-1037.6598 870.5706,-974.9722 892.8798,-954.4102 887.7853,-940.7967 906.5706,-916.9722 953.4017,-857.5782 1073.5952,-697.1476 1145.9073,-674.9722"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1865.8971,-1298.9776 1740.4186,-1298.9776 1740.4186,-1276.9667 1865.8971,-1276.9667 1865.8971,-1298.9776"/>
<text text-anchor="middle" x="1803.1578" y="-1284.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-1248.9722C1357.9469,-1261.6871 1608.4799,-1276.4932 1729.8863,-1283.6543"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1729.9798,-1287.1658 1740.1685,-1284.2607 1730.392,-1280.178 1729.9798,-1287.1658"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M433.7303,-1711.9237C474.531,-1700.6436 543.9905,-1686.8908 601.1821,-1702.9722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-1702.9722C764.3818,-1748.8613 595.2734,-1454.252 721.3989,-1340.9722 865.0241,-1211.9751 952.8841,-1245.7423 1145.9073,-1248.9722"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M601.1821,-1702.9722C638.084,-1713.4861 660.441,-1692.8278 685.3989,-1721.9722 762.6162,-1812.1419 662.2698,-2152.0312 721.3989,-2254.9722 748.0231,-2301.3235 887.1256,-2380.2228 949.4466,-2413.9322"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="947.947,-2417.0998 958.4116,-2418.7558 951.2637,-2410.9354 947.947,-2417.0998"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1034.8358,-1180.9776 924.5597,-1180.9776 924.5597,-1158.9667 1034.8358,-1158.9667 1034.8358,-1180.9776"/>
<text text-anchor="middle" x="979.6978" y="-1166.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffbf" stroke-dasharray="5,2" d="M795.9847,-1169.9722C834.9712,-1175.1927 879.0302,-1175.3833 914.2265,-1174.1787"/>
<polygon fill="#00ffbf" stroke="#00ffbf" points="914.5203,-1177.67 924.377,-1173.7847 914.2487,-1170.6753 914.5203,-1177.67"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1195.4562,-954.9776 1096.3585,-954.9776 1096.3585,-932.9667 1195.4562,-932.9667 1195.4562,-954.9776"/>
<text text-anchor="middle" x="1145.9073" y="-940.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00bfff" stroke-dasharray="5,2" d="M601.1821,-1093.9722C664.0705,-1038.1119 925.1844,-1157.0315 979.6978,-1092.9722"/>
<path fill="none" stroke="#00bfff" stroke-dasharray="5,2" d="M979.6978,-1092.9722C1001.8356,-1066.8952 1028.2958,-1092.8135 1052.825,-1068.9722 1086.6979,-1036.049 1056.5652,-1003.4775 1088.825,-968.9722 1091.9859,-965.5912 1095.6845,-962.642 1099.6528,-960.0748"/>
<polygon fill="#00bfff" stroke="#00bfff" points="1101.6396,-962.9743 1108.6669,-955.0454 1098.2289,-956.8614 1101.6396,-962.9743"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1052.9524,-1752.9776 906.4431,-1752.9776 906.4431,-1730.9667 1052.9524,-1730.9667 1052.9524,-1752.9776"/>
<text text-anchor="middle" x="979.6978" y="-1738.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M795.9847,-1704.9722C831.6419,-1714.2964 871.7151,-1722.6136 905.314,-1728.9892"/>
<polygon fill="#007fff" stroke="#007fff" points="905.0474,-1732.5001 915.5213,-1730.9044 906.3383,-1725.6202 905.0474,-1732.5001"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M601.1821,-1702.9722C658.2577,-1719.1464 666.886,-1668.3722 721.3989,-1644.9722 802.2477,-1610.2673 822.5582,-1601.1038 906.5706,-1574.9722 965.704,-1556.579 1034.4588,-1540.128 1083.0634,-1529.3005"/>
<polygon fill="#003fff" stroke="#003fff" points="1084.1103,-1532.6536 1093.1186,-1527.0767 1082.5987,-1525.8188 1084.1103,-1532.6536"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-1702.9722C629.0263,-1710.9054 704.2561,-1692.049 752.6624,-1678.1557"/>
<polygon fill="#0000ff" stroke="#0000ff" points="753.9332,-1681.4312 762.5579,-1675.2778 751.9783,-1674.7097 753.9332,-1681.4312"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M601.1821,-1702.9722C638.2195,-1712.9982 659.1382,-1693.996 685.3989,-1721.9722 754.7093,-1795.8103 663.9461,-1863.5745 721.3989,-1946.9722 764.8138,-2009.9926 817.4424,-1977.892 870.5706,-2032.9722 894.3109,-2057.5847 878.9666,-2080.7879 906.5706,-2100.9722 993.2962,-2164.3866 1277.867,-2161.8556 1382.3269,-2186.9722 1572.2806,-2232.6451 1615.2654,-2260.4477 1803.1578,-2313.9722"/>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M1803.1578,-2313.9722C1832.8568,-2317.8955 1866.139,-2322.4956 1892.4981,-2326.1867"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="1892.2152,-2329.6813 1902.6046,-2327.6049 1893.188,-2322.7492 1892.2152,-2329.6813"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1703.5743,-1414.9776 1584.9032,-1414.9776 1584.9032,-1392.9667 1703.5743,-1392.9667 1703.5743,-1414.9776"/>
<text text-anchor="middle" x="1644.2388" y="-1400.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1145.9073,-1248.9722C1193.422,-1254.4335 1194.6627,-1285.0115 1238.9897,-1302.9722 1301.1355,-1328.1526 1485.0134,-1369.6679 1582.2871,-1390.7713"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1581.7658,-1394.2394 1592.2798,-1392.9335 1583.2462,-1387.3978 1581.7658,-1394.2394"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1029.825,-2058.9776 929.5705,-2058.9776 929.5705,-2036.9667 1029.825,-2036.9667 1029.825,-2058.9776"/>
<text text-anchor="middle" x="979.6978" y="-2044.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M795.9847,-1704.9722C837.6891,-1715.8777 848.5063,-1729.9404 870.5706,-1766.9722 912.3297,-1837.059 873.8981,-1872.2158 906.5706,-1946.9722 920.3907,-1978.5935 945.3545,-2009.9967 962.2249,-2029.1922"/>
<polygon fill="#ff007f" stroke="#ff007f" points="959.8355,-2031.7699 969.1204,-2036.8731 965.0444,-2027.0936 959.8355,-2031.7699"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003f" stroke-dasharray="5,2" d="M408.9774,-1734.0612C425.8404,-1753.4611 460.3241,-1795.371 480.9653,-1835.9722 504.469,-1882.2037 487.104,-1904.5684 516.9653,-1946.9722 531.1827,-1967.1611 553.5196,-1983.9911 571.6175,-1995.4641"/>
<polygon fill="#ff003f" stroke="#ff003f" points="570.2706,-1998.7424 580.6297,-2000.9649 573.9175,-1992.7674 570.2706,-1998.7424"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1379.0561,-1222.9776 1242.2606,-1222.9776 1242.2606,-1200.9667 1379.0561,-1200.9667 1379.0561,-1222.9776"/>
<text text-anchor="middle" x="1310.6583" y="-1208.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.466,-1711.8818C419.5462,-1630.6276 541.3948,-1132.4571 795.9847,-1207.9722"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1201.7241,-646.9776 1090.0905,-646.9776 1090.0905,-624.9667 1201.7241,-624.9667 1201.7241,-646.9776"/>
<text text-anchor="middle" x="1145.9073" y="-632.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.6243,-1711.7594C403.4866,-1636.3509 429.3108,-1203.3868 516.9653,-1112.9722 543.6736,-1085.4229 572.4473,-1119.4005 601.1821,-1093.9722"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M601.1821,-1093.9722C630.3285,-1068.1797 655.0026,-1094.279 685.3989,-1069.9722 711.4946,-1049.1045 698.053,-1027.8763 721.3989,-1003.9722 774.8689,-949.2237 826.2888,-980.3866 870.5706,-917.9722 920.5555,-847.5191 847.5968,-790.0929 906.5706,-726.9722 952.4205,-677.898 992.5752,-718.6446 1052.825,-688.9722 1071.0091,-680.0166 1071.4074,-671.34 1088.825,-660.9722 1094.6963,-657.4772 1101.1449,-654.1851 1107.5285,-651.2085"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1109.0561,-654.3596 1116.7601,-647.0863 1106.202,-647.9678 1109.0561,-654.3596"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="669.6908,-1752.9776 532.6734,-1752.9776 532.6734,-1730.9667 669.6908,-1730.9667 669.6908,-1752.9776"/>
<text text-anchor="middle" x="601.1821" y="-1738.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.0062,-1727.5715C470.2863,-1729.6662 497.2222,-1732.1985 522.2537,-1734.5518"/>
<polygon fill="#ff0000" stroke="#ff0000" points="522.1907,-1738.0612 532.4745,-1735.5127 522.846,-1731.092 522.1907,-1738.0612"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-2426.9722C1353.6229,-2443.4753 1442.4461,-2561.6316 1483.574,-2540.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-2390.9722C1154.0703,-2395.57 1301.9125,-2423.6128 1310.6583,-2426.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1702.9722C638.1731,-1713.1683 660.2909,-1692.957 685.3989,-1721.9722 752.7834,-1799.8424 663.0694,-2099.1069 721.3989,-2183.9722 762.9889,-2244.4826 810.5911,-2212.62 870.5706,-2254.9722 889.0544,-2268.0238 886.9318,-2279.733 906.5706,-2290.9722 964.8601,-2324.331 994.9914,-2294.8289 1052.825,-2328.9722 1072.8586,-2340.7995 1069.6927,-2353.7362 1088.825,-2366.9722 1111.4578,-2382.6299 1121.9283,-2377.4659 1145.9073,-2390.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.574,-2540.9722C1581.79,-2491.6361 1534.814,-2363.2998 1644.2388,-2352.9722"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1702.9722C684.5332,-1726.4092 712.2179,-1683.0674 795.9847,-1704.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1704.9722C907.7739,-1734.2047 1245.1525,-1726.1579 1310.6583,-1630.9722"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-906.9722C1713.8623,-895.0869 1763.2715,-848.6817 1803.1578,-906.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1525.5921,-932.9055C1557.8524,-924.748 1603.609,-913.908 1644.2388,-906.9722"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="846.1377,-2174.9776 745.8318,-2174.9776 745.8318,-2152.9667 846.1377,-2152.9667 846.1377,-2174.9776"/>
<text text-anchor="middle" x="795.9847" y="-2160.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M846.3054,-2170.7242C854.699,-2172.974 863.0973,-2175.9734 870.5706,-2179.9722 890.2463,-2190.5002 888.4772,-2201.9105 906.5706,-2214.9722 965.9652,-2257.8494 988.5268,-2255.8732 1052.825,-2290.9722 1120.3319,-2327.8227 1148.8164,-2322.3791 1202.9897,-2376.9722 1225.9774,-2400.1379 1218.3421,-2415.6984 1238.9897,-2440.9722 1292.2831,-2506.2058 1320.2498,-2508.0332 1382.3269,-2564.9722 1398.7722,-2580.0562 1400.2179,-2586.9322 1418.3269,-2599.9722 1483.5491,-2646.9376 1666.2399,-2733.2659 1739.6565,-2765.9722 1767.2167,-2778.2499 1776.6735,-2775.5192 1803.1578,-2789.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.1578,-2789.9722C1868.4478,-2814.5207 1871.354,-2856.5848 1940.4719,-2865.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1940.4719,-2865.9722C1992.1992,-2872.9976 2006.925,-2877.1024 2057.9268,-2865.9722"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M1310.6583,-2200.9722C1513.6812,-2116.4199 1600.8213,-2239.1537 1803.1578,-2152.9722"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-2276.9722C1226.1337,-2285.1101 1234.2228,-2226.6646 1310.6583,-2200.9722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M979.6978,-2200.9722C1013.1709,-2208.0177 1021.4984,-2211.234 1052.825,-2224.9722 1096.2229,-2244.0041 1098.7616,-2272.1898 1145.9073,-2276.9722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1310.6583,-2200.9722C1443.593,-2156.2885 1478.804,-2115.487 1548.821,-1993.9722 1591.0765,-1920.6377 1560.2785,-1887.9729 1584.821,-1806.9722 1645.6196,-1606.3115 1757.8085,-1377.5644 1792.5931,-1308.657"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1795.9196,-1309.8359 1797.3207,-1299.3341 1789.6764,-1306.67 1795.9196,-1309.8359"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M803.6448,-2175.0632C831.832,-2215.8758 930.0244,-2358.0496 966.1901,-2410.4143"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="963.4422,-2412.5945 972.005,-2418.8338 969.202,-2408.6164 963.4422,-2412.5945"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M805.6767,-2152.9667C821.1941,-2134.8767 851.7756,-2097.2352 870.5706,-2060.9722 925.5144,-1954.9634 962.1859,-1815.3493 974.8187,-1762.9959"/>
<polygon fill="#007fff" stroke="#007fff" points="978.2415,-1763.7305 977.1474,-1753.1923 971.431,-1762.1126 978.2415,-1763.7305"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M1145.9073,-2276.9722C1298.9503,-2292.4964 1331.4317,-2330.2587 1483.574,-2352.9722"/>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M1483.574,-2352.9722C1528.9256,-2355.585 1539.7526,-2344.6675 1584.821,-2338.9722 1681.723,-2326.7265 1709.5419,-2286.1153 1803.1578,-2313.9722"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M846.3516,-2173.7494C883.3088,-2181.0128 934.6889,-2191.2963 979.6978,-2200.9722"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M979.6978,-2200.9722C1235.402,-2255.9424 1316.7423,-2098.4009 1483.574,-1896.9722"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.574,-2352.9722C1554.1979,-2363.5157 1573.1939,-2360.1501 1644.2388,-2352.9722"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1350.4465,-664.8916C1385.2436,-655.8206 1437.3088,-643.7371 1483.574,-638.9722"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1865.8415,-1277.4174C1895.131,-1276.4828 1926.5679,-1282.352 1940.4719,-1307.9722"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1940.4719,-2979.9722C2010.9533,-2961.9568 1986.8522,-2881.4829 2057.9268,-2865.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M984.978,-2441.1414C998.8113,-2469.5318 1038.539,-2545.6947 1088.825,-2594.9722 1145.2309,-2650.2469 1170.6756,-2650.3476 1238.9897,-2689.9722 1317.0126,-2735.2281 1336.0523,-2748.0051 1418.3269,-2784.9722 1446.5718,-2797.663 1910.4715,-2987.6404 1940.4719,-2979.9722"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M992.6263,-2441.2814C1019.0277,-2464.2618 1077.599,-2514.6191 1088.825,-2518.9722 1170.7402,-2550.7361 1404.5408,-2579.3494 1483.574,-2540.9722"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1185.1453,-306.9776 1106.6694,-306.9776 1106.6694,-284.9667 1185.1453,-284.9667 1185.1453,-306.9776"/>
<text text-anchor="middle" x="1145.9073" y="-292.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1185.2028,-286.5998C1219.6802,-280.3541 1270.4475,-276.0507 1310.6583,-292.9722"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M1151.4367,-307.0547C1162.6806,-330.0043 1188.3796,-384.6289 1202.9897,-432.9722 1227.2223,-513.1549 1195.8295,-546.183 1238.9897,-617.9722 1249.3313,-635.1734 1266.7362,-649.4389 1281.804,-659.5178"/>
<polygon fill="#3fff00" stroke="#3fff00" points="1280.0214,-662.5321 1290.3346,-664.9589 1283.7858,-656.6304 1280.0214,-662.5321"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1020.9722C1177.5507,-988.6766 1507.9122,-983.2275 1548.821,-963.9722 1568.4595,-954.7286 1566.465,-942.5551 1584.821,-930.9722 1608.9073,-915.7733 1616.1641,-911.7647 1644.2388,-906.9722"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M1028.2943,-1158.8413C1037.0562,-1155.367 1045.6677,-1150.8442 1052.825,-1144.9722 1077.4591,-1124.7616 1069.9215,-1108.6231 1088.825,-1082.9722 1111.0458,-1052.8196 1119.6936,-1047.7262 1145.9073,-1020.9722"/>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M1145.9073,-1020.9722C1170.9991,-995.3632 1183.584,-994.1189 1202.9897,-963.9722 1233.1814,-917.0695 1285.8354,-754.8041 1304.1545,-696.7938"/>
<polygon fill="#3fff00" stroke="#3fff00" points="1307.502,-697.8159 1307.1624,-687.2265 1300.8242,-695.7165 1307.502,-697.8159"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1145.9073,-1096.9722C1225.8687,-1086.547 1230.1005,-1024.5687 1310.6583,-1020.9722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1015.4283,-1158.9234C1027.4531,-1154.898 1040.8518,-1150.0733 1052.825,-1144.9722 1095.647,-1126.7278 1099.7514,-1102.9898 1145.9073,-1096.9722"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00bfff" stroke-dasharray="5,2" d="M997.0448,-1158.9334C1013.4798,-1147.6708 1037.8182,-1128.7852 1052.825,-1106.9722 1079.5983,-1068.0556 1064.5041,-1047.4667 1088.825,-1006.9722 1098.7989,-990.3654 1113.5501,-974.2271 1125.5583,-962.4421"/>
<polygon fill="#00bfff" stroke="#00bfff" points="1128.1566,-964.8006 1132.9756,-955.3651 1123.3243,-959.736 1128.1566,-964.8006"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M985.0396,-1181.0923C1008.7741,-1230.5006 1104.8726,-1430.5497 1136.0727,-1495.4992"/>
<polygon fill="#003fff" stroke="#003fff" points="1133.0169,-1497.2211 1140.5019,-1504.7195 1139.3266,-1494.19 1133.0169,-1497.2211"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1145.9073,-1096.9722C1164.536,-1094.5434 1293.6926,-1126.9044 1310.6583,-1134.9722"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1310.6583,-1134.9722C1340.9943,-1149.3979 1353.4739,-1141.7711 1382.3269,-1158.9722 1490.852,-1223.6707 1591.8926,-1339.7382 1629.1261,-1385.0869"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1626.4894,-1387.3921 1635.5149,-1392.9411 1631.9198,-1382.9748 1626.4894,-1387.3921"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1096.9722C1162.6588,-1094.7881 1248.3988,-1161.7617 1289.1248,-1194.4774"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1287.1096,-1197.3485 1297.091,-1200.9013 1291.5037,-1191.8995 1287.1096,-1197.3485"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M991.0415,-1158.7858C1007.8967,-1141.3599 1039.0435,-1105.8831 1052.825,-1068.9722 1084.6619,-983.7029 1035.7176,-734.8914 1088.825,-660.9722 1091.0718,-657.8448 1093.7974,-655.1037 1096.8251,-652.7021"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1098.9523,-655.4937 1105.4241,-647.1052 1095.1337,-649.6269 1098.9523,-655.4937"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-1134.9722C1340.9943,-1149.3979 1357.7721,-1136.0498 1382.3269,-1158.9722 1449.6019,-1221.7745 1473.5531,-1335.9529 1480.8148,-1382.9253"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1477.3571,-1383.4699 1482.2533,-1392.8656 1484.2849,-1382.4674 1477.3571,-1383.4699"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1382.4959,-608.9776 1238.8208,-608.9776 1238.8208,-586.9667 1382.4959,-586.9667 1382.4959,-608.9776"/>
<text text-anchor="middle" x="1310.6583" y="-594.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1334.6569,-608.9925C1367.7359,-622.948 1429.406,-644.5511 1483.574,-638.9722"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#bfff00" stroke-dasharray="5,2" d="M1363.7771,-609.0246C1370.8235,-612.482 1377.326,-617.019 1382.3269,-622.9722 1446.0549,-698.8354 1382.6944,-750.5231 1418.3269,-842.9722 1430.2412,-873.8838 1452.4572,-905.2833 1467.6244,-924.6871"/>
<polygon fill="#bfff00" stroke="#bfff00" points="1465.0593,-927.0838 1474.0348,-932.7133 1470.5289,-922.7153 1465.0593,-927.0838"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1364.7926,-609.1345C1371.5206,-612.5808 1377.6615,-617.0854 1382.3269,-622.9722 1429.6558,-682.6903 1408.7362,-888.3792 1418.3269,-963.9722 1438.8202,-1125.4975 1469.8149,-1319.4165 1480.1123,-1382.806"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1476.6743,-1383.4699 1481.7366,-1392.777 1483.5832,-1382.3444 1476.6743,-1383.4699"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1176.9336,-932.8626C1185.712,-929.0724 1195.035,-924.3977 1202.9897,-918.9722 1275.7621,-869.3377 1395.9501,-647.9968 1483.574,-638.9722"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1159.0254,-954.9885C1185.7272,-976.251 1249.0923,-1020.8787 1310.6583,-1020.9722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1310.6583,-1020.9722C1384.7872,-1021.0846 1589.5176,-970.9652 1644.2388,-1020.9722"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1155.9912,-955.1374C1175.8817,-976.9328 1219.8942,-1023.9773 1238.9897,-1034.9722 1362.8367,-1106.2808 1445.0562,-1022.708 1548.821,-1120.9722 1588.1679,-1158.2332 1626.875,-1323.3217 1639.7545,-1382.6492"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1636.399,-1383.6947 1641.9162,-1392.7396 1643.2437,-1382.2283 1636.399,-1383.6947"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1046.4121,-1752.9839C1165.8618,-1772.0098 1424.341,-1810.0498 1644.2388,-1820.9722"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1052.9863,-1746.9693C1173.6499,-1750.9268 1414.1586,-1740.1389 1548.821,-1606.9722 1602.3393,-1554.0483 1629.4354,-1465.3249 1639.5001,-1425.0268"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1642.9213,-1425.769 1641.8462,-1415.2288 1636.1137,-1424.1389 1642.9213,-1425.769"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-2352.9722C1671.7802,-2348.5785 1702.3499,-2347.6547 1729.2621,-2348.1455"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1729.299,-2351.6474 1739.3834,-2348.3985 1729.4741,-2344.6496 1729.299,-2351.6474"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M990.5734,-1753.2723C1009.2406,-1772.1742 1049.2084,-1810.5324 1088.825,-1834.9722 1209.3458,-1909.3223 1273.2854,-1868.6219 1382.3269,-1958.9722 1463.2831,-2026.0513 1540.4159,-2369.5349 1644.2388,-2352.9722"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1183.2025,-1526.9946C1190.4972,-1530.5201 1197.5583,-1535.0904 1202.9897,-1540.9722 1236.1738,-1576.907 1205.7505,-1609.0884 1238.9897,-1644.9722 1372.4299,-1789.0287 1450.7214,-1787.6616 1644.2388,-1820.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-1820.9722C1714.7825,-1824.4761 1749.7104,-1774.7979 1803.1578,-1820.9722"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M1149.0455,-1504.4725C1158.6415,-1468.8763 1187.8578,-1357.2239 1202.9897,-1262.9722 1229.3206,-1098.9667 1204.507,-1053.4592 1238.9897,-890.9722 1254.5191,-817.796 1286.5119,-734.7252 1301.9487,-696.8183"/>
<polygon fill="#3fff00" stroke="#3fff00" points="1305.2679,-697.9496 1305.8362,-687.3701 1298.7944,-695.2861 1305.2679,-697.9496"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1310.6583,-1592.9722C1387.4717,-1590.5535 1417.7089,-1632.5692 1483.574,-1592.9722"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1483.574,-1592.9722C1555.3689,-1549.8102 1610.8181,-1463.1228 1633.3116,-1423.9726"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1636.4517,-1425.5293 1638.3101,-1415.0988 1630.3527,-1422.0938 1636.4517,-1425.5293"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1151.9663,-1504.7921C1176.3872,-1459.7304 1267.803,-1291.0491 1299.6413,-1232.3009"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1302.8567,-1233.7134 1304.5443,-1223.2539 1296.7023,-1230.3781 1302.8567,-1233.7134"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1171.8566,-1527.095C1181.6494,-1531.356 1192.867,-1536.313 1202.9897,-1540.9722 1251.2632,-1563.191 1257.5433,-1594.6446 1310.6583,-1592.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-1592.9722C1400.9376,-1590.1295 1456.8046,-1472.8398 1476.0391,-1424.4854"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1479.3538,-1425.6171 1479.6806,-1415.0273 1472.8213,-1423.102 1479.3538,-1425.6171"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1588.9722C1018.3562,-1571.0515 1020.4299,-1554.6522 1052.825,-1526.9722 1131.1275,-1460.0664 1145.5308,-1432.2514 1238.9897,-1388.9722 1340.7505,-1341.8484 1371.4317,-1326.9722 1483.574,-1326.9722 1483.574,-1326.9722 1483.574,-1326.9722 1644.2388,-1326.9722 1652.4844,-1326.9722 1936.5389,-1300.725 1940.4719,-1307.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M824.2437,-1653.9548C860.5287,-1639.6549 925.304,-1613.6084 979.6978,-1588.9722"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M829.4601,-1671.8463C997.8849,-1706.907 1751.9547,-1869.6615 1940.4719,-2010.9722"/>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M1940.4719,-2010.9722C1994.6566,-2043.9353 2040.0429,-2245.267 2053.7135,-2311.715"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="2050.3476,-2312.7282 2055.7632,-2321.8343 2057.2083,-2311.3384 2050.3476,-2312.7282"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#bfff00" stroke-dasharray="5,2" d="M809.6701,-1653.6944C863.6545,-1609.2157 1060.2816,-1447.2943 1088.825,-1424.9722 1154.4097,-1373.682 1169.2375,-1358.4328 1238.9897,-1312.9722 1300.2928,-1273.0182 1335.3415,-1288.0681 1382.3269,-1231.9722 1451.4575,-1149.437 1474.6273,-1016.5473 1481.2485,-965.1841"/>
<polygon fill="#bfff00" stroke="#bfff00" points="1484.7558,-965.3336 1482.4796,-954.9862 1477.8063,-964.4947 1484.7558,-965.3336"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M802.4219,-1653.899C817.4356,-1627.4543 854.6978,-1558.1113 870.5706,-1494.9722 895.2453,-1396.8206 860.4344,-1131.05 906.5706,-1040.9722 945.4195,-965.122 989.1764,-973.6409 1052.825,-916.9722 1143.9677,-835.8243 1249.3514,-735.0723 1291.6525,-694.3352"/>
<polygon fill="#3fff00" stroke="#3fff00" points="1294.2545,-696.6883 1299.0245,-687.228 1289.3961,-691.6489 1294.2545,-696.6883"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M829.4629,-1668.3642C844.4195,-1671.692 860.8354,-1678.2188 870.5706,-1690.9722 905.9811,-1737.361 895.078,-2157.7555 906.5706,-2214.9722 921.3321,-2288.4637 954.5022,-2371.3814 970.5956,-2409.1886"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="967.483,-2410.81 974.6525,-2418.6106 973.9124,-2408.0417 967.483,-2410.81"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffbf" stroke-dasharray="5,2" d="M801.4398,-1653.5892C814.3315,-1626.4751 847.3398,-1555.7901 870.5706,-1494.9722 888.9259,-1446.918 890.2881,-1433.7677 906.5706,-1384.9722 930.4115,-1313.5251 959.3934,-1228.9823 972.5667,-1190.6767"/>
<polygon fill="#00ffbf" stroke="#00ffbf" points="975.9013,-1191.7427 975.8457,-1181.148 969.2822,-1189.4649 975.9013,-1191.7427"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00bfff" stroke-dasharray="5,2" d="M802.3174,-1653.8721C817.1053,-1627.3691 853.9148,-1557.9092 870.5706,-1494.9722 910.0116,-1345.9369 831.8036,-1284.7943 906.5706,-1149.9722 926.5555,-1113.9347 952.9916,-1124.3549 979.6978,-1092.9722"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M829.6715,-1675.9027C842.5733,-1680.3003 857.3599,-1685.5989 870.5706,-1690.9722 897.4008,-1701.8851 927.1422,-1715.918 948.7911,-1726.5005"/>
<polygon fill="#007fff" stroke="#007fff" points="947.3168,-1729.6758 957.8347,-1730.9506 950.4074,-1723.395 947.3168,-1729.6758"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M979.6978,-1588.9722C1010.732,-1574.5858 1022.0619,-1579.9297 1052.825,-1564.9722 1070.1187,-1556.5636 1071.9531,-1550.1981 1088.825,-1540.9722 1095.0113,-1537.5893 1101.7474,-1534.3086 1108.3523,-1531.2973"/>
<polygon fill="#003fff" stroke="#003fff" points="1110.1241,-1534.3409 1117.8561,-1527.0976 1107.2947,-1527.9382 1110.1241,-1534.3409"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M829.6348,-1670.9036C843.5673,-1674.7339 859.1116,-1680.9527 870.5706,-1690.9722 897.2051,-1714.2607 880.6124,-1737.932 906.5706,-1761.9722 1074.4817,-1917.477 1177.5934,-1856.6974 1382.3269,-1958.9722 1530.7489,-2033.1164 1566.4688,-2055.6662 1703.6565,-2148.9722 1786.6542,-2205.4217 1878.9481,-2281.2001 1919.4669,-2315.1815"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="1917.4001,-2318.0166 1927.3054,-2321.7764 1921.9067,-2312.6602 1917.4001,-2318.0166"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1145.9073,-1554.9722C1202.7119,-1564.1765 1185.6413,-1623.3988 1238.9897,-1644.9722 1298.049,-1668.8549 1323.8055,-1670.1441 1382.3269,-1644.9722 1403.6982,-1635.7797 1398.0445,-1618.3677 1418.3269,-1606.9722 1444.184,-1592.4445 1458.1551,-1608.2536 1483.574,-1592.9722"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M829.4489,-1668.7652C844.2146,-1672.1881 860.4752,-1678.6789 870.5706,-1690.9722 943.489,-1779.7657 863.6125,-1840.4077 906.5706,-1946.9722 919.4601,-1978.9468 944.6114,-2010.2246 961.7812,-2029.2992"/>
<polygon fill="#ff007f" stroke="#ff007f" points="959.2426,-2031.7094 968.592,-2036.6934 964.3913,-2026.9669 959.2426,-2031.7094"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M801.8879,-1653.632C816.8802,-1625.4703 858.6512,-1550.8774 906.5706,-1498.9722 922.5211,-1481.6949 1218.3716,-1248.2776 1238.9897,-1236.9722 1246.1365,-1233.0534 1254.0135,-1229.5689 1261.8506,-1226.5376"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1263.1501,-1229.7891 1271.3386,-1223.066 1260.7448,-1223.2153 1263.1501,-1229.7891"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M802.4696,-1653.9109C817.5864,-1627.4917 855.055,-1558.2 870.5706,-1494.9722 926.8375,-1265.6766 834.6767,-1189.8581 906.5706,-964.9722 944.3764,-846.7143 990.5775,-834.394 1052.825,-726.9722 1069.5775,-698.062 1064.1982,-683.5547 1088.825,-660.9722 1092.6636,-657.4521 1097.0772,-654.3719 1101.7136,-651.6905"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1103.5174,-654.6988 1110.812,-647.015 1100.3179,-648.4727 1103.5174,-654.6988"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M829.515,-1669.1217C844.1119,-1672.6239 860.2149,-1679.0786 870.5706,-1690.9722 924.144,-1752.5017 869.0139,-1798.5463 906.5706,-1870.9722 912.6876,-1882.7685 1227.7124,-2207.9441 1238.9897,-2214.9722 1296.0065,-2250.505 1318.7057,-2241.389 1382.3269,-2262.9722 1440.6076,-2282.7436 1583.0074,-2359.1586 1644.2388,-2352.9722"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-1554.9722C1225.5072,-1567.8702 1264.9434,-1697.3999 1310.6583,-1630.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-1630.9722C1329.7017,-1603.3005 1356.9765,-1629.0114 1382.3269,-1606.9722 1440.0447,-1556.7931 1468.4572,-1465.9296 1478.812,-1424.981"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1482.2657,-1425.5889 1481.2134,-1415.0465 1475.4617,-1423.9442 1482.2657,-1425.5889"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1588.9722C988.2487,-1585.0082 1136.6036,-1553.4646 1145.9073,-1554.9722"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1941.7252,-2344.3665C1950.4838,-2422.6765 2003.7698,-2877.7909 2057.9268,-2865.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2057.9268,-2865.9722C2163.152,-2843.0086 2197.022,-2450.8394 2203.7838,-2354.3083"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2207.295,-2354.2597 2204.477,-2344.0465 2200.3109,-2353.7878 2207.295,-2354.2597"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M1978.2819,-2332.9722C1986.476,-2332.9722 1995.2951,-2332.9722 2003.9742,-2332.9722"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="2004.0526,-2336.4723 2014.0526,-2332.9722 2004.0526,-2329.4723 2004.0526,-2336.4723"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-1426.9776 -.2403,-1426.9776 -.2403,-1404.9667 130.719,-1404.9667 130.719,-1426.9776"/>
<text text-anchor="middle" x="65.2394" y="-1412.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-3112.9722C876.7265,-3125.1183 898.7243,-3102.4816 979.6978,-3112.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-521.9722C440.4249,-500.0842 492.3312,-490.3834 533.1877,-486.1291"/>
<polygon fill="#ff0000" stroke="#ff0000" points="533.7019,-489.596 543.3237,-485.1608 533.0361,-482.6278 533.7019,-489.596"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff3f00" stroke-dasharray="5,2" d="M223.8406,-1972.9722C244.5396,-1990.0839 257.5119,-1979.3222 281.2024,-1991.9722 299.0828,-2001.5197 299.4738,-2010.1456 317.2024,-2019.9722 327.9612,-2025.9355 340.1388,-2031.1355 351.7507,-2035.4559"/>
<polygon fill="#ff3f00" stroke="#ff3f00" points="350.7336,-2038.8091 361.3282,-2038.8757 353.0875,-2032.2167 350.7336,-2038.8091"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M795.9847,-3112.9722C808.6211,-3114.6815 1691.6417,-2979.2434 1703.6565,-2974.9722 1782.8757,-2946.8096 1806.8926,-2938.1056 1866.6592,-2878.9722 2022.8382,-2724.4475 2051.7646,-2435.3564 2056.8763,-2354.4818"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="2060.3932,-2354.2847 2057.47,-2344.1011 2053.4046,-2353.8849 2060.3932,-2354.2847"/>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M601.1821,-3036.9722C693.3973,-3048.514 704.0841,-3099.1474 795.9847,-3112.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M223.8406,-2716.9722C255.5133,-2749.4333 309.1942,-2751.0283 348.8166,-2746.6068"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="349.3432,-2750.0681 358.8205,-2745.3318 348.4582,-2743.1243 349.3432,-2750.0681"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M66.7261,-1427.3087C76.4819,-1499.8673 133.7545,-1898.4985 223.8406,-1972.9722"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.8406,-1972.9722C290.2775,-2027.8952 265.0616,-1871.6143 317.2024,-1802.9722 335.0751,-1779.4432 359.8048,-1756.2615 377.3992,-1740.9593"/>
<polygon fill="#ffff00" stroke="#ffff00" points="380.0783,-1743.2735 385.402,-1734.1133 375.5279,-1737.9543 380.0783,-1743.2735"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#bfff00" stroke-dasharray="5,2" d="M979.6978,-104.9722C1077.3763,-84.4432 1131.2317,-59.5941 1202.9897,-128.9722 1243.9748,-168.5979 1217.4564,-330.1868 1238.9897,-382.9722 1279.618,-482.5655 1337.1011,-480.3806 1382.3269,-577.9722 1411.3356,-640.5693 1400.3011,-662.3766 1418.3269,-728.9722 1437.7136,-800.5956 1464.3146,-884.4872 1476.7045,-922.8694"/>
<polygon fill="#bfff00" stroke="#bfff00" points="1473.5262,-924.4152 1479.9376,-932.8498 1480.1855,-922.2579 1473.5262,-924.4152"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-2240.9722C531.2756,-2290.4874 700.716,-2214.686 767.3002,-2179.9035"/>
<polygon fill="#7fff00" stroke="#7fff00" points="769.1726,-2182.8721 776.3611,-2175.089 765.888,-2176.6905 769.1726,-2182.8721"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M795.9847,-180.9722C910.4851,-178.2729 942.4338,-171.4534 1052.825,-201.9722 1124.5385,-221.7981 1160.4332,-214.9407 1202.9897,-275.9722 1290.4094,-401.3428 1166.0299,-483.6708 1238.9897,-617.9722 1248.443,-635.3732 1265.4978,-649.5015 1280.599,-659.4562"/>
<polygon fill="#3fff00" stroke="#3fff00" points="1278.8576,-662.4952 1289.1924,-664.8283 1282.5682,-656.5595 1278.8576,-662.4952"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M601.1821,-180.9722C799.401,1.7583 1004.576,77.5467 1202.9897,-104.9722 1270.1047,-166.7106 1177.2305,-239.8764 1238.9897,-306.9722 1283.6241,-355.4633 1324.6798,-313.0281 1382.3269,-344.9722 1471.0234,-394.1215 1504.5573,-409.7392 1548.821,-500.9722 1589.7114,-585.252 1529.1636,-845.6239 1584.821,-920.9722 1601.7429,-943.8807 1633.1786,-918.7266 1644.2388,-944.9722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M65.436,-1404.7945C67.297,-1314.069 84.9865,-699.1487 223.8406,-598.9722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-598.9722C264.4361,-569.6844 270.7431,-554.6081 317.2024,-535.9722 351.4683,-522.2273 366.5367,-539.4009 399.0839,-521.9722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1644.2388,-944.9722C1659.8546,-979.7979 1683.6349,-974.4787 1703.6565,-1006.9722 1758.186,-1095.4691 1788.4,-1218.0762 1798.8866,-1266.7919"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1795.503,-1267.7107 1800.9802,-1276.7799 1802.3541,-1266.2745 1795.503,-1267.7107"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-521.9722C554.3913,-438.8061 464.3308,-291.9167 601.1821,-180.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M601.1821,-2697.9722C693.8365,-2688.9039 711.2816,-2659.6043 795.9847,-2620.9722"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M795.9847,-2620.9722C835.2047,-2603.0844 846.0438,-2594.421 870.5706,-2558.9722 898.4011,-2518.7484 871.9176,-2489.4926 906.5706,-2454.9722 910.7723,-2450.7865 915.7032,-2447.3009 920.9863,-2444.3985"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="922.6156,-2447.4994 930.1432,-2440.0438 919.6092,-2441.1778 922.6156,-2447.4994"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M223.8406,-2716.9722C231.1699,-2724.4839 590.737,-2698.9944 601.1821,-2697.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M795.9847,-180.9722C859.3261,-180.9722 1034.1828,-249.8391 1110.0312,-280.9877"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="1109.0505,-284.3691 1119.6297,-284.9455 1111.7189,-277.8977 1109.0505,-284.3691"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffbf" stroke-dasharray="5,2" d="M223.8406,-598.9722C361.605,-503.3337 433.6834,-607.3347 601.1821,-598.9722"/>
<path fill="none" stroke="#00ffbf" stroke-dasharray="5,2" d="M795.9847,-559.9722C824.9233,-578.2134 848.6717,-552.6925 870.5706,-578.9722 945.8582,-669.3208 853.9526,-1001.7939 906.5706,-1106.9722 916.3125,-1126.4454 935.0045,-1142.381 951.0512,-1153.3534"/>
<polygon fill="#00ffbf" stroke="#00ffbf" points="949.3296,-1156.4089 959.6203,-1158.9295 953.1476,-1150.5418 949.3296,-1156.4089"/>
<path fill="none" stroke="#00ffbf" stroke-dasharray="5,2" d="M601.1821,-598.9722C689.4703,-600.2161 721.2891,-512.8881 795.9847,-559.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M979.6978,-104.9722C1033.2043,-94.3415 1171.0355,-162.758 1202.9897,-206.9722 1288.8924,-325.833 1171.3335,-404.8576 1238.9897,-534.9722 1248.9849,-554.1945 1267.4719,-570.2187 1283.1659,-581.2957"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1281.2771,-584.2434 1291.5258,-586.9295 1285.1891,-578.4385 1281.2771,-584.2434"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00bfff" stroke-dasharray="5,2" d="M795.9847,-521.9722C830.6176,-525.6077 846.7561,-520.565 870.5706,-545.9722 915.3904,-593.7894 877.5712,-630.1985 906.5706,-688.9722 964.2807,-805.9347 985.5308,-839.3416 1088.825,-918.9722 1093.4907,-922.569 1098.7542,-925.7668 1104.1501,-928.5726"/>
<polygon fill="#00bfff" stroke="#00bfff" points="1102.7413,-931.7784 1113.2739,-932.9257 1105.7557,-925.4606 1102.7413,-931.7784"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M979.6978,-1398.9722C1015.6774,-1445.7877 1075.6273,-1481.3872 1112.8438,-1500.4333"/>
<polygon fill="#003fff" stroke="#003fff" points="1111.2791,-1503.564 1121.7873,-1504.9156 1114.4155,-1497.3059 1111.2791,-1503.564"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M795.9847,-559.9722C824.9233,-578.2134 848.7931,-552.5918 870.5706,-578.9722 913.8649,-631.4174 893.2121,-1123.2904 906.5706,-1189.9722 925.9013,-1286.4656 919.7295,-1320.9435 979.6978,-1398.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-1972.9722C434.5934,-1961.3644 448.174,-1971.8717 480.9653,-1953.9722 500.5525,-1943.2802 498.8254,-1931.969 516.9653,-1918.9722 585.291,-1870.0185 632.9729,-1898.6713 685.3989,-1832.9722 726.0084,-1782.0812 677.4095,-1738.9716 721.3989,-1690.9722 729.6507,-1681.9682 741.1883,-1676.0823 752.7268,-1672.2347"/>
<polygon fill="#0000ff" stroke="#0000ff" points="753.7097,-1675.5939 762.3472,-1669.4584 751.7688,-1668.8684 753.7097,-1675.5939"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-1972.9722C254.3997,-1997.1111 361.6484,-1983.7026 399.0839,-1972.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M601.1821,-3036.9722C720.0658,-3052.4717 750.8515,-3029.3674 870.5706,-3022.9722 951.5788,-3018.6448 972.1905,-3021.8691 1052.825,-3012.9722 1120.0753,-3005.552 1137.7932,-3006.0575 1202.9897,-2987.9722 1450.1126,-2919.4211 1500.4442,-2868.4189 1739.6565,-2775.9722 1767.7993,-2765.096 1782.121,-2773.5998 1803.1578,-2751.9722"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="868.5702,-2708.9776 723.3993,-2708.9776 723.3993,-2686.9667 868.5702,-2686.9667 868.5702,-2708.9776"/>
<text text-anchor="middle" x="795.9847" y="-2694.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#bf00ff" stroke-dasharray="5,2" d="M601.1821,-2697.9722C637.791,-2694.3892 678.4554,-2693.8507 713.1213,-2694.4165"/>
<polygon fill="#bf00ff" stroke="#bf00ff" points="713.1353,-2697.9174 723.2021,-2694.6145 713.2728,-2690.9188 713.1353,-2697.9174"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1827.9776 180.0456,-1827.9776 180.0456,-1805.9667 267.6355,-1805.9667 267.6355,-1827.9776"/>
<text text-anchor="middle" x="223.8406" y="-1813.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M69.6468,-1427.1157C91.3433,-1481.9722 186.9093,-1723.5968 215.6417,-1796.2426"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="212.4466,-1797.6806 219.3793,-1805.6924 218.956,-1795.106 212.4466,-1797.6806"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M601.1821,-180.9722C664.8392,-122.2891 709.4149,-182.2285 795.9847,-180.9722"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M979.6978,-104.9722C1086.5147,-82.746 1132.8075,-123.4358 1202.9897,-206.9722 1243.7631,-255.5037 1203.9505,-292.1514 1238.9897,-344.9722 1283.3803,-411.8899 1331.6857,-392.6507 1382.3269,-454.9722 1489.9473,-587.4148 1501.3231,-637.0601 1548.821,-800.9722 1587.426,-934.1952 1563.0182,-973.9928 1584.821,-1110.9722 1601.1703,-1213.6888 1628.3315,-1335.1295 1639.3601,-1383.0423"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1635.9667,-1383.9032 1641.6309,-1392.8568 1642.7866,-1382.3252 1635.9667,-1383.9032"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M795.9847,-180.9722C884.3366,-179.69 891.6055,-111.861 979.6978,-104.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M399.0839,-2240.9722C425.7331,-2250.8155 813.3979,-2109.3943 940.0154,-2062.6762"/>
<polygon fill="#ff007f" stroke="#ff007f" points="941.5473,-2065.8415 949.7155,-2059.0939 939.1223,-2059.275 941.5473,-2065.8415"/>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M223.8406,-1972.9722C244.9151,-1989.6192 263.5217,-1971.757 281.2024,-1991.9722 338.0726,-2056.9945 270.5583,-2110.2642 317.2024,-2182.9722 341.283,-2220.5085 358.3805,-2222.7487 399.0839,-2240.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003f" stroke-dasharray="5,2" d="M223.8406,-1972.9722C244.5396,-1990.0839 261.1741,-1974.0801 281.2024,-1991.9722 309.6761,-2017.4088 285.0413,-2049.3944 317.2024,-2069.9722 400.5719,-2123.3147 523.4707,-2060.4503 575.9418,-2028.4585"/>
<polygon fill="#ff003f" stroke="#ff003f" points="577.9693,-2031.3191 584.6076,-2023.0617 574.2689,-2025.3771 577.9693,-2031.3191"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-521.9722C438.0584,-501.3371 752.1256,-517.3681 795.9847,-521.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-332.9722C1010.6967,-336.2419 1126.7756,-534.3632 1145.9073,-558.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-521.9722C887.2712,-533.4533 830.5415,-398.7855 906.5706,-346.9722 933.9156,-328.3367 946.7891,-329.501 979.6978,-332.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1145.9073,-558.9722C1167.9126,-587.2773 1188.1488,-583.3354 1202.9897,-615.9722 1252.1306,-724.0382 1186.44,-1042.5221 1238.9897,-1148.9722 1248.5183,-1168.2742 1266.8378,-1184.2125 1282.5693,-1195.2289"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1280.7093,-1198.1954 1290.9706,-1200.8329 1284.5937,-1192.372 1280.7093,-1198.1954"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="647.8111,-761.9776 554.5531,-761.9776 554.5531,-739.9667 647.8111,-739.9667 647.8111,-761.9776"/>
<text text-anchor="middle" x="601.1821" y="-747.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M223.8406,-598.9722C272.9695,-564.8154 264.6316,-667.3952 317.2024,-695.9722 355.5755,-716.8313 472.9107,-734.7366 544.1863,-744.0719"/>
<polygon fill="#cbff00" stroke="#cbff00" points="543.987,-747.5752 554.3533,-745.3863 544.8847,-740.6329 543.987,-747.5752"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-686.9776 353.1239,-686.9776 353.1239,-664.9667 445.0438,-664.9667 445.0438,-686.9776"/>
<text text-anchor="middle" x="399.0839" y="-672.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-598.9722C249.6418,-581.0339 332.9635,-631.6241 374.7363,-659.2804"/>
<polygon fill="#00ff66" stroke="#00ff66" points="372.9646,-662.3063 383.2213,-664.9618 376.8592,-656.4897 372.9646,-662.3063"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M979.6978,-332.9722C1096.2269,-345.2634 1024.4673,-475.0527 1088.825,-572.9722 1099.5977,-589.3627 1114.568,-605.713 1126.475,-617.6481"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1124.1906,-620.3099 1133.7824,-624.8096 1129.0902,-615.3105 1124.1906,-620.3099"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-2556.9776 334.3841,-2556.9776 334.3841,-2534.9667 463.7837,-2534.9667 463.7837,-2556.9776"/>
<text text-anchor="middle" x="399.0839" y="-2542.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M65.7848,-1427.0744C71.829,-1548.0386 127.9015,-2618.6449 223.8406,-2716.9722"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-2716.9722C254.6459,-2748.5444 350.6793,-2616.5385 385.9337,-2565.4295"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="388.8397,-2567.3805 391.5993,-2557.1514 383.063,-2563.4269 388.8397,-2567.3805"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-802.9776 168.8556,-802.9776 168.8556,-780.9667 278.8255,-780.9667 278.8255,-802.9776"/>
<text text-anchor="middle" x="223.8406" y="-788.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.9926,-1404.8428C75.3866,-1352.3938 113.2673,-1124.8771 166.4788,-943.9722 180.5852,-896.014 202.6533,-841.6057 214.8977,-812.6653"/>
<polygon fill="#ff0000" stroke="#ff0000" points="218.2249,-813.7857 218.9313,-803.2144 211.7868,-811.0378 218.2249,-813.7857"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-802.9776 340.6161,-802.9776 340.6161,-780.9667 457.5516,-780.9667 457.5516,-802.9776"/>
<text text-anchor="middle" x="399.0839" y="-788.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M65.6088,-1404.7949C68.092,-1348.234 86.8133,-1091.0485 223.8406,-957.9722"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-957.9722C279.8234,-903.6035 347.0879,-840.4957 379.5987,-810.1312"/>
<polygon fill="#00ffff" stroke="#00ffff" points="382.1647,-812.5239 387.0873,-803.1421 377.3885,-807.4064 382.1647,-812.5239"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-989.9776 323.0941,-989.9776 323.0941,-967.9667 475.0737,-967.9667 475.0737,-989.9776"/>
<text text-anchor="middle" x="399.0839" y="-975.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-957.9722C231.7762,-950.2654 286.519,-957.9349 332.7381,-966.0861"/>
<polygon fill="#ff0000" stroke="#ff0000" points="332.2918,-969.5618 342.7526,-967.8823 333.5276,-962.6718 332.2918,-969.5618"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-948.9776 317.3208,-948.9776 317.3208,-926.9667 480.847,-926.9667 480.847,-948.9776"/>
<text text-anchor="middle" x="399.0839" y="-934.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-957.9722C245.649,-936.7925 276.8976,-929.0321 306.9848,-927.4681"/>
<polygon fill="#00ffff" stroke="#00ffff" points="307.2376,-930.9622 317.1285,-927.1648 307.0283,-923.9653 307.2376,-930.9622"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="870.6565,-609.9776 721.313,-609.9776 721.313,-587.9667 870.6565,-587.9667 870.6565,-609.9776"/>
<text text-anchor="middle" x="795.9847" y="-595.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-598.9722C636.9972,-597.1841 676.5623,-596.8772 710.627,-597.1312"/>
<polygon fill="#ff0000" stroke="#ff0000" points="710.9801,-600.6345 721.012,-597.2271 711.0448,-593.6348 710.9801,-600.6345"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1972.9722C280.6306,-2019.9201 256.4019,-1877.5957 317.2024,-1835.9722 348.0293,-1814.8683 364.4889,-1831.0738 399.0839,-1816.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2989.9722C480.0104,-3034.1891 509.3759,-3028.263 601.1821,-3036.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-3036.9722C639.9281,-3040.6478 648.3062,-3024.7572 685.3989,-3012.9722 1004.3328,-2911.6406 1096.8245,-2902.5438 1382.3269,-2727.9722 1461.9583,-2679.2812 1478.2257,-2661.0316 1548.821,-2599.9722 1642.1958,-2519.2102 1745.3804,-2413.3782 1785.6843,-2371.3366"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1788.2927,-2373.6731 1792.674,-2364.0266 1783.2333,-2368.8354 1788.2927,-2373.6731"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1540.9771,-2590.9776 1426.1709,-2590.9776 1426.1709,-2568.9667 1540.9771,-2568.9667 1540.9771,-2590.9776"/>
<text text-anchor="middle" x="1483.574" y="-2576.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2989.9722C441.2391,-3009.9305 1158.4677,-2761.8713 1202.9897,-2747.9722 1282.9539,-2723.0085 1313.9046,-2738.3026 1382.3269,-2689.9722 1403.8186,-2674.7914 1400.8137,-2662.6097 1418.3269,-2642.9722 1432.5607,-2627.0118 1450.0556,-2610.2546 1463.3455,-2598.0382"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1465.9678,-2600.3842 1471.0101,-2591.0662 1461.2575,-2595.206 1465.9678,-2600.3842"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-2716.9722C323.5924,-2821.0758 272.5579,-2920.8405 399.0839,-2989.9722"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2620.9722C900.7498,-2573.19 963.4027,-2659.5152 1052.825,-2586.9722 1090.1588,-2556.6853 1059.7529,-2523.2596 1088.825,-2484.9722 1126.2928,-2435.6275 1173.0982,-2459.2421 1202.9897,-2404.9722 1243.7759,-2330.9225 1183.7173,-1708.9395 1238.9897,-1644.9722 1260.209,-1620.415 1291.836,-1657.4113 1310.6583,-1630.9722"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-2869.9722C1024.9328,-2894.601 1040.1369,-2892.1714 1088.825,-2908.9722 1139.3767,-2926.4161 1152.9613,-2928.0797 1202.9897,-2946.9722 1283.9748,-2977.5549 1303.5578,-2987.0652 1382.3269,-3022.9722 1441.2727,-3049.8426 1580.9458,-3164.7793 1644.2388,-3150.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.2388,-3150.9722C1789.1637,-3105.071 1795.5046,-3025.7392 1940.4719,-2979.9722"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M1644.2388,-2960.9722C1931.4079,-2893.0375 2033.9714,-2455.5111 2054.0516,-2353.989"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="2057.5162,-2354.5063 2055.9675,-2344.0253 2050.6421,-2353.1845 2057.5162,-2354.5063"/>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M979.6978,-2869.9722C1037.9315,-2896.0646 1485.634,-2938.0625 1548.821,-2946.9722 1591.2631,-2952.9567 1601.8946,-2967.6139 1644.2388,-2960.9722"/>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M843.4657,-2709.0559C852.9702,-2712.5672 862.502,-2717.1163 870.5706,-2722.9722 936.4232,-2770.7656 908.2352,-2831.0634 979.6978,-2869.9722"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M815.4149,-2686.8552C832.6871,-2675.9183 857.2119,-2657.595 870.5706,-2634.9722 912.0534,-2564.7213 852.8126,-2516.3406 906.5706,-2454.9722 910.5918,-2450.3817 915.4925,-2446.6332 920.8333,-2443.5724"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="922.693,-2446.5603 930.1594,-2439.0435 919.635,-2440.2635 922.693,-2446.5603"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-2675.9722C1375.7481,-2649.3043 1358.4699,-2596.9181 1418.3269,-2559.9722 1444.0284,-2544.1082 1456.5845,-2554.5295 1483.574,-2540.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M868.747,-2707.7518C881.3373,-2709.0928 894.3163,-2710.2543 906.5706,-2710.9722 996.5498,-2716.2428 1227.2536,-2710.1438 1310.6583,-2675.9722"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.574,-638.9722C1554.8737,-635.0667 1599.479,-583.3353 1644.2388,-638.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1055.9722C434.8198,-1029.7218 445.0548,-1024.9831 480.9653,-998.9722 573.0916,-932.2427 602.0055,-922.3388 685.3989,-844.9722 703.1764,-828.4794 700.7234,-816.6438 721.3989,-803.9722 779.7309,-768.2215 824.0139,-816.104 870.5706,-765.9722 932.9243,-698.8301 839.3303,-625.22 906.5706,-562.9722 1061.8127,-419.2562 1201.9256,-467.4744 1382.3269,-577.9722 1404.7649,-591.7156 1396.0933,-610.9004 1418.3269,-624.9722 1443.388,-640.8334 1453.9596,-640.5943 1483.574,-638.9722"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.5596,-1805.7961C232.263,-1686.3371 299.6194,-648.9285 317.2024,-622.9722 324.9102,-611.5938 493.9347,-532.5299 567.4886,-498.4957"/>
<polygon fill="#ff0000" stroke="#ff0000" points="569.1865,-501.5667 576.7952,-494.194 566.2495,-495.2126 569.1865,-501.5667"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff3f00" stroke-dasharray="5,2" d="M228.2196,-1828.1337C244.438,-1869.2572 300.9844,-2010.6727 317.2024,-2024.9722 322.4458,-2029.5952 328.5262,-2033.3635 334.9591,-2036.4349"/>
<polygon fill="#ff3f00" stroke="#ff3f00" points="334.0036,-2039.8288 344.5799,-2040.4546 336.7023,-2033.3699 334.0036,-2039.8288"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M795.9847,-903.9722C871.0072,-866.8882 1472.6823,-846.2376 1548.821,-880.9722 1570.5812,-890.8992 1567.0337,-904.9828 1584.821,-920.9722 1633.3066,-964.5565 1659.1546,-959.3274 1703.6565,-1006.9722 1797.0106,-1106.9191 1817.4608,-1140.3638 1866.6592,-1267.9722 1944.9627,-1471.0719 2038.2384,-2179.2127 2055.2101,-2311.5734"/>
<polygon fill="#ff7f00" stroke="#ff7f00" points="2051.7586,-2312.1766 2056.4973,-2321.6526 2058.7022,-2311.2897 2051.7586,-2312.1766"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M229.7548,-1827.9777C241.964,-1851.3217 269.7691,-1907.8564 281.2024,-1958.9722 343.3891,-2236.9964 234.1404,-2326.4555 317.2024,-2598.9722 331.2976,-2645.2168 363.9099,-2692.1794 383.4572,-2717.6357"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="380.8548,-2719.9894 389.7746,-2725.7066 386.3669,-2715.6747 380.8548,-2719.9894"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#bfff00" stroke-dasharray="5,2" d="M1310.6583,-904.9722C1357.4317,-904.5228 1409.6195,-918.3553 1444.3037,-929.6689"/>
<polygon fill="#bfff00" stroke="#bfff00" points="1443.4474,-933.0731 1454.0412,-932.9295 1445.67,-926.4353 1443.4474,-933.0731"/>
<path fill="none" stroke="#bfff00" stroke-dasharray="5,2" d="M1145.9073,-904.9722C1213.0666,-875.7969 1237.439,-905.6756 1310.6583,-904.9722"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M228.7243,-1828.279C238.9832,-1852.193 263.3025,-1909.7468 281.2024,-1958.9722 298.926,-2007.7128 278.4008,-2035.5597 317.2024,-2069.9722 378.5671,-2124.3955 621.0699,-2150.2707 735.5459,-2159.6458"/>
<polygon fill="#7fff00" stroke="#7fff00" points="735.3043,-2163.1376 745.5525,-2160.4499 735.865,-2156.1601 735.3043,-2163.1376"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M979.6978,-674.9722C1044.3213,-639.1851 1073.7586,-690.83 1145.9073,-674.9722"/>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M1145.9073,-674.9722C1180.3165,-667.4092 1219.7528,-667.3553 1251.4136,-669.3355"/>
<polygon fill="#3fff00" stroke="#3fff00" points="1251.1814,-672.8278 1261.4036,-670.043 1251.6759,-665.8452 1251.1814,-672.8278"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M795.9847,-903.9722C868.6127,-862.3937 1481.8934,-830.7298 1548.821,-880.9722 1591.9916,-913.3801 1548.2662,-957.2516 1584.821,-996.9722 1604.1075,-1017.9289 1623.6001,-1001.3457 1644.2388,-1020.9722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1644.2388,-1020.9722C1671.9924,-1047.1718 1681.8546,-1051.6455 1703.6565,-1082.9722 1746.8285,-1145.005 1780.9773,-1228.6154 1795.5281,-1267.054"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1792.3302,-1268.4955 1799.1037,-1276.6423 1798.889,-1266.0496 1792.3302,-1268.4955"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M229.0445,-1828.1698C239.9094,-1851.8773 265.3119,-1909.0619 281.2024,-1958.9722 302.2642,-2025.1247 278.3742,-2053.4211 317.2024,-2110.9722 367.087,-2184.911 408.8669,-2174.4628 480.9653,-2226.9722 588.8687,-2305.5583 596.7395,-2359.2338 721.3989,-2406.9722 786.1755,-2431.7784 866.5401,-2435.0568 920.2672,-2433.7348"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="920.4241,-2437.2317 930.3119,-2433.4264 920.2092,-2430.235 920.4241,-2437.2317"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M224.5062,-1805.7786C229.9401,-1718.7349 270.1314,-1150.9403 399.0839,-1055.9722"/>
<path fill="none" stroke="#00ff7f" stroke-dasharray="5,2" d="M399.0839,-1055.9722C434.7875,-1029.6779 454.4553,-1034.5159 480.9653,-998.9722 511.4674,-958.0761 486.6058,-930.9741 516.9653,-889.9722 571.5083,-816.3093 614.0427,-828.5 685.3989,-770.9722 702.2965,-757.3492 704.9055,-752.0816 721.3989,-737.9722 785.8451,-682.8412 822.2042,-688.6386 870.5706,-618.9722 899.9066,-576.7168 877.869,-551.661 906.5706,-508.9722 954.1198,-438.2505 989.498,-442.0001 1052.825,-384.9722 1079.2834,-361.1454 1108.8441,-332.522 1127.4087,-314.29"/>
<polygon fill="#00ff7f" stroke="#00ff7f" points="1129.9824,-316.6677 1134.6506,-307.1567 1125.0701,-311.6806 1129.9824,-316.6677"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffbf" stroke-dasharray="5,2" d="M601.1821,-1055.9722C736.2968,-1054.0899 887.4793,-1122.5377 950.089,-1154.2456"/>
<polygon fill="#00ffbf" stroke="#00ffbf" points="948.5214,-1157.3751 959.0168,-1158.8239 951.7156,-1151.1463 948.5214,-1157.3751"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M601.1821,-1055.9722C673.0325,-1055.4453 649.4702,-980.1966 685.3989,-917.9722 702.1068,-889.0361 695.6585,-873.2765 721.3989,-851.9722 775.052,-807.5655 824.2343,-855.9678 870.5706,-803.9722 925.1393,-742.7385 844.8061,-676.9394 906.5706,-622.9722 1006.8964,-535.3116 1180.1814,-563.7554 1263.3869,-584.43"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1262.5213,-587.8212 1273.0764,-586.9044 1264.2534,-581.0388 1262.5213,-587.8212"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1055.9722C471.4738,-1002.7971 511.3631,-1056.6308 601.1821,-1055.9722"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00bfff" stroke-dasharray="5,2" d="M979.6978,-1054.9722C1013.8795,-1056.2748 1026.2467,-1052.5056 1052.825,-1030.9722 1077.5829,-1010.9134 1065.0545,-990.1919 1088.825,-968.9722 1092.7595,-965.4598 1097.2656,-962.3786 1101.9828,-959.6916"/>
<polygon fill="#00bfff" stroke="#00bfff" points="1103.8883,-962.6495 1111.2197,-955.0008 1100.7187,-956.4081 1103.8883,-962.6495"/>
<path fill="none" stroke="#00bfff" stroke-dasharray="5,2" d="M601.1821,-1055.9722C654.9492,-1054.3767 667.6985,-1045.0885 721.3989,-1041.9722 787.5861,-1038.1312 804.3885,-1038.044 870.5706,-1041.9722 919.3287,-1044.8661 930.8893,-1053.112 979.6978,-1054.9722"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M399.0839,-1055.9722C453.716,-1015.7379 456.0256,-1123.1424 516.9653,-1152.9722 551.4285,-1169.8417 572.9742,-1145.9606 601.1821,-1171.9722"/>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M601.1821,-1171.9722C630.6179,-1199.116 658.9709,-1173.892 685.3989,-1203.9722 730.9357,-1255.8017 682.0376,-1298.3101 721.3989,-1354.9722 766.9363,-1420.5248 824.8836,-1389.5237 870.5706,-1454.9722 909.3192,-1510.4812 882.6308,-1539.6507 906.5706,-1602.9722 923.4035,-1647.4957 951.2819,-1695.9298 967.3155,-1722.2394"/>
<polygon fill="#007fff" stroke="#007fff" points="964.4172,-1724.2075 972.6444,-1730.8831 970.3758,-1720.534 964.4172,-1724.2075"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M601.1821,-1055.9722C640.087,-1054.8888 658.2849,-1052.051 685.3989,-1079.9722 730.757,-1126.6804 675.3872,-1175.9077 721.3989,-1221.9722 769.7485,-1270.3771 813.2432,-1222.6319 870.5706,-1259.9722 936.3829,-1302.8391 931.786,-1336.7363 979.6978,-1398.9722"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-1055.9722C427.3479,-1033.5721 721.6534,-1536.8473 784.2997,-1644.7847"/>
<polygon fill="#0000ff" stroke="#0000ff" points="781.4306,-1646.8142 789.4744,-1653.7097 787.4864,-1643.3031 781.4306,-1646.8142"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M795.9847,-903.9722C826.5793,-887.3401 838.3291,-893.1303 870.5706,-879.9722 887.1329,-873.2128 890.1576,-869.0866 906.5706,-861.9722 1051.1072,-799.3203 1083.9251,-766.7403 1238.9897,-738.9722 1301.6976,-727.7428 1320.9175,-722.0231 1382.3269,-738.9722 1542.696,-783.2341 1591.3117,-808.2692 1703.6565,-930.9722 1816.0102,-1053.6848 1825.6551,-1106.7257 1866.6592,-1267.9722 1908.1646,-1431.1899 1888.3884,-1857.1655 1902.6592,-2024.9722 1911.8496,-2133.0397 1929.9697,-2261.6134 1937.2912,-2311.6096"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="1933.8748,-2312.4334 1938.7963,-2321.8158 1940.7999,-2311.4121 1933.8748,-2312.4334"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#bf00ff" stroke-dasharray="5,2" d="M229.7424,-1827.9805C241.9281,-1851.3297 269.6913,-1907.8739 281.2024,-1958.9722 296.0505,-2024.8834 276.503,-2512.0434 317.2024,-2565.9722 364.7543,-2628.9808 589.2165,-2669.3841 713.1946,-2687.2852"/>
<polygon fill="#bf00ff" stroke="#bf00ff" points="713.0121,-2690.7945 723.4061,-2688.7415 714.0005,-2683.8646 713.0121,-2690.7945"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M795.9847,-903.9722C843.6495,-878.3305 853.7047,-943.3691 906.5706,-954.9722 970.0612,-968.9072 991.8864,-977.5939 1052.825,-954.9722 1072.6197,-947.6239 1070.4606,-934.3923 1088.825,-923.9722 1112.0805,-910.7766 1121.3831,-915.626 1145.9073,-904.9722"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1145.9073,-904.9722C1232.0887,-880.3275 1485.6129,-860.4165 1548.821,-923.9722 1608.5043,-983.9835 1568.4102,-1027.9412 1584.821,-1110.9722 1604.9881,-1213.0079 1629.9901,-1334.8337 1639.9006,-1382.946"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1636.4855,-1383.7156 1641.9323,-1392.8031 1643.3414,-1382.3023 1636.4855,-1383.7156"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M237.0568,-1828.0687C254.2873,-1841.8566 285.9295,-1864.9126 317.2024,-1875.9722 472.5304,-1930.9034 526.3814,-1875.8717 685.3989,-1918.9722 787.5368,-1946.6558 899.8979,-2004.1423 951.2511,-2032.0643"/>
<polygon fill="#ff007f" stroke="#ff007f" points="949.662,-2035.1845 960.1137,-2036.9201 953.0255,-2029.0456 949.662,-2035.1845"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003f" stroke-dasharray="5,2" d="M226.1663,-1828.1694C233.3348,-1859.5418 258.2675,-1948.5119 317.2024,-1986.9722 384.202,-2030.6954 479.8164,-2029.1694 541.1948,-2022.1053"/>
<polygon fill="#ff003f" stroke="#ff003f" points="541.9968,-2025.5328 551.4913,-2020.8314 541.1372,-2018.5858 541.9968,-2025.5328"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-1207.9722C844.7739,-1216.9003 857.0839,-1219.6312 906.5706,-1222.9722 1019.3805,-1230.5881 1150.2436,-1224.2615 1231.7573,-1218.5249"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1232.2168,-1222.001 1241.9402,-1217.7932 1231.715,-1215.019 1232.2168,-1222.001"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1055.9722C640.101,-1055.6868 657.1237,-1053.2276 685.3989,-1079.9722 720.9342,-1113.5838 686.435,-1149.7667 721.3989,-1183.9722 746.2911,-1208.3243 761.4114,-1203.809 795.9847,-1207.9722"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M224.4204,-1805.755C229.565,-1707.678 268.3578,-997.6561 317.2024,-917.9722 362.5127,-844.0541 413.5458,-866.4837 480.9653,-811.9722 498.5608,-797.7454 497.5226,-787.5471 516.9653,-775.9722 525.5164,-770.8814 535.1795,-766.7616 544.8324,-763.4486"/>
<polygon fill="#cbff00" stroke="#cbff00" points="545.9681,-766.7602 554.4402,-760.3983 543.8499,-760.0884 545.9681,-766.7602"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M224.5497,-1805.7951C231.6429,-1694.4976 290.1215,-788.462 317.2024,-738.9722 328.2736,-718.7396 348.8812,-702.9377 366.6518,-692.2201"/>
<polygon fill="#00ff66" stroke="#00ff66" points="368.6832,-695.0901 375.6206,-687.0824 365.2037,-689.0161 368.6832,-695.0901"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M601.1821,-1055.9722C657.2731,-1055.5608 648.915,-1004.5783 685.3989,-961.9722 701.8332,-942.7801 699.6665,-930.8609 721.3989,-917.9722 750.4089,-900.7673 766.2818,-919.9511 795.9847,-903.9722"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M795.9847,-903.9722C826.652,-887.4745 847.5332,-906.0859 870.5706,-879.9722 927.718,-815.1933 845.5756,-750.1419 906.5706,-688.9722 929.9361,-665.5397 950.749,-691.0033 979.6978,-674.9722"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M979.6978,-674.9722C996.9543,-665.4158 1041.1993,-655.2537 1079.7026,-647.6992"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1080.708,-651.0699 1089.8639,-645.7387 1079.3819,-644.1966 1080.708,-651.0699"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8833,-1805.911C224.398,-1711.9282 231.0783,-1046.47 317.2024,-869.9722 329.6712,-844.4193 354.2365,-822.8155 373.2219,-808.8702"/>
<polygon fill="#00ffff" stroke="#00ffff" points="375.3512,-811.6511 381.4888,-803.0152 371.3054,-805.9387 375.3512,-811.6511"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.0174,-1805.7977C225.5254,-1721.1778 238.183,-1180.8054 317.2024,-1041.9722 328.6865,-1021.7952 349.4903,-1005.916 367.2535,-995.1468"/>
<polygon fill="#ff0000" stroke="#ff0000" points="369.2872,-998.0143 376.1999,-989.9852 365.789,-991.951 369.2872,-998.0143"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.2944,-1805.8425C228.2973,-1710.0322 258.815,-1026.346 317.2024,-958.9722 318.3918,-957.5997 319.6575,-956.3109 320.9894,-955.1008"/>
<polygon fill="#00ffff" stroke="#00ffff" points="323.2974,-957.7477 329.2707,-948.9973 319.1443,-952.1128 323.2974,-957.7477"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.5468,-1805.7071C231.9828,-1687.4724 296.0564,-677.8938 317.2024,-655.9722 374.3937,-596.683 603.6246,-622.9232 685.3989,-612.9722 693.7525,-611.9556 702.4588,-610.8805 711.1571,-609.796"/>
<polygon fill="#ff0000" stroke="#ff0000" points="711.8548,-613.2361 721.3429,-608.5215 710.9857,-606.2902 711.8548,-613.2361"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="685.6163,-1143.9776 516.748,-1143.9776 516.748,-1121.9667 685.6163,-1121.9667 685.6163,-1143.9776"/>
<text text-anchor="middle" x="601.1821" y="-1129.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1055.9722C443.9616,-1020.4052 463.2138,-1088.229 516.9653,-1107.9722 527.706,-1111.9172 539.3842,-1115.6971 550.5281,-1119.0698"/>
<polygon fill="#ff0000" stroke="#ff0000" points="549.5641,-1122.4346 560.1466,-1121.9228 551.5547,-1115.7236 549.5641,-1122.4346"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.7246,-1825.8863C304.2747,-1831.2571 356.9645,-1834.141 399.0839,-1816.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1816.9722C451.7836,-1795.4905 463.4062,-1786.2114 516.9653,-1766.9722 527.8449,-1763.064 539.6648,-1759.2786 550.9145,-1755.8857"/>
<polygon fill="#ff0000" stroke="#ff0000" points="552.0217,-1759.2081 560.6158,-1753.0119 550.0335,-1752.4964 552.0217,-1759.2081"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-1054.9722C1053.1713,-1046.286 1612.1262,-1030.3194 1644.2388,-1096.9722"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1821,-1055.9722C665.8723,-1055.4978 849.1184,-1142.1265 870.5706,-1155.9722 889.0615,-1167.9066 886.1369,-1181.7984 906.5706,-1189.9722 1102.8951,-1268.5049 1203.7082,-1078.8082 1382.3269,-1191.9722 1399.975,-1203.1531 1454.2262,-1332.2295 1475.1872,-1383.3288"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1472.0002,-1384.7824 1479.0226,-1392.7156 1478.4802,-1382.1347 1472.0002,-1384.7824"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1944.9776 334.8633,-1944.9776 334.8633,-1922.9667 463.3044,-1922.9667 463.3044,-1944.9776"/>
<text text-anchor="middle" x="399.0839" y="-1930.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M232.0851,-1828.0561C246.9732,-1847.3066 280.2515,-1886.9636 317.2024,-1908.9722 324.1021,-1913.0817 331.7368,-1916.5702 339.4889,-1919.5168"/>
<polygon fill="#ff0000" stroke="#ff0000" points="338.3667,-1922.8322 348.9615,-1922.8474 340.6886,-1916.2285 338.3667,-1922.8322"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1866.9776 354.6193,-1866.9776 354.6193,-1844.9667 443.5485,-1844.9667 443.5485,-1866.9776"/>
<text text-anchor="middle" x="399.0839" y="-1852.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M267.6098,-1826.7129C290.9546,-1831.9082 319.8949,-1838.3488 344.6753,-1843.8637"/>
<polygon fill="#00ff00" stroke="#00ff00" points="344.134,-1847.3287 354.6555,-1846.0847 345.6547,-1840.4959 344.134,-1847.3287"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="860.8052,-1485.9776 731.1643,-1485.9776 731.1643,-1463.9667 860.8052,-1463.9667 860.8052,-1485.9776"/>
<text text-anchor="middle" x="795.9847" y="-1471.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M601.1821,-1171.9722C630.6179,-1199.116 660.331,-1172.7495 685.3989,-1203.9722 754.5774,-1290.1355 650.5236,-1365.1991 721.3989,-1449.9722 724.2075,-1453.3315 727.4826,-1456.2415 731.0632,-1458.7621"/>
<polygon fill="#0000ff" stroke="#0000ff" points="729.5039,-1461.9056 739.8967,-1463.9647 733.0563,-1455.874 729.5039,-1461.9056"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.8159,-1415.094C1648.2492,-1469.1519 1670.6617,-1706.5061 1803.1578,-1820.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1940.4719,-1896.9722C1992.1992,-1903.9976 2039.9007,-1847.9811 2057.9268,-1896.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.1578,-1820.9722C1825.9889,-1840.6964 1840.0032,-1830.8383 1866.6592,-1844.9722 1902.1127,-1863.7707 1900.708,-1891.5716 1940.4719,-1896.9722"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1659.4766,-1392.8496C1687.2894,-1372.5481 1746.4567,-1329.3601 1779.5318,-1305.2175"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1781.719,-1307.9543 1787.7326,-1299.2315 1777.592,-1302.3003 1781.719,-1307.9543"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1644.7004,-1415.2617C1648.8893,-1515.5113 1681.5156,-2251.3835 1739.6565,-2327.9722 1742.1247,-2331.2235 1745.0787,-2334.0525 1748.343,-2336.5139"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1746.6586,-2339.5882 1756.9967,-2341.9066 1750.3608,-2333.6473 1746.6586,-2339.5882"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-1972.9722C1444.2853,-1928.0558 1800.7805,-1877.9998 1940.4719,-1896.9722"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff7f00" stroke-dasharray="5,2" d="M1145.9073,-2048.9722C1233.7558,-2039.2399 1868.6729,-1959.4265 1940.4719,-2010.9722"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1310.6583,-1972.9722C1390.2302,-1946.2255 1430.027,-1961.6235 1483.574,-1896.9722"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1030.0421,-2051.3061C1063.0841,-2052.749 1107.1882,-2053.2617 1145.9073,-2048.9722"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1483.574,-1896.9722C1607.5736,-1747.2578 1636.6986,-1499.3225 1642.7769,-1425.4053"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1646.2938,-1425.3154 1643.5655,-1415.0779 1639.3142,-1424.7823 1646.2938,-1425.3154"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1145.9073,-2048.9722C1173.2611,-2045.9418 1179.2377,-2038.8737 1202.9897,-2024.9722 1220.4835,-2014.7334 1221.125,-2006.549 1238.9897,-1996.9722 1268.5953,-1981.1013 1278.8177,-1983.6748 1310.6583,-1972.9722"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantcondlooptowers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.574,-3150.9722C1554.0774,-3162.2929 1573.7495,-3162.3811 1644.2388,-3150.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602.072,-2023.1171C608.605,-2103.1029 650.8832,-2590.2027 721.3989,-2717.9722 815.5234,-2888.5191 1291.2412,-3120.0891 1483.574,-3150.9722"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M650.8462,-2003.6551C706.4583,-1993.0694 798.2617,-1971.7289 870.5706,-1935.9722 888.4984,-1927.1069 889.2942,-1919.0482 906.5706,-1908.9722 967.8612,-1873.2258 1009.6474,-1901.2753 1052.825,-1844.9722 1117.9268,-1760.0799 1019.9222,-1688.8095 1088.825,-1606.9722 1123.2675,-1566.0639 1170.5725,-1611.5033 1202.9897,-1568.9722 1248.7205,-1508.9737 1224.9348,-965.0908 1238.9897,-890.9722 1252.9267,-817.4761 1285.6924,-734.5606 1301.6324,-696.7548"/>
<polygon fill="#3fff00" stroke="#3fff00" points="1304.9471,-697.9045 1305.6525,-687.3331 1298.5087,-695.1573 1304.9471,-697.9045"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M650.8639,-2017.7125C663.5879,-2021.4009 676.2462,-2027.3654 685.3989,-2036.9722 731.797,-2085.6719 674.8746,-2135.393 721.3989,-2183.9722 780.2197,-2245.3909 1004.6352,-2278.9629 1088.825,-2290.9722 1139.0564,-2298.1374 1153.2655,-2301.0735 1202.9897,-2290.9722 1287.8242,-2273.7383 1307.6366,-2258.7357 1382.3269,-2214.9722 1463.0932,-2167.6484 1493.4313,-2161.4354 1548.821,-2085.9722 1666.047,-1926.2628 1644.0845,-1856.917 1703.6565,-1667.9722 1746.2317,-1532.9362 1785.195,-1366.9903 1798.4015,-1309.0899"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1801.8281,-1309.8052 1800.6281,-1299.2785 1795.0017,-1308.2559 1801.8281,-1309.8052"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M795.9847,-2392.9722C815.891,-2406.5967 874.3753,-2416.8517 920.0669,-2423.0693"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="919.8191,-2426.567 930.1921,-2424.4105 920.7383,-2419.6276 919.8191,-2426.567"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M609.8501,-2023.1534C627.0273,-2045.886 665.4482,-2099.6962 685.3989,-2150.9722 714.9819,-2227.0041 679.6398,-2260.8853 721.3989,-2330.9722 743.4632,-2368.0039 760.4122,-2368.6251 795.9847,-2392.9722"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M621.6305,-2000.8909C640.6315,-1989.6288 668.4715,-1970.5154 685.3989,-1946.9722 713.9528,-1907.2586 693.5684,-1883.1959 721.3989,-1842.9722 745.9257,-1807.5233 757.9094,-1801.1822 795.9847,-1780.9722"/>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M795.9847,-1780.9722C813.8773,-1771.4749 857.6808,-1762.0093 898.0272,-1754.7819"/>
<polygon fill="#007fff" stroke="#007fff" points="898.6781,-1758.2212 907.9202,-1753.041 897.4649,-1751.3271 898.6781,-1758.2212"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M625.0453,-2000.8779C717.2883,-1957.9468 1045.7602,-1804.6242 1052.825,-1794.9722 1120.1674,-1702.9673 1019.8782,-1631.781 1088.825,-1540.9722 1091.2936,-1537.7207 1094.2748,-1534.8846 1097.5636,-1532.412"/>
<polygon fill="#003fff" stroke="#003fff" points="1099.627,-1535.25 1106.2562,-1526.9853 1095.92,-1529.3121 1099.627,-1535.25"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M623.8289,-2000.9492C643.5313,-1990.089 671.1038,-1971.5617 685.3989,-1946.9722 743.1453,-1847.6407 648.4805,-1779.7657 721.3989,-1690.9722 729.2859,-1681.3681 740.9359,-1675.3055 752.6962,-1671.4805"/>
<polygon fill="#0000ff" stroke="#0000ff" points="753.8144,-1674.8028 762.5206,-1668.7652 751.9496,-1668.0557 753.8144,-1674.8028"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M601.5978,-2023.1063C604.0253,-2073.4113 620.0683,-2282.4164 721.3989,-2406.9722 731.7399,-2419.6833 1223.467,-2684.723 1238.9897,-2689.9722 1411.5945,-2748.3396 1462.3479,-2762.6899 1644.2388,-2751.9722"/>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M1803.1578,-2751.9722C1916.9346,-2635.0003 1936.4396,-2422.3091 1939.7815,-2354.4117"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="1943.2906,-2354.2666 1940.2143,-2344.1282 1936.2968,-2353.9722 1943.2906,-2354.2666"/>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M1644.2388,-2751.9722C1714.6249,-2746.0991 1753.9107,-2802.6023 1803.1578,-2751.9722"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M979.6978,-2162.9722C1256.2774,-2168.2857 1378.2763,-2128.7771 1548.821,-1910.9722 1564.2751,-1891.2356 1625.6848,-1518.2024 1640.8429,-1424.9585"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1644.3091,-1425.4483 1642.456,-1415.0168 1637.3995,-1424.3271 1644.3091,-1425.4483"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff007f" stroke-dasharray="5,2" d="M795.9847,-2046.9722C837.0587,-2046.4878 883.3009,-2046.7438 919.1163,-2047.1179"/>
<polygon fill="#ff007f" stroke="#ff007f" points="919.3646,-2050.6208 929.4027,-2047.2316 919.442,-2043.6212 919.3646,-2050.6208"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2046.9722C860.7727,-2046.2081 1014.201,-1960.9939 1052.825,-1908.9722 1100.9393,-1844.168 1052.1388,-1802.8658 1088.825,-1730.9722 1122.8743,-1664.2458 1170.1433,-1674.2989 1202.9897,-1606.9722 1246.0478,-1518.7142 1212.3996,-1483.5048 1238.9897,-1388.9722 1255.4331,-1330.5131 1285.0382,-1265.0914 1300.551,-1232.6011"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1303.8647,-1233.7874 1305.0579,-1223.26 1297.5601,-1230.7456 1303.8647,-1233.7874"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.1055,-2022.9806C675.9401,-2033.8064 739.8248,-2048.5093 795.9847,-2046.9722"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M795.9847,-1780.9722C897.0881,-1727.3074 973.5698,-1844.5581 1052.825,-1761.9722 1137.5747,-1673.6607 1020.1848,-762.313 1088.825,-660.9722 1090.9522,-657.8314 1093.5676,-655.082 1096.4975,-652.6757"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1098.5039,-655.5445 1104.8682,-647.0742 1094.6108,-649.7269 1098.5039,-655.5445"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M650.914,-2017.138C663.7931,-2020.8088 676.5194,-2026.908 685.3989,-2036.9722 750.3684,-2110.6093 659.8698,-2178.4371 721.3989,-2254.9722 776.9292,-2324.0454 823.276,-2298.6944 906.5706,-2328.9722 970.8676,-2352.3443 992.4322,-2344.8306 1052.825,-2376.9722 1070.7184,-2386.4952 1070.0007,-2397.4547 1088.825,-2404.9722 1180.8355,-2441.7167 1214.1471,-2404.5736 1310.6583,-2426.9722"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M979.6978,-2162.9722C1054.306,-2158.2505 1039.2477,-2090.9256 1088.825,-2034.9722 1138.5045,-1978.9033 1163.4765,-1974.6155 1202.9897,-1910.9722 1273.3154,-1797.6999 1235.0729,-1740.8045 1310.6583,-1630.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M647.5599,-2023.0397C660.1211,-2026.7579 673.5223,-2031.4057 685.3989,-2036.9722 702.811,-2045.1329 704.4623,-2051.8656 721.3989,-2060.9722 800.0522,-2103.2627 822.9272,-2107.6893 906.5706,-2138.9722 938.6097,-2150.9549 945.5595,-2165.1326 979.6978,-2162.9722"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M624.3391,-2000.8087C644.0965,-1989.9674 671.4547,-1971.5502 685.3989,-1946.9722 752.1009,-1829.4032 685.8593,-1775.3889 721.3989,-1644.9722 736.8444,-1588.2931 768.1068,-1526.1438 784.8325,-1495.0475"/>
<polygon fill="#0000ff" stroke="#0000ff" points="788.0026,-1496.5445 789.7137,-1486.0888 781.8558,-1493.1954 788.0026,-1496.5445"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#bfff00" stroke-dasharray="5,2" d="M1326.5299,-1200.912C1342.2339,-1189.3565 1366.197,-1170.0055 1382.3269,-1148.9722 1428.6939,-1088.5097 1462.4511,-1003.4626 1476.4398,-964.6923"/>
<polygon fill="#bfff00" stroke="#bfff00" points="1479.8178,-965.6379 1479.8552,-955.0432 1473.219,-963.3022 1479.8178,-965.6379"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1320.7024,-1223.1248C1349.2344,-1254.8058 1431.0022,-1345.5981 1466.6346,-1385.1632"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1464.2093,-1387.7003 1473.5022,-1392.7887 1469.4108,-1383.0157 1464.2093,-1387.7003"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-2022.9776 166.6166,-2022.9776 166.6166,-2000.9667 281.0645,-2000.9667 281.0645,-2022.9776"/>
<text text-anchor="middle" x="223.8406" y="-2008.8222" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M225.2907,-2023.0857C230.6751,-2060.3111 252.654,-2182.3431 317.2024,-2254.9722 476.9453,-2434.7128 555.5175,-2506.9722 795.9847,-2506.9722"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M795.9847,-2506.9722C879.0342,-2514.3736 924.6372,-2531.5847 979.6978,-2468.9722"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M979.6978,-2468.9722C1001.873,-2443.7555 1031.76,-2476.1234 1052.825,-2449.9722 1116.2326,-2371.2545 1031.8523,-1624.4654 1088.825,-1540.9722 1090.9631,-1537.8387 1093.5863,-1535.0947 1096.5216,-1532.6921"/>
<polygon fill="#003fff" stroke="#003fff" points="1098.5286,-1535.5606 1104.9019,-1527.097 1094.6417,-1529.7389 1098.5286,-1535.5606"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M281.4192,-2002.0787C315.9815,-1995.4223 360.5703,-1985.5619 399.0839,-1972.9722"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003f" stroke-dasharray="5,2" d="M227.7618,-2022.9882C237.8014,-2049.2883 267.2216,-2115.4477 317.2024,-2140.9722 382.0226,-2174.0748 414.2231,-2170.0053 480.9653,-2140.9722 532.3868,-2118.6036 571.7701,-2062.1999 590.0156,-2031.9198"/>
<polygon fill="#ff003f" stroke="#ff003f" points="593.1568,-2033.4816 595.1852,-2023.0827 587.1147,-2029.947 593.1568,-2033.4816"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2506.9722C910.1806,-2517.1494 973.5381,-2565.7844 1052.825,-2482.9722 1108.5262,-2424.7942 1049.0442,-1829.0064 1088.825,-1758.9722 1118.9306,-1705.971 1170.9918,-1734.8529 1202.9897,-1682.9722 1272.095,-1570.9264 1206.0019,-1516.4146 1238.9897,-1388.9722 1254.2073,-1330.1821 1284.3407,-1264.9031 1300.2534,-1232.5207"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1303.5634,-1233.7251 1304.8832,-1223.2128 1297.2959,-1230.6076 1303.5634,-1233.7251"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M224.3625,-2023.3703C227.7006,-2091.4016 248.1625,-2443.5044 317.2024,-2520.9722 320.2325,-2524.3721 323.7102,-2527.3163 327.485,-2529.8652"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="325.748,-2532.9037 336.165,-2534.837 329.2273,-2526.8296 325.748,-2532.9037"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.8852,-2023.1887C232.0044,-2098.4781 274.3866,-2528.4403 317.2024,-2565.9722 347.9469,-2592.9225 1019.4493,-2610.586 1052.825,-2586.9722 1092.0697,-2559.2059 1059.7529,-2523.2596 1088.825,-2484.9722 1126.2928,-2435.6275 1172.2012,-2458.7383 1202.9897,-2404.9722 1252.4013,-2318.6848 1213.9669,-2055.2056 1238.9897,-1958.9722 1277.5957,-1810.5009 1320.7579,-1785.4833 1382.3269,-1644.9722 1417.9236,-1563.7342 1458.1783,-1466.0748 1475.2324,-1424.4144"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1478.5067,-1425.6542 1479.0513,-1415.0733 1472.0272,-1423.0051 1478.5067,-1425.6542"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M642.6384,-739.8602C700.226,-722.5741 804.7552,-684.2609 870.5706,-618.9722 895.9702,-593.7757 880.4285,-571.3974 906.5706,-546.9722 990.8073,-468.2672 1056.8493,-373.7672 1145.9073,-446.9722"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M605.3108,-762.1455C619.2829,-800.4843 665.0513,-930.4735 685.3989,-1041.9722 721.6577,-1240.6589 672.1405,-1299.103 721.3989,-1494.9722 735.7266,-1551.9441 767.4629,-1613.9692 784.5544,-1644.9696"/>
<polygon fill="#0000ff" stroke="#0000ff" points="781.6123,-1646.8796 789.5483,-1653.8989 787.7217,-1643.4627 781.6123,-1646.8796"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-751.9722C828.76,-740.2065 845.7143,-752.361 870.5706,-727.9722 905.784,-693.4209 870.504,-656.632 906.5706,-622.9722 987.0691,-547.8452 1080.1834,-470.6294 1145.9073,-558.9722"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M647.8708,-759.7533C688.2527,-765.3688 747.5927,-768.8104 795.9847,-751.9722"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M979.6978,-636.9722C1011.1423,-624.4402 1048.6683,-623.183 1080.1,-625.4993"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1079.8098,-628.9872 1090.0756,-626.3672 1080.4166,-622.0136 1079.8098,-628.9872"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M795.9847,-751.9722C828.76,-740.2065 843.814,-750.2598 870.5706,-727.9722 896.5441,-706.3367 880.6599,-682.6829 906.5706,-660.9722 932.7897,-639.0029 947.9218,-649.6362 979.6978,-636.9722"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M608.8336,-739.7222C626.0783,-715.1895 670.4729,-656.4794 721.3989,-623.9722 727.572,-620.0317 734.4317,-616.6451 741.4194,-613.7533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="742.8774,-616.9432 750.975,-610.1109 740.3842,-610.4023 742.8774,-616.9432"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445.2177,-684.8715C537.0812,-699.792 744.8252,-719.1637 870.5706,-618.9722 907.5142,-589.5362 867.9241,-546.1339 906.5706,-518.9722 994.8052,-456.9585 1080.7609,-473.0246 1145.9073,-558.9722"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#3fff00" stroke-dasharray="5,2" d="M1191.3624,-647.0082C1211.0885,-651.7975 1234.376,-657.4515 1255.1159,-662.487"/>
<polygon fill="#3fff00" stroke="#3fff00" points="1254.5224,-665.9445 1265.0659,-664.9027 1256.174,-659.1421 1254.5224,-665.9445"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1148.7381,-647.091C1157.6795,-682.5011 1185.7441,-795.8929 1202.9897,-890.9722 1223.6525,-1004.891 1184.0774,-1047.0453 1238.9897,-1148.9722 1249.2656,-1168.0459 1267.7465,-1184.0733 1283.3674,-1195.1891"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1281.4448,-1198.1143 1291.6811,-1200.8473 1285.3834,-1192.3274 1281.4448,-1198.1143"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1201.9751,-632.8944C1263.7018,-630.8123 1357.5094,-631.9355 1382.3269,-655.9722 1431.8263,-703.9143 1409.2718,-895.6593 1418.3269,-963.9722 1439.7222,-1125.3805 1470.1332,-1319.3752 1480.1966,-1382.7951"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1476.7558,-1383.4448 1481.7828,-1392.771 1483.669,-1382.3455 1476.7558,-1383.4448"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M464.0683,-2551.0627C542.9758,-2556.0367 679.9155,-2560.784 795.9847,-2544.9722"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M795.9847,-2544.9722C830.3715,-2539.4765 843.744,-2543.1755 870.5706,-2520.9722 896.311,-2499.6678 881.024,-2476.5086 906.5706,-2454.9722 911.0393,-2451.2049 916.1047,-2447.9958 921.4343,-2445.2641"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="922.9372,-2448.4256 930.5943,-2441.1031 920.0421,-2442.0524 922.9372,-2448.4256"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M795.9847,-2544.9722C883.2386,-2531.0274 921.3469,-2535.3263 979.6978,-2468.9722"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003f" stroke-dasharray="5,2" d="M403.305,-2534.8188C428.5788,-2468.0384 559.8991,-2121.0534 593.3977,-2032.5408"/>
<polygon fill="#ff003f" stroke="#ff003f" points="596.718,-2033.6556 596.9842,-2023.0641 590.1712,-2031.1779 596.718,-2033.6556"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M795.9847,-2544.9722C908.8728,-2526.9306 969.2636,-2636.9896 1052.825,-2558.9722 1095.4821,-2519.1451 1075.4975,-2091.7894 1088.825,-2034.9722 1119.1402,-1905.7335 1170.8426,-1887.7674 1202.9897,-1758.9722 1243.0012,-1598.6691 1199.5782,-1549.4237 1238.9897,-1388.9722 1253.4756,-1329.9976 1283.9245,-1264.7981 1300.0758,-1232.4759"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1303.3845,-1233.6892 1304.779,-1223.1865 1297.1393,-1230.5273 1303.3845,-1233.6892"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M459.1627,-2556.9825C466.5313,-2558.5475 473.9374,-2560.2234 480.9653,-2561.9722 606.5866,-2593.2299 936.46,-2729.6903 1052.825,-2672.9722 1112.7219,-2643.7774 1381.7094,-2216.8056 1382.3269,-2214.9722 1427.5109,-2080.8173 1389.2731,-1717.5181 1418.3269,-1578.9722 1430.5171,-1520.8419 1458.6678,-1456.3024 1473.6974,-1424.2874"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1476.9401,-1425.6186 1478.0792,-1415.0852 1470.62,-1422.6091 1476.9401,-1425.6186"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-752.9722C448.0393,-749.7216 503.8091,-749.4253 544.344,-749.8257"/>
<polygon fill="#cbff00" stroke="#cbff00" points="544.5286,-753.328 554.5686,-749.9447 544.61,-746.3285 544.5286,-753.328"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M258.625,-780.9291C293.6595,-770.5946 349.4793,-756.2658 399.0839,-752.9722"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M601.1821,-789.9722C691.6869,-811.0846 713.9863,-909.7112 795.9847,-865.9722"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M795.9847,-865.9722C826.71,-849.5829 847.4024,-867.97 870.5706,-841.9722 925.1393,-780.7385 852.1798,-722.3639 906.5706,-660.9722 929.2543,-635.3686 947.9218,-649.6362 979.6978,-636.9722"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-752.9722C421.8623,-751.4597 578.9504,-784.7861 601.1821,-789.9722"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-791.9722C295.1003,-791.9722 313.1505,-791.9722 330.2066,-791.9722"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.6733,-795.4722 340.6733,-791.9722 330.6733,-788.4722 330.6733,-795.4722"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M453.5083,-780.931C481.7451,-775.2025 516.203,-768.212 544.7292,-762.4248"/>
<polygon fill="#cbff00" stroke="#cbff00" points="545.4476,-765.8505 554.552,-760.4321 544.0558,-758.9902 545.4476,-765.8505"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M457.3758,-784.1577C498.1849,-780.434 553.6847,-778.8922 601.1821,-789.9722"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M474.8887,-975.9709C534.885,-970.9448 619.2854,-957.8313 685.3989,-923.9722 704.9873,-913.9402 702.4559,-901.1751 721.3989,-889.9722 751.3726,-872.2456 765.1763,-882.2045 795.9847,-865.9722"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M481.2664,-928.2735C580.716,-915.6395 741.6055,-892.0625 795.9847,-865.9722"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M852.4698,-587.8039C859.3599,-584.3556 865.6799,-579.8519 870.5706,-573.9722 943.7631,-485.9761 835.0854,-408.3608 906.5706,-318.9722 991.0508,-213.3338 1091.6798,-173.1187 1202.9897,-249.9722 1240.1458,-275.6264 1212.0529,-308.7351 1238.9897,-344.9722 1286.8966,-409.4193 1340.4876,-386.4304 1382.3269,-454.9722 1428.9284,-531.3155 1375.8087,-574.2816 1418.3269,-652.9722 1456.3591,-723.3603 1508.5174,-707.8596 1548.821,-776.9722 1582.0539,-833.9597 1541.523,-871.1999 1584.821,-920.9722 1603.5139,-942.4601 1633.1786,-918.7266 1644.2388,-944.9722"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M851.4152,-587.9001C858.6358,-584.4435 865.3301,-579.9119 870.5706,-573.9722 924.2569,-513.121 852.6929,-455.654 906.5706,-394.9722 951.9927,-343.8136 1000.9129,-391.5312 1052.825,-346.9722 1079.6714,-323.9283 1058.6767,-294.488 1088.825,-275.9722 1132.0617,-249.4179 1163.8012,-243.7418 1202.9897,-275.9722 1267.0108,-328.6259 1196.6515,-387.708 1238.9897,-458.9722 1281.2803,-530.1559 1341.359,-506.0191 1382.3269,-577.9722 1432.8695,-666.7416 1362.9726,-719.1207 1418.3269,-804.9722 1455.9666,-863.3493 1511.0379,-832.6878 1548.821,-890.9722 1602.7155,-974.1099 1566.9722,-1013.5149 1584.821,-1110.9722 1603.5583,-1213.2802 1629.3689,-1334.9519 1639.6982,-1382.9845"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1636.2906,-1383.7867 1641.8195,-1392.8246 1643.1334,-1382.3115 1636.2906,-1383.7867"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#007fff" stroke-dasharray="5,2" d="M663.7371,-1144.1323C671.6963,-1147.5818 679.2084,-1152.0879 685.3989,-1157.9722 720.2435,-1191.0926 696.6105,-1218.7818 721.3989,-1259.9722 771.8663,-1343.8324 826.2213,-1334.7217 870.5706,-1421.9722 907.7357,-1495.0889 879.1932,-1525.656 906.5706,-1602.9722 922.4586,-1647.8416 950.6807,-1696.1498 967.0287,-1722.3444"/>
<polygon fill="#007fff" stroke="#007fff" points="964.1662,-1724.3664 972.4695,-1730.9471 970.0823,-1720.6247 964.1662,-1724.3664"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M648.5784,-1730.9368C660.8832,-1727.2606 673.9024,-1722.6256 685.3989,-1716.9722 703.1099,-1708.2628 703.8968,-1700.094 721.3989,-1690.9722 731.268,-1685.8285 742.3756,-1681.3331 752.9446,-1677.5919"/>
<polygon fill="#0000ff" stroke="#0000ff" points="754.1009,-1680.8957 762.4485,-1674.3712 751.8542,-1674.266 754.1009,-1680.8957"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#3f00ff" stroke-dasharray="5,2" d="M1866.991,-2343.6748C1875.5595,-2342.4267 1884.2287,-2341.1641 1892.4613,-2339.965"/>
<polygon fill="#3f00ff" stroke="#3f00ff" points="1893.2241,-2343.3909 1902.6152,-2338.486 1892.2151,-2336.464 1893.2241,-2343.3909"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1488.0703,-2568.6616C1500.3256,-2537.2608 1534.3619,-2446.1065 1548.821,-2366.9722 1593.6489,-2121.6313 1558.6098,-2054.9936 1584.821,-1806.9722 1600.3223,-1660.2929 1630.0023,-1485.1337 1640.4704,-1425.2508"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1643.9622,-1425.6025 1642.2461,-1415.1475 1637.0679,-1424.3907 1643.9622,-1425.6025"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1526.6544,-2568.8495C1534.6746,-2565.3593 1542.5057,-2560.8285 1548.821,-2554.9722 1621.6257,-2487.4594 1546.1887,-2368.614 1644.2388,-2352.9722"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1537.52,-1403.9722C1549.3425,-1403.9722 1562.0228,-1403.9722 1574.3678,-1403.9722"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1574.6326,-1407.4722 1584.6325,-1403.9722 1574.6325,-1400.4722 1574.6326,-1407.4722"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003f" stroke-dasharray="5,2" d="M427.611,-1944.9822C463.0187,-1958.6479 523.5351,-1982.0042 562.9388,-1997.2121"/>
<polygon fill="#ff003f" stroke="#ff003f" points="561.8841,-2000.5566 572.4736,-2000.8921 564.4046,-1994.0261 561.8841,-2000.5566"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M417.6609,-1922.7705C434.9533,-1911.9046 460.9893,-1894.3975 480.9653,-1875.9722 499.2864,-1859.0733 495.6152,-1845.8331 516.9653,-1832.9722 582.5375,-1793.4726 634.2044,-1853.8848 685.3989,-1796.9722 787.6137,-1683.3405 628.0377,-1575.9833 721.3989,-1454.9722 775.1425,-1385.3118 820.0206,-1400.7852 906.5706,-1384.9722 1083.4158,-1352.6617 1131.7975,-1384.8886 1310.6583,-1402.9722"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff003f" stroke-dasharray="5,2" d="M416.1593,-1867.1495C433.0458,-1878.4139 459.4124,-1896.5743 480.9653,-1913.9722 497.8546,-1927.6054 500.3592,-1932.9954 516.9653,-1946.9722 536.9401,-1963.7842 560.5338,-1981.8485 577.6592,-1994.6561"/>
<polygon fill="#ff003f" stroke="#ff003f" points="575.8593,-1997.6793 585.9717,-2000.8399 580.0374,-1992.063 575.8593,-1997.6793"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1310.6583,-1402.9722C1346.2606,-1408.4956 1386.4841,-1409.0601 1419.1717,-1408.1012"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1419.6325,-1411.5873 1429.5043,-1407.7407 1419.3883,-1404.5916 1419.6325,-1411.5873"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M443.4553,-1845.3195C455.9141,-1841.5615 469.2505,-1836.7895 480.9653,-1830.9722 498.6423,-1822.1941 499.0895,-1813.338 516.9653,-1804.9722 586.9416,-1772.2234 635.1614,-1820.6692 685.3989,-1761.9722 740.266,-1697.866 664.8607,-1446.6095 721.3989,-1383.9722 771.0542,-1328.9602 978.7188,-1346.4787 1052.825,-1346.9722 1119.5693,-1347.4166 1140.3832,-1325.8328 1202.9897,-1348.9722 1222.5254,-1356.1925 1220.802,-1368.824 1238.9897,-1378.9722 1268.3237,-1395.3395 1277.4642,-1397.8223 1310.6583,-1402.9722"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M833.2836,-1463.9419C917.8669,-1440.2076 1130.865,-1387.6354 1310.6583,-1402.9722"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplantcondlooptowersf90EfferentGraph = svgPanZoom('#sourcefileplantcondlooptowersf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~plantcondlooptowers.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileplantcondlooptowersf90AfferentGraph" width="641pt" height="47pt"
 viewBox="0.00 0.00 641.00 47.07" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph" class="graph" transform="scale(.3805 .3805) rotate(0) translate(4 119.7261)">
<title>sourcefile~~plantcondlooptowers.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-119.7261 1680.7876,-119.7261 1680.7876,4 -4,4"/>
<!-- sourcefile~plantcondlooptowers.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~plantcondlooptowers.f90</title>
<polygon fill="none" stroke="#000000" points="135.2473,-95.4815 -.0825,-95.4815 -.0825,-73.4707 135.2473,-73.4707 135.2473,-95.4815"/>
<text text-anchor="middle" x="67.5824" y="-81.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantCondLoopTowers.f90</text>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="298.1688,-95.4815 171.1635,-95.4815 171.1635,-73.4707 298.1688,-73.4707 298.1688,-95.4815"/>
<text text-anchor="middle" x="234.6661" y="-81.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantcondlooptowers.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~plantcondlooptowers.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M135.5418,-84.4761C143.8919,-84.4761 152.4573,-84.4761 160.8882,-84.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="161.0819,-87.9762 171.0819,-84.4761 161.0819,-80.9762 161.0819,-87.9762"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="570.6303,-95.4815 476.0028,-95.4815 476.0028,-73.4707 570.6303,-73.4707 570.6303,-95.4815"/>
<text text-anchor="middle" x="523.3165" y="-81.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M298.3623,-85.2114C310.2617,-85.3217 322.5931,-85.4179 334.1675,-85.4761 381.2746,-85.7128 393.053,-85.7593 440.1599,-85.4761 448.3714,-85.4267 457.0386,-85.3499 465.5539,-85.2603"/>
<polygon fill="#ff0000" stroke="#ff0000" points="465.8642,-88.7572 475.8245,-85.1457 465.786,-81.7576 465.8642,-88.7572"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="440.1561,-76.4815 334.1713,-76.4815 334.1713,-54.4707 440.1561,-54.4707 440.1561,-76.4815"/>
<text text-anchor="middle" x="387.1637" y="-62.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M298.4552,-76.5285C306.8109,-75.4874 315.3716,-74.4208 323.7215,-73.3805"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.2834,-76.8376 333.7739,-72.1281 323.4179,-69.8914 324.2834,-76.8376"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1544.3702,-75.4815 1424.5597,-75.4815 1424.5597,-53.4707 1544.3702,-53.4707 1544.3702,-75.4815"/>
<text text-anchor="middle" x="1484.465" y="-61.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1339.2733,-104.4761C1377.0738,-101.8848 1418.6034,-89.4098 1447.5276,-79.0712"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1449.0218,-82.2513 1457.206,-75.5231 1446.6123,-75.679 1449.0218,-82.2513"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M570.6524,-89.757C627.9399,-95.6824 727.3695,-104.4761 812.9205,-104.4761 812.9205,-104.4761 812.9205,-104.4761 1003.9343,-104.4761 1152.9739,-104.4761 1190.5827,-114.669 1339.2733,-104.4761"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1676.5985,-115.4815 1580.3563,-115.4815 1580.3563,-93.4707 1676.5985,-93.4707 1676.5985,-115.4815"/>
<text text-anchor="middle" x="1628.4774" y="-101.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1339.2733,-104.4761C1419.0746,-98.2074 1511.6448,-99.7465 1570.13,-101.7999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1570.1638,-105.3034 1580.2858,-102.1737 1570.4214,-98.3081 1570.1638,-105.3034"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="705.1416,-76.4815 606.5835,-76.4815 606.5835,-54.4707 705.1416,-54.4707 705.1416,-76.4815"/>
<text text-anchor="middle" x="655.8625" y="-62.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M570.7943,-77.6703C579.1232,-76.4764 587.8839,-75.2206 596.4878,-73.9873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="597.0787,-77.4384 606.4808,-72.5548 596.0853,-70.5093 597.0787,-77.4384"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M440.1938,-72.8764C448.6732,-74.0597 457.4803,-75.2887 466.0528,-76.485"/>
<polygon fill="#00ffff" stroke="#00ffff" points="465.5868,-79.9538 475.9746,-77.8696 466.5543,-73.021 465.5868,-79.9538"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1524.1982,-75.5122C1541.0575,-80.1949 1560.8928,-85.7042 1578.7129,-90.6538"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1577.8019,-94.0332 1588.3739,-93.3372 1579.6753,-87.2886 1577.8019,-94.0332"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1670.1859,-74.4815 1586.7689,-74.4815 1586.7689,-52.4707 1670.1859,-52.4707 1670.1859,-74.4815"/>
<text text-anchor="middle" x="1628.4774" y="-60.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1544.2881,-64.0607C1554.9527,-63.9866 1565.9845,-63.91 1576.4109,-63.8376"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1576.6239,-67.3363 1586.5994,-63.7669 1576.5753,-60.3365 1576.6239,-67.3363"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M705.186,-64.1301C772.6754,-62.6281 897.5653,-61.0607 1003.9343,-66.4761"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="884.7581,-38.4815 741.083,-38.4815 741.083,-16.4707 884.7581,-16.4707 884.7581,-38.4815"/>
<text text-anchor="middle" x="812.9205" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M701.7124,-54.3828C719.1306,-50.1685 739.1594,-45.3225 757.378,-40.9146"/>
<polygon fill="#0000ff" stroke="#0000ff" points="758.3887,-44.2711 767.2852,-38.5175 756.7425,-37.4674 758.3887,-44.2711"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M850.1842,-38.5558C888.3747,-49.0856 949.6813,-63.714 1003.9343,-66.4761"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1003.9343,-66.4761C1085.8715,-70.6476 1106.649,-61.3458 1188.5317,-66.4761"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1087.125,-38.4815 920.7436,-38.4815 920.7436,-16.4707 1087.125,-16.4707 1087.125,-38.4815"/>
<text text-anchor="middle" x="1003.9343" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M884.5905,-27.4761C893.0362,-27.4761 901.7476,-27.4761 910.4369,-27.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="910.6099,-30.9762 920.6098,-27.4761 910.6098,-23.9762 910.6099,-30.9762"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1039.9173,-38.5545C1076.8021,-49.0832 1136.0318,-63.7109 1188.5317,-66.4761"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1188.5317,-66.4761C1265.7703,-70.5443 1354.5033,-69.1363 1414.5027,-67.2859"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1414.737,-70.7802 1424.6196,-66.9612 1414.5124,-63.7838 1414.737,-70.7802"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1253.5371,-38.4815 1123.5264,-38.4815 1123.5264,-16.4707 1253.5371,-16.4707 1253.5371,-38.4815"/>
<text text-anchor="middle" x="1188.5317" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1087.322,-27.4761C1096.0436,-27.4761 1104.8723,-27.4761 1113.4927,-27.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1113.4978,-30.9762 1123.4978,-27.4761 1113.4977,-23.9762 1113.4978,-30.9762"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1223.5479,-16.3906C1264.0348,-5.3016 1332.3441,8.0525 1388.7627,-7.4761 1416.77,-15.1848 1444.8594,-33.4716 1463.2918,-47.2689"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1461.2263,-50.0958 1471.284,-53.4265 1465.4986,-44.5507 1461.2263,-50.0958"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~plantcondlooptowers.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1388.7521,-38.4815 1289.7946,-38.4815 1289.7946,-16.4707 1388.7521,-16.4707 1388.7521,-38.4815"/>
<text text-anchor="middle" x="1339.2733" y="-24.3261" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1253.7725,-27.4761C1262.2578,-27.4761 1270.9176,-27.4761 1279.3111,-27.4761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1279.3877,-30.9762 1289.3876,-27.4761 1279.3876,-23.9762 1279.3877,-30.9762"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantcondlooptowers.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1382.8356,-38.5773C1398.1228,-42.473 1415.4665,-46.8928 1431.4433,-50.9643"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1430.6292,-54.3686 1441.1838,-53.4465 1432.3578,-47.5854 1430.6292,-54.3686"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplantcondlooptowersf90AfferentGraph = svgPanZoom('#sourcefileplantcondlooptowersf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/condenserlooptowers.html">CondenserLoopTowers</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html#src">PlantCondLoopTowers.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">CondenserLoopTowers</span>
<a name="ln-2"></a>
<a name="ln-3"></a>  <span class="c">! Module containing the routines dealing with the objects COOLING TOWER:SINGLE SPEED,</span>
<a name="ln-4"></a>  <span class="c">! COOLING TOWER:TWO SPEED, and COOLING TOWER:VARIABLE SPEED</span>
<a name="ln-5"></a>
<a name="ln-6"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-7"></a>  <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-8"></a>  <span class="c">!       DATE WRITTEN   April 1998</span>
<a name="ln-9"></a>  <span class="c">!       MODIFIED       Shirey, Raustad: Dec 2000; Shirey, Sept 2002, Raustad Mar 2005</span>
<a name="ln-10"></a>  <span class="c">!                      B Griffith Aug 2006, added water consumption and water system interactions</span>
<a name="ln-11"></a>  <span class="c">!                      T Hong, Aug 2008. Added fluid bypass for single speed cooling tower</span>
<a name="ln-12"></a>  <span class="c">!                      Chandan Sharma, FSEC, February 2010, Added basin heater</span>
<a name="ln-13"></a>  <span class="c">!                      A Flament, July 2010, added multi-cell capability for the 3 types of cooling tower</span>
<a name="ln-14"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-15"></a>
<a name="ln-16"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-17"></a>  <span class="c">! Model the performance of cooling towers</span>
<a name="ln-18"></a>
<a name="ln-19"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-20"></a>
<a name="ln-21"></a>  <span class="c">! REFERENCES: none</span>
<a name="ln-22"></a>
<a name="ln-23"></a>  <span class="c">! OTHER NOTES: none</span>
<a name="ln-24"></a>
<a name="ln-25"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-26"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-27"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-28"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">KelvinConv</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">InitConvTemp</span>
<a name="ln-29"></a><span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">SetupOutputVariable</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-30"></a>                       <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowContinueErrorTimeStamp</span><span class="p">,</span> <span class="n">ShowRecurringWarningErrorAtEnd</span>
<a name="ln-31"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span>
<a name="ln-32"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-33"></a><span class="k">Use </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span><span class="p">,</span> <span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">OutHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-34"></a>
<a name="ln-35"></a><span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-36"></a><span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-37"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-38"></a><span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">,</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyHFnTdbRhPb</span><span class="p">,</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-39"></a>                          <span class="n">PsyTsatFnHPb</span><span class="p">,</span> <span class="n">PsyWFnTdbH</span>
<a name="ln-40"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-41"></a>
<a name="ln-42"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-43"></a>
<a name="ln-44"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-45"></a>
<a name="ln-46"></a>  <span class="c">! MODULE PARAMETER DEFINITIONS</span>
<a name="ln-47"></a><span class="c">! Empirical Model Type</span>
<a name="ln-48"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>             <span class="kd">::</span> <span class="n">CoolToolsXFModel</span>     <span class="o">=</span> <span class="mi">1</span>
<a name="ln-49"></a><span class="c">! CoolTools counterflow model does not work properly. The empirical model seems flawed since the tower</span>
<a name="ln-50"></a><span class="c">! operates in the free convection regime on the design day.</span>
<a name="ln-51"></a><span class="c">! INTEGER, PARAMETER             :: CoolToolsCFModel     = 2</span>
<a name="ln-52"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>             <span class="kd">::</span> <span class="n">CoolToolsUserDefined</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-53"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>             <span class="kd">::</span> <span class="n">YorkCalcModel</span>        <span class="o">=</span> <span class="mi">4</span>
<a name="ln-54"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>             <span class="kd">::</span> <span class="n">YorkCalcUserDefined</span>  <span class="o">=</span> <span class="mi">5</span>
<a name="ln-55"></a>
<a name="ln-56"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>             <span class="kd">::</span> <span class="n">EvapLossByUserFactor</span> <span class="o">=</span> <span class="mi">80</span>
<a name="ln-57"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>             <span class="kd">::</span> <span class="n">EvapLossByMoistTheory</span> <span class="o">=</span> <span class="mi">81</span>
<a name="ln-58"></a>
<a name="ln-59"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>             <span class="kd">::</span> <span class="n">BlowdownByConcentration</span> <span class="o">=</span> <span class="mi">90</span>
<a name="ln-60"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>             <span class="kd">::</span> <span class="n">BlowdownBySchedule</span> <span class="o">=</span> <span class="mi">91</span>
<a name="ln-61"></a>
<a name="ln-62"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cCoolingTower_SingleSpeed</span>  <span class="o">=</span><span class="s1">&#39;CoolingTower:SingleSpeed&#39;</span>
<a name="ln-63"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cCoolingTower_TwoSpeed</span>     <span class="o">=</span><span class="s1">&#39;CoolingTower:TwoSpeed&#39;</span>
<a name="ln-64"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cCoolingTower_VariableSpeed</span><span class="o">=</span><span class="s1">&#39;CoolingTower:VariableSpeed&#39;</span>
<a name="ln-65"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cCoolingTower_VariableSpeedMerkel</span><span class="o">=</span><span class="s1">&#39;CoolingTower:VariableSpeed:Merkel&#39;</span>
<a name="ln-66"></a>
<a name="ln-67"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PIM_NominalCapacity</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-68"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PIM_UFactor</span>              <span class="o">=</span> <span class="mi">2</span>
<a name="ln-69"></a>
<a name="ln-70"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingTower_SingleSpeed</span>  <span class="o">=</span> <span class="mi">1</span>
<a name="ln-71"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingTower_TwoSpeed</span>     <span class="o">=</span> <span class="mi">2</span>
<a name="ln-72"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingTower_VariableSpeed</span><span class="o">=</span> <span class="mi">3</span>
<a name="ln-73"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingTower_VariableSpeedMerkel</span><span class="o">=</span> <span class="mi">4</span>
<a name="ln-74"></a>
<a name="ln-75"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CapacityControl_FanCycling</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-76"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CapacityControl_FluidBypass</span><span class="o">=</span> <span class="mi">2</span>
<a name="ln-77"></a>
<a name="ln-78"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CellCtrl_MinCell</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-79"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CellCtrl_MaxCell</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-80"></a>
<a name="ln-81"></a>
<a name="ln-82"></a>
<a name="ln-83"></a>
<a name="ln-84"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-85"></a><span class="k">TYPE </span><span class="n">Towerspecs</span>
<a name="ln-86"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>                   <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! User identifier</span>
<a name="ln-87"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TowerType</span>              <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Type of cooling tower</span>
<a name="ln-88"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TowerType_Num</span>          <span class="o">=</span> <span class="mi">0</span>
<a name="ln-89"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Method of entering tower performance: UA and Design Water</span>
<a name="ln-90"></a>                                                               <span class="c">!  Flow Rate, or Nominal Capacity</span>
<a name="ln-91"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span><span class="kd">::</span> <span class="n">ModelCoeffObjectName</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Cooling Tower:Variable Speed Model Coefficient Object name</span>
<a name="ln-92"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">Available</span>                    <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! need an array of logicals--load identifiers of available equipment</span>
<a name="ln-93"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">ON</span>                           <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Simulate the machine at it&#39;s operating part load ratio</span>
<a name="ln-94"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignWaterFlowRate</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design water flow rate through the tower [m3/s]</span>
<a name="ln-95"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignWaterFlowPerUnitNomCap</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! scalable sizing factor for water flow per capacity [m3/s/W]</span>
<a name="ln-96"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesWaterMassFlowRate</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design water flow rate through the entire tower [kg/s]</span>
<a name="ln-97"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesWaterMassFlowRatePerCell</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design water flow rate per cell [Kg/s]</span>
<a name="ln-98"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HighSpeedAirFlowRate</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Air flow rate through tower at high speed [m3/s]</span>
<a name="ln-99"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignAirFlowPerUnitNomCap</span>      <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! scalable sizing factor for air flow per capacity [m3/s/W]</span>
<a name="ln-100"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">DefaultedDesignAirFlowScalingFactor</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! true if user left input field blank for DesignAirFlowPerUnitNomCap</span>
<a name="ln-101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HighSpeedFanPower</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Fan power at high fan speed [W]</span>
<a name="ln-102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignFanPowerPerUnitNomCap</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! scalable sizing factor for fan power per capacity [W/W]</span>
<a name="ln-103"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">UAvaluesCompleted</span>               <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HighSpeedTowerUA</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! UA of tower at high fan speed [W/C]</span>
<a name="ln-105"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LowSpeedAirFlowRate</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Air flow rate through tower at low speed [m3/s]</span>
<a name="ln-106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LowSpeedAirFlowRateSizingFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! sizing factor for low speed flow rate [ ]</span>
<a name="ln-107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LowSpeedFanPower</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Fan power at low fan speed [W]</span>
<a name="ln-108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LowSpeedFanPowerSizingFactor</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! sizing factor for low speed fan power []</span>
<a name="ln-109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LowSpeedTowerUA</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! UA of tower at low fan speed [W/C]</span>
<a name="ln-110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LowSpeedTowerUASizingFactor</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! sizing factor for UA at low fan speed []</span>
<a name="ln-111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FreeConvAirFlowRate</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Air flow rate through tower with fan off [m3/s]</span>
<a name="ln-112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FreeConvAirFlowRateSizingFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! sizing factor for air flow at free conv []</span>
<a name="ln-113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FreeConvTowerUA</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! UA of tower with fan off [W/C]</span>
<a name="ln-114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FreeConvTowerUASizingFactor</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! sizing factor for UA at fre convection []</span>
<a name="ln-115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignInletWB</span>                   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design inlet air wet-bulb temperature (C)</span>
<a name="ln-116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignApproach</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design approach (outlet water temp minus inlet air wet-bulb temp (C)</span>
<a name="ln-117"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DesignRange</span>                     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design range temperature (inlet water temp minus outlet water temp (C)</span>
<a name="ln-118"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MinimumVSAirFlowFrac</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Min air flow ratio (used for VS tower only, point where free conv occurs)</span>
<a name="ln-119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CalibratedWaterFlowRate</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Water flow ratio required for model calibration</span>
<a name="ln-120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">BasinHeaterPowerFTempDiff</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Basin heater capacity per degree C below setpoint (W/C)</span>
<a name="ln-121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">BasinHeaterSetPointTemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! setpoint temperature for basin heater operation (C)</span>
<a name="ln-122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MakeupWaterDrift</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Makeup water flow rate fraction due to drift</span>
<a name="ln-123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FreeConvectionCapacityFraction</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Percentage of tower capacity in free convection regime</span>
<a name="ln-124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerMassFlowRateMultiplier</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum tower flow rate is this multiplier times design flow rate</span>
<a name="ln-125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatRejectCapNomCapSizingRatio</span>  <span class="o">=</span> <span class="mf">1.25d0</span> <span class="c">! ratio of actual cap to nominal capacity []</span>
<a name="ln-126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerNominalCapacity</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Nominal capacity of the tower [W] with entering water at 35C (95F),</span>
<a name="ln-127"></a>                                                      <span class="c">!  leaving water at 29.44C (85F), entering air at 25.56C (78F) wet-bulb</span>
<a name="ln-128"></a>                                                      <span class="c">!  temp and 35C (95F) dry-bulb temp, and water flow</span>
<a name="ln-129"></a>                                                      <span class="c">!  rate of 5.382E-8 m3/s per watt (3 gpm/ton)</span>
<a name="ln-130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerLowSpeedNomCap</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Nominal capacity of the tower [W] with entering water at 35C (95F),</span>
<a name="ln-131"></a>                                                      <span class="c">!  leaving water at 29.44C (85F), entering air at 25.56C (78F) wet-bulb</span>
<a name="ln-132"></a>                                                      <span class="c">!  temp and 35C (95F) dry-bulb temp, and water flow</span>
<a name="ln-133"></a>                                                      <span class="c">!  rate of 5.382E-8 m3/s per nominal capacity watt (3 gpm/ton)</span>
<a name="ln-134"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerLowSpeedNomCapSizingFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! sizing factor for low speed capacity []</span>
<a name="ln-135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerFreeConvNomCap</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Nominal capacity of the tower [W] with entering water at 35C (95F),</span>
<a name="ln-136"></a>                                                      <span class="c">!  leaving water at 29.44C (85F), entering air at 25.56C (78F) wet-bulb</span>
<a name="ln-137"></a>                                                      <span class="c">!  temp and 35C (95F) dry-bulb temp, and water flow</span>
<a name="ln-138"></a>                                                      <span class="c">!  rate of 5.382E-8 m3/s per nominal capacity watt (3 gpm/ton)</span>
<a name="ln-139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerFreeConvNomCapSizingFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! sizing factor for free conv capacity []</span>
<a name="ln-140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SizFac</span>                          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!  sizing factor</span>
<a name="ln-141"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">WaterInletNodeNum</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the water inlet side of the tower</span>
<a name="ln-142"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">WaterOutletNodeNum</span>              <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number on the water outlet side of the tower</span>
<a name="ln-143"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">OutdoorAirInletNodeNum</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Node number of outdoor air inlet for the tower</span>
<a name="ln-144"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">TowerModelType</span>                  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Type of empirical model (1=CoolTools)</span>
<a name="ln-145"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">VSTower</span>                         <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to a variable speed tower (otherwise = 0)</span>
<a name="ln-146"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanPowerfAirFlowCurve</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to fan power correlation curve for VS Towers</span>
<a name="ln-147"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">BlowDownSchedulePtr</span>             <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Pointer to blow down schedule</span>
<a name="ln-148"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">BasinHeaterSchedulePtr</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Pointer to basin heater schedule</span>
<a name="ln-149"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HighMassFlowErrorCount</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter when mass flow rate is &gt; Design*TowerMassFlowRateMultiplier</span>
<a name="ln-150"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">HighMassFlowErrorIndex</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for high mass flow recurring error message</span>
<a name="ln-151"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">OutletWaterTempErrorCount</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter when outlet water temperature is &lt; minimum allowed temperature</span>
<a name="ln-152"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">OutletWaterTempErrorIndex</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for outlet water temperature recurring error message</span>
<a name="ln-153"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SmallWaterMassFlowErrorCount</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter when water mass flow rate is very small</span>
<a name="ln-154"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SmallWaterMassFlowErrorIndex</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for very small water mass flow rate recurring error message</span>
<a name="ln-155"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">WMFRLessThanMinAvailErrCount</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter when water mass flow rate is less than minimum available</span>
<a name="ln-156"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">WMFRLessThanMinAvailErrIndex</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for water mass flow rate less than minavail recurring message</span>
<a name="ln-157"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">WMFRGreaterThanMaxAvailErrCount</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter when water mass flow rate is greater than minimum available</span>
<a name="ln-158"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">WMFRGreaterThanMaxAvailErrIndex</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for water mass flow rate &gt; minavail recurring message</span>
<a name="ln-159"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolingTowerAFRRFailedCount</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for air flow rate ratio out of bounds error</span>
<a name="ln-160"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CoolingTowerAFRRFailedIndex</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for air flow rate ratio out of bounds error</span>
<a name="ln-161"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SpeedSelected</span>                   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! speed of the two-speed fan selected (0:ON;1:LOW;2:HIGH)</span>
<a name="ln-162"></a>  <span class="c">!fluid bypass</span>
<a name="ln-163"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CapacityControl</span>                 <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Type of capacity control for single speed cooling tower:</span>
<a name="ln-164"></a>                                                      <span class="c">!  0 - FanCycling, 1 - FluidBypass</span>
<a name="ln-165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">BypassFraction</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Fraction of fluid bypass as a ratio of total fluid flow</span>
<a name="ln-166"></a>                                                      <span class="c">!  through the tower sump</span>
<a name="ln-167"></a>  <span class="c">!multi cell tower</span>
<a name="ln-168"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">NumCell</span>                         <span class="o">=</span> <span class="mi">0</span> <span class="c">! Number of cells in the cooling tower</span>
<a name="ln-169"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CellCtrl</span>                <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Cell control type : either MaxCell or MinCell</span>
<a name="ln-170"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CellCtrl_Num</span>                    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-171"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">NumCellON</span>                       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! number of cells working</span>
<a name="ln-172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MinFracFlowRate</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Minimal fraction of design flow/cell allowable</span>
<a name="ln-173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">MaxFracFlowRate</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximal ratio of design flow/cell allowable</span>
<a name="ln-174"></a>
<a name="ln-175"></a>  <span class="c">!begin water system interactions</span>
<a name="ln-176"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">EvapLossMode</span>                    <span class="o">=</span> <span class="n">EvapLossByMoistTheory</span>  <span class="c">! sets how tower water evaporation is modeled</span>
<a name="ln-177"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UserEvapLossFactor</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! simple model [%/Delt C]</span>
<a name="ln-178"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DriftLossFraction</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-179"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">BlowdownMode</span>                    <span class="o">=</span> <span class="n">BlowdownByConcentration</span> <span class="c">! sets how tower water blowdown is modeled</span>
<a name="ln-180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ConcentrationRatio</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! ratio of solids in blowdown vs make up water</span>
<a name="ln-181"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SchedIDBlowdown</span>                 <span class="o">=</span> <span class="mi">0</span> <span class="c">! index &quot;pointer&quot; to schedule of blowdown in [m3/s]</span>
<a name="ln-182"></a>  <span class="kt">Logical</span>    <span class="kd">::</span> <span class="n">SuppliedByWaterSystem</span>           <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-183"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">WaterTankID</span>                     <span class="o">=</span> <span class="mi">0</span> <span class="c">! index &quot;pointer&quot; to WaterStorage structure</span>
<a name="ln-184"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">WaterTankDemandARRID</span>            <span class="o">=</span> <span class="mi">0</span> <span class="c">! index &quot;pointer&quot; to demand array inside WaterStorage structure</span>
<a name="ln-185"></a>
<a name="ln-186"></a>
<a name="ln-187"></a>  <span class="c">!end water system variables</span>
<a name="ln-188"></a>
<a name="ln-189"></a>  <span class="c">!loop topology variables</span>
<a name="ln-190"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">LoopNum</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-191"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">LoopSideNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-192"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">BranchNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-193"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CompNum</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-194"></a>
<a name="ln-195"></a>  <span class="c">!Merkel VS model curves</span>
<a name="ln-196"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">UAModFuncAirFlowRatioCurvePtr</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for UA modifier as a function of air flow ratio</span>
<a name="ln-197"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">UAModFuncWetbulbDiffCurvePtr</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for UA modifier as a function of local wetbulb</span>
<a name="ln-198"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">UAModFuncWaterFlowRatioCurvePtr</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for UA modifier as a function of water flow ratio</span>
<a name="ln-199"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">SetpointIsOnOutlet</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! if true look to outlet node of tower, if flase look to overall loop setpoint</span>
<a name="ln-200"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">VSMerkelAFRErrorIter</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! error counter for regula falsi failed with max iterations, vs merkel model</span>
<a name="ln-201"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">VSMerkelAFRErrorFail</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! error counter for regula falsi failed with limits exceeded, vs merkel model</span>
<a name="ln-202"></a>
<a name="ln-203"></a><span class="k">END TYPE </span><span class="n">Towerspecs</span>
<a name="ln-204"></a>
<a name="ln-205"></a><span class="k">TYPE </span><span class="n">TowerInletConds</span>
<a name="ln-206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower water inlet temperature (C)</span>
<a name="ln-207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower air inlet dry-bulb temperature (C)</span>
<a name="ln-208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirWetBulb</span>     <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower air inlet wet-bulb temperature (C)</span>
<a name="ln-209"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirPress</span>       <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower air barometric pressure</span>
<a name="ln-210"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirHumRat</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower air inlet humidity ratio (kg/kg)</span>
<a name="ln-211"></a><span class="k">END TYPE </span><span class="n">TowerInletConds</span>
<a name="ln-212"></a>
<a name="ln-213"></a><span class="k">TYPE </span><span class="n">ReportVars</span>
<a name="ln-214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletWaterTemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower inlet water temperature (C)</span>
<a name="ln-215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletWaterTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower outlet water temperature (C)</span>
<a name="ln-216"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WaterMassFlowRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower water mass flow rate (m3/s)</span>
<a name="ln-217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Qactual</span>                <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower heat rejection rate (W)</span>
<a name="ln-218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanPower</span>               <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower fan power (W)</span>
<a name="ln-219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanEnergy</span>              <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower fan energy consumption (J)</span>
<a name="ln-220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirFlowRatio</span>           <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Air flow ratio through variable speed cooling tower</span>
<a name="ln-221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">BasinHeaterPower</span>       <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Basin heater power (W)</span>
<a name="ln-222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">BasinHeaterConsumption</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Basin heater energy consumption (J)</span>
<a name="ln-223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WaterAmountUsed</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Tower make up water usage (m3)</span>
<a name="ln-224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanCyclingRatio</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! cycling ratio of tower fan when min fan speed provide too much capacity (for VFD)</span>
<a name="ln-225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EvaporationVdot</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EvaporationVol</span>         <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DriftVdot</span>              <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DriftVol</span>               <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">BlowdownVdot</span>           <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-230"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">BlowdownVol</span>            <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MakeUpVdot</span>             <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MakeUpVol</span>              <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-233"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TankSupplyVdot</span>         <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TankSupplyVol</span>          <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">StarvedMakeUpVdot</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">StarvedMakeUpVol</span>       <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!</span>
<a name="ln-237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">BypassFraction</span>         <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Added for fluid bypass</span>
<a name="ln-238"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">NumCellON</span>              <span class="o">=</span> <span class="mi">0</span>    <span class="c">! for multi-cell tower</span>
<a name="ln-239"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SpeedSelected</span>            <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Speed selected for the two speed tower</span>
<a name="ln-240"></a>
<a name="ln-241"></a><span class="k">END TYPE </span><span class="n">ReportVars</span>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="k">TYPE </span><span class="n">VSTowerData</span>
<a name="ln-244"></a><span class="c">! variables specific to variable-speed towers</span>
<a name="ln-245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Coeff</span>                       <span class="c">!- model coefficients</span>
<a name="ln-246"></a>  <span class="kt">LOGICAL</span>                         <span class="kd">::</span> <span class="n">FoundModelCoeff</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- TRUE if model is calibratable</span>
<a name="ln-247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">MinInletAirWBTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">!- model limit for min inlet air WB temp</span>
<a name="ln-248"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">MaxInletAirWBTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">!- model limit for max inlet air WB temp</span>
<a name="ln-249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">MinRangeTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">!- model limit for min range temp</span>
<a name="ln-250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">MaxRangeTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">!- model limit for max range temp</span>
<a name="ln-251"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">MinApproachTemp</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">!- model limit for min approach temp</span>
<a name="ln-252"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">MaxApproachTemp</span>   <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">!- model limit for max approach temp</span>
<a name="ln-253"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">MinWaterFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">!- model limit for min water flow rate ratio</span>
<a name="ln-254"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">MaxWaterFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">!- model limit for max water flow rate ratio</span>
<a name="ln-255"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">MaxLiquidToGasRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">!- model limit for max liquid to gas ratio</span>
<a name="ln-256"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">VSErrorCountFlowFrac</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">!- counter if water flow rate ratio limits are exceeded</span>
<a name="ln-257"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">VSErrorCountWFRR</span>  <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- counter if water flow rate ratio limits are exceeded</span>
<a name="ln-258"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">VSErrorCountIAWB</span>  <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- counter if inlet air wet-bulb temperature limits are exceeded</span>
<a name="ln-259"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">VSErrorCountTR</span>    <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- counter if tower range temperature limits are exceeded</span>
<a name="ln-260"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">VSErrorCountTA</span>    <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- counter if tower approach temperature limits are exceeded</span>
<a name="ln-261"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">ErrIndexFlowFrac</span>  <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- index to recurring error structure for liquid to gas ratio</span>
<a name="ln-262"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">ErrIndexWFRR</span>      <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- index to recurring error structure for water flow rate ratio</span>
<a name="ln-263"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">ErrIndexIAWB</span>      <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- index to recurring error structure for inlet air WB</span>
<a name="ln-264"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">ErrIndexTR</span>        <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- index to recurring error structure for tower range</span>
<a name="ln-265"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">ErrIndexTA</span>        <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- index to recurring error structure for tower approach</span>
<a name="ln-266"></a>  <span class="kt">INTEGER</span>                         <span class="kd">::</span> <span class="n">ErrIndexLG</span>        <span class="o">=</span> <span class="mi">0</span>       <span class="c">!- index to recurring error structure for tower liquid/gas ratio</span>
<a name="ln-267"></a>                                                                 <span class="c">!- Tr = Range temperature</span>
<a name="ln-268"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TrBuffer1</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print Tr warning messages on following time step</span>
<a name="ln-269"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TrBuffer2</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print Tr warning messages on following time step</span>
<a name="ln-270"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">TrBuffer3</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print Tr warning messages on following time step</span>
<a name="ln-271"></a>                                                                 <span class="c">!- Twb = Wet-bulb temperature</span>
<a name="ln-272"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TwbBuffer1</span>        <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print Twb warning messages on following time step</span>
<a name="ln-273"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TwbBuffer2</span>        <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print Twb warning messages on following time step</span>
<a name="ln-274"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">TwbBuffer3</span>        <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print Twb warning messages on following time step</span>
<a name="ln-275"></a>                                                                 <span class="c">!- Ta = Approach temperature</span>
<a name="ln-276"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TaBuffer1</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print Ta warning messages on following time step</span>
<a name="ln-277"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TaBuffer2</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print Ta warning messages on following time step</span>
<a name="ln-278"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">TaBuffer3</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print Ta warning messages on following time step</span>
<a name="ln-279"></a>                                                                 <span class="c">!- WFRR = Water flow rate ratio</span>
<a name="ln-280"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WFRRBuffer1</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print WFRR warning messages on following time step</span>
<a name="ln-281"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WFRRBuffer2</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print WFRR warning messages on following time step</span>
<a name="ln-282"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">WFRRBuffer3</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print WFRR warning messages on following time step</span>
<a name="ln-283"></a>                                                                 <span class="c">!- LG = Liquid to gas ratio</span>
<a name="ln-284"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">220</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LGBuffer1</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print LG warning messages on following time step</span>
<a name="ln-285"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">LGBuffer2</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print LG warning messages on following time step</span>
<a name="ln-286"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">LGBuffer3</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">!- buffer to print LG warning messages on following time step</span>
<a name="ln-287"></a>  <span class="kt">LOGICAL</span>                         <span class="kd">::</span> <span class="n">PrintTrMessage</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print Tr error message</span>
<a name="ln-288"></a>  <span class="kt">LOGICAL</span>                         <span class="kd">::</span> <span class="n">PrintTwbMessage</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print Twb error message</span>
<a name="ln-289"></a>  <span class="kt">LOGICAL</span>                         <span class="kd">::</span> <span class="n">PrintTaMessage</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print Ta error message</span>
<a name="ln-290"></a>  <span class="kt">LOGICAL</span>                         <span class="kd">::</span> <span class="n">PrintWFRRMessage</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print WFRR error message</span>
<a name="ln-291"></a>  <span class="kt">LOGICAL</span>                         <span class="kd">::</span> <span class="n">PrintLGMessage</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!- flag to print liquid-gas ratio error message</span>
<a name="ln-292"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">TrLast</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! value of Tr when warning occurred (passed to Recurring Warning)</span>
<a name="ln-293"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">TwbLast</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! value of Twb when warning occurred (passed to Recurring Warning)</span>
<a name="ln-294"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">TaLast</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! value of Ta when warning occurred (passed to Recurring Warning)</span>
<a name="ln-295"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">WaterFlowRateRatioLast</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! value of WFRR when warning occurred (passed to Recurring Warn)</span>
<a name="ln-296"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">LGLast</span>            <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! value of LG when warning occurred (passed to Recurring Warn)</span>
<a name="ln-297"></a><span class="k">END TYPE </span><span class="n">VSTowerData</span>
<a name="ln-298"></a>
<a name="ln-299"></a>  <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-300"></a><span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">NumSimpleTowers</span>          <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Number of similar towers</span>
<a name="ln-301"></a>
<a name="ln-302"></a><span class="c">!? The following block of variables are used to carry model results for a tower instance</span>
<a name="ln-303"></a><span class="c">!   across sim, update, and report routines.  Simulation manager must be careful</span>
<a name="ln-304"></a><span class="c">!   in models with multiple towers.</span>
<a name="ln-305"></a>
<a name="ln-306"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">InletWaterTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! CW temperature at tower inlet</span>
<a name="ln-307"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">OutletWaterTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! CW temperature at tower outlet</span>
<a name="ln-308"></a><span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">WaterInletNode</span>           <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Node number at tower inlet</span>
<a name="ln-309"></a><span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">WaterOutletNode</span>          <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Node number at tower outlet</span>
<a name="ln-310"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">WaterMassFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! WaterMassFlowRate through tower</span>
<a name="ln-311"></a>
<a name="ln-312"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Qactual</span>                  <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Tower heat transfer</span>
<a name="ln-313"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CTFanPower</span>               <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Tower fan power used</span>
<a name="ln-314"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">AirFlowRateRatio</span>         <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Ratio of air flow rate through VS cooling tower to design air flow rate</span>
<a name="ln-315"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">BasinHeaterPower</span>         <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Basin heater power use (W)</span>
<a name="ln-316"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">WaterUsage</span>               <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Tower water usage (m3/s)</span>
<a name="ln-317"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FanCyclingRatio</span>          <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! cycling ratio of tower fan when min fan speed provide to much capacity</span>
<a name="ln-318"></a>
<a name="ln-319"></a>
<a name="ln-320"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">Towerspecs</span><span class="p">),</span>      <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SimpleTower</span>         <span class="c">! dimension to number of machines</span>
<a name="ln-321"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">TowerInletConds</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SimpleTowerInlet</span>    <span class="c">! inlet conditions</span>
<a name="ln-322"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">ReportVars</span><span class="p">),</span>      <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SimpleTowerReport</span>   <span class="c">! report variables</span>
<a name="ln-323"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">VSTowerData</span><span class="p">),</span>     <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">VSTower</span>             <span class="c">! model coefficients and specific variables for VS tower</span>
<a name="ln-324"></a>
<a name="ln-325"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-326"></a>
<a name="ln-327"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE CondenserLoopTowers</span>
<a name="ln-328"></a>
<a name="ln-329"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-330"></a><span class="k">PUBLIC     </span><span class="n">SimTowers</span>             <span class="c">! PlantCondLoopSupplySideManager calls this top level Subroutine</span>
<a name="ln-331"></a>
<a name="ln-332"></a>          <span class="c">! Get Input routines for module</span>
<a name="ln-333"></a><span class="k">PRIVATE    </span><span class="n">GetTowerInput</span>         <span class="c">! Retrieves inputs for specified tower</span>
<a name="ln-334"></a>
<a name="ln-335"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-336"></a><span class="k">PRIVATE    </span><span class="n">InitTower</span>             <span class="c">! Initializes tower variables</span>
<a name="ln-337"></a><span class="k">PRIVATE    </span><span class="n">InitSimVars</span>           <span class="c">! Initializes model level variables</span>
<a name="ln-338"></a><span class="k">PRIVATE    </span><span class="n">SizeTower</span>             <span class="c">! Automatically sizes the cooling tower; also, calculates UA based on nominal capacity input(s)</span>
<a name="ln-339"></a><span class="k">PRIVATE    </span><span class="n">SizeVSMerkelTower</span>     <span class="c">! alternate sizing routine for VS merkel/shceier model.</span>
<a name="ln-340"></a>
<a name="ln-341"></a>          <span class="c">! Update routines to check convergence and update nodes</span>
<a name="ln-342"></a><span class="k">PRIVATE    </span><span class="n">SimSimpleTower</span>        <span class="c">! Calculates exiting water temperature of tower</span>
<a name="ln-343"></a><span class="k">PRIVATE    </span><span class="n">CalcSingleSpeedTower</span>  <span class="c">! Simulates a single speed tower using SimSimpleTower</span>
<a name="ln-344"></a><span class="k">PRIVATE    </span><span class="n">CalcTwoSpeedTower</span>     <span class="c">! Simulates a two speed tower using SimSimpleTower</span>
<a name="ln-345"></a><span class="k">PRIVATE    </span><span class="n">CalcMerkelVariableSpeedTower</span>
<a name="ln-346"></a><span class="k">PRIVATE    </span><span class="n">CalcVariableSpeedTower</span> <span class="c">! Simulates a variable speed tower using SimSimpleTower</span>
<a name="ln-347"></a><span class="k">PRIVATE    </span><span class="n">SimpleTowerUAResidual</span> <span class="c">! Given a design tower load and a UA, calculates a residual</span>
<a name="ln-348"></a><span class="k">PRIVATE    </span><span class="n">CalculateWaterUseage</span>  <span class="c">! calculates water consumed by the different towers</span>
<a name="ln-349"></a><span class="k">PRIVATE    </span><span class="n">UpdateTowers</span>          <span class="c">! Updates node information and checks mass flow rate</span>
<a name="ln-350"></a><span class="k">PRIVATE    </span><span class="n">ReportTowers</span>          <span class="c">! Outputs report variables</span>
<a name="ln-351"></a><span class="k">PRIVATE    </span><span class="n">CalcVSTowerApproach</span>   <span class="c">! Calculates approach temperature for variable speed towers</span>
<a name="ln-352"></a>
<a name="ln-353"></a><span class="k">CONTAINS</span>
<a name="ln-354"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-355"></a>
<a name="ln-356"></a><span class="c">! Beginning of CondenserLoopTowers Module Driver Subroutines</span>
<a name="ln-357"></a><span class="c">!*************************************************************************</span>
<a name="ln-358"></a>
<a name="ln-359"></a><span class="k">SUBROUTINE </span><span class="n">SimTowers</span><span class="p">(</span><span class="n">TowerType</span><span class="p">,</span><span class="n">TowerName</span><span class="p">,</span> <span class="n">CompIndex</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">,</span><span class="n">InitLoopEquip</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-360"></a>                     <span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">GetSizingFactor</span><span class="p">,</span><span class="n">SizingFactor</span><span class="p">)</span>
<a name="ln-361"></a>
<a name="ln-362"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-363"></a>          <span class="c">!       AUTHOR         Don Shirey</span>
<a name="ln-364"></a>          <span class="c">!       DATE WRITTEN   Dec. 2000</span>
<a name="ln-365"></a>          <span class="c">!       MODIFIED       Fred Buhl, May 2002; Richard Raustad, FSEC, Feb 2005 (added VS tower)</span>
<a name="ln-366"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-367"></a>
<a name="ln-368"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-369"></a>          <span class="c">! Main cooling tower driver subroutine.  Gets called from</span>
<a name="ln-370"></a>          <span class="c">! PlantLoopEquipments.</span>
<a name="ln-371"></a>
<a name="ln-372"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-373"></a>          <span class="c">! After being called by PlantLoopEquipments, this subroutine</span>
<a name="ln-374"></a>          <span class="c">! calls GetTowerInput to get all cooling tower input info (one time only),</span>
<a name="ln-375"></a>          <span class="c">! then calls the appropriate subroutine to calculate tower performance,</span>
<a name="ln-376"></a>          <span class="c">! update records (node info) and writes output report info.</span>
<a name="ln-377"></a>
<a name="ln-378"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-379"></a>          <span class="c">! na</span>
<a name="ln-380"></a>
<a name="ln-381"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-382"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-383"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantSizesOkayToFinalize</span>
<a name="ln-384"></a>
<a name="ln-385"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-386"></a>
<a name="ln-387"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-388"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TowerType</span>
<a name="ln-389"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TowerName</span>
<a name="ln-390"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-391"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">RunFlag</span>
<a name="ln-392"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">InitLoopEquip</span>
<a name="ln-393"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MyLoad</span>
<a name="ln-394"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OptCap</span>
<a name="ln-395"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MaxCap</span>
<a name="ln-396"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">MinCap</span>
<a name="ln-397"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">GetSizingFactor</span>  <span class="c">! TRUE when just the sizing factor is requested</span>
<a name="ln-398"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SizingFactor</span>     <span class="c">! sizing factor</span>
<a name="ln-399"></a>
<a name="ln-400"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-401"></a>          <span class="c">! na</span>
<a name="ln-402"></a>
<a name="ln-403"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-404"></a>          <span class="c">! na</span>
<a name="ln-405"></a>
<a name="ln-406"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-407"></a>          <span class="c">! na</span>
<a name="ln-408"></a>
<a name="ln-409"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-410"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>          <span class="kd">::</span> <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-411"></a>  <span class="kt">INTEGER</span>               <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-412"></a>
<a name="ln-413"></a>          <span class="c">!GET INPUT</span>
<a name="ln-414"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-415"></a><span class="k">    CALL </span><span class="n">GetTowerInput</span>
<a name="ln-416"></a>    <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-417"></a>  <span class="k">END IF</span>
<a name="ln-418"></a>
<a name="ln-419"></a>    <span class="c">! Find the correct CoolingTower</span>
<a name="ln-420"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-421"></a><span class="k">    </span><span class="n">TowerNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">TowerName</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumSimpleTowers</span><span class="p">)</span>
<a name="ln-422"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TowerNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-423"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimTowers: Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TowerName</span><span class="p">))</span>
<a name="ln-424"></a>    <span class="n">ENDIF</span>
<a name="ln-425"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">TowerNum</span>
<a name="ln-426"></a>  <span class="k">ELSE</span>
<a name="ln-427"></a><span class="k">    </span><span class="n">TowerNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-428"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TowerNum</span> <span class="o">&gt;</span> <span class="n">NumSimpleTowers</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">TowerNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-429"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimTowers:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-430"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-431"></a>                          <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumSimpleTowers</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-432"></a>                          <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TowerName</span><span class="p">))</span>
<a name="ln-433"></a>    <span class="n">ENDIF</span>
<a name="ln-434"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-435"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">TowerName</span> <span class="o">/=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-436"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimTowers: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-437"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-438"></a>                            <span class="s1">&#39;, Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TowerName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-439"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-440"></a>      <span class="n">ENDIF</span>
<a name="ln-441"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-442"></a>    <span class="n">ENDIF</span>
<a name="ln-443"></a>  <span class="n">ENDIF</span>
<a name="ln-444"></a>
<a name="ln-445"></a>          <span class="c">!INITIALIZE</span>
<a name="ln-446"></a>  <span class="k">CALL </span><span class="n">InitSimVars</span>
<a name="ln-447"></a>
<a name="ln-448"></a>          <span class="c">!CALCULATE</span>
<a name="ln-449"></a>  <span class="n">TypeOfEquip</span><span class="p">:</span>   <span class="p">&amp;</span>
<a name="ln-450"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span><span class="p">)</span>
<a name="ln-451"></a>
<a name="ln-452"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CoolingTower_SingleSpeed</span><span class="p">)</span>
<a name="ln-453"></a>
<a name="ln-454"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-455"></a><span class="k">          CALL </span><span class="n">InitTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-456"></a>          <span class="k">CALL </span><span class="n">SizeTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-457"></a>          <span class="n">MinCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-458"></a>          <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="p">&amp;</span>
<a name="ln-459"></a>                      <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-460"></a>          <span class="n">OptCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>
<a name="ln-461"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">GetSizingFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-462"></a><span class="k">            </span><span class="n">SizingFactor</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span>
<a name="ln-463"></a>          <span class="k">END IF</span>
<a name="ln-464"></a><span class="k">          RETURN</span>
<a name="ln-465"></a><span class="k">        END IF</span>
<a name="ln-466"></a><span class="k">        CALL </span><span class="n">InitTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-467"></a>        <span class="k">CALL </span><span class="n">CalcSingleSpeedTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-468"></a>        <span class="k">CALL </span><span class="n">CalculateWaterUseage</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-469"></a>        <span class="k">CALL </span><span class="n">UpdateTowers</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-470"></a>        <span class="k">CALL </span><span class="n">ReportTowers</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-471"></a>
<a name="ln-472"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CoolingTower_TwoSpeed</span><span class="p">)</span>
<a name="ln-473"></a>
<a name="ln-474"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-475"></a><span class="k">          CALL </span><span class="n">InitTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-476"></a>          <span class="k">CALL </span><span class="n">SizeTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-477"></a>          <span class="n">MinCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-478"></a>          <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="p">&amp;</span>
<a name="ln-479"></a>                      <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-480"></a>          <span class="n">OptCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>
<a name="ln-481"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">GetSizingFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-482"></a><span class="k">            </span><span class="n">SizingFactor</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span>
<a name="ln-483"></a>          <span class="k">END IF</span>
<a name="ln-484"></a><span class="k">          RETURN</span>
<a name="ln-485"></a><span class="k">        END IF</span>
<a name="ln-486"></a><span class="k">        CALL </span><span class="n">InitTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-487"></a>        <span class="k">CALL </span><span class="n">CalcTwoSpeedTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-488"></a>        <span class="k">CALL </span><span class="n">CalculateWaterUseage</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-489"></a>        <span class="k">CALL </span><span class="n">UpdateTowers</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-490"></a>        <span class="k">CALL </span><span class="n">ReportTowers</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-491"></a>
<a name="ln-492"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CoolingTower_VariableSpeedMerkel</span><span class="p">)</span>
<a name="ln-493"></a>
<a name="ln-494"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-495"></a><span class="k">          CALL </span><span class="n">InitTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-496"></a>          <span class="k">CALL </span><span class="n">SizeVSMerkelTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-497"></a>          <span class="n">MinCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-498"></a>          <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="p">&amp;</span>
<a name="ln-499"></a>                      <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-500"></a>          <span class="n">OptCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>
<a name="ln-501"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">GetSizingFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-502"></a><span class="k">            </span><span class="n">SizingFactor</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span>
<a name="ln-503"></a>          <span class="k">END IF</span>
<a name="ln-504"></a><span class="k">          RETURN</span>
<a name="ln-505"></a><span class="k">        END IF</span>
<a name="ln-506"></a><span class="k">        CALL </span><span class="n">InitTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-507"></a>        <span class="k">CALL </span><span class="n">CalcMerkelVariableSpeedTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-508"></a>        <span class="k">CALL </span><span class="n">CalculateWaterUseage</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-509"></a>        <span class="k">CALL </span><span class="n">UpdateTowers</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-510"></a>        <span class="k">CALL </span><span class="n">ReportTowers</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-511"></a>
<a name="ln-512"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CoolingTower_VariableSpeed</span><span class="p">)</span>
<a name="ln-513"></a>
<a name="ln-514"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-515"></a><span class="k">          CALL </span><span class="n">InitTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-516"></a>          <span class="k">CALL </span><span class="n">SizeTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-517"></a>          <span class="n">MinCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-518"></a>          <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="p">&amp;</span>
<a name="ln-519"></a>                      <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-520"></a>          <span class="n">OptCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>
<a name="ln-521"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">GetSizingFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-522"></a><span class="k">            </span><span class="n">SizingFactor</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span>
<a name="ln-523"></a>          <span class="k">END IF</span>
<a name="ln-524"></a><span class="k">          RETURN</span>
<a name="ln-525"></a><span class="k">        END IF</span>
<a name="ln-526"></a><span class="k">        CALL </span><span class="n">InitTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-527"></a>        <span class="k">CALL </span><span class="n">CalcVariableSpeedTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-528"></a>        <span class="k">CALL </span><span class="n">CalculateWaterUseage</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-529"></a>        <span class="k">CALL </span><span class="n">UpdateTowers</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-530"></a>        <span class="k">CALL </span><span class="n">ReportTowers</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-531"></a>
<a name="ln-532"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-533"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimTowers: Invalid Tower Type Requested=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TowerType</span><span class="p">))</span>
<a name="ln-534"></a>
<a name="ln-535"></a>    <span class="k">END SELECT </span><span class="n">TypeOfEquip</span>
<a name="ln-536"></a>
<a name="ln-537"></a><span class="k">RETURN</span>
<a name="ln-538"></a><span class="k">END SUBROUTINE </span><span class="n">SimTowers</span>
<a name="ln-539"></a>
<a name="ln-540"></a><span class="c">! End CondenserLoopTowers Module Driver Subroutines</span>
<a name="ln-541"></a><span class="c">!******************************************************************************</span>
<a name="ln-542"></a>
<a name="ln-543"></a>
<a name="ln-544"></a><span class="c">! Beginning of CondenserLoopTowers Module Get Input subroutines</span>
<a name="ln-545"></a><span class="c">!******************************************************************************</span>
<a name="ln-546"></a>
<a name="ln-547"></a><span class="k">SUBROUTINE </span><span class="n">GetTowerInput</span>
<a name="ln-548"></a>
<a name="ln-549"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-550"></a>          <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-551"></a>          <span class="c">!       DATE WRITTEN:    April 1998</span>
<a name="ln-552"></a>          <span class="c">!       MODIFIED         Don Shirey, Jan 2001 and Sept/Oct 2002; Richard Raustad, FSEC, Feb 2005 (added VS tower)</span>
<a name="ln-553"></a>          <span class="c">!                        B. Griffith, Aug. 2006 water consumption modeling and water system connections</span>
<a name="ln-554"></a>          <span class="c">!                        T Hong, Aug. 2008: added fluid bypass for single speed tower</span>
<a name="ln-555"></a>          <span class="c">!                        A Flament, July 2010, added multi-cell capability for the 3 types of cooling tower</span>
<a name="ln-556"></a>          <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-557"></a>
<a name="ln-558"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-559"></a>          <span class="c">! Obtains input data for cooling towers and stores it in SimpleTower data structure. Additional structure</span>
<a name="ln-560"></a>          <span class="c">! (VSTower) stores the coefficients for each VS tower.</span>
<a name="ln-561"></a>
<a name="ln-562"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-563"></a>          <span class="c">! Uses &quot;Get&quot; routines to read in the data.</span>
<a name="ln-564"></a>
<a name="ln-565"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-566"></a>          <span class="c">! na</span>
<a name="ln-567"></a>
<a name="ln-568"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-569"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">MakeUPPERCase</span>
<a name="ln-570"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>  <span class="c">! Data for field names, blank numerics</span>
<a name="ln-571"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-572"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-573"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-574"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveIndex</span>
<a name="ln-575"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-576"></a>  <span class="k">USE </span><span class="n">WaterManager</span> <span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupTankDemandComponent</span>
<a name="ln-577"></a>  <span class="k">USE </span><span class="n">OutAirNodeManager</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckOutAirNodeNumber</span>
<a name="ln-578"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-579"></a>
<a name="ln-580"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-581"></a>
<a name="ln-582"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-583"></a>          <span class="c">! na</span>
<a name="ln-584"></a>
<a name="ln-585"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-586"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OutputFormat</span>  <span class="o">=</span><span class="s1">&#39;(F5.2)&#39;</span>
<a name="ln-587"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-588"></a>
<a name="ln-589"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-590"></a>          <span class="c">! na</span>
<a name="ln-591"></a>
<a name="ln-592"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-593"></a>          <span class="c">! na</span>
<a name="ln-594"></a>
<a name="ln-595"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-596"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">TowerNum</span>                  <span class="c">! Tower number, reference counter for SimpleTower data array</span>
<a name="ln-597"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumSingleSpeedTowers</span>      <span class="c">! Total number of single-speed cooling towers</span>
<a name="ln-598"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">SingleSpeedTowerNumber</span>    <span class="c">! Specific single-speed tower of interest</span>
<a name="ln-599"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumTwoSpeedTowers</span>         <span class="c">! Number of two-speed cooling towers</span>
<a name="ln-600"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">TwoSpeedTowerNumber</span>       <span class="c">! Specific two-speed tower of interest</span>
<a name="ln-601"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumVariableSpeedTowers</span>    <span class="c">! Number of variable-speed cooling towers</span>
<a name="ln-602"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">VariableSpeedTowerNumber</span>  <span class="c">! Specific variable-speed tower of interest</span>
<a name="ln-603"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumVSCoolToolsModelCoeffs</span> <span class="c">! Number of CoolTools VS cooling tower coefficient objects</span>
<a name="ln-604"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumVSYorkCalcModelCoeffs</span>  <span class="c">! Number of YorkCalc VS cooling tower coefficient objects</span>
<a name="ln-605"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumVSMerkelTowers</span>         <span class="c">! Number of Merkel variable speed cooling towers</span>
<a name="ln-606"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">MerkelVSTowerNum</span>          <span class="c">! specific merkel variable speed tower of interest</span>
<a name="ln-607"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">VSModelCoeffNum</span>           <span class="c">! Specific variable-speed tower coefficient object of interest</span>
<a name="ln-608"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>                 <span class="c">! Number of elements in the alpha array</span>
<a name="ln-609"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>                   <span class="c">! Number of elements in the numeric array</span>
<a name="ln-610"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas2</span>                <span class="c">! Number of elements in the alpha2 array</span>
<a name="ln-611"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums2</span>                  <span class="c">! Number of elements in the numeric2 array</span>
<a name="ln-612"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>                    <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-613"></a>    <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">CoeffNum</span>                  <span class="c">! Index for reading user defined VS tower coefficients</span>
<a name="ln-614"></a>    <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsNotOK</span>                   <span class="c">! Flag to verify name</span>
<a name="ln-615"></a>    <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsBlank</span>                   <span class="c">! Flag for blank name</span>
<a name="ln-616"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>               <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>       <span class="c">! Logical flag set .true. if errors found while getting input data</span>
<a name="ln-617"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">OutputChar</span>                <span class="c">! report variable for warning messages</span>
<a name="ln-618"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">OutputCharLo</span>              <span class="c">! report variable for warning messages</span>
<a name="ln-619"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">OutputCharHi</span>              <span class="c">! report variable for warning messages</span>
<a name="ln-620"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">NumArray</span>                  <span class="c">! Numeric input data array</span>
<a name="ln-621"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">NumArray2</span>                 <span class="c">! Numeric input data array for VS tower coefficients</span>
<a name="ln-622"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlphArray</span>   <span class="c">! Character string input data array</span>
<a name="ln-623"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AlphArray2</span>  <span class="c">! Character string input data array for VS tower coefficients</span>
<a name="ln-624"></a>
<a name="ln-625"></a>  <span class="c">! Get number of all cooling towers specified in the input data file (idf)</span>
<a name="ln-626"></a>  <span class="n">NumSingleSpeedTowers</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCoolingTower_SingleSpeed</span><span class="p">)</span>
<a name="ln-627"></a>  <span class="n">NumTwoSpeedTowers</span>      <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCoolingTower_TwoSpeed</span><span class="p">)</span>
<a name="ln-628"></a>  <span class="n">NumVariableSpeedTowers</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCoolingTower_VariableSpeed</span><span class="p">)</span>
<a name="ln-629"></a>  <span class="n">NumVSMerkelTowers</span>      <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCoolingTower_VariableSpeedMerkel</span><span class="p">)</span>
<a name="ln-630"></a>  <span class="n">NumSimpleTowers</span>        <span class="o">=</span> <span class="n">NumSingleSpeedTowers</span> <span class="o">+</span> <span class="n">NumTwoSpeedTowers</span> <span class="o">+</span> <span class="n">NumVariableSpeedTowers</span> <span class="o">+</span> <span class="n">NumVSMerkelTowers</span>
<a name="ln-631"></a>
<a name="ln-632"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumSimpleTowers</span> <span class="o">&lt;=</span><span class="mi">0</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-633"></a>    <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;No Cooling Tower objects found in input, however, a branch object has specified a cooling tower. &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-634"></a>                        <span class="s1">&#39;Search the input for CoolingTower to determine the cause for this error.&#39;</span><span class="p">)</span>
<a name="ln-635"></a>
<a name="ln-636"></a>  <span class="c">! See if load distribution manager has already gotten the input</span>
<a name="ln-637"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">))</span><span class="k">RETURN</span>
<a name="ln-638"></a>
<a name="ln-639"></a>  <span class="c">! Allocate data structures to hold tower input data, report data and tower inlet conditions</span>
<a name="ln-640"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">NumSimpleTowers</span><span class="p">))</span>
<a name="ln-641"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">NumSimpleTowers</span><span class="p">))</span>
<a name="ln-642"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">NumSimpleTowers</span><span class="p">))</span>
<a name="ln-643"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumSimpleTowers</span><span class="p">))</span>
<a name="ln-644"></a>  <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-645"></a>  <span class="c">! Allocate variable-speed tower structure with data specific to this type</span>
<a name="ln-646"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">NumVariableSpeedTowers</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-647"></a><span class="k">    ALLOCATE</span> <span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">NumVariableSpeedTowers</span><span class="p">))</span>
<a name="ln-648"></a>  <span class="c">! Allow users to input model coefficients other than default</span>
<a name="ln-649"></a>    <span class="n">NumVSCoolToolsModelCoeffs</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;CoolingTowerPerformance:CoolTools&#39;</span><span class="p">)</span>
<a name="ln-650"></a>    <span class="n">NumVSYorkCalcModelCoeffs</span>  <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;CoolingTowerPerformance:YorkCalc&#39;</span><span class="p">)</span>
<a name="ln-651"></a>  <span class="k">END IF</span>
<a name="ln-652"></a>
<a name="ln-653"></a>  <span class="c">! Load data structures with cooling tower input data</span>
<a name="ln-654"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cCoolingTower_SingleSpeed</span>
<a name="ln-655"></a>  <span class="k">DO </span><span class="n">SingleSpeedTowerNumber</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumSingleSpeedTowers</span>
<a name="ln-656"></a>    <span class="n">TowerNum</span> <span class="o">=</span> <span class="n">SingleSpeedTowerNumber</span>
<a name="ln-657"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">SingleSpeedTowerNumber</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-658"></a>                       <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-659"></a>                    <span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-660"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-661"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-662"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TowerNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-663"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-664"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-665"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-666"></a>    <span class="n">ENDIF</span>
<a name="ln-667"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span>                     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-668"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span>                <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-669"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span>            <span class="o">=</span> <span class="n">CoolingTower_SingleSpeed</span>
<a name="ln-670"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerMassFlowRateMultiplier</span> <span class="o">=</span> <span class="mf">2.5d0</span>
<a name="ln-671"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>        <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-672"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-673"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-674"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>       <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-675"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-676"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-677"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Chilled Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-678"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-679"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-680"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-681"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span>         <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-682"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-683"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRateSizingFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-684"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-685"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUASizingFactor</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-686"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-687"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-688"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-689"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCapSizingFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-690"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-691"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;UFactorTimesAreaAndDesignWaterFlowRate&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-692"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="n">PIM_UFactor</span>
<a name="ln-693"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;NominalCapacity&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-694"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="n">PIM_NominalCapacity</span>
<a name="ln-695"></a>      <span class="k">ELSE</span>
<a name="ln-696"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-697"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-698"></a>        <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-699"></a>      <span class="n">ENDIF</span>
<a name="ln-700"></a>    <span class="k">ELSE</span>
<a name="ln-701"></a>     <span class="c">! Since Performance Input Method has been omitted then assume it to be UA and DESIGN WATER FLOW RATE</span>
<a name="ln-702"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="n">PIM_UFactor</span>
<a name="ln-703"></a>    <span class="n">ENDIF</span>
<a name="ln-704"></a>
<a name="ln-705"></a>    <span class="c">!   Basin heater power as a function of temperature must be greater than or equal to 0</span>
<a name="ln-706"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-707"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-708"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-709"></a>                     <span class="s1">&#39;&quot; basin heater power as a function of temperature difference must be &gt;= 0&#39;</span><span class="p">)</span>
<a name="ln-710"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-711"></a>    <span class="k">END IF</span>
<a name="ln-712"></a>
<a name="ln-713"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-714"></a>
<a name="ln-715"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-716"></a><span class="k">      IF</span><span class="p">(</span><span class="n">NumNums</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">14</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-717"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-718"></a>      <span class="n">ENDIF</span>
<a name="ln-719"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">simpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-720"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-721"></a>           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is less than 2 deg C. Freezing could occur.&#39;</span><span class="p">)</span>
<a name="ln-722"></a>      <span class="k">END IF</span>
<a name="ln-723"></a><span class="k">    END IF</span>
<a name="ln-724"></a>
<a name="ln-725"></a><span class="k">    IF</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Blank</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-726"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-727"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-728"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-729"></a>                       <span class="s1">&#39;&quot; basin heater schedule name &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-730"></a>                       <span class="o">//</span><span class="s1">&#39;&quot; was not found. Basin heater operation will not be modeled and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-731"></a>      <span class="k">END IF</span>
<a name="ln-732"></a><span class="k">    END IF</span>
<a name="ln-733"></a>
<a name="ln-734"></a>    <span class="c">! begin water use and systems get input</span>
<a name="ln-735"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;LossFactor&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-736"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByUserFactor</span>
<a name="ln-737"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;SaturatedExit&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-738"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByMoistTheory</span>
<a name="ln-739"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-740"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByMoistTheory</span>
<a name="ln-741"></a>    <span class="k">ELSE</span>
<a name="ln-742"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-743"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-744"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-745"></a>    <span class="n">ENDIF</span>
<a name="ln-746"></a>
<a name="ln-747"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UserEvapLossFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="c">!  N11 , \field Evaporation Loss Factor</span>
<a name="ln-748"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>  <span class="c">!  N12, \field Drift Loss Percent</span>
<a name="ln-749"></a>
<a name="ln-750"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-751"></a>      <span class="c">! assume Drift loss not entered and should be defaulted</span>
<a name="ln-752"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">=</span> <span class="mf">0.008d0</span> <span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-753"></a>    <span class="n">endif</span>
<a name="ln-754"></a>
<a name="ln-755"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="c">!  N13, \field Blowdown Concentration Ratio</span>
<a name="ln-756"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>             <span class="c">!  N17  \field Sizing Factor</span>
<a name="ln-757"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-758"></a>
<a name="ln-759"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="s1">&#39;ScheduledRate&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-760"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownBySchedule</span>
<a name="ln-761"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="s1">&#39;ConcentrationRatio&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-762"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownByConcentration</span>
<a name="ln-763"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-764"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownByConcentration</span>
<a name="ln-765"></a>      <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">17</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-766"></a>        <span class="c">! assume Concetratino ratio was omitted and should be defaulted</span>
<a name="ln-767"></a>            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">=</span> <span class="mf">3.0d0</span>
<a name="ln-768"></a>      <span class="n">endif</span>
<a name="ln-769"></a>    <span class="k">ELSE</span>
<a name="ln-770"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-771"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-772"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-773"></a>    <span class="n">ENDIF</span>
<a name="ln-774"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-775"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span> <span class="o">==</span> <span class="n">BlowdownBySchedule</span><span class="p">))</span><span class="k">Then</span>
<a name="ln-776"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-777"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-778"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-779"></a>    <span class="n">endif</span>
<a name="ln-780"></a>
<a name="ln-781"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-782"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-783"></a>    <span class="k">ELSE</span> <span class="c">! water from storage tank</span>
<a name="ln-784"></a>      <span class="c">!</span>
<a name="ln-785"></a>      <span class="k">Call </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-786"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankID</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankDemandARRID</span><span class="p">)</span>
<a name="ln-787"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-788"></a>    <span class="n">ENDIF</span>
<a name="ln-789"></a>
<a name="ln-790"></a><span class="c">!   outdoor air inlet node</span>
<a name="ln-791"></a>
<a name="ln-792"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-793"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-794"></a>    <span class="k">ELSE</span>
<a name="ln-795"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-796"></a>       <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-797"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-798"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-799"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-800"></a>                          <span class="s1">&#39;&quot; Outdoor Air Inlet Node Name not valid Outdoor Air Node= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-801"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-802"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-803"></a>      <span class="k">END IF</span>
<a name="ln-804"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-805"></a>
<a name="ln-806"></a><span class="c">!   fluid bypass for single speed tower</span>
<a name="ln-807"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-808"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CapacityControl</span> <span class="o">=</span> <span class="n">CapacityControl_FanCycling</span>     <span class="c">! FanCycling</span>
<a name="ln-809"></a>    <span class="k">ELSE</span>
<a name="ln-810"></a><span class="k">      SELECT CASE</span> <span class="p">(</span><span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-811"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FANCYCLING&#39;</span><span class="p">)</span>
<a name="ln-812"></a>          <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CapacityControl</span> <span class="o">=</span> <span class="n">CapacityControl_FanCycling</span>
<a name="ln-813"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FLUIDBYPASS&#39;</span><span class="p">)</span>
<a name="ln-814"></a>          <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CapacityControl</span> <span class="o">=</span> <span class="n">CapacityControl_FluidBypass</span>
<a name="ln-815"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-816"></a>          <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CapacityControl</span> <span class="o">=</span> <span class="n">CapacityControl_FanCycling</span>
<a name="ln-817"></a>          <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-818"></a>                       <span class="s1">&#39;&quot; The Capacity Control is not specified correctly. The default Fan Cycling is used.&#39;</span><span class="p">)</span>
<a name="ln-819"></a>      <span class="k">END SELECT</span>
<a name="ln-820"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-821"></a>
<a name="ln-822"></a>  <span class="c">!added for multi-cell</span>
<a name="ln-823"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>                  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-824"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-825"></a>      <span class="c">! assume Number of Cells not entered and should be defaulted</span>
<a name="ln-826"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-827"></a>    <span class="n">endif</span>
<a name="ln-828"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-829"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">19</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-830"></a>      <span class="c">! assume Cell Minimum Water Flow Rate Fraction not entered and should be defaulted</span>
<a name="ln-831"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">=</span> <span class="mf">0.33d0</span>
<a name="ln-832"></a>    <span class="n">endif</span>
<a name="ln-833"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-834"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-835"></a>      <span class="c">! assume Cell Maximum Water Flow Rate Fraction not entered and should be defaulted</span>
<a name="ln-836"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">=</span> <span class="mf">2.5d0</span>
<a name="ln-837"></a>    <span class="n">endif</span>
<a name="ln-838"></a>
<a name="ln-839"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">12</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-840"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-841"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-842"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-843"></a>      <span class="k">ELSE</span>
<a name="ln-844"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;MinimalCell&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-845"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;MaximalCell&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-846"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;MinimalCell&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-847"></a><span class="k">             </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MinCell</span>
<a name="ln-848"></a>             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span><span class="s1">&#39;MinimalCell&#39;</span>
<a name="ln-849"></a>          <span class="n">ENDIF</span>
<a name="ln-850"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s1">&#39;MaximalCell&#39;</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-851"></a><span class="k">             </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-852"></a>             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span><span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-853"></a>          <span class="n">ENDIF</span>
<a name="ln-854"></a>        <span class="k">ELSE</span>
<a name="ln-855"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-856"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-857"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-858"></a>        <span class="k">END IF</span>
<a name="ln-859"></a><span class="k">      END IF</span>
<a name="ln-860"></a><span class="k">    ELSE</span>
<a name="ln-861"></a>      <span class="c">!assume Cell Control not entered and should be defaulted</span>
<a name="ln-862"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-863"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-864"></a>    <span class="k">END IF</span>
<a name="ln-865"></a>
<a name="ln-866"></a><span class="c">!   High speed air flow rate must be greater than free convection air flow rate.</span>
<a name="ln-867"></a><span class="c">!   Can&#39;t tell yet if autosized, check later in InitTower.</span>
<a name="ln-868"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-869"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-870"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-871"></a>                            <span class="s1">&#39;&quot;. Free convection air flow rate must be less than the design air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-872"></a>       <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-873"></a>    <span class="n">ENDIF</span>
<a name="ln-874"></a>
<a name="ln-875"></a><span class="c">!   Check various inputs if Performance Input Method = &quot;UA and Design Water Flow Rate&quot;</span>
<a name="ln-876"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_UFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-877"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-878"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-879"></a>                              <span class="s1">&#39;&quot;. Tower performance input method requires a design water flow rate greater than zero.&#39;</span><span class="p">)</span>
<a name="ln-880"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-881"></a>      <span class="n">ENDIF</span>
<a name="ln-882"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-883"></a>          <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-884"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-885"></a>                              <span class="s1">&#39;&quot;. Free convection UA must be less than the design tower UA.&#39;</span><span class="p">)</span>
<a name="ln-886"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-887"></a>      <span class="n">ENDIF</span>
<a name="ln-888"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-889"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-890"></a>                  <span class="s1">&#39;&quot;. Free convection air flow rate must be greater than zero when free convection UA is greater than zero.&#39;</span><span class="p">)</span>
<a name="ln-891"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-892"></a>      <span class="k">END IF</span>
<a name="ln-893"></a><span class="k">    </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_NominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-894"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-895"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-896"></a>                              <span class="s1">&#39;&quot;. Tower performance input method requires valid nominal capacity.&#39;</span><span class="p">)</span>
<a name="ln-897"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-898"></a>      <span class="n">ENDIF</span>
<a name="ln-899"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-900"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-901"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-902"></a>                                <span class="s1">&#39;&quot;. Nominal capacity input method and design water flow rate have been specified.&#39;</span><span class="p">)</span>
<a name="ln-903"></a>         <span class="k">ELSE</span>
<a name="ln-904"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-905"></a>                         <span class="s1">&#39;&quot;. Nominal capacity input method has been specified and design water flow rate is being autosized.&#39;</span><span class="p">)</span>
<a name="ln-906"></a>         <span class="n">ENDIF</span>
<a name="ln-907"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Design water flow rate must be left blank when nominal tower capacity input method is used.&#39;</span><span class="p">)</span>
<a name="ln-908"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-909"></a>      <span class="n">ENDIF</span>
<a name="ln-910"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-911"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-912"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-913"></a>                                <span class="s1">&#39;&quot;. Nominal tower capacity and design tower UA have been specified.&#39;</span><span class="p">)</span>
<a name="ln-914"></a>         <span class="k">ELSE</span>
<a name="ln-915"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-916"></a>                                <span class="s1">&#39;&quot;. Nominal tower capacity has been specified and design tower UA is being autosized.&#39;</span><span class="p">)</span>
<a name="ln-917"></a>         <span class="n">ENDIF</span>
<a name="ln-918"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Design tower UA field must be left blank when nominal tower capacity input method is used.&#39;</span><span class="p">)</span>
<a name="ln-919"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-920"></a>      <span class="n">ENDIF</span>
<a name="ln-921"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-922"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-923"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-924"></a>                                <span class="s1">&#39;&quot;. Nominal capacity input method and free convection UA have been specified.&#39;</span><span class="p">)</span>
<a name="ln-925"></a>         <span class="k">ELSE</span>
<a name="ln-926"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-927"></a>                               <span class="s1">&#39;&quot;. Nominal capacity input method has been specified and free convection UA is being autosized.&#39;</span><span class="p">)</span>
<a name="ln-928"></a>         <span class="n">ENDIF</span>
<a name="ln-929"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Free convection UA should be left blank when nominal tower capacity input method is used.&#39;</span><span class="p">)</span>
<a name="ln-930"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-931"></a>      <span class="n">ENDIF</span>
<a name="ln-932"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">&gt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-933"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-934"></a>                              <span class="s1">&#39;&quot;. Free convection nominal capacity must be less than the nominal (design) tower capacity.&#39;</span><span class="p">)</span>
<a name="ln-935"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-936"></a>      <span class="k">END IF</span>
<a name="ln-937"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-938"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-939"></a>                  <span class="s1">&#39;&quot;. Free convection air flow must be greater than zero when tower free convection capacity is specified.&#39;</span><span class="p">)</span>
<a name="ln-940"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-941"></a>      <span class="k">END IF</span>
<a name="ln-942"></a><span class="k">    ELSE</span> <span class="c">! Tower performance input method is not specified as a valid &quot;choice&quot;</span>
<a name="ln-943"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-944"></a>                  <span class="s1">&#39;&quot;. Tower Performance Input Method must be &quot;UFactorTimesAreaAndDesignWaterFlowRate&quot; or &quot;NominalCapacity&quot;.&#39;</span><span class="p">)</span>
<a name="ln-945"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Tower Performanace Input Method currently specified as: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-946"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-947"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-948"></a>    <span class="n">ENDIF</span>
<a name="ln-949"></a>  <span class="k">END DO</span>  <span class="c">! End Single-Speed Tower Loop</span>
<a name="ln-950"></a>
<a name="ln-951"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cCoolingTower_TwoSpeed</span>
<a name="ln-952"></a>  <span class="k">DO </span><span class="n">TwoSpeedTowerNumber</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumTwoSpeedTowers</span>
<a name="ln-953"></a>    <span class="n">TowerNum</span> <span class="o">=</span> <span class="n">NumSingleSpeedTowers</span> <span class="o">+</span> <span class="n">TwoSpeedTowerNumber</span>
<a name="ln-954"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">TwoSpeedTowerNumber</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-955"></a>                       <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-956"></a>                    <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-957"></a>
<a name="ln-958"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-959"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-960"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TowerNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-961"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-962"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-963"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-964"></a>    <span class="n">ENDIF</span>
<a name="ln-965"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span>                  <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-966"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span>             <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-967"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span>         <span class="o">=</span> <span class="n">CoolingTower_TwoSpeed</span>
<a name="ln-968"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerMassFlowRateMultiplier</span> <span class="o">=</span> <span class="mf">2.5d0</span>
<a name="ln-969"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-970"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-971"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-972"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-973"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-974"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-975"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Chilled Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-976"></a>
<a name="ln-977"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-978"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;UFactorTimesAreaAndDesignWaterFlowRate&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-979"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="n">PIM_UFactor</span>
<a name="ln-980"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;NominalCapacity&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-981"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="n">PIM_NominalCapacity</span>
<a name="ln-982"></a>      <span class="k">ELSE</span>
<a name="ln-983"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-984"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-985"></a>        <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-986"></a>      <span class="n">ENDIF</span>
<a name="ln-987"></a>    <span class="k">ELSE</span>
<a name="ln-988"></a>     <span class="c">! Since Performance Input Method has been omitted then assume it to be UA and DESIGN WATER FLOW RATE</span>
<a name="ln-989"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="n">PIM_UFactor</span>
<a name="ln-990"></a>    <span class="n">ENDIF</span>
<a name="ln-991"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-992"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-993"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-994"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-995"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-996"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRateSizingFactor</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-997"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedFanPower</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-998"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedFanPowerSizingFactor</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-999"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1000"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUASizingFactor</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1001"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1002"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRateSizingFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1003"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-1004"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUASizingFactor</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-1005"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-1006"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-1007"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCap</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-1008"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCapSizingFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-1009"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-1010"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCapSizingFactor</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-1011"></a>
<a name="ln-1012"></a>    <span class="c">!   Basin heater power as a function of temperature must be greater than or equal to 0</span>
<a name="ln-1013"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-1014"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1015"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1016"></a>                      <span class="s1">&#39;&quot; basin heater power as a function of temperature difference must be &gt;= 0&#39;</span><span class="p">)</span>
<a name="ln-1017"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1018"></a>    <span class="k">END IF</span>
<a name="ln-1019"></a>
<a name="ln-1020"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-1021"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1022"></a><span class="k">      IF</span><span class="p">(</span><span class="n">NumNums</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">22</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1023"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-1024"></a>      <span class="n">ENDIF</span>
<a name="ln-1025"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">simpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1026"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1027"></a>           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is less than 2 deg C. Freezing could occur.&#39;</span><span class="p">)</span>
<a name="ln-1028"></a>      <span class="k">END IF</span>
<a name="ln-1029"></a><span class="k">    END IF</span>
<a name="ln-1030"></a>
<a name="ln-1031"></a><span class="k">    IF</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Blank</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1032"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-1033"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1034"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1035"></a>                       <span class="s1">&#39;&quot; basin heater schedule name &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1036"></a>                       <span class="o">//</span><span class="s1">&#39;&quot; was not found. Basin heater operation will not be modeled and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-1037"></a>      <span class="k">END IF</span>
<a name="ln-1038"></a><span class="k">    END IF</span>
<a name="ln-1039"></a>
<a name="ln-1040"></a>    <span class="c">! begin water use and systems get input</span>
<a name="ln-1041"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;LossFactor&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1042"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByUserFactor</span>
<a name="ln-1043"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;SaturatedExit&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1044"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByMoistTheory</span>
<a name="ln-1045"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1046"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByMoistTheory</span>
<a name="ln-1047"></a>    <span class="k">ELSE</span>
<a name="ln-1048"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1049"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1050"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1051"></a>    <span class="n">ENDIF</span>
<a name="ln-1052"></a>
<a name="ln-1053"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UserEvapLossFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="c">!  N23 , \field Evaporation Loss Factor</span>
<a name="ln-1054"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="mf">0.0d0</span>  <span class="c">!  N24, \field Drift Loss Percent</span>
<a name="ln-1055"></a>   <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-1056"></a>    <span class="c">! assume Drift loss not entered and should be defaulted</span>
<a name="ln-1057"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">=</span> <span class="mf">0.008d0</span> <span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-1058"></a>   <span class="n">endif</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="c">!  N17, \field Blowdown Concentration Ratio</span>
<a name="ln-1061"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>             <span class="c">!  N21  \field Sizing Factor</span>
<a name="ln-1062"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1063"></a>
<a name="ln-1064"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="s1">&#39;ScheduledRate&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1065"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownBySchedule</span>
<a name="ln-1066"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="s1">&#39;ConcentrationRatio&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1067"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownByConcentration</span>
<a name="ln-1068"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1069"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownByConcentration</span>
<a name="ln-1070"></a>      <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1071"></a>        <span class="c">! assume Concetration ratio was omitted and should be defaulted</span>
<a name="ln-1072"></a>            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">=</span> <span class="mf">3.0d0</span>
<a name="ln-1073"></a>      <span class="n">endif</span>
<a name="ln-1074"></a>    <span class="k">ELSE</span>
<a name="ln-1075"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1076"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1077"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1078"></a>    <span class="n">ENDIF</span>
<a name="ln-1079"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-1080"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span> <span class="o">==</span> <span class="n">BlowdownBySchedule</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-1081"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1082"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-1083"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1084"></a>    <span class="n">endif</span>
<a name="ln-1085"></a>
<a name="ln-1086"></a>  <span class="c">!added for multi-cell</span>
<a name="ln-1087"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>                  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
<a name="ln-1088"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">26</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-1089"></a>      <span class="c">! assume Number of Cells not entered and should be defaulted</span>
<a name="ln-1090"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1091"></a>    <span class="n">endif</span>
<a name="ln-1092"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<a name="ln-1093"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">27</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-1094"></a>      <span class="c">! assume Cell Minimum Water Flow Rate Fraction not entered and should be defaulted</span>
<a name="ln-1095"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">=</span> <span class="mf">0.33d0</span>
<a name="ln-1096"></a>    <span class="n">endif</span>
<a name="ln-1097"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
<a name="ln-1098"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">28</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-1099"></a>      <span class="c">! assume Cell Maximum Water Flow Rate Fraction not entered and should be defaulted</span>
<a name="ln-1100"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">=</span> <span class="mf">2.5d0</span>
<a name="ln-1101"></a>    <span class="n">endif</span>
<a name="ln-1102"></a>
<a name="ln-1103"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">11</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1104"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1105"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-1106"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-1107"></a>      <span class="k">ELSE</span>
<a name="ln-1108"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="s1">&#39;MinimalCell&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1109"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="s1">&#39;MaximalCell&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1110"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="s1">&#39;MinimalCell&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1111"></a><span class="k">             </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MinCell</span>
<a name="ln-1112"></a>             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MinimalCell&#39;</span>
<a name="ln-1113"></a>          <span class="n">ENDIF</span>
<a name="ln-1114"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="s1">&#39;MaximalCell&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1115"></a><span class="k">             </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-1116"></a>             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-1117"></a>          <span class="n">ENDIF</span>
<a name="ln-1118"></a>        <span class="k">ELSE</span>
<a name="ln-1119"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-1120"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1121"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1122"></a>        <span class="k">END IF</span>
<a name="ln-1123"></a><span class="k">      END IF</span>
<a name="ln-1124"></a><span class="k">    ELSE</span>
<a name="ln-1125"></a>      <span class="c">!assume Cell Control not entered and should be defaulted</span>
<a name="ln-1126"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-1127"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-1128"></a>    <span class="k">END IF</span>
<a name="ln-1129"></a>
<a name="ln-1130"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1131"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1132"></a>    <span class="k">ELSE</span> <span class="c">! water from storage tank</span>
<a name="ln-1133"></a>      <span class="c">!</span>
<a name="ln-1134"></a>      <span class="k">Call </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1135"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankID</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankDemandARRID</span><span class="p">)</span>
<a name="ln-1136"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1137"></a>    <span class="n">ENDIF</span>
<a name="ln-1138"></a>
<a name="ln-1139"></a><span class="c">!   outdoor air inlet node</span>
<a name="ln-1140"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1141"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1142"></a>    <span class="k">ELSE</span>
<a name="ln-1143"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1144"></a>       <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1145"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1146"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1147"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1148"></a>                          <span class="s1">&#39;&quot; Outdoor Air Inlet Node Name not valid Outdoor Air Node= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-1149"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-1150"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1151"></a>      <span class="k">END IF</span>
<a name="ln-1152"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-1153"></a>
<a name="ln-1154"></a>
<a name="ln-1155"></a>
<a name="ln-1156"></a><span class="c">!   High speed air flow rate must be greater than low speed air flow rate.</span>
<a name="ln-1157"></a><span class="c">!   Can&#39;t tell yet if autosized, check later in InitTower.</span>
<a name="ln-1158"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1159"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1160"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1161"></a>                            <span class="s1">&#39;&quot;. Low speed air flow rate must be less than the high speed air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-1162"></a>       <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1163"></a>    <span class="n">ENDIF</span>
<a name="ln-1164"></a><span class="c">!   Low speed air flow rate must be greater than free convection air flow rate.</span>
<a name="ln-1165"></a><span class="c">!   Can&#39;t tell yet if autosized, check later in InitTower.</span>
<a name="ln-1166"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1167"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1168"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1169"></a>                            <span class="s1">&#39;&quot;. Free convection air flow rate must be less than the low speed air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-1170"></a>       <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1171"></a>    <span class="n">ENDIF</span>
<a name="ln-1172"></a>
<a name="ln-1173"></a><span class="c">!   Check various inputs if Performance Input Method = &quot;UA and Design Water Flow Rate&quot;</span>
<a name="ln-1174"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_UFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1175"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1176"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1177"></a>                              <span class="s1">&#39;&quot;. Tower performance input method requires a design water flow rate greater than zero.&#39;</span><span class="p">)</span>
<a name="ln-1178"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1179"></a>      <span class="n">ENDIF</span>
<a name="ln-1180"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1181"></a>          <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1182"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1183"></a>                              <span class="s1">&#39;&quot;. Tower UA at low fan speed must be less than the tower UA at high fan speed.&#39;</span><span class="p">)</span>
<a name="ln-1184"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1185"></a>      <span class="n">ENDIF</span>
<a name="ln-1186"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1187"></a>          <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1188"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1189"></a>                            <span class="s1">&#39;&quot;. Tower UA at free convection air flow rate must be less than the tower UA at low fan speed.&#39;</span><span class="p">)</span>
<a name="ln-1190"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1191"></a>      <span class="n">ENDIF</span>
<a name="ln-1192"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1193"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1194"></a>                  <span class="s1">&#39;&quot;. Free convection air flow rate must be greater than zero when free convection UA is greater than zero.&#39;</span><span class="p">)</span>
<a name="ln-1195"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1196"></a>      <span class="k">END IF</span>
<a name="ln-1197"></a><span class="k">    </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_NominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1198"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1199"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1200"></a>                              <span class="s1">&#39;&quot;. Tower performance input method requires valid high-speed nominal capacity.&#39;</span><span class="p">)</span>
<a name="ln-1201"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1202"></a>      <span class="n">ENDIF</span>
<a name="ln-1203"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCap</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1204"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1205"></a>                              <span class="s1">&#39;&quot;. Tower performance input method requires valid low-speed nominal capacity.&#39;</span><span class="p">)</span>
<a name="ln-1206"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1207"></a>      <span class="n">ENDIF</span>
<a name="ln-1208"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1209"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1210"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1211"></a>                                <span class="s1">&#39;&quot;. Nominal capacity input method and design water flow rate have been specified.&#39;</span><span class="p">)</span>
<a name="ln-1212"></a>         <span class="k">ELSE</span>
<a name="ln-1213"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1214"></a>                <span class="s1">&#39;&quot;. Nominal capacity input method has been specified and design water flow rate is being autosized.&#39;</span><span class="p">)</span>
<a name="ln-1215"></a>         <span class="n">ENDIF</span>
<a name="ln-1216"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Design water flow rate must be left blank when nominal tower capacity input method is used.&#39;</span><span class="p">)</span>
<a name="ln-1217"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1218"></a>      <span class="n">ENDIF</span>
<a name="ln-1219"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1220"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1221"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1222"></a>                                <span class="s1">&#39;&quot;. Nominal capacity input method and tower UA at high fan speed have been specified.&#39;</span><span class="p">)</span>
<a name="ln-1223"></a>         <span class="k">ELSE</span>
<a name="ln-1224"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1225"></a>                <span class="s1">&#39;&quot;. Nominal capacity input method has been specified and tower UA at high fan speed is being autosized.&#39;</span><span class="p">)</span>
<a name="ln-1226"></a>         <span class="n">ENDIF</span>
<a name="ln-1227"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Tower UA at high fan speed must be left blank when nominal tower capacity input method&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1228"></a>                                <span class="s1">&#39; is used.&#39;</span><span class="p">)</span>
<a name="ln-1229"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1230"></a>      <span class="n">ENDIF</span>
<a name="ln-1231"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1232"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1233"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1234"></a>                                <span class="s1">&#39;&quot;. Nominal capacity input method and tower UA at low fan speed have been specified.&#39;</span><span class="p">)</span>
<a name="ln-1235"></a>         <span class="k">ELSE</span>
<a name="ln-1236"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1237"></a>                <span class="s1">&#39;&quot;. Nominal capacity input method has been specified and tower UA at low fan speed is being autosized.&#39;</span><span class="p">)</span>
<a name="ln-1238"></a>         <span class="n">ENDIF</span>
<a name="ln-1239"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Tower UA at low fan speed must be left blank when nominal tower capacity input method&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1240"></a>                                <span class="s1">&#39; is used.&#39;</span><span class="p">)</span>
<a name="ln-1241"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1242"></a>      <span class="n">ENDIF</span>
<a name="ln-1243"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1244"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1245"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1246"></a>                                <span class="s1">&#39;&quot;. Nominal capacity input method and free convection UA have been specified.&#39;</span><span class="p">)</span>
<a name="ln-1247"></a>         <span class="k">ELSE</span>
<a name="ln-1248"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1249"></a>                              <span class="s1">&#39;&quot;. Nominal capacity input method has been specified and free convection UA is being autosized.&#39;</span><span class="p">)</span>
<a name="ln-1250"></a>         <span class="n">ENDIF</span>
<a name="ln-1251"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Free convection UA should be left blank when nominal tower capacity input method is used.&#39;</span><span class="p">)</span>
<a name="ln-1252"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1253"></a>      <span class="n">ENDIF</span>
<a name="ln-1254"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCap</span> <span class="o">&gt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1255"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1256"></a>                              <span class="s1">&#39;&quot;. Low-speed nominal capacity must be less than the high-speed nominal capacity.&#39;</span><span class="p">)</span>
<a name="ln-1257"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1258"></a>      <span class="k">END IF</span>
<a name="ln-1259"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">&gt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCap</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1260"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1261"></a>                              <span class="s1">&#39;&quot;. Free convection nominal capacity must be less than the low-speed nominal capacity.&#39;</span><span class="p">)</span>
<a name="ln-1262"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1263"></a>      <span class="k">END IF</span>
<a name="ln-1264"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1265"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1266"></a>                  <span class="s1">&#39;&quot;. Free convection air flow must be greater than zero when tower free convection capacity is specified.&#39;</span><span class="p">)</span>
<a name="ln-1267"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1268"></a>      <span class="k">END IF</span>
<a name="ln-1269"></a><span class="k">    ELSE</span> <span class="c">! Tower performance input method is not specified as a valid &quot;choice&quot;</span>
<a name="ln-1270"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1271"></a>                  <span class="s1">&#39;&quot;. Tower Performance Input Method must be &quot;UFactorTimesAreaAndDesignWaterFlowRate&quot; or &quot;NominalCapacity&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1272"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Tower Performanace Input Method currently specified as: &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1273"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1274"></a>         <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1275"></a>    <span class="n">ENDIF</span>
<a name="ln-1276"></a>  <span class="k">END DO</span>  <span class="c">! End Two-Speed Tower Loop</span>
<a name="ln-1277"></a>
<a name="ln-1278"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cCoolingTower_VariableSpeed</span>
<a name="ln-1279"></a>  <span class="k">DO </span><span class="n">VariableSpeedTowerNumber</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumVariableSpeedTowers</span>
<a name="ln-1280"></a>    <span class="n">TowerNum</span> <span class="o">=</span> <span class="n">NumSingleSpeedTowers</span> <span class="o">+</span> <span class="n">NumTwoSpeedTowers</span> <span class="o">+</span> <span class="n">VariableSpeedTowerNumber</span>
<a name="ln-1281"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">VariableSpeedTowerNumber</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1282"></a>                       <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1283"></a>                    <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1284"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1285"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1286"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TowerNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1287"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1288"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1289"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1290"></a>    <span class="n">ENDIF</span>
<a name="ln-1291"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span>            <span class="o">=</span> <span class="n">VariableSpeedTowerNumber</span>
<a name="ln-1292"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span>               <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1293"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span>          <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-1294"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span>      <span class="o">=</span> <span class="n">CoolingTower_VariableSpeed</span>
<a name="ln-1295"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1296"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1297"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1298"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1299"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1300"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1301"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Chilled Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-1302"></a>
<a name="ln-1303"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;CoolToolsUserDefined&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;YorkCalcUserDefined&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1304"></a>        <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-1305"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1306"></a>                       <span class="s1">&#39;&quot; a &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be specified when &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1307"></a>                       <span class="s1">&#39; is specified as CoolToolsUserDefined or YorkCalcUserDefined&#39;</span><span class="p">)</span>
<a name="ln-1308"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1309"></a>    <span class="n">ELSEIF</span><span class="p">((</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;CoolToolsCrossFlow&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1310"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;YorkCalc&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-1311"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1312"></a>                       <span class="s1">&#39;&quot; a Tower Model Coefficient Name is specified and the Tower Model Type&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1313"></a>                       <span class="s1">&#39; is not specified as CoolToolsUserDefined or YorkCalcUserDefined. The &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1314"></a>                       <span class="s1">&#39;CoolingTowerPerformance:CoolTools (orCoolingTowerPerformance:YorkCalc) data object will not be used.&#39;</span><span class="p">)</span>
<a name="ln-1315"></a>    <span class="k">ELSE</span>
<a name="ln-1316"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ModelCoeffObjectName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1317"></a>    <span class="k">END IF</span>
<a name="ln-1318"></a>
<a name="ln-1319"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-1320"></a><span class="k">     </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1321"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1322"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1323"></a>                       <span class="s1">&#39;&quot; the Fan Power Ratio as a function of Air Flow Rate Ratio Curve Name specified as &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1324"></a>                       <span class="o">//</span><span class="s1">&#39; was not found. Fan Power as a function of Air Flow Rate Ratio will default to Fan Power = (Air&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1325"></a>                       <span class="s1">&#39; Flow Rate Ratio)^3 and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-1326"></a>     <span class="k">END IF</span>
<a name="ln-1327"></a><span class="k">    END IF</span>
<a name="ln-1328"></a>
<a name="ln-1329"></a><span class="k">    ALLOCATE</span> <span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">VariableSpeedTowerNumber</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<a name="ln-1330"></a>    <span class="n">VSTower</span><span class="p">(</span><span class="n">VariableSpeedTowerNumber</span><span class="p">)%</span><span class="n">Coeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1331"></a>
<a name="ln-1332"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;CoolToolsCrossFlow&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1333"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span>               <span class="o">=</span> <span class="n">CoolToolsXFModel</span>
<a name="ln-1334"></a><span class="c">!     set cross-flow model coefficients</span>
<a name="ln-1335"></a><span class="c">!       Outputs approach in F</span>
<a name="ln-1336"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(1)  = -2.1985908408527</span>
<a name="ln-1337"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(2)  = -24.3108065555106</span>
<a name="ln-1338"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(3)  = 21.9333667825398</span>
<a name="ln-1339"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(4)  = -4.94979078884808</span>
<a name="ln-1340"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(5)  = 14.6788552214526</span>
<a name="ln-1341"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(6)  = -15.4612468065777</span>
<a name="ln-1342"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(7)  = 2.83753688605444</span>
<a name="ln-1343"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(8)  = 10.0023162199558</span>
<a name="ln-1344"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(9)  = 2.70780345372045</span>
<a name="ln-1345"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(10) = -5.91993527180418</span>
<a name="ln-1346"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(11) = 0.194222288920726</span>
<a name="ln-1347"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(12) = 0.142543400927955</span>
<a name="ln-1348"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(13) = -0.0818947291400898</span>
<a name="ln-1349"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(14) = -0.169584760441541</span>
<a name="ln-1350"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(15) = 0.0186741309635284</span>
<a name="ln-1351"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(16) = 0.0536824177590012</span>
<a name="ln-1352"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(17) = -0.00375848174056975</span>
<a name="ln-1353"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(18) = 0.000623763881051551</span>
<a name="ln-1354"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(19) = -0.000709769430542879</span>
<a name="ln-1355"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(20) = 0.0000234697776728891</span>
<a name="ln-1356"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(21) = 2.45541543720225</span>
<a name="ln-1357"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(22) = -0.607566456611435</span>
<a name="ln-1358"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(23) = 0.117339576910507</span>
<a name="ln-1359"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(24) = 1.64648551160799</span>
<a name="ln-1360"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(25) = -0.135898905926974</span>
<a name="ln-1361"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(26) = -0.152577581866506</span>
<a name="ln-1362"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(27) = -0.034055419164321</span>
<a name="ln-1363"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(28) = 0.00274052705314173</span>
<a name="ln-1364"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(29) = -0.00442366885652332</span>
<a name="ln-1365"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(30) = 0.0000687098236486247</span>
<a name="ln-1366"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(31) = -0.0416435261408276</span>
<a name="ln-1367"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(32) = 0.00263481599534274</span>
<a name="ln-1368"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(33) = -0.010325259545311</span>
<a name="ln-1369"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(34) = 0.000356999078067433</span>
<a name="ln-1370"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(35) = 0.000249188476685273</span>
<a name="ln-1371"></a>
<a name="ln-1372"></a><span class="c">!       Outputs approach in C</span>
<a name="ln-1373"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span>   <span class="mf">0.52049709836241d0</span>
<a name="ln-1374"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="mf">0.617046395344d0</span>
<a name="ln-1375"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mi">1</span><span class="mf">0.7292974722538d0</span>
<a name="ln-1376"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span>  <span class="o">-</span><span class="mf">2.74988377158227d0</span>
<a name="ln-1377"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span>   <span class="mf">4.73629943913743d0</span>
<a name="ln-1378"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span>  <span class="o">-</span><span class="mf">8.25759700874711d0</span>
<a name="ln-1379"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span>   <span class="mf">1.57640938114136d0</span>
<a name="ln-1380"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span>   <span class="mf">6.51119643791324d0</span>
<a name="ln-1381"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="o">=</span>   <span class="mf">1.50433525206692d0</span>
<a name="ln-1382"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">3.2888529287801d0</span>
<a name="ln-1383"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.0257786145353773d0</span>
<a name="ln-1384"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.182464289315254d0</span>
<a name="ln-1385"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.0818947291400898d0</span>
<a name="ln-1386"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.215010003996285d0</span>
<a name="ln-1387"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.0186741309635284d0</span>
<a name="ln-1388"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.0536824177590012d0</span>
<a name="ln-1389"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.00270968955115031d0</span>
<a name="ln-1390"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.00112277498589279d0</span>
<a name="ln-1391"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.00127758497497718d0</span>
<a name="ln-1392"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.0000760420796601607d0</span>
<a name="ln-1393"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">1.43600088336017d0</span>
<a name="ln-1394"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.5198695909109d0</span>
<a name="ln-1395"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.117339576910507d0</span>
<a name="ln-1396"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">1.50492810819924d0</span>
<a name="ln-1397"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.135898905926974d0</span>
<a name="ln-1398"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.152577581866506d0</span>
<a name="ln-1399"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.0533843828114562d0</span>
<a name="ln-1400"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.00493294869565511d0</span>
<a name="ln-1401"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.00796260394174197d0</span>
<a name="ln-1402"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.000222619828621544d0</span>
<a name="ln-1403"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.0543952001568055d0</span>
<a name="ln-1404"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.00474266879161693d0</span>
<a name="ln-1405"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">0.0185854671815598d0</span>
<a name="ln-1406"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.00115667701293848d0</span>
<a name="ln-1407"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span> <span class="o">=</span>   <span class="mf">0.000807370664460284d0</span>
<a name="ln-1408"></a>
<a name="ln-1409"></a><span class="c">!       set minimum and maximum boundaries for CoolTools crossflow model input variables</span>
<a name="ln-1410"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>
<a name="ln-1411"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">6.6667d0</span>
<a name="ln-1412"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span>      <span class="o">=</span> <span class="mf">1.1111d0</span>
<a name="ln-1413"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span>      <span class="o">=</span> <span class="mi">1</span><span class="mf">1.1111d0</span>
<a name="ln-1414"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span>   <span class="o">=</span> <span class="mf">1.1111d0</span>
<a name="ln-1415"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span>   <span class="o">=</span> <span class="mi">1</span><span class="mf">1.1111d0</span>
<a name="ln-1416"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span> <span class="o">=</span> <span class="mf">0.75d0</span>
<a name="ln-1417"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span> <span class="o">=</span> <span class="mf">1.25d0</span>
<a name="ln-1418"></a>
<a name="ln-1419"></a><span class="c">!    CoolTools counterflow model does not work properly. The empirical model seems flawed since the tower</span>
<a name="ln-1420"></a><span class="c">!    operates in the free convection regime on the design day.</span>
<a name="ln-1421"></a><span class="c">!    ELSEIF(SameString(AlphArray(5),&#39;COOLTOOLS COUNTERFLOW&#39;))THEN</span>
<a name="ln-1422"></a><span class="c">!      SimpleTower(TowerNum)%TowerModelType               = CoolToolsCFModel</span>
<a name="ln-1423"></a><span class="c">!!     set counter-flow model coefficients</span>
<a name="ln-1424"></a><span class="c">!!       Outputs approach in F</span>
<a name="ln-1425"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(1)  = -4.48760943345722</span>
<a name="ln-1426"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(2)  = 0.741749875850003</span>
<a name="ln-1427"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(3)  = 1.74679844252553</span>
<a name="ln-1428"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(4)  = -0.397320959632943</span>
<a name="ln-1429"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(5)  = 19.5106208955792</span>
<a name="ln-1430"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(6)  = -9.79489761472574</span>
<a name="ln-1431"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(7)  = 1.96690857354709</span>
<a name="ln-1432"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(8)  = -1.40803729637148</span>
<a name="ln-1433"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(9)  = 0.633867141219563</span>
<a name="ln-1434"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(10) = -0.517255742412696</span>
<a name="ln-1435"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(11) = 0.0546335532842876</span>
<a name="ln-1436"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(12) = 0.0468060318806566</span>
<a name="ln-1437"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(13) = -0.0244033403339062</span>
<a name="ln-1438"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(14) = -0.267365212754448</span>
<a name="ln-1439"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(15) = 0.0385664546399435</span>
<a name="ln-1440"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(16) = 0.037765628073743</span>
<a name="ln-1441"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(17) = -0.000928698541521428</span>
<a name="ln-1442"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(18) = -0.000122211107650076</span>
<a name="ln-1443"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(19) = 0.000682937021895334</span>
<a name="ln-1444"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(20) = 0.00000679217734960548</span>
<a name="ln-1445"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(21) = 1.47274732178792</span>
<a name="ln-1446"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(22) = -0.869303590626237</span>
<a name="ln-1447"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(23) = 0.149995781695274</span>
<a name="ln-1448"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(24) = 2.4548219494635</span>
<a name="ln-1449"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(25) = -0.161092120908292</span>
<a name="ln-1450"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(26) = -0.0830303891087807</span>
<a name="ln-1451"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(27) = -0.0251101427687245</span>
<a name="ln-1452"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(28) = 0.00430042875730149</span>
<a name="ln-1453"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(29) = -0.013969370453107</span>
<a name="ln-1454"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(30) = 0.000096171182587938</span>
<a name="ln-1455"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(31) = -0.0251558254472348</span>
<a name="ln-1456"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(32) = 0.0077094706621763</span>
<a name="ln-1457"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(33) = -0.0173842428341529</span>
<a name="ln-1458"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(34) = 0.000244578460749651</span>
<a name="ln-1459"></a><span class="c">!!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(35) = 0.000123026859143619</span>
<a name="ln-1460"></a><span class="c">!</span>
<a name="ln-1461"></a><span class="c">!!       Outputs approach in C</span>
<a name="ln-1462"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(1)  =  -1.92653164860338</span>
<a name="ln-1463"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(2)  =   1.17466595655408</span>
<a name="ln-1464"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(3)  =   0.536606417689184</span>
<a name="ln-1465"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(4)  =  -0.220733866462746</span>
<a name="ln-1466"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(5)  =   6.4745897765876</span>
<a name="ln-1467"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(6)  =  -4.75598392569308</span>
<a name="ln-1468"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(7)  =   1.09272698530394</span>
<a name="ln-1469"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(8)  =  -0.110853998895391</span>
<a name="ln-1470"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(9)  =   0.352148411788646</span>
<a name="ln-1471"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(10) =  -0.287364301340387</span>
<a name="ln-1472"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(11) =   0.0160624154449042</span>
<a name="ln-1473"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(12) =   0.0389845209910517</span>
<a name="ln-1474"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(13) =  -0.0244033403339062</span>
<a name="ln-1475"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(14) =  -0.223657243353147</span>
<a name="ln-1476"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(15) =   0.0385664546399435</span>
<a name="ln-1477"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(16) =   0.037765628073743</span>
<a name="ln-1478"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(17) =  -0.000497969128726743</span>
<a name="ln-1479"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(18) =  -0.000219979993770137</span>
<a name="ln-1480"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(19) =   0.0012292866394116</span>
<a name="ln-1481"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(20) =   0.0000220066546127218</span>
<a name="ln-1482"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(21) =   0.767702044158785</span>
<a name="ln-1483"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(22) =  -0.731689870392589</span>
<a name="ln-1484"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(23) =   0.149995781695274</span>
<a name="ln-1485"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(24) =   2.00780209496408</span>
<a name="ln-1486"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(25) =  -0.161092120908292</span>
<a name="ln-1487"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(26) =  -0.0830303891087807</span>
<a name="ln-1488"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(27) =  -0.0341193367495736</span>
<a name="ln-1489"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(28) =   0.00774077176314268</span>
<a name="ln-1490"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(29) =  -0.0251448668155926</span>
<a name="ln-1491"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(30) =   0.000311594631584919</span>
<a name="ln-1492"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(31) =  -0.0311927664658427</span>
<a name="ln-1493"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(32) =   0.0138770471919173</span>
<a name="ln-1494"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(33) =  -0.0312916371014752</span>
<a name="ln-1495"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(34) =   0.000792434212828869</span>
<a name="ln-1496"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(35) =   0.000398607023625325</span>
<a name="ln-1497"></a>
<a name="ln-1498"></a><span class="c">!!       set minimum and maximum boundaries for CoolTools counterflow model input variables</span>
<a name="ln-1499"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%MinInletAirWBTemp = -1.0</span>
<a name="ln-1500"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%MaxInletAirWBTemp = 26.6667</span>
<a name="ln-1501"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%MinRangeTemp      = 1.1111</span>
<a name="ln-1502"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%MaxRangeTemp      = 11.1111</span>
<a name="ln-1503"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%MinApproachTemp   = 1.1111</span>
<a name="ln-1504"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%MaxApproachTemp   = 11.1111</span>
<a name="ln-1505"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%MinWaterFlowRatio = 0.75</span>
<a name="ln-1506"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%MaxWaterFlowRatio = 1.25</span>
<a name="ln-1507"></a>
<a name="ln-1508"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;YorkCalc&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1509"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span>               <span class="o">=</span> <span class="n">YorkCalcModel</span>
<a name="ln-1510"></a><span class="c">!     set counter-flow model coefficients</span>
<a name="ln-1511"></a><span class="c">!       Outputs approach in F</span>
<a name="ln-1512"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(1)  = 2.471005863</span>
<a name="ln-1513"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(2)  = -0.139855144</span>
<a name="ln-1514"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(3)  = 0.001325024</span>
<a name="ln-1515"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(4)  = 0.768721437</span>
<a name="ln-1516"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(5)  = -0.023370562</span>
<a name="ln-1517"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(6)  = 0.000149476</span>
<a name="ln-1518"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(7)  = -0.01116139</span>
<a name="ln-1519"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(8)  = 0.000325406</span>
<a name="ln-1520"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(9)  = -0.00000230183</span>
<a name="ln-1521"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(10) = 9.852803844</span>
<a name="ln-1522"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(11) = -0.173673565</span>
<a name="ln-1523"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(12) = 0.000811069</span>
<a name="ln-1524"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(13) = 1.749920395</span>
<a name="ln-1525"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(14) = 0.004930143</span>
<a name="ln-1526"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(15) = -0.00022193</span>
<a name="ln-1527"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(16) = -0.009865402</span>
<a name="ln-1528"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(17) = -0.000283361</span>
<a name="ln-1529"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(18) = 0.00000466261</span>
<a name="ln-1530"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(19) = 0.09746009</span>
<a name="ln-1531"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(20) = -0.011167959</span>
<a name="ln-1532"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(21) = 0.000138903</span>
<a name="ln-1533"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(22) = -0.135414837</span>
<a name="ln-1534"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(23) = 0.001004747</span>
<a name="ln-1535"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(24) = 0.0000119203</span>
<a name="ln-1536"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(25) = -0.002255673</span>
<a name="ln-1537"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(26) = 0.0000192893</span>
<a name="ln-1538"></a><span class="c">!        VSTower(SimpleTower(TowerNum)%VSTower)%Coeff(27) = -0.000000260086</span>
<a name="ln-1539"></a>
<a name="ln-1540"></a><span class="c">!       Outputs approach in C</span>
<a name="ln-1541"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.359741205d0</span>
<a name="ln-1542"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.055053608d0</span>
<a name="ln-1543"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span>  <span class="mf">0.0023850432d0</span>
<a name="ln-1544"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span>  <span class="mf">0.173926877d0</span>
<a name="ln-1545"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.0248473764d0</span>
<a name="ln-1546"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span>  <span class="mf">0.00048430224d0</span>
<a name="ln-1547"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.005589849456d0</span>
<a name="ln-1548"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span>  <span class="mf">0.0005770079712d0</span>
<a name="ln-1549"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.00001342427256d0</span>
<a name="ln-1550"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">2.84765801111111d0</span>
<a name="ln-1551"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.121765149d0</span>
<a name="ln-1552"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.0014599242d0</span>
<a name="ln-1553"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">1.680428651d0</span>
<a name="ln-1554"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0166920786d0</span>
<a name="ln-1555"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0007190532d0</span>
<a name="ln-1556"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.025485194448d0</span>
<a name="ln-1557"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.0000487491696d0</span>
<a name="ln-1558"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.00002719234152d0</span>
<a name="ln-1559"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0653766255555556d0</span>
<a name="ln-1560"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.002278167d0</span>
<a name="ln-1561"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.0002500254d0</span>
<a name="ln-1562"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0910565458d0</span>
<a name="ln-1563"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.00318176316d0</span>
<a name="ln-1564"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.000038621772d0</span>
<a name="ln-1565"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0034285382352d0</span>
<a name="ln-1566"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">0.00000856589904d0</span>
<a name="ln-1567"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.000001516821552d0</span>
<a name="ln-1568"></a>
<a name="ln-1569"></a><span class="c">!       set minimum and maximum boundaries for YorkCalc model input variables</span>
<a name="ln-1570"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="mf">4.4d0</span>
<a name="ln-1571"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">9.4444d0</span>
<a name="ln-1572"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span>      <span class="o">=</span> <span class="mf">1.1111d0</span>
<a name="ln-1573"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span>      <span class="o">=</span> <span class="mi">2</span><span class="mf">2.2222d0</span>
<a name="ln-1574"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span>   <span class="o">=</span> <span class="mf">1.1111d0</span>
<a name="ln-1575"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span>   <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0d0</span>
<a name="ln-1576"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span> <span class="o">=</span> <span class="mf">0.75d0</span>
<a name="ln-1577"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span> <span class="o">=</span> <span class="mf">1.25d0</span>
<a name="ln-1578"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxLiquidToGasRatio</span> <span class="o">=</span> <span class="mf">8.0d0</span>
<a name="ln-1579"></a>
<a name="ln-1580"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;CoolToolsUserDefined&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1581"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span>                         <span class="o">=</span> <span class="n">CoolToolsUserDefined</span>
<a name="ln-1582"></a>      <span class="c">! Nested Get-input routines below.  Should pull out of here and read in beforehand.</span>
<a name="ln-1583"></a>      <span class="k">DO </span><span class="n">VSModelCoeffNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVSCoolToolsModelCoeffs</span>
<a name="ln-1584"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="s1">&#39;CoolingTowerPerformance:CoolTools&#39;</span><span class="p">,</span><span class="n">VSModelCoeffNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1585"></a>                           <span class="n">AlphArray2</span><span class="p">,</span><span class="n">NumAlphas2</span><span class="p">,</span> <span class="n">NumArray2</span> <span class="p">,</span><span class="n">NumNums2</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-1586"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray2</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ModelCoeffObjectName</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-1587"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">FoundModelCoeff</span>     <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1588"></a>        <span class="c">! verify the correct number of coefficients for the CoolTools model</span>
<a name="ln-1589"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumNums2</span> <span class="o">/=</span> <span class="mi">43</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1590"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CoolingTower:VariableSpeed &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1591"></a>                 <span class="s1">&#39;&quot;. The number of numeric inputs for object CoolingTowerPerformance:CoolTools &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1592"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ModelCoeffObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; must equal 43.&#39;</span><span class="p">)</span>
<a name="ln-1593"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1594"></a>        <span class="k">ELSE</span>
<a name="ln-1595"></a>
<a name="ln-1596"></a><span class="k">          </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span> <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1597"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span> <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1598"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span>      <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1599"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span>      <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1600"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span>   <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1601"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span>   <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1602"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span> <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1603"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span> <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1604"></a>
<a name="ln-1605"></a>          <span class="k">DO </span><span class="n">CoeffNum</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">NumNums2</span>
<a name="ln-1606"></a>            <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="n">CoeffNum</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="n">CoeffNum</span><span class="p">)</span>
<a name="ln-1607"></a>          <span class="k">END DO</span>
<a name="ln-1608"></a><span class="k">        END IF</span>
<a name="ln-1609"></a><span class="k">        EXIT</span>
<a name="ln-1610"></a><span class="k">      END DO</span>
<a name="ln-1611"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">FoundModelCoeff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1612"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CoolingTower:VariableSpeed &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1613"></a>                      <span class="s1">&#39;&quot;. User defined name for variable speed cooling tower model coefficients object not found = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1614"></a>                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ModelCoeffObjectName</span><span class="p">))</span>
<a name="ln-1615"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1616"></a>      <span class="k">END IF</span>
<a name="ln-1617"></a><span class="k">    </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;YorkCalcUserDefined&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1618"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span>                         <span class="o">=</span> <span class="n">YorkCalcUserDefined</span>
<a name="ln-1619"></a>      <span class="c">! Nested Get-input routines below.  Should pull out of here and read in beforehand.</span>
<a name="ln-1620"></a>      <span class="k">DO </span><span class="n">VSModelCoeffNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVSYorkCalcModelCoeffs</span>
<a name="ln-1621"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="s1">&#39;CoolingTowerPerformance:YorkCalc&#39;</span><span class="p">,</span><span class="n">VSModelCoeffNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1622"></a>                     <span class="n">AlphArray2</span><span class="p">,</span><span class="n">NumAlphas2</span><span class="p">,</span> <span class="n">NumArray2</span> <span class="p">,</span><span class="n">NumNums2</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-1623"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray2</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ModelCoeffObjectName</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-1624"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">FoundModelCoeff</span>     <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1625"></a>        <span class="c">! verify the correct number of coefficients for the YorkCalc model</span>
<a name="ln-1626"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumNums2</span> <span class="o">/=</span> <span class="mi">36</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1627"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CoolingTower:VariableSpeed &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1628"></a>                  <span class="s1">&#39;&quot;. The number of numeric inputs for object CoolingTowerPerformance:YorkCalc &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-1629"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ModelCoeffObjectName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; must equal 36.&#39;</span><span class="p">)</span>
<a name="ln-1630"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1631"></a>        <span class="k">ELSE</span>
<a name="ln-1632"></a>
<a name="ln-1633"></a><span class="k">          </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span>   <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1634"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span>   <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1635"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span>        <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1636"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span>        <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1637"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span>     <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1638"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span>     <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1639"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span>   <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1640"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span>   <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1641"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxLiquidToGasRatio</span> <span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1642"></a>
<a name="ln-1643"></a>          <span class="k">DO </span><span class="n">CoeffNum</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">NumNums2</span>
<a name="ln-1644"></a>            <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="n">CoeffNum</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span> <span class="n">NumArray2</span><span class="p">(</span><span class="n">CoeffNum</span><span class="p">)</span>
<a name="ln-1645"></a>          <span class="k">END DO</span>
<a name="ln-1646"></a><span class="k">        END IF</span>
<a name="ln-1647"></a><span class="k">        EXIT</span>
<a name="ln-1648"></a><span class="k">      END DO</span>
<a name="ln-1649"></a>
<a name="ln-1650"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">FoundModelCoeff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1651"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1652"></a>                      <span class="s1">&#39;&quot;. User defined name for variable speed cooling tower model coefficients object not found = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1653"></a>                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ModelCoeffObjectName</span><span class="p">))</span>
<a name="ln-1654"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1655"></a>      <span class="k">END IF</span>
<a name="ln-1656"></a><span class="k">    ELSE</span>
<a name="ln-1657"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1658"></a>                    <span class="s1">&#39;&quot;. Illegal Tower Model Type = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1659"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Tower Model Type must be &quot;CoolToolsCrossFlow&quot;, &quot;YorkCalc&quot;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1660"></a>                    <span class="s1">&#39; &quot;CoolToolsUserDefined&quot;, or &quot;YorkCalcUserDefined.&#39;</span><span class="p">)</span>
<a name="ln-1661"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1662"></a>    <span class="k">END IF</span>
<a name="ln-1663"></a>
<a name="ln-1664"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerMassFlowRateMultiplier</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span>
<a name="ln-1665"></a>
<a name="ln-1666"></a><span class="c">!   check user defined minimums to be greater than 0</span>
<a name="ln-1667"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1668"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1669"></a>                   <span class="s1">&#39;&quot;. User defined minimum approach temperature must be &gt; 0&#39;</span><span class="p">)</span>
<a name="ln-1670"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1671"></a>    <span class="k">END IF</span>
<a name="ln-1672"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1673"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1674"></a>                   <span class="s1">&#39;&quot;. User defined minimum range temperature must be &gt; 0&#39;</span><span class="p">)</span>
<a name="ln-1675"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1676"></a>    <span class="k">END IF</span>
<a name="ln-1677"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1678"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1679"></a>                   <span class="s1">&#39;&quot;. User defined minimum water flow rate ratio must be &gt; 0&#39;</span><span class="p">)</span>
<a name="ln-1680"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1681"></a>    <span class="k">END IF</span>
<a name="ln-1682"></a>
<a name="ln-1683"></a><span class="c">!   check that the user defined maximums are greater than the minimums</span>
<a name="ln-1684"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1685"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1686"></a>                   <span class="s1">&#39;&quot;. User defined maximum approach temperature must be &gt; the minimum approach temperature&#39;</span><span class="p">)</span>
<a name="ln-1687"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1688"></a>    <span class="k">END IF</span>
<a name="ln-1689"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1690"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1691"></a>                   <span class="s1">&#39;&quot;. User defined maximum range temperature must be &gt; the minimum range temperature&#39;</span><span class="p">)</span>
<a name="ln-1692"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1693"></a>    <span class="k">END IF</span>
<a name="ln-1694"></a><span class="k">    IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1695"></a>       <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1696"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1697"></a>                   <span class="s1">&#39;&quot;. User defined maximum water flow rate ratio must be &gt; the minimum water flow rate ratio&#39;</span><span class="p">)</span>
<a name="ln-1698"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1699"></a>    <span class="k">END IF</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignInletWB</span>             <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1702"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1703"></a>        <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1704"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignInletWB</span>
<a name="ln-1705"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span>
<a name="ln-1706"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span>
<a name="ln-1707"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1708"></a>                       <span class="s1">&#39;&quot; the design inlet air wet-bulb temperature of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; must be within&#39;</span> <span class="p">&amp;</span>
<a name="ln-1709"></a>                       <span class="o">//</span><span class="s1">&#39; the model limits of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; degrees C&#39;</span><span class="p">)</span>
<a name="ln-1710"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1711"></a>     <span class="k">END IF</span>
<a name="ln-1712"></a>
<a name="ln-1713"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignApproach</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1714"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1715"></a>        <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1716"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignApproach</span>
<a name="ln-1717"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span>
<a name="ln-1718"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span>
<a name="ln-1719"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1720"></a>                       <span class="s1">&#39;&quot; the design approach temperature of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; must be within &#39;</span> <span class="p">&amp;</span>
<a name="ln-1721"></a>                       <span class="o">//</span><span class="s1">&#39; the model limits of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; degrees C&#39;</span><span class="p">)</span>
<a name="ln-1722"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1723"></a>     <span class="k">END IF</span>
<a name="ln-1724"></a>
<a name="ln-1725"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignRange</span>               <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1726"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1727"></a>        <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1728"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignRange</span>
<a name="ln-1729"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span>
<a name="ln-1730"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span>
<a name="ln-1731"></a>        <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1732"></a>                       <span class="s1">&#39;&quot; the design range temperature of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; must be within &#39;</span> <span class="p">&amp;</span>
<a name="ln-1733"></a>                       <span class="o">//</span><span class="s1">&#39; the model limits of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; degrees C&#39;</span><span class="p">)</span>
<a name="ln-1734"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1735"></a>     <span class="k">END IF</span>
<a name="ln-1736"></a>
<a name="ln-1737"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1738"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1739"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1740"></a>                       <span class="s1">&#39;&quot; design water flow rate must be &gt; 0&#39;</span><span class="p">)</span>
<a name="ln-1741"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1742"></a>     <span class="k">END IF</span>
<a name="ln-1743"></a>
<a name="ln-1744"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1745"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1746"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1747"></a>                       <span class="s1">&#39;&quot; design air flow rate must be &gt; 0&#39;</span><span class="p">)</span>
<a name="ln-1748"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1749"></a>     <span class="k">END IF</span>
<a name="ln-1750"></a>
<a name="ln-1751"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span>         <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1752"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1753"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1754"></a>                       <span class="s1">&#39;&quot; design fan power must be &gt; 0&#39;</span><span class="p">)</span>
<a name="ln-1755"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1756"></a>     <span class="k">END IF</span>
<a name="ln-1757"></a>
<a name="ln-1758"></a><span class="c">!   minimum air flow rate fraction must be &gt;= 0.2 and &lt;= 0.5, below this value the tower fan cycles to maintain the setpoint</span>
<a name="ln-1759"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1760"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1761"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.2d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1762"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1763"></a>                       <span class="s1">&#39;&quot; minimum VS air flow rate ratio must be &gt;= 0.2 and &lt;= 0.5&#39;</span><span class="p">)</span>
<a name="ln-1764"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1765"></a>     <span class="k">END IF</span>
<a name="ln-1766"></a>
<a name="ln-1767"></a><span class="c">!   fraction of tower capacity in free convection regime must be &gt;= to 0 and &lt;= 0.2</span>
<a name="ln-1768"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvectionCapacityFraction</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1769"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.2d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1770"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1771"></a>                       <span class="s1">&#39;&quot; fraction of tower capacity in free convection regime must be &gt;= 0 and &lt;= 0.2&#39;</span><span class="p">)</span>
<a name="ln-1772"></a>       <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1773"></a>     <span class="k">END IF</span>
<a name="ln-1774"></a>
<a name="ln-1775"></a><span class="c">!   Basin heater power as a function of temperature must be greater than or equal to 0</span>
<a name="ln-1776"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1777"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1778"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1779"></a>                      <span class="s1">&#39;&quot; basin heater power as a function of temperature difference must be &gt;= 0&#39;</span><span class="p">)</span>
<a name="ln-1780"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1781"></a>    <span class="k">END IF</span>
<a name="ln-1782"></a>
<a name="ln-1783"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1784"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1785"></a><span class="k">      IF</span><span class="p">(</span><span class="n">NumNums</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1786"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-1787"></a>      <span class="n">ENDIF</span>
<a name="ln-1788"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">simpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1789"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1790"></a>           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is less than 2 deg C. Freezing could occur.&#39;</span><span class="p">)</span>
<a name="ln-1791"></a>      <span class="k">END IF</span>
<a name="ln-1792"></a><span class="k">    END IF</span>
<a name="ln-1793"></a>
<a name="ln-1794"></a>    <span class="c">! Performance Input Method for Variable Speed Towers is assigned to be UA AND DESIGN WATER FLOW RATE</span>
<a name="ln-1795"></a>    <span class="c">! for autosizing calculations (see SizeTower)</span>
<a name="ln-1796"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="n">PIM_UFactor</span>
<a name="ln-1797"></a>
<a name="ln-1798"></a><span class="c">!   Makeup water drift percentage must be greater than or equal to 0</span>
<a name="ln-1799"></a><span class="c">!    SimpleTower(TowerNum)%MakeupWaterDrift          = NumArray(10)/100.0</span>
<a name="ln-1800"></a><span class="c">!     IF(NumArray(10) .LT. 0.0) THEN</span>
<a name="ln-1801"></a><span class="c">!       CALL ShowSevereError(&#39;COOLING TOWER:VARIABLE SPEED, &quot;&#39;//TRIM(SimpleTower(TowerNum)%Name)//&amp;</span>
<a name="ln-1802"></a><span class="c">!                       &#39;&quot; Makeup Water Drift as a percentage of design water flow rate must be &gt;= 0&#39;)</span>
<a name="ln-1803"></a><span class="c">!       ErrorsFound = .TRUE.</span>
<a name="ln-1804"></a><span class="c">!     END IF</span>
<a name="ln-1805"></a>
<a name="ln-1806"></a>
<a name="ln-1807"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Blank</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1808"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-1809"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1810"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1811"></a>                       <span class="s1">&#39;&quot; basin heater schedule name &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-1812"></a>                       <span class="o">//</span><span class="s1">&#39;&quot; was not found. Basin heater operation will not be modeled and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-1813"></a>      <span class="k">END IF</span>
<a name="ln-1814"></a><span class="k">    END IF</span>
<a name="ln-1815"></a>
<a name="ln-1816"></a><span class="c">!    IF(AlphArray(9) .NE. &#39; &#39;)THEN</span>
<a name="ln-1817"></a><span class="c">!      SimpleTower(TowerNum)%BlowDownSchedulePtr       = GetScheduleIndex(AlphArray(9))</span>
<a name="ln-1818"></a><span class="c">!      IF(SimpleTower(TowerNum)%BlowDownSchedulePtr .EQ. 0)THEN</span>
<a name="ln-1819"></a><span class="c">!        CALL ShowWarningError(&#39;COOLING TOWER:VARIABLE SPEED, &quot;&#39;//TRIM(SimpleTower(TowerNum)%Name)//&amp;</span>
<a name="ln-1820"></a><span class="c">!                       &#39;&quot; blowdown schedule name &quot;&#39;//TRIM(AlphArray(9)) &amp;</span>
<a name="ln-1821"></a><span class="c">!                       //&#39;&quot; was not found. Basin blowdown will not be modeled and the simulation continues&#39;)</span>
<a name="ln-1822"></a><span class="c">!      END IF</span>
<a name="ln-1823"></a><span class="c">!    END IF</span>
<a name="ln-1824"></a>
<a name="ln-1825"></a>    <span class="c">! begin water use and systems get input</span>
<a name="ln-1826"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="s1">&#39;LossFactor&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1827"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByUserFactor</span>
<a name="ln-1828"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="s1">&#39;SaturatedExit&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1829"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByMoistTheory</span>
<a name="ln-1830"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1831"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByMoistTheory</span>
<a name="ln-1832"></a>    <span class="k">ELSE</span>
<a name="ln-1833"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-1834"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1835"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1836"></a>    <span class="n">ENDIF</span>
<a name="ln-1837"></a>
<a name="ln-1838"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UserEvapLossFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c">!  N11 , \field Evaporation Loss Factor</span>
<a name="ln-1839"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="mf">0.0d0</span> <span class="c">!  N12, \field Drift Loss Percent</span>
<a name="ln-1840"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="c">!  N13, \field Blowdown Concentration Ratio</span>
<a name="ln-1841"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span>             <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="c">!  N14  \field Sizing Factor</span>
<a name="ln-1842"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1843"></a>
<a name="ln-1844"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;ScheduledRate&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1845"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownBySchedule</span>
<a name="ln-1846"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;ConcentrationRatio&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1847"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownByConcentration</span>
<a name="ln-1848"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1849"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownByConcentration</span>
<a name="ln-1850"></a>    <span class="k">ELSE</span>
<a name="ln-1851"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-1852"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1853"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1854"></a>    <span class="n">ENDIF</span>
<a name="ln-1855"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-1856"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span> <span class="o">==</span> <span class="n">BlowdownBySchedule</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-1857"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-1858"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1859"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1860"></a>    <span class="n">endif</span>
<a name="ln-1861"></a>
<a name="ln-1862"></a>  <span class="c">!added for multi-cell</span>
<a name="ln-1863"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>                  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-1864"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-1865"></a>      <span class="c">! assume Number of Cells not entered and should be defaulted</span>
<a name="ln-1866"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1867"></a>    <span class="n">endif</span>
<a name="ln-1868"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-1869"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-1870"></a>      <span class="c">! assume Cell Minimum Water Flow Rate Fraction not entered and should be defaulted</span>
<a name="ln-1871"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">=</span> <span class="mf">0.33d0</span>
<a name="ln-1872"></a>    <span class="n">endif</span>
<a name="ln-1873"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-1874"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-1875"></a>      <span class="c">! assume Cell Maximum Water Flow Rate Fraction not entered and should be defaulted</span>
<a name="ln-1876"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">=</span> <span class="mf">2.5d0</span>
<a name="ln-1877"></a>    <span class="n">endif</span>
<a name="ln-1878"></a>
<a name="ln-1879"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">13</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1880"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1881"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-1882"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-1883"></a>      <span class="k">ELSE</span>
<a name="ln-1884"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;MinimalCell&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1885"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;MaximalCell&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1886"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;MinimalCell&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1887"></a><span class="k">             </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MinCell</span>
<a name="ln-1888"></a>             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MinimalCell&#39;</span>
<a name="ln-1889"></a>          <span class="n">ENDIF</span>
<a name="ln-1890"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;MaximalCell&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1891"></a><span class="k">             </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-1892"></a>             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-1893"></a>          <span class="n">ENDIF</span>
<a name="ln-1894"></a>        <span class="k">ELSE</span>
<a name="ln-1895"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)))</span>
<a name="ln-1896"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1897"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1898"></a>        <span class="k">END IF</span>
<a name="ln-1899"></a><span class="k">      END IF</span>
<a name="ln-1900"></a><span class="k">    ELSE</span>
<a name="ln-1901"></a>      <span class="c">!assume Cell Control not entered and should be defaulted</span>
<a name="ln-1902"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-1903"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-1904"></a>    <span class="k">END IF</span>
<a name="ln-1905"></a>
<a name="ln-1906"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1907"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1908"></a>    <span class="k">ELSE</span> <span class="c">! water from storage tank</span>
<a name="ln-1909"></a>      <span class="c">!</span>
<a name="ln-1910"></a>      <span class="k">Call </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1911"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankID</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankDemandARRID</span><span class="p">)</span>
<a name="ln-1912"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1913"></a>    <span class="n">ENDIF</span>
<a name="ln-1914"></a>
<a name="ln-1915"></a><span class="c">!   outdoor air inlet node</span>
<a name="ln-1916"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1917"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1918"></a>    <span class="k">ELSE</span>
<a name="ln-1919"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1920"></a>        <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1921"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1922"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1923"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1924"></a>                          <span class="s1">&#39;&quot; Outdoor Air Inlet Node Name not valid Outdoor Air Node= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-1925"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-1926"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1927"></a>      <span class="k">END IF</span>
<a name="ln-1928"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-1929"></a>
<a name="ln-1930"></a>  <span class="k">END DO</span>  <span class="c">! End Variable-Speed Tower Loop</span>
<a name="ln-1931"></a>
<a name="ln-1932"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cCoolingTower_VariableSpeedMerkel</span>
<a name="ln-1933"></a>  <span class="k">DO </span><span class="n">MerkelVSTowerNum</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVSMerkelTowers</span>
<a name="ln-1934"></a>    <span class="n">TowerNum</span> <span class="o">=</span> <span class="n">NumSingleSpeedTowers</span> <span class="o">+</span> <span class="n">NumTwoSpeedTowers</span> <span class="o">+</span> <span class="n">NumVariableSpeedTowers</span> <span class="o">+</span> <span class="n">MerkelVSTowerNum</span>
<a name="ln-1935"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">MerkelVSTowerNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1936"></a>                       <span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,&amp;</span>
<a name="ln-1937"></a>                    <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1938"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1939"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1940"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">TowerNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1941"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1942"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1943"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1944"></a>    <span class="n">ENDIF</span>
<a name="ln-1945"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span>               <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1946"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span>          <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-1947"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span>      <span class="o">=</span> <span class="n">CoolingTower_VariableSpeedMerkel</span>
<a name="ln-1948"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1949"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1950"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1951"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1952"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1953"></a>               <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1954"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;Chilled Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-1955"></a>
<a name="ln-1956"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;UFactorTimesAreaAndDesignWaterFlowRate&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1957"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="n">PIM_UFactor</span>
<a name="ln-1958"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;NominalCapacity&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1959"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">=</span> <span class="n">PIM_NominalCapacity</span>
<a name="ln-1960"></a>    <span class="k">ELSE</span>
<a name="ln-1961"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1962"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1963"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1964"></a>    <span class="n">ENDIF</span>
<a name="ln-1965"></a>
<a name="ln-1966"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-1967"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1968"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1969"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1970"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve name not found.&#39;</span><span class="p">)</span>
<a name="ln-1971"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1972"></a>    <span class="n">ENDIF</span>
<a name="ln-1973"></a>
<a name="ln-1974"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1975"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1976"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span>             <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1977"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCapSizingFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1978"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span>             <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1979"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowPerUnitNomCap</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1980"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1981"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1982"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DefaultedDesignAirFlowScalingFactor</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1983"></a>    <span class="k">ELSE</span>
<a name="ln-1984"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DefaultedDesignAirFlowScalingFactor</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1985"></a>    <span class="n">ENDIF</span>
<a name="ln-1986"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignAirFlowPerUnitNomCap</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1987"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1988"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span>               <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1989"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignFanPowerPerUnitNomCap</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1990"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span>             <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1991"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRateSizingFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-1992"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span>                <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-1993"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span>                 <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-1994"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUASizingFactor</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-1995"></a>
<a name="ln-1996"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncAirFlowRatioCurvePtr</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1997"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncAirFlowRatioCurvePtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1998"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1999"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2000"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve name not found.&#39;</span><span class="p">)</span>
<a name="ln-2001"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2002"></a>    <span class="n">ENDIF</span>
<a name="ln-2003"></a>
<a name="ln-2004"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncWetbulbDiffCurvePtr</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-2005"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncWetbulbDiffCurvePtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2006"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2007"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-2008"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve name not found.&#39;</span><span class="p">)</span>
<a name="ln-2009"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2010"></a>    <span class="n">ENDIF</span>
<a name="ln-2011"></a>
<a name="ln-2012"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncWaterFlowRatioCurvePtr</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-2013"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncWaterFlowRatioCurvePtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2014"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2015"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-2016"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve name not found.&#39;</span><span class="p">)</span>
<a name="ln-2017"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2018"></a>    <span class="n">ENDIF</span>
<a name="ln-2019"></a>
<a name="ln-2020"></a>    <span class="c">!   Basin heater power as a function of temperature must be greater than or equal to 0</span>
<a name="ln-2021"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-2022"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2023"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2024"></a>                      <span class="s1">&#39;&quot; basin heater power as a function of temperature difference must be &gt;= 0&#39;</span><span class="p">)</span>
<a name="ln-2025"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2026"></a>    <span class="k">END IF</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-2029"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2030"></a><span class="k">      IF</span><span class="p">(</span><span class="n">NumNums</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">18</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2031"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">=</span> <span class="mf">2.0d0</span>
<a name="ln-2032"></a>      <span class="n">ENDIF</span>
<a name="ln-2033"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">simpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2034"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2035"></a>           <span class="s1">&#39;&quot;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is less than 2 deg C. Freezing could occur.&#39;</span><span class="p">)</span>
<a name="ln-2036"></a>      <span class="k">END IF</span>
<a name="ln-2037"></a><span class="k">    END IF</span>
<a name="ln-2038"></a>
<a name="ln-2039"></a><span class="k">    IF</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Blank</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2040"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-2041"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2042"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2043"></a>                       <span class="s1">&#39;&quot; basin heater schedule name &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2044"></a>                       <span class="o">//</span><span class="s1">&#39;&quot; was not found. Basin heater operation will not be modeled and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2045"></a>      <span class="k">END IF</span>
<a name="ln-2046"></a><span class="k">    END IF</span>
<a name="ln-2047"></a>
<a name="ln-2048"></a>    <span class="c">! begin water use and systems get input</span>
<a name="ln-2049"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;LossFactor&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2050"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByUserFactor</span>
<a name="ln-2051"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;SaturatedExit&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2052"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByMoistTheory</span>
<a name="ln-2053"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2054"></a><span class="k">       </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">=</span> <span class="n">EvapLossByMoistTheory</span>
<a name="ln-2055"></a>    <span class="k">ELSE</span>
<a name="ln-2056"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2057"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-2058"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2059"></a>    <span class="n">ENDIF</span>
<a name="ln-2060"></a>
<a name="ln-2061"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UserEvapLossFactor</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="c">!  N19 , \field Evaporation Loss Factor</span>
<a name="ln-2062"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="mf">0.0d0</span>  <span class="c">!  N20, \field Drift Loss Percent</span>
<a name="ln-2063"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2064"></a>      <span class="c">! assume Drift loss not entered and should be defaulted</span>
<a name="ln-2065"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">=</span> <span class="mf">0.008d0</span> <span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-2066"></a>    <span class="n">ENDIF</span>
<a name="ln-2067"></a>
<a name="ln-2068"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="c">!  N21, \field Blowdown Concentration Ratio</span>
<a name="ln-2069"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>             <span class="c">!  N25  \field Sizing Factor</span>
<a name="ln-2070"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2071"></a>
<a name="ln-2072"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="s1">&#39;ScheduledRate&#39;</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2073"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownBySchedule</span>
<a name="ln-2074"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="s1">&#39;ConcentrationRatio&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2075"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownByConcentration</span>
<a name="ln-2076"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2077"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span>  <span class="o">=</span> <span class="n">BlowdownByConcentration</span>
<a name="ln-2078"></a>      <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2079"></a>        <span class="c">! assume Concetration ratio was omitted and should be defaulted</span>
<a name="ln-2080"></a>            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">=</span> <span class="mf">3.0d0</span>
<a name="ln-2081"></a>      <span class="n">endif</span>
<a name="ln-2082"></a>    <span class="k">ELSE</span>
<a name="ln-2083"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2084"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-2085"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2086"></a>    <span class="n">ENDIF</span>
<a name="ln-2087"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-2088"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span> <span class="o">==</span> <span class="n">BlowdownBySchedule</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-2089"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2090"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-2091"></a>      <span class="n">errorsfound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2092"></a>    <span class="n">ENDIF</span>
<a name="ln-2093"></a>
<a name="ln-2094"></a>  <span class="c">!added for multi-cell</span>
<a name="ln-2095"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>                  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-2096"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">22</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2097"></a>      <span class="c">! assume Number of Cells not entered and should be defaulted</span>
<a name="ln-2098"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2099"></a>    <span class="n">endif</span>
<a name="ln-2100"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<a name="ln-2101"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">23</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2102"></a>      <span class="c">! assume Cell Minimum Water Flow Rate Fraction not entered and should be defaulted</span>
<a name="ln-2103"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">=</span> <span class="mf">0.33d0</span>
<a name="ln-2104"></a>    <span class="n">endif</span>
<a name="ln-2105"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-2106"></a>    <span class="k">If</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2107"></a>      <span class="c">! assume Cell Maximum Water Flow Rate Fraction not entered and should be defaulted</span>
<a name="ln-2108"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">=</span> <span class="mf">2.5d0</span>
<a name="ln-2109"></a>    <span class="n">endif</span>
<a name="ln-2110"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerMassFlowRateMultiplier</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span>
<a name="ln-2111"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">15</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2112"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2113"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-2114"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-2115"></a>      <span class="k">ELSE</span>
<a name="ln-2116"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="s1">&#39;MinimalCell&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2117"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="s1">&#39;MaximalCell&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2118"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="s1">&#39;MinimalCell&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2119"></a><span class="k">             </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MinCell</span>
<a name="ln-2120"></a>             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MinimalCell&#39;</span>
<a name="ln-2121"></a>          <span class="n">ENDIF</span>
<a name="ln-2122"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="s1">&#39;MaximalCell&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2123"></a><span class="k">             </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-2124"></a>             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-2125"></a>          <span class="n">ENDIF</span>
<a name="ln-2126"></a>        <span class="k">ELSE</span>
<a name="ln-2127"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-2128"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2129"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2130"></a>        <span class="k">END IF</span>
<a name="ln-2131"></a><span class="k">      END IF</span>
<a name="ln-2132"></a><span class="k">    ELSE</span>
<a name="ln-2133"></a>      <span class="c">!assume Cell Control not entered and should be defaulted</span>
<a name="ln-2134"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl</span><span class="o">=</span> <span class="s1">&#39;MaximalCell&#39;</span>
<a name="ln-2135"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span><span class="o">=</span><span class="n">CellCtrl_MaxCell</span>
<a name="ln-2136"></a>    <span class="k">END IF</span>
<a name="ln-2137"></a>
<a name="ln-2138"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2139"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2140"></a>    <span class="k">ELSE</span> <span class="c">! water from storage tank</span>
<a name="ln-2141"></a>      <span class="c">!</span>
<a name="ln-2142"></a>      <span class="k">Call </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2143"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankID</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankDemandARRID</span><span class="p">)</span>
<a name="ln-2144"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2145"></a>    <span class="n">ENDIF</span>
<a name="ln-2146"></a>
<a name="ln-2147"></a><span class="c">!   outdoor air inlet node</span>
<a name="ln-2148"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2149"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2150"></a>    <span class="k">ELSE</span>
<a name="ln-2151"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2152"></a>       <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2153"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2154"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2155"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2156"></a>                          <span class="s1">&#39;&quot; Outdoor Air Inlet Node Name not valid Outdoor Air Node= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)))</span>
<a name="ln-2157"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-2158"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2159"></a>      <span class="k">END IF</span>
<a name="ln-2160"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-2161"></a>
<a name="ln-2162"></a>
<a name="ln-2163"></a>
<a name="ln-2164"></a>  <span class="n">ENDDO</span> <span class="c">! end merkel vs tower loop</span>
<a name="ln-2165"></a>
<a name="ln-2166"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2167"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting cooling tower input.&#39;</span><span class="p">)</span>
<a name="ln-2168"></a>  <span class="n">ENDIF</span>
<a name="ln-2169"></a>
<a name="ln-2170"></a><span class="c">! Set up output variables CurrentModuleObject=&#39;CoolingTower:SingleSpeed&#39;</span>
<a name="ln-2171"></a>  <span class="k">DO </span><span class="n">TowerNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumSingleSpeedTowers</span>
<a name="ln-2172"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2173"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2174"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2175"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2176"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2177"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2178"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2179"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Qactual</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2180"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2181"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2182"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2183"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2184"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2185"></a>                       <span class="c">! Added for fluid bypass</span>
<a name="ln-2186"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Bypass Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2187"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2188"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Operating Cells Count []&#39;</span><span class="p">,&amp;</span>
<a name="ln-2189"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2190"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Cycling Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2191"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanCyclingRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2192"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2193"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Basin Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2194"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2195"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Basin Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2196"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2197"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2198"></a>    <span class="k">END IF</span>
<a name="ln-2199"></a><span class="k">  END DO</span>
<a name="ln-2200"></a>
<a name="ln-2201"></a>  <span class="c">! CurrentModuleObject=&#39;CoolingTower:TwoSpeed&#39;</span>
<a name="ln-2202"></a>  <span class="k">DO </span><span class="n">TowerNum</span> <span class="o">=</span> <span class="n">NumSingleSpeedTowers</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumSingleSpeedTowers</span><span class="o">+</span><span class="n">NumTwoSpeedTowers</span>
<a name="ln-2203"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2204"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2205"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2206"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2207"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2208"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2209"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2210"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Qactual</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2211"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2212"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2213"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2214"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2215"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2216"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Cycling Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2217"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanCyclingRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2218"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Speed Level []&#39;</span><span class="p">,&amp;</span>
<a name="ln-2219"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SpeedSelected</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2220"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Operating Cells Count []&#39;</span><span class="p">,&amp;</span>
<a name="ln-2221"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2222"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2223"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Basin Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2224"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2225"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Basin Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2226"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2227"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2228"></a>    <span class="k">END IF</span>
<a name="ln-2229"></a><span class="k">  END DO</span>
<a name="ln-2230"></a>
<a name="ln-2231"></a>  <span class="c">! CurrentModuleObject=&#39;CoolingTower:VariableSpeed&#39;</span>
<a name="ln-2232"></a>  <span class="k">DO </span><span class="n">TowerNum</span> <span class="o">=</span> <span class="n">NumSingleSpeedTowers</span><span class="o">+</span><span class="n">NumTwoSpeedTowers</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumSingleSpeedTowers</span><span class="o">+</span><span class="n">NumTwoSpeedTowers</span><span class="o">+</span><span class="n">NumVariableSpeedTowers</span>
<a name="ln-2233"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2234"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2235"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2236"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2237"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2238"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2239"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2240"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Qactual</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2241"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2242"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2243"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2244"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2245"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2246"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Air Flow Rate Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2247"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirFlowRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2248"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2249"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanCyclingRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2250"></a>   <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Operating Cells Count []&#39;</span><span class="p">,&amp;</span>
<a name="ln-2251"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2252"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2253"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Basin Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2254"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2255"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Basin Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2256"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2257"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2258"></a>    <span class="k">END IF</span>
<a name="ln-2259"></a>
<a name="ln-2260"></a><span class="c">!    CALL SetupOutputVariable(&#39;Tower Makeup Water Consumption [m3]&#39;, &amp;</span>
<a name="ln-2261"></a><span class="c">!          SimpleTowerReport(TowerNum)%WaterAmountUsed,&#39;System&#39;,&#39;Sum&#39;,SimpleTower(TowerNum)%Name, &amp;</span>
<a name="ln-2262"></a><span class="c">!                                  ResourceTypeKey=&#39;Water&#39;,EndUseKey=&#39;HeatRejection&#39;,GroupKey=&#39;Plant&#39;)</span>
<a name="ln-2263"></a>
<a name="ln-2264"></a>  <span class="k">END DO</span>
<a name="ln-2265"></a>
<a name="ln-2266"></a>  <span class="c">! CurrentModuleObject=&#39;CoolingTower:VariableSpeed:Merkel&#39;</span>
<a name="ln-2267"></a>  <span class="k">DO </span><span class="n">TowerNum</span> <span class="o">=</span> <span class="n">NumSingleSpeedTowers</span><span class="o">+</span><span class="n">NumTwoSpeedTowers</span><span class="o">+</span><span class="n">NumVariableSpeedTowers</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2268"></a>                  <span class="n">NumSingleSpeedTowers</span><span class="o">+</span><span class="n">NumTwoSpeedTowers</span><span class="o">+</span><span class="n">NumVariableSpeedTowers</span><span class="o">+</span><span class="n">NumVSMerkelTowers</span>
<a name="ln-2269"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2270"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2271"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2272"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2273"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2274"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2275"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2276"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Qactual</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2277"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2278"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2279"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2280"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2281"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2282"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Fan Speed Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2283"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirFlowRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2284"></a>
<a name="ln-2285"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Operating Cells Count []&#39;</span><span class="p">,&amp;</span>
<a name="ln-2286"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2287"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2288"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Basin Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2289"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2290"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Basin Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2291"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2292"></a>          <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2293"></a>    <span class="k">END IF</span>
<a name="ln-2294"></a><span class="k">  </span><span class="n">ENDDO</span>
<a name="ln-2295"></a>  <span class="c">! setup common water reporting for all types of towers.</span>
<a name="ln-2296"></a>  <span class="k">Do </span><span class="n">TowerNum</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">NumSingleSpeedTowers</span><span class="o">+</span><span class="n">NumTwoSpeedTowers</span><span class="o">+</span><span class="n">NumVariableSpeedTowers</span><span class="o">+</span><span class="n">NumVSMerkelTowers</span>
<a name="ln-2297"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2298"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Make Up Water Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2299"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MakeUpVdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2300"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Make Up Water Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2301"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MakeUpVol</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2302"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Storage Tank Water Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2303"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TankSupplyVdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2304"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Storage Tank Water Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2305"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TankSupplyVol</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2306"></a>            <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span> <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2307"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Starved Storage Tank Water Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2308"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">StarvedMakeUpVdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2309"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Starved Storage Tank Water Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2310"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">StarvedMakeUpVol</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2311"></a>            <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span> <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2312"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Make Up Mains Water Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2313"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">StarvedMakeUpVol</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2314"></a>            <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;MainsWater&#39;</span><span class="p">,</span> <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2315"></a>    <span class="k">ELSE</span> <span class="c">! tower water from mains and gets metered</span>
<a name="ln-2316"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Make Up Water Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2317"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MakeUpVdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2318"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Make Up Water Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2319"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MakeUpVol</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2320"></a>            <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span> <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2321"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Make Up Mains Water Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2322"></a>            <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MakeUpVol</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2323"></a>            <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;MainsWater&#39;</span><span class="p">,</span> <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HeatRejection&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2324"></a>    <span class="n">ENDIF</span>
<a name="ln-2325"></a>
<a name="ln-2326"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Water Evaporation Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2327"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvaporationVdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2328"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Water Evaporation Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2329"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvaporationVol</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2330"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Water Drift Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2331"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftVdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2332"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Water Drift Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2333"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftVol</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2334"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Water Blowdown Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2335"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownVdot</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2336"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Tower Water Blowdown Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2337"></a>          <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownVol</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2338"></a>  <span class="n">ENDDO</span> <span class="c">! loop all towers</span>
<a name="ln-2339"></a>
<a name="ln-2340"></a><span class="k">RETURN</span>
<a name="ln-2341"></a><span class="k">END SUBROUTINE </span><span class="n">GetTowerInput</span>
<a name="ln-2342"></a><span class="c">! End of Get Input subroutines for the CondenserLoopTowers Module</span>
<a name="ln-2343"></a><span class="c">!******************************************************************************</span>
<a name="ln-2344"></a>
<a name="ln-2345"></a>
<a name="ln-2346"></a><span class="c">! Beginning Initialization Section for the CondenserLoopTowers Module</span>
<a name="ln-2347"></a><span class="c">!******************************************************************************</span>
<a name="ln-2348"></a>
<a name="ln-2349"></a><span class="k">SUBROUTINE </span><span class="n">InitSimVars</span>
<a name="ln-2350"></a>
<a name="ln-2351"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2352"></a>          <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-2353"></a>          <span class="c">!       DATE WRITTEN:    October 1998</span>
<a name="ln-2354"></a>          <span class="c">!       MODIFIED         Jan 2001, Richard Raustad</span>
<a name="ln-2355"></a>          <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-2356"></a>
<a name="ln-2357"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2358"></a>          <span class="c">! Initialize the simulation variables.</span>
<a name="ln-2359"></a>
<a name="ln-2360"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2361"></a>          <span class="c">! na</span>
<a name="ln-2362"></a>
<a name="ln-2363"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2364"></a>          <span class="c">! na</span>
<a name="ln-2365"></a>
<a name="ln-2366"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2367"></a>          <span class="c">! na</span>
<a name="ln-2368"></a>
<a name="ln-2369"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2370"></a>
<a name="ln-2371"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2372"></a>          <span class="c">! na</span>
<a name="ln-2373"></a>
<a name="ln-2374"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2375"></a>          <span class="c">! na</span>
<a name="ln-2376"></a>
<a name="ln-2377"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2378"></a>          <span class="c">! na</span>
<a name="ln-2379"></a>
<a name="ln-2380"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2381"></a>          <span class="c">! na</span>
<a name="ln-2382"></a>
<a name="ln-2383"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2384"></a>          <span class="c">! na</span>
<a name="ln-2385"></a>
<a name="ln-2386"></a>
<a name="ln-2387"></a>          <span class="c">!INITIALIZE MODULE LEVEL VARIABLES</span>
<a name="ln-2388"></a>
<a name="ln-2389"></a>    <span class="n">InletWaterTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! CW temperature at tower inlet</span>
<a name="ln-2390"></a>    <span class="n">OutletWaterTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! CW temperature at tower outlet</span>
<a name="ln-2391"></a>    <span class="n">WaterInletNode</span>           <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Node number at tower inlet</span>
<a name="ln-2392"></a>    <span class="n">WaterOutletNode</span>          <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Node number at tower outlet</span>
<a name="ln-2393"></a>    <span class="n">WaterMassFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! WaterMassFlowRate through tower</span>
<a name="ln-2394"></a>   <span class="c">! TowerMassFlowRateMax     = 0.0    ! Max Hardware Mass Flow Rate</span>
<a name="ln-2395"></a>   <span class="c">! TowerMassFlowRateMin     = 0.0    ! Min Hardware Mass Flow Rate</span>
<a name="ln-2396"></a>    <span class="c">!LoopMassFlowRateMaxAvail = 0.0    ! Max Loop Mass Flow Rate available</span>
<a name="ln-2397"></a>    <span class="c">!LoopMassFlowRateMinAvail = 0.0    ! Min Loop Mass Flow Rate available</span>
<a name="ln-2398"></a>    <span class="n">Qactual</span>                  <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Tower heat transfer</span>
<a name="ln-2399"></a>    <span class="n">CTFanPower</span>               <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Tower fan power used</span>
<a name="ln-2400"></a>    <span class="n">AirFlowRateRatio</span>         <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Ratio of air flow rate through VS cooling tower to design air flow rate</span>
<a name="ln-2401"></a>    <span class="n">BasinHeaterPower</span>         <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Basin heater power use (W)</span>
<a name="ln-2402"></a>    <span class="n">WaterUsage</span>               <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Tower water usage (m3/s)</span>
<a name="ln-2403"></a>    <span class="n">FanCyclingRatio</span>          <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! cycling ratio of tower fan when min fan speed provide to much capacity</span>
<a name="ln-2404"></a>
<a name="ln-2405"></a><span class="k">RETURN</span>
<a name="ln-2406"></a><span class="k">END SUBROUTINE </span><span class="n">InitSimVars</span>
<a name="ln-2407"></a>
<a name="ln-2408"></a><span class="k">SUBROUTINE </span><span class="n">InitTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">RunFlag</span><span class="p">)</span>
<a name="ln-2409"></a>
<a name="ln-2410"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2411"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-2412"></a>          <span class="c">!       DATE WRITTEN   May 2002</span>
<a name="ln-2413"></a>          <span class="c">!       MODIFIED       Don Shirey Sept/Oct 2002, F Buhl Oct 2002</span>
<a name="ln-2414"></a>          <span class="c">!       RE-ENGINEERED  R. Raustad, Oct 2005, moved Max/MinAvail to Init and allowed more than design</span>
<a name="ln-2415"></a>          <span class="c">!                      water flow rate to pass through towers (up to 2.5 and 1.25 times the design flow</span>
<a name="ln-2416"></a>          <span class="c">!                      for 1 or 2-speed and variable speed towers, respectively). Flow multiplier for</span>
<a name="ln-2417"></a>          <span class="c">!                      VS Tower is defaulted to 1.25 and can be reassigned by user.</span>
<a name="ln-2418"></a>
<a name="ln-2419"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2420"></a>          <span class="c">! This subroutine is for initializations of the Cooling Tower components and for</span>
<a name="ln-2421"></a>          <span class="c">! final checking of tower inputs (post autosizing)</span>
<a name="ln-2422"></a>
<a name="ln-2423"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2424"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-2425"></a>
<a name="ln-2426"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2427"></a>          <span class="c">! na</span>
<a name="ln-2428"></a>
<a name="ln-2429"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2430"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span>
<a name="ln-2431"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyTwbFnTdbWPb</span>
<a name="ln-2432"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-2433"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_CoolingTower_SingleSpd</span><span class="p">,</span> <span class="n">TypeOf_CoolingTower_TwoSpd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2434"></a>                             <span class="n">TypeOf_CoolingTower_VarSpd</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2435"></a>                             <span class="n">PlantSizesOkayToFinalize</span><span class="p">,</span> <span class="n">PlantSizeNotComplete</span><span class="p">,</span> <span class="n">TypeOf_CoolingTower_VarSpdMerkel</span>
<a name="ln-2436"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">SetComponentFlowRate</span><span class="p">,</span> <span class="n">RegulateCondenserCompFlowReqOp</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2439"></a>
<a name="ln-2440"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2441"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TowerNum</span>         <span class="c">! Number of the current cooling tower being simulated</span>
<a name="ln-2442"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunFlag</span>          <span class="c">! Indication of</span>
<a name="ln-2443"></a>
<a name="ln-2444"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2445"></a>          <span class="c">! na</span>
<a name="ln-2446"></a>
<a name="ln-2447"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2448"></a>          <span class="c">! na</span>
<a name="ln-2449"></a>
<a name="ln-2450"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2451"></a>          <span class="c">! na</span>
<a name="ln-2452"></a>
<a name="ln-2453"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2454"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>                           <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">! Flag if input data errors are found</span>
<a name="ln-2455"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>                           <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2456"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">Save</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>
<a name="ln-2457"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">Save</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">OneTimeFlagForEachTower</span>
<a name="ln-2458"></a><span class="c">!  LOGICAL                                 :: FatalError</span>
<a name="ln-2459"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">TypeOf_Num</span>
<a name="ln-2460"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-2461"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-2462"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">BranchIndex</span>
<a name="ln-2463"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-2464"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local density of fluid</span>
<a name="ln-2465"></a>
<a name="ln-2466"></a>  <span class="c">! Do the one time initializations</span>
<a name="ln-2467"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2468"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumSimpleTowers</span><span class="p">))</span>
<a name="ln-2469"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">OneTimeFlagForEachTower</span><span class="p">(</span><span class="n">NumSimpleTowers</span><span class="p">))</span>
<a name="ln-2470"></a>
<a name="ln-2471"></a>    <span class="n">OneTimeFlagForEachTower</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2472"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2473"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2474"></a>
<a name="ln-2475"></a>  <span class="k">END IF</span>
<a name="ln-2476"></a>
<a name="ln-2477"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">OneTimeFlagForEachTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2478"></a>
<a name="ln-2479"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_SingleSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2480"></a><span class="k">      </span><span class="n">TypeOf_Num</span> <span class="o">=</span> <span class="n">TypeOf_CoolingTower_SingleSpd</span>
<a name="ln-2481"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_TwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2482"></a><span class="k">      </span><span class="n">TypeOf_Num</span> <span class="o">=</span> <span class="n">TypeOf_CoolingTower_TwoSpd</span>
<a name="ln-2483"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_VariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2484"></a><span class="k">      </span><span class="n">TypeOf_Num</span> <span class="o">=</span> <span class="n">TypeOf_CoolingTower_VarSpd</span>
<a name="ln-2485"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_VariableSpeedMerkel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2486"></a><span class="k">      </span><span class="n">TypeOf_Num</span> <span class="o">=</span> <span class="n">TypeOf_CoolingTower_VarSpdMerkel</span>
<a name="ln-2487"></a>    <span class="n">ENDIF</span>
<a name="ln-2488"></a>
<a name="ln-2489"></a>    <span class="c">! Locate the tower on the plant loops for later usage</span>
<a name="ln-2490"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2491"></a>                                 <span class="n">TypeOf_Num</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2492"></a>                                 <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2493"></a>                                 <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2494"></a>                                 <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2495"></a>                                 <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2496"></a>                                 <span class="n">errFlag</span><span class="o">=</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2497"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2498"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitTower: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-2499"></a>    <span class="n">ENDIF</span>
<a name="ln-2500"></a>
<a name="ln-2501"></a>    <span class="c">! check if setpoint on outlet node</span>
<a name="ln-2502"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Node</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPoint</span> <span class="o">==</span> <span class="n">SensedNodeFlagValue</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2503"></a>        <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">)%</span><span class="n">TempSetPointHi</span> <span class="o">==</span> <span class="n">SensedNodeFlagValue</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2504"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SetpointIsOnOutlet</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2505"></a>    <span class="k">ELSE</span>
<a name="ln-2506"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SetpointIsOnOutlet</span> <span class="o">=</span>  <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2507"></a>    <span class="n">ENDIF</span>
<a name="ln-2508"></a>
<a name="ln-2509"></a>    <span class="n">OneTimeFlagForEachTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2510"></a>
<a name="ln-2511"></a>  <span class="k">END IF</span>
<a name="ln-2512"></a>
<a name="ln-2513"></a>  <span class="c">! Begin environment initializations</span>
<a name="ln-2514"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="p">)</span><span class="k">Then</span>
<a name="ln-2515"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PlantSizeNotComplete</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2516"></a><span class="k">      SELECT CASE</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span><span class="p">)</span>
<a name="ln-2517"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CoolingTower_SingleSpeed</span><span class="p">,</span> <span class="n">CoolingTower_TwoSpeed</span><span class="p">,</span> <span class="n">CoolingTower_VariableSpeed</span><span class="p">)</span>
<a name="ln-2518"></a>        <span class="k">CALL </span><span class="n">SizeTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-2519"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CoolingTower_VariableSpeedMerkel</span> <span class="p">)</span>
<a name="ln-2520"></a>        <span class="k">CALL </span><span class="n">SizeVSMerkelTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-2521"></a>      <span class="n">ENDSELECT</span>
<a name="ln-2522"></a>
<a name="ln-2523"></a>    <span class="n">ENDIF</span>
<a name="ln-2524"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2525"></a>                                <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2526"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-2527"></a>                                <span class="s1">&#39;InitTower&#39;</span><span class="p">)</span>
<a name="ln-2528"></a>
<a name="ln-2529"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2530"></a>                                                  <span class="n">rho</span>
<a name="ln-2531"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="p">&amp;</span>
<a name="ln-2532"></a>                                                            <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-2533"></a>    <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span>  <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2534"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2535"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2536"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-2537"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-2538"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-2539"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-2540"></a>
<a name="ln-2541"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2542"></a>  <span class="k">END IF</span>
<a name="ln-2543"></a>
<a name="ln-2544"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2545"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2546"></a>  <span class="n">ENDIF</span>
<a name="ln-2547"></a>
<a name="ln-2548"></a>  <span class="c">! Each time initializations</span>
<a name="ln-2549"></a>  <span class="n">WaterInletNode</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-2550"></a>  <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2551"></a>
<a name="ln-2552"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2553"></a><span class="k">    </span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2554"></a>    <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-2555"></a>    <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span>   <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-2556"></a><span class="c">!    SimpleTowerInlet(TowerNum)%AirWetBulb = PsyTwbFnTdbWPb(SimpleTowerInlet(TowerNum)%AirTemp, &amp;</span>
<a name="ln-2557"></a><span class="c">!                                            SimpleTowerInlet(TowerNum)%AirHumRat,SimpleTowerInlet(TowerNum)%AirPress)</span>
<a name="ln-2558"></a>    <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutdoorAirInletNodeNum</span><span class="p">)%</span><span class="n">OutAirWetBulb</span>
<a name="ln-2559"></a>  <span class="k">ELSE</span>
<a name="ln-2560"></a><span class="k">    </span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span>    <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-2561"></a>    <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span>  <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-2562"></a>    <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span>   <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-2563"></a>    <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-2564"></a>  <span class="n">ENDIF</span>
<a name="ln-2565"></a>
<a name="ln-2566"></a>  <span class="n">LoopNum</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span>
<a name="ln-2567"></a>  <span class="n">LoopSideNum</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span>
<a name="ln-2568"></a>  <span class="n">BranchIndex</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BranchNum</span>
<a name="ln-2569"></a>  <span class="n">CompIndex</span>   <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CompNum</span>
<a name="ln-2570"></a>
<a name="ln-2571"></a>  <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">RegulateCondenserCompFlowReqOp</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-2572"></a>                                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-2573"></a>                                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-2574"></a>                                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2575"></a>                                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="p">&amp;</span>
<a name="ln-2576"></a>                                                <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerMassFlowRateMultiplier</span><span class="p">)</span>
<a name="ln-2577"></a>
<a name="ln-2578"></a>
<a name="ln-2579"></a>  <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2580"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2581"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2582"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-2583"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-2584"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-2585"></a>                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-2586"></a>
<a name="ln-2587"></a>
<a name="ln-2588"></a>    <span class="c">! Added for fluid bypass. 8/2008</span>
<a name="ln-2589"></a>  <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2590"></a>  <span class="n">BasinHeaterPower</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2591"></a>
<a name="ln-2592"></a>  <span class="k">RETURN</span>
<a name="ln-2593"></a>
<a name="ln-2594"></a><span class="k">END SUBROUTINE </span><span class="n">InitTower</span>
<a name="ln-2595"></a>
<a name="ln-2596"></a>
<a name="ln-2597"></a><span class="k">SUBROUTINE </span><span class="n">SizeTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-2598"></a>
<a name="ln-2599"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2600"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-2601"></a>          <span class="c">!       DATE WRITTEN   May 2002</span>
<a name="ln-2602"></a>          <span class="c">!       MODIFIED       Don Shirey, Sept/Oct 2002; Richard Raustad, Feb 2005</span>
<a name="ln-2603"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2604"></a>
<a name="ln-2605"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2606"></a>          <span class="c">! This subroutine is for sizing Cooling Tower Components for which capacities and flow rates</span>
<a name="ln-2607"></a>          <span class="c">! have not been specified in the input. This subroutine also calculates tower UA if the user</span>
<a name="ln-2608"></a>          <span class="c">! has specified tower performance via the &quot;Nominal Capacity&quot; method.</span>
<a name="ln-2609"></a>
<a name="ln-2610"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2611"></a>          <span class="c">! Obtains condenser flow rate from the plant sizing array. If tower performance is specified</span>
<a name="ln-2612"></a>          <span class="c">! via the &quot;Nominal Capacity&quot; method, the water flow rate is directly proportional to capacity.</span>
<a name="ln-2613"></a>
<a name="ln-2614"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2615"></a>          <span class="c">! na</span>
<a name="ln-2616"></a>
<a name="ln-2617"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2618"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-2619"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">PlantSizesOkayToFinalize</span>
<a name="ln-2620"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-2621"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span>
<a name="ln-2622"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-2623"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-2624"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-2625"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2628"></a>
<a name="ln-2629"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2630"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-2631"></a>
<a name="ln-2632"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2633"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OutputFormat</span>  <span class="o">=</span><span class="s1">&#39;(F6.2)&#39;</span>
<a name="ln-2634"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OutputFormat2</span> <span class="o">=</span><span class="s1">&#39;(F9.6)&#39;</span>
<a name="ln-2635"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>          <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>       <span class="c">! Maximum number of iterations</span>
<a name="ln-2636"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">0.0001d0</span>    <span class="c">! Accuracy of result</span>
<a name="ln-2637"></a>
<a name="ln-2638"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2639"></a>          <span class="c">! na</span>
<a name="ln-2640"></a>
<a name="ln-2641"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2642"></a>          <span class="c">! na</span>
<a name="ln-2643"></a>
<a name="ln-2644"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2645"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">PltSizCondNum</span>          <span class="c">! Plant Sizing index for condenser loop</span>
<a name="ln-2646"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFla</span>                 <span class="c">! Flag of solver</span>
<a name="ln-2647"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesTowerLoad</span>           <span class="c">! Design tower load [W]</span>
<a name="ln-2648"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA0</span>                    <span class="c">! Lower bound for UA [W/C]</span>
<a name="ln-2649"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA1</span>                    <span class="c">! Upper bound for UA [W/C]</span>
<a name="ln-2650"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA</span>                     <span class="c">! Calculated UA value</span>
<a name="ln-2651"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Twb</span>                    <span class="c">! tower inlet air wet-bulb temperature [C]</span>
<a name="ln-2652"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Tr</span>                     <span class="c">! tower range temperature [C]</span>
<a name="ln-2653"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Ta</span>                     <span class="c">! tower approach temperature [C]</span>
<a name="ln-2654"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">WaterFlowRatio</span>         <span class="c">! tower water flow rate ratio found during model calibration</span>
<a name="ln-2655"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MaxWaterFlowRateRatio</span>  <span class="c">! maximum water flow rate ratio which yields desired approach temp</span>
<a name="ln-2656"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">WaterFlowRateRatio</span>     <span class="c">! tower water flow rate ratio</span>
<a name="ln-2657"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Tapproach</span>              <span class="c">! temporary tower approach temp variable [C]</span>
<a name="ln-2658"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ModelWaterFlowRatioMax</span> <span class="c">! maximum water flow rate ratio used for model calibration</span>
<a name="ln-2659"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FlowRateRatioStep</span>      <span class="c">! flow rate ratio to determine maximum water flow rate ratio during calibration</span>
<a name="ln-2660"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>                    <span class="c">! Parameter array need for RegulaFalsi routine</span>
<a name="ln-2661"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">ModelCalibrated</span>        <span class="c">! TRUE if water flow rate ratio is with the specified range</span>
<a name="ln-2662"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutputChar</span>             <span class="c">! report variable for warning messages</span>
<a name="ln-2663"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutputChar2</span>            <span class="c">! report variable for warning messages</span>
<a name="ln-2664"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutputCharLo</span>           <span class="c">! report variable for warning messages</span>
<a name="ln-2665"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutputCharHi</span>           <span class="c">! report variable for warning messages</span>
<a name="ln-2666"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">equipName</span>
<a name="ln-2667"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Cp</span>  <span class="c">! local specific heat for fluid</span>
<a name="ln-2668"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local density for fluid</span>
<a name="ln-2669"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="c">! local temporary for water volume flow rate</span>
<a name="ln-2670"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">tmpHighSpeedFanPower</span> <span class="c">!local temporary for high speed fan power</span>
<a name="ln-2671"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">tmpHighSpeedAirFlowRate</span> <span class="c">! local temporary for high speed air flow rate</span>
<a name="ln-2672"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">tmpHighSpeedTowerUA</span> <span class="c">! local temporary for high speed tower UA</span>
<a name="ln-2673"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">tmpLowSpeedAirFlowRate</span> <span class="c">!local temporary for low speed air flow rate</span>
<a name="ln-2674"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AssumedDeltaT</span> <span class="c">! default delta T for nominal capacity of hard sized with UA method</span>
<a name="ln-2675"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AssumedExitTemp</span> <span class="c">! default for cp fo nominal capacity of hard sized with UA method</span>
<a name="ln-2676"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-2677"></a>
<a name="ln-2678"></a>  <span class="n">PltSizCondNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2679"></a>  <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2680"></a>  <span class="n">tmpDesignWaterFlowRate</span>  <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span>
<a name="ln-2681"></a>  <span class="n">tmpHighSpeedFanPower</span>    <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span>
<a name="ln-2682"></a>  <span class="n">tmpHighSpeedAirFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>
<a name="ln-2683"></a>  <span class="n">tmpHighSpeedTowerUA</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span>
<a name="ln-2684"></a>  <span class="n">tmpLowSpeedAirFlowRate</span>  <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span>
<a name="ln-2685"></a>
<a name="ln-2686"></a>  <span class="c">! Find the appropriate Plant Sizing object</span>
<a name="ln-2687"></a>  <span class="n">PltSizCondNum</span> <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">PlantSizNum</span>
<a name="ln-2688"></a>
<a name="ln-2689"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_UFactor</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2690"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2691"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PltSizCondNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2692"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2693"></a>                                <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2694"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-2695"></a>                                <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2696"></a>      <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2697"></a>                               <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-2698"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2699"></a>                               <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2700"></a>      <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Cp</span>  <span class="p">&amp;</span>
<a name="ln-2701"></a>                      <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-2702"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="o">=</span><span class="n">DesTowerLoad</span><span class="o">/</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-2703"></a>    <span class="k">ELSE</span>
<a name="ln-2704"></a><span class="k">      </span><span class="n">AssumedDeltaT</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">1.d0</span>
<a name="ln-2705"></a>      <span class="n">AssumedExitTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">1.d0</span>
<a name="ln-2706"></a>      <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2707"></a>                                <span class="n">AssumedExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2708"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-2709"></a>                                <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2710"></a>      <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2711"></a>                               <span class="n">AssumedExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-2712"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2713"></a>                               <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2714"></a>
<a name="ln-2715"></a>      <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Cp</span>  <span class="p">&amp;</span>
<a name="ln-2716"></a>                      <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">*</span> <span class="n">AssumedDeltaT</span>
<a name="ln-2717"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="o">=</span><span class="n">DesTowerLoad</span><span class="o">/</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-2718"></a>    <span class="n">ENDIF</span>
<a name="ln-2719"></a>  <span class="k">END IF</span>
<a name="ln-2720"></a>
<a name="ln-2721"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2722"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PltSizCondNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2723"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2724"></a><span class="k">        </span><span class="n">tmpDesignWaterFlowRate</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span>
<a name="ln-2725"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignWaterFlowRate</span>
<a name="ln-2726"></a>      <span class="k">ELSE</span>
<a name="ln-2727"></a><span class="k">        </span><span class="n">tmpDesignWaterFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2728"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignWaterFlowRate</span>
<a name="ln-2729"></a>      <span class="n">ENDIF</span>
<a name="ln-2730"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2731"></a>                              <span class="s1">&#39;Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span><span class="p">)</span>
<a name="ln-2732"></a>    <span class="k">ELSE</span>
<a name="ln-2733"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing error for cooling tower object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2734"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower condenser flow rate requires a loop Sizing:Plant object.&#39;</span><span class="p">)</span>
<a name="ln-2735"></a>    <span class="n">ENDIF</span>
<a name="ln-2736"></a>  <span class="n">ENDIF</span>
<a name="ln-2737"></a>
<a name="ln-2738"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_NominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2739"></a>    <span class="c">! Design water flow rate is assumed to be 3 gpm per ton (SI equivalent 5.382E-8 m3/s per watt)</span>
<a name="ln-2740"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">=</span> <span class="mf">5.382d-8</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>
<a name="ln-2741"></a>    <span class="n">tmpDesignWaterFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span>
<a name="ln-2742"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span> <span class="p">,</span> <span class="s1">&#39;CoolingTower:SingleSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2743"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2744"></a>                              <span class="s1">&#39;Design water flow rate based on tower nominal capacity [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2745"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span><span class="p">)</span>
<a name="ln-2746"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span> <span class="p">,</span> <span class="s1">&#39;CoolingTower:TwoSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2747"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2748"></a>                              <span class="s1">&#39;Design water flow rate based on tower high-speed nominal capacity [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2749"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span><span class="p">)</span>
<a name="ln-2750"></a>    <span class="n">ENDIF</span>
<a name="ln-2751"></a>  <span class="n">ENDIF</span>
<a name="ln-2752"></a>
<a name="ln-2753"></a>  <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span><span class="n">tmpDesignWaterFlowRate</span><span class="p">)</span>
<a name="ln-2754"></a>
<a name="ln-2755"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2756"></a>    <span class="c">! We assume the nominal fan power is 0.0105 times the design load</span>
<a name="ln-2757"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_NominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2758"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">=</span> <span class="mf">0.0105d0</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>
<a name="ln-2759"></a>    <span class="k">ELSE</span>
<a name="ln-2760"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PltSizCondNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2761"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2762"></a><span class="k">          </span><span class="n">rho</span>   <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2763"></a>                            <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2764"></a>                            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-2765"></a>                            <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2766"></a>          <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2767"></a>                               <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-2768"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2769"></a>                               <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2770"></a>          <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-2771"></a>          <span class="n">tmpHighSpeedFanPower</span> <span class="o">=</span>  <span class="mf">0.0105d0</span> <span class="o">*</span> <span class="n">DesTowerLoad</span>
<a name="ln-2772"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">=</span>  <span class="n">tmpHighSpeedFanPower</span>
<a name="ln-2773"></a>        <span class="k">ELSE</span>
<a name="ln-2774"></a><span class="k">          </span><span class="n">tmpHighSpeedFanPower</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2775"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">=</span> <span class="n">tmpHighSpeedFanPower</span>
<a name="ln-2776"></a>        <span class="n">ENDIF</span>
<a name="ln-2777"></a>      <span class="k">ELSE</span>
<a name="ln-2778"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower fan power requires a loop Sizing:Plant object.&#39;</span><span class="p">)</span>
<a name="ln-2779"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39; Occurs in cooling tower object= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2780"></a>      <span class="n">ENDIF</span>
<a name="ln-2781"></a>    <span class="n">ENDIF</span>
<a name="ln-2782"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_SingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2783"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_VariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2784"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2785"></a>                             <span class="s1">&#39;Fan Power at Design Air Flow Rate [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span><span class="p">)</span>
<a name="ln-2786"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_TwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2787"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2788"></a>                             <span class="s1">&#39;Fan Power at High Fan Speed [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span><span class="p">)</span>
<a name="ln-2789"></a>    <span class="n">ENDIF</span>
<a name="ln-2790"></a>  <span class="n">ENDIF</span>
<a name="ln-2791"></a>
<a name="ln-2792"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2793"></a><span class="c">! Plant Sizing Object is not required to AUTOSIZE this field since its simply a multiple of another field.</span>
<a name="ln-2794"></a>    <span class="n">tmpHighSpeedAirFlowRate</span> <span class="o">=</span> <span class="n">tmpHighSpeedFanPower</span> <span class="o">*</span> <span class="mf">0.5d0</span> <span class="p">&amp;</span>
<a name="ln-2795"></a>                                 <span class="o">*</span> <span class="p">(</span><span class="mi">10132</span><span class="mf">5.d0</span><span class="o">/</span><span class="n">StdBaroPress</span><span class="p">)</span> <span class="o">/</span> <span class="mi">19</span><span class="mf">0.d0</span>
<a name="ln-2796"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>  <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">=</span> <span class="n">tmpHighSpeedAirFlowRate</span>
<a name="ln-2797"></a>
<a name="ln-2798"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_SingleSpeed</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2799"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_VariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2800"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2801"></a>                              <span class="s1">&#39;Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span><span class="p">)</span>
<a name="ln-2802"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_TwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2803"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2804"></a>                              <span class="s1">&#39;Air Flow Rate at High Fan Speed [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span><span class="p">)</span>
<a name="ln-2805"></a>    <span class="n">ENDIF</span>
<a name="ln-2806"></a>  <span class="n">ENDIF</span>
<a name="ln-2807"></a>
<a name="ln-2808"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2809"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PltSizCondNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2810"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2811"></a><span class="k">        </span><span class="n">rho</span>   <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2812"></a>                            <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2813"></a>                            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-2814"></a>                            <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2815"></a>        <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2816"></a>                               <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-2817"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2818"></a>                               <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2819"></a>        <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-2820"></a>
<a name="ln-2821"></a>        <span class="c">! This conditional statement is to trap when the user specified condenser/tower water design setpoint</span>
<a name="ln-2822"></a>        <span class="c">!  temperature is less than design inlet air wet bulb temperature of 25.6 C</span>
<a name="ln-2823"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="mf">5.6d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2824"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Error when autosizing the UA value for cooling tower = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2825"></a>                               <span class="s1">&#39;.&#39;</span><span class="o">//</span><span class="s1">&#39; Design Loop Exit Temperature must be greater than 25.6 C when autosizing the tower UA.&#39;</span><span class="p">)</span>
<a name="ln-2826"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The Design Loop Exit Temperature specified in Sizing:Plant object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2827"></a>                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">PlantLoopName</span><span class="p">))</span>
<a name="ln-2828"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;is less than or equal to the design inlet air wet-bulb temperature of 25.6 C.&#39;</span><span class="p">)</span>
<a name="ln-2829"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;It is recommended that the Design Loop Exit Temperature = 25.6 C plus &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2830"></a>                                 <span class="s1">&#39;the cooling tower design approach temperature (e.g., 4 C).&#39;</span><span class="p">)</span>
<a name="ln-2831"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;If using HVACTemplate:Plant:ChilledWaterLoop, then check that input field &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2832"></a>                                 <span class="s1">&#39;Condenser Water Design Setpoint must be &gt; 25.6 C if autosizing the cooling tower.&#39;</span><span class="p">)</span>
<a name="ln-2833"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower fails for tower = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-2834"></a>        <span class="n">ENDIF</span>
<a name="ln-2835"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesTowerLoad</span>
<a name="ln-2836"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-2837"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="c">! design water mass flow rate</span>
<a name="ln-2838"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpHighSpeedAirFlowRate</span> <span class="c">! design air volume flow rate</span>
<a name="ln-2839"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cp</span>
<a name="ln-2840"></a>        <span class="n">UA0</span> <span class="o">=</span> <span class="mf">0.0001d0</span> <span class="o">*</span> <span class="n">DesTowerLoad</span> <span class="c">! Assume deltaT = 10000K (limit)</span>
<a name="ln-2841"></a>        <span class="n">UA1</span> <span class="o">=</span> <span class="n">DesTowerLoad</span>          <span class="c">! Assume deltaT = 1K</span>
<a name="ln-2842"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span> <span class="o">+</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-2843"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>
<a name="ln-2844"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.6d0</span>
<a name="ln-2845"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-2846"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2847"></a>           <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-2848"></a>                          <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2849"></a>                          <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-2850"></a><span class="c">!        SimpleTowerInlet(TowerNum)%AirHumRat = PsyWFnTdbTwbPb(35.,25.6,StdBaroPress)</span>
<a name="ln-2851"></a>        <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleTowerUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-2852"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2853"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower UA&#39;</span><span class="p">)</span>
<a name="ln-2854"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2855"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2856"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-2857"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2858"></a>        <span class="n">ENDIF</span>
<a name="ln-2859"></a>
<a name="ln-2860"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2861"></a><span class="k">          </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-2862"></a>        <span class="k">ELSE</span>
<a name="ln-2863"></a><span class="k">          </span><span class="n">tmpHighSpeedTowerUA</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-2864"></a>        <span class="n">ENDIF</span>
<a name="ln-2865"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="o">=</span><span class="n">DesTowerLoad</span><span class="o">/</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-2866"></a>      <span class="k">ELSE</span>
<a name="ln-2867"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2868"></a><span class="k">          </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2869"></a>        <span class="k">ELSE</span>
<a name="ln-2870"></a><span class="k">          </span><span class="n">tmpHighSpeedTowerUA</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2871"></a>        <span class="n">ENDIF</span>
<a name="ln-2872"></a>      <span class="n">ENDIF</span>
<a name="ln-2873"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_SingleSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2874"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2875"></a>                              <span class="s1">&#39;U-Factor Times Area Value at Design Air Flow Rate [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2876"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span><span class="p">)</span>
<a name="ln-2877"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_TwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2878"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2879"></a>                              <span class="s1">&#39;U-Factor Times Area Value at High Fan Speed [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2880"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span><span class="p">)</span>
<a name="ln-2881"></a>      <span class="n">ENDIF</span>
<a name="ln-2882"></a>    <span class="k">ELSE</span>
<a name="ln-2883"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing error for cooling tower object= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2884"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA requires a loop Sizing:Plant object.&#39;</span><span class="p">)</span>
<a name="ln-2885"></a>    <span class="n">ENDIF</span>
<a name="ln-2886"></a>  <span class="n">ENDIF</span>
<a name="ln-2887"></a>
<a name="ln-2888"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_NominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2889"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2890"></a>      <span class="c">! nominal capacity doesn&#39;t include compressor heat; predefined factor was 1.25 W heat rejection per W of delivered cooling</span>
<a name="ln-2891"></a>      <span class="c">! but now is a user input</span>
<a name="ln-2892"></a>      <span class="n">rho</span>   <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2893"></a>                          <span class="mi">2</span><span class="mf">9.44d0</span><span class="p">,</span>     <span class="p">&amp;</span> <span class="c">! 85F design exiting water temp</span>
<a name="ln-2894"></a>                          <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-2895"></a>                          <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2896"></a>      <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2897"></a>                             <span class="mi">2</span><span class="mf">9.44d0</span><span class="p">,</span>     <span class="p">&amp;</span> <span class="c">! 85F design exiting water temp</span>
<a name="ln-2898"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2899"></a>                             <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-2900"></a>
<a name="ln-2901"></a>      <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-2902"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesTowerLoad</span>
<a name="ln-2903"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-2904"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="c">! design water mass flow rate</span>
<a name="ln-2905"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpHighSpeedAirFlowRate</span> <span class="c">! design air volume flow rate</span>
<a name="ln-2906"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cp</span> <span class="c">! 85F design exiting water temp</span>
<a name="ln-2907"></a>      <span class="n">UA0</span> <span class="o">=</span> <span class="mf">0.0001d0</span> <span class="o">*</span> <span class="n">DesTowerLoad</span> <span class="c">! Assume deltaT = 10000K (limit)</span>
<a name="ln-2908"></a>      <span class="n">UA1</span> <span class="o">=</span> <span class="n">DesTowerLoad</span>          <span class="c">! Assume deltaT = 1K</span>
<a name="ln-2909"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>   <span class="c">! 95F design inlet water temperature</span>
<a name="ln-2910"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>     <span class="c">! 95F design inlet air dry-bulb temp</span>
<a name="ln-2911"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.6d0</span> <span class="c">! 78F design inlet air wet-bulb temp</span>
<a name="ln-2912"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-2913"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2914"></a>         <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2915"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2916"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-2917"></a><span class="c">!      SimpleTowerInlet(TowerNum)%AirHumRat = PsyWFnTdbTwbPb(35.,25.6,StdBaroPress)</span>
<a name="ln-2918"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleTowerUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-2919"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2920"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower UA&#39;</span><span class="p">)</span>
<a name="ln-2921"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2922"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2923"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-2924"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2925"></a>      <span class="n">ENDIF</span>
<a name="ln-2926"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-2927"></a>    <span class="k">ELSE</span>
<a name="ln-2928"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2929"></a>    <span class="n">ENDIF</span>
<a name="ln-2930"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_SingleSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2931"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2932"></a>                              <span class="s1">&#39;U-Factor Times Area Value at Design Air Flow Rate [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2933"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span><span class="p">)</span>
<a name="ln-2934"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_TwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2935"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2936"></a>                              <span class="s1">&#39;U-Factor Times Area Value at High Fan Speed [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2937"></a>                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span><span class="p">)</span>
<a name="ln-2938"></a>    <span class="n">ENDIF</span>
<a name="ln-2939"></a>  <span class="n">ENDIF</span>
<a name="ln-2940"></a>
<a name="ln-2941"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2942"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2943"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRateSizingFactor</span> <span class="p">&amp;</span>
<a name="ln-2944"></a>                                                   <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>
<a name="ln-2945"></a>      <span class="n">tmpLowSpeedAirFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span>
<a name="ln-2946"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2947"></a>                              <span class="s1">&#39;Low Fan Speed Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span><span class="p">)</span>
<a name="ln-2948"></a>    <span class="k">ELSE</span>
<a name="ln-2949"></a><span class="k">      </span><span class="n">tmpLowSpeedAirFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRateSizingFactor</span> <span class="o">*</span> <span class="n">tmpHighSpeedAirFlowRate</span>
<a name="ln-2950"></a>    <span class="n">ENDIF</span>
<a name="ln-2951"></a>  <span class="n">ENDIF</span>
<a name="ln-2952"></a>
<a name="ln-2953"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedFanPower</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2954"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2955"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedFanPower</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedFanPowerSizingFactor</span> <span class="p">&amp;</span>
<a name="ln-2956"></a>                                                <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span>
<a name="ln-2957"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2958"></a>                              <span class="s1">&#39;Fan Power at Low Fan Speed [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedFanPower</span><span class="p">)</span>
<a name="ln-2959"></a>    <span class="n">ENDIF</span>
<a name="ln-2960"></a>  <span class="n">ENDIF</span>
<a name="ln-2961"></a>
<a name="ln-2962"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2963"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUASizingFactor</span> <span class="p">&amp;</span>
<a name="ln-2964"></a>                                               <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span>
<a name="ln-2965"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2966"></a>                              <span class="s1">&#39;U-Factor Times Area Value at Low Fan Speed [W/K]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span><span class="p">)</span>
<a name="ln-2967"></a>  <span class="n">ENDIF</span>
<a name="ln-2968"></a>
<a name="ln-2969"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_NominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2970"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCap</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2971"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2972"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCapSizingFactor</span> <span class="p">&amp;</span>
<a name="ln-2973"></a>                                                     <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>
<a name="ln-2974"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2975"></a>                                <span class="s1">&#39;Low Speed Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2976"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCap</span><span class="p">)</span>
<a name="ln-2977"></a>      <span class="n">ENDIF</span>
<a name="ln-2978"></a>    <span class="n">ENDIF</span>
<a name="ln-2979"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2980"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2981"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCapSizingFactor</span> <span class="p">&amp;</span>
<a name="ln-2982"></a>                                                     <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>
<a name="ln-2983"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2984"></a>                                <span class="s1">&#39;Free Convection Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2985"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span><span class="p">)</span>
<a name="ln-2986"></a>      <span class="n">ENDIF</span>
<a name="ln-2987"></a>    <span class="n">ENDIF</span>
<a name="ln-2988"></a>
<a name="ln-2989"></a>  <span class="n">ENDIF</span>
<a name="ln-2990"></a>
<a name="ln-2991"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_NominalCapacity</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2992"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span> <span class="p">,</span> <span class="s1">&#39;CoolingTower:TwoSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2993"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCap</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2994"></a>      <span class="c">! nominal capacity doesn&#39;t include compressor heat; predefined factor wass 1.25 W heat rejection per W of evap cooling</span>
<a name="ln-2995"></a>       <span class="c">! but now is a user input</span>
<a name="ln-2996"></a>      <span class="n">rho</span>   <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2997"></a>                          <span class="mi">2</span><span class="mf">9.44d0</span><span class="p">,</span>     <span class="p">&amp;</span> <span class="c">! 85F design exiting water temp</span>
<a name="ln-2998"></a>                          <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-2999"></a>                          <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3000"></a>      <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3001"></a>                             <span class="mi">2</span><span class="mf">9.44d0</span><span class="p">,</span>     <span class="p">&amp;</span> <span class="c">! 85F design exiting water temp</span>
<a name="ln-3002"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3003"></a>                             <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3004"></a>      <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerLowSpeedNomCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3005"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesTowerLoad</span>
<a name="ln-3006"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3007"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="c">! design water mass flow rate</span>
<a name="ln-3008"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpLowSpeedAirFlowRate</span> <span class="c">! Air volume flow rate at low fan speed</span>
<a name="ln-3009"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cp</span> <span class="c">! 85F design exiting water temp</span>
<a name="ln-3010"></a>      <span class="n">UA0</span> <span class="o">=</span> <span class="mf">0.0001d0</span> <span class="o">*</span> <span class="n">DesTowerLoad</span> <span class="c">! Assume deltaT = 10000K (limit)</span>
<a name="ln-3011"></a>      <span class="n">UA1</span> <span class="o">=</span> <span class="n">DesTowerLoad</span>          <span class="c">! Assume deltaT = 1K</span>
<a name="ln-3012"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>   <span class="c">! 95F design inlet water temperature</span>
<a name="ln-3013"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>     <span class="c">! 95F design inlet air dry-bulb temp</span>
<a name="ln-3014"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.6d0</span> <span class="c">! 78F design inlet air wet-bulb temp</span>
<a name="ln-3015"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-3016"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3017"></a>         <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3018"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3019"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-3020"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleTowerUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3021"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3022"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower UA&#39;</span><span class="p">)</span>
<a name="ln-3023"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3024"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3025"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-3026"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3027"></a>        <span class="n">ENDIF</span>
<a name="ln-3028"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-3029"></a>    <span class="k">ELSE</span>
<a name="ln-3030"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3031"></a>    <span class="n">ENDIF</span>
<a name="ln-3032"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3033"></a>                            <span class="s1">&#39;Low Fan Speed U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3034"></a>                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span><span class="p">)</span>
<a name="ln-3035"></a>  <span class="n">ENDIF</span>
<a name="ln-3036"></a>
<a name="ln-3037"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3038"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3039"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRateSizingFactor</span> <span class="p">&amp;</span>
<a name="ln-3040"></a>                                                   <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>
<a name="ln-3041"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3042"></a>                              <span class="s1">&#39;Free Convection Regime Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span><span class="p">)</span>
<a name="ln-3043"></a>    <span class="n">ENDIF</span>
<a name="ln-3044"></a>  <span class="n">ENDIF</span>
<a name="ln-3045"></a>
<a name="ln-3046"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3047"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3048"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUASizingFactor</span> <span class="p">&amp;</span>
<a name="ln-3049"></a>                                               <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span>
<a name="ln-3050"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3051"></a>                              <span class="s1">&#39;Free Convection U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3052"></a>                               <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span><span class="p">)</span>
<a name="ln-3053"></a>    <span class="n">ENDIF</span>
<a name="ln-3054"></a>  <span class="n">ENDIF</span>
<a name="ln-3055"></a>
<a name="ln-3056"></a>
<a name="ln-3057"></a>
<a name="ln-3058"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_NominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3059"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3060"></a>      <span class="c">! nominal capacity doesn&#39;t include compressor heat; predefined factor was 1.25 W heat rejection per W of evap cooling,</span>
<a name="ln-3061"></a>      <span class="c">! but now user input</span>
<a name="ln-3062"></a>      <span class="n">rho</span>   <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3063"></a>                          <span class="mi">2</span><span class="mf">9.44d0</span><span class="p">,</span>     <span class="p">&amp;</span> <span class="c">! 85F design exiting water temp</span>
<a name="ln-3064"></a>                          <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-3065"></a>                          <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3066"></a>      <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3067"></a>                             <span class="mi">2</span><span class="mf">9.44d0</span><span class="p">,</span>     <span class="p">&amp;</span> <span class="c">! 85F design exiting water temp</span>
<a name="ln-3068"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3069"></a>                             <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3070"></a>      <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3071"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesTowerLoad</span>
<a name="ln-3072"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3073"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="c">! design water mass flow rate</span>
<a name="ln-3074"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="c">! free convection air volume flow rate</span>
<a name="ln-3075"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cp</span> <span class="c">! 85F design exiting water temp</span>
<a name="ln-3076"></a>      <span class="n">UA0</span> <span class="o">=</span> <span class="mf">0.0001d0</span> <span class="o">*</span> <span class="n">DesTowerLoad</span> <span class="c">! Assume deltaT = 10000K (limit)</span>
<a name="ln-3077"></a>      <span class="n">UA1</span> <span class="o">=</span> <span class="n">DesTowerLoad</span>          <span class="c">! Assume deltaT = 1K</span>
<a name="ln-3078"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>   <span class="c">! 95F design inlet water temperature</span>
<a name="ln-3079"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>     <span class="c">! 95F design inlet air dry-bulb temp</span>
<a name="ln-3080"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.6d0</span> <span class="c">! 78F design inlet air wet-bulb temp</span>
<a name="ln-3081"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-3082"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3083"></a>         <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3084"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3085"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-3086"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleTowerUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3087"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3088"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower UA&#39;</span><span class="p">)</span>
<a name="ln-3089"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3090"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3091"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-3092"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3093"></a>      <span class="n">ENDIF</span>
<a name="ln-3094"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-3095"></a>    <span class="k">ELSE</span>
<a name="ln-3096"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3097"></a>    <span class="n">ENDIF</span>
<a name="ln-3098"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3099"></a>                            <span class="s1">&#39;U-Factor Times Area Value at Free Convection Air Flow Rate [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3100"></a>                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span><span class="p">)</span>
<a name="ln-3101"></a>  <span class="n">ENDIF</span>
<a name="ln-3102"></a>
<a name="ln-3103"></a>
<a name="ln-3104"></a>
<a name="ln-3105"></a><span class="c">! calibrate variable speed tower model based on user input by finding calibration water flow rate ratio that</span>
<a name="ln-3106"></a><span class="c">! yields an approach temperature that matches user input</span>
<a name="ln-3107"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span> <span class="p">,</span> <span class="s1">&#39;CoolingTower:VariableSpeed&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3108"></a>
<a name="ln-3109"></a><span class="k">    </span><span class="n">Twb</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignInletWB</span>
<a name="ln-3110"></a>    <span class="n">Tr</span>      <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignRange</span>
<a name="ln-3111"></a>    <span class="n">Ta</span>      <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignApproach</span>
<a name="ln-3112"></a>
<a name="ln-3113"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TowerNum</span> <span class="c">! Index to cooling tower</span>
<a name="ln-3114"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>      <span class="c">! air flow rate ratio</span>
<a name="ln-3115"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Twb</span>      <span class="c">! inlet air wet-bulb temperature [C]</span>
<a name="ln-3116"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Tr</span>       <span class="c">! tower range temperature [C]</span>
<a name="ln-3117"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Ta</span>       <span class="c">! design approach temperature [C]</span>
<a name="ln-3118"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Calculation FLAG, 0.0 = calc water flow ratio, 1.0 calc air flow ratio</span>
<a name="ln-3119"></a>
<a name="ln-3120"></a><span class="c">!   check range for water flow rate ratio (make sure RegulaFalsi converges)</span>
<a name="ln-3121"></a>    <span class="n">MaxWaterFlowRateRatio</span> <span class="o">=</span> <span class="mf">0.5d0</span>
<a name="ln-3122"></a>    <span class="n">Tapproach</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3123"></a>    <span class="n">FlowRateRatioStep</span> <span class="o">=</span> <span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-3124"></a>                         <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span><span class="p">)</span><span class="o">/</span><span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-3125"></a>    <span class="n">ModelCalibrated</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3126"></a>    <span class="n">ModelWaterFlowRatioMax</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span> <span class="o">*</span> <span class="mf">4.0d0</span>
<a name="ln-3127"></a><span class="c">!   find a flow rate large enough to provide an approach temperature &gt; than the user defined approach</span>
<a name="ln-3128"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">Tapproach</span> <span class="o">&lt;</span> <span class="n">Ta</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MaxWaterFlowRateRatio</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">ModelWaterFlowRatioMax</span><span class="p">)</span>
<a name="ln-3129"></a>      <span class="n">WaterFlowRateRatio</span> <span class="o">=</span> <span class="n">MaxWaterFlowRateRatio</span>
<a name="ln-3130"></a>      <span class="k">CALL </span><span class="n">CalcVSTowerApproach</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterFlowRateRatio</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Twb</span><span class="p">,</span><span class="n">Tr</span><span class="p">,</span><span class="n">Tapproach</span><span class="p">)</span>
<a name="ln-3131"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Tapproach</span> <span class="o">&lt;</span> <span class="n">Ta</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3132"></a><span class="k">        </span><span class="n">MaxWaterFlowRateRatio</span> <span class="o">=</span> <span class="n">MaxWaterFlowRateRatio</span> <span class="o">+</span> <span class="n">FlowRateRatioStep</span>
<a name="ln-3133"></a>      <span class="k">END IF</span>
<a name="ln-3134"></a>      <span class="c">! a water flow rate large enough to provide an approach temperature &gt; than the user defined approach does not exist</span>
<a name="ln-3135"></a>      <span class="c">! within the tolerances specified by the user</span>
<a name="ln-3136"></a>      <span class="k">IF</span><span class="p">((</span><span class="n">MaxWaterFlowRateRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.5d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Tapproach</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Ta</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">MaxWaterFlowRateRatio</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">ModelWaterFlowRatioMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3137"></a><span class="k">        </span><span class="n">ModelCalibrated</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3138"></a>        <span class="k">EXIT</span>
<a name="ln-3139"></a><span class="k">      END IF</span>
<a name="ln-3140"></a><span class="k">    END DO</span>
<a name="ln-3141"></a>
<a name="ln-3142"></a><span class="k">    IF</span><span class="p">(</span><span class="n">ModelCalibrated</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3143"></a><span class="k">      CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">WaterFlowRatio</span><span class="p">,</span> <span class="n">SimpleTowerApproachResidual</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3144"></a>                               <span class="n">constant_pointfive</span><span class="p">,</span> <span class="n">MaxWaterFlowRateRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3145"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3146"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower water flow ratio during calibration&#39;</span><span class="p">)</span>
<a name="ln-3147"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Inlet air wet-bulb, range, and/or approach temperature does not allow calibration of&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3148"></a>                               <span class="s1">&#39;water flow rate ratio for this variable-speed cooling tower.&#39;</span><span class="p">)</span>
<a name="ln-3149"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Cooling tower calibration failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3150"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3151"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for cooling tower water flow rate ratio calibration.&#39;</span><span class="p">)</span>
<a name="ln-3152"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Inlet air wet-bulb, range, and/or approach temperature does not allow calibration of&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3153"></a>                               <span class="s1">&#39;water flow rate ratio for this variable-speed cooling tower.&#39;</span><span class="p">)</span>
<a name="ln-3154"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Cooling tower calibration failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-3155"></a>      <span class="n">ENDIF</span>
<a name="ln-3156"></a>    <span class="k">ELSE</span>
<a name="ln-3157"></a><span class="k">      WRITE</span><span class="p">(</span><span class="n">OutputChar2</span><span class="p">,</span><span class="n">OutputFormat2</span><span class="p">)</span><span class="n">WaterFlowRateRatio</span>
<a name="ln-3158"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">Tapproach</span>
<a name="ln-3159"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for cooling tower water flow rate ratio calibration.&#39;</span><span class="p">)</span>
<a name="ln-3160"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Design inlet air wet-bulb or range temperature must be modified to achieve the design approach&#39;</span><span class="p">)</span>
<a name="ln-3161"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;A water flow rate ratio of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; was calculated to yield an &#39;</span> <span class="p">&amp;</span>
<a name="ln-3162"></a>                             <span class="o">//</span><span class="s1">&#39;approach temperature of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-3163"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Cooling tower calibration failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-3164"></a>    <span class="k">END IF</span>
<a name="ln-3165"></a>
<a name="ln-3166"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CalibratedWaterFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span><span class="o">/</span><span class="n">WaterFlowRatio</span>
<a name="ln-3167"></a>
<a name="ln-3168"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WaterFlowRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3169"></a>       <span class="n">WaterFlowRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3170"></a><span class="k">      WRITE</span><span class="p">(</span><span class="n">OutputChar2</span><span class="p">,</span><span class="n">OutputFormat2</span><span class="p">)</span><span class="n">WaterFlowRatio</span>
<a name="ln-3171"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span>
<a name="ln-3172"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span>
<a name="ln-3173"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CoolingTower:VariableSpeed, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3174"></a>                     <span class="s1">&#39;&quot; the calibrated water flow rate ratio is determined to be &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar2</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3175"></a>                     <span class="o">//</span><span class="s1">&#39;. This is outside the valid range of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-3176"></a>    <span class="k">END IF</span>
<a name="ln-3177"></a>
<a name="ln-3178"></a><span class="k">    </span><span class="n">rho</span>   <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3179"></a>                          <span class="p">(</span><span class="n">Twb</span><span class="o">+</span><span class="n">Ta</span><span class="o">+</span><span class="n">Tr</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3180"></a>                          <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-3181"></a>                          <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3182"></a>    <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3183"></a>                             <span class="p">(</span><span class="n">Twb</span><span class="o">+</span><span class="n">Ta</span><span class="o">+</span><span class="n">Tr</span><span class="p">),</span>                      <span class="p">&amp;</span>
<a name="ln-3184"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3185"></a>                             <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3186"></a>
<a name="ln-3187"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">=</span> <span class="p">((</span><span class="n">rho</span> <span class="o">*</span><span class="n">tmpDesignWaterFlowRate</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3188"></a>                                                   <span class="n">Cp</span> <span class="o">*</span> <span class="n">Tr</span><span class="p">)</span>
<a name="ln-3189"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3190"></a>                           <span class="s1">&#39;Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span>
<a name="ln-3191"></a>
<a name="ln-3192"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3193"></a>                                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>
<a name="ln-3194"></a>
<a name="ln-3195"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3196"></a>                           <span class="s1">&#39;Air flow rate in free convection regime [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span><span class="p">)</span>
<a name="ln-3197"></a>
<a name="ln-3198"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3199"></a>                                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvectionCapacityFraction</span>
<a name="ln-3200"></a>
<a name="ln-3201"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3202"></a>                           <span class="s1">&#39;Tower capacity in free convection regime at design conditions [W]&#39;</span> <span class="p">&amp;</span>
<a name="ln-3203"></a>                           <span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span><span class="p">)</span>
<a name="ln-3204"></a>
<a name="ln-3205"></a>  <span class="k">END IF</span>
<a name="ln-3206"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3207"></a>    <span class="c">!create predefined report</span>
<a name="ln-3208"></a>    <span class="n">equipName</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-3209"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchMechType</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span>
<a name="ln-3210"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchMechNomCap</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span>
<a name="ln-3211"></a>  <span class="n">ENDIF</span>
<a name="ln-3212"></a>
<a name="ln-3213"></a>  <span class="c">! input error checking</span>
<a name="ln-3214"></a>  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3215"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3216"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_SingleSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3217"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3218"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">&gt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3219"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cCoolingTower_SingleSpeed</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3220"></a>                               <span class="s1">&#39;&quot;. Free convection air flow rate must be less than the design air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-3221"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3222"></a>        <span class="k">END IF</span>
<a name="ln-3223"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">&gt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3224"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cCoolingTower_SingleSpeed</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3225"></a>                               <span class="s1">&#39;&quot;. Free convection UA must be less than the design tower UA.&#39;</span><span class="p">)</span>
<a name="ln-3226"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3227"></a>        <span class="k">END IF</span>
<a name="ln-3228"></a><span class="k">      END IF</span>
<a name="ln-3229"></a><span class="k">    END IF</span>
<a name="ln-3230"></a>
<a name="ln-3231"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType_Num</span> <span class="o">==</span> <span class="n">CoolingTower_TwoSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3232"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3233"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3234"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cCoolingTower_TwoSpeed</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3235"></a>                               <span class="s1">&#39;&quot;. Low speed air flow rate must be less than the high speed air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-3236"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3237"></a>        <span class="n">ENDIF</span>
<a name="ln-3238"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3239"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cCoolingTower_TwoSpeed</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3240"></a>                                <span class="s1">&#39;&quot;. Free convection air flow rate must be less than the low speed air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-3241"></a>           <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3242"></a>        <span class="n">ENDIF</span>
<a name="ln-3243"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3244"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cCoolingTower_TwoSpeed</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3245"></a>                                <span class="s1">&#39;&quot;. Tower UA at low fan speed must be less than the tower UA at high fan speed.&#39;</span><span class="p">)</span>
<a name="ln-3246"></a>           <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3247"></a>        <span class="n">ENDIF</span>
<a name="ln-3248"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="o">&lt;=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3249"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">cCoolingTower_TwoSpeed</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3250"></a>                              <span class="s1">&#39;&quot;. Tower UA at free convection air flow rate must be less than the tower UA at low fan speed.&#39;</span><span class="p">)</span>
<a name="ln-3251"></a>           <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3252"></a>        <span class="n">ENDIF</span>
<a name="ln-3253"></a>      <span class="k">END IF</span>
<a name="ln-3254"></a><span class="k">    END IF</span>
<a name="ln-3255"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3256"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitTower: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-3257"></a>    <span class="n">ENDIF</span>
<a name="ln-3258"></a>  <span class="n">ENDIF</span>
<a name="ln-3259"></a>
<a name="ln-3260"></a>  <span class="k">RETURN</span>
<a name="ln-3261"></a><span class="k">END SUBROUTINE </span><span class="n">SizeTower</span>
<a name="ln-3262"></a>
<a name="ln-3263"></a><span class="k">SUBROUTINE </span><span class="n">SizeVSMerkelTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-3264"></a>
<a name="ln-3265"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3266"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-3267"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-3268"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3269"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3270"></a>
<a name="ln-3271"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3272"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3273"></a>
<a name="ln-3274"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3275"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3276"></a>
<a name="ln-3277"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3278"></a>          <span class="c">! na</span>
<a name="ln-3279"></a>
<a name="ln-3280"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3281"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-3282"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">PlantSizesOkayToFinalize</span>
<a name="ln-3283"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span>
<a name="ln-3284"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-3285"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-3286"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-3287"></a>
<a name="ln-3288"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3289"></a>
<a name="ln-3290"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3291"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-3292"></a>
<a name="ln-3293"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3294"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>       <span class="c">! Maximum number of iterations</span>
<a name="ln-3295"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">0.0001d0</span>    <span class="c">! Accuracy of result</span>
<a name="ln-3296"></a>
<a name="ln-3297"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3298"></a>          <span class="c">! na</span>
<a name="ln-3299"></a>
<a name="ln-3300"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3301"></a>          <span class="c">! na</span>
<a name="ln-3302"></a>
<a name="ln-3303"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3304"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">PltSizCondNum</span>          <span class="c">! Plant Sizing index for condenser loop</span>
<a name="ln-3305"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFla</span>                 <span class="c">! Flag of solver</span>
<a name="ln-3306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpNomTowerCap</span>
<a name="ln-3307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpDesignWaterFlowRate</span>
<a name="ln-3308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpTowerFreeConvNomCap</span>
<a name="ln-3309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpDesignAirFlowRate</span>
<a name="ln-3310"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpHighSpeedFanPower</span>
<a name="ln-3311"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpFreeConvAirFlowRate</span>
<a name="ln-3312"></a>
<a name="ln-3313"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>                    <span class="c">! Parameter array need for RegulaFalsi routine</span>
<a name="ln-3314"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA0</span>                    <span class="c">! Lower bound for UA [W/C]</span>
<a name="ln-3315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA1</span>                    <span class="c">! Upper bound for UA [W/C]</span>
<a name="ln-3316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesTowerLoad</span>           <span class="c">! Design tower load [W]</span>
<a name="ln-3317"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Cp</span>  <span class="c">! local specific heat for fluid</span>
<a name="ln-3318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local density for fluid</span>
<a name="ln-3319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA</span>                     <span class="c">! Calculated UA value</span>
<a name="ln-3320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutWaterTemp</span>
<a name="ln-3321"></a>
<a name="ln-3322"></a>  <span class="c">! Find the appropriate Plant Sizing object</span>
<a name="ln-3323"></a>  <span class="n">PltSizCondNum</span> <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">PlantSizNum</span>
<a name="ln-3324"></a>
<a name="ln-3325"></a>  <span class="n">tmpNomTowerCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span>
<a name="ln-3326"></a>  <span class="n">tmpDesignWaterFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span>
<a name="ln-3327"></a>
<a name="ln-3328"></a>  <span class="n">tmpTowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span>
<a name="ln-3329"></a>  <span class="n">tmpDesignAirFlowRate</span>   <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>
<a name="ln-3330"></a>  <span class="n">tmpHighSpeedFanPower</span>   <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span>
<a name="ln-3331"></a>  <span class="n">tmpFreeConvAirFlowRate</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span>
<a name="ln-3332"></a>
<a name="ln-3333"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_NominalCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3334"></a>
<a name="ln-3335"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3336"></a>      <span class="c">! get nominal capacity from PlantSizData(PltSizCondNum)%DeltaT and PlantSizData(PltSizCondNum)%DesVolFlowRate</span>
<a name="ln-3337"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizCondNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3338"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3339"></a><span class="k">          </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3340"></a>                                    <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3341"></a>                                    <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-3342"></a>                                    <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3343"></a>          <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3344"></a>                                   <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3345"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3346"></a>                                   <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3347"></a>          <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Cp</span>  <span class="p">&amp;</span>
<a name="ln-3348"></a>                          <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="p">&amp;</span>
<a name="ln-3349"></a>                          <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span>
<a name="ln-3350"></a>          <span class="n">tmpNomTowerCap</span>  <span class="o">=</span> <span class="n">DesTowerLoad</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3351"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3352"></a><span class="k">            </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span>
<a name="ln-3353"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3354"></a>                              <span class="s1">&#39;Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span>
<a name="ln-3355"></a>          <span class="n">ENDIF</span>
<a name="ln-3356"></a>        <span class="k">ELSE</span>
<a name="ln-3357"></a><span class="k">          </span><span class="n">tmpNomTowerCap</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3358"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3359"></a><span class="k">            </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span>
<a name="ln-3360"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3361"></a>                              <span class="s1">&#39;Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span>
<a name="ln-3362"></a>          <span class="n">ENDIF</span>
<a name="ln-3363"></a>        <span class="n">ENDIF</span>
<a name="ln-3364"></a>
<a name="ln-3365"></a>      <span class="k">ELSE</span>
<a name="ln-3366"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing error for cooling tower object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3367"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower nominal capacity requires a loop Sizing:Plant object.&#39;</span><span class="p">)</span>
<a name="ln-3368"></a>      <span class="n">ENDIF</span>
<a name="ln-3369"></a>
<a name="ln-3370"></a>    <span class="n">ENDIF</span>
<a name="ln-3371"></a>
<a name="ln-3372"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3373"></a><span class="k">      </span><span class="n">tmpTowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCapSizingFactor</span>
<a name="ln-3374"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3375"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">tmpTowerFreeConvNomCap</span>
<a name="ln-3376"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3377"></a>                                <span class="s1">&#39;Free Convection Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3378"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span><span class="p">)</span>
<a name="ln-3379"></a>      <span class="n">ENDIF</span>
<a name="ln-3380"></a>    <span class="n">ENDIF</span>
<a name="ln-3381"></a>
<a name="ln-3382"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3383"></a>    <span class="c">! for nominal cap input method, get design water flow rate from nominal cap and scalable sizing factor</span>
<a name="ln-3384"></a>      <span class="n">tmpDesignWaterFlowRate</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowPerUnitNomCap</span>
<a name="ln-3385"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3386"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignWaterFlowRate</span>
<a name="ln-3387"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3388"></a>                              <span class="s1">&#39;Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span><span class="p">)</span>
<a name="ln-3389"></a>      <span class="n">ENDIF</span>
<a name="ln-3390"></a>    <span class="n">ENDIF</span>
<a name="ln-3391"></a>
<a name="ln-3392"></a>    <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span><span class="n">tmpDesignWaterFlowRate</span><span class="p">)</span>
<a name="ln-3393"></a>
<a name="ln-3394"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">==</span>  <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3395"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DefaultedDesignAirFlowScalingFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3396"></a><span class="k">        </span><span class="n">tmpDesignAirFlowRate</span> <span class="o">=</span>  <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignAirFlowPerUnitNomCap</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10132</span><span class="mf">5.d0</span><span class="o">/</span><span class="n">StdBaroPress</span><span class="p">)</span>
<a name="ln-3397"></a>      <span class="k">ELSE</span>
<a name="ln-3398"></a><span class="k">        </span><span class="n">tmpDesignAirFlowRate</span> <span class="o">=</span>  <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignAirFlowPerUnitNomCap</span>
<a name="ln-3399"></a>      <span class="n">ENDIF</span>
<a name="ln-3400"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3401"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignAirFlowRate</span>
<a name="ln-3402"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3403"></a>                              <span class="s1">&#39;Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span><span class="p">)</span>
<a name="ln-3404"></a>      <span class="n">ENDIF</span>
<a name="ln-3405"></a>    <span class="n">ENDIF</span>
<a name="ln-3406"></a>
<a name="ln-3407"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3408"></a><span class="k">      </span><span class="n">tmpFreeConvAirFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignAirFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRateSizingFactor</span>
<a name="ln-3409"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3410"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">=</span> <span class="n">tmpFreeConvAirFlowRate</span>
<a name="ln-3411"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3412"></a>                              <span class="s1">&#39;Free Convection Regime Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span><span class="p">)</span>
<a name="ln-3413"></a>      <span class="n">ENDIF</span>
<a name="ln-3414"></a>    <span class="n">ENDIF</span>
<a name="ln-3415"></a>
<a name="ln-3416"></a>    <span class="c">! now calcuate UA values from nominal capacities and flow rates</span>
<a name="ln-3417"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAvaluesCompleted</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3418"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">PltSizCondNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! user has a plant sizing object</span>
<a name="ln-3419"></a>        <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3420"></a>                                <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3421"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3422"></a>                                <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3423"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span> <span class="o">+</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-3424"></a>      <span class="k">ELSE</span> <span class="c">! probably no plant sizing object</span>
<a name="ln-3425"></a>        <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3426"></a>                                <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3427"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3428"></a>                                <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3429"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span> <span class="c">! design condition</span>
<a name="ln-3430"></a>      <span class="n">ENDIF</span>
<a name="ln-3431"></a>      <span class="n">rho</span>   <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3432"></a>                          <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3433"></a>                          <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-3434"></a>                          <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3435"></a>
<a name="ln-3436"></a>      <span class="c">! full speed fan tower UA</span>
<a name="ln-3437"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span><span class="o">*</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3438"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3439"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="c">! design water mass flow rate</span>
<a name="ln-3440"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpDesignAirFlowRate</span> <span class="c">! design air volume flow rate</span>
<a name="ln-3441"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cp</span>
<a name="ln-3442"></a>      <span class="n">UA0</span> <span class="o">=</span> <span class="mf">0.0001d0</span> <span class="o">*</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">! Assume deltaT = 10000K (limit)</span>
<a name="ln-3443"></a>      <span class="n">UA1</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>          <span class="c">! Assume deltaT = 1K</span>
<a name="ln-3444"></a>
<a name="ln-3445"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>
<a name="ln-3446"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.6d0</span>
<a name="ln-3447"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-3448"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3449"></a>          <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3450"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3451"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-3452"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleTowerUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3453"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3454"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower UA&#39;</span><span class="p">)</span>
<a name="ln-3455"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;calculating cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3456"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3457"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-3458"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3459"></a>      <span class="n">ENDIF</span>
<a name="ln-3460"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-3461"></a>
<a name="ln-3462"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3463"></a>                            <span class="s1">&#39;U-Factor Times Area Value at Full Speed Air Flow Rate [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3464"></a>                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span><span class="p">)</span>
<a name="ln-3465"></a>
<a name="ln-3466"></a>      <span class="c">! free convection tower UA</span>
<a name="ln-3467"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpTowerFreeConvNomCap</span><span class="o">*</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3468"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3469"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="c">! design water mass flow rate</span>
<a name="ln-3470"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpFreeConvAirFlowRate</span> <span class="c">! design air volume flow rate</span>
<a name="ln-3471"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cp</span>
<a name="ln-3472"></a>      <span class="n">UA0</span> <span class="o">=</span> <span class="mf">0.0001d0</span> <span class="o">*</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">! Assume deltaT = 10000K (limit)</span>
<a name="ln-3473"></a>      <span class="n">UA0</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">UA0</span><span class="p">,</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="c">! limit to 1.0</span>
<a name="ln-3474"></a>      <span class="n">UA1</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>          <span class="c">! Assume deltaT = 1K</span>
<a name="ln-3475"></a>
<a name="ln-3476"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>
<a name="ln-3477"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.6d0</span>
<a name="ln-3478"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-3479"></a>      <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3480"></a>          <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3481"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3482"></a>                        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-3483"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleTowerUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3484"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3485"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower free convection UA&#39;</span><span class="p">)</span>
<a name="ln-3486"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;calculating cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3487"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3488"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-3489"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for free convection tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3490"></a>      <span class="n">ENDIF</span>
<a name="ln-3491"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-3492"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3493"></a>                            <span class="s1">&#39;U-Factor Times Area Value at Free Convection Air Flow Rate [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3494"></a>                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span><span class="p">)</span>
<a name="ln-3495"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAvaluesCompleted</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3496"></a>    <span class="n">ENDIF</span>
<a name="ln-3497"></a>
<a name="ln-3498"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">PerformanceInputMethod_Num</span> <span class="o">==</span> <span class="n">PIM_UFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3499"></a>  <span class="c">!UA input method</span>
<a name="ln-3500"></a>
<a name="ln-3501"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! get from plant sizing</span>
<a name="ln-3502"></a>      <span class="c">! UA input method using plant sizing for flow rate, whereas Nominal capacity method uses scalable sizing factor per cap</span>
<a name="ln-3503"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizCondNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3504"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3505"></a><span class="k">          </span><span class="n">tmpDesignWaterFlowRate</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span><span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span>
<a name="ln-3506"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3507"></a><span class="k">            </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignWaterFlowRate</span>
<a name="ln-3508"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3509"></a>                                  <span class="s1">&#39;Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span><span class="p">)</span>
<a name="ln-3510"></a>          <span class="n">ENDIF</span>
<a name="ln-3511"></a>        <span class="k">ELSE</span>
<a name="ln-3512"></a><span class="k">          </span><span class="n">tmpDesignWaterFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3513"></a>
<a name="ln-3514"></a>        <span class="n">ENDIF</span>
<a name="ln-3515"></a>
<a name="ln-3516"></a>      <span class="k">ELSE</span>
<a name="ln-3517"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing error for cooling tower object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3518"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower nominal capacity requires a loop Sizing:Plant object.&#39;</span><span class="p">)</span>
<a name="ln-3519"></a>      <span class="n">ENDIF</span>
<a name="ln-3520"></a>    <span class="n">ENDIF</span>
<a name="ln-3521"></a>    <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span><span class="n">tmpDesignWaterFlowRate</span><span class="p">)</span>
<a name="ln-3522"></a>
<a name="ln-3523"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">==</span>  <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3524"></a>      <span class="c">! get nominal capacity from PlantSizData(PltSizCondNum)%DeltaT and PlantSizData(PltSizCondNum)%DesVolFlowRate</span>
<a name="ln-3525"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizCondNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3526"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3527"></a><span class="k">          </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3528"></a>                                    <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3529"></a>                                    <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-3530"></a>                                    <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3531"></a>          <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3532"></a>                                   <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3533"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3534"></a>                                   <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3535"></a>          <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Cp</span>  <span class="p">&amp;</span>
<a name="ln-3536"></a>                          <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="p">&amp;</span>
<a name="ln-3537"></a>                          <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SizFac</span>
<a name="ln-3538"></a>          <span class="n">tmpNomTowerCap</span>  <span class="o">=</span> <span class="n">DesTowerLoad</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3539"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3540"></a><span class="k">            </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span>
<a name="ln-3541"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3542"></a>                              <span class="s1">&#39;Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span>
<a name="ln-3543"></a>          <span class="n">ENDIF</span>
<a name="ln-3544"></a>        <span class="k">ELSE</span>
<a name="ln-3545"></a><span class="k">          </span><span class="n">tmpNomTowerCap</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3546"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3547"></a><span class="k">            </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span>
<a name="ln-3548"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3549"></a>                              <span class="s1">&#39;Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span>
<a name="ln-3550"></a>          <span class="n">ENDIF</span>
<a name="ln-3551"></a>        <span class="n">ENDIF</span>
<a name="ln-3552"></a>      <span class="k">ELSE</span>
<a name="ln-3553"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing error for cooling tower object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3554"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower nominal capacity requires a loop Sizing:Plant object.&#39;</span><span class="p">)</span>
<a name="ln-3555"></a>      <span class="n">ENDIF</span>
<a name="ln-3556"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3557"></a><span class="k">        </span><span class="n">tmpTowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCapSizingFactor</span>
<a name="ln-3558"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3559"></a><span class="k">          </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">tmpTowerFreeConvNomCap</span>
<a name="ln-3560"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3561"></a>                                  <span class="s1">&#39;Free Convection Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3562"></a>                                  <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span><span class="p">)</span>
<a name="ln-3563"></a>        <span class="n">ENDIF</span>
<a name="ln-3564"></a>      <span class="n">ENDIF</span>
<a name="ln-3565"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">==</span>  <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3566"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DefaultedDesignAirFlowScalingFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3567"></a><span class="k">          </span><span class="n">tmpDesignAirFlowRate</span> <span class="o">=</span>  <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignAirFlowPerUnitNomCap</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10132</span><span class="mf">5.d0</span><span class="o">/</span><span class="n">StdBaroPress</span><span class="p">)</span>
<a name="ln-3568"></a>        <span class="k">ELSE</span>
<a name="ln-3569"></a><span class="k">          </span><span class="n">tmpDesignAirFlowRate</span> <span class="o">=</span>  <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignAirFlowPerUnitNomCap</span>
<a name="ln-3570"></a>        <span class="n">ENDIF</span>
<a name="ln-3571"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3572"></a><span class="k">          </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignAirFlowRate</span>
<a name="ln-3573"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3574"></a>                                <span class="s1">&#39;Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span><span class="p">)</span>
<a name="ln-3575"></a>        <span class="n">ENDIF</span>
<a name="ln-3576"></a>      <span class="n">ENDIF</span>
<a name="ln-3577"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3578"></a><span class="k">        </span><span class="n">tmpFreeConvAirFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignAirFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRateSizingFactor</span>
<a name="ln-3579"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3580"></a><span class="k">          </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">=</span> <span class="n">tmpFreeConvAirFlowRate</span>
<a name="ln-3581"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3582"></a>                                <span class="s1">&#39;Free Convection Regime Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span><span class="p">)</span>
<a name="ln-3583"></a>        <span class="n">ENDIF</span>
<a name="ln-3584"></a>      <span class="n">ENDIF</span>
<a name="ln-3585"></a>      <span class="c">! now calcuate UA values from nominal capacities and flow rates</span>
<a name="ln-3586"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3587"></a><span class="k">        </span><span class="n">rho</span>   <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3588"></a>                            <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3589"></a>                            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-3590"></a>                            <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3591"></a>        <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3592"></a>                                <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3593"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3594"></a>                                <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3595"></a>        <span class="c">! full speed fan tower UA</span>
<a name="ln-3596"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span><span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3597"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3598"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="c">! design water mass flow rate</span>
<a name="ln-3599"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpDesignAirFlowRate</span> <span class="c">! design air volume flow rate</span>
<a name="ln-3600"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cp</span>
<a name="ln-3601"></a>        <span class="n">UA0</span> <span class="o">=</span> <span class="mf">0.0001d0</span> <span class="o">*</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">! Assume deltaT = 10000K (limit)</span>
<a name="ln-3602"></a>        <span class="n">UA1</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>          <span class="c">! Assume deltaT = 1K</span>
<a name="ln-3603"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span> <span class="o">+</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-3604"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>
<a name="ln-3605"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.6d0</span>
<a name="ln-3606"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-3607"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3608"></a>            <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3609"></a>                          <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3610"></a>                          <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-3611"></a>        <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleTowerUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3612"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3613"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower UA&#39;</span><span class="p">)</span>
<a name="ln-3614"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;calculating cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3615"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3616"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-3617"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3618"></a>        <span class="n">ENDIF</span>
<a name="ln-3619"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-3620"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3621"></a>                            <span class="s1">&#39;U-Factor Times Area Value at Full Speed Air Flow Rate [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3622"></a>                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span><span class="p">)</span>
<a name="ln-3623"></a>        <span class="c">! free convection tower UA</span>
<a name="ln-3624"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpTowerFreeConvNomCap</span><span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3625"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3626"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span> <span class="c">! design water mass flow rate</span>
<a name="ln-3627"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmpFreeConvAirFlowRate</span> <span class="c">! design air volume flow rate</span>
<a name="ln-3628"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Cp</span>
<a name="ln-3629"></a>        <span class="n">UA0</span> <span class="o">=</span> <span class="mf">0.0001d0</span> <span class="o">*</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c">! Assume deltaT = 10000K (limit)</span>
<a name="ln-3630"></a>        <span class="n">UA1</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>          <span class="c">! Assume deltaT = 1K</span>
<a name="ln-3631"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span> <span class="o">+</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-3632"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>
<a name="ln-3633"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.6d0</span>
<a name="ln-3634"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-3635"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3636"></a>            <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3637"></a>                          <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3638"></a>                          <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-3639"></a>        <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleTowerUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3640"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3641"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower free convection UA&#39;</span><span class="p">)</span>
<a name="ln-3642"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;calculating cooling tower UA failed for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3643"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3644"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-3645"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower UA failed for free convection tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3646"></a>        <span class="n">ENDIF</span>
<a name="ln-3647"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-3648"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3649"></a>                            <span class="s1">&#39;U-Factor Times Area Value at Free Convection Air Flow Rate [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3650"></a>                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span><span class="p">)</span>
<a name="ln-3651"></a>      <span class="n">ENDIF</span>
<a name="ln-3652"></a>
<a name="ln-3653"></a>    <span class="k">ELSE</span> <span class="c">!full speed UA given</span>
<a name="ln-3654"></a>
<a name="ln-3655"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! determine from scalable sizing factor</span>
<a name="ln-3656"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3657"></a><span class="k">          </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3658"></a>                                                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUASizingFactor</span>
<a name="ln-3659"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3660"></a>                            <span class="s1">&#39;U-Factor Times Area Value at Free Convection Air Flow Rate [W/C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3661"></a>                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span><span class="p">)</span>
<a name="ln-3662"></a>        <span class="n">ENDIF</span>
<a name="ln-3663"></a>      <span class="n">ENDIF</span>
<a name="ln-3664"></a>
<a name="ln-3665"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">==</span>  <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! given UA but not air flow rate</span>
<a name="ln-3666"></a>       <span class="c">! need an air flow rate to find capacity from UA but flow rate is scaled off capacity</span>
<a name="ln-3667"></a>        <span class="c">! get nominal capacity from PlantSizData(PltSizCondNum)%DeltaT and PlantSizData(PltSizCondNum)%DesVolFlowRate</span>
<a name="ln-3668"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizCondNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3669"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3670"></a><span class="k">            </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3671"></a>                                      <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3672"></a>                                      <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-3673"></a>                                      <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3674"></a>            <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3675"></a>                                     <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3676"></a>                                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3677"></a>                                     <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3678"></a>            <span class="n">DesTowerLoad</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Cp</span>  <span class="p">&amp;</span>
<a name="ln-3679"></a>                            <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-3680"></a>            <span class="n">tmpNomTowerCap</span>  <span class="o">=</span> <span class="n">DesTowerLoad</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3681"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3682"></a><span class="k">              </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span>
<a name="ln-3683"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3684"></a>                                <span class="s1">&#39;Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span>
<a name="ln-3685"></a>            <span class="n">ENDIF</span>
<a name="ln-3686"></a>          <span class="k">ELSE</span>
<a name="ln-3687"></a><span class="k">            </span><span class="n">tmpNomTowerCap</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3688"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3689"></a><span class="k">              </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span>
<a name="ln-3690"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3691"></a>                                <span class="s1">&#39;Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span>
<a name="ln-3692"></a>            <span class="n">ENDIF</span>
<a name="ln-3693"></a>          <span class="n">ENDIF</span>
<a name="ln-3694"></a>
<a name="ln-3695"></a>        <span class="k">ELSE</span>
<a name="ln-3696"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing error for cooling tower object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3697"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Autosizing of cooling tower nominal capacity requires a loop Sizing:Plant object.&#39;</span><span class="p">)</span>
<a name="ln-3698"></a>        <span class="n">ENDIF</span>
<a name="ln-3699"></a>
<a name="ln-3700"></a>
<a name="ln-3701"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DefaultedDesignAirFlowScalingFactor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3702"></a><span class="k">          </span><span class="n">tmpDesignAirFlowRate</span> <span class="o">=</span>  <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignAirFlowPerUnitNomCap</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10132</span><span class="mf">5.d0</span><span class="o">/</span><span class="n">StdBaroPress</span><span class="p">)</span>
<a name="ln-3703"></a>        <span class="k">ELSE</span>
<a name="ln-3704"></a><span class="k">          </span><span class="n">tmpDesignAirFlowRate</span> <span class="o">=</span>  <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignAirFlowPerUnitNomCap</span>
<a name="ln-3705"></a>        <span class="n">ENDIF</span>
<a name="ln-3706"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3707"></a><span class="k">          </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignAirFlowRate</span>
<a name="ln-3708"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3709"></a>                              <span class="s1">&#39;Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span><span class="p">)</span>
<a name="ln-3710"></a>        <span class="n">ENDIF</span>
<a name="ln-3711"></a>
<a name="ln-3712"></a>      <span class="k">ELSE</span> <span class="c">! UA and Air flow rate given, so find Nominal Cap from running model</span>
<a name="ln-3713"></a>
<a name="ln-3714"></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3715"></a>                                      <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3716"></a>                                      <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-3717"></a>                                      <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3718"></a>        <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3719"></a>                                <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3720"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3721"></a>                                <span class="s1">&#39;SizeTower&#39;</span><span class="p">)</span>
<a name="ln-3722"></a>
<a name="ln-3723"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">ExitTemp</span> <span class="o">+</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCondNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-3724"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.d0</span>
<a name="ln-3725"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.6d0</span>
<a name="ln-3726"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span> <span class="o">=</span> <span class="n">StdBaroPress</span>
<a name="ln-3727"></a>        <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3728"></a>            <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-3729"></a>                          <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3730"></a>                          <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-3731"></a>        <span class="k">CALL </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span><span class="p">,</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3732"></a>                                             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span><span class="p">,</span><span class="n">OutWaterTemp</span><span class="p">)</span>
<a name="ln-3733"></a>        <span class="n">tmpNomTowerCap</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">-</span> <span class="n">OutWaterTemp</span><span class="p">)</span>
<a name="ln-3734"></a>        <span class="n">tmpNomTowerCap</span> <span class="o">=</span>  <span class="n">tmpNomTowerCap</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3735"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3736"></a><span class="k">          </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span> <span class="o">=</span> <span class="n">tmpNomTowerCap</span>
<a name="ln-3737"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3738"></a>                            <span class="s1">&#39;Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerNominalCapacity</span><span class="p">)</span>
<a name="ln-3739"></a>        <span class="n">ENDIF</span>
<a name="ln-3740"></a>
<a name="ln-3741"></a>      <span class="n">ENDIF</span> <span class="c">! both UA and air flow rate given</span>
<a name="ln-3742"></a>
<a name="ln-3743"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3744"></a><span class="k">        </span><span class="n">tmpFreeConvAirFlowRate</span> <span class="o">=</span> <span class="n">tmpDesignAirFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRateSizingFactor</span>
<a name="ln-3745"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3746"></a><span class="k">          </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">=</span> <span class="n">tmpFreeConvAirFlowRate</span>
<a name="ln-3747"></a>          <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3748"></a>                              <span class="s1">&#39;Free Convection Regime Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span><span class="p">)</span>
<a name="ln-3749"></a>        <span class="n">ENDIF</span>
<a name="ln-3750"></a>      <span class="n">ENDIF</span>
<a name="ln-3751"></a>
<a name="ln-3752"></a>      <span class="k">CALL </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span><span class="p">,</span><span class="n">tmpFreeConvAirFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3753"></a>                                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span><span class="p">,</span><span class="n">OutWaterTemp</span><span class="p">)</span>
<a name="ln-3754"></a>      <span class="n">tmpTowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">cp</span><span class="o">*</span><span class="n">rho</span> <span class="o">*</span> <span class="n">tmpDesignWaterFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">-</span> <span class="n">OutWaterTemp</span><span class="p">)</span>
<a name="ln-3755"></a>      <span class="n">tmpTowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">tmpTowerFreeConvNomCap</span>  <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HeatRejectCapNomCapSizingRatio</span>
<a name="ln-3756"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3757"></a><span class="k">        </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span> <span class="o">=</span> <span class="n">tmpTowerFreeConvNomCap</span>
<a name="ln-3758"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3759"></a>                                <span class="s1">&#39;Free Convection Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3760"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerFreeConvNomCap</span><span class="p">)</span>
<a name="ln-3761"></a>      <span class="n">ENDIF</span>
<a name="ln-3762"></a>
<a name="ln-3763"></a>    <span class="n">ENDIF</span>
<a name="ln-3764"></a>
<a name="ln-3765"></a>
<a name="ln-3766"></a>  <span class="n">ENDIF</span>
<a name="ln-3767"></a>
<a name="ln-3768"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">==</span> <span class="n">autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3769"></a><span class="k">    </span><span class="n">tmpHighSpeedFanPower</span>   <span class="o">=</span> <span class="n">tmpNomTowerCap</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignFanPowerPerUnitNomCap</span>
<a name="ln-3770"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3771"></a><span class="k">      </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">=</span> <span class="n">tmpHighSpeedFanPower</span>
<a name="ln-3772"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3773"></a>                            <span class="s1">&#39;Design Fan Power [W]&#39;</span><span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span><span class="p">)</span>
<a name="ln-3774"></a>    <span class="n">ENDIF</span>
<a name="ln-3775"></a>  <span class="n">ENDIF</span>
<a name="ln-3776"></a>
<a name="ln-3777"></a>  <span class="k">RETURN</span>
<a name="ln-3778"></a>
<a name="ln-3779"></a><span class="k">END SUBROUTINE </span><span class="n">SizeVSMerkelTower</span>
<a name="ln-3780"></a>
<a name="ln-3781"></a>
<a name="ln-3782"></a><span class="c">! End Initialization Section for the CondenserLoopTowers Module</span>
<a name="ln-3783"></a><span class="c">!******************************************************************************</span>
<a name="ln-3784"></a>
<a name="ln-3785"></a>
<a name="ln-3786"></a><span class="c">! Beginning of the CondenserLoopTowers Module Simulation Subroutines</span>
<a name="ln-3787"></a><span class="c">! *****************************************************************************</span>
<a name="ln-3788"></a>
<a name="ln-3789"></a><span class="k">SUBROUTINE </span><span class="n">CalcSingleSpeedTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-3790"></a>
<a name="ln-3791"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3792"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-3793"></a>          <span class="c">!       DATE WRITTEN   Sept. 1998</span>
<a name="ln-3794"></a>          <span class="c">!       MODIFIED       T Hong, Aug. 2008. Added fluid bypass for single speed cooling tower</span>
<a name="ln-3795"></a>          <span class="c">!                      The OutletWaterTemp from SimSimpleTower can be lower than 0 degreeC</span>
<a name="ln-3796"></a>          <span class="c">!                      which may not be allowed in practice if water is the tower fluid.</span>
<a name="ln-3797"></a>          <span class="c">!                      Chandan Sharma, FSEC, February 2010, Added basin heater</span>
<a name="ln-3798"></a>          <span class="c">!                      A Flament, July 2010, added multi-cell capability for the 3 types of cooling tower</span>
<a name="ln-3799"></a>          <span class="c">!       RE-ENGINEERED  Jan 2001, Richard Raustad</span>
<a name="ln-3800"></a>
<a name="ln-3801"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3802"></a>          <span class="c">!</span>
<a name="ln-3803"></a>          <span class="c">! To simulate the operation of a single-speed fan cooling tower.</span>
<a name="ln-3804"></a>
<a name="ln-3805"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3806"></a>          <span class="c">!</span>
<a name="ln-3807"></a>          <span class="c">! The cooling tower is modeled using effectiveness-NTU relationships for</span>
<a name="ln-3808"></a>          <span class="c">! counterflow heat exchangers based on Merkel&#39;s theory.</span>
<a name="ln-3809"></a>          <span class="c">!</span>
<a name="ln-3810"></a>          <span class="c">! The subroutine calculates the period of time required to meet a</span>
<a name="ln-3811"></a>          <span class="c">! leaving water temperature setpoint. It assumes that part-load</span>
<a name="ln-3812"></a>          <span class="c">! operation represents a linear interpolation of two steady-state regimes.</span>
<a name="ln-3813"></a>          <span class="c">! Cyclic losses are neglected. The period of time required to meet the</span>
<a name="ln-3814"></a>          <span class="c">! leaving water temperature setpoint is used to determine the required</span>
<a name="ln-3815"></a>          <span class="c">! fan power and energy. Free convection regime is also modeled. This</span>
<a name="ln-3816"></a>          <span class="c">! occures when the pump is operating and the fan is off. If free convection</span>
<a name="ln-3817"></a>          <span class="c">! regime cooling is all that is required for a given time step, the leaving</span>
<a name="ln-3818"></a>          <span class="c">! water temperature is allowed to fall below the leaving water temperature</span>
<a name="ln-3819"></a>          <span class="c">! setpoint (free cooling). At times when the cooling tower fan is required,</span>
<a name="ln-3820"></a>          <span class="c">! the leaving water temperature is at or above the setpoint.</span>
<a name="ln-3821"></a>          <span class="c">!</span>
<a name="ln-3822"></a>          <span class="c">! A RunFlag is passed by the upper level manager to indicate the ON/OFF status,</span>
<a name="ln-3823"></a>          <span class="c">! or schedule, of the cooling tower. If the tower is OFF, outlet water</span>
<a name="ln-3824"></a>          <span class="c">! temperature and flow rate are passed through the model from inlet node to</span>
<a name="ln-3825"></a>          <span class="c">! outlet node without intervention (with the exception of free convection</span>
<a name="ln-3826"></a>          <span class="c">! where water temperature is allowed to float below the outlet water set</span>
<a name="ln-3827"></a>          <span class="c">! point). Reports are also updated with fan power and energy being zero.</span>
<a name="ln-3828"></a>          <span class="c">!</span>
<a name="ln-3829"></a>          <span class="c">! When the RunFlag indicates an ON condition for the cooling tower, the</span>
<a name="ln-3830"></a>          <span class="c">! mass flow rate and water temperature are read from the inlet node of the</span>
<a name="ln-3831"></a>          <span class="c">! cooling tower (water-side). The outdoor air wet-bulb temperature is used</span>
<a name="ln-3832"></a>          <span class="c">! as the entering condition to the cooling tower (air-side). Input deck</span>
<a name="ln-3833"></a>          <span class="c">! parameters are read for the free convection regime (pump ON and fan OFF)</span>
<a name="ln-3834"></a>          <span class="c">! and a leaving water temperature is calculated. If the leaving water temperature</span>
<a name="ln-3835"></a>          <span class="c">! is at or below the setpoint, the calculated leaving water temperature is</span>
<a name="ln-3836"></a>          <span class="c">! placed on the outlet node and no fan power is used. If the calculated leaving</span>
<a name="ln-3837"></a>          <span class="c">! water temperature is above the setpoint, the cooling tower fan is turned on</span>
<a name="ln-3838"></a>          <span class="c">! and design parameters are used to again calculate the leaving water temperature.</span>
<a name="ln-3839"></a>          <span class="c">! If the calculated leaving water temperature is below the setpoint, a fan</span>
<a name="ln-3840"></a>          <span class="c">! run-time fraction is calculated and used to determine fan power. The leaving</span>
<a name="ln-3841"></a>          <span class="c">! water temperature setpoint is placed on the outlet node. If the calculated</span>
<a name="ln-3842"></a>          <span class="c">! leaving water temperature is at or above the setpoint, the calculated</span>
<a name="ln-3843"></a>          <span class="c">! leaving water temperature is placed on the outlet node and the fan runs at</span>
<a name="ln-3844"></a>          <span class="c">! full power. Water mass flow rate is passed from inlet node to outlet node</span>
<a name="ln-3845"></a>          <span class="c">! with no intervention.</span>
<a name="ln-3846"></a>          <span class="c">!</span>
<a name="ln-3847"></a>          <span class="c">! If a tower has multiple cells, the specified inputs of or the autosized capacity</span>
<a name="ln-3848"></a>          <span class="c">!  and air/water flow rates are for the entire tower. The number of cells to operate</span>
<a name="ln-3849"></a>          <span class="c">!  is first determined based on the user entered minimal and maximal water flow fractions</span>
<a name="ln-3850"></a>          <span class="c">!  per cell. If the loads are not met, more cells (if available) will operate to meet</span>
<a name="ln-3851"></a>          <span class="c">!  the loads. Inside each cell, the capacity controls still apply. Each cell operates</span>
<a name="ln-3852"></a>          <span class="c">!  in the same way.</span>
<a name="ln-3853"></a>
<a name="ln-3854"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3855"></a>          <span class="c">! ASHRAE HVAC1KIT: A Toolkit for Primary HVAC System Energy Calculation. 1999.</span>
<a name="ln-3856"></a>
<a name="ln-3857"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3858"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">SingleSetPoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-3859"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-3860"></a>
<a name="ln-3861"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3862"></a>
<a name="ln-3863"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3864"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-3865"></a>
<a name="ln-3866"></a>
<a name="ln-3867"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3868"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">MaxIteration</span> <span class="o">=</span> <span class="mi">100</span>          <span class="c">! Maximum fluid bypass iteration calculations</span>
<a name="ln-3869"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxItChar</span>  <span class="o">=</span><span class="s1">&#39;100&#39;</span>
<a name="ln-3870"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">BypassFractionThreshold</span> <span class="o">=</span> <span class="mf">0.01d0</span>   <span class="c">!Threshold to stop bypass iteration</span>
<a name="ln-3871"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OWTLowerLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! The limit of tower exit fluid temperature used in the fluid bypass</span>
<a name="ln-3872"></a>                                                     <span class="c">!  calculation to avoid fluid freezing. For water, it is 0 degreeC,</span>
<a name="ln-3873"></a>                                                     <span class="c">!  for glycols, it can be much lower. The fluid type is stored at the loop.</span>
<a name="ln-3874"></a>                                                     <span class="c">!  Current choices are Water and Steam, needs to expand for glycols</span>
<a name="ln-3875"></a>
<a name="ln-3876"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3877"></a>          <span class="c">! na</span>
<a name="ln-3878"></a>
<a name="ln-3879"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3880"></a>          <span class="c">! na</span>
<a name="ln-3881"></a>
<a name="ln-3882"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3883"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AirFlowRate</span>
<a name="ln-3884"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">UAdesign</span>            <span class="c">! UA value at design conditions (entered by user or calculated)</span>
<a name="ln-3885"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletWaterTempOFF</span>
<a name="ln-3886"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FanModeFrac</span>
<a name="ln-3887"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">DesignWaterFlowRate</span>
<a name="ln-3888"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FanPowerOn</span>
<a name="ln-3889"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CpWater</span>
<a name="ln-3890"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TempSetPoint</span>
<a name="ln-3891"></a>
<a name="ln-3892"></a>
<a name="ln-3893"></a>  <span class="c">!Added variables for fluid bypass</span>
<a name="ln-3894"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumIteration</span>
<a name="ln-3895"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">CapacityControl</span>                  <span class="c">! Capacity Control (0 - FanCycling, 1 - FluidBypass)</span>
<a name="ln-3896"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">BypassFlag</span>                       <span class="c">! Flag indicator for fluid bypass (0 - no bypass, 1 - bypass)</span>
<a name="ln-3897"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">BypassFraction</span>                   <span class="c">! Fluid bypass fraction</span>
<a name="ln-3898"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">BypassFraction2</span>                  <span class="c">! Fluid bypass fraction</span>
<a name="ln-3899"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">BypassFractionPrev</span>
<a name="ln-3900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletWaterTempPrev</span>
<a name="ln-3901"></a>
<a name="ln-3902"></a>  <span class="c">!Added variables for multicell</span>
<a name="ln-3903"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCellMin</span>
<a name="ln-3904"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCellMax</span>
<a name="ln-3905"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumCellMin</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3906"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumCellMax</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3907"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumCellON</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCell</span>
<a name="ln-3909"></a>  <span class="kt">LOGICAL</span>                <span class="kd">::</span> <span class="n">IncrNumCellFlag</span>                   <span class="c">! determine if yes or no we increase the number of cells</span>
<a name="ln-3910"></a>
<a name="ln-3911"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-3912"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-3913"></a>
<a name="ln-3914"></a>    <span class="c">!set inlet and outlet nodes</span>
<a name="ln-3915"></a>    <span class="n">WaterInletNode</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-3916"></a>    <span class="n">WaterOutletNode</span>    <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-3917"></a>    <span class="n">Qactual</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3918"></a>    <span class="n">CTFanPower</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3919"></a>    <span class="n">OutletWaterTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3920"></a>    <span class="n">LoopNum</span>            <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span>
<a name="ln-3921"></a>    <span class="n">LoopSideNum</span>        <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span>
<a name="ln-3922"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-3923"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-3924"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SetpointIsOnOutlet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3925"></a><span class="k">        </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">TempSetpoint</span>
<a name="ln-3926"></a>      <span class="k">ELSE</span>
<a name="ln-3927"></a><span class="k">        </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpoint</span>
<a name="ln-3928"></a>      <span class="n">ENDIF</span>
<a name="ln-3929"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-3930"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SetpointIsOnOutlet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3931"></a><span class="k">        </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">TempSetpointHi</span>
<a name="ln-3932"></a>      <span class="k">ELSE</span>
<a name="ln-3933"></a><span class="k">        </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpointHi</span>
<a name="ln-3934"></a>      <span class="n">ENDIF</span>
<a name="ln-3935"></a>    <span class="k">END SELECT</span>
<a name="ln-3936"></a>
<a name="ln-3937"></a>    <span class="c">! Added for fluid bypass. First assume no fluid bypass</span>
<a name="ln-3938"></a>    <span class="n">BypassFlag</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3939"></a>    <span class="n">BypassFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3940"></a>    <span class="n">BypassFraction2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3941"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3942"></a>    <span class="n">CapacityControl</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CapacityControl</span>
<a name="ln-3943"></a>
<a name="ln-3944"></a>
<a name="ln-3945"></a>    <span class="c">! Added for multi-cell. Determine the number of cells operating</span>
<a name="ln-3946"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3947"></a><span class="k">      </span><span class="n">WaterMassFlowRatePerCellMin</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-3948"></a>         <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-3949"></a>      <span class="n">WaterMassFlowRatePerCellMax</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-3950"></a>         <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-3951"></a>
<a name="ln-3952"></a>      <span class="c">!round it up to the nearest integer</span>
<a name="ln-3953"></a>      <span class="n">NumCellMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">INT</span><span class="p">((</span><span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">WaterMassFlowRatePerCellMax</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">9999</span><span class="n">d0</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span>
<a name="ln-3954"></a>      <span class="n">NumCellMax</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">INT</span><span class="p">((</span><span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">WaterMassFlowRatePerCellMin</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">9999</span><span class="n">d0</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span>
<a name="ln-3955"></a>    <span class="n">ENDIF</span>
<a name="ln-3956"></a>
<a name="ln-3957"></a>    <span class="c">! cap min at 1</span>
<a name="ln-3958"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumCellMin</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="n">NumCellMin</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3959"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumCellMax</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="n">NumCellMax</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3960"></a>
<a name="ln-3961"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span> <span class="o">==</span> <span class="n">CellCtrl_MinCell</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3962"></a><span class="k">      </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellMin</span>
<a name="ln-3963"></a>    <span class="k">ELSE</span>
<a name="ln-3964"></a><span class="k">      </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellMax</span>
<a name="ln-3965"></a>    <span class="k">END IF</span>
<a name="ln-3966"></a>
<a name="ln-3967"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span>
<a name="ln-3968"></a>    <span class="n">WaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">NumCellON</span>
<a name="ln-3969"></a>
<a name="ln-3970"></a>   <span class="c">! Do not RETURN here if flow rate is less than SmallMassFlow. Check basin heater and then RETURN.</span>
<a name="ln-3971"></a>
<a name="ln-3972"></a>  <span class="c">! MassFlowTolerance is a parameter to indicate a no flow condition</span>
<a name="ln-3973"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="n">MassFlowTolerance</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3974"></a>      <span class="c">! for multiple cells, we assume that it&#39;s a commun bassin</span>
<a name="ln-3975"></a>      <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-3976"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-3977"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-3978"></a>      <span class="k">RETURN</span>
<a name="ln-3979"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-3980"></a>
<a name="ln-3981"></a>    <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! set value to true to enter in the loop</span>
<a name="ln-3982"></a>
<a name="ln-3983"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">IncrNumCellFlag</span><span class="p">)</span>
<a name="ln-3984"></a>      <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3985"></a>
<a name="ln-3986"></a>  <span class="c">!   Initialize local variables to the free convection design values</span>
<a name="ln-3987"></a>      <span class="n">UAdesign</span>               <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-3988"></a>      <span class="n">AirFlowRate</span>            <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-3989"></a>      <span class="n">DesignWaterFlowRate</span>    <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span>
<a name="ln-3990"></a>      <span class="n">OutletWaterTempOFF</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3991"></a>      <span class="n">OutletWaterTemp</span>        <span class="o">=</span> <span class="n">OutletWaterTempOFF</span>
<a name="ln-3992"></a>      <span class="n">FanModeFrac</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3993"></a>
<a name="ln-3994"></a>      <span class="k">Call </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRate</span><span class="p">,</span><span class="n">UAdesign</span><span class="p">,</span><span class="n">OutletWaterTempOFF</span><span class="p">)</span>
<a name="ln-3995"></a>
<a name="ln-3996"></a>  <span class="c">!   Assume Setpoint was met using free convection regime (pump ON and fan OFF)</span>
<a name="ln-3997"></a>      <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3998"></a>      <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">OutletWaterTempOFF</span>
<a name="ln-3999"></a>
<a name="ln-4000"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OutletWaterTempOFF</span> <span class="o">&gt;</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4001"></a>  <span class="c">!     Setpoint was not met (or free conv. not used), turn on cooling tower fan</span>
<a name="ln-4002"></a>        <span class="n">UAdesign</span>          <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4003"></a>        <span class="n">AirFlowRate</span>       <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4004"></a>
<a name="ln-4005"></a>        <span class="c">! The fan power is for all cells operating</span>
<a name="ln-4006"></a>        <span class="n">FanPowerOn</span>        <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4007"></a>
<a name="ln-4008"></a>        <span class="k">Call </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRate</span><span class="p">,</span><span class="n">UAdesign</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4009"></a>
<a name="ln-4010"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">OutletWaterTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4011"></a><span class="k">          IF</span><span class="p">(</span><span class="n">CapacityControl</span> <span class="o">==</span> <span class="n">CapacityControl_FanCycling</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">OutletWaterTemp</span> <span class="o">&lt;=</span> <span class="n">OWTLowerLimit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4012"></a><span class="c">!           Setpoint was met with pump ON and fan ON, calculate run-time fraction</span>
<a name="ln-4013"></a>            <span class="n">FanModeFrac</span>     <span class="o">=</span> <span class="p">(</span><span class="n">TempSetPoint</span><span class="o">-</span><span class="n">OutletWaterTempOFF</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">OutletWaterTemp</span><span class="o">-</span><span class="n">OutletWaterTempOFF</span><span class="p">)</span>
<a name="ln-4014"></a>            <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="n">FanModeFrac</span> <span class="o">*</span> <span class="n">FanPowerOn</span>
<a name="ln-4015"></a>            <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">TempSetPoint</span>
<a name="ln-4016"></a>          <span class="k">ELSE</span>
<a name="ln-4017"></a>            <span class="c">!FluidBypass, fan runs at full speed for the entire time step</span>
<a name="ln-4018"></a>            <span class="n">FanModeFrac</span>     <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4019"></a>            <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="n">FanPowerOn</span>
<a name="ln-4020"></a>            <span class="n">BypassFlag</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4021"></a>          <span class="n">ENDIF</span>
<a name="ln-4022"></a>        <span class="k">ELSE</span>
<a name="ln-4023"></a><span class="c">!         Setpoint was not met, cooling tower ran at full capacity</span>
<a name="ln-4024"></a>          <span class="n">FanModeFrac</span>     <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4025"></a>          <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="n">FanPowerOn</span>
<a name="ln-4026"></a>          <span class="c">! if possible increase the number of cells and do the calculations again with the new water mass flow rate per cell</span>
<a name="ln-4027"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NumCellON</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>   <span class="p">&amp;</span>
<a name="ln-4028"></a>             <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">NumCellON</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">WaterMassFlowRatePerCellMin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4029"></a><span class="k">            </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4030"></a>            <span class="n">WaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">NumCellON</span>
<a name="ln-4031"></a>            <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4032"></a>          <span class="k">END IF</span>
<a name="ln-4033"></a><span class="k">        END IF</span>
<a name="ln-4034"></a><span class="k">      </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">OutletWaterTempOFF</span> <span class="o">&lt;</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4035"></a>        <span class="c">! Need to bypass in free convection cooling mode if bypass is allowed</span>
<a name="ln-4036"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CapacityControl</span> <span class="o">==</span> <span class="n">CapacityControl_FluidBypass</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4037"></a><span class="k">          IF</span><span class="p">(</span><span class="n">OutletWaterTempOFF</span> <span class="o">&gt;</span> <span class="n">OWTLowerLimit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4038"></a><span class="k">          </span><span class="n">BypassFlag</span>  <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4039"></a>          <span class="n">ENDIF</span>
<a name="ln-4040"></a>        <span class="n">ENDIF</span>
<a name="ln-4041"></a>      <span class="k">END IF</span>
<a name="ln-4042"></a><span class="k">    END DO</span>
<a name="ln-4043"></a>
<a name="ln-4044"></a>    <span class="c">! Calculate bypass fraction since OWTLowerLimit &lt; OutletWaterTemp &lt; TempSetPoint.</span>
<a name="ln-4045"></a>    <span class="c">! The iteraction ends when the numer of iteraction exceeds the limit or the difference</span>
<a name="ln-4046"></a>    <span class="c">!  between the new and old bypass fractions is less than the threshold.</span>
<a name="ln-4047"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">BypassFlag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4048"></a>      <span class="c">!Inlet water temperature lower than setpoint, assume 100% bypass, tower fan off</span>
<a name="ln-4049"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">InletWaterTemp</span> <span class="o">&lt;=</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4050"></a><span class="k">        </span><span class="n">CTFanPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4051"></a>        <span class="n">BypassFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4052"></a>        <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4053"></a>        <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">InletWaterTemp</span>
<a name="ln-4054"></a>      <span class="k">ELSE</span>
<a name="ln-4055"></a><span class="k">          IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">InletWaterTemp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span><span class="o">&lt;=</span><span class="mf">0.01d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4056"></a>            <span class="c">! Outlet temp is close enough to inlet temp, assume 100% bypass, tower fan off</span>
<a name="ln-4057"></a>            <span class="n">BypassFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4058"></a>            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4059"></a>            <span class="n">CTFanPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4060"></a>          <span class="k">ELSE</span>
<a name="ln-4061"></a><span class="k">            </span><span class="n">BypassFraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempSetPoint</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">InletWaterTemp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4062"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">BypassFraction</span> <span class="o">&gt;</span><span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">BypassFraction</span><span class="o">&lt;</span><span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4063"></a>              <span class="c">! Bypass cannot meet setpoint, assume no bypass</span>
<a name="ln-4064"></a>              <span class="n">BypassFlag</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4065"></a>              <span class="n">BypassFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4066"></a>              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4067"></a>            <span class="k">ELSE</span>
<a name="ln-4068"></a><span class="k">              </span><span class="n">NumIteration</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4069"></a>              <span class="n">BypassFractionPrev</span> <span class="o">=</span> <span class="n">BypassFraction</span>
<a name="ln-4070"></a>              <span class="n">OutletWaterTempPrev</span> <span class="o">=</span> <span class="n">OutletWaterTemp</span>
<a name="ln-4071"></a>              <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">NumIteration</span> <span class="o">&lt;</span> <span class="n">MaxIteration</span><span class="p">)</span>
<a name="ln-4072"></a>                <span class="n">NumIteration</span> <span class="o">=</span> <span class="n">NumIteration</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4073"></a>                <span class="c">! need to iterate for the new OutletWaterTemp while bypassing tower water</span>
<a name="ln-4074"></a>                <span class="k">Call </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">WaterMassFlowRatePerCell</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">BypassFraction</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-4075"></a>                   <span class="n">AirFlowRate</span><span class="p">,</span> <span class="n">UAdesign</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4076"></a>                <span class="c">! Calc new BypassFraction based on the new OutletWaterTemp</span>
<a name="ln-4077"></a>                <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">OutletWaterTemp</span> <span class="o">-</span> <span class="n">OWTLowerLimit</span><span class="p">)</span><span class="o">&lt;=</span><span class="mf">0.01d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4078"></a><span class="k">                  </span><span class="n">BypassFraction2</span> <span class="o">=</span> <span class="n">BypassFraction</span>
<a name="ln-4079"></a>                  <span class="k">EXIT</span>
<a name="ln-4080"></a><span class="k">                </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">OutletWaterTemp</span> <span class="o">&lt;</span> <span class="n">OWTLowerLimit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4081"></a>                  <span class="c">! Set OutletWaterTemp = OWTLowerLimit, and use linear interpolation to calculate the bypassFraction</span>
<a name="ln-4082"></a>                  <span class="n">BypassFraction2</span> <span class="o">=</span> <span class="n">BypassFractionPrev</span> <span class="o">-</span> <span class="p">(</span><span class="n">BypassFractionPrev</span><span class="o">-</span><span class="n">BypassFraction</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">OutletWaterTempPrev</span><span class="o">-</span><span class="n">OWTLowerLimit</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4083"></a>                                    <span class="o">/</span><span class="p">(</span><span class="n">OutletWaterTempPrev</span><span class="o">-</span><span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4084"></a>                  <span class="k">Call </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">WaterMassFlowRatePerCell</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">BypassFraction2</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-4085"></a>                     <span class="n">AirFlowRate</span><span class="p">,</span> <span class="n">UAdesign</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4086"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">OutletWaterTemp</span> <span class="o">&lt;</span> <span class="n">OWTLowerLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4087"></a>                    <span class="c">!Use previous iteraction values</span>
<a name="ln-4088"></a>                    <span class="n">BypassFraction2</span> <span class="o">=</span> <span class="n">BypassFractionPrev</span>
<a name="ln-4089"></a>                    <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">OutletWaterTempPrev</span>
<a name="ln-4090"></a>                  <span class="n">ENDIF</span>
<a name="ln-4091"></a>                  <span class="k">EXIT</span>
<a name="ln-4092"></a><span class="k">                ELSE</span>
<a name="ln-4093"></a><span class="k">                  </span><span class="n">BypassFraction2</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempSetPoint</span><span class="o">-</span><span class="n">OutletWaterTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">InletWaterTemp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4094"></a>                <span class="n">ENDIF</span>
<a name="ln-4095"></a>
<a name="ln-4096"></a>                <span class="c">! Compare two BypassFraction to determine when to stop</span>
<a name="ln-4097"></a>                <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">BypassFraction2</span> <span class="o">-</span> <span class="n">BypassFraction</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">BypassFractionThreshold</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-4098"></a><span class="k">                </span><span class="n">BypassFractionPrev</span> <span class="o">=</span> <span class="n">BypassFraction</span>
<a name="ln-4099"></a>                <span class="n">OutletWaterTempPrev</span> <span class="o">=</span> <span class="n">OutletWaterTemp</span>
<a name="ln-4100"></a>                <span class="n">BypassFraction</span> <span class="o">=</span> <span class="n">BypassFraction2</span>
<a name="ln-4101"></a>              <span class="k">END DO</span>
<a name="ln-4102"></a><span class="k">              IF</span><span class="p">(</span><span class="n">NumIteration</span> <span class="o">&gt;</span> <span class="n">MaxIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4103"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Cooling tower fluid bypass iteration &#39;</span> <span class="p">&amp;</span>
<a name="ln-4104"></a>                 <span class="o">//</span><span class="s1">&#39;exceeds maximum limit of &#39;</span><span class="o">//</span><span class="n">MaxItChar</span><span class="o">//</span><span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4105"></a>              <span class="n">ENDIF</span>
<a name="ln-4106"></a>              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span> <span class="o">=</span> <span class="n">BypassFraction2</span>
<a name="ln-4107"></a>              <span class="c">! may not meet TempSetPoint due to limit of tower outlet temp to OWTLowerLimit</span>
<a name="ln-4108"></a>              <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">BypassFraction2</span><span class="p">)</span><span class="o">*</span><span class="n">OutletWaterTemp</span> <span class="o">+</span> <span class="n">BypassFraction2</span><span class="o">*</span><span class="n">InletWaterTemp</span>
<a name="ln-4109"></a>            <span class="n">ENDIF</span>
<a name="ln-4110"></a>          <span class="n">ENDIF</span>
<a name="ln-4111"></a>      <span class="n">ENDIF</span>
<a name="ln-4112"></a>    <span class="n">ENDIF</span>
<a name="ln-4113"></a>
<a name="ln-4114"></a>    <span class="c">!output the fraction of the time step the fan is ON</span>
<a name="ln-4115"></a>    <span class="n">FanCyclingRatio</span> <span class="o">=</span> <span class="n">FanModeFrac</span>
<a name="ln-4116"></a>    <span class="c">! output the number of cells operating</span>
<a name="ln-4117"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span>
<a name="ln-4118"></a>    <span class="c">!Should this be water inlet node num?????</span>
<a name="ln-4119"></a>    <span class="n">CpWater</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4120"></a>                               <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span>                                   <span class="p">&amp;</span>
<a name="ln-4121"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-4122"></a>                               <span class="s1">&#39;CalcSingleSpeedTower&#39;</span><span class="p">)</span>
<a name="ln-4123"></a>
<a name="ln-4124"></a>    <span class="n">Qactual</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4125"></a>    <span class="n">AirFlowRateRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">AirFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>
<a name="ln-4126"></a>
<a name="ln-4127"></a><span class="k">RETURN</span>
<a name="ln-4128"></a><span class="k">END SUBROUTINE </span><span class="n">CalcSingleSpeedTower</span>
<a name="ln-4129"></a>
<a name="ln-4130"></a><span class="k">SUBROUTINE </span><span class="n">CalcTwoSpeedTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-4131"></a>
<a name="ln-4132"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4133"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-4134"></a>          <span class="c">!       DATE WRITTEN   Sept. 1998</span>
<a name="ln-4135"></a>          <span class="c">!       MODIFIED       Chandan Sharma, FSEC, February 2010, Added basin heater</span>
<a name="ln-4136"></a>          <span class="c">!                      A Flament, July 2010, added multi-cell capability for the 3 types of cooling tower</span>
<a name="ln-4137"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4138"></a>
<a name="ln-4139"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4140"></a>          <span class="c">!</span>
<a name="ln-4141"></a>          <span class="c">! To simulate the operation of a cooling tower with a two-speed fan.</span>
<a name="ln-4142"></a>
<a name="ln-4143"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4144"></a>          <span class="c">!</span>
<a name="ln-4145"></a>          <span class="c">! The cooling tower is modeled using effectiveness-NTU relationships for</span>
<a name="ln-4146"></a>          <span class="c">! counterflow heat exchangers based on Merkel&#39;s theory.</span>
<a name="ln-4147"></a>          <span class="c">!</span>
<a name="ln-4148"></a>          <span class="c">! The subroutine calculates the period of time required to meet a</span>
<a name="ln-4149"></a>          <span class="c">! leaving water temperature setpoint. It assumes that part-load</span>
<a name="ln-4150"></a>          <span class="c">! operation represents a linear interpolation of three steady-state regimes</span>
<a name="ln-4151"></a>          <span class="c">! (high-speed fan operation, low-speed fan operation and free convection regime).</span>
<a name="ln-4152"></a>          <span class="c">! Cyclic losses are neglected. The period of time required to meet the</span>
<a name="ln-4153"></a>          <span class="c">! leaving water temperature setpoint is used to determine the required</span>
<a name="ln-4154"></a>          <span class="c">! fan power and energy. Free convection regime is also modeled. This</span>
<a name="ln-4155"></a>          <span class="c">! occures when the pump is operating and the fan is off. If free convection</span>
<a name="ln-4156"></a>          <span class="c">! regime cooling is all that is required for a given time step, the leaving</span>
<a name="ln-4157"></a>          <span class="c">! water temperature is allowed to fall below the leaving water temperature</span>
<a name="ln-4158"></a>          <span class="c">! setpoint (free cooling). At times when the cooling tower fan is required,</span>
<a name="ln-4159"></a>          <span class="c">! the leaving water temperature is at or above the setpoint.</span>
<a name="ln-4160"></a>          <span class="c">!</span>
<a name="ln-4161"></a>          <span class="c">! A RunFlag is passed by the upper level manager to indicate the ON/OFF status,</span>
<a name="ln-4162"></a>          <span class="c">! or schedule, of the cooling tower. If the tower is OFF, outlet water</span>
<a name="ln-4163"></a>          <span class="c">! temperature and flow rate are passed through the model from inlet node to</span>
<a name="ln-4164"></a>          <span class="c">! outlet node without intervention (with the exception of free convection</span>
<a name="ln-4165"></a>          <span class="c">! where water temperature is allowed to float below the outlet water set</span>
<a name="ln-4166"></a>          <span class="c">! point). Reports are also updated with fan power and fan energy being zero.</span>
<a name="ln-4167"></a>          <span class="c">!</span>
<a name="ln-4168"></a>          <span class="c">! When the RunFlag indicates an ON condition for the cooling tower, the</span>
<a name="ln-4169"></a>          <span class="c">! mass flow rate and water temperature are read from the inlet node of the</span>
<a name="ln-4170"></a>          <span class="c">! cooling tower (water-side). The outdoor air wet-bulb temperature is used</span>
<a name="ln-4171"></a>          <span class="c">! as the entering condition to the cooling tower (air-side). Input deck</span>
<a name="ln-4172"></a>          <span class="c">! parameters are read for the free convection regime (pump ON and fan OFF)</span>
<a name="ln-4173"></a>          <span class="c">! and a leaving water temperature is calculated. If the leaving water temperature</span>
<a name="ln-4174"></a>          <span class="c">! is at or below the setpoint, the calculated leaving water temperature is</span>
<a name="ln-4175"></a>          <span class="c">! placed on the outlet node and no fan power is used. If the calculated leaving</span>
<a name="ln-4176"></a>          <span class="c">! water temperature is above the setpoint, the cooling tower fan is turned on</span>
<a name="ln-4177"></a>          <span class="c">! and parameters for low fan speed are used to again calculate the leaving</span>
<a name="ln-4178"></a>          <span class="c">! water temperature. If the calculated leaving water temperature is</span>
<a name="ln-4179"></a>          <span class="c">! below the setpoint, a fan run-time fraction (FanModeFrac) is calculated and</span>
<a name="ln-4180"></a>          <span class="c">! used to determine fan power. The leaving water temperature setpoint is placed</span>
<a name="ln-4181"></a>          <span class="c">! on the outlet node. If the calculated leaving water temperature is at or above</span>
<a name="ln-4182"></a>          <span class="c">! the setpoint, the cooling tower fan is turned on &#39;high speed&#39; and the routine is</span>
<a name="ln-4183"></a>          <span class="c">! repeated. If the calculated leaving water temperature is below the setpoint,</span>
<a name="ln-4184"></a>          <span class="c">! a fan run-time fraction is calculated for the second stage fan and fan power</span>
<a name="ln-4185"></a>          <span class="c">! is calculated as FanModeFrac*HighSpeedFanPower+(1-FanModeFrac)*LowSpeedFanPower.</span>
<a name="ln-4186"></a>          <span class="c">! If the calculated leaving water temperature is above the leaving water temp.</span>
<a name="ln-4187"></a>          <span class="c">! setpoint, the calculated leaving water temperature is placed on the outlet</span>
<a name="ln-4188"></a>          <span class="c">! node and the fan runs at full power (High Speed Fan Power). Water mass flow</span>
<a name="ln-4189"></a>          <span class="c">! rate is passed from inlet node to outlet node with no intervention.</span>
<a name="ln-4190"></a>          <span class="c">!</span>
<a name="ln-4191"></a>          <span class="c">! If a tower has multiple cells, the specified inputs of or the autosized capacity</span>
<a name="ln-4192"></a>          <span class="c">!  and air/water flow rates are for the entire tower. The number of cells to operate</span>
<a name="ln-4193"></a>          <span class="c">!  is first determined based on the user entered minimal and maximal water flow fractions</span>
<a name="ln-4194"></a>          <span class="c">!  per cell. If the loads are not met, more cells (if available) will operate to meet</span>
<a name="ln-4195"></a>          <span class="c">!  the loads. Each cell operates in same way - same fan speed etc.</span>
<a name="ln-4196"></a>          <span class="c">!</span>
<a name="ln-4197"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4198"></a>          <span class="c">! ASHRAE HVAC1KIT: A Toolkit for Primary HVAC System Energy Calculation. 1999.</span>
<a name="ln-4199"></a>
<a name="ln-4200"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4201"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">SingleSetPoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-4202"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-4203"></a>
<a name="ln-4204"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4205"></a>
<a name="ln-4206"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4207"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-4208"></a>
<a name="ln-4209"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4210"></a>          <span class="c">! na</span>
<a name="ln-4211"></a>
<a name="ln-4212"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4213"></a>          <span class="c">! na</span>
<a name="ln-4214"></a>
<a name="ln-4215"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4216"></a>          <span class="c">! na</span>
<a name="ln-4217"></a>
<a name="ln-4218"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AirFlowRate</span>
<a name="ln-4220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">UAdesign</span>            <span class="c">! UA value at design conditions (entered by user) [W/C]</span>
<a name="ln-4221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletWaterTempOFF</span>
<a name="ln-4222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletWaterTemp1stStage</span>
<a name="ln-4223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletWaterTemp2ndStage</span>
<a name="ln-4224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FanModeFrac</span>
<a name="ln-4225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">designWaterFlowRate</span>
<a name="ln-4226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FanPowerLow</span>
<a name="ln-4227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FanPowerHigh</span>
<a name="ln-4228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CpWater</span>
<a name="ln-4229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TempSetPoint</span>
<a name="ln-4230"></a>
<a name="ln-4231"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-4232"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-4233"></a>
<a name="ln-4234"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedSel</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4235"></a>
<a name="ln-4236"></a> <span class="c">!Added variables for multicell</span>
<a name="ln-4237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCellMin</span>
<a name="ln-4238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCellMax</span>
<a name="ln-4239"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumCellMin</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4240"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumCellMax</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4241"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumCellON</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCell</span>
<a name="ln-4243"></a>  <span class="kt">LOGICAL</span>                <span class="kd">::</span> <span class="n">IncrNumCellFlag</span>                   <span class="c">! determine if yes or no we increase the number of cells</span>
<a name="ln-4244"></a>
<a name="ln-4245"></a>
<a name="ln-4246"></a>          <span class="c">!set inlet and outlet nodes</span>
<a name="ln-4247"></a>
<a name="ln-4248"></a>    <span class="n">WaterInletNode</span>      <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-4249"></a>    <span class="n">WaterOutletNode</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-4250"></a>    <span class="n">Qactual</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4251"></a>    <span class="n">CTFanPower</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4252"></a>    <span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4253"></a>    <span class="n">LoopNum</span>             <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span>
<a name="ln-4254"></a>    <span class="n">LoopSideNum</span>         <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span>
<a name="ln-4255"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-4256"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-4257"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SetpointIsOnOutlet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4258"></a><span class="k">        </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">TempSetpoint</span>
<a name="ln-4259"></a>      <span class="k">ELSE</span>
<a name="ln-4260"></a><span class="k">        </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpoint</span>
<a name="ln-4261"></a>      <span class="n">ENDIF</span>
<a name="ln-4262"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-4263"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SetpointIsOnOutlet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4264"></a><span class="k">        </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">TempSetpointHi</span>
<a name="ln-4265"></a>      <span class="k">ELSE</span>
<a name="ln-4266"></a><span class="k">        </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpointHi</span>
<a name="ln-4267"></a>      <span class="n">ENDIF</span>
<a name="ln-4268"></a>    <span class="k">END SELECT</span>
<a name="ln-4269"></a>
<a name="ln-4270"></a>  <span class="c">! Do not RETURN here if flow rate is less than SmallMassFlow. Check basin heater and then RETURN.</span>
<a name="ln-4271"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">Loopside</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">FlowLock</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-4272"></a>  <span class="c">! MassFlowTolerance is a parameter to indicate a no flow condition</span>
<a name="ln-4273"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="n">MassFlowTolerance</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4274"></a><span class="k">      CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-4275"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-4276"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-4277"></a>      <span class="k">RETURN</span>
<a name="ln-4278"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-4279"></a>
<a name="ln-4280"></a>    <span class="c">! Added for multi-cell. Determine the number of cells operating</span>
<a name="ln-4281"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4282"></a><span class="k">      </span><span class="n">WaterMassFlowRatePerCellMin</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-4283"></a>         <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4284"></a>      <span class="n">WaterMassFlowRatePerCellMax</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-4285"></a>         <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4286"></a>
<a name="ln-4287"></a>      <span class="c">!round it up to the nearest integer</span>
<a name="ln-4288"></a>      <span class="n">NumCellMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">INT</span><span class="p">((</span><span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">WaterMassFlowRatePerCellMax</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">9999</span><span class="n">d0</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span>
<a name="ln-4289"></a>      <span class="n">NumCellMax</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">INT</span><span class="p">((</span><span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">WaterMassFlowRatePerCellMin</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">9999</span><span class="n">d0</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span>
<a name="ln-4290"></a>    <span class="n">ENDIF</span>
<a name="ln-4291"></a>
<a name="ln-4292"></a>    <span class="c">! cap min at 1</span>
<a name="ln-4293"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumCellMin</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="n">NumCellMin</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4294"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumCellMax</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="n">NumCellMax</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4295"></a>
<a name="ln-4296"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span> <span class="o">==</span> <span class="n">CellCtrl_MinCell</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4297"></a><span class="k">      </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellMin</span>
<a name="ln-4298"></a>    <span class="k">ELSE</span>
<a name="ln-4299"></a><span class="k">      </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellMax</span>
<a name="ln-4300"></a>    <span class="k">END IF</span>
<a name="ln-4301"></a>
<a name="ln-4302"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span>
<a name="ln-4303"></a>    <span class="n">WaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">NumCellON</span>
<a name="ln-4304"></a>
<a name="ln-4305"></a>    <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4306"></a>
<a name="ln-4307"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">IncrNumCellFlag</span><span class="p">)</span>
<a name="ln-4308"></a>      <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4309"></a>
<a name="ln-4310"></a>      <span class="c">!set local variable for tower</span>
<a name="ln-4311"></a>      <span class="n">UAdesign</span>                <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>  <span class="c">! where is NumCellOn?</span>
<a name="ln-4312"></a>      <span class="n">AirFlowRate</span>             <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4313"></a>      <span class="n">DesignWaterFlowRate</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="c">! ??useless subroutine variable??</span>
<a name="ln-4314"></a>      <span class="n">OutletWaterTempOFF</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4315"></a>      <span class="n">WaterMassFlowRate</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-4316"></a>      <span class="n">OutletWaterTemp1stStage</span> <span class="o">=</span> <span class="n">OutletWaterTemp</span>
<a name="ln-4317"></a>      <span class="n">OutletWaterTemp2ndStage</span> <span class="o">=</span> <span class="n">OutletWaterTemp</span>
<a name="ln-4318"></a>      <span class="n">FanModeFrac</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4319"></a>
<a name="ln-4320"></a>      <span class="k">Call </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRate</span><span class="p">,</span><span class="n">UAdesign</span><span class="p">,</span><span class="n">OutletWaterTempOFF</span><span class="p">)</span>
<a name="ln-4321"></a>
<a name="ln-4322"></a>  <span class="c">!     Setpoint was met using free convection regime (pump ON and fan OFF)</span>
<a name="ln-4323"></a>        <span class="n">CTFanPower</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4324"></a>        <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">OutletWaterTempOFF</span>
<a name="ln-4325"></a>        <span class="n">SpeedSel</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4326"></a>
<a name="ln-4327"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OutletWaterTempOFF</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4328"></a>  <span class="c">!     Setpoint was not met (or free conv. not used),turn on cooling tower 1st stage fan</span>
<a name="ln-4329"></a>        <span class="n">UAdesign</span>        <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedTowerUA</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4330"></a>        <span class="n">AirFlowRate</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedAirFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4331"></a>        <span class="n">FanPowerLow</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LowSpeedFanPower</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4332"></a>
<a name="ln-4333"></a>        <span class="k">Call </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRate</span><span class="p">,</span><span class="n">UAdesign</span><span class="p">,</span><span class="n">OutletWaterTemp1stStage</span><span class="p">)</span>
<a name="ln-4334"></a>
<a name="ln-4335"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">OutletWaterTemp1stStage</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4336"></a><span class="c">!         Setpoint was met with pump ON and fan ON 1st stage, calculate fan mode fraction</span>
<a name="ln-4337"></a>          <span class="n">FanModeFrac</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempSetPoint</span><span class="o">-</span><span class="n">OutletWaterTempOFF</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">OutletWaterTemp1stStage</span><span class="o">-</span><span class="n">OutletWaterTempOFF</span><span class="p">)</span>
<a name="ln-4338"></a>          <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="n">FanModeFrac</span> <span class="o">*</span> <span class="n">FanPowerLow</span>
<a name="ln-4339"></a>          <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">TempSetPoint</span>
<a name="ln-4340"></a>          <span class="n">Qactual</span>         <span class="o">=</span> <span class="n">Qactual</span> <span class="o">*</span> <span class="n">FanModeFrac</span>
<a name="ln-4341"></a>          <span class="n">SpeedSel</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4342"></a>        <span class="k">ELSE</span>
<a name="ln-4343"></a><span class="c">!         Setpoint was not met, turn on cooling tower 2nd stage fan</span>
<a name="ln-4344"></a>          <span class="n">UAdesign</span>          <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4345"></a>          <span class="n">AirFlowRate</span>       <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4346"></a>          <span class="n">FanPowerHigh</span>      <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4347"></a>
<a name="ln-4348"></a>          <span class="k">Call </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRate</span><span class="p">,</span><span class="n">UAdesign</span><span class="p">,</span><span class="n">OutletWaterTemp2ndStage</span><span class="p">)</span>
<a name="ln-4349"></a>
<a name="ln-4350"></a>          <span class="k">IF</span><span class="p">((</span><span class="n">OutletWaterTemp2ndStage</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">TempSetPoint</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UAdesign</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4351"></a><span class="c">!           Setpoint was met with pump ON and fan ON 2nd stage, calculate fan mode fraction</span>
<a name="ln-4352"></a>            <span class="n">FanModeFrac</span>     <span class="o">=</span> <span class="p">(</span><span class="n">TempSetPoint</span><span class="o">-</span><span class="n">OutletWaterTemp1stStage</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">OutletWaterTemp2ndStage</span><span class="o">-</span><span class="n">OutletWaterTemp1stStage</span><span class="p">)</span>
<a name="ln-4353"></a>            <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="p">(</span><span class="n">FanModeFrac</span> <span class="o">*</span> <span class="n">FanPowerHigh</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">FanModeFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FanPowerLow</span>
<a name="ln-4354"></a>            <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">TempSetPoint</span>
<a name="ln-4355"></a>            <span class="n">SpeedSel</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-4356"></a>          <span class="k">ELSE</span>
<a name="ln-4357"></a><span class="c">!           Setpoint was not met, cooling tower ran at full capacity</span>
<a name="ln-4358"></a>            <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">OutletWaterTemp2ndStage</span>
<a name="ln-4359"></a>            <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="n">FanPowerHigh</span>
<a name="ln-4360"></a>            <span class="n">SpeedSel</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-4361"></a>            <span class="n">FanModeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4362"></a>            <span class="c">! if possible increase the number of cells and do the calculations again with the new water mass flow rate per cell</span>
<a name="ln-4363"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">NumCellON</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4364"></a>               <span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">NumCellON</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">WaterMassFlowRatePerCellMin</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4365"></a><span class="k">            </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4366"></a>            <span class="n">WaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">NumCellON</span>
<a name="ln-4367"></a>            <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4368"></a>            <span class="k">END IF</span>
<a name="ln-4369"></a><span class="k">          END IF</span>
<a name="ln-4370"></a>
<a name="ln-4371"></a><span class="k">        END IF</span>
<a name="ln-4372"></a>
<a name="ln-4373"></a><span class="k">      END IF</span>
<a name="ln-4374"></a><span class="k">    END DO</span>
<a name="ln-4375"></a>
<a name="ln-4376"></a>      <span class="c">!output the fraction of the time step the fan is ON</span>
<a name="ln-4377"></a>      <span class="n">FanCyclingRatio</span> <span class="o">=</span> <span class="n">FanModeFrac</span>
<a name="ln-4378"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SpeedSelected</span> <span class="o">=</span> <span class="n">SpeedSel</span>
<a name="ln-4379"></a>      <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span>
<a name="ln-4380"></a>
<a name="ln-4381"></a>      <span class="n">CpWater</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4382"></a>                               <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span>                                   <span class="p">&amp;</span>
<a name="ln-4383"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-4384"></a>                               <span class="s1">&#39;CalcTwoSpeedTower&#39;</span><span class="p">)</span>
<a name="ln-4385"></a>      <span class="n">Qactual</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4386"></a>      <span class="n">AirFlowRateRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">AirFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span>
<a name="ln-4387"></a>
<a name="ln-4388"></a><span class="k">RETURN</span>
<a name="ln-4389"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTwoSpeedTower</span>
<a name="ln-4390"></a>
<a name="ln-4391"></a>
<a name="ln-4392"></a><span class="k">SUBROUTINE </span><span class="n">CalcMerkelVariableSpeedTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-4393"></a>
<a name="ln-4394"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4395"></a>          <span class="c">!       AUTHOR         B.Griffith</span>
<a name="ln-4396"></a>          <span class="c">!       DATE WRITTEN   August 2013</span>
<a name="ln-4397"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4398"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4399"></a>
<a name="ln-4400"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4401"></a>          <span class="c">! Calculate varialble speed tower model using Merkel&#39;s theory with UA adjustments developed by Scheier</span>
<a name="ln-4402"></a>
<a name="ln-4403"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4404"></a>          <span class="c">! Find a fan speed that operates the tower to meet MyLoad</span>
<a name="ln-4405"></a>
<a name="ln-4406"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4407"></a>          <span class="c">! na</span>
<a name="ln-4408"></a>
<a name="ln-4409"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4410"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-4411"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">SingleSetpoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-4412"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-4413"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-4414"></a>
<a name="ln-4415"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4416"></a>
<a name="ln-4417"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4418"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-4419"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MyLoad</span>
<a name="ln-4420"></a>
<a name="ln-4421"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4422"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">DesignWetBlub</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">5.56d0</span> <span class="c">! tower outdoor air entering wetblub for design [C]</span>
<a name="ln-4423"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">MaxIte</span>    <span class="o">=</span> <span class="mi">500</span>     <span class="c">! Maximum number of iterations for solver</span>
<a name="ln-4424"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">Acc</span>       <span class="o">=</span> <span class="mf">1.d-3</span>   <span class="c">! Accuracy of solver result</span>
<a name="ln-4425"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4426"></a>          <span class="c">! na</span>
<a name="ln-4427"></a>
<a name="ln-4428"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4429"></a>          <span class="c">! na</span>
<a name="ln-4430"></a>
<a name="ln-4431"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4432"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>                 <span class="c">! Parameter array passed to solver</span>
<a name="ln-4433"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">SolFla</span>              <span class="c">! Flag of solver</span>
<a name="ln-4434"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpWater</span>
<a name="ln-4435"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-4436"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-4437"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSetpoint</span>
<a name="ln-4438"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCellMin</span>
<a name="ln-4439"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCellMax</span>
<a name="ln-4440"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumCellMin</span>
<a name="ln-4441"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumCellMax</span>
<a name="ln-4442"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumCellOn</span>
<a name="ln-4443"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCell</span>
<a name="ln-4444"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAdesignPerCell</span>
<a name="ln-4445"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirFlowRatePerCell</span>
<a name="ln-4446"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterTempOff</span>
<a name="ln-4447"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FreeConvQdot</span>
<a name="ln-4448"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterFlowRateRatio</span>
<a name="ln-4449"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAwetbulbAdjFac</span>
<a name="ln-4450"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAairFlowAdjFac</span>
<a name="ln-4451"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAWaterFlowAdjFac</span>
<a name="ln-4452"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAadjustedPerCell</span>
<a name="ln-4453"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullSpeedFanQdot</span>
<a name="ln-4454"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">IncrNumCellFlag</span>
<a name="ln-4455"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinSpeedFanQdot</span>
<a name="ln-4456"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanPowerAdjustFac</span>
<a name="ln-4457"></a>
<a name="ln-4458"></a>
<a name="ln-4459"></a>
<a name="ln-4460"></a>
<a name="ln-4461"></a>  <span class="n">WaterInletNode</span>      <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-4462"></a>  <span class="n">CpWater</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4463"></a>                               <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span>                                   <span class="p">&amp;</span>
<a name="ln-4464"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-4465"></a>                               <span class="s1">&#39;CalcMerkelVariableSpeedTower&#39;</span><span class="p">)</span>
<a name="ln-4466"></a>  <span class="n">WaterOutletNode</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-4467"></a>  <span class="n">Qactual</span>             <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4468"></a>  <span class="n">CTFanPower</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4469"></a>  <span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4470"></a>  <span class="n">LoopNum</span>             <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span>
<a name="ln-4471"></a>  <span class="n">LoopSideNum</span>         <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span>
<a name="ln-4472"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-4473"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-4474"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SetpointIsOnOutlet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4475"></a><span class="k">      </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">TempSetpoint</span>
<a name="ln-4476"></a>    <span class="k">ELSE</span>
<a name="ln-4477"></a><span class="k">      </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpoint</span>
<a name="ln-4478"></a>    <span class="n">ENDIF</span>
<a name="ln-4479"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-4480"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SetpointIsOnOutlet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4481"></a><span class="k">      </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">TempSetpointHi</span>
<a name="ln-4482"></a>    <span class="k">ELSE</span>
<a name="ln-4483"></a><span class="k">      </span><span class="n">TempSetPoint</span>     <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpointHi</span>
<a name="ln-4484"></a>    <span class="n">ENDIF</span>
<a name="ln-4485"></a>  <span class="k">END SELECT</span>
<a name="ln-4486"></a>
<a name="ln-4487"></a>    <span class="c">! Added for multi-cell. Determine the number of cells operating</span>
<a name="ln-4488"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4489"></a><span class="k">      </span><span class="n">WaterMassFlowRatePerCellMin</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-4490"></a>         <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4491"></a>      <span class="n">WaterMassFlowRatePerCellMax</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-4492"></a>         <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4493"></a>
<a name="ln-4494"></a>      <span class="c">!round it up to the nearest integer</span>
<a name="ln-4495"></a>      <span class="n">NumCellMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">INT</span><span class="p">((</span><span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">WaterMassFlowRatePerCellMax</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">9999</span><span class="n">d0</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span>
<a name="ln-4496"></a>      <span class="n">NumCellMax</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">INT</span><span class="p">((</span><span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">WaterMassFlowRatePerCellMin</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">9999</span><span class="n">d0</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span>
<a name="ln-4497"></a>    <span class="n">ENDIF</span>
<a name="ln-4498"></a>
<a name="ln-4499"></a>    <span class="c">! cap min at 1</span>
<a name="ln-4500"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumCellMin</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="n">NumCellMin</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4501"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumCellMax</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="n">NumCellMax</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4502"></a>
<a name="ln-4503"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span> <span class="o">==</span> <span class="n">CellCtrl_MinCell</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4504"></a><span class="k">      </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellMin</span>
<a name="ln-4505"></a>    <span class="k">ELSE</span>
<a name="ln-4506"></a><span class="k">      </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellMax</span>
<a name="ln-4507"></a>    <span class="k">END IF</span>
<a name="ln-4508"></a>
<a name="ln-4509"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span>
<a name="ln-4510"></a>    <span class="n">WaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">NumCellON</span>
<a name="ln-4511"></a>  <span class="c">! MassFlowTolerance is a parameter to indicate a no flow condition</span>
<a name="ln-4512"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="n">MassFlowTolerance</span>  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">MyLoad</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4513"></a>      <span class="c">! for multiple cells, we assume that it&#39;s a common bassin</span>
<a name="ln-4514"></a>      <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-4515"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-4516"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-4517"></a>      <span class="k">RETURN</span>
<a name="ln-4518"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-4519"></a>
<a name="ln-4520"></a>
<a name="ln-4521"></a>
<a name="ln-4522"></a>    <span class="c">! first find free convection cooling rate</span>
<a name="ln-4523"></a>    <span class="n">UAdesignPerCell</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvTowerUA</span>   <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4524"></a>    <span class="n">AirFlowRatePerCell</span>  <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvAirFlowRate</span>  <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4525"></a>    <span class="n">OutletWaterTempOFF</span>      <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4526"></a>    <span class="n">WaterMassFlowRate</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-4527"></a>    <span class="k">Call </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRatePerCell</span><span class="p">,</span><span class="n">UAdesignPerCell</span><span class="p">,</span><span class="n">OutletWaterTempOFF</span><span class="p">)</span>
<a name="ln-4528"></a>
<a name="ln-4529"></a>    <span class="n">FreeConvQdot</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTempOFF</span><span class="p">)</span>
<a name="ln-4530"></a>    <span class="n">CTFanPower</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4531"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">FreeConvQdot</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! can meet load with free convection and fan off</span>
<a name="ln-4532"></a>      <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">OutletWaterTempOFF</span>
<a name="ln-4533"></a>      <span class="n">AirFlowRateRatio</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4534"></a>      <span class="n">Qactual</span> <span class="o">=</span> <span class="n">FreeConvQdot</span>
<a name="ln-4535"></a>      <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-4536"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-4537"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-4538"></a>
<a name="ln-4539"></a>      <span class="k">RETURN</span>
<a name="ln-4540"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-4541"></a>
<a name="ln-4542"></a>    <span class="c">! next find full fan speed cooling rate</span>
<a name="ln-4543"></a>    <span class="n">UAdesignPerCell</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedTowerUA</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4544"></a>    <span class="n">AirFlowRatePerCell</span>  <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4545"></a>    <span class="n">AirFlowRateRatio</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-4546"></a>    <span class="n">WaterFlowRateRatio</span> <span class="o">=</span> <span class="n">WaterMassFlowRatePerCell</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRatePerCell</span>
<a name="ln-4547"></a>    <span class="n">UAwetbulbAdjFac</span> <span class="o">=</span>  <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncWetbulbDiffCurvePtr</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4548"></a>                                  <span class="p">(</span><span class="n">DesignWetBlub</span> <span class="o">-</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">))</span>
<a name="ln-4549"></a>    <span class="n">UAairflowAdjFac</span> <span class="o">=</span>  <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncAirFlowRatioCurvePtr</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-4550"></a>    <span class="n">UAwaterflowAdjFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncWaterFlowRatioCurvePtr</span><span class="p">,</span> <span class="n">WaterFlowRateRatio</span><span class="p">)</span>
<a name="ln-4551"></a>    <span class="n">UAadjustedPerCell</span> <span class="o">=</span> <span class="n">UAdesignPerCell</span><span class="o">*</span><span class="n">UAwetbulbAdjFac</span><span class="o">*</span><span class="n">UAairflowAdjFac</span><span class="o">*</span><span class="n">UAwaterflowAdjFac</span>
<a name="ln-4552"></a>    <span class="k">CALL </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRatePerCell</span><span class="p">,</span><span class="n">UAadjustedPerCell</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4553"></a>    <span class="n">FullSpeedFanQdot</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4554"></a>
<a name="ln-4555"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FullSpeedFanQdot</span> <span class="o">&lt;=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! full speed is what we want.</span>
<a name="ln-4556"></a>
<a name="ln-4557"></a>
<a name="ln-4558"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">FullSpeedFanQdot</span><span class="o">+</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">NumCellON</span> <span class="o">&lt;</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4559"></a>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">((</span><span class="n">WaterMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">NumCellON</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">WaterMassFlowRatePerCellMin</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4560"></a>        <span class="c">! If full fan and not meeting setpoint, then increase number of cells until all are used or load is satisfied</span>
<a name="ln-4561"></a>        <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! set value to true to enter in the loop</span>
<a name="ln-4562"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">IncrNumCellFlag</span><span class="p">)</span>
<a name="ln-4563"></a>            <span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4564"></a>            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span>
<a name="ln-4565"></a>            <span class="n">WaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">NumCellON</span>
<a name="ln-4566"></a>            <span class="n">WaterFlowRateRatio</span> <span class="o">=</span> <span class="n">WaterMassFlowRatePerCell</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRatePerCell</span>
<a name="ln-4567"></a>            <span class="n">UAwaterflowAdjFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncWaterFlowRatioCurvePtr</span><span class="p">,</span> <span class="n">WaterFlowRateRatio</span><span class="p">)</span>
<a name="ln-4568"></a>            <span class="n">UAadjustedPerCell</span> <span class="o">=</span> <span class="n">UAdesignPerCell</span><span class="o">*</span><span class="n">UAwetbulbAdjFac</span><span class="o">*</span><span class="n">UAairflowAdjFac</span><span class="o">*</span><span class="n">UAwaterflowAdjFac</span>
<a name="ln-4569"></a>            <span class="k">CALL </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRatePerCell</span><span class="p">,</span><span class="n">UAadjustedPerCell</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4570"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">FullSpeedFanQdot</span><span class="o">+</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">NumCellON</span> <span class="o">&lt;</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4571"></a>                      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">((</span><span class="n">WaterMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">NumCellON</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="n">WaterMassFlowRatePerCellMin</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4572"></a><span class="k">              </span><span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4573"></a>            <span class="k">ELSE</span>
<a name="ln-4574"></a><span class="k">              </span><span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4575"></a>            <span class="n">ENDIF</span>
<a name="ln-4576"></a>        <span class="n">ENDDO</span>
<a name="ln-4577"></a>        <span class="n">FullSpeedFanQdot</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4578"></a>      <span class="n">ENDIF</span>
<a name="ln-4579"></a>      <span class="n">Qactual</span> <span class="o">=</span> <span class="n">FullSpeedFanQdot</span>
<a name="ln-4580"></a>      <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-4581"></a>                                  <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-4582"></a>                                  <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-4583"></a>      <span class="c">! now calculate fan power</span>
<a name="ln-4584"></a>      <span class="n">FanPowerAdjustFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-4585"></a>      <span class="n">CTFanPower</span>        <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">FanPowerAdjustFac</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-4586"></a>                                                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4587"></a>
<a name="ln-4588"></a>      <span class="k">RETURN</span>
<a name="ln-4589"></a>
<a name="ln-4590"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-4591"></a>
<a name="ln-4592"></a>    <span class="c">! next find minimum air flow ratio cooling rate</span>
<a name="ln-4593"></a>    <span class="n">AirFlowRateRatio</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span>
<a name="ln-4594"></a>    <span class="n">AirFlowRatePerCell</span> <span class="o">=</span><span class="n">AirFlowRateRatio</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4595"></a>    <span class="n">UAairflowAdjFac</span> <span class="o">=</span>  <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncAirFlowRatioCurvePtr</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-4596"></a>    <span class="n">UAadjustedPerCell</span> <span class="o">=</span> <span class="n">UAdesignPerCell</span><span class="o">*</span><span class="n">UAwetbulbAdjFac</span><span class="o">*</span><span class="n">UAairflowAdjFac</span><span class="o">*</span><span class="n">UAwaterflowAdjFac</span>
<a name="ln-4597"></a>    <span class="k">CALL </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRatePerCell</span><span class="p">,</span><span class="n">UAadjustedPerCell</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4598"></a>    <span class="n">MinSpeedFanQdot</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4599"></a>
<a name="ln-4600"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">MinSpeedFanQdot</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! min fan speed already exceeds load)</span>
<a name="ln-4601"></a>      <span class="n">Qactual</span> <span class="o">=</span> <span class="n">MinSpeedFanQdot</span>
<a name="ln-4602"></a>      <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-4603"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-4604"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-4605"></a>      <span class="c">! now calculate fan power</span>
<a name="ln-4606"></a>      <span class="n">FanPowerAdjustFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-4607"></a>      <span class="n">CTFanPower</span>        <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">FanPowerAdjustFac</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-4608"></a>                                                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4609"></a>      <span class="k">RETURN</span>
<a name="ln-4610"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-4611"></a>
<a name="ln-4612"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">MinSpeedFanQdot</span> <span class="o">&lt;</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">FullSpeedFanQdot</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4613"></a>      <span class="c">! load can be refined by modulationg fan speed, call regulafalsi</span>
<a name="ln-4614"></a>
<a name="ln-4615"></a>
<a name="ln-4616"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span>
<a name="ln-4617"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">MyLoad</span>
<a name="ln-4618"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterMassFlowRatePerCell</span>
<a name="ln-4619"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">UAdesignPerCell</span>
<a name="ln-4620"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">UAwetbulbAdjFac</span>
<a name="ln-4621"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">UAwaterflowAdjFac</span>
<a name="ln-4622"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">CpWater</span>
<a name="ln-4623"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span>
<a name="ln-4624"></a>
<a name="ln-4625"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="n">VSMerkelResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4626"></a>                             <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-4627"></a>
<a name="ln-4628"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4629"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4630"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSMerkelAFRErrorIter</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4631"></a><span class="k">            </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSMerkelAFRErrorIter</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSMerkelAFRErrorIter</span> <span class="o">+</span><span class="mi">1</span>
<a name="ln-4632"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCoolingTower_VariableSpeedMerkel</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4633"></a>                  <span class="s1">&#39; - Iteration limit exceeded calculating variable speed fan ratio for unit = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4634"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-4635"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated air flow ratio  = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4636"></a>                         <span class="n">RoundSigDigits</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="o">-</span> <span class="n">MinSpeedFanQdot</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">FullSpeedFanQdot</span> <span class="o">-</span> <span class="n">MinSpeedFanQdot</span> <span class="p">),</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-4637"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Calculated air flow ratio = &#39;</span><span class="o">//</span><span class="n">roundSigDigits</span><span class="p">(</span><span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-4638"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The calculated air flow ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4639"></a>                                                      <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-4640"></a>          <span class="n">ENDIF</span>
<a name="ln-4641"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCoolingTower_VariableSpeedMerkel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-4642"></a>                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded calculating air flow ratio error continues.&#39;</span> <span class="p">&amp;</span>
<a name="ln-4643"></a>                 <span class="o">//</span><span class="s1">&#39; air flow ratio statistics follow.&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4644"></a>                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSMerkelAFRErrorIter</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-4645"></a>        <span class="n">ENDIF</span>
<a name="ln-4646"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4647"></a><span class="k">        </span><span class="n">AirFlowRateRatio</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span> <span class="o">-</span> <span class="n">MinSpeedFanQdot</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">FullSpeedFanQdot</span> <span class="o">-</span> <span class="n">MinSpeedFanQdot</span> <span class="p">)</span>
<a name="ln-4648"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4649"></a><span class="k">          IF</span> <span class="p">(</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSMerkelAFRErrorFail</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4650"></a><span class="k">            </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSMerkelAFRErrorFail</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSMerkelAFRErrorFail</span> <span class="o">+</span><span class="mi">1</span>
<a name="ln-4651"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCoolingTower_VariableSpeedMerkel</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4652"></a>                  <span class="s1">&#39; - solver failed calculating variable speed fan ratio for unit = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4653"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-4654"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Estimated air flow ratio  = &#39;</span><span class="o">//</span>  <span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-4655"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;The estimated air flow ratio will be used and the simulation&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4656"></a>                                                      <span class="s1">&#39; continues. Occurrence info: &#39;</span><span class="p">)</span>
<a name="ln-4657"></a>          <span class="n">ENDIF</span>
<a name="ln-4658"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCoolingTower_VariableSpeedMerkel</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-4659"></a>                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - solver failed calculating air flow ratio error continues.&#39;</span> <span class="p">&amp;</span>
<a name="ln-4660"></a>                 <span class="o">//</span><span class="s1">&#39; air flow ratio statistics follow.&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4661"></a>                    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSMerkelAFRErrorFail</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-4662"></a>        <span class="n">ENDIF</span>
<a name="ln-4663"></a>      <span class="n">ENDIF</span>
<a name="ln-4664"></a>
<a name="ln-4665"></a>      <span class="c">! now rerun to get peformance with AirFlowRateRatio</span>
<a name="ln-4666"></a>      <span class="n">AirFlowRatePerCell</span> <span class="o">=</span> <span class="n">AirFlowRateRatio</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4667"></a>
<a name="ln-4668"></a>      <span class="n">UAairflowAdjFac</span> <span class="o">=</span>  <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncAirFlowRatioCurvePtr</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-4669"></a>      <span class="n">UAadjustedPerCell</span> <span class="o">=</span> <span class="n">UAdesignPerCell</span><span class="o">*</span><span class="n">UAwetbulbAdjFac</span><span class="o">*</span><span class="n">UAairflowAdjFac</span><span class="o">*</span><span class="n">UAwaterflowAdjFac</span>
<a name="ln-4670"></a>
<a name="ln-4671"></a>      <span class="k">CALL </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRatePerCell</span><span class="p">,</span><span class="n">UAadjustedPerCell</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4672"></a>      <span class="n">Qactual</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-4673"></a>      <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-4674"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-4675"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-4676"></a>
<a name="ln-4677"></a>      <span class="c">! now calculate fan power</span>
<a name="ln-4678"></a>      <span class="n">FanPowerAdjustFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-4679"></a>      <span class="n">CTFanPower</span>        <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">FanPowerAdjustFac</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-4680"></a>                                                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4681"></a>
<a name="ln-4682"></a>    <span class="n">ENDIF</span>
<a name="ln-4683"></a>
<a name="ln-4684"></a>
<a name="ln-4685"></a>  <span class="k">RETURN</span>
<a name="ln-4686"></a>
<a name="ln-4687"></a><span class="k">END SUBROUTINE </span><span class="n">CalcMerkelVariableSpeedTower</span>
<a name="ln-4688"></a>
<a name="ln-4689"></a><span class="k">FUNCTION </span><span class="n">VSMerkelResidual</span><span class="p">(</span><span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-4690"></a>
<a name="ln-4691"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-4692"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-4693"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-4694"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4695"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4696"></a>
<a name="ln-4697"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-4698"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4699"></a>
<a name="ln-4700"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4701"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4702"></a>
<a name="ln-4703"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4704"></a>          <span class="c">! na</span>
<a name="ln-4705"></a>
<a name="ln-4706"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4707"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-4708"></a>
<a name="ln-4709"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4710"></a>
<a name="ln-4711"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-4712"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AirFlowRateRatio</span> <span class="c">! fan speed ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-4713"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = Tower number</span>
<a name="ln-4714"></a>                                                  <span class="c">! par(2) =MyLoad [W] , negative is cooling</span>
<a name="ln-4715"></a>                                                  <span class="c">! par(3) = water mass flow per cell</span>
<a name="ln-4716"></a>                                                  <span class="c">! par(4) = Design UA per cell</span>
<a name="ln-4717"></a>                                                  <span class="c">! par(5) = UA adjust factor for wetbulb</span>
<a name="ln-4718"></a>                                                  <span class="c">! par(6) = UA adjust factor for water flow rate</span>
<a name="ln-4719"></a>                                                  <span class="c">! par(7) = specific heat of water at inlet temp</span>
<a name="ln-4720"></a>                                                  <span class="c">! par(8) = water mass flow rate, total [kg/s]</span>
<a name="ln-4721"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-4722"></a>
<a name="ln-4723"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-4724"></a>          <span class="c">! na</span>
<a name="ln-4725"></a>
<a name="ln-4726"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4727"></a>          <span class="c">! na</span>
<a name="ln-4728"></a>
<a name="ln-4729"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4730"></a>          <span class="c">! na</span>
<a name="ln-4731"></a>
<a name="ln-4732"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4733"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-4734"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCell</span>
<a name="ln-4735"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TargetLoad</span>
<a name="ln-4736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAdesignPerCell</span>
<a name="ln-4737"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAwetbulbAdjFac</span>
<a name="ln-4738"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAairflowAdjFac</span>
<a name="ln-4739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAwaterflowAdjFac</span>
<a name="ln-4740"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpWater</span>
<a name="ln-4741"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalWaterMassFlowRate</span>
<a name="ln-4742"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirFlowRatePerCell</span>
<a name="ln-4743"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAadjustedPerCell</span>
<a name="ln-4744"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Qdot</span>
<a name="ln-4745"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterTempTrial</span>
<a name="ln-4746"></a>
<a name="ln-4747"></a>  <span class="n">TowerNum</span>                 <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4748"></a>  <span class="n">TargetLoad</span>               <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4749"></a>  <span class="n">WaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4750"></a>  <span class="n">UAdesignPerCell</span>          <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4751"></a>  <span class="n">UAwetbulbAdjFac</span>          <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4752"></a>  <span class="n">UAwaterflowAdjFac</span>        <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4753"></a>  <span class="n">CpWater</span>                  <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4754"></a>  <span class="n">TotalWaterMassFlowRate</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-4755"></a>
<a name="ln-4756"></a>  <span class="n">AirFlowRatePerCell</span> <span class="o">=</span> <span class="n">AirFlowRateRatio</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4757"></a>
<a name="ln-4758"></a>  <span class="n">UAairflowAdjFac</span> <span class="o">=</span>  <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UAModFuncAirFlowRatioCurvePtr</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-4759"></a>  <span class="n">UAadjustedPerCell</span> <span class="o">=</span> <span class="n">UAdesignPerCell</span><span class="o">*</span><span class="n">UAwetbulbAdjFac</span><span class="o">*</span><span class="n">UAairflowAdjFac</span><span class="o">*</span><span class="n">UAwaterflowAdjFac</span>
<a name="ln-4760"></a>
<a name="ln-4761"></a>  <span class="k">CALL </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRatePerCell</span><span class="p">,</span><span class="n">AirFlowRatePerCell</span><span class="p">,</span><span class="n">UAadjustedPerCell</span><span class="p">,</span> <span class="n">OutletWaterTempTrial</span><span class="p">)</span>
<a name="ln-4762"></a>
<a name="ln-4763"></a>  <span class="n">Qdot</span> <span class="o">=</span> <span class="n">TotalWaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTempTrial</span><span class="p">)</span>
<a name="ln-4764"></a>
<a name="ln-4765"></a>  <span class="n">Residuum</span> <span class="o">=</span>  <span class="nb">ABS</span><span class="p">(</span><span class="n">TargetLoad</span><span class="p">)</span> <span class="o">-</span> <span class="n">Qdot</span>
<a name="ln-4766"></a>
<a name="ln-4767"></a>  <span class="k">RETURN</span>
<a name="ln-4768"></a>
<a name="ln-4769"></a><span class="k">END FUNCTION </span><span class="n">VSMerkelResidual</span>
<a name="ln-4770"></a>
<a name="ln-4771"></a>
<a name="ln-4772"></a>
<a name="ln-4773"></a>
<a name="ln-4774"></a><span class="k">SUBROUTINE </span><span class="n">CalcVariableSpeedTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-4775"></a>
<a name="ln-4776"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4777"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-4778"></a>          <span class="c">!       DATE WRITTEN   Feb 2005</span>
<a name="ln-4779"></a>          <span class="c">!       MODIFIED       A Flament, July 2010, added multi-cell capability for the 3 types of cooling tower</span>
<a name="ln-4780"></a>          <span class="c">!                      B Griffith, general fluid props</span>
<a name="ln-4781"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-4782"></a>
<a name="ln-4783"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4784"></a>          <span class="c">!</span>
<a name="ln-4785"></a>          <span class="c">! To simulate the operation of a variable-speed fan cooling tower.</span>
<a name="ln-4786"></a>
<a name="ln-4787"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4788"></a>          <span class="c">!</span>
<a name="ln-4789"></a>          <span class="c">! For each simulation time step, a desired range temperature (Twater,inlet-Twater,setpoint) and desired approach</span>
<a name="ln-4790"></a>          <span class="c">! temperature (Twater,setpoint-Tair,WB) is calculated which meets the outlet water temperature setpoint. This</span>
<a name="ln-4791"></a>          <span class="c">! desired range and approach temperature also provides a balance point for the empirical model where:</span>
<a name="ln-4792"></a>          <span class="c">!</span>
<a name="ln-4793"></a>          <span class="c">! Tair,WB + Twater,range + Tapproach = Node(WaterInletNode)%Temp</span>
<a name="ln-4794"></a>          <span class="c">!</span>
<a name="ln-4795"></a>          <span class="c">! Calculation of water outlet temperature uses one of the following equations:</span>
<a name="ln-4796"></a>          <span class="c">!</span>
<a name="ln-4797"></a>          <span class="c">! Twater,outlet = Tair,WB + Tapproach          (1)  or</span>
<a name="ln-4798"></a>          <span class="c">! Twater,outlet = Twater,inlet - Twater,range  (2)</span>
<a name="ln-4799"></a>          <span class="c">!</span>
<a name="ln-4800"></a>          <span class="c">! If a solution (or balance) is found, these 2 calculation methods are equal. Equation 2 is used to calculate</span>
<a name="ln-4801"></a>          <span class="c">! the outlet water temperature in the free convection regime and at the minimum or maximum fan speed so that</span>
<a name="ln-4802"></a>          <span class="c">! if a solution is not reached, the outlet water temperature is approximately equal to the inlet water temperature</span>
<a name="ln-4803"></a>          <span class="c">! and the tower fan must be varied to meet the setpoint. Equation 1 is used when the fan speed is varied between</span>
<a name="ln-4804"></a>          <span class="c">! the minimum and maximum fan speed to meet the outlet water temperature setpoint.</span>
<a name="ln-4805"></a>          <span class="c">!</span>
<a name="ln-4806"></a>          <span class="c">! The outlet water temperature in the free convection regime is first calculated to see if the setpoint is met.</span>
<a name="ln-4807"></a>          <span class="c">! If the setpoint is met, the fan is OFF and the outlet water temperature is allowed to float below the set</span>
<a name="ln-4808"></a>          <span class="c">! point temperature. If the setpoint is not met, the outlet water temperature is re-calculated at the minimum</span>
<a name="ln-4809"></a>          <span class="c">! fan speed. If the setpoint is met, the fan is cycled to exactly meet the outlet water temperature setpoint.</span>
<a name="ln-4810"></a>          <span class="c">! If the setpoint is not met at the minimum fan speed, the outlet water temperature is re-calculated at the</span>
<a name="ln-4811"></a>          <span class="c">! maximum fan speed. If the setpoint at the maximum fan speed is not met, the fan runs at maximum speed the</span>
<a name="ln-4812"></a>          <span class="c">! entire time step. If the setpoint is met at the maximum fan speed, the fan speed is varied to meet the setpoint.</span>
<a name="ln-4813"></a>          <span class="c">!</span>
<a name="ln-4814"></a>          <span class="c">! If a tower has multiple cells, the specified inputs of or the autosized capacity</span>
<a name="ln-4815"></a>          <span class="c">!  and air/water flow rates are for the entire tower. The number of cells to operate</span>
<a name="ln-4816"></a>          <span class="c">!  is first determined based on the user entered minimal and maximal water flow fractions</span>
<a name="ln-4817"></a>          <span class="c">!  per cell. If the loads are not met, more cells (if available) will operate to meet</span>
<a name="ln-4818"></a>          <span class="c">!  the loads. Inside each cell, the fan speed varies in the same way.</span>
<a name="ln-4819"></a>          <span class="c">!</span>
<a name="ln-4820"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4821"></a>          <span class="c">!</span>
<a name="ln-4822"></a>          <span class="c">! Benton, D.J., Bowmand, C.F., Hydeman, M., Miller, P.,</span>
<a name="ln-4823"></a>          <span class="c">! &quot;An Improved Cooling Tower Algorithm for the CoolToolsTM Simulation Model&quot;.</span>
<a name="ln-4824"></a>          <span class="c">! ASHRAE Transactions 2002, V. 108, Pt. 1.</span>
<a name="ln-4825"></a>          <span class="c">!</span>
<a name="ln-4826"></a>          <span class="c">! York International Corporation, &quot;YORKcalcTM Software, Chiller-Plant Energy-Estimating Program&quot;,</span>
<a name="ln-4827"></a>          <span class="c">! Form 160.00-SG2 (0502). © 2002.</span>
<a name="ln-4828"></a>
<a name="ln-4829"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4830"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span>
<a name="ln-4831"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-4832"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">EnvironmentName</span><span class="p">,</span> <span class="n">CurMnDy</span>
<a name="ln-4833"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-4834"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CreateSysTimeIntervalString</span>
<a name="ln-4835"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">SingleSetPoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-4836"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-4837"></a>
<a name="ln-4838"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4839"></a>
<a name="ln-4840"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4841"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-4842"></a>
<a name="ln-4843"></a>
<a name="ln-4844"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4845"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OutputFormat</span>  <span class="o">=</span><span class="s1">&#39;(F5.2)&#39;</span>
<a name="ln-4846"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OutputFormat2</span> <span class="o">=</span><span class="s1">&#39;(F8.5)&#39;</span>
<a name="ln-4847"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>          <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>         <span class="c">! Maximum number of iterations</span>
<a name="ln-4848"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">0.0001d0</span>      <span class="c">! Accuracy of result</span>
<a name="ln-4849"></a>
<a name="ln-4850"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4851"></a>          <span class="c">! na</span>
<a name="ln-4852"></a>
<a name="ln-4853"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4854"></a>          <span class="c">! na</span>
<a name="ln-4855"></a>
<a name="ln-4856"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4857"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletWaterTempOFF</span>   <span class="c">! Outlet water temperature with fan OFF (C)</span>
<a name="ln-4858"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletWaterTempON</span>    <span class="c">! Outlet water temperature with fan ON at maximum fan speed (C)</span>
<a name="ln-4859"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletWaterTempMIN</span>   <span class="c">! Outlet water temperature with fan at minimum speed (C)</span>
<a name="ln-4860"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CpWater</span>              <span class="c">! Specific heat of water</span>
<a name="ln-4861"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TempSetPoint</span>         <span class="c">! Outlet water temperature setpoint (C)</span>
<a name="ln-4862"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FanCurveValue</span>        <span class="c">! Output of fan power as a func of air flow rate ratio curve</span>
<a name="ln-4863"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AirDensity</span>           <span class="c">! Density of air [kg/m3]</span>
<a name="ln-4864"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AirMassFlowRate</span>      <span class="c">! Mass flow rate of air [kg/s]</span>
<a name="ln-4865"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>     <span class="c">! Enthalpy of entering moist air [J/kg]</span>
<a name="ln-4866"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SolFla</span>               <span class="c">! Flag of solver</span>
<a name="ln-4867"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Par</span>                  <span class="c">! Parameter array for regula falsi solver</span>
<a name="ln-4868"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Twb</span>                  <span class="c">! inlet air wet-bulb temperature</span>
<a name="ln-4869"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TwbCapped</span>            <span class="c">! inlet air wet-bulb temp passed to VS tower model</span>
<a name="ln-4870"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Tr</span>                   <span class="c">! range temperature</span>
<a name="ln-4871"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TrCapped</span>             <span class="c">! range temp passed to VS tower model</span>
<a name="ln-4872"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Ta</span>                   <span class="c">! approach temperature</span>
<a name="ln-4873"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">TaCapped</span>             <span class="c">! approach temp passed to VS tower model</span>
<a name="ln-4874"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterFlowRateRatio</span>   <span class="c">! Water flow rate ratio</span>
<a name="ln-4875"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterFlowRateRatioCapped</span> <span class="c">! Water flow rate ratio passed to VS tower model</span>
<a name="ln-4876"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterDensity</span>             <span class="c">! density of inlet water</span>
<a name="ln-4877"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FreeConvectionCapFrac</span>    <span class="c">! fraction of tower capacity in free convection</span>
<a name="ln-4878"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">FlowFraction</span>         <span class="c">! liquid to gas (L/G) ratio for cooling tower</span>
<a name="ln-4879"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">OutputChar</span>           <span class="c">! character string used for warning messages</span>
<a name="ln-4880"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">OutputChar2</span>          <span class="c">! character string used for warning messages</span>
<a name="ln-4881"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">OutputChar3</span>          <span class="c">! character string used for warning messages</span>
<a name="ln-4882"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">OutputChar4</span>          <span class="c">! character string used for warning messages</span>
<a name="ln-4883"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">OutputChar5</span>          <span class="c">! character string used for warning messages</span>
<a name="ln-4884"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">TimeStepSysLast</span><span class="o">=</span><span class="mf">0.0d0</span>      <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-4885"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CurrentEndTime</span>       <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-4886"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span><span class="o">=</span><span class="mf">0.0d0</span>   <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-4887"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-4888"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-4889"></a>
<a name="ln-4890"></a>   <span class="c">!Added variables for multicell</span>
<a name="ln-4891"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCellMin</span>
<a name="ln-4892"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCellMax</span>
<a name="ln-4893"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumCellMin</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4894"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumCellMax</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4895"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">NumCellON</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WaterMassFlowRatePerCell</span>
<a name="ln-4897"></a>  <span class="kt">LOGICAL</span>                <span class="kd">::</span> <span class="n">IncrNumCellFlag</span>
<a name="ln-4898"></a>
<a name="ln-4899"></a>   <span class="c">! Added for multi-cell. Determine the number of cells operating</span>
<a name="ln-4900"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4901"></a><span class="k">      </span><span class="n">WaterMassFlowRatePerCellMin</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinFracFlowRate</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-4902"></a>         <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4903"></a>      <span class="n">WaterMassFlowRatePerCellMax</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MaxFracFlowRate</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-4904"></a>         <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4905"></a>
<a name="ln-4906"></a>      <span class="c">!round it up to the nearest integer</span>
<a name="ln-4907"></a>      <span class="n">NumCellMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">INT</span><span class="p">((</span><span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">WaterMassFlowRatePerCellMax</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">9999</span><span class="n">d0</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span>
<a name="ln-4908"></a>      <span class="n">NumCellMax</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">INT</span><span class="p">((</span><span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">WaterMassFlowRatePerCellMin</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">9999</span><span class="n">d0</span><span class="p">),</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span><span class="p">)</span>
<a name="ln-4909"></a>    <span class="n">ENDIF</span>
<a name="ln-4910"></a>
<a name="ln-4911"></a>    <span class="c">! cap min at 1</span>
<a name="ln-4912"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumCellMin</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="n">NumCellMin</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4913"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumCellMax</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span><span class="n">NumCellMax</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4914"></a>
<a name="ln-4915"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CellCtrl_Num</span> <span class="o">==</span> <span class="n">CellCtrl_MinCell</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4916"></a><span class="k">      </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellMin</span>
<a name="ln-4917"></a>    <span class="k">ELSE</span>
<a name="ln-4918"></a><span class="k">      </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellMax</span>
<a name="ln-4919"></a>    <span class="k">END IF</span>
<a name="ln-4920"></a>
<a name="ln-4921"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span>
<a name="ln-4922"></a>    <span class="n">WaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">NumCellON</span>
<a name="ln-4923"></a>
<a name="ln-4924"></a>  <span class="c">! Set inlet and outlet nodes and initialize subroutine variables</span>
<a name="ln-4925"></a>
<a name="ln-4926"></a>    <span class="n">WaterInletNode</span>     <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-4927"></a>    <span class="n">WaterOutletNode</span>    <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-4928"></a>    <span class="n">Qactual</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4929"></a>    <span class="n">CTFanPower</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4930"></a>    <span class="n">OutletWaterTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4931"></a>
<a name="ln-4932"></a>    <span class="n">WaterUsage</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4933"></a>    <span class="n">Twb</span>                <span class="o">=</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span>
<a name="ln-4934"></a>    <span class="n">TwbCapped</span>          <span class="o">=</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span>
<a name="ln-4935"></a>    <span class="n">LoopNum</span>            <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span>
<a name="ln-4936"></a>    <span class="n">LoopSideNum</span>        <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span>
<a name="ln-4937"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-4938"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-4939"></a>      <span class="n">TempSetPoint</span>       <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpoint</span>
<a name="ln-4940"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-4941"></a>      <span class="n">TempSetPoint</span>       <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpointHi</span>
<a name="ln-4942"></a>    <span class="k">END SELECT</span>
<a name="ln-4943"></a>
<a name="ln-4944"></a><span class="k">    </span><span class="n">Tr</span>                 <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">TempSetPoint</span>
<a name="ln-4945"></a>    <span class="n">Ta</span>                 <span class="o">=</span> <span class="n">TempSetPoint</span> <span class="o">-</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span>
<a name="ln-4946"></a>
<a name="ln-4947"></a>  <span class="c">! Do not RETURN here if flow rate is less than MassFlowTolerance. Check basin heater and then RETURN.</span>
<a name="ln-4948"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">Loopside</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">FlowLock</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-4949"></a>  <span class="c">! MassFlowTolerance is a parameter to indicate a no flow condition</span>
<a name="ln-4950"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="n">MassFlowTolerance</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4951"></a><span class="k">      CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,&amp;</span>
<a name="ln-4952"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSchedulePtr</span><span class="p">,&amp;</span>
<a name="ln-4953"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterSetPointTemp</span><span class="p">,</span><span class="n">BasinHeaterPower</span><span class="p">)</span>
<a name="ln-4954"></a>      <span class="k">RETURN</span>
<a name="ln-4955"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-4956"></a>
<a name="ln-4957"></a>    <span class="c">!loop to increment NumCell if we cannot meet the setpoint with the actual number of cells calculated above</span>
<a name="ln-4958"></a>    <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4959"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">IncrNumCellFlag</span><span class="p">)</span>
<a name="ln-4960"></a>      <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4961"></a>    <span class="c">! Initialize inlet node water properties</span>
<a name="ln-4962"></a>      <span class="n">WaterDensity</span>  <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4963"></a>                                <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4964"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-4965"></a>                                <span class="s1">&#39;CalcVariableSpeedTower&#39;</span><span class="p">)</span>
<a name="ln-4966"></a>      <span class="n">WaterFlowRateRatio</span>       <span class="o">=</span> <span class="n">WaterMassFlowRatePerCell</span> <span class="o">/</span> <span class="p">(</span><span class="n">WaterDensity</span><span class="o">*</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CalibratedWaterFlowRate</span> <span class="p">&amp;</span>
<a name="ln-4967"></a>                                                                          <span class="o">/</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="p">)</span>
<a name="ln-4968"></a>
<a name="ln-4969"></a>    <span class="c">! check independent inputs with respect to model boundaries</span>
<a name="ln-4970"></a>      <span class="k">Call </span><span class="n">CheckModelBounds</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">Twb</span><span class="p">,</span> <span class="n">Tr</span><span class="p">,</span> <span class="n">Ta</span><span class="p">,</span> <span class="n">WaterFlowRateRatio</span><span class="p">,</span> <span class="n">TwbCapped</span><span class="p">,</span> <span class="n">TrCapped</span><span class="p">,</span> <span class="n">TaCapped</span><span class="p">,</span> <span class="n">WaterFlowRateRatioCapped</span><span class="p">)</span>
<a name="ln-4971"></a>
<a name="ln-4972"></a><span class="c">!   determine the free convection capacity by finding the outlet temperature at full air flow and multiplying</span>
<a name="ln-4973"></a><span class="c">!   the tower&#39;s full capacity temperature difference by the percentage of tower capacity in free convection</span>
<a name="ln-4974"></a><span class="c">!   regime specified by the user</span>
<a name="ln-4975"></a>
<a name="ln-4976"></a>      <span class="n">AirFlowRateRatio</span>         <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4977"></a>      <span class="n">OutletWaterTempOFF</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4978"></a>      <span class="n">OutletWaterTempON</span>        <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4979"></a>      <span class="n">OutletWaterTemp</span>          <span class="o">=</span> <span class="n">OutletWaterTempOFF</span>
<a name="ln-4980"></a>      <span class="n">FreeConvectionCapFrac</span>    <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FreeConvectionCapacityFraction</span>
<a name="ln-4981"></a>
<a name="ln-4982"></a>      <span class="k">Call </span><span class="n">SimVariableTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">WaterFlowRateRatioCapped</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="n">TwbCapped</span><span class="p">,</span> <span class="n">OutletWaterTempON</span><span class="p">)</span>
<a name="ln-4983"></a>
<a name="ln-4984"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OutletWaterTempON</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">TempSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4985"></a><span class="k">        </span><span class="n">FanCyclingRatio</span>    <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4986"></a>        <span class="n">AirFlowRateRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4987"></a>        <span class="n">CTFanPower</span>         <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-4988"></a>        <span class="n">OutletWaterTemp</span>    <span class="o">=</span> <span class="n">OutletWaterTempON</span>
<a name="ln-4989"></a>        <span class="c">! if possible increase the number of cells and do the calculations again with the new water mass flow rate per cell</span>
<a name="ln-4990"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NumCellON</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4991"></a>           <span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="o">/</span><span class="p">(</span><span class="n">NumCellON</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="n">WaterMassFlowRatePerCellMin</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4992"></a><span class="k">          </span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4993"></a>          <span class="n">WaterMassFlowRatePerCell</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">NumCellON</span>
<a name="ln-4994"></a>          <span class="n">IncrNumCellFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4995"></a>        <span class="k">END IF</span>
<a name="ln-4996"></a><span class="k">      END IF</span>
<a name="ln-4997"></a><span class="k">    END DO</span>
<a name="ln-4998"></a>
<a name="ln-4999"></a>    <span class="c">! find the correct air ratio only if full flow is  too much</span>
<a name="ln-5000"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OutletWaterTempON</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5001"></a>  <span class="c">!   outlet water temperature is calculated in the free convection regime</span>
<a name="ln-5002"></a>      <span class="n">OutletWaterTempOFF</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">FreeConvectionCapFrac</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTempON</span><span class="p">)</span>
<a name="ln-5003"></a>  <span class="c">!   fan is OFF</span>
<a name="ln-5004"></a>      <span class="n">FanCyclingRatio</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5005"></a>  <span class="c">!   air flow ratio is assumed to be the fraction of tower capacity in the free convection regime (fan is OFF but air is flowing)</span>
<a name="ln-5006"></a>      <span class="n">AirFlowRateRatio</span>   <span class="o">=</span> <span class="n">FreeConvectionCapFrac</span>
<a name="ln-5007"></a>
<a name="ln-5008"></a>      <span class="c">! Assume setpoint was met using free convection regime (pump ON and fan OFF)</span>
<a name="ln-5009"></a>      <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5010"></a>      <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">OutletWaterTempOFF</span>
<a name="ln-5011"></a>
<a name="ln-5012"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OutletWaterTempOFF</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5013"></a>      <span class="c">! Setpoint was not met, turn on cooling tower fan at minimum fan speed</span>
<a name="ln-5014"></a>
<a name="ln-5015"></a>        <span class="n">AirFlowRateRatio</span>  <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span>
<a name="ln-5016"></a>        <span class="k">Call </span><span class="n">SimVariableTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">WaterFlowRateRatioCapped</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="n">TwbCapped</span><span class="p">,</span> <span class="n">OutletWaterTempMIN</span><span class="p">)</span>
<a name="ln-5017"></a>
<a name="ln-5018"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">OutletWaterTempMIN</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5019"></a><span class="c">!         if setpoint was exceeded, cycle the fan at minimum air flow to meet the setpoint temperature</span>
<a name="ln-5020"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5021"></a><span class="k">            </span><span class="n">CTFanPower</span>      <span class="o">=</span> <span class="n">AirFlowRateRatio</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-5022"></a>               <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-5023"></a>          <span class="k">ELSE</span>
<a name="ln-5024"></a><span class="k">            </span><span class="n">FanCurveValue</span>   <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span><span class="p">,</span><span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-5025"></a>            <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">FanCurveValue</span><span class="p">))</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-5026"></a>               <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-5027"></a>          <span class="k">END IF</span>
<a name="ln-5028"></a>  <span class="c">!       fan is cycling ON and OFF at the minimum fan speed. Adjust fan power and air flow rate ratio according to cycling rate</span>
<a name="ln-5029"></a>          <span class="n">FanCyclingRatio</span>     <span class="o">=</span> <span class="p">((</span><span class="n">OutletWaterTempOFF</span> <span class="o">-</span> <span class="n">TempSetPoint</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">OutletWaterTempOFF</span> <span class="o">-</span> <span class="n">OutletWaterTempMIN</span><span class="p">))</span>
<a name="ln-5030"></a>          <span class="n">CTFanPower</span>          <span class="o">=</span> <span class="n">CTFanPower</span> <span class="o">*</span> <span class="n">FanCyclingRatio</span>
<a name="ln-5031"></a>          <span class="n">OutletWaterTemp</span>     <span class="o">=</span> <span class="n">TempSetPoint</span>
<a name="ln-5032"></a>          <span class="n">AirFlowRateRatio</span>    <span class="o">=</span> <span class="p">(</span><span class="n">FanCyclingRatio</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5033"></a>                                <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">FanCyclingRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FreeConvectionCapFrac</span><span class="p">)</span>
<a name="ln-5034"></a>        <span class="k">ELSE</span>
<a name="ln-5035"></a>  <span class="c">!       if setpoint was not met at minimum fan speed, set fan speed to maximum</span>
<a name="ln-5036"></a>          <span class="n">AirFlowRateRatio</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5037"></a><span class="c">!         fan will not cycle and runs the entire time step</span>
<a name="ln-5038"></a>          <span class="n">FanCyclingRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5039"></a>
<a name="ln-5040"></a>          <span class="k">Call </span><span class="n">SimVariableTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">WaterFlowRateRatioCapped</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="n">TwbCapped</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-5041"></a>
<a name="ln-5042"></a>          <span class="c">! Setpoint was met with pump ON and fan ON at full flow</span>
<a name="ln-5043"></a>          <span class="c">! Calculate the fraction of full air flow to exactly meet the setpoint temperature</span>
<a name="ln-5044"></a>
<a name="ln-5045"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TowerNum</span>                          <span class="c">! Index to cooling tower</span>
<a name="ln-5046"></a>  <span class="c">!         cap the water flow rate ratio and inlet air wet-bulb temperature to provide a stable output</span>
<a name="ln-5047"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterFlowRateRatioCapped</span>          <span class="c">! water flow rate ratio</span>
<a name="ln-5048"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">TwbCapped</span>                         <span class="c">! Inlet air wet-bulb temperature [C]</span>
<a name="ln-5049"></a>  <span class="c">!         do not cap desired range and approach temperature to provide a valid (balanced) output for this simulation time step</span>
<a name="ln-5050"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Tr</span>                                <span class="c">! Tower range temperature [C]</span>
<a name="ln-5051"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">Ta</span>                                <span class="c">! desired approach temperature [C]</span>
<a name="ln-5052"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>                               <span class="c">! calculate the air flow rate ratio required for a balance</span>
<a name="ln-5053"></a>
<a name="ln-5054"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="n">SimpleTowerApproachResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5055"></a>                                <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-5056"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5057"></a><span class="k">              IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span><span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Cooling tower iteration limit exceeded when calculating air flow &#39;</span> <span class="p">&amp;</span>
<a name="ln-5058"></a>                                  <span class="o">//</span><span class="s1">&#39;rate ratio for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5059"></a><span class="c">!           IF RegulaFalsi cannot find a solution then provide detailed output for debugging</span>
<a name="ln-5060"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5061"></a><span class="k">              IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5062"></a><span class="k">                WRITE</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">TwbCapped</span>
<a name="ln-5063"></a>                <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputChar2</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">Tr</span>
<a name="ln-5064"></a>                <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputChar3</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">Ta</span>
<a name="ln-5065"></a>                <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputChar4</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">WaterFlowRateRatioCapped</span>
<a name="ln-5066"></a>                <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputChar5</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span>
<a name="ln-5067"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CoolingTowerAFRRFailedCount</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5068"></a><span class="k">                  </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CoolingTowerAFRRFailedCount</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CoolingTowerAFRRFailedCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5069"></a>                  <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;CoolingTower:VariableSpeed &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - &#39;</span> <span class="p">&amp;</span>
<a name="ln-5070"></a>                                      <span class="o">//</span><span class="s1">&#39;Cooling tower air flow rate ratio calculation failed &#39;</span><span class="p">)</span>
<a name="ln-5071"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...with conditions as Twb = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Trange = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5072"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, Tapproach = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar3</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, and water flow rate ratio = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5073"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar4</span><span class="p">))</span>
<a name="ln-5074"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...a solution could not be found within the valid range &#39;</span> <span class="p">&amp;</span>
<a name="ln-5075"></a>                                  <span class="o">//</span><span class="s1">&#39;of air flow rate ratios&#39;</span><span class="p">)</span>
<a name="ln-5076"></a>                  <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Valid air flow rate ratio range = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar5</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to 1.0.&#39;</span><span class="p">)</span>
<a name="ln-5077"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Consider modifying the design approach or design range temperature for this tower.&#39;</span><span class="p">)</span>
<a name="ln-5078"></a>                <span class="k">ELSE</span>
<a name="ln-5079"></a><span class="k">                  CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CoolingTower:VariableSpeed &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5080"></a>                                                   <span class="s1">&#39;&quot; - Cooling tower air flow rate ratio calculation failed &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5081"></a>                                                   <span class="s1">&#39;error continues.&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5082"></a>                                                   <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CoolingTowerAFRRFailedIndex</span><span class="p">)</span>
<a name="ln-5083"></a>                <span class="k">END IF</span>
<a name="ln-5084"></a><span class="k">              END IF</span>
<a name="ln-5085"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-5086"></a>
<a name="ln-5087"></a>  <span class="c">!         Use theoretical cubic for deterination of fan power if user has not specified a fan power ratio curve</span>
<a name="ln-5088"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5089"></a><span class="k">              </span><span class="n">CTFanPower</span>      <span class="o">=</span> <span class="n">AirFlowRateRatio</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-5090"></a>                 <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-5091"></a>            <span class="k">ELSE</span>
<a name="ln-5092"></a><span class="k">              </span><span class="n">FanCurveValue</span>   <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPowerfAirFlowCurve</span><span class="p">,</span><span class="n">AirFlowRateRatio</span><span class="p">)</span>
<a name="ln-5093"></a>              <span class="n">CTFanPower</span>      <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedFanPower</span> <span class="o">*</span> <span class="n">FanCurveValue</span><span class="p">))</span> <span class="o">*</span> <span class="n">NumCellON</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-5094"></a>                 <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-5095"></a>            <span class="k">END IF</span>
<a name="ln-5096"></a><span class="c">!           outlet water temperature is calculated as the inlet air wet-bulb temperature plus tower approach temperature</span>
<a name="ln-5097"></a>            <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">Twb</span> <span class="o">+</span> <span class="n">Ta</span>
<a name="ln-5098"></a>        <span class="k">END IF</span>   <span class="c">! IF(OutletWaterTempMIN .LT. TempSetPoint)THEN</span>
<a name="ln-5099"></a>
<a name="ln-5100"></a>      <span class="k">END IF</span>   <span class="c">! IF(OutletWaterTempOFF .GT. TempSetPoint)THEN</span>
<a name="ln-5101"></a>    <span class="k">END IF</span>   <span class="c">! IF(OutletWaterTempON .LT. TempSetpoint) ie if tower should not run at full capacity</span>
<a name="ln-5102"></a>
<a name="ln-5103"></a>    <span class="n">CpWater</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5104"></a>                               <span class="n">Node</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-5105"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-5106"></a>                               <span class="s1">&#39;CalcVariableSpeedTower&#39;</span><span class="p">)</span>
<a name="ln-5107"></a>    <span class="n">Qactual</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-5108"></a>    <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">=</span> <span class="n">NumCellON</span>
<a name="ln-5109"></a>  <span class="c">! Set water and air properties</span>
<a name="ln-5110"></a>    <span class="n">AirDensity</span>          <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5111"></a>                            <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span><span class="p">)</span>
<a name="ln-5112"></a>    <span class="n">AirMassFlowRate</span>     <span class="o">=</span> <span class="n">AirFlowRateRatio</span><span class="o">*</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span><span class="o">*</span><span class="n">AirDensity</span><span class="p">&amp;</span>
<a name="ln-5113"></a>                          <span class="o">*</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span><span class="o">/</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-5114"></a>    <span class="n">InletAirEnthalpy</span>    <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5115"></a>       <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5116"></a>                     <span class="mf">1.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5117"></a>                     <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-5118"></a>
<a name="ln-5119"></a><span class="c">!   calculate end time of current time step</span>
<a name="ln-5120"></a>    <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-5121"></a>
<a name="ln-5122"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-5123"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-5124"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-5125"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-5126"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5127"></a><span class="k">      IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintLGMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5128"></a><span class="k">          </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountFlowFrac</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5129"></a>                           <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountFlowFrac</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5130"></a><span class="c">!       Show single warning and pass additional info to ShowRecurringWarningErrorAtEnd</span>
<a name="ln-5131"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountFlowFrac</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5132"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">LGBuffer1</span><span class="p">))</span>
<a name="ln-5133"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">LGBuffer2</span><span class="p">))</span>
<a name="ln-5134"></a>        <span class="k">ELSE</span>
<a name="ln-5135"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-5136"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Liquid to gas ratio is out of range error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-5137"></a>              <span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">ErrIndexLG</span><span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">LGLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5138"></a>                                                                 <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">LGLast</span><span class="p">)</span>
<a name="ln-5139"></a>        <span class="k">END IF</span>
<a name="ln-5140"></a><span class="k">      END IF</span>
<a name="ln-5141"></a><span class="k">    END IF</span>
<a name="ln-5142"></a>
<a name="ln-5143"></a><span class="c">!   save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-5144"></a>    <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-5145"></a>    <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-5146"></a>
<a name="ln-5147"></a><span class="c">!   warn user on first occurrence if flow fraction is greater than maximum for the YorkCalc model, use recurring warning stats</span>
<a name="ln-5148"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">YorkCalcModel</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5149"></a>       <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">YorkCalcUserDefined</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5150"></a><span class="k">       </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintLGMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5151"></a><span class="c">!      Do not report error message in free convection regime</span>
<a name="ln-5152"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">AirFlowRateRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MinimumVSAirFlowFrac</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5153"></a><span class="k">         </span><span class="n">FlowFraction</span> <span class="o">=</span> <span class="n">WaterFlowRateRatioCapped</span><span class="o">/</span><span class="n">AirFlowRateRatio</span>
<a name="ln-5154"></a><span class="c">!        Flow fractions greater than a MaxLiquidToGasRatio of 8 are not reliable using the YorkCalc model</span>
<a name="ln-5155"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">FlowFraction</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxLiquidToGasRatio</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5156"></a><span class="c">!          Report warnings only during actual simulation</span>
<a name="ln-5157"></a>           <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5158"></a><span class="k">             </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintLGMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5159"></a>             <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">FlowFraction</span>
<a name="ln-5160"></a>             <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputChar2</span><span class="p">,</span><span class="n">OutputFormat</span><span class="p">)</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxLiquidToGasRatio</span>
<a name="ln-5161"></a>             <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">LGBuffer1</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-5162"></a>                                                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5163"></a>                <span class="s1">&#39;&quot; - Liquid to gas ratio (L/G) is out of range at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5164"></a>             <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">LGBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Valid maximum ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar2</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5165"></a>                            <span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-5166"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-5167"></a>             <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">LGLast</span>       <span class="o">=</span> <span class="n">FlowFraction</span>
<a name="ln-5168"></a>           <span class="k">END IF</span>
<a name="ln-5169"></a><span class="k">         END IF</span>
<a name="ln-5170"></a><span class="k">       END IF</span>
<a name="ln-5171"></a><span class="k">    END IF</span>
<a name="ln-5172"></a>
<a name="ln-5173"></a>
<a name="ln-5174"></a><span class="k">RETURN</span>
<a name="ln-5175"></a><span class="k">END SUBROUTINE </span><span class="n">CalcVariableSpeedTower</span>
<a name="ln-5176"></a>
<a name="ln-5177"></a><span class="k">SUBROUTINE </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="n">AirFlowRate</span><span class="p">,</span><span class="n">UAdesign</span><span class="p">,</span><span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-5178"></a>
<a name="ln-5179"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5180"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-5181"></a>          <span class="c">!       DATE WRITTEN   Sept. 1998</span>
<a name="ln-5182"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5183"></a>          <span class="c">!       RE-ENGINEERED  Shirey, Raustad, Jan 2001</span>
<a name="ln-5184"></a>
<a name="ln-5185"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5186"></a>          <span class="c">!</span>
<a name="ln-5187"></a>          <span class="c">! See purpose for Single Speed or Two Speed tower model</span>
<a name="ln-5188"></a>
<a name="ln-5189"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5190"></a>          <span class="c">!</span>
<a name="ln-5191"></a>          <span class="c">! See methodology for Single Speed or Two Speed tower model</span>
<a name="ln-5192"></a>
<a name="ln-5193"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5194"></a>          <span class="c">!</span>
<a name="ln-5195"></a>          <span class="c">! Merkel, F. 1925.  Verduftungskuhlung. VDI Forschungsarbeiten, Nr 275, Berlin.</span>
<a name="ln-5196"></a>          <span class="c">! ASHRAE     1999.  HVAC1KIT: A Toolkit for Primary HVAC System Energy Calculations.</span>
<a name="ln-5197"></a>
<a name="ln-5198"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5199"></a>          <span class="c">! na</span>
<a name="ln-5200"></a>
<a name="ln-5201"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5202"></a>
<a name="ln-5203"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5204"></a>  <span class="kt">INTEGER</span>  <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-5205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">WaterMassFlowRate</span>
<a name="ln-5206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AirFlowRate</span>
<a name="ln-5207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">UAdesign</span>
<a name="ln-5208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OutletWaterTemp</span>
<a name="ln-5209"></a>
<a name="ln-5210"></a>
<a name="ln-5211"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5212"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">IterMax</span>           <span class="o">=</span> <span class="mi">50</span>      <span class="c">! Maximum number of iterations allowed</span>
<a name="ln-5213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WetBulbTolerance</span>  <span class="o">=</span> <span class="mf">0.00001d0</span> <span class="c">! Maximum error for exiting wet-bulb temperature between iterations</span>
<a name="ln-5214"></a>                                                        <span class="c">! [delta K/K]</span>
<a name="ln-5215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DeltaTwbTolerance</span> <span class="o">=</span> <span class="mf">0.001d0</span>   <span class="c">! Maximum error (tolerance) in DeltaTwb for iteration convergence [C]</span>
<a name="ln-5216"></a>
<a name="ln-5217"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5218"></a>          <span class="c">! na</span>
<a name="ln-5219"></a>
<a name="ln-5220"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5221"></a>          <span class="c">! na</span>
<a name="ln-5222"></a>
<a name="ln-5223"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5224"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">Iter</span>                 <span class="c">! Number of iterations completed</span>
<a name="ln-5225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">MdotCpWater</span>          <span class="c">! Water mass flow rate times the heat capacity [W/K]</span>
<a name="ln-5226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">InletAirTemp</span>         <span class="c">! Dry-bulb temperature of air entering the tower [C]</span>
<a name="ln-5227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CpWater</span>              <span class="c">! Heat capacity of water [J/kg/K]</span>
<a name="ln-5228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CpAir</span>                <span class="c">! Heat capacity of air [J/kg/K]</span>
<a name="ln-5229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AirDensity</span>           <span class="c">! Density of air [kg/m3]</span>
<a name="ln-5230"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AirMassFlowRate</span>      <span class="c">! Mass flow rate of air [kg/s]</span>
<a name="ln-5231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">effectiveness</span>        <span class="c">! Effectiveness of the heat exchanger [-]</span>
<a name="ln-5232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">UAactual</span>             <span class="c">! UA value at actual conditions [W/C]</span>
<a name="ln-5233"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>     <span class="c">! Enthalpy of entering moist air [J/kg]</span>
<a name="ln-5234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">InletAirWetBulb</span>      <span class="c">! Wetbulb temp of entering moist air [C]</span>
<a name="ln-5235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>    <span class="c">! Enthalpy of exiting moist air [J/kg]</span>
<a name="ln-5236"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletAirWetBulb</span>     <span class="c">! Wetbulb temp of exiting moist air [C]</span>
<a name="ln-5237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">OutletAirWetBulbLast</span> <span class="c">! temporary Wetbulb temp of exiting moist air [C]</span>
<a name="ln-5238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">AirCapacity</span>          <span class="c">! MdotCp of air through the tower</span>
<a name="ln-5239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CapacityRatioMin</span>     <span class="c">! Minimum capacity of airside and waterside</span>
<a name="ln-5240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CapacityRatioMax</span>     <span class="c">! Maximum capacity of airside and waterside</span>
<a name="ln-5241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CapacityRatio</span>        <span class="c">! Ratio of minimum to maximum capacity</span>
<a name="ln-5242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">NumTransferUnits</span>     <span class="c">! Number of transfer Units [NTU]</span>
<a name="ln-5243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">WetBulbError</span>      <span class="c">! Calculated error for exiting wet-bulb temperature between iterations [delta K/K]</span>
<a name="ln-5244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">CpAirside</span>            <span class="c">! Delta enthalpy of the tower air divides by delta air wet-bulb temp [J/kg/K]</span>
<a name="ln-5245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Qactual</span>              <span class="c">! Actual heat transfer rate between tower water and air [W]</span>
<a name="ln-5246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">DeltaTwb</span>             <span class="c">! Absolute value of difference between inlet and outlet air wet-bulb temp [C]</span>
<a name="ln-5247"></a>
<a name="ln-5248"></a>     <span class="c">! set inlet and outlet node numbers, and initialize some local variables</span>
<a name="ln-5249"></a>
<a name="ln-5250"></a>    <span class="n">WaterInletNode</span>    <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-5251"></a>    <span class="n">WaterOutletNode</span>   <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-5252"></a>    <span class="n">Qactual</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5253"></a><span class="c">!    WetBulbTolerance  = 0.00001</span>
<a name="ln-5254"></a>    <span class="n">WetBulbError</span>      <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5255"></a><span class="c">!    IterMax           = 50</span>
<a name="ln-5256"></a>    <span class="n">DeltaTwb</span>          <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5257"></a><span class="c">!    DeltaTwbTolerance = 0.001</span>
<a name="ln-5258"></a>
<a name="ln-5259"></a>    <span class="c">! set local tower inlet and outlet temperature variables</span>
<a name="ln-5260"></a>    <span class="n">InletWaterTemp</span>    <span class="o">=</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span>
<a name="ln-5261"></a>    <span class="n">OutletWaterTemp</span>   <span class="o">=</span> <span class="n">InletWaterTemp</span>
<a name="ln-5262"></a>    <span class="n">InletAirTemp</span>      <span class="o">=</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span>
<a name="ln-5263"></a>    <span class="n">InletAirWetBulb</span>   <span class="o">=</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span>
<a name="ln-5264"></a>
<a name="ln-5265"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">UAdesign</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-5266"></a>
<a name="ln-5267"></a>    <span class="c">! set water and air properties</span>
<a name="ln-5268"></a>    <span class="n">AirDensity</span>        <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span><span class="p">)</span>
<a name="ln-5269"></a>    <span class="n">AirMassFlowRate</span>   <span class="o">=</span> <span class="n">AirFlowRate</span><span class="o">*</span><span class="n">AirDensity</span>
<a name="ln-5270"></a>    <span class="n">CpAir</span>             <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span><span class="p">,</span><span class="n">InletAirTemp</span><span class="p">)</span>
<a name="ln-5271"></a>    <span class="n">CpWater</span>           <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5272"></a>                               <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-5273"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5274"></a>                               <span class="s1">&#39;SimSimpleTower&#39;</span><span class="p">)</span>
<a name="ln-5275"></a>     <span class="n">InletAirEnthalpy</span>  <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-5276"></a>       <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5277"></a>                     <span class="mf">1.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5278"></a>                     <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-5279"></a>
<a name="ln-5280"></a>    <span class="c">! initialize exiting wet bulb temperature before iterating on final solution</span>
<a name="ln-5281"></a>    <span class="n">OutletAirWetBulb</span> <span class="o">=</span> <span class="n">InletAirWetBulb</span> <span class="o">+</span> <span class="mf">6.0d0</span>
<a name="ln-5282"></a>
<a name="ln-5283"></a>    <span class="c">! Calcluate mass flow rates</span>
<a name="ln-5284"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5285"></a><span class="k">      </span><span class="n">MdotCpWater</span> <span class="o">=</span>   <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">CpWater</span>
<a name="ln-5286"></a>    <span class="k">ELSE</span>
<a name="ln-5287"></a><span class="k">      </span><span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">InletWaterTemp</span>
<a name="ln-5288"></a>      <span class="k">RETURN</span>
<a name="ln-5289"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-5290"></a>    <span class="n">Iter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5291"></a>    <span class="k">DO WHILE</span> <span class="p">((</span><span class="n">WetBulbError</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">WetBulbTolerance</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Iter</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="n">IterMax</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">DeltaTwb</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">DeltaTwbTolerance</span><span class="p">))</span>
<a name="ln-5292"></a>        <span class="n">Iter</span> <span class="o">=</span> <span class="n">Iter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5293"></a><span class="c">!        OutletAirEnthalpy = PsyHFnTdbRhPb(OutletAirWetBulb,1.0,OutBaroPress)</span>
<a name="ln-5294"></a>        <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">OutletAirWetBulb</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-5295"></a>        <span class="c">! calculate the airside specific heat and capacity</span>
<a name="ln-5296"></a>        <span class="n">CpAirside</span>   <span class="o">=</span>   <span class="p">(</span><span class="n">OutletAirEnthalpy</span> <span class="o">-</span> <span class="n">InletAirEnthalpy</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">OutletAirWetBulb</span><span class="o">-</span><span class="n">InletAirWetBulb</span><span class="p">)</span>
<a name="ln-5297"></a>        <span class="n">AirCapacity</span> <span class="o">=</span> <span class="n">AirMassFlowRate</span> <span class="o">*</span> <span class="n">CpAirside</span>
<a name="ln-5298"></a>        <span class="c">! calculate the minimum to maximum capacity ratios of airside and waterside</span>
<a name="ln-5299"></a>        <span class="n">CapacityRatioMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">AirCapacity</span><span class="p">,</span><span class="n">MdotCpWater</span><span class="p">)</span>
<a name="ln-5300"></a>        <span class="n">CapacityRatioMax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">AirCapacity</span><span class="p">,</span><span class="n">MdotCpWater</span><span class="p">)</span>
<a name="ln-5301"></a>        <span class="n">CapacityRatio</span>    <span class="o">=</span> <span class="n">CapacityRatioMin</span><span class="o">/</span><span class="n">CapacityRatioMax</span>
<a name="ln-5302"></a>        <span class="c">! Calculate heat transfer coefficient and number of transfer units (NTU)</span>
<a name="ln-5303"></a>        <span class="n">UAactual</span> <span class="o">=</span> <span class="n">UAdesign</span><span class="o">*</span><span class="n">CpAirside</span><span class="o">/</span><span class="n">CpAir</span>
<a name="ln-5304"></a>        <span class="n">NumTransferUnits</span> <span class="o">=</span> <span class="n">UAactual</span><span class="o">/</span><span class="n">CapacityRatioMin</span>
<a name="ln-5305"></a>        <span class="c">! calculate heat exchanger effectiveness</span>
<a name="ln-5306"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CapacityRatio</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.995d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5307"></a><span class="k">          </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">*</span><span class="n">NumTransferUnits</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">CapacityRatio</span><span class="p">)))</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5308"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">CapacityRatio</span><span class="o">*</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">*</span><span class="n">NumTransferUnits</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">CapacityRatio</span><span class="p">)))</span>
<a name="ln-5309"></a>        <span class="k">ELSE</span>
<a name="ln-5310"></a><span class="k">          </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="n">NumTransferUnits</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">NumTransferUnits</span><span class="p">)</span>
<a name="ln-5311"></a>        <span class="n">ENDIF</span>
<a name="ln-5312"></a>        <span class="c">! calculate water to air heat transfer and store last exiting WB temp of air</span>
<a name="ln-5313"></a>        <span class="n">Qactual</span> <span class="o">=</span> <span class="n">effectiveness</span> <span class="o">*</span> <span class="n">CapacityRatioMin</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletWaterTemp</span><span class="o">-</span><span class="n">InletAirWetBulb</span><span class="p">)</span>
<a name="ln-5314"></a>        <span class="n">OutletAirWetBulbLast</span> <span class="o">=</span> <span class="n">OutletAirWetBulb</span>
<a name="ln-5315"></a>        <span class="c">! calculate new exiting wet bulb temperature of airstream</span>
<a name="ln-5316"></a>        <span class="n">OutletAirWetBulb</span> <span class="o">=</span> <span class="n">InletAirWetBulb</span> <span class="o">+</span> <span class="n">Qactual</span><span class="o">/</span><span class="n">AirCapacity</span>
<a name="ln-5317"></a>        <span class="c">! Check error tolerance and exit if satisfied</span>
<a name="ln-5318"></a>        <span class="n">DeltaTwb</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">OutletAirWetBulb</span> <span class="o">-</span> <span class="n">InletAirWetBulb</span><span class="p">)</span>
<a name="ln-5319"></a>        <span class="c">! Add KelvinConv to denominator below convert OutletAirWetBulbLast to Kelvin to avoid divide by zero.</span>
<a name="ln-5320"></a>        <span class="c">! Wet bulb error units are delta K/K</span>
<a name="ln-5321"></a>        <span class="n">WetBulbError</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">((</span><span class="n">OutletAirWetBulb</span> <span class="o">-</span> <span class="n">OutletAirWetBulbLast</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">OutletAirWetBulbLast</span><span class="o">+</span><span class="n">KelvinConv</span><span class="p">))</span>
<a name="ln-5322"></a>    <span class="k">END DO</span>
<a name="ln-5323"></a>
<a name="ln-5324"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Qactual</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5325"></a><span class="k">        </span><span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">InletWaterTemp</span> <span class="o">-</span> <span class="n">Qactual</span><span class="o">/</span> <span class="n">MdotCpWater</span>
<a name="ln-5326"></a>    <span class="k">ELSE</span>
<a name="ln-5327"></a><span class="k">        </span><span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">InletWaterTemp</span>
<a name="ln-5328"></a>    <span class="k">END IF</span>
<a name="ln-5329"></a>
<a name="ln-5330"></a><span class="k">RETURN</span>
<a name="ln-5331"></a><span class="k">END SUBROUTINE </span><span class="n">SimSimpleTower</span>
<a name="ln-5332"></a>
<a name="ln-5333"></a><span class="k">SUBROUTINE </span><span class="n">SimVariableTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">WaterFlowRateRatio</span><span class="p">,</span> <span class="n">AirFlowRateRatio</span><span class="p">,</span> <span class="n">Twb</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-5334"></a>
<a name="ln-5335"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5336"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-5337"></a>          <span class="c">!       DATE WRITTEN   Feb. 2005</span>
<a name="ln-5338"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5339"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5340"></a>
<a name="ln-5341"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5342"></a>          <span class="c">!</span>
<a name="ln-5343"></a>          <span class="c">! To calculate the leaving water temperature of the variable speed cooling tower.</span>
<a name="ln-5344"></a>
<a name="ln-5345"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5346"></a>          <span class="c">!</span>
<a name="ln-5347"></a>          <span class="c">! The range temperature is varied to determine balance point where model output (Tapproach),</span>
<a name="ln-5348"></a>          <span class="c">! range temperature and inlet air wet-bulb temperature show a balance as:</span>
<a name="ln-5349"></a>          <span class="c">! Twb + Tapproach + Trange = Node(WaterInletNode)%Temp</span>
<a name="ln-5350"></a>
<a name="ln-5351"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5352"></a>          <span class="c">!</span>
<a name="ln-5353"></a>          <span class="c">! Benton, D.J., Bowmand, C.F., Hydeman, M., Miller, P.,</span>
<a name="ln-5354"></a>          <span class="c">! &quot;An Improved Cooling Tower Algorithm for the CoolToolsTM Simulation Model&quot;.</span>
<a name="ln-5355"></a>          <span class="c">! ASHRAE Transactions 2002, V. 108, Pt. 1.</span>
<a name="ln-5356"></a>          <span class="c">!</span>
<a name="ln-5357"></a>          <span class="c">! York International Corporation, &quot;YORKcalcTM Software, Chiller-Plant Energy-Estimating Program&quot;,</span>
<a name="ln-5358"></a>          <span class="c">! Form 160.00-SG2 (0502). © 2002.</span>
<a name="ln-5359"></a>
<a name="ln-5360"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5361"></a>          <span class="c">!</span>
<a name="ln-5362"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span>
<a name="ln-5363"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SingleSetPoint</span><span class="p">,</span> <span class="n">DualSetpointDeadband</span>
<a name="ln-5364"></a>
<a name="ln-5365"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5366"></a>
<a name="ln-5367"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5368"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TowerNum</span>              <span class="c">! variable speed tower index</span>
<a name="ln-5369"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WaterFlowRateRatio</span>    <span class="c">! current water flow rate ratio (capped if applicable)</span>
<a name="ln-5370"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirFlowRateRatio</span>      <span class="c">! current air flow rate ratio</span>
<a name="ln-5371"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Twb</span>                   <span class="c">! current inlet air wet-bulb temperature (C, capped if applicable)</span>
<a name="ln-5372"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">OutletWaterTemp</span>       <span class="c">! calculated tower outlet water temperature (C)</span>
<a name="ln-5373"></a>
<a name="ln-5374"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5375"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>          <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>         <span class="c">! Maximum number of iterations</span>
<a name="ln-5376"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">0.0001d0</span>        <span class="c">! Accuracy of result</span>
<a name="ln-5377"></a>
<a name="ln-5378"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5379"></a>          <span class="c">! na</span>
<a name="ln-5380"></a>
<a name="ln-5381"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5382"></a>          <span class="c">! na</span>
<a name="ln-5383"></a>
<a name="ln-5384"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5385"></a>  <span class="kt">INTEGER</span>                <span class="kd">::</span> <span class="n">SolFla</span>               <span class="c">! Flag of solver</span>
<a name="ln-5386"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">Par</span>                  <span class="c">! Parameter array for regula falsi solver</span>
<a name="ln-5387"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">Tr</span>                   <span class="c">! range temperature which results in an energy balance</span>
<a name="ln-5388"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TempSetPoint</span> <span class="c">! local temporary for loop setpoint</span>
<a name="ln-5389"></a>
<a name="ln-5390"></a><span class="c">!   determine tower outlet water temperature</span>
<a name="ln-5391"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TowerNum</span>                  <span class="c">! Index to cooling tower</span>
<a name="ln-5392"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterFlowRateRatio</span>        <span class="c">! water flow rate ratio</span>
<a name="ln-5393"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">AirFlowRateRatio</span>          <span class="c">! air flow rate ratio</span>
<a name="ln-5394"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">Twb</span>                       <span class="c">! inlet air wet-bulb temperature [C]</span>
<a name="ln-5395"></a>    <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">Tr</span><span class="p">,</span> <span class="n">SimpleTowerTrResidual</span><span class="p">,</span> <span class="mf">0.001d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5396"></a>                          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-5397"></a>
<a name="ln-5398"></a>    <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">-</span> <span class="n">Tr</span>
<a name="ln-5399"></a>
<a name="ln-5400"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5401"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded in calculating tower nominal capacity at minimum air flow ratio&#39;</span><span class="p">)</span>
<a name="ln-5402"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Design inlet air wet-bulb or approach temperature must be modified to achieve an acceptable&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5403"></a>                           <span class="s1">&#39; range at the minimum air flow rate&#39;</span><span class="p">)</span>
<a name="ln-5404"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cooling tower simulation failed to converge for tower &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5405"></a><span class="c">!    if SolFla = -2, Tr is returned as minimum value (0.001) and outlet temp = inlet temp - 0.001</span>
<a name="ln-5406"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! decide if should run at max flow</span>
<a name="ln-5407"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopDemandCalcScheme</span><span class="p">)</span>
<a name="ln-5408"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">SingleSetPoint</span><span class="p">)</span>
<a name="ln-5409"></a>        <span class="n">TempSetPoint</span>       <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpoint</span>
<a name="ln-5410"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">DualSetPointDeadBand</span><span class="p">)</span>
<a name="ln-5411"></a>        <span class="n">TempSetPoint</span>       <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">TempSetpointHi</span>
<a name="ln-5412"></a>      <span class="k">END SELECT</span>
<a name="ln-5413"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">&gt;</span>   <span class="p">&amp;</span>
<a name="ln-5414"></a>           <span class="p">(</span><span class="n">TempSetPoint</span>   <span class="o">+</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! run flat out</span>
<a name="ln-5415"></a>        <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">-</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span>
<a name="ln-5416"></a>      <span class="n">ENDIF</span>
<a name="ln-5417"></a>    <span class="k">END IF</span>
<a name="ln-5418"></a>
<a name="ln-5419"></a><span class="k">RETURN</span>
<a name="ln-5420"></a><span class="k">END SUBROUTINE </span><span class="n">SimVariableTower</span>
<a name="ln-5421"></a>
<a name="ln-5422"></a><span class="k">SUBROUTINE </span><span class="n">CalcVSTowerApproach</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">PctWaterFlow</span><span class="p">,</span> <span class="n">AirFlowRatio</span><span class="p">,</span> <span class="n">Twb</span><span class="p">,</span> <span class="n">Tr</span><span class="p">,</span> <span class="n">Approach</span><span class="p">)</span>
<a name="ln-5423"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5424"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-5425"></a>          <span class="c">!       DATE WRITTEN   Feb. 2005</span>
<a name="ln-5426"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5427"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5428"></a>
<a name="ln-5429"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5430"></a>          <span class="c">! Calculate tower approach temperature (e.g. outlet water temp minus inlet air wet-bulb temp)</span>
<a name="ln-5431"></a>          <span class="c">! given air flow ratio, water flow ratio, inlet air wet-bulb temp, and tower range.</span>
<a name="ln-5432"></a>
<a name="ln-5433"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5434"></a>          <span class="c">! Calculation method used empirical models from CoolTools or York to determine performance</span>
<a name="ln-5435"></a>          <span class="c">! of variable speed (variable air flow rate) cooling towers.</span>
<a name="ln-5436"></a>
<a name="ln-5437"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5438"></a>          <span class="c">!</span>
<a name="ln-5439"></a>          <span class="c">! Benton, D.J., Bowmand, C.F., Hydeman, M., Miller, P.,</span>
<a name="ln-5440"></a>          <span class="c">! &quot;An Improved Cooling Tower Algorithm for the CoolToolsTM Simulation Model&quot;.</span>
<a name="ln-5441"></a>          <span class="c">! ASHRAE Transactions 2002, V. 108, Pt. 1.</span>
<a name="ln-5442"></a>          <span class="c">!</span>
<a name="ln-5443"></a>          <span class="c">! York International Corporation, &quot;YORKcalcTM Software, Chiller-Plant Energy-Estimating Program&quot;,</span>
<a name="ln-5444"></a>          <span class="c">! Form 160.00-SG2 (0502). © 2002.</span>
<a name="ln-5445"></a>
<a name="ln-5446"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5447"></a>          <span class="c">! na</span>
<a name="ln-5448"></a>
<a name="ln-5449"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5450"></a>
<a name="ln-5451"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5452"></a>    <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerNum</span>     <span class="c">! Index to cooling tower</span>
<a name="ln-5453"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">AirFlowRatio</span> <span class="c">! Air flow ratio of cooling tower</span>
<a name="ln-5454"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PctWaterFlow</span> <span class="c">! Water flow ratio of cooling tower</span>
<a name="ln-5455"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Twb</span>          <span class="c">! Inlet air wet-bulb temperature [C]</span>
<a name="ln-5456"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tr</span>           <span class="c">! Cooling tower range (outlet water temp minus inlet air wet-bulb temp) [C]</span>
<a name="ln-5457"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Approach</span>     <span class="c">! Calculated approach temperature [C]</span>
<a name="ln-5458"></a>
<a name="ln-5459"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5460"></a><span class="c">!    REAL(r64)        :: Twb                       ! Inlet air wet-bulb temperature [C] (or [F] for CoolTools Model)</span>
<a name="ln-5461"></a><span class="c">!    REAL(r64)        :: Tr                        ! Cooling tower range (outlet water temp minus inlet air wet-bulb temp) [C]</span>
<a name="ln-5462"></a>                                                  <span class="c">!   (or [F] for CoolTools Model)</span>
<a name="ln-5463"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">PctAirFlow</span>   <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! air flow rate ratio (fan power ratio in the case of CoolTools model)</span>
<a name="ln-5464"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">FlowFactor</span>   <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! water flow rate to air flow rate ratio (L/G) for YorkCalc model</span>
<a name="ln-5465"></a>
<a name="ln-5466"></a><span class="c">!    IF(SimpleTower(TowerNum)%TowerModelType .EQ. CoolToolsXFModel .OR. &amp;</span>
<a name="ln-5467"></a><span class="c">!        SimpleTower(TowerNum)%TowerModelType .EQ. CoolToolsCFModel .OR. &amp;</span>
<a name="ln-5468"></a><span class="c">!        SimpleTower(TowerNum)%TowerModelType .EQ. YorkCalcModel)THEN</span>
<a name="ln-5469"></a><span class="c">!      Twb        = (TwbIN * 1.8) + 32.0 ! Convert Celsius to Fahrenheit for CoolTools Model</span>
<a name="ln-5470"></a><span class="c">!      Tr         = (TrIN * 1.8)</span>
<a name="ln-5471"></a>      <span class="c">! Convert air flow rate ratio to fan power ratio for CoolTools Model</span>
<a name="ln-5472"></a><span class="c">!      IF(SimpleTower(TowerNum)%TowerModelType .NE. YorkCalcModel)PctAirFlow = (AirFlowRatio)**3.0</span>
<a name="ln-5473"></a><span class="c">!    ELSE</span>
<a name="ln-5474"></a><span class="c">!      Twb        = TwbIN</span>
<a name="ln-5475"></a><span class="c">!      Tr         = TrIN</span>
<a name="ln-5476"></a><span class="c">!      IF(SimpleTower(TowerNum)%TowerModelType .NE. YorkCalcUserDefined)PctAirFlow = (AirFlowRatio)**3.0</span>
<a name="ln-5477"></a><span class="c">!    END IF</span>
<a name="ln-5478"></a>
<a name="ln-5479"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">YorkCalcModel</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5480"></a>       <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">YorkCalcUserDefined</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5481"></a><span class="k">      </span><span class="n">PctAirFlow</span> <span class="o">=</span> <span class="n">AirFlowRatio</span>
<a name="ln-5482"></a>      <span class="n">FlowFactor</span> <span class="o">=</span> <span class="n">PctWaterFlow</span> <span class="o">/</span> <span class="n">PctAirFlow</span>
<a name="ln-5483"></a>      <span class="n">Approach</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5484"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5485"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5486"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5487"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5488"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5489"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5490"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5491"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5492"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5493"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5494"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5495"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5496"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5497"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5498"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5499"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5500"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5501"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5502"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5503"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5504"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5505"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5506"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5507"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5508"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5509"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">FlowFactor</span> <span class="o">*</span> <span class="n">FlowFactor</span>
<a name="ln-5510"></a>
<a name="ln-5511"></a>    <span class="k">ELSE</span> <span class="c">! empirical model is CoolTools format</span>
<a name="ln-5512"></a>
<a name="ln-5513"></a><span class="c">!     the CoolTools model actually uses PctFanPower = AirFlowRatio^3 as an input to the model</span>
<a name="ln-5514"></a>      <span class="n">PctAirFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">AirFlowRatio</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<a name="ln-5515"></a>      <span class="n">Approach</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5516"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5517"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5518"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5519"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5520"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5521"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5522"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5523"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5524"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5525"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5526"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5527"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5528"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5529"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5530"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5531"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5532"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5533"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5534"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5535"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5536"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5537"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5538"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5539"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5540"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5541"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5542"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5543"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5544"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5545"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5546"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctAirFlow</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5547"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span> <span class="o">*</span> <span class="n">PctWaterFlow</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5548"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span> <span class="o">*</span> <span class="n">Twb</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5549"></a>               <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">Coeff</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span> <span class="o">*</span> <span class="n">Tr</span>
<a name="ln-5550"></a>    <span class="k">END IF</span>
<a name="ln-5551"></a><span class="c">!    capping approach to 0 results in failure of RegulaFalsi routine</span>
<a name="ln-5552"></a><span class="c">!    Approach = MAX(0.0, Approach)</span>
<a name="ln-5553"></a>
<a name="ln-5554"></a><span class="c">!    IF(SimpleTower(TowerNum)%TowerModelType .EQ. CoolToolsXFModel .OR. &amp;</span>
<a name="ln-5555"></a><span class="c">!        SimpleTower(TowerNum)%TowerModelType .EQ. CoolToolsCFModel .OR. &amp;</span>
<a name="ln-5556"></a><span class="c">!        SimpleTower(TowerNum)%TowerModelType .EQ. YorkCalcModel)THEN</span>
<a name="ln-5557"></a><span class="c">!      Approach = (Approach / 1.8)  ! Convert from Fahrenheit to Celsius</span>
<a name="ln-5558"></a><span class="c">!    END IF</span>
<a name="ln-5559"></a>
<a name="ln-5560"></a><span class="k">END SUBROUTINE </span><span class="n">CalcVSTowerApproach</span>
<a name="ln-5561"></a>
<a name="ln-5562"></a><span class="k">SUBROUTINE </span><span class="n">CheckModelBounds</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">,</span> <span class="n">Twb</span><span class="p">,</span><span class="n">Tr</span><span class="p">,</span> <span class="n">Ta</span><span class="p">,</span> <span class="n">WaterFlowRateRatio</span><span class="p">,</span> <span class="n">TwbCapped</span><span class="p">,</span> <span class="n">TrCapped</span><span class="p">,</span> <span class="n">TaCapped</span><span class="p">,</span> <span class="n">WaterFlowRateRatioCapped</span><span class="p">)</span>
<a name="ln-5563"></a>
<a name="ln-5564"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5565"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5566"></a>          <span class="c">!       DATE WRITTEN   Feb 2005</span>
<a name="ln-5567"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5568"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-5569"></a>
<a name="ln-5570"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5571"></a>          <span class="c">!</span>
<a name="ln-5572"></a>          <span class="c">! To verify that the empirical model&#39;s independent variables are within the limits used during the</span>
<a name="ln-5573"></a>          <span class="c">! developement of the empirical model.</span>
<a name="ln-5574"></a>
<a name="ln-5575"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5576"></a>          <span class="c">! The empirical models used for simulating a variable speed cooling tower are based on a limited data set.</span>
<a name="ln-5577"></a>          <span class="c">! Extrapolation of empirical models can cause instability and the independent variables may need to be limited.</span>
<a name="ln-5578"></a>          <span class="c">! The range of each independent variable is provided either by the CoolTools or York model limits, or</span>
<a name="ln-5579"></a>          <span class="c">! specified by the user if the model is User Defined (in either the CoolTools or York model format).</span>
<a name="ln-5580"></a>          <span class="c">! These limits are tested in this subroutine each time step and returned for use by the calling routine.</span>
<a name="ln-5581"></a>          <span class="c">! The independent variables capped here may or may not be passed to the empirical model in the calling</span>
<a name="ln-5582"></a>          <span class="c">! routine depending on their use.</span>
<a name="ln-5583"></a>          <span class="c">!</span>
<a name="ln-5584"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5585"></a>          <span class="c">! na</span>
<a name="ln-5586"></a>
<a name="ln-5587"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5588"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurrentTime</span>
<a name="ln-5589"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">EnvironmentName</span><span class="p">,</span> <span class="n">CurMnDy</span>
<a name="ln-5590"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">CreateSysTimeIntervalString</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-5591"></a>
<a name="ln-5592"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5593"></a>
<a name="ln-5594"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5595"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerNum</span>                        <span class="c">! index to tower</span>
<a name="ln-5596"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Twb</span>                             <span class="c">! current inlet air wet-bulb temperature (C)</span>
<a name="ln-5597"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tr</span>                              <span class="c">! requested range temperature for current time step (C)</span>
<a name="ln-5598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Ta</span>                              <span class="c">! requested approach temperature for current time step (C)</span>
<a name="ln-5599"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WaterFlowRateRatio</span>              <span class="c">! current water flow rate ratio at water inlet node</span>
<a name="ln-5600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TwbCapped</span>                       <span class="c">! bounded value of inlet air wet-bulb temperature (C)</span>
<a name="ln-5601"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TrCapped</span>                        <span class="c">! bounded value of range temperature (C)</span>
<a name="ln-5602"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TaCapped</span>                        <span class="c">! bounded value of approach temperature (C)</span>
<a name="ln-5603"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterFlowRateRatioCapped</span>        <span class="c">! bounded value of water flow rate ratio</span>
<a name="ln-5604"></a>
<a name="ln-5605"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5606"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: OutputFormat  =&#39;(F5.2)&#39;</span>
<a name="ln-5607"></a><span class="c">!  CHARACTER(len=*), PARAMETER :: OutputFormat2 =&#39;(F8.5)&#39;</span>
<a name="ln-5608"></a>
<a name="ln-5609"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5610"></a>          <span class="c">! na</span>
<a name="ln-5611"></a>
<a name="ln-5612"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5613"></a>          <span class="c">! na</span>
<a name="ln-5614"></a>
<a name="ln-5615"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5616"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">OutputChar</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-5617"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">OutputCharLo</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-5618"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">OutputCharHi</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-5619"></a> <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TrimValue</span>          <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! character string for warning messages</span>
<a name="ln-5620"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">TimeStepSysLast</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! last system time step (used to check for downshifting)</span>
<a name="ln-5621"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CurrentEndTime</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! end time of time step for current simulation time step</span>
<a name="ln-5622"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">CurrentEndTimeLast</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! end time of time step for last simulation time step</span>
<a name="ln-5623"></a>                                                          <span class="c">! current end time is compared with last to see if time step changed</span>
<a name="ln-5624"></a>
<a name="ln-5625"></a><span class="c">!   initialize capped variables in case independent variables are in bounds</span>
<a name="ln-5626"></a>    <span class="n">TwbCapped</span> <span class="o">=</span> <span class="n">Twb</span>
<a name="ln-5627"></a>    <span class="n">TrCapped</span>  <span class="o">=</span> <span class="n">Tr</span>
<a name="ln-5628"></a>    <span class="n">TaCapped</span>  <span class="o">=</span> <span class="n">Ta</span>
<a name="ln-5629"></a>    <span class="n">WaterFlowRateRatioCapped</span> <span class="o">=</span> <span class="n">WaterFlowRateRatio</span>
<a name="ln-5630"></a>
<a name="ln-5631"></a><span class="c">!   calculate end time of current time step</span>
<a name="ln-5632"></a>    <span class="n">CurrentEndTime</span> <span class="o">=</span> <span class="n">CurrentTime</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-5633"></a>
<a name="ln-5634"></a><span class="c">!   Print warning messages only when valid and only for the first ocurrance. Let summary provide statistics.</span>
<a name="ln-5635"></a><span class="c">!   Wait for next time step to print warnings. If simulation iterates, print out</span>
<a name="ln-5636"></a><span class="c">!   the warning for the last iteration only. Must wait for next time step to accomplish this.</span>
<a name="ln-5637"></a><span class="c">!   If a warning occurs and the simulation down shifts, the warning is not valid.</span>
<a name="ln-5638"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CurrentEndTime</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CurrentEndTimeLast</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TimeStepSys</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">TimeStepSysLast</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5639"></a><span class="k">      IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTrMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5640"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountTR</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5641"></a>                        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountTR</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5642"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountTR</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5643"></a><span class="k">           CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TrBuffer1</span><span class="p">))</span>
<a name="ln-5644"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TrBuffer2</span><span class="p">))</span>
<a name="ln-5645"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TrBuffer3</span><span class="p">))</span>
<a name="ln-5646"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ...Range temperatures outside model boundaries may not &#39;</span> <span class="p">&amp;</span>
<a name="ln-5647"></a>                                  <span class="o">//</span><span class="s1">&#39;adversely affect tower performance.&#39;</span><span class="p">)</span>
<a name="ln-5648"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ...This is not an unexpected occurrence when simulating actual conditions.&#39;</span><span class="p">)</span>
<a name="ln-5649"></a>        <span class="k">ELSE</span>
<a name="ln-5650"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-5651"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Tower range temperature is out of range error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-5652"></a>              <span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">ErrIndexTR</span><span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TrLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5653"></a>                                                                 <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TrLast</span><span class="p">)</span>
<a name="ln-5654"></a>        <span class="k">END IF</span>
<a name="ln-5655"></a><span class="k">      END IF</span>
<a name="ln-5656"></a><span class="k">      IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTwbMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5657"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountIAWB</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5658"></a>                           <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountIAWB</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5659"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountIAWB</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5660"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TwbBuffer1</span><span class="p">))</span>
<a name="ln-5661"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TwbBuffer2</span><span class="p">))</span>
<a name="ln-5662"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TwbBuffer3</span><span class="p">))</span>
<a name="ln-5663"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ...Wet-bulb temperatures outside model boundaries may not &#39;</span> <span class="p">&amp;</span>
<a name="ln-5664"></a>                                 <span class="o">//</span><span class="s1">&#39;adversely affect tower performance.&#39;</span><span class="p">)</span>
<a name="ln-5665"></a>        <span class="k">ELSE</span>
<a name="ln-5666"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-5667"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Inlet air wet-bulb temperature is out of range error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-5668"></a>              <span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">ErrIndexIAWB</span><span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TwbLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5669"></a>                                                                   <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TwbLast</span><span class="p">)</span>
<a name="ln-5670"></a>        <span class="k">END IF</span>
<a name="ln-5671"></a><span class="k">      END IF</span>
<a name="ln-5672"></a><span class="k">      IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTaMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5673"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountTA</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5674"></a>                           <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountTA</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5675"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountTA</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5676"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TaBuffer1</span><span class="p">))</span>
<a name="ln-5677"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TaBuffer2</span><span class="p">))</span>
<a name="ln-5678"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TaBuffer3</span><span class="p">))</span>
<a name="ln-5679"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ...Approach temperatures outside model boundaries may not &#39;</span> <span class="p">&amp;</span>
<a name="ln-5680"></a>                                 <span class="o">//</span><span class="s1">&#39;adversely affect tower performance.&#39;</span><span class="p">)</span>
<a name="ln-5681"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ...This is not an unexpected occurrence when simulating actual conditions.&#39;</span><span class="p">)</span>
<a name="ln-5682"></a>       <span class="k">ELSE</span>
<a name="ln-5683"></a><span class="k">         CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-5684"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Tower approach temperature is out of range error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-5685"></a>              <span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">ErrIndexTA</span><span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TaLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5686"></a>                                                                 <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TaLast</span><span class="p">)</span>
<a name="ln-5687"></a>       <span class="k">END IF</span>
<a name="ln-5688"></a><span class="k">      END IF</span>
<a name="ln-5689"></a><span class="k">      IF</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintWFRRMessage</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5690"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountWFRR</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5691"></a>                           <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountWFRR</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5692"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">VSErrorCountWFRR</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5693"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">WFRRBuffer1</span><span class="p">))</span>
<a name="ln-5694"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">WFRRBuffer2</span><span class="p">))</span>
<a name="ln-5695"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">WFRRBuffer3</span><span class="p">))</span>
<a name="ln-5696"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ...Water flow rate ratios outside model boundaries may not &#39;</span> <span class="p">&amp;</span>
<a name="ln-5697"></a>                                 <span class="o">//</span><span class="s1">&#39;adversely affect tower performance.&#39;</span><span class="p">)</span>
<a name="ln-5698"></a>        <span class="k">ELSE</span>
<a name="ln-5699"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-5700"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Water flow rate ratio is out of range error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-5701"></a>              <span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">ErrIndexWFRR</span><span class="p">,</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">WaterFlowRateRatioLast</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5702"></a>                                                                   <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">WaterFlowRateRatioLast</span><span class="p">)</span>
<a name="ln-5703"></a>        <span class="k">END IF</span>
<a name="ln-5704"></a><span class="k">      END IF</span>
<a name="ln-5705"></a><span class="k">    END IF</span>
<a name="ln-5706"></a>
<a name="ln-5707"></a><span class="c">!   save last system time step and last end time of current time step (used to determine if warning is valid)</span>
<a name="ln-5708"></a>    <span class="n">TimeStepSysLast</span>    <span class="o">=</span> <span class="n">TimeStepSys</span>
<a name="ln-5709"></a>    <span class="n">CurrentEndTimeLast</span> <span class="o">=</span> <span class="n">CurrentEndTime</span>
<a name="ln-5710"></a>
<a name="ln-5711"></a><span class="c">!   check boundaries of independent variables and post warnings to individual buffers to print at end of time step</span>
<a name="ln-5712"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Twb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5713"></a>      <span class="n">Twb</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5714"></a><span class="k">      </span><span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Twb</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5715"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5716"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5717"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Twb</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5718"></a><span class="k">        </span><span class="n">TwbCapped</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinInletAirWBTemp</span>
<a name="ln-5719"></a>      <span class="k">END IF</span>
<a name="ln-5720"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Twb</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5721"></a><span class="k">        </span><span class="n">TwbCapped</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxInletAirWBTemp</span>
<a name="ln-5722"></a>      <span class="k">END IF</span>
<a name="ln-5723"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5724"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTwbMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5725"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TwbBuffer1</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-5726"></a>                                                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5727"></a>           <span class="s1">&#39;&quot; - Inlet air wet-bulb temperature is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5728"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TwbBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Valid range = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="p">&amp;</span>
<a name="ln-5729"></a>                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-5730"></a>                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-5731"></a>        <span class="n">TrimValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TwbCapped</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-5732"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TwbBuffer3</span> <span class="o">=</span> <span class="s1">&#39; ...Inlet air wet-bulb temperature passed to the model = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5733"></a>                                                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimValue</span><span class="p">)</span>
<a name="ln-5734"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TwbLast</span>       <span class="o">=</span> <span class="n">Twb</span>
<a name="ln-5735"></a>      <span class="k">ELSE</span>
<a name="ln-5736"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTwbMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5737"></a>      <span class="k">END IF</span>
<a name="ln-5738"></a><span class="k">    ELSE</span>
<a name="ln-5739"></a><span class="k">      </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTwbMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5740"></a>    <span class="k">END IF</span>
<a name="ln-5741"></a>
<a name="ln-5742"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Tr</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5743"></a>      <span class="n">Tr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5744"></a><span class="k">      </span><span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5745"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5746"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5747"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Tr</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5748"></a><span class="k">        </span><span class="n">TrCapped</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinRangeTemp</span>
<a name="ln-5749"></a>      <span class="k">END IF</span>
<a name="ln-5750"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Tr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5751"></a><span class="k">        </span><span class="n">TrCapped</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxRangeTemp</span>
<a name="ln-5752"></a>      <span class="k">END IF</span>
<a name="ln-5753"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5754"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTrMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5755"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TrBuffer1</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-5756"></a>                                                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5757"></a>             <span class="s1">&#39;&quot; - Tower range temperature is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5758"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TrBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Valid range = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="p">&amp;</span>
<a name="ln-5759"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-5760"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-5761"></a>        <span class="n">TrimValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-5762"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TrBuffer3</span> <span class="o">=</span> <span class="s1">&#39; ...Tower range temperature passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimValue</span><span class="p">)</span>
<a name="ln-5763"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TrLast</span>       <span class="o">=</span> <span class="n">Tr</span>
<a name="ln-5764"></a>      <span class="k">ELSE</span>
<a name="ln-5765"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTrMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5766"></a>      <span class="k">END IF</span>
<a name="ln-5767"></a><span class="k">    ELSE</span>
<a name="ln-5768"></a><span class="k">      </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTrMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5769"></a>    <span class="k">END IF</span>
<a name="ln-5770"></a>
<a name="ln-5771"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Ta</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5772"></a>       <span class="n">Ta</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5773"></a><span class="k">      </span><span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5774"></a>      <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5775"></a>      <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5776"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Ta</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5777"></a><span class="k">        </span><span class="n">TaCapped</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinApproachTemp</span>
<a name="ln-5778"></a>      <span class="k">END IF</span>
<a name="ln-5779"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Ta</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5780"></a><span class="k">        </span><span class="n">TaCapped</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxApproachTemp</span>
<a name="ln-5781"></a>      <span class="k">END IF</span>
<a name="ln-5782"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5783"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTaMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5784"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TaBuffer1</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-5785"></a>                                                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5786"></a>              <span class="s1">&#39;&quot; - Tower approach temperature is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5787"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TaBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Valid range = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="p">&amp;</span>
<a name="ln-5788"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-5789"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-5790"></a>        <span class="n">TrimValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Ta</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-5791"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TaBuffer3</span> <span class="o">=</span> <span class="s1">&#39; ...Tower approach temperature passed to the model = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5792"></a>                                                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimValue</span><span class="p">)</span>
<a name="ln-5793"></a>        <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">TaLast</span> <span class="o">=</span> <span class="n">Ta</span>
<a name="ln-5794"></a>      <span class="k">ELSE</span>
<a name="ln-5795"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTaMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5796"></a>      <span class="k">END IF</span>
<a name="ln-5797"></a><span class="k">    ELSE</span>
<a name="ln-5798"></a><span class="k">      </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintTaMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5799"></a>    <span class="k">END IF</span>
<a name="ln-5800"></a>
<a name="ln-5801"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">YorkCalcModel</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5802"></a>       <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerModelType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">YorkCalcUserDefined</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5803"></a><span class="c">!     Water flow rate ratio warning not valid for YorkCalc model, print liquid to gas ratio</span>
<a name="ln-5804"></a><span class="c">!     warning instead (bottom of Subroutine VariableSpeedTower)</span>
<a name="ln-5805"></a>      <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintWFRRMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5806"></a>    <span class="k">ELSE</span>
<a name="ln-5807"></a><span class="k">      IF</span><span class="p">(</span><span class="n">WaterFlowRateRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5808"></a>        <span class="n">WaterFlowRateRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5809"></a><span class="k">        </span><span class="n">OutputChar</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterFlowRateRatio</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5810"></a>        <span class="n">OutputCharLo</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5811"></a>        <span class="n">OutputCharHi</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5812"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterFlowRateRatio</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5813"></a><span class="k">           </span><span class="n">WaterFlowRateRatioCapped</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MinWaterFlowRatio</span>
<a name="ln-5814"></a>        <span class="k">END IF</span>
<a name="ln-5815"></a><span class="k">        IF</span><span class="p">(</span><span class="n">WaterFlowRateRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5816"></a><span class="k">           </span><span class="n">WaterFlowRateRatioCapped</span> <span class="o">=</span> <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">MaxWaterFlowRatio</span>
<a name="ln-5817"></a>        <span class="k">END IF</span>
<a name="ln-5818"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5819"></a><span class="k">          </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintWFRRMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5820"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">WFRRBuffer1</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-5821"></a>                                                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5822"></a>                <span class="s1">&#39;&quot; - Water flow rate ratio is outside model boundaries at &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputChar</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span>
<a name="ln-5823"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">WFRRBuffer2</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Valid range = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharLo</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span> <span class="p">&amp;</span>
<a name="ln-5824"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">OutputCharHi</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;. Occurrence info = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">EnvironmentName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">CurMnDy</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &#39;</span><span class="p">&amp;</span>
<a name="ln-5825"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CreateSysTimeIntervalString</span><span class="p">())</span>
<a name="ln-5826"></a>          <span class="n">TrimValue</span><span class="o">=</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterFlowRateRatioCapped</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-5827"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">WFRRBuffer3</span> <span class="o">=</span> <span class="s1">&#39; ...Water flow rate ratio passed to the model = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimValue</span><span class="p">)</span>
<a name="ln-5828"></a>          <span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">WaterFlowRateRatioLast</span> <span class="o">=</span> <span class="n">WaterFlowRateRatio</span>
<a name="ln-5829"></a>        <span class="k">ELSE</span>
<a name="ln-5830"></a><span class="k">          </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintWFRRMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5831"></a>        <span class="k">END IF</span>
<a name="ln-5832"></a><span class="k">      ELSE</span>
<a name="ln-5833"></a><span class="k">        </span><span class="n">VSTower</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">VSTower</span><span class="p">)%</span><span class="n">PrintWFRRMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5834"></a>      <span class="k">END IF</span>
<a name="ln-5835"></a><span class="k">    END IF</span>
<a name="ln-5836"></a>
<a name="ln-5837"></a><span class="k">END SUBROUTINE </span><span class="n">CheckModelBounds</span>
<a name="ln-5838"></a>
<a name="ln-5839"></a><span class="k">FUNCTION </span><span class="n">SimpleTowerUAResidual</span><span class="p">(</span><span class="n">UA</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-5840"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5841"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-5842"></a>          <span class="c">!       DATE WRITTEN   May 2002</span>
<a name="ln-5843"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-5844"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-5845"></a>
<a name="ln-5846"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5847"></a>          <span class="c">! Calculates residual function (Design Tower Load - Tower Cooling Output) / Design Tower Load.</span>
<a name="ln-5848"></a>          <span class="c">! Tower Cooling Output depends on the UA which is being varied to zero the residual.</span>
<a name="ln-5849"></a>
<a name="ln-5850"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5851"></a>          <span class="c">! Puts UA into the cooling tower data structure, calls SimSimpleTower, and calculates</span>
<a name="ln-5852"></a>          <span class="c">! the residual as defined above.</span>
<a name="ln-5853"></a>
<a name="ln-5854"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5855"></a>
<a name="ln-5856"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5857"></a>          <span class="c">! na</span>
<a name="ln-5858"></a>
<a name="ln-5859"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5860"></a>
<a name="ln-5861"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5862"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UA</span>                         <span class="c">! UA of cooling tower</span>
<a name="ln-5863"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = design tower load [W]</span>
<a name="ln-5864"></a>                                                    <span class="c">! par(2) = tower number</span>
<a name="ln-5865"></a>                                                    <span class="c">! par(3) = design water mass flow rate [kg/s]</span>
<a name="ln-5866"></a>                                                    <span class="c">! par(4) = design air volume flow rate [m3/s]</span>
<a name="ln-5867"></a>                                                    <span class="c">! par(5) = water specific heat [J/(kg*C)]</span>
<a name="ln-5868"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-5869"></a>
<a name="ln-5870"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5871"></a>          <span class="c">! na</span>
<a name="ln-5872"></a>
<a name="ln-5873"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5874"></a>          <span class="c">! na</span>
<a name="ln-5875"></a>
<a name="ln-5876"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5877"></a>          <span class="c">! na</span>
<a name="ln-5878"></a>
<a name="ln-5879"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5880"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TowerIndex</span>                             <span class="c">! index of this tower</span>
<a name="ln-5881"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutWaterTemp</span>                           <span class="c">! outlet water temperature [C]</span>
<a name="ln-5882"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolingOutput</span>                          <span class="c">! tower cooling output [W]</span>
<a name="ln-5883"></a>
<a name="ln-5884"></a>  <span class="n">TowerIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-5885"></a>  <span class="k">CALL </span><span class="n">SimSimpleTower</span><span class="p">(</span><span class="n">TowerIndex</span><span class="p">,</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">UA</span><span class="p">,</span><span class="n">OutWaterTemp</span><span class="p">)</span>
<a name="ln-5886"></a>  <span class="n">CoolingOutput</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerIndex</span><span class="p">)%</span><span class="n">WaterTemp</span> <span class="o">-</span> <span class="n">OutWaterTemp</span><span class="p">)</span>
<a name="ln-5887"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">CoolingOutput</span><span class="p">)</span> <span class="o">/</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5888"></a>  <span class="k">RETURN</span>
<a name="ln-5889"></a><span class="k">END FUNCTION </span><span class="n">SimpleTowerUAResidual</span>
<a name="ln-5890"></a>
<a name="ln-5891"></a><span class="k">FUNCTION </span><span class="n">SimpleTowerTrResidual</span><span class="p">(</span><span class="n">Trange</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-5892"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5893"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-5894"></a>          <span class="c">!       DATE WRITTEN   Feb 2005</span>
<a name="ln-5895"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5896"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5897"></a>
<a name="ln-5898"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5899"></a>          <span class="c">! Calculates residual function (where residual shows a balance point of model and desired performance)</span>
<a name="ln-5900"></a>          <span class="c">! Tower Approach depends on the range temperature which is being varied to zero the residual.</span>
<a name="ln-5901"></a>
<a name="ln-5902"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5903"></a>          <span class="c">! Varies tower range temperature until a balance point exists where the model output corresponds</span>
<a name="ln-5904"></a>          <span class="c">! to the desired independent variables</span>
<a name="ln-5905"></a>
<a name="ln-5906"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5907"></a>
<a name="ln-5908"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5909"></a>          <span class="c">! na</span>
<a name="ln-5910"></a>
<a name="ln-5911"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5912"></a>
<a name="ln-5913"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5914"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Trange</span>                     <span class="c">! cooling tower range temperature [C]</span>
<a name="ln-5915"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = tower number</span>
<a name="ln-5916"></a>                                                    <span class="c">! par(2) = water flow ratio</span>
<a name="ln-5917"></a>                                                    <span class="c">! par(3) = air flow ratio</span>
<a name="ln-5918"></a>                                                    <span class="c">! par(4) = inlet air wet-bulb temperature [C]</span>
<a name="ln-5919"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span>                   <span class="c">! residual to be minimized to zero</span>
<a name="ln-5920"></a>
<a name="ln-5921"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5922"></a>          <span class="c">! na</span>
<a name="ln-5923"></a>
<a name="ln-5924"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5925"></a>          <span class="c">! na</span>
<a name="ln-5926"></a>
<a name="ln-5927"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5928"></a>          <span class="c">! na</span>
<a name="ln-5929"></a>
<a name="ln-5930"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5931"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TowerIndex</span>                             <span class="c">! index of this tower</span>
<a name="ln-5932"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">WaterFlowRateRatio</span>                     <span class="c">! ratio of water flow rate to design water flow rate</span>
<a name="ln-5933"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">AirFlowRateRatio</span>                       <span class="c">! ratio of water flow rate to design water flow rate</span>
<a name="ln-5934"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">InletAirWB</span>                             <span class="c">! inlet air wet-bulb temperature [C]</span>
<a name="ln-5935"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">Tapproach</span>                              <span class="c">! tower approach temperature [C]</span>
<a name="ln-5936"></a>
<a name="ln-5937"></a>  <span class="n">TowerIndex</span>         <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-5938"></a>  <span class="n">WaterFlowRateRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5939"></a>  <span class="n">AirFlowRateRatio</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5940"></a>  <span class="n">InletAirWB</span>         <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-5941"></a>  <span class="n">Tapproach</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5942"></a>
<a name="ln-5943"></a><span class="c">! call model to determine approach temperature given other independent variables (range temp is being varied to find balance)</span>
<a name="ln-5944"></a>  <span class="k">CALL </span><span class="n">CalcVSTowerApproach</span><span class="p">(</span><span class="n">TowerIndex</span><span class="p">,</span><span class="n">WaterFlowRateRatio</span><span class="p">,</span><span class="n">AirFlowRateRatio</span><span class="p">,</span><span class="n">InletAirWB</span><span class="p">,</span><span class="n">Trange</span><span class="p">,</span><span class="n">Tapproach</span><span class="p">)</span>
<a name="ln-5945"></a><span class="c">! calculate residual based on a balance where Twb + Ta + Tr = Node(WaterInletNode)%Temp</span>
<a name="ln-5946"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">InletAirWB</span><span class="o">+</span><span class="n">Tapproach</span><span class="o">+</span><span class="n">Trange</span><span class="p">)</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5947"></a>              <span class="n">Node</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerIndex</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5948"></a>
<a name="ln-5949"></a>  <span class="k">RETURN</span>
<a name="ln-5950"></a><span class="k">END FUNCTION </span><span class="n">SimpleTowerTrResidual</span>
<a name="ln-5951"></a>
<a name="ln-5952"></a><span class="k">FUNCTION </span><span class="n">SimpleTowerApproachResidual</span><span class="p">(</span><span class="n">FlowRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-5953"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5954"></a>          <span class="c">!       AUTHOR         Richard Raustad, FSEC</span>
<a name="ln-5955"></a>          <span class="c">!       DATE WRITTEN   Feb 2005</span>
<a name="ln-5956"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5957"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5958"></a>
<a name="ln-5959"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5960"></a>          <span class="c">! Calculates residual function (Desired Approach - Model Approach Output)</span>
<a name="ln-5961"></a>          <span class="c">! Tower Approach depends on the water (or air) flow rate ratio which is being varied to zero the residual.</span>
<a name="ln-5962"></a>
<a name="ln-5963"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5964"></a>          <span class="c">! In SizeTower, calibrates tower water flow rate ratio at an air flow rate ratio of 1.</span>
<a name="ln-5965"></a>          <span class="c">! In VariableSpeedTower, calculates air flow rate ratio at the inlet water flow rate ratio.</span>
<a name="ln-5966"></a>
<a name="ln-5967"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5968"></a>
<a name="ln-5969"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5970"></a>          <span class="c">! na</span>
<a name="ln-5971"></a>
<a name="ln-5972"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5973"></a>
<a name="ln-5974"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5975"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FlowRatio</span>                  <span class="c">! water or air flow ratio of cooling tower</span>
<a name="ln-5976"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = tower number</span>
<a name="ln-5977"></a>                                                  <span class="c">! par(2) = water or air flow ratio (opposite of input variable)</span>
<a name="ln-5978"></a>                                                  <span class="c">! par(3) = inlet air wet-bulb temp [C]</span>
<a name="ln-5979"></a>                                                  <span class="c">! par(4) = tower range [C]</span>
<a name="ln-5980"></a>                                                  <span class="c">! par(5) = desired approach [C]</span>
<a name="ln-5981"></a>                                                  <span class="c">! par(6) = 0.0 to calculate water flow rate ratio, 1.0 for air</span>
<a name="ln-5982"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-5983"></a>
<a name="ln-5984"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5985"></a>          <span class="c">! na</span>
<a name="ln-5986"></a>
<a name="ln-5987"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5988"></a>          <span class="c">! na</span>
<a name="ln-5989"></a>
<a name="ln-5990"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5991"></a>          <span class="c">! na</span>
<a name="ln-5992"></a>
<a name="ln-5993"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5994"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TowerIndex</span>                           <span class="c">! index of this tower</span>
<a name="ln-5995"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">WaterFlowRateRatio</span>                   <span class="c">! ratio of water flow rate to design water flow rate</span>
<a name="ln-5996"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">AirFlowRateRatio</span>                     <span class="c">! ratio of water flow rate to design water flow rate</span>
<a name="ln-5997"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">InletAirWB</span>                           <span class="c">! inlet air wet-bulb temperature [C]</span>
<a name="ln-5998"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">Trange</span>                               <span class="c">! tower range temperature [C]</span>
<a name="ln-5999"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">TapproachActual</span>                      <span class="c">! actual tower approach temperature [C]</span>
<a name="ln-6000"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span>    <span class="n">TapproachDesired</span>                     <span class="c">! desired tower approach temperature [C]</span>
<a name="ln-6001"></a>
<a name="ln-6002"></a>  <span class="n">TowerIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-6003"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6004"></a><span class="k">    </span><span class="n">AirFlowRateRatio</span>   <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6005"></a>    <span class="n">WaterFlowRateRatio</span> <span class="o">=</span> <span class="n">FlowRatio</span>
<a name="ln-6006"></a>  <span class="k">ELSE</span>
<a name="ln-6007"></a><span class="k">    </span><span class="n">AirFlowRateRatio</span>   <span class="o">=</span> <span class="n">FlowRatio</span>
<a name="ln-6008"></a>    <span class="n">WaterFlowRateRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6009"></a>  <span class="k">END IF</span>
<a name="ln-6010"></a><span class="k">  </span><span class="n">InletAirWB</span>           <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6011"></a>  <span class="n">Trange</span>               <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-6012"></a>  <span class="n">TapproachDesired</span>     <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-6013"></a>  <span class="n">TapproachActual</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6014"></a>
<a name="ln-6015"></a><span class="c">! call model to determine tower approach temperature given other independent variables</span>
<a name="ln-6016"></a>  <span class="k">CALL </span><span class="n">CalcVSTowerApproach</span><span class="p">(</span><span class="n">TowerIndex</span><span class="p">,</span><span class="n">WaterFlowRateRatio</span><span class="p">,</span><span class="n">AirFlowRateRatio</span><span class="p">,</span><span class="n">InletAirWB</span><span class="p">,</span><span class="n">Trange</span><span class="p">,</span><span class="n">TapproachActual</span><span class="p">)</span>
<a name="ln-6017"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="n">TapproachDesired</span> <span class="o">-</span> <span class="n">TapproachActual</span>
<a name="ln-6018"></a>
<a name="ln-6019"></a>  <span class="k">RETURN</span>
<a name="ln-6020"></a><span class="k">END FUNCTION </span><span class="n">SimpleTowerApproachResidual</span>
<a name="ln-6021"></a>
<a name="ln-6022"></a><span class="c">! End of the CondenserLoopTowers Module Simulation Subroutines</span>
<a name="ln-6023"></a>
<a name="ln-6024"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6025"></a>
<a name="ln-6026"></a><span class="k">SUBROUTINE </span><span class="n">CalculateWaterUseage</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-6027"></a>
<a name="ln-6028"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6029"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-6030"></a>          <span class="c">!       DATE WRITTEN   August 2006</span>
<a name="ln-6031"></a>          <span class="c">!       MODIFIED       T Hong, Aug. 2008. Added fluid bypass for single speed cooling tower</span>
<a name="ln-6032"></a>          <span class="c">!                      A Flament, July 2010. Added multi-cell capability</span>
<a name="ln-6033"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6034"></a>
<a name="ln-6035"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6036"></a>          <span class="c">! Collect tower water useage calculations for</span>
<a name="ln-6037"></a>          <span class="c">! reuse by all the tower models.</span>
<a name="ln-6038"></a>
<a name="ln-6039"></a>
<a name="ln-6040"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6041"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-6042"></a>
<a name="ln-6043"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6044"></a>          <span class="c">! Code for this routine started from VariableSpeedTower</span>
<a name="ln-6045"></a>
<a name="ln-6046"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6047"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">BeginTimeStepFlag</span>
<a name="ln-6048"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-6049"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-6050"></a>  <span class="k">USE </span><span class="n">DataWater</span>      <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-6051"></a>
<a name="ln-6052"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6053"></a>
<a name="ln-6054"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6055"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-6056"></a>
<a name="ln-6057"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6058"></a>          <span class="c">! na</span>
<a name="ln-6059"></a>
<a name="ln-6060"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-6061"></a>          <span class="c">! na</span>
<a name="ln-6062"></a>
<a name="ln-6063"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-6064"></a>          <span class="c">! na</span>
<a name="ln-6065"></a>
<a name="ln-6066"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6067"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirDensity</span>
<a name="ln-6068"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRate</span>
<a name="ln-6069"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AvailTankVdot</span>
<a name="ln-6070"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BlowDownVdot</span>      <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6071"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DriftVdot</span>         <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6072"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapVdot</span>          <span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6073"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>
<a name="ln-6074"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InSpecificHumRat</span>
<a name="ln-6075"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutSpecificHumRat</span>
<a name="ln-6076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TairAvg</span>
<a name="ln-6077"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MakeUpVdot</span>
<a name="ln-6078"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-6079"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRatSat</span>
<a name="ln-6080"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTSat</span>
<a name="ln-6081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StarvedVdot</span>
<a name="ln-6082"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankSupplyVdot</span>
<a name="ln-6083"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-6084"></a>
<a name="ln-6085"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AverageWaterTemp</span>
<a name="ln-6086"></a>
<a name="ln-6087"></a>  <span class="n">AverageWaterTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">InletWaterTemp</span> <span class="o">+</span> <span class="n">OutletWaterTemp</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0d0</span>
<a name="ln-6088"></a>
<a name="ln-6089"></a>  <span class="c">! Set water and air properties</span>
<a name="ln-6090"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">==</span> <span class="n">EvapLossByMoistTheory</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6091"></a>
<a name="ln-6092"></a><span class="k">    </span><span class="n">AirDensity</span>          <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6093"></a>                            <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span><span class="p">,</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span><span class="p">)</span>
<a name="ln-6094"></a>    <span class="n">AirMassFlowRate</span>     <span class="o">=</span> <span class="n">AirFlowRateRatio</span><span class="o">*</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighSpeedAirFlowRate</span><span class="o">*</span><span class="n">AirDensity</span><span class="p">&amp;</span>
<a name="ln-6095"></a>                          <span class="o">*</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span>
<a name="ln-6096"></a>    <span class="n">InletAirEnthalpy</span>    <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6097"></a>       <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirWetBulb</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6098"></a>          <span class="mf">1.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6099"></a>          <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-6100"></a>
<a name="ln-6101"></a>    <span class="k">IF</span>  <span class="p">(</span><span class="n">AirMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6102"></a>      <span class="c">! Calculate outlet air conditions for determining water usage</span>
<a name="ln-6103"></a>
<a name="ln-6104"></a>      <span class="n">OutletAirEnthalpy</span>   <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">+</span> <span class="n">Qactual</span><span class="o">/</span><span class="n">AirMassFlowRate</span>
<a name="ln-6105"></a>      <span class="n">OutletAirTSat</span>       <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">OutletAirEnthalpy</span><span class="p">,</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirPress</span><span class="p">)</span>
<a name="ln-6106"></a>      <span class="n">OutletAirHumRatSat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirTSat</span><span class="p">,</span><span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-6107"></a>
<a name="ln-6108"></a>      <span class="c">! calculate specific humidity ratios (HUMRAT to mass of moist air not dry air)</span>
<a name="ln-6109"></a>       <span class="n">InSpecificHumRat</span> <span class="o">=</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirHumRat</span><span class="p">)</span>
<a name="ln-6110"></a>       <span class="n">OutSpecificHumRat</span> <span class="o">=</span> <span class="n">OutletAirHumRatSat</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="n">OutletAirHumRatSat</span><span class="p">)</span>
<a name="ln-6111"></a>
<a name="ln-6112"></a>      <span class="c">! calculate average air temp for density call</span>
<a name="ln-6113"></a>       <span class="n">TairAvg</span> <span class="o">=</span> <span class="p">(</span><span class="n">SimpleTowerInlet</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirTemp</span> <span class="o">+</span> <span class="n">OutletAirTSat</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-6114"></a>
<a name="ln-6115"></a>      <span class="c">! Amount of water evaporated, get density water at air temp or 4 C if too cold</span>
<a name="ln-6116"></a>       <span class="n">rho</span> <span class="o">=</span>  <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6117"></a>                                <span class="nb">MAX</span><span class="p">(</span><span class="n">TairAvg</span><span class="p">,</span><span class="mf">4.d0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6118"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-6119"></a>                                <span class="s1">&#39;CalculateWaterUseage&#39;</span><span class="p">)</span>
<a name="ln-6120"></a>
<a name="ln-6121"></a>       <span class="n">EvapVdot</span>         <span class="o">=</span> <span class="p">(</span><span class="n">AirMassFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">OutSpecificHumRat</span> <span class="o">-</span> <span class="n">InSpecificHumRat</span><span class="p">))</span> <span class="o">/</span> <span class="n">rho</span> <span class="c">! [m3/s]</span>
<a name="ln-6122"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">EvapVdot</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">EvapVdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6123"></a>     <span class="k">ELSE</span>
<a name="ln-6124"></a><span class="k">       </span><span class="n">EvapVdot</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6125"></a>     <span class="n">ENDIF</span>
<a name="ln-6126"></a>
<a name="ln-6127"></a>  <span class="n">ElseIf</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">==</span> <span class="n">EvapLossByUserFactor</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6128"></a><span class="c">!    EvapVdot   = SimpleTower(TowerNum)%UserEvapLossFactor * (InletWaterTemp - OutletWaterTemp) &amp;</span>
<a name="ln-6129"></a><span class="c">!                     * SimpleTower(TowerNum)%DesignWaterFlowRate</span>
<a name="ln-6130"></a>    <span class="n">rho</span> <span class="o">=</span>  <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6131"></a>                                <span class="n">AverageWaterTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6132"></a>                                <span class="n">PlantLoop</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,&amp;</span>
<a name="ln-6133"></a>                                <span class="s1">&#39;CalculateWaterUseage&#39;</span><span class="p">)</span>
<a name="ln-6134"></a>
<a name="ln-6135"></a>    <span class="n">EvapVdot</span>   <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">UserEvapLossFactor</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletWaterTemp</span> <span class="o">-</span> <span class="n">OutletWaterTemp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6136"></a>                     <span class="o">*</span> <span class="p">(</span><span class="n">WaterMassFlowRate</span> <span class="o">/</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-6137"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">EvapVdot</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">EvapVdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6138"></a>  <span class="k">ELSE</span>
<a name="ln-6139"></a>    <span class="c">! should never come here</span>
<a name="ln-6140"></a>  <span class="n">ENDIF</span>
<a name="ln-6141"></a>
<a name="ln-6142"></a><span class="c">!   amount of water lost due to drift</span>
<a name="ln-6143"></a>  <span class="n">DriftVdot</span>               <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesignWaterFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6144"></a>                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span> <span class="o">/</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCell</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6145"></a>                            <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftLossFraction</span> <span class="o">*</span>  <span class="n">AirFlowRateRatio</span>
<a name="ln-6146"></a>
<a name="ln-6147"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span> <span class="o">==</span> <span class="n">BlowdownBySchedule</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6148"></a>    <span class="c">! Amount of water lost due to blow down (purging contaminants from tower basin)</span>
<a name="ln-6149"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6150"></a><span class="k">      </span><span class="n">BlowDownVdot</span>          <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SchedIDBlowdown</span><span class="p">)</span>
<a name="ln-6151"></a>    <span class="k">ELSE</span>
<a name="ln-6152"></a><span class="k">      </span><span class="n">BlowDownVdot</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6153"></a>    <span class="k">END IF</span>
<a name="ln-6154"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownMode</span> <span class="o">==</span> <span class="n">BlowdownByConcentration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6155"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">&gt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">Then</span> <span class="c">! protect divide by zero</span>
<a name="ln-6156"></a>         <span class="n">BlowDownVdot</span>  <span class="o">=</span>  <span class="n">EvapVdot</span> <span class="o">/</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">ConcentrationRatio</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">DriftVdot</span>
<a name="ln-6157"></a>      <span class="k">ELSE</span>
<a name="ln-6158"></a><span class="k">         </span><span class="n">BlowDownVdot</span>  <span class="o">=</span> <span class="n">EvapVdot</span> <span class="o">-</span> <span class="n">DriftVdot</span>
<a name="ln-6159"></a>      <span class="n">ENDIF</span>
<a name="ln-6160"></a>      <span class="k">If</span> <span class="p">(</span> <span class="n">BlowDownVdot</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="n">BlowDownVdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6161"></a>  <span class="k">ELSE</span>
<a name="ln-6162"></a>   <span class="c">!should never come here</span>
<a name="ln-6163"></a>  <span class="n">ENDIF</span>
<a name="ln-6164"></a>
<a name="ln-6165"></a>  <span class="c">! Added for fluid bypass</span>
<a name="ln-6166"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">CapacityControl</span> <span class="o">==</span> <span class="n">CapacityControl_FluidBypass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6167"></a><span class="k">    If</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvapLossMode</span> <span class="o">==</span> <span class="n">EvapLossByUserFactor</span><span class="p">)</span> <span class="n">EvapVdot</span> <span class="o">=</span> <span class="n">EvapVdot</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span><span class="p">)</span>
<a name="ln-6168"></a>    <span class="n">DriftVdot</span> <span class="o">=</span> <span class="n">DriftVdot</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span><span class="p">)</span>
<a name="ln-6169"></a>    <span class="n">BlowDownVdot</span> <span class="o">=</span> <span class="n">BlowDownVdot</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span><span class="p">)</span>
<a name="ln-6170"></a>  <span class="n">ENDIF</span>
<a name="ln-6171"></a>
<a name="ln-6172"></a>  <span class="n">MakeUpVdot</span> <span class="o">=</span> <span class="n">EvapVdot</span> <span class="o">+</span> <span class="n">DriftVdot</span> <span class="o">+</span> <span class="n">BlowDownVdot</span>
<a name="ln-6173"></a>
<a name="ln-6174"></a>  <span class="c">! set demand request in Water STorage if needed</span>
<a name="ln-6175"></a>  <span class="n">StarvedVdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6176"></a>  <span class="n">TankSupplyVdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6177"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SuppliedByWaterSystem</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6178"></a>
<a name="ln-6179"></a>     <span class="c">! set demand request</span>
<a name="ln-6180"></a>     <span class="n">WaterStorage</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankID</span><span class="p">)%</span><span class="n">VdotRequestDemand</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankDemandARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6181"></a>      <span class="o">=</span> <span class="n">MakeUpVdot</span>
<a name="ln-6182"></a>
<a name="ln-6183"></a>     <span class="n">AvailTankVdot</span> <span class="o">=</span> <span class="p">&amp;</span>       <span class="c">! check what tank can currently provide</span>
<a name="ln-6184"></a>     <span class="n">WaterStorage</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankID</span><span class="p">)%</span><span class="n">VdotAvailDemand</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterTankDemandARRID</span><span class="p">)</span>
<a name="ln-6185"></a>
<a name="ln-6186"></a>     <span class="n">TankSupplyVdot</span> <span class="o">=</span> <span class="n">MakeUpVdot</span> <span class="c">! init</span>
<a name="ln-6187"></a>     <span class="k">If</span> <span class="p">(</span><span class="n">AvailTankVdot</span> <span class="o">&lt;</span> <span class="n">MakeUpVdot</span><span class="p">)</span> <span class="k">Then</span> <span class="c">! calculate starved flow</span>
<a name="ln-6188"></a>        <span class="n">StarvedVdot</span> <span class="o">=</span> <span class="n">MakeUpVdot</span> <span class="o">-</span> <span class="n">AvailTankVdot</span>
<a name="ln-6189"></a>        <span class="n">TankSupplyVdot</span> <span class="o">=</span> <span class="n">AvailTankVdot</span>
<a name="ln-6190"></a>     <span class="n">ENDIF</span>
<a name="ln-6191"></a>  <span class="k">ELSE</span> <span class="c">! supplied by mains</span>
<a name="ln-6192"></a>
<a name="ln-6193"></a>  <span class="n">ENDIF</span>
<a name="ln-6194"></a>
<a name="ln-6195"></a>  <span class="c">!   total water usage</span>
<a name="ln-6196"></a>  <span class="c">! update report variables</span>
<a name="ln-6197"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvaporationVdot</span>   <span class="o">=</span> <span class="n">EvapVdot</span>
<a name="ln-6198"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">EvaporationVol</span>    <span class="o">=</span> <span class="n">EvapVdot</span>       <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-6199"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftVdot</span>         <span class="o">=</span> <span class="n">DriftVdot</span>
<a name="ln-6200"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DriftVol</span>          <span class="o">=</span> <span class="n">DriftVdot</span>      <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-6201"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownVdot</span>      <span class="o">=</span> <span class="n">BlowDownVdot</span>
<a name="ln-6202"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BlowdownVol</span>       <span class="o">=</span> <span class="n">BlowDownVdot</span>   <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-6203"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MakeUpVdot</span>        <span class="o">=</span> <span class="n">MakeUpVdot</span>
<a name="ln-6204"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">MakeUpVol</span>         <span class="o">=</span> <span class="n">MakeUpVdot</span>     <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-6205"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TankSupplyVdot</span>    <span class="o">=</span> <span class="n">TankSupplyVdot</span>
<a name="ln-6206"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TankSupplyVol</span>     <span class="o">=</span> <span class="n">TankSupplyVdot</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-6207"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">StarvedMakeUpVdot</span> <span class="o">=</span> <span class="n">StarvedVdot</span>
<a name="ln-6208"></a>  <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">StarvedMakeUpVol</span>  <span class="o">=</span> <span class="n">StarvedVdot</span>    <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-6209"></a>
<a name="ln-6210"></a>  <span class="k">RETURN</span>
<a name="ln-6211"></a>
<a name="ln-6212"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateWaterUseage</span>
<a name="ln-6213"></a>
<a name="ln-6214"></a>
<a name="ln-6215"></a><span class="c">! Beginning of Record Keeping subroutines for the Tower Module</span>
<a name="ln-6216"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6217"></a>
<a name="ln-6218"></a><span class="k">SUBROUTINE </span><span class="n">UpdateTowers</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-6219"></a>
<a name="ln-6220"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6221"></a>          <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-6222"></a>          <span class="c">!       DATE WRITTEN:    October 1998</span>
<a name="ln-6223"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6224"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6225"></a>
<a name="ln-6226"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6227"></a>          <span class="c">! This subroutine is for passing results to the outlet water node.</span>
<a name="ln-6228"></a>
<a name="ln-6229"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6230"></a>          <span class="c">! na</span>
<a name="ln-6231"></a>
<a name="ln-6232"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6233"></a>          <span class="c">! na</span>
<a name="ln-6234"></a>
<a name="ln-6235"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6236"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">EnvironmentName</span><span class="p">,</span> <span class="n">CurMnDy</span>
<a name="ln-6237"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-6238"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-6239"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-6240"></a>
<a name="ln-6241"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6242"></a>
<a name="ln-6243"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6244"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-6245"></a>
<a name="ln-6246"></a>
<a name="ln-6247"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6248"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">LowTempFmt</span><span class="o">=</span><span class="s2">&quot;(&#39; &#39;,F6.2)&quot;</span>
<a name="ln-6249"></a>
<a name="ln-6250"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6251"></a>          <span class="c">! na</span>
<a name="ln-6252"></a>
<a name="ln-6253"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6254"></a>          <span class="c">! na</span>
<a name="ln-6255"></a>
<a name="ln-6256"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6257"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">CharErrOut</span>
<a name="ln-6258"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">CharLowOutletTemp</span>
<a name="ln-6259"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-6260"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-6261"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoopMinTemp</span>
<a name="ln-6262"></a>  <span class="c">! set node information</span>
<a name="ln-6263"></a>
<a name="ln-6264"></a>
<a name="ln-6265"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>                   <span class="o">=</span> <span class="n">OutletWaterTemp</span>
<a name="ln-6266"></a>
<a name="ln-6267"></a>  <span class="n">LoopNum</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopNum</span>
<a name="ln-6268"></a>  <span class="n">LoopSideNum</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">LoopSideNum</span>
<a name="ln-6269"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">Loopside</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">FlowLock</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-6270"></a>
<a name="ln-6271"></a>  <span class="c">!Check flow rate through tower and compare to design flow rate, show warning if greater than Design * Mulitplier</span>
<a name="ln-6272"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6273"></a>                                              <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerMassFlowRateMultiplier</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6274"></a><span class="k">    </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighMassFlowErrorCount</span><span class="o">=</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighMassFlowErrorCount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-6275"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighMassFlowErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6276"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-6277"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39; Condenser Loop Mass Flow Rate is much greater than the towers design mass flow rate.&#39;</span><span class="p">)</span>
<a name="ln-6278"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39; Condenser Loop Mass Flow Rate = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6279"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39; Tower Design Mass Flow Rate   = &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">DesWaterMassFlowRate</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6280"></a>      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6281"></a>    <span class="k">ELSE</span>
<a name="ln-6282"></a><span class="k">      CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-6283"></a>          <span class="s1">&#39;&quot;  Condenser Loop Mass Flow Rate is much greater than the towers design mass flow rate error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-6284"></a>          <span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">HighMassFlowErrorIndex</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">)</span>
<a name="ln-6285"></a>    <span class="n">ENDIF</span>
<a name="ln-6286"></a>  <span class="k">END IF</span>
<a name="ln-6287"></a>
<a name="ln-6288"></a>   <span class="c">! Check if OutletWaterTemp is below the minimum condenser loop temp and warn user</span>
<a name="ln-6289"></a>   <span class="n">LoopMinTemp</span> <span class="o">=</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">MinTemp</span>
<a name="ln-6290"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">OutletWaterTemp</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">LoopMinTemp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6291"></a><span class="k">     </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTempErrorCount</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTempErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6292"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">CharLowOutletTemp</span><span class="p">,</span><span class="n">LowTempFmt</span><span class="p">)</span> <span class="n">LoopMinTemp</span>
<a name="ln-6293"></a>     <span class="k">WRITE</span><span class="p">(</span><span class="n">CharErrOut</span><span class="p">,</span><span class="n">LowTempFmt</span><span class="p">)</span> <span class="n">OutletWaterTemp</span>
<a name="ln-6294"></a>     <span class="n">CharErrOut</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">CharErrOut</span><span class="p">)</span>
<a name="ln-6295"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTempErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6296"></a><span class="k">       CALL </span><span class="n">ShowWarningError</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-6297"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;Cooling tower water outlet temperature (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharErrOut</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; C) is &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6298"></a>                               <span class="s1">&#39;below the specified minimum condenser loop temp of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">CharLowOutletTemp</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-6299"></a>       <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6300"></a>     <span class="k">ELSE</span>
<a name="ln-6301"></a><span class="k">       CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-6302"></a>          <span class="s1">&#39;&quot; Cooling tower water outlet temperature is below the specified minimum condenser loop temp error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-6303"></a>          <span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTempErrorIndex</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">)</span>
<a name="ln-6304"></a>     <span class="k">END IF</span>
<a name="ln-6305"></a><span class="k">   END IF</span>
<a name="ln-6306"></a>
<a name="ln-6307"></a>   <span class="c">! Check if water mass flow rate is small (e.g. no flow) and warn user</span>
<a name="ln-6308"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">WaterMassFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterMassFlowRate</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">MassFlowTolerance</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6309"></a><span class="k">     </span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SmallWaterMassFlowErrorCount</span> <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SmallWaterMassFlowErrorCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6310"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SmallWaterMassFlowErrorCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6311"></a><span class="k">       CALL </span><span class="n">ShowWarningError</span> <span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-6312"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;Cooling tower water mass flow rate near zero.&#39;</span><span class="p">)</span>
<a name="ln-6313"></a>       <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6314"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Actual Mass flow = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-6315"></a>     <span class="k">ELSE</span>
<a name="ln-6316"></a><span class="k">       CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">TowerType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-6317"></a>          <span class="s1">&#39;&quot;  Cooling tower water mass flow rate near zero error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-6318"></a>          <span class="p">,</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SmallWaterMassFlowErrorIndex</span><span class="p">,</span> <span class="n">WaterMassFlowRate</span><span class="p">,</span> <span class="n">WaterMassFlowRate</span><span class="p">)</span>
<a name="ln-6319"></a>     <span class="n">ENDIF</span>
<a name="ln-6320"></a>   <span class="k">END IF</span>
<a name="ln-6321"></a>
<a name="ln-6322"></a>   <span class="c">! Check if water mass flow rate is lower than loop minimum and warn user</span>
<a name="ln-6323"></a><span class="c">!   IF(WaterMassFlowRate .LT. LoopMassFlowRateMinAvail)THEN</span>
<a name="ln-6324"></a><span class="c">!     SimpleTower(TowerNum)%WMFRLessThanMinAvailErrCount = SimpleTower(TowerNum)%WMFRLessThanMinAvailErrCount + 1</span>
<a name="ln-6325"></a><span class="c">!     IF (SimpleTower(TowerNum)%WMFRLessThanMinAvailErrCount &lt; 2) THEN</span>
<a name="ln-6326"></a><span class="c">!       CALL ShowWarningError (TRIM(SimpleTower(TowerNum)%TowerType)//&#39; &quot;&#39;//TRIM(SimpleTower(TowerNum)%Name)//&#39;&quot;&#39;)</span>
<a name="ln-6327"></a><span class="c">!       CALL ShowContinueError (&#39;Cooling tower water mass flow below loop minimum.&#39;)</span>
<a name="ln-6328"></a><span class="c">!       CALL ShowContinueErrorTimeStamp(&#39; &#39;)</span>
<a name="ln-6329"></a><span class="c">!       CALL ShowContinueError(&#39;Actual Mass flow  = &#39;//TRIM(TrimSigDigits(WaterMassFlowRate,2)))</span>
<a name="ln-6330"></a><span class="c">!       CALL ShowContinueError(&#39;Loop Minimum flow = &#39;//TRIM(TrimSigDigits(LoopMassFlowRateMinAvail,2)))</span>
<a name="ln-6331"></a><span class="c">!     ELSE</span>
<a name="ln-6332"></a><span class="c">!       CALL ShowRecurringWarningErrorAtEnd(TRIM(SimpleTower(TowerNum)%TowerType)//&#39; &quot;&#39;//TRIM(SimpleTower(TowerNum)%Name)//&amp;</span>
<a name="ln-6333"></a><span class="c">!          &#39;&quot; Cooling tower water mass flow rate below loop minimum error continues...&#39; &amp;</span>
<a name="ln-6334"></a><span class="c">!          , SimpleTower(TowerNum)%WMFRLessThanMinAvailErrIndex, WaterMassFlowRate, WaterMassFlowRate)</span>
<a name="ln-6335"></a><span class="c">!     ENDIF</span>
<a name="ln-6336"></a><span class="c">!   END IF</span>
<a name="ln-6337"></a>
<a name="ln-6338"></a>   <span class="c">! Check if water mass flow rate is greater than loop maximum and warn user</span>
<a name="ln-6339"></a><span class="c">!   IF(WaterMassFlowRate .GT. LoopMassFlowRateMaxAvail)THEN</span>
<a name="ln-6340"></a><span class="c">!     SimpleTower(TowerNum)%WMFRGreaterThanMaxAvailErrCount = SimpleTower(TowerNum)%WMFRGreaterThanMaxAvailErrCount + 1</span>
<a name="ln-6341"></a><span class="c">!     IF (SimpleTower(TowerNum)%WMFRGreaterThanMaxAvailErrCount &lt; 2) THEN</span>
<a name="ln-6342"></a><span class="c">!       CALL ShowWarningError (TRIM(SimpleTower(TowerNum)%TowerType)//&#39; &quot;&#39;//TRIM(SimpleTower(TowerNum)%Name)//&#39;&quot;&#39;)</span>
<a name="ln-6343"></a><span class="c">!       CALL ShowContinueError (&#39;Cooling Tower water mass flow above loop maximum.&#39;)</span>
<a name="ln-6344"></a><span class="c">!       CALL ShowContinueErrorTimeStamp(&#39; &#39;)</span>
<a name="ln-6345"></a><span class="c">!       CALL ShowContinueError(&#39;Actual Mass flow=&#39;//TRIM(TrimSigDigits(WaterMassFlowRate,2)))</span>
<a name="ln-6346"></a><span class="c">!       CALL ShowContinueError(&#39;Loop Maximum flow = &#39;//TRIM(TrimSigDigits(LoopMassFlowRateMaxAvail,2)))</span>
<a name="ln-6347"></a><span class="c">!     ELSE</span>
<a name="ln-6348"></a><span class="c">!       CALL ShowRecurringWarningErrorAtEnd(TRIM(SimpleTower(TowerNum)%TowerType)//&#39; &quot;&#39;//TRIM(SimpleTower(TowerNum)%Name)//&amp;</span>
<a name="ln-6349"></a><span class="c">!          &#39;&quot; Cooling tower water mass flow rate above loop maximum error continues...&#39; &amp;</span>
<a name="ln-6350"></a><span class="c">!          , SimpleTower(TowerNum)%WMFRGreaterThanMaxAvailErrIndex, WaterMassFlowRate, WaterMassFlowRate)</span>
<a name="ln-6351"></a><span class="c">!     ENDIF</span>
<a name="ln-6352"></a><span class="c">!   END IF</span>
<a name="ln-6353"></a>
<a name="ln-6354"></a><span class="k">RETURN</span>
<a name="ln-6355"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateTowers</span>
<a name="ln-6356"></a><span class="c">! End of Record Keeping subroutines for the Tower Module</span>
<a name="ln-6357"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6358"></a>
<a name="ln-6359"></a><span class="c">! Beginning of Reporting subroutines for the Tower Module</span>
<a name="ln-6360"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6361"></a>
<a name="ln-6362"></a><span class="k">SUBROUTINE </span><span class="n">ReportTowers</span><span class="p">(</span><span class="n">RunFlag</span><span class="p">,</span> <span class="n">TowerNum</span><span class="p">)</span>
<a name="ln-6363"></a>
<a name="ln-6364"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6365"></a>          <span class="c">!       AUTHOR:          Dan Fisher</span>
<a name="ln-6366"></a>          <span class="c">!       DATE WRITTEN:    October 1998</span>
<a name="ln-6367"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6368"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6369"></a>
<a name="ln-6370"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6371"></a>          <span class="c">! This subroutine updates the report variables for the tower.</span>
<a name="ln-6372"></a>
<a name="ln-6373"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6374"></a>          <span class="c">! na</span>
<a name="ln-6375"></a>
<a name="ln-6376"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6377"></a>          <span class="c">! na</span>
<a name="ln-6378"></a>
<a name="ln-6379"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6380"></a>          <span class="c">! na</span>
<a name="ln-6381"></a>
<a name="ln-6382"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6383"></a>
<a name="ln-6384"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6385"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RunFlag</span>
<a name="ln-6386"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TowerNum</span>
<a name="ln-6387"></a>
<a name="ln-6388"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6389"></a>          <span class="c">! na</span>
<a name="ln-6390"></a>
<a name="ln-6391"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6392"></a>          <span class="c">! na</span>
<a name="ln-6393"></a>
<a name="ln-6394"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6395"></a>          <span class="c">! na</span>
<a name="ln-6396"></a>
<a name="ln-6397"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6398"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-6399"></a>
<a name="ln-6400"></a>  <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-6401"></a>
<a name="ln-6402"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">RunFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6403"></a><span class="k">    </span><span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6404"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>        <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6405"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>      <span class="o">=</span> <span class="n">WaterMassFlowRate</span>
<a name="ln-6406"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Qactual</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6407"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPower</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6408"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanEnergy</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6409"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirFlowRatio</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6410"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterAmountUsed</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6411"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span>       <span class="o">=</span> <span class="n">BasinHeaterPower</span>
<a name="ln-6412"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span> <span class="o">=</span> <span class="n">BasinHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-6413"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanCyclingRatio</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6414"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span>         <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! added for fluid bypass</span>
<a name="ln-6415"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span>              <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6416"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SpeedSelected</span>          <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6417"></a>  <span class="k">ELSE</span>
<a name="ln-6418"></a><span class="k">    </span><span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6419"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>        <span class="o">=</span> <span class="n">OutletWaterTemp</span>
<a name="ln-6420"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterMassFlowRate</span>      <span class="o">=</span> <span class="n">WaterMassFlowRate</span>
<a name="ln-6421"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">Qactual</span>                <span class="o">=</span> <span class="n">Qactual</span>
<a name="ln-6422"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanPower</span>               <span class="o">=</span> <span class="n">CTFanPower</span>
<a name="ln-6423"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanEnergy</span>              <span class="o">=</span> <span class="n">CTFanPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-6424"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">AirFlowRatio</span>           <span class="o">=</span> <span class="n">AirFlowRateRatio</span>
<a name="ln-6425"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">WaterAmountUsed</span>        <span class="o">=</span> <span class="n">WaterUsage</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-6426"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterPower</span>       <span class="o">=</span> <span class="n">BasinHeaterPower</span>
<a name="ln-6427"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BasinHeaterConsumption</span> <span class="o">=</span> <span class="n">BasinHeaterPower</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-6428"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">FanCyclingRatio</span>        <span class="o">=</span> <span class="n">FanCyclingRatio</span>
<a name="ln-6429"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span>         <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">BypassFraction</span>   <span class="c">! added for fluid bypass</span>
<a name="ln-6430"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span>              <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">NumCellON</span>
<a name="ln-6431"></a>    <span class="n">SimpleTowerReport</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SpeedSelected</span>          <span class="o">=</span> <span class="n">SimpleTower</span><span class="p">(</span><span class="n">TowerNum</span><span class="p">)%</span><span class="n">SpeedSelected</span>
<a name="ln-6432"></a>  <span class="k">END IF</span>
<a name="ln-6433"></a>
<a name="ln-6434"></a>
<a name="ln-6435"></a><span class="k">RETURN</span>
<a name="ln-6436"></a><span class="k">END SUBROUTINE </span><span class="n">ReportTowers</span>
<a name="ln-6437"></a>
<a name="ln-6438"></a><span class="c">!     NOTICE</span>
<a name="ln-6439"></a><span class="c">!</span>
<a name="ln-6440"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-6441"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-6442"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-6443"></a><span class="c">!</span>
<a name="ln-6444"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-6445"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-6446"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-6447"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-6448"></a><span class="c">!</span>
<a name="ln-6449"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-6450"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-6451"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-6452"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-6453"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-6454"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-6455"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-6456"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-6457"></a><span class="c">!     permit others to do so.</span>
<a name="ln-6458"></a><span class="c">!</span>
<a name="ln-6459"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-6460"></a><span class="c">!</span>
<a name="ln-6461"></a>
<a name="ln-6462"></a><span class="k">END MODULE </span><span class="n">CondenserLoopTowers</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
