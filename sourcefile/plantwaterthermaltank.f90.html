<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>PlantWaterThermalTank.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>PlantWaterThermalTank.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.8% of total for source files.">6934 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/PlantWaterThermalTank.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">PlantWaterThermalTank.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/waterthermaltanks.html">WaterThermalTanks</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html#src">PlantWaterThermalTank.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~plantwaterthermaltank.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileplantwaterthermaltankf90EfferentGraph" width="641pt" height="1346pt"
 viewBox="0.00 0.00 641.00 1346.10" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph" class="graph" transform="scale(.2295 .2295) rotate(0) translate(4 5862.4481)">
<title>sourcefile~~plantwaterthermaltank.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-5862.4481 2789.5564,-5862.4481 2789.5564,4 -4,4"/>
<!-- sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~plantwaterthermaltank.f90</title>
<polygon fill="none" stroke="#000000" points="2785.4331,-2997.4535 2643.9268,-2997.4535 2643.9268,-2975.4426 2785.4331,-2975.4426 2785.4331,-2997.4535"/>
<text text-anchor="middle" x="2714.6799" y="-2983.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantWaterThermalTank.f90</text>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-3249.4535 528.0262,-3249.4535 528.0262,-3227.4426 643.4123,-3227.4426 643.4123,-3249.4535"/>
<text text-anchor="middle" x="585.7192" y="-3235.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge365" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-4186.4481C943.879,-4199.7547 992.6987,-4196.5334 1009.6252,-4200.4481 1185.3392,-4241.0861 1223.6838,-4273.5629 1400.2236,-4310.4481 1673.3214,-4367.5074 1754.6712,-4316.7591 2022.0432,-4396.4481 2097.7372,-4419.0083 2115.412,-4431.0651 2182.6875,-4472.4481 2199.9524,-4483.0682 2199.8899,-4492.8643 2218.6875,-4500.4481 2312.2719,-4538.2041 2348.3274,-4555.1065 2444.4712,-4524.4481"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2509.7606,-2978.4535 2379.1818,-2978.4535 2379.1818,-2956.4426 2509.7606,-2956.4426 2509.7606,-2978.4535"/>
<text text-anchor="middle" x="2444.4712" y="-2964.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M624.4183,-3227.3913C634.5684,-3223.6947 645.2474,-3219.055 654.4731,-3213.4481 739.7681,-3161.61 748.6906,-3131.4969 819.7932,-3061.4481 836.366,-3045.1209 837.2535,-3037.502 855.7932,-3023.4481 931.7869,-2965.8414 957.1337,-2958.9843 1045.6252,-2923.4481 1110.0471,-2897.5777 1127.8683,-2894.8039 1195.79,-2880.4481 1234.5976,-2872.2458 1519.5533,-2857.5777 1549.3953,-2831.4481 1594.5005,-2791.9539 1547.0638,-2747.5455 1585.3953,-2701.4481 1750.5333,-2502.8531 1863.0869,-2451.6815 2120.3654,-2474.4481"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1909.74,-3322.4535 1784.0928,-3322.4535 1784.0928,-3300.4426 1909.74,-3300.4426 1909.74,-3322.4535"/>
<text text-anchor="middle" x="1846.9164" y="-3308.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M755.1332,-3540.4481C813.371,-3624.1726 1587.4456,-3714.999 1666.4052,-3650.4481"/>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M640.3458,-3249.533C645.5359,-3252.1672 650.3788,-3255.4235 654.4731,-3259.4481 691.4596,-3295.8044 673.249,-3321.5287 690.4731,-3370.4481 717.3196,-3446.6962 711.2989,-3472.5285 755.1332,-3540.4481"/>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1666.4052,-3650.4481C1771.9596,-3559.9131 1825.3339,-3391.8959 1841.4914,-3332.732"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1844.9718,-3333.2624 1844.1556,-3322.6991 1838.2062,-3331.4658 1844.9718,-3333.2624"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~plantsolarcollectors.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/plantsolarcollectors.f90.html" xlink:title="PlantSolarCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2343.1468,-4288.4535 2218.8674,-4288.4535 2218.8674,-4266.4426 2343.1468,-4266.4426 2343.1468,-4288.4535"/>
<text text-anchor="middle" x="2281.0071" y="-4274.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantSolarCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M642.912,-3249.607C647.2836,-3252.2434 651.2428,-3255.4795 654.4731,-3259.4481 709.4167,-3326.9486 649.479,-3572.6718 690.4731,-3649.4481 725.3443,-3714.7567 783.214,-3690.0805 819.7932,-3754.4481 874.605,-3850.8992 826.2695,-3894.5111 855.7932,-4001.4481 879.4908,-4087.2824 874.2436,-4119.285 932.7092,-4186.4481"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M932.7092,-4186.4481C954.1156,-4211.5508 2090.8819,-4167.6458 2120.3654,-4182.4481"/>
</g>
<!-- sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~refrigeratedcase.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/refrigeratedcase.f90.html" xlink:title="RefrigeratedCase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2336.8136,-4002.4535 2225.2005,-4002.4535 2225.2005,-3980.4426 2336.8136,-3980.4426 2336.8136,-4002.4535"/>
<text text-anchor="middle" x="2281.0071" y="-3988.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RefrigeratedCase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M642.4669,-3249.518C646.9908,-3252.168 651.1046,-3255.4317 654.4731,-3259.4481 739.3511,-3360.6501 634.1469,-3434.9764 690.4731,-3554.4481 725.2395,-3628.1897 1127.3681,-4042.1201 1195.79,-4086.4481 1276.636,-4138.8251 1305.2713,-4142.216 1400.2236,-4158.4481 1465.5741,-4169.6197 1483.722,-4167.5317 1549.3953,-4158.4481 1656.4422,-4143.6418 1678.7611,-4119.3893 1783.415,-4092.4481 1855.4545,-4073.9028 1873.6263,-4069.7784 1946.4177,-4054.4481 2039.2574,-4034.8954 2147.2113,-4015.095 2214.8292,-4003.044"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2215.6834,-4006.4471 2224.9163,-4001.2504 2214.458,-3999.5551 2215.6834,-4006.4471"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.502,-3249.4535 721.7644,-3249.4535 721.7644,-3227.4426 788.502,-3227.4426 788.502,-3249.4535"/>
<text text-anchor="middle" x="755.1332" y="-3235.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M643.5481,-3238.4481C665.8524,-3238.4481 690.9304,-3238.4481 711.6543,-3238.4481"/>
<polygon fill="#1000ff" stroke="#1000ff" points="711.751,-3241.9482 721.7509,-3238.4481 711.7509,-3234.9482 711.751,-3241.9482"/>
</g>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~dxcoil.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/dxcoil.f90.html" xlink:title="DXCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2607.8976,-2997.4535 2545.5216,-2997.4535 2545.5216,-2975.4426 2607.8976,-2975.4426 2607.8976,-2997.4535"/>
<text text-anchor="middle" x="2576.7096" y="-2983.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DXCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M636.5708,-3227.4122C643.4323,-3223.9537 649.7292,-3219.4121 654.4731,-3213.4481 736.4217,-3110.4228 625.3814,-3033.872 690.4731,-2919.4481 721.5487,-2864.8207 1531.7837,-2260.2451 1585.3953,-2227.4481 1876.0062,-2049.6659 1948.429,-1831.6037 2281.0071,-1905.4481"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1747.4249,-2033.4535 1585.3854,-2033.4535 1585.3854,-2011.4426 1747.4249,-2011.4426 1747.4249,-2033.4535"/>
<text text-anchor="middle" x="1666.4052" y="-2019.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.0683,-3227.3597C643.7759,-3223.9071 649.8955,-3219.381 654.4731,-3213.4481 707.5054,-3144.7151 649.4196,-2900.9415 690.4731,-2824.4481 690.4731,-2824.4481 1045.6252,-2538.4481 1045.6252,-2538.4481 1095.7371,-2499.4061 1122.4046,-2503.8077 1159.79,-2452.4481 1188.576,-2412.9023 1166.8181,-2387.8577 1195.79,-2348.4481 1262.6963,-2257.4377 1307.5665,-2262.0545 1400.2236,-2197.4481 1486.7401,-2137.1233 1592.0748,-2069.5591 1640.1769,-2039.0195"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1642.1724,-2041.8986 1648.7438,-2033.5879 1638.4241,-2035.9867 1642.1724,-2041.8986"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1329.0063,-1802.4535 1231.0073,-1802.4535 1231.0073,-1780.4426 1329.0063,-1780.4426 1329.0063,-1802.4535"/>
<text text-anchor="middle" x="1280.0068" y="-1788.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.6765,-3227.3843C644.2136,-3223.9266 650.1222,-3219.3925 654.4731,-3213.4481 711.2231,-3135.9146 667.7717,-2442.811 690.4731,-2349.4481 722.6694,-2217.0365 770.5932,-2198.5259 819.7932,-2071.4481 839.1299,-2021.5037 816.1526,-1992.4615 855.7932,-1956.4481 938.7996,-1881.0368 1008.2597,-1964.9172 1102.7076,-1904.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-1904.4481C1125.53,-1889.0678 1139.2491,-1898.7643 1159.79,-1880.4481 1184.1483,-1858.728 1170.2803,-1836.8034 1195.79,-1816.4481 1203.2223,-1810.5175 1212.0292,-1805.9928 1221.1005,-1802.541"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1222.2569,-1805.8447 1230.6029,-1799.3182 1220.0086,-1799.2156 1222.2569,-1805.8447"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2174.0962,-3850.4535 2066.6346,-3850.4535 2066.6346,-3828.4426 2174.0962,-3828.4426 2174.0962,-3850.4535"/>
<text text-anchor="middle" x="2120.3654" y="-3836.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-3878.4481C1808.484,-3885.6596 1844.1162,-3865.0735 1984.2305,-3840.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3540.4481C880.9592,-3735.4108 976.7677,-3743.82 1195.79,-3820.4481 1344.9852,-3872.6461 1392.8389,-3836.6777 1549.3953,-3858.4481 1601.651,-3865.7146 1613.6523,-3877.669 1666.4052,-3878.4481"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node58"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1910.4191,-4688.4535 1783.4137,-4688.4535 1783.4137,-4666.4426 1910.4191,-4666.4426 1910.4191,-4688.4535"/>
<text text-anchor="middle" x="1846.9164" y="-4674.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M643.0625,-3249.4867C647.4031,-3252.1479 651.3139,-3255.4226 654.4731,-3259.4481 698.2396,-3315.2154 672.7035,-3827.8206 690.4731,-3896.4481 732.7917,-4059.8855 768.7273,-4093.8031 855.7932,-4238.4481 921.6239,-4347.8143 1088.9903,-4631.5304 1195.79,-4701.4481 1227.8929,-4722.4646 1242.9478,-4710.5022 1280.0068,-4720.4481"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge366" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2461.82,-2978.5747C2477.3932,-2989.6419 2499.3349,-3008.1609 2509.6157,-3030.4481 2559.7915,-3139.2208 2462.1806,-4141.5509 2576.7096,-4106.4481"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2509.8156,-2976.8367C2518.5085,-2978.0857 2527.2193,-2979.3373 2535.3468,-2980.5051"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2534.8883,-2983.9751 2545.2845,-2981.9329 2535.8839,-2977.0462 2534.8883,-2983.9751"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge367" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1872.1821,-3322.5953C1884.3137,-3328.5274 1898.7194,-3336.4538 1910.4177,-3345.4481 1948.512,-3374.7368 1936.2162,-3422.5434 1984.2305,-3424.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2444.4712,-4106.4481C2498.666,-4129.1889 2519.6425,-4120.5041 2576.7096,-4106.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-3424.4481C2035.9219,-3426.4986 2011.2815,-3356.5739 2058.0432,-3334.4481 2108.1181,-3310.7546 2138.8176,-3300.6204 2182.6875,-3334.4481 2216.714,-3360.6856 2350.4354,-4050.6439 2379.3267,-4082.4481 2400.0738,-4105.287 2416.0191,-4094.5092 2444.4712,-4106.4481"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1882.0427,-3300.4017C1891.6139,-3296.6611 1901.7305,-3291.9965 1910.4177,-3286.4481 2069.9783,-3184.5383 2047.0707,-3072.4034 2218.6875,-2992.4481 2265.5491,-2970.6155 2323.6197,-2964.5869 2369.133,-2963.9017"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2369.2577,-2967.4011 2379.2338,-2963.8334 2369.2103,-2960.4012 2369.2577,-2967.4011"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1984.2305,-3424.4481C2024.3279,-3426.0387 2022.6486,-3391.3572 2058.0432,-3372.4481 2084.223,-3358.4618 2106.0392,-3322.4527 2120.3654,-3348.4481"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-4040.4535 344.7839,-4040.4535 344.7839,-4018.4426 453.3838,-4018.4426 453.3838,-4040.4535"/>
<text text-anchor="middle" x="399.0839" y="-4026.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge368" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M420.0521,-4040.4858C437.9977,-4050.752 463.61,-4067.4495 480.9653,-4087.4481 503.8951,-4113.8702 500.224,-4126.7295 516.9653,-4157.4481 742.086,-4570.52 698.2161,-4757.25 1045.6252,-5074.4481 1169.9761,-5187.9852 2327.4869,-5778.5616 2444.4712,-5657.4481"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M420.8983,-4040.5926C444.3018,-4052.3193 482.7314,-4070.9169 516.9653,-4084.4481 576.7674,-4108.0851 603.9217,-4089.7046 654.4731,-4129.4481 834.0709,-4270.6473 1029.1067,-4847.2135 1195.79,-5003.4481 1270.9156,-5073.8643 1300.3291,-5087.4807 1400.2236,-5112.4481 1592.9236,-5160.6109 1649.6918,-5074.8816 1846.9164,-5098.4481"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1524.1994,-4460.4535 1425.4195,-4460.4535 1425.4195,-4438.4426 1524.1994,-4438.4426 1524.1994,-4460.4535"/>
<text text-anchor="middle" x="1474.8094" y="-4446.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M1102.7076,-4452.4481C1210.3732,-4479.0677 1340.9754,-4468.6356 1415.3327,-4458.8748"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1416.0033,-4462.3161 1425.4433,-4457.5059 1415.0641,-4455.3794 1416.0033,-4462.3161"/>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M453.4222,-4037.6327C506.1893,-4046.7302 587.8598,-4063.8879 654.4731,-4091.4481 697.1512,-4109.1054 981.4252,-4270.87 1009.6252,-4307.4481 1043.8827,-4351.8831 1008.1677,-4386.6751 1045.6252,-4428.4481 1063.9984,-4448.938 1077.2255,-4442.0524 1102.7076,-4452.4481"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1159.8726,-1992.4535 1045.5427,-1992.4535 1045.5427,-1970.4426 1159.8726,-1970.4426 1159.8726,-1992.4535"/>
<text text-anchor="middle" x="1102.7076" y="-1978.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M400.273,-4018.3817C408.3146,-3943.2106 455.195,-3499.6535 480.9653,-3137.4481 486.5869,-3058.4356 483.5772,-2497.2798 516.9653,-2425.4481 561.4347,-2329.776 596.9993,-2312.3695 690.4731,-2263.4481 716.5246,-2249.8135 728.5749,-2262.0669 755.1332,-2249.4481"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M755.1332,-2249.4481C793.2494,-2230.1362 1008.0029,-2017.7054 1045.6252,-1997.4481 1046.1633,-1997.1584 1046.7071,-1996.8735 1047.2561,-1996.5934"/>
<polygon fill="#0020ff" stroke="#0020ff" points="1048.8104,-1999.7325 1056.5164,-1992.4615 1045.9581,-1993.34 1048.8104,-1999.7325"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M453.2371,-4022.4208C463.7895,-4018.6562 473.7889,-4012.9784 480.9653,-4004.4481 564.0088,-3905.7374 435.8884,-3816.7801 516.9653,-3716.4481 537.3078,-3691.2745 572.8493,-3722.1447 585.7192,-3692.4481"/>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M585.7192,-3692.4481C656.7143,-3528.631 726.427,-3324.4175 748.1934,-3259.3647"/>
<polygon fill="#1000ff" stroke="#1000ff" points="751.6376,-3260.1003 751.4806,-3249.5066 744.997,-3257.8859 751.6376,-3260.1003"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-2183.4535 536.1602,-2183.4535 536.1602,-2161.4426 635.2783,-2161.4426 635.2783,-2183.4535"/>
<text text-anchor="middle" x="585.7192" y="-2169.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge360" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M400.3244,-4018.3852C408.7044,-3943.2371 457.4121,-3499.8044 480.9653,-3137.4481 484.3551,-3085.2976 486.1695,-2239.671 516.9653,-2197.4481 519.8538,-2193.4877 523.434,-2190.1533 527.4317,-2187.3461"/>
<polygon fill="#ff0031" stroke="#ff0031" points="529.2451,-2190.3404 536.136,-2182.2926 525.7305,-2184.2867 529.2451,-2190.3404"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1528.5351,-1347.4535 1421.0838,-1347.4535 1421.0838,-1325.4426 1528.5351,-1325.4426 1528.5351,-1347.4535"/>
<text text-anchor="middle" x="1474.8094" y="-1333.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M400.2477,-4018.3798C408.1229,-3943.1967 454.104,-3499.5742 480.9653,-3137.4481 486.2012,-3066.8622 469.4976,-2553.9513 516.9653,-2501.4481 562.6595,-2450.9065 752.8836,-2466.3131 819.7932,-2453.4481 971.9427,-2424.1935 1054.8734,-2490.456 1159.79,-2376.4481 1237.5938,-2291.9024 1120.3363,-2207.0974 1195.79,-2120.4481 1221.349,-2091.0968 1261.3178,-2130.5872 1280.0068,-2096.4481"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2164.15,-4956.4535 2076.5807,-4956.4535 2076.5807,-4934.4426 2164.15,-4934.4426 2164.15,-4956.4535"/>
<text text-anchor="middle" x="2120.3654" y="-4942.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge369" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2127.6339,-4956.8606C2147.6435,-4987.0663 2206.9966,-5068.8077 2281.0071,-5098.4481"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M2125.5101,-4934.2832C2137.8225,-4906.9954 2168.9772,-4834.4661 2182.6875,-4770.4481 2203.6959,-4672.353 2168.5516,-4407.3411 2218.6875,-4320.4481 2225.1029,-4309.3293 2235.6924,-4300.4361 2246.3379,-4293.6886"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2248.3244,-4296.5819 2255.2029,-4288.5235 2244.8004,-4290.5336 2248.3244,-4296.5819"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M2125.6205,-4934.306C2138.1779,-4907.0691 2169.8357,-4834.6439 2182.6875,-4770.4481 2212.3053,-4622.5047 2173.6753,-4236.4562 2218.6875,-4092.4481 2228.4423,-4061.2395 2250.0512,-4029.9112 2265.0689,-4010.6045"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2267.9363,-4012.6225 2271.4388,-4002.6234 2262.4652,-4008.2559 2267.9363,-4012.6225"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-4844.4535 358.7923,-4844.4535 358.7923,-4822.4426 439.3754,-4822.4426 439.3754,-4844.4535"/>
<text text-anchor="middle" x="399.0839" y="-4830.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge370" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-5706.4481C985.0561,-5724.7018 993.4863,-5740.6088 1045.6252,-5759.4481 1146.8592,-5796.0267 1172.3671,-5820.4481 1280.0068,-5820.4481 1280.0068,-5820.4481 1280.0068,-5820.4481 1474.8094,-5820.4481 1640.1903,-5820.4481 1682.7834,-5840.726 1846.9164,-5820.4481"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M755.1332,-5592.4481C988.4935,-5576.7497 1046.1191,-5630.4481 1280.0068,-5630.4481 1280.0068,-5630.4481 1280.0068,-5630.4481 1474.8094,-5630.4481 1718.2582,-5630.4481 1807.3404,-5721.2087 2022.0432,-5606.4481 2128.5017,-5549.545 2130.0391,-5496.0737 2182.6875,-5387.4481 2299.5363,-5146.3623 2304.6698,-5071.5549 2343.3267,-4806.4481 2357.8708,-4706.7053 2321.4092,-3074.9449 2379.3267,-2992.4481 2381.5454,-2989.2878 2384.2215,-2986.5269 2387.2068,-2984.115"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2389.2968,-2986.9296 2395.7291,-2978.5107 2385.4507,-2981.0808 2389.2968,-2986.9296"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M439.6149,-4836.6198C454.7547,-4839.904 470.7373,-4846.2695 480.9653,-4858.4481 565.0601,-4958.5797 419.0101,-5063.8279 516.9653,-5150.4481 562.7475,-5190.9325 608.3477,-5190.5409 654.4731,-5150.4481 741.1903,-5075.0723 635.2863,-4995.2241 690.4731,-4894.4481 931.9377,-4453.5123 1311.8792,-4601.5233 1549.3953,-4158.4481 1611.5911,-4042.4246 1533.9669,-3985.6293 1585.3953,-3864.4481 1630.086,-3759.1426 1694.8119,-3766.0326 1747.415,-3664.4481 1807.9399,-3547.5655 1835.5974,-3389.2741 1844.0029,-3332.6618"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1847.4709,-3333.1341 1845.4313,-3322.7374 1840.5423,-3332.1368 1847.4709,-3333.1341"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M585.7192,-5592.4481C648.1881,-5634.4837 680.256,-5600.37 755.1332,-5592.4481"/>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M755.1332,-5592.4481C1074.1892,-5558.6923 1767.1811,-5105.8565 2058.0432,-4970.4481 2065.5569,-4966.9501 2073.7038,-4963.4669 2081.5528,-4960.2601"/>
<polygon fill="#ffc500" stroke="#ffc500" points="2082.9389,-4963.4752 2090.9164,-4956.5031 2080.3322,-4956.9786 2082.9389,-4963.4752"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M932.7092,-5706.4481C1282.0064,-5802.0537 1389.1234,-5773.1363 1747.415,-5720.4481 1822.2583,-5709.4421 1838.1021,-5693.6538 1910.4177,-5671.4481 1960.1202,-5656.1861 1976.54,-5661.6018 2022.0432,-5636.4481 2104.1662,-5591.0513 2127.2586,-5575.1626 2182.6875,-5499.4481 2403.515,-5197.8031 2428.4386,-5089.3655 2509.6157,-4724.4481 2529.1836,-4636.484 2570.6074,-3200.9951 2576.1029,-3007.8745"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2579.6027,-3007.9282 2576.3881,-2997.8329 2572.6055,-3007.7294 2579.6027,-3007.9282"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M585.7192,-5592.4481C720.3949,-5683.072 778.4613,-5655.8731 932.7092,-5706.4481"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2021.8569,-4496.4535 1946.6041,-4496.4535 1946.6041,-4474.4426 2021.8569,-4474.4426 2021.8569,-4496.4535"/>
<text text-anchor="middle" x="1984.2305" y="-4482.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M585.7192,-5592.4481C628.5549,-5620.1247 965.5532,-5442.1102 1009.6252,-5416.4481 1027.1419,-5406.2485 1028.5135,-5399.3132 1045.6252,-5388.4481 1179.7292,-5303.2983 1265.0385,-5350.5314 1364.2236,-5226.4481 1404.8757,-5175.5912 1363.1317,-5137.957 1400.2236,-5084.4481 1518.3333,-4914.0627 1612.4263,-4935.6825 1783.415,-4818.4481 1839.6385,-4779.8998 1870.0922,-4787.4108 1910.4177,-4732.4481 1962.8925,-4660.9262 1978.3579,-4552.0931 1982.6664,-4506.5964"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1986.1688,-4506.7181 1983.5372,-4496.4554 1979.1944,-4506.1193 1986.1688,-4506.7181"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge361" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M439.4499,-4830.9999C454.9482,-4827.858 471.2366,-4821.4028 480.9653,-4808.4481 568.0795,-4692.4471 432.9213,-2315.6923 516.9653,-2197.4481 519.8051,-2193.4527 523.3513,-2190.0937 527.3263,-2187.2702"/>
<polygon fill="#ff0031" stroke="#ff0031" points="529.1366,-2190.2661 535.999,-2182.194 525.6006,-2184.2248 529.1366,-2190.2661"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5592.4481C638.7358,-5623.3806 638.8081,-5535.5888 690.4731,-5502.4481 788.5107,-5439.5614 818.937,-5427.3873 932.7092,-5402.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.641,-4836.1639C454.9748,-4839.3651 471.0908,-4845.7921 480.9653,-4858.4481 578.1455,-4983.0027 422.265,-5441.9978 516.9653,-5568.4481 536.3666,-5594.354 558.5344,-5574.8836 585.7192,-5592.4481"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge371" class="edge">
<title>sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2444.4712,-4524.4481C2473.8682,-4515.0739 2489.898,-4524.1814 2509.6157,-4500.4481 2566.3722,-4432.1328 2491.7927,-4132.4749 2576.7096,-4106.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2282.7106,-4288.6309C2291.3129,-4341.1919 2333.9951,-4559.6768 2444.4712,-4524.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-4118.4535 350.2841,-4118.4535 350.2841,-4096.4426 447.8836,-4096.4426 447.8836,-4118.4535"/>
<text text-anchor="middle" x="399.0839" y="-4104.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge372" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.3208,-4118.631C411.7992,-4171.3751 456.5435,-4400.649 480.9653,-4590.4481 492.5812,-4680.7227 476.3533,-4916.9919 516.9653,-4998.4481 553.6841,-5072.0956 615.4625,-5049.9884 654.4731,-5122.4481 704.9784,-5216.2582 654.7344,-5259.0795 690.4731,-5359.4481 728.3905,-5465.9351 763.9835,-5480.1501 819.7932,-5578.4481 836.2904,-5607.5047 828.6689,-5624.9361 855.7932,-5644.4481 878.4922,-5660.7767 1819.0067,-5822.1568 1846.9164,-5820.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-5772.4481C2365.6945,-5745.6429 2382.6303,-5721.2147 2444.4712,-5657.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1846.9164,-5820.4481C1944.7136,-5808.0412 1960.6561,-5767.7444 2058.0432,-5752.4481 2112.7697,-5743.8523 2127.5687,-5746.8988 2182.6875,-5752.4481 2227.0557,-5756.915 2238.4933,-5785.9045 2281.0071,-5772.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M585.7192,-4832.4481C607.0765,-4867.618 626.4879,-4864.2838 654.4731,-4894.4481 753.8723,-5001.5871 731.1738,-5078.1003 855.7932,-5154.4481 1297.8469,-5425.2711 1526.5642,-5327.9509 2022.0432,-5175.4481 2095.1874,-5152.9351 2137.4118,-5175.1491 2182.6875,-5113.4481 2257.1173,-5012.0163 2166.7217,-4663.0245 2218.6875,-4548.4481 2234.8253,-4512.8667 2274.7907,-4525.0204 2281.0071,-4486.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2281.0071,-4486.4481C2291.8791,-4420.0347 2328.2886,-4414.0437 2343.3267,-4348.4481 2360.1663,-4274.9938 2335.8192,-3053.9803 2379.3267,-2992.4481 2381.5559,-2989.2952 2384.24,-2986.5399 2387.2311,-2984.1321"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2389.3218,-2986.9466 2395.7641,-2978.5354 2385.4826,-2981.0932 2389.3218,-2986.9466"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M585.7192,-4143.4481C739.2632,-4162.5504 1583.2998,-3721.7283 1666.4052,-3650.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M400.545,-4118.8978C409.622,-4188.8826 459.7811,-4559.1724 516.9653,-4656.4481 568.9203,-4744.8284 609.0536,-4746.1483 690.4731,-4808.4481 745.291,-4850.3931 777.55,-4839.8597 819.7932,-4894.4481 849.7282,-4933.1313 822.0387,-4963.0485 855.7932,-4998.4481 1048.1113,-5200.1388 1196.6826,-5080.8175 1474.8094,-5098.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M755.1332,-4908.4481C765.0254,-4916.864 845.7693,-5111.1895 855.7932,-5119.4481 923.0436,-5174.8549 959.9923,-5152.3382 1045.6252,-5168.4481 1295.088,-5215.3789 2022.9598,-5256.7326 2182.6875,-5059.4481 2234.4171,-4995.5553 2178.7169,-4392.2853 2218.6875,-4320.4481 2224.879,-4309.3204 2235.3087,-4300.457 2245.8824,-4293.7376"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2247.8301,-4296.6536 2254.7083,-4288.5949 2244.3059,-4290.6054 2247.8301,-4296.6536"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1540.3045,-775.4535 1409.3144,-775.4535 1409.3144,-753.4426 1540.3045,-753.4426 1540.3045,-775.4535"/>
<text text-anchor="middle" x="1474.8094" y="-761.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M425.9046,-4096.3145C444.9098,-4086.8658 469.0644,-4071.3329 480.9653,-4049.4481 526.8672,-3965.0382 498.0331,-3279.6477 516.9653,-3185.4481 560.6757,-2967.9623 579.7938,-2909.6998 690.4731,-2717.4481 854.0273,-2433.3519 1019.1126,-2444.5401 1159.79,-2148.4481 1194.8012,-2074.758 1140.461,-2028.4039 1195.79,-1968.4481 1248.5796,-1911.2441 1315.8534,-1981.4346 1364.2236,-1920.4481 1416.1362,-1854.9953 1390.6368,-1252.4364 1400.2236,-1169.4481 1417.3705,-1021.0164 1456.23,-845.0167 1469.9229,-785.3858"/>
<polygon fill="#73ff00" stroke="#73ff00" points="1473.3339,-786.1699 1472.1759,-775.6386 1466.5137,-784.5934 1473.3339,-786.1699"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="801.757,-1347.4535 708.5093,-1347.4535 708.5093,-1325.4426 801.757,-1325.4426 801.757,-1347.4535"/>
<text text-anchor="middle" x="755.1332" y="-1333.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M426.0822,-4096.4094C445.178,-4087.0093 469.3682,-4071.4954 480.9653,-4049.4481 547.5434,-3922.8765 447.4305,-1600.4197 516.9653,-1475.4481 552.2438,-1412.0438 594.4815,-1428.2608 654.4731,-1387.4481 670.7915,-1376.3466 673.1264,-1370.8619 690.4731,-1361.4481 697.3903,-1357.6942 704.9925,-1354.2269 712.4785,-1351.1448"/>
<polygon fill="#41ff00" stroke="#41ff00" points="713.8193,-1354.3784 721.8383,-1347.454 711.2515,-1347.8664 713.8193,-1354.3784"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1909.6556,-2924.4535 1784.1771,-2924.4535 1784.1771,-2902.4426 1909.6556,-2902.4426 1909.6556,-2924.4535"/>
<text text-anchor="middle" x="1846.9164" y="-2910.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M445.1774,-4096.3127C457.1409,-4092.6372 469.7962,-4088.0276 480.9653,-4082.4481 615.8949,-4015.0445 645.1499,-3985.661 755.1332,-3882.4481"/>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M755.1332,-3882.4481C810.2943,-3837.772 807.8324,-3810.7784 855.7932,-3758.4481 997.8664,-3603.431 1029.5341,-3558.1882 1195.79,-3429.4481 1265.1684,-3375.725 1312.2245,-3397.1277 1364.2236,-3326.4481 1403.0621,-3273.6571 1361.0979,-3236.0264 1400.2236,-3183.4481 1446.3123,-3121.5128 1484.8912,-3136.867 1549.3953,-3094.4481 1565.8856,-3083.6037 1568.8891,-3079.2684 1585.3953,-3068.4481 1667.9152,-3014.3536 1769.3809,-2956.6047 1818.1127,-2929.3878"/>
<polygon fill="#00ff20" stroke="#00ff20" points="1819.8263,-2932.4397 1826.8585,-2924.5151 1816.4193,-2926.3247 1819.8263,-2932.4397"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M585.7192,-4143.4481C615.4695,-4147.7417 1018.9588,-4414.5767 1045.6252,-4428.4481 1070.0406,-4441.1485 1076.1059,-4445.3938 1102.7076,-4452.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M585.7192,-4832.4481C628.5537,-4902.9853 693.7433,-4853.2977 755.1332,-4908.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M755.1332,-4908.4481C819.3185,-4966.1098 787.1794,-5022.1339 855.7932,-5074.4481 1013.929,-5195.0178 1553.684,-5195.3061 1747.415,-5150.4481 1897.1527,-5115.7766 1913.0414,-5049.4183 2058.0432,-4998.4481 2084.8257,-4989.0336 2111.1109,-5011.2863 2120.3654,-4984.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M400.9123,-4118.6681C413.875,-4197.9816 492.0931,-4672.6833 516.9653,-4732.4481 537.6887,-4782.2436 557.7238,-4786.3469 585.7192,-4832.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M2120.3654,-4984.4481C2131.2386,-4957.6096 2164.978,-4988.3588 2182.6875,-4965.4481 2242.0605,-4888.6376 2190.2733,-4185.2793 2218.6875,-4092.4481 2228.2575,-4061.1823 2249.9107,-4029.8677 2264.9888,-4010.5797"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2267.8575,-4012.597 2271.3868,-4002.6073 2262.3981,-4008.2157 2267.8575,-4012.597"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="987.8473,-2297.4535 877.5712,-2297.4535 877.5712,-2275.4426 987.8473,-2275.4426 987.8473,-2297.4535"/>
<text text-anchor="middle" x="932.7092" y="-2283.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe6" stroke-dasharray="5,2" d="M755.1332,-2401.4481C777.9514,-2380.9794 793.144,-2392.5959 819.7932,-2377.4481 824.7913,-2374.6071 880.1523,-2329.4841 911.4556,-2303.8687"/>
<polygon fill="#00ffe6" stroke="#00ffe6" points="913.698,-2306.5562 919.2181,-2297.513 909.2634,-2301.14 913.698,-2306.5562"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1158.5244,-967.4535 1046.8908,-967.4535 1046.8908,-945.4426 1158.5244,-945.4426 1158.5244,-967.4535"/>
<text text-anchor="middle" x="1102.7076" y="-953.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M426.0347,-4096.3843C445.1063,-4086.9714 469.287,-4071.4524 480.9653,-4049.4481 568.7545,-3884.0358 443.9234,-2536.8808 516.9653,-2364.4481 550.8601,-2284.4316 613.757,-2302.2184 654.4731,-2225.4481 693.1074,-2152.603 664.2192,-2121.6129 690.4731,-2043.4481 742.0904,-1889.7703 963.7163,-1542.9266 1009.6252,-1387.4481 1047.0298,-1260.7712 1011.744,-1220.1124 1045.6252,-1092.4481 1056.9327,-1049.8417 1078.845,-1003.0385 1091.9865,-976.9492"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1095.273,-978.2097 1096.7108,-967.7129 1089.0409,-975.022 1095.273,-978.2097"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1524.3583,-3361.4535 1425.2606,-3361.4535 1425.2606,-3339.4426 1524.3583,-3339.4426 1524.3583,-3361.4535"/>
<text text-anchor="middle" x="1474.8094" y="-3347.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M755.1332,-3768.4481C1047.2847,-3650.6507 1363.777,-3430.337 1451.2713,-3367.547"/>
<polygon fill="#0083ff" stroke="#0083ff" points="1453.3962,-3370.3299 1459.4654,-3361.6457 1449.3053,-3364.6497 1453.3962,-3370.3299"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1548.0641,-3014.4535 1401.5548,-3014.4535 1401.5548,-2992.4426 1548.0641,-2992.4426 1548.0641,-3014.4535"/>
<text text-anchor="middle" x="1474.8094" y="-3000.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M755.1332,-3768.4481C839.5898,-3731.3239 959.0973,-3517.6364 1009.6252,-3440.4481 1027.9255,-3412.4919 1025.0051,-3400.7398 1045.6252,-3374.4481 1089.1506,-3318.9512 1221.2106,-3199.4014 1280.0068,-3160.4481"/>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M585.7192,-3768.4481C638.7528,-3714.9991 684.3575,-3794.1415 755.1332,-3768.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M426.0226,-4096.3779C445.0879,-4086.9616 469.2662,-4071.4414 480.9653,-4049.4481 561.7637,-3897.5546 447.9671,-2659.0528 516.9653,-2501.4481 551.0638,-2423.5609 608.8652,-2440.2048 654.4731,-2368.4481 680.9361,-2326.8129 653.6082,-2296.2315 690.4731,-2263.4481 712.4454,-2243.9085 732.9691,-2268.7698 755.1332,-2249.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M424.6165,-4096.4259C443.4726,-4086.8664 468.0225,-4071.14 480.9653,-4049.4481 548.6435,-3936.0206 456.0632,-3871.6533 516.9653,-3754.4481 535.9376,-3717.9363 569.3575,-3730.2019 585.7192,-3692.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M401.1053,-4118.6615C410.613,-4171.5433 451.6458,-4401.3437 480.9653,-4590.4481 498.5692,-4703.9888 463.0583,-4744.9817 516.9653,-4846.4481 555.5755,-4919.1219 605.5147,-4904.302 654.4731,-4970.4481 676.9481,-5000.8131 668.5849,-5016.6574 690.4731,-5047.4481 978.3159,-5452.3617 1169.6069,-5592.4481 1666.4052,-5592.4481 1666.4052,-5592.4481 1666.4052,-5592.4481 1846.9164,-5592.4481 2534.6728,-5592.4481 2499.1621,-4348.27 2509.6157,-4287.4481 2554.4225,-4026.7496 2573.3636,-3156.2561 2576.2982,-3008.004"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2579.8058,-3007.6414 2576.5015,-2997.575 2572.8071,-3007.5048 2579.8058,-3007.6414"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M405.6124,-4118.8598C422.1321,-4147.2264 467.7904,-4222.5279 516.9653,-4276.4481 765.61,-4549.0857 838.5095,-4662.2199 1195.79,-4754.4481 1284.2285,-4777.2775 1309.0057,-4770.7753 1400.2236,-4775.4481 1466.4353,-4778.8399 1483.4716,-4782.4883 1549.3953,-4775.4481 1569.7988,-4773.2691 1895.0488,-4711.0441 1910.4177,-4697.4481 1939.8678,-4671.3952 1968.7503,-4554.7018 1979.6633,-4506.4418"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1983.1232,-4507.0065 1981.8782,-4496.4851 1976.2902,-4505.4864 1983.1232,-4507.0065"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1725.7407,-3208.4535 1607.0696,-3208.4535 1607.0696,-3186.4426 1725.7407,-3186.4426 1725.7407,-3208.4535"/>
<text text-anchor="middle" x="1666.4052" y="-3194.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge347" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1474.8094,-3536.4481C1526.9607,-3449.2865 1535.2451,-3424.7761 1585.3953,-3336.4481 1609.5916,-3293.8318 1638.6736,-3244.3393 1654.5787,-3217.4138"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1657.7314,-3218.9586 1659.8089,-3208.5695 1651.7061,-3215.3955 1657.7314,-3218.9586"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M755.1332,-3882.4481C1026.5702,-3653.8054 1292.5882,-3840.9985 1474.8094,-3536.4481"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1524.9367,-3889.4535 1424.6822,-3889.4535 1424.6822,-3867.4426 1524.9367,-3867.4426 1524.9367,-3889.4535"/>
<text text-anchor="middle" x="1474.8094" y="-3875.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge354" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M446.7517,-4118.4664C484.2976,-4126.7016 538.0726,-4137.5204 585.7192,-4143.4481"/>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M585.7192,-4143.4481C638.3171,-4149.9917 640.3823,-4103.7764 690.4731,-4086.4481 837.7903,-4035.4854 1262.957,-4043.6112 1280.0068,-4034.4481"/>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M1280.0068,-4034.4481C1314.1242,-4015.7193 1331.5736,-4031.6314 1364.2236,-4010.4481 1409.5143,-3981.0634 1445.9361,-3927.4511 1463.4645,-3898.4142"/>
<polygon fill="#ff0062" stroke="#ff0062" points="1466.6089,-3899.972 1468.6701,-3889.5796 1460.578,-3896.4184 1466.6089,-3899.972"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge364" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M426.0471,-4096.3909C445.125,-4086.9813 469.3082,-4071.4637 480.9653,-4049.4481 529.1209,-3958.5021 457.11,-2281.1587 516.9653,-2197.4481 519.8164,-2193.4607 523.3705,-2190.1074 527.3507,-2187.2876"/>
<polygon fill="#ff0031" stroke="#ff0031" points="529.1618,-2190.2831 536.0307,-2182.2166 525.6307,-2184.239 529.1618,-2190.2831"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2327.6412,-1877.4535 2234.373,-1877.4535 2234.373,-1855.4426 2327.6412,-1855.4426 2327.6412,-1877.4535"/>
<text text-anchor="middle" x="2281.0071" y="-1863.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4642.4481C604.0839,-4667.6513 631.0124,-4635.904 654.4731,-4656.4481 691.2716,-4688.6718 656.2718,-4725.4801 690.4731,-4760.4481 733.3407,-4804.2765 762.7488,-4785.9872 819.7932,-4808.4481 835.9214,-4814.7984 839.2929,-4818.1393 855.7932,-4823.4481 1002.7441,-4870.7274 1042.3286,-4877.7308 1195.79,-4894.4481 1352.0636,-4911.4717 1392.507,-4912.3125 1549.3953,-4902.4481 1711.4485,-4892.2589 1781.6619,-4945.3775 1910.4177,-4846.4481 2052.1222,-4737.5696 2013.1348,-4645.416 2058.0432,-4472.4481 2112.2442,-4263.6893 2152.932,-4217.0659 2182.6875,-4003.4481 2190.7824,-3945.334 2185.4038,-1939.7696 2218.6875,-1891.4481 2220.8656,-1888.2859 2223.5148,-1885.5236 2226.4779,-1883.1106"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2228.5401,-1885.943 2234.9465,-1877.5044 2224.676,-1880.1061 2228.5401,-1885.943"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3768.4481C685.0016,-3668.3882 747.5857,-3675.5061 819.7932,-3554.4481 853.1456,-3498.5318 816.6576,-3464.4809 855.7932,-3412.4481 903.4063,-3349.1439 958.991,-3383.3627 1009.6252,-3322.4481 1039.8204,-3286.1223 1020.1701,-3262.2394 1045.6252,-3222.4481 1152.7616,-3054.973 1261.0569,-3078.3973 1364.2236,-2908.4481 1392.4557,-2861.9406 1383.323,-2843.1624 1400.2236,-2791.4481 1497.8526,-2492.7121 1626.8051,-2132.4805 1658.9215,-2043.209"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1662.255,-2044.2822 1662.3495,-2033.6878 1655.6688,-2041.9109 1662.255,-2044.2822"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.1949,-4100.558C460.1351,-4096.8496 472.0244,-4091.1624 480.9653,-4082.4481 586.3192,-3979.7646 477.2918,-3867.8806 585.7192,-3768.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M425.1608,-4096.3175C444.0443,-4086.7866 468.3788,-4071.1475 480.9653,-4049.4481 522.5256,-3977.7973 498.1855,-3759.1228 516.9653,-3678.4481 523.1578,-3651.8463 674.2359,-3240.4106 690.4731,-3218.4481 733.6656,-3160.0258 771.8515,-3173.0406 819.7932,-3118.4481 898.9292,-3028.3339 1327.8393,-2300.7251 1364.2236,-2186.4481 1419.5849,-2012.568 1376.9899,-1958.4435 1400.2236,-1777.4481 1421.0684,-1615.063 1458.1703,-1421.0221 1470.6114,-1357.6163"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1474.0771,-1358.1314 1472.5767,-1347.6434 1467.2092,-1356.7779 1474.0771,-1358.1314"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-3290.4535 517.2105,-3290.4535 517.2105,-3268.4426 654.2279,-3268.4426 654.2279,-3290.4535"/>
<text text-anchor="middle" x="585.7192" y="-3276.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M425.8622,-4096.2913C444.8457,-4086.8308 468.9918,-4071.2932 480.9653,-4049.4481 520.7984,-3976.7742 467.7952,-3371.1598 516.9653,-3304.4481 519.2873,-3301.2978 522.0463,-3298.5437 525.1035,-3296.136"/>
<polygon fill="#0066ff" stroke="#0066ff" points="527.2846,-3298.8945 533.7974,-3290.5378 523.4948,-3293.0091 527.2846,-3298.8945"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1348.4046,-1195.4535 1211.6091,-1195.4535 1211.6091,-1173.4426 1348.4046,-1173.4426 1348.4046,-1195.4535"/>
<text text-anchor="middle" x="1280.0068" y="-1181.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-2515.4481C688.3578,-2317.3859 733.8439,-2277.3024 819.7932,-2071.4481 840.2648,-2022.4172 825.1145,-2000.8293 855.7932,-1957.4481 953.4622,-1819.339 1077.0899,-1876.0083 1159.79,-1728.4481 1240.9995,-1583.5476 1150.5412,-1516.2719 1195.79,-1356.4481 1212.3704,-1297.8845 1248.3022,-1235.1248 1267.4312,-1204.1167"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1270.4523,-1205.8868 1272.7883,-1195.5527 1264.5177,-1202.1745 1270.4523,-1205.8868"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M425.9357,-4096.3313C444.9567,-4086.8912 469.1175,-4071.3617 480.9653,-4049.4481 532.682,-3953.7933 508.2848,-3179.8413 516.9653,-3071.4481 536.8421,-2823.2494 490.717,-2745.605 585.7192,-2515.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2515.4481C627.476,-2434.8699 687.5759,-2462.0491 755.1332,-2401.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2401.4481C777.9514,-2380.9794 800.6509,-2401.3899 819.7932,-2377.4481 894.843,-2283.5812 802.1745,-2217.005 855.7932,-2109.4481 898.6751,-2023.4287 942.8261,-2026.5571 1009.6252,-1957.4481 1026.0194,-1940.487 1025.3076,-1930.433 1045.6252,-1918.4481 1068.1244,-1905.1763 1081.0457,-1919.0464 1102.7076,-1904.4481"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.2287,-4118.8759C407.2741,-4187.0861 446.7737,-4540.1462 516.9653,-4618.4481 538.569,-4642.548 563.8388,-4618.5991 585.7192,-4642.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4642.4481C734.9887,-4805.1471 1332.8837,-4927.7504 1549.3953,-4884.4481 1566.392,-4881.0487 1568.6792,-4874.0325 1585.3953,-4869.4481 1698.6042,-4838.4005 1741.419,-4883.9312 1846.9164,-4832.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1846.9164,-4832.4481C1876.0328,-4814.7281 1889.1174,-4816.0574 1910.4177,-4789.4481 1915.7148,-4782.8307 2020.0246,-4513.6806 2022.0432,-4505.4481 2057.9156,-4359.152 2036.0077,-4317.4575 2058.0432,-4168.4481 2075.355,-4051.382 2104.5411,-3912.4657 2115.7712,-3860.4687"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2119.2407,-3860.9846 2117.9415,-3850.4697 2112.4,-3859.4998 2119.2407,-3860.9846"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412.0071,-4118.4792C507.1212,-4199.5515 1097.8197,-4701.0146 1195.79,-4734.4481 1266.6376,-4758.6256 1289.6077,-4740.481 1364.2236,-4734.4481 1413.8577,-4730.435 1429.6646,-4737.4621 1474.8094,-4716.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-4716.4481C1505.645,-4702.7821 1516.247,-4708.6753 1549.3953,-4702.4481 1601.4011,-4692.6782 1614.1709,-4688.9122 1666.4052,-4680.4481"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge373" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1487.7488,-753.105C1562.5164,-688.9491 1947.5374,-377.374 2281.0071,-461.4481"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1539.7701,-775.4944C1595.6829,-785.9355 1678.0653,-803.5622 1747.415,-827.4481 1822.991,-853.4784 1841.7899,-862.4661 1910.4177,-903.4481 1980.668,-945.3989 1990.2342,-967.6561 2058.0432,-1013.4481 2111.8138,-1049.7598 2131.1213,-1050.0686 2182.6875,-1089.4481 2200.1784,-1102.8053 2200.0672,-1111.7164 2218.6875,-1123.4481 2243.7994,-1139.2698 2269.0996,-1120.2608 2281.0071,-1147.4481"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2444.4712,-1943.4481C2538.363,-2132.7252 2570.5836,-2832.6679 2575.8885,-2964.8401"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2572.4066,-2965.3712 2576.2962,-2975.2262 2579.4012,-2965.0965 2572.4066,-2965.3712"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1526.869,-753.4036C1582.3375,-743.6082 1672.3213,-733.4039 1747.415,-751.4481 1958.5677,-802.1856 2017.7503,-832.1843 2182.6875,-973.4481 2239.3359,-1021.9658 2227.1504,-1057.8489 2281.0071,-1109.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2281.0071,-1109.4481C2302.1255,-1130.3034 2325.0422,-1110.0683 2343.3267,-1133.4481 2566.8242,-1419.2271 2283.2506,-1618.4424 2444.4712,-1943.4481"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge374" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2444.4712,-803.4481C2502.861,-810.1456 2549.1301,-751.5482 2576.7096,-803.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M801.9197,-1341.0059C914.494,-1349.2388 1203.055,-1353.6749 1364.2236,-1204.4481 1404.4568,-1167.196 1367.6431,-1130.5494 1400.2236,-1086.4481 1522.3678,-921.1122 1595.0309,-909.7071 1783.415,-827.4481 1851.5874,-797.6802 1872.5168,-797.9482 1946.4177,-789.4481 2121.6663,-769.2909 2167.3397,-777.3262 2343.3267,-789.4481 2388.6011,-792.5666 2399.3851,-798.2765 2444.4712,-803.4481"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M771.3429,-1347.4647C790.5351,-1359.8224 823.9278,-1379.2127 855.7932,-1387.4481 1002.1472,-1425.2721 1044.6308,-1395.4415 1195.79,-1396.4481 1270.6478,-1396.9466 1303.7877,-1440.623 1364.2236,-1396.4481 1406.7772,-1365.344 1360.7304,-1318.3559 1400.2236,-1283.4481 1522.2183,-1175.6177 1959.9022,-1176.0461 2120.3654,-1148.4481"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1330.1598,-4692.4535 1229.8539,-4692.4535 1229.8539,-4670.4426 1330.1598,-4670.4426 1330.1598,-4692.4535"/>
<text text-anchor="middle" x="1280.0068" y="-4678.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge375" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1284.4737,-4692.7578C1297.8733,-4725.5936 1340.5229,-4822.526 1400.2236,-4884.4481 1468.1236,-4954.8744 1501.3464,-4953.3874 1585.3953,-5003.4481 1671.7064,-5054.8562 1688.0647,-5080.8138 1783.415,-5112.4481 1952.603,-5168.5795 2009.6788,-5193.3817 2182.6875,-5150.4481 2230.6651,-5138.542 2231.9732,-5104.7154 2281.0071,-5098.4481"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1846.9164,-4600.4481C1997.8122,-4562.0316 2059.9426,-4596.2555 2182.6875,-4500.4481 2250.2819,-4447.6879 2237.722,-4408.4686 2281.0071,-4334.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1474.8094,-4602.4481C1490.8065,-4587.7156 1644.7522,-4640.4238 1666.4052,-4642.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1666.4052,-4642.4481C1748.4178,-4650.1151 1765.5707,-4613.3993 1846.9164,-4600.4481"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1474.8094,-4602.4481C1506.8878,-4574.5024 1526.5249,-4578.3219 1549.3953,-4542.4481 1585.3223,-4486.0937 1563.3242,-4459.5308 1585.3953,-4396.4481 1642.2704,-4233.8893 1700.3825,-4210.1227 1747.415,-4044.4481 1783.3658,-3917.8095 1765.991,-3880.9325 1783.415,-3750.4481 1804.9055,-3589.5112 1834.0707,-3395.8896 1843.6916,-3332.5868"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1847.1626,-3333.0419 1845.2074,-3322.6291 1840.2423,-3331.9885 1847.1626,-3333.0419"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M1474.8094,-4870.4481C1577.4922,-4918.1088 1880.6615,-4824.745 1984.2305,-4870.4481"/>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M1287.8186,-4692.5727C1311.6403,-4725.586 1387.1077,-4823.6074 1474.8094,-4870.4481"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1474.8094,-4870.4481C1496.195,-4881.8699 1822.9547,-5094.7548 1846.9164,-5098.4481"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1846.9164,-5098.4481C2001.8923,-5113.5426 2086.3372,-5120.7673 2182.6875,-4998.4481 2276.0489,-4879.9234 2145.0406,-4452.1317 2218.6875,-4320.4481 2224.9033,-4309.334 2235.3389,-4300.4738 2245.9106,-4293.7533"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2247.8575,-4296.6696 2254.7331,-4288.6088 2244.3314,-4290.6226 2247.8575,-4296.6696"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M1329.4392,-4670.4139C1341.2097,-4666.8095 1353.4676,-4662.2081 1364.2236,-4656.4481 1382.584,-4646.6158 1381.9762,-4636.4885 1400.2236,-4626.4481 1430.7331,-4609.6606 1448.8255,-4625.6317 1474.8094,-4602.4481"/>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M1474.8094,-4602.4481C1506.5545,-4574.1243 1530.2593,-4580.4454 1549.3953,-4542.4481 1594.7101,-4452.4684 1556.7346,-3733.0314 1585.3953,-3636.4481 1625.4251,-3501.5518 1701.9353,-3497.6058 1747.415,-3364.4481 1790.2491,-3239.0363 1749.9955,-3196.69 1783.415,-3068.4481 1796.4693,-3018.3544 1822.0732,-2962.9808 1836.4616,-2933.8915"/>
<polygon fill="#00ff20" stroke="#00ff20" points="1839.6916,-2935.2583 1841.0443,-2924.7502 1833.4339,-2932.1212 1839.6916,-2935.2583"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M1301.594,-4670.2509C1320.583,-4659.3791 1347.7035,-4641.2029 1364.2236,-4618.4481 1393.4541,-4578.186 1372.196,-4553.5566 1400.2236,-4512.4481 1412.8722,-4493.8962 1432.4018,-4477.6749 1448.3043,-4466.3398"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1450.4464,-4469.1144 1456.6992,-4460.5614 1446.4775,-4463.3483 1450.4464,-4469.1144"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1324.6288,-4692.4669C1429.8212,-4716.3519 1700.2823,-4765.4972 1910.4177,-4697.4481 2052.515,-4651.432 2108.9623,-4630.3468 2182.6875,-4500.4481 2227.6144,-4421.2899 2190.0192,-4178.8343 2218.6875,-4092.4481 2228.9863,-4061.4147 2250.4648,-4030.0444 2265.3046,-4010.6804"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2268.1693,-4012.6995 2271.5918,-4002.6727 2262.6635,-4008.3767 2268.1693,-4012.6995"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M1280.8447,-4670.1752C1291.321,-4529.2502 1396.5855,-3114.2296 1400.2236,-3104.4481 1412.3248,-3071.9127 1438.233,-3040.7718 1456.0875,-3021.8807"/>
<polygon fill="#0052ff" stroke="#0052ff" points="1458.7323,-3024.181 1463.1826,-3014.5662 1453.7078,-3019.3072 1458.7323,-3024.181"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1846.9164,-4600.4481C2069.1759,-4565.0616 2176.4513,-4651.4584 2343.3267,-4500.4481 2491.5761,-4366.2929 2466.0059,-4277.5729 2509.6157,-4082.4481 2557.8465,-3866.6476 2573.7613,-3141.9224 2576.3225,-3007.8699"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2579.8253,-3007.7449 2576.5129,-2997.6812 2572.8266,-3007.6141 2579.8253,-3007.7449"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M1666.4052,-4528.4481C1756.5481,-4491.0909 1872.2114,-4484.7292 1936.2138,-4484.433"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1936.4083,-4487.933 1946.4092,-4484.4357 1936.4102,-4480.933 1936.4083,-4487.933"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge338" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1295.4034,-4670.3045C1312.4297,-4657.8953 1340.5808,-4637.1216 1364.2236,-4618.4481 1380.5679,-4605.5391 1384.082,-4601.6096 1400.2236,-4588.4481 1465.953,-4534.8536 1511.3949,-4545.2682 1549.3953,-4469.4481 1605.8301,-4356.8465 1550.6213,-3457.505 1585.3953,-3336.4481 1598.7777,-3289.8605 1631.2431,-3242.5604 1650.7697,-3216.9222"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1653.7134,-3218.838 1657.0843,-3208.7937 1648.1854,-3214.5435 1653.7134,-3218.838"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-4602.4481C1541.9567,-4540.609 1585.0138,-4569.7793 1666.4052,-4528.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-4528.4481C1729.93,-4496.1897 2015.3034,-4336.6421 2182.6875,-3859.4481 2218.8824,-3756.2603 2156.6012,-1981.4651 2218.6875,-1891.4481 2220.8675,-1888.2873 2223.5182,-1885.526 2226.4824,-1883.1137"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2228.5447,-1885.946 2234.9528,-1877.5088 2224.6818,-1880.1083 2228.5447,-1885.946"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-4642.4481C1709.219,-4646.4506 1756.955,-4655.9314 1792.5794,-4664.0172"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1792.2279,-4667.5279 1802.7586,-4666.3643 1793.8007,-4660.7069 1792.2279,-4667.5279"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge376" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1879.8,-2902.4261C1944.6299,-2882.9189 2090.6196,-2850.2681 2182.6875,-2916.4481 2222.4045,-2944.9973 2184.7,-2985.2722 2218.6875,-3020.4481 2239.3111,-3041.7928 2252.3784,-3036.6164 2281.0071,-3044.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-3044.4481C2351.992,-3059.9162 2400.9414,-2986.2821 2444.4712,-3044.4481"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1892.6382,-2924.4684C1931.3152,-2935.834 1986.0385,-2956.9922 2022.0432,-2992.4481 2141.6986,-3110.2793 2134.0491,-3173.7126 2182.6875,-3334.4481 2256.0647,-3576.9381 2275.9077,-3887.0251 2280.062,-3970.1572"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2276.5757,-3970.5287 2280.548,-3980.3506 2283.5677,-3970.1953 2276.5757,-3970.5287"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1865.1248,-2902.2692C1878.0519,-2894.1264 1895.6598,-2882.612 1910.4177,-2871.4481 1927.257,-2858.7097 1928.089,-2850.9306 1946.4177,-2840.4481 2038.7431,-2787.6456 2083.8163,-2763.2491 2182.6875,-2802.4481 2294.234,-2846.6723 2275.1553,-2927.8936 2379.3267,-2987.4481 2405.5094,-3002.4166 2414.903,-3000.5053 2444.4712,-3006.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2444.4712,-3006.4481C2475.1845,-3009.3458 2509.6371,-3003.8485 2535.6747,-2997.8897"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2536.6654,-3001.2513 2545.5704,-2995.5109 2535.0293,-2994.4452 2536.6654,-3001.2513"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1847.6332,-2902.4292C1853.972,-2813.8311 1907.8095,-2212.6349 2218.6875,-1891.4481 2222.0572,-1887.9666 2225.9754,-1884.9567 2230.1752,-1882.3569"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2231.9409,-1885.3817 2239.1057,-1877.5768 2228.6375,-1879.2101 2231.9409,-1885.3817"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge377" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1524.17,-4457.5774C1628.0723,-4475.7963 1863.6425,-4523.3003 1910.4177,-4586.4481 1989.8245,-4693.6492 1888.6848,-4764.1799 1946.4177,-4884.4481 2022.8085,-5043.5838 2106.1427,-5122.5762 2281.0071,-5098.4481"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2281.0071,-4334.4481C2298.6025,-4307.467 2327.0067,-4325.2192 2343.3267,-4297.4481 2416.819,-4172.3886 2295.5207,-3110.8438 2379.3267,-2992.4481 2381.5576,-2989.2964 2384.2429,-2986.542 2387.2348,-2984.1348"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2389.3256,-2986.9492 2395.7695,-2978.5392 2385.4875,-2981.0952 2389.3256,-2986.9492"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1666.4052,-4410.4481C1804.0128,-4378.5527 1844.2811,-4429.6141 1984.2305,-4410.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1984.2305,-4410.4481C2001.1169,-4408.3231 2271.7102,-4348.7041 2281.0071,-4334.4481"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1524.3585,-4440.8413C1563.2367,-4433.7328 1618.5912,-4422.827 1666.4052,-4410.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1666.4052,-4410.4481C1805.6706,-4374.3925 2168.0371,-4083.7409 2259.698,-4008.9476"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2261.9496,-4011.6276 2267.476,-4002.5882 2257.5188,-4006.2083 2261.9496,-4011.6276"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1984.2305,-4410.4481C2146.0206,-4403.039 2236.6928,-4470.3503 2343.3267,-4348.4481 2418.9747,-4261.9683 2307.1908,-4181.8785 2379.3267,-4092.4481 2398.6986,-4068.4317 2429.7722,-4095.5774 2444.4712,-4068.4481"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1478.6519,-4438.2607C1491.6236,-4399.8767 1533.8504,-4269.7595 1549.3953,-4158.4481 1590.995,-3860.5657 1565.9045,-3105.589 1585.3953,-2805.4481 1605.0986,-2502.0331 1651.7411,-2134.6023 1663.6163,-2043.5945"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1667.1152,-2043.8309 1664.9444,-2033.4609 1660.1745,-2042.9212 1667.1152,-2043.8309"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1489.5662,-4438.3925C1505.171,-4426.3883 1530.1452,-4406.2666 1549.3953,-4386.4481 1603.4313,-4330.8163 1909.2113,-3860.118 1984.2305,-3840.4481"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1486.5923,-4460.6813C1515.4891,-4487.8349 1592.8878,-4558.2009 1666.4052,-4604.4481"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge378" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2320.6126,-4002.5586C2328.7359,-4006.0901 2336.791,-4010.6405 2343.3267,-4016.4481 2368.3037,-4038.6425 2354.0357,-4060.6121 2379.3267,-4082.4481 2402.6817,-4102.6125 2416.0191,-4094.5092 2444.4712,-4106.4481"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2182.5101,-5783.4535 2058.2206,-5783.4535 2058.2206,-5761.4426 2182.5101,-5761.4426 2182.5101,-5783.4535"/>
<text text-anchor="middle" x="2120.3654" y="-5769.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge379" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2182.7279,-5781.1054C2213.0503,-5783.1547 2249.632,-5782.3789 2281.0071,-5772.4481"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M2121.573,-5761.3819C2128.6539,-5696.076 2165.0748,-5354.3268 2182.6875,-5074.4481 2189.5449,-4965.4792 2186.97,-4196.9241 2218.6875,-4092.4481 2228.186,-4061.1605 2249.8564,-4029.8512 2264.9578,-4010.5702"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2267.8271,-4012.5872 2271.3667,-4002.6011 2262.3722,-4008.2003 2267.8271,-4012.5872"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge380" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-2134.4481C1780.2989,-2063.9657 2070.9786,-2110.9056 2343.3267,-2536.4481 2449.5482,-2702.4186 2466.3934,-2755.1954 2509.6157,-2947.4481 2523.7628,-3010.3741 2514.0846,-4121.8731 2576.7096,-4106.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2576.7096,-4106.4481C2684.557,-4066.7494 2710.6133,-3158.9476 2714.211,-3007.7149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2717.7158,-3007.5424 2714.4475,-2997.4643 2710.7177,-3007.3809 2717.7158,-3007.5424"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M975.2385,-2275.3776C986.7114,-2271.6593 998.9082,-2267.0122 1009.6252,-2261.4481 1027.3755,-2252.2324 1027.8526,-2243.6205 1045.6252,-2234.4481 1141.3776,-2185.0305 1172.4449,-2178.8552 1280.0068,-2172.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1280.0068,-2172.4481C1564.1833,-2154.7524 1655.0315,-2160.562 1910.4177,-2286.4481 2039.2281,-2349.9418 2068.7944,-2372.9728 2182.6875,-2460.4481 2229.6701,-2496.5329 2232.328,-2516.6867 2281.0071,-2550.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2281.0071,-2550.4481C2353.1244,-2595.175 2421.0937,-2866.7621 2439.5642,-2945.8541"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2436.2645,-2947.1207 2441.9248,-2956.0768 2443.085,-2945.5457 2436.2645,-2947.1207"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M987.8754,-2286.0205C1126.5159,-2287.419 1496.3513,-2306.6651 1747.415,-2463.4481 1841.7873,-2522.3812 1840.5596,-2566.8508 1910.4177,-2653.4481 1934.6656,-2683.5061 2109.3165,-2893.4431 2120.3654,-2930.4481"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M970.6591,-2297.531C1007.103,-2309.4615 1062.4153,-2331.0533 1102.7076,-2362.4481"/>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M1102.7076,-2362.4481C1124.4168,-2379.3633 1136.038,-2372.5465 1159.79,-2386.4481 1177.2838,-2396.6868 1178.651,-2403.626 1195.79,-2414.4481 1427.7586,-2560.9187 1566.6557,-2485.0768 1747.415,-2691.4481 1779.6432,-2728.2426 1763.7622,-2750.6568 1783.415,-2795.4481 1799.0367,-2831.0519 1821.3254,-2870.4595 1834.9183,-2893.5304"/>
<polygon fill="#00ff20" stroke="#00ff20" points="1832.0481,-2895.5517 1840.1667,-2902.359 1838.0652,-2891.9747 1832.0481,-2895.5517"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M2120.3654,-2816.4481C2136.0641,-2866.4088 2166.0022,-2866.8081 2182.6875,-2916.4481 2251.9488,-3122.5051 2276.421,-3837.9006 2280.4024,-3970.2887"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2276.9058,-3970.459 2280.6989,-3980.3515 2283.9028,-3970.2527 2276.9058,-3970.459"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1280.0068,-2172.4481C1333.1385,-2172.0883 1698.7189,-2252.1928 1747.415,-2273.4481 1828.4382,-2308.8136 1850.2011,-2322.7222 1910.4177,-2387.4481 1976.3472,-2458.3145 1984.9555,-2485.0431 2022.0432,-2574.4481 2046.9904,-2634.5867 2032.521,-2656.5513 2058.0432,-2716.4481 2078.5719,-2764.6259 2104.6666,-2766.4873 2120.3654,-2816.4481"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M988.1206,-2277.6564C996.4936,-2273.9535 1004.148,-2268.7486 1009.6252,-2261.4481 1048.6187,-2209.4741 1031.8208,-1155.9399 1045.6252,-1092.4481 1055.0321,-1049.1826 1077.7729,-1002.3187 1091.5439,-976.4553"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1094.6437,-978.0813 1096.3361,-967.6225 1088.4909,-974.7431 1094.6437,-978.0813"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M936.1225,-2297.5336C946.9797,-2332.8257 981.6484,-2445.7504 1009.6252,-2539.4481 1093.7689,-2821.2549 1018.5975,-2939.7183 1195.79,-3174.4481 1258.5481,-3257.5847 1372.9651,-3311.4265 1433.9625,-3335.6363"/>
<polygon fill="#0083ff" stroke="#0083ff" points="1433.0465,-3339.0356 1443.6349,-3339.404 1435.5873,-3332.5129 1433.0465,-3339.0356"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M988.017,-2276.0775C996.0886,-2272.5392 1003.6705,-2267.7984 1009.6252,-2261.4481 1053.8655,-2214.2685 1025.2909,-2181.8454 1045.6252,-2120.4481 1059.8799,-2077.4078 1081.0888,-2028.7424 1093.2397,-2001.9267"/>
<polygon fill="#0020ff" stroke="#0020ff" points="1096.4481,-2003.3267 1097.4198,-1992.7765 1090.081,-2000.418 1096.4481,-2003.3267"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1280.0068,-2134.4481C1318.5462,-2129.0186 1329.6596,-2128.339 1364.2236,-2110.4481 1420.2523,-2081.4467 1415.7522,-2043.641 1474.8094,-2021.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1474.8094,-2021.4481C1755.0127,-1916.1514 1836.1177,-1735.6155 2120.3654,-1829.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1102.7076,-2134.4481C1164.1989,-2085.1712 1201.9777,-2145.441 1280.0068,-2134.4481"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge350" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1474.8094,-3118.4481C1512.4342,-3151.4157 1565.7049,-3171.8758 1606.5285,-3183.6898"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1605.7837,-3187.1157 1616.3569,-3186.4379 1607.6688,-3180.3743 1605.7837,-3187.1157"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1102.7076,-2362.4481C1157.1771,-2396.9451 1343.7164,-2819.3218 1364.2236,-2880.4481 1392.6724,-2965.2459 1347.5871,-3006.1335 1400.2236,-3078.4481 1422.3601,-3108.8602 1446.5181,-3093.6585 1474.8094,-3118.4481"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-2021.4481C1513.2328,-2007.0091 1559.131,-2006.7224 1596.3704,-2010.2993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1596.314,-2013.8133 1606.6308,-2011.402 1597.0621,-2006.8534 1596.314,-2013.8133"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1280.0068,-2096.4481C1307.9089,-2045.4798 1339.9256,-2049.2297 1364.2236,-1996.4481 1405.4716,-1906.8468 1383.999,-1874.7442 1400.2236,-1777.4481 1427.1525,-1615.9605 1460.3168,-1421.3387 1471.1793,-1357.7001"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1474.6555,-1358.1358 1472.8886,-1347.6894 1467.7554,-1356.9576 1474.6555,-1358.1358"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1102.7076,-2134.4481C1134.1515,-2109.2501 1260.6576,-2131.793 1280.0068,-2096.4481"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M987.9189,-2277.5024C996.3133,-2273.8159 1004.0273,-2268.6564 1009.6252,-2261.4481 1047.9368,-2212.1158 1030.9092,-1761.1513 1045.6252,-1700.4481 1084.9286,-1538.3232 1125.7237,-1507.8414 1195.79,-1356.4481 1221.3699,-1301.1773 1253.4611,-1236.9412 1269.649,-1204.8674"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1272.9278,-1206.1394 1274.3176,-1195.6361 1266.6812,-1202.9802 1272.9278,-1206.1394"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M987.9477,-2275.4556C995.9307,-2271.9921 1003.5026,-2267.4376 1009.6252,-2261.4481 1044.29,-2227.5371 1012.4104,-2193.7805 1045.6252,-2158.4481 1064.4755,-2138.3961 1081.2316,-2151.6582 1102.7076,-2134.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-2134.4481C1205.0432,-2052.44 1123.4451,-1963.8286 1195.79,-1854.4481 1208.9139,-1834.6057 1230.4932,-1818.6421 1248.5219,-1807.7489"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1250.6578,-1810.5568 1257.5625,-1802.5209 1247.1536,-1804.4971 1250.6578,-1810.5568"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1351.8444,-623.4535 1208.1693,-623.4535 1208.1693,-601.4426 1351.8444,-601.4426 1351.8444,-623.4535"/>
<text text-anchor="middle" x="1280.0068" y="-609.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge381" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1291.9706,-601.4188C1346.7767,-551.3539 1575.0981,-347.8889 1666.4052,-347.4481"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2281.0071,-1147.4481C2318.309,-1234.6766 2428.6474,-2748.2932 2442.9397,-2946.1748"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2439.4677,-2946.6901 2443.6781,-2956.4124 2446.4495,-2946.1864 2439.4677,-2946.6901"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1334.8169,-623.5578C1376.7589,-634.2648 1434.1239,-653.9065 1474.8094,-687.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1474.8094,-687.4481C1528.4148,-731.6409 1714.1657,-643.0216 1783.415,-637.4481 1839.6787,-632.9197 1859.4667,-613.1559 1910.4177,-637.4481 2083.9146,-720.1669 2097.6546,-801.0735 2182.6875,-973.4481 2213.0185,-1034.9336 2173.5128,-1071.8758 2218.6875,-1123.4481 2238.2443,-1145.7744 2269.337,-1120.1581 2281.0071,-1147.4481"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M1295.3433,-623.6684C1312.3169,-636.1448 1340.4222,-656.977 1364.2236,-675.4481 1395.6439,-699.8317 1431.3969,-728.8415 1453.5333,-746.9546"/>
<polygon fill="#73ff00" stroke="#73ff00" points="1451.3602,-749.6989 1461.3131,-753.3307 1455.7974,-744.2849 1451.3602,-749.6989"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1345.5216,-601.4339C1532.7338,-570.6699 2060.4591,-489.1589 2120.3654,-537.4481"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1283.5536,-623.6751C1296.5548,-665.2877 1341.9977,-814.8522 1364.2236,-941.4481 1378.5087,-1022.8141 1348.7822,-1246.8085 1400.2236,-1311.4481 1403.5403,-1315.6156 1407.5774,-1319.0936 1412.0385,-1321.9954"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1410.604,-1325.1991 1421.0622,-1326.8953 1413.9444,-1319.0475 1410.604,-1325.1991"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-687.4481C1501.9997,-709.2045 1526.2408,-685.4381 1549.3953,-711.4481 1604.2217,-773.036 1569.2896,-812.5802 1585.3953,-893.4481 1656.9347,-1252.653 1682.3432,-1341.0154 1747.415,-1701.4481 1884.0934,-2458.5092 1923.3157,-2647.5094 2022.0432,-3410.4481 2032.5314,-3491.4981 2023.3056,-3702.4723 2058.0432,-3776.4481 2066.5454,-3794.5541 2082.4866,-3810.5189 2096.1177,-3821.8472"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2094.2111,-3824.8025 2104.2192,-3828.2793 2098.5637,-3819.3202 2094.2111,-3824.8025"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge382" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1116.9834,-945.4066C1130.5568,-934.0062 1150.2715,-914.8985 1159.79,-893.4481 1192.5796,-819.5552 1146.9557,-595.8726 1195.79,-531.4481 1229.706,-486.7045 1610.3553,-350.7174 1666.4052,-347.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-347.4481C1765.2228,-323.2872 2034.584,-233.765 2120.3654,-288.4481"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1474.8094,-1183.4481C1502.6647,-1231.3883 1529.8273,-1231.5706 1549.3953,-1283.4481 1619.5801,-1469.5183 1525.0935,-1539.9441 1585.3953,-1729.4481 1628.1782,-1863.8976 1708.1766,-1866.9217 1747.415,-2002.4481 1767.261,-2070.9943 1742.4243,-3228.034 1783.415,-3286.4481 1785.6205,-3289.591 1788.2852,-3292.3388 1791.2574,-3294.7412"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1789.463,-3297.7502 1799.7395,-3300.3278 1793.3133,-3291.9043 1789.463,-3297.7502"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1280.0068,-955.4481C1315.1807,-972.1082 1337.1096,-951.5269 1364.2236,-979.4481 1409.5817,-1026.1563 1365.4857,-1066.3818 1400.2236,-1121.4481 1423.223,-1157.9064 1453.7322,-1145.8458 1474.8094,-1183.4481"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M2120.3654,-2930.4481C2176.4406,-3120.7457 2164.0499,-3174.9379 2182.6875,-3372.4481 2213.9553,-3703.8053 2148.3367,-3795.1389 2218.6875,-4120.4481 2229.7773,-4171.7283 2255.8034,-4228.0119 2270.473,-4257.2606"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2267.4854,-4259.1065 2275.1452,-4266.4262 2273.7219,-4255.9274 2267.4854,-4259.1065"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1474.8094,-1183.4481C1491.8364,-1213.8246 1526.6549,-1181.0752 1549.3953,-1207.4481 1613.523,-1281.8194 1551.9767,-1333.1082 1585.3953,-1425.4481 1633.8008,-1559.1989 1690.4806,-1571.0991 1747.415,-1701.4481 1916.6833,-2088.9802 1926.3647,-2200.5275 2022.0432,-2612.4481 2044.2613,-2708.1027 2023.4045,-2738.5589 2058.0432,-2830.4481 2076.5155,-2879.4512 2105.563,-2880.2144 2120.3654,-2930.4481"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1280.0068,-955.4481C1315.399,-971.6393 1333.8273,-955.1413 1364.2236,-979.4481 1390.3193,-1000.3158 1378.9983,-1019.6425 1400.2236,-1045.4481 1454.9895,-1112.032 1489.0836,-1107.8426 1549.3953,-1169.4481 1666.2278,-1288.7869 1648.4611,-1365.0659 1783.415,-1463.4481 1832.176,-1498.9951 1869.6784,-1466.9337 1910.4177,-1511.4481 2062.0042,-1677.0813 2145.2013,-2263.0714 2182.6875,-2484.4481 2225.3634,-2736.4728 2202.1697,-2803.37 2218.6875,-3058.4481 2242.3244,-3423.4624 2272.6295,-3868.6964 2279.5546,-3970.1822"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2276.0763,-3970.6215 2280.2493,-3980.3599 2283.0601,-3970.1447 2276.0763,-3970.6215"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1150.2843,-945.3973C1187.4352,-939.2411 1239.3913,-936.2105 1280.0068,-955.4481"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1116.8916,-945.3653C1130.3953,-933.9335 1150.0584,-914.8026 1159.79,-893.4481 1187.7256,-832.1477 1150.0861,-641.9382 1195.79,-592.4481 1245.8574,-538.2331 1773.5161,-453.806 1846.9164,-461.4481"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-1449.4481C2227.3538,-1575.0778 2267.4519,-1779.8047 2277.9564,-1845.4725"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2274.5086,-1846.0801 2279.4896,-1855.431 2281.4271,-1845.0149 2274.5086,-1846.0801"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1151.1719,-945.3822C1204.2399,-935.1691 1291.4776,-924.0001 1364.2236,-941.4481 1757.9207,-1035.8756 1857.8673,-1141.2132 2120.3654,-1449.4481"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-1297.4481C1493.6804,-1325.98 1527.4964,-1290.1684 1549.3953,-1316.4481 1587.0391,-1361.6224 1570.9847,-1787.4383 1585.3953,-1844.4481 1600.7026,-1905.0057 1635.845,-1970.4504 1654.4093,-2002.4846"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1651.513,-2004.4642 1659.5981,-2011.3112 1657.5475,-2000.9167 1651.513,-2004.4642"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-955.4481C1315.399,-971.6393 1338.315,-950.4049 1364.2236,-979.4481 1429.5952,-1052.7285 1361.7787,-1107.0852 1400.2236,-1197.4481 1421.93,-1248.4678 1444.2228,-1251.2026 1474.8094,-1297.4481"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1123.5117,-967.6162C1179.7423,-998.2079 1332.6505,-1084.2138 1364.2236,-1131.4481 1409.5616,-1199.2748 1346.2819,-1250.2412 1400.2236,-1311.4481 1403.6352,-1315.3191 1407.6643,-1318.592 1412.0543,-1321.3591"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1410.4062,-1324.4467 1420.8742,-1326.0811 1413.7102,-1318.2755 1410.4062,-1324.4467"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1107.1967,-967.6233C1123.5526,-1008.1294 1179.8307,-1145.5991 1195.79,-1159.4481 1200.0377,-1163.1341 1204.8091,-1166.2769 1209.8651,-1168.9566"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1208.6774,-1172.2638 1219.2218,-1173.297 1211.6232,-1165.9138 1208.6774,-1172.2638"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1108.899,-967.6637C1121.1103,-990.4013 1148.1238,-1043.8973 1159.79,-1092.4481 1210.1871,-1302.1834 1147.9193,-1366.1217 1195.79,-1576.4481 1212.7046,-1650.7644 1250.9463,-1733.2818 1269.5074,-1770.8284"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1266.5823,-1772.8044 1274.1866,-1780.1817 1272.8426,-1769.6725 1266.5823,-1772.8044"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge383" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1478.8841,-3361.8186C1490.1711,-3393.3374 1522.7662,-3484.5072 1549.3953,-3560.4481 1565.5807,-3606.6057 1551.3659,-3629.3127 1585.3953,-3664.4481 1671.9689,-3753.8355 1729.3396,-3723.6952 1846.9164,-3764.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1846.9164,-3764.4481C1916.6225,-3793.7389 2128.6121,-3766.6016 2182.6875,-3819.4481 2244.7803,-3880.1297 2164.7741,-3943.3957 2218.6875,-4011.4481 2286.2927,-4096.7829 2342.969,-4067.0805 2444.4712,-4106.4481"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1666.4052,-3350.4481C1781.6092,-3329.3243 1758.1493,-3234.8587 1846.9164,-3158.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1524.4757,-3355.3269C1563.4177,-3357.9834 1618.8009,-3359.1768 1666.4052,-3350.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1846.9164,-3158.4481C1869.7827,-3138.7647 1888.4836,-3155.1652 1910.4177,-3134.4481 1969.1165,-3079.006 2014.3788,-2870.3656 2058.0432,-2802.4481 2063.0977,-2794.5861 2273.2815,-2545.1874 2281.0071,-2550.4481"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1846.9164,-3764.4481C1909.7394,-3783.914 2198.6807,-4167.1002 2266.6576,-4258.1562"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2263.9137,-4260.3315 2272.6968,-4266.2566 2269.5256,-4256.1474 2263.9137,-4260.3315"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M1479.3847,-3339.2854C1492.0957,-3309.456 1530.5487,-3226.8101 1585.3953,-3177.4481 1645.2351,-3123.5921 1689.5175,-3152.3868 1747.415,-3096.4481 1796.6507,-3048.8782 1827.4802,-2971.5884 1840.2012,-2934.5488"/>
<polygon fill="#00ff20" stroke="#00ff20" points="1843.6008,-2935.4175 1843.4393,-2924.8239 1836.9593,-2933.206 1843.6008,-2935.4175"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1666.4052,-3350.4481C1930.7732,-3284.5213 1906.7907,-3593.2657 2120.3654,-3762.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M2120.3654,-3762.4481C2142.9665,-3781.6883 2160.8809,-3766.3118 2182.6875,-3786.4481 2239.003,-3838.4498 2266.4561,-3929.5216 2276.4294,-3970.4646"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2273.0644,-3971.4471 2278.7405,-3980.3931 2279.8822,-3969.86 2273.0644,-3971.4471"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1846.9164,-3158.4481C1870.1266,-3139.1714 1883.2101,-3147.4884 1910.4177,-3134.4481 1979.0944,-3101.532 1986.6927,-3074.0764 2058.0432,-3047.4481 2152.4401,-3012.2187 2181.3525,-2991.5874 2281.0071,-3006.4481"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge344" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1488.8979,-3339.1976C1521.9189,-3312.8285 1604.5163,-3246.8698 1644.302,-3215.0987"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1646.9242,-3217.4837 1652.5544,-3208.5087 1642.5562,-3212.0138 1646.9242,-3217.4837"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1477.8296,-3339.2414C1488.9216,-3297.7147 1527.8807,-3148.5505 1549.3953,-3023.4481 1616.5628,-2632.8842 1656.471,-2149.8536 1664.7774,-2043.7064"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1668.2753,-2043.8679 1665.5593,-2033.6271 1661.2963,-2043.3264 1668.2753,-2043.8679"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge384" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1489.302,-2992.1382C1564.5198,-2934.8906 1917.1223,-2684.3522 2182.6875,-2802.4481 2301.9117,-2855.4666 2271.2633,-2947.3202 2379.3267,-3020.4481 2404.8809,-3037.7409 2425.9836,-3019.7444 2444.4712,-3044.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2444.4712,-3044.4481C2587.9487,-3234.1156 2345.7886,-4163.3257 2576.7096,-4106.4481"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1493.58,-2992.3422C1510.6381,-2981.2897 1535.2377,-2962.7807 1549.3953,-2940.4481 1582.6431,-2888.0021 1540.8796,-2848.7419 1585.3953,-2805.4481 1671.0285,-2722.1651 1727.6383,-2736.9804 1846.9164,-2743.4481"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1666.4052,-3082.4481C1706.6587,-3103.3113 1722.4575,-3106.5964 1747.415,-3144.4481 1783.2545,-3198.8038 1740.3855,-3237.5863 1783.415,-3286.4481 1786.4481,-3289.8922 1790.0171,-3292.8665 1793.8904,-3295.4342"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1792.3348,-3298.5749 1802.7659,-3300.4305 1795.7687,-3292.475 1792.3348,-3298.5749"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1846.9164,-3082.4481C1875.3282,-3092.6007 1887.4683,-3086.8616 1910.4177,-3106.4481 1934.9476,-3127.3834 1930.3447,-3141.4899 1946.4177,-3169.4481 1952.5911,-3180.1864 2048.6257,-3354.4023 2058.0432,-3362.4481 2080.6103,-3381.7282 2105.0084,-3361.048 2120.3654,-3386.4481"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M2120.3654,-3386.4481C2290.6567,-3668.1063 2137.7521,-3801.4183 2218.6875,-4120.4481 2231.5889,-4171.3027 2256.8945,-4227.7555 2270.9659,-4257.1448"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2267.9218,-4258.8888 2275.4359,-4266.358 2274.2197,-4255.8331 2267.9218,-4258.8888"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1533.8837,-3014.491C1539.1849,-3015.9702 1544.4238,-3017.6186 1549.3953,-3019.4481 1604.8245,-3039.8455 1613.9668,-3055.2695 1666.4052,-3082.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1846.9164,-3082.4481C2008.7607,-3132.9766 2037.9413,-3200.2826 2120.3654,-3348.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1666.4052,-3082.4481C1737.6337,-3119.3655 1771.3677,-3055.4517 1846.9164,-3082.4481"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1481.8883,-2992.3312C1496.3107,-2969.2815 1529.4193,-2914.2703 1549.3953,-2864.4481 1571.7063,-2808.802 1548.7423,-2781.891 1585.3953,-2734.4481 1733.8429,-2542.3004 1823.561,-2523.4999 2058.0432,-2460.4481 2184.7568,-2426.375 2248.8645,-2445.3755 2343.3267,-2536.4481 2479.5421,-2667.7757 2551.571,-2895.9121 2571.1496,-2965.6216"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2567.8154,-2966.6973 2573.8433,-2975.4102 2574.5645,-2964.84 2567.8154,-2966.6973"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge348" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1529.619,-3014.5654C1537.0152,-3018.0142 1543.9254,-3022.5315 1549.3953,-3028.4481 1594.178,-3076.8888 1540.0324,-3124.5501 1585.3953,-3172.4481 1589.0341,-3176.2903 1593.2487,-3179.5463 1597.8055,-3182.3052"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1596.4384,-3185.5384 1606.929,-3187.021 1599.6527,-3179.32 1596.4384,-3185.5384"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1525.3344,-3014.5265C1533.9846,-3017.994 1542.4184,-3022.5278 1549.3953,-3028.4481 1575.4693,-3050.5734 1560.9348,-3072.551 1585.3953,-3096.4481 1642.9811,-3152.7076 1704.2344,-3109.5018 1747.415,-3177.4481 1833.0813,-3312.247 1720.1602,-4467.7911 1783.415,-4614.4481 1791.3606,-4632.8699 1807.4582,-4648.7426 1821.4567,-4659.9476"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1819.7319,-4663.0332 1829.8098,-4666.3022 1823.9701,-4657.462 1819.7319,-4663.0332"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge385" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-1906.4481C1312.379,-1884.8425 1335.9879,-1909.2343 1364.2236,-1882.4481 1400.0142,-1848.4949 1376.2258,-1820.5512 1400.2236,-1777.4481 1624.8128,-1374.0579 1677.2225,-1234.4837 2058.0432,-973.4481 2070.5489,-964.876 2569.1547,-790.3029 2576.7096,-803.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1130.6706,-1970.3465C1140.2612,-1965.9951 1150.8284,-1960.5702 1159.79,-1954.4481 1177.9623,-1942.0338 1176.0775,-1930.2339 1195.79,-1920.4481 1229.7761,-1903.5766 1248.364,-1927.3868 1280.0068,-1906.4481"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1474.8094,-1791.4481C1517.3923,-1775.1987 2249.9926,-1910.0498 2281.0071,-1943.4481"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1280.0068,-1982.4481C1353.4133,-1986.414 1490.1648,-2038.8428 1747.415,-2974.4481 1765.9184,-3041.7439 1740.8827,-3231.1117 1783.415,-3286.4481 1785.9027,-3289.6846 1788.8709,-3292.5027 1792.1452,-3294.9565"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1790.4732,-3298.038 1800.8158,-3300.3362 1794.1638,-3292.0899 1790.4732,-3298.038"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1280.0068,-1982.4481C1381.3134,-2005.802 1654.6085,-1955.5933 1747.415,-2002.4481 1760.0195,-2008.8116 1903.3323,-2185.2348 1910.4177,-2197.4481 1946.2171,-2259.1558 1997.9709,-2431.2918 2022.0432,-2498.4481 2038.548,-2544.4925 2036.9757,-2558.3045 2058.0432,-2602.4481 2103.1553,-2696.9733 2149.7491,-2703.0238 2182.6875,-2802.4481 2220.8574,-2917.6637 2271.5542,-3818.6626 2279.8399,-3969.9308"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2276.3605,-3970.4052 2280.4002,-3980.1997 2283.3501,-3970.0238 2276.3605,-3970.4052"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1160.0159,-1974.361C1195.2448,-1971.8118 1240.959,-1971.7841 1280.0068,-1982.4481"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2120.3654,-1829.4481C2147.4768,-1841.5297 2157.4575,-1837.8134 2182.6875,-1853.4481 2201.1373,-1864.8812 2199.84,-1875.6833 2218.6875,-1886.4481 2243.8316,-1900.8092 2252.7392,-1899.1716 2281.0071,-1905.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1666.4052,-1715.4481C1697.964,-1701.7744 1884.0917,-1724.1581 2120.3654,-1829.4481"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge337" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1107.6744,-1992.5949C1121.4582,-2023.4836 1161.4355,-2112.7615 1195.79,-2186.4481 1269.0751,-2343.6361 1319.6045,-2370.8536 1364.2236,-2538.4481 1392.028,-2642.8845 1341.5654,-2932.6777 1400.2236,-3023.4481 1441.1704,-3086.811 1492.0507,-3055.4267 1549.3953,-3104.4481 1569.3958,-3121.5456 1565.5579,-3134.1615 1585.3953,-3151.4481 1599.2291,-3163.503 1616.712,-3173.9077 1631.8926,-3181.7571"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1630.4842,-3184.966 1640.994,-3186.3062 1633.6139,-3178.7046 1630.4842,-3184.966"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-1791.4481C1560.398,-1758.7879 1581.6086,-1750.1125 1666.4052,-1715.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-1906.4481C1312.379,-1884.8425 1329.7574,-1900.5268 1364.2236,-1882.4481 1392.4071,-1867.6649 1445.0754,-1802.7944 1474.8094,-1791.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-1715.4481C1751.6569,-1680.5975 1892.3633,-1442.9027 1984.2305,-1449.4481"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1137.7492,-1970.3461C1145.5913,-1966.7597 1153.4531,-1962.1834 1159.79,-1956.4481 1183.987,-1934.5484 1170.1693,-1912.6635 1195.79,-1892.4481 1226.3443,-1868.34 1258.7437,-1901.0462 1280.0068,-1868.4481"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1280.0068,-1868.4481C1301.2699,-1835.8499 1338.3363,-1873.5101 1364.2236,-1844.4481 1430.125,-1770.4649 1379.7826,-1721.3947 1400.2236,-1624.4481 1421.5277,-1523.4084 1455.0466,-1404.5329 1468.7082,-1357.3044"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1472.0945,-1358.1937 1471.5241,-1347.6143 1465.3725,-1356.2403 1472.0945,-1358.1937"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1111.1862,-1970.3978C1124.31,-1952.5917 1149.1391,-1915.9448 1159.79,-1880.4481 1226.8789,-1656.8584 1135.3364,-1581.9222 1195.79,-1356.4481 1211.5524,-1297.6591 1247.8361,-1234.9964 1267.232,-1204.0618"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1270.252,-1205.8352 1272.6678,-1195.5195 1264.3463,-1202.0772 1270.252,-1205.8352"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1114.4915,-1970.0508C1126.6679,-1957.9237 1145.8143,-1937.8485 1159.79,-1918.4481 1178.8659,-1891.9679 1174.2593,-1878.9738 1195.79,-1854.4481 1211.9979,-1835.9857 1234.4319,-1819.5276 1252.0704,-1808.0669"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1254.2191,-1810.8492 1260.7987,-1802.5451 1250.4766,-1804.9336 1254.2191,-1810.8492"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge386" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-4106.4481C2351.1492,-4125.3746 2376.5717,-4080.6064 2444.4712,-4106.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-3426.4481C961.046,-3446.5565 976.7486,-3429.2032 1009.6252,-3440.4481 1080.7844,-3464.7867 1105.0052,-3466.9252 1159.79,-3518.4481 1182.444,-3539.7532 1173.2607,-3557.0112 1195.79,-3578.4481 1257.2786,-3636.9552 1296.2081,-3617.6759 1364.2236,-3668.4481 1378.238,-3678.9095 1570.2981,-3883.621 1585.3953,-3892.4481 1822.9422,-4031.3379 1926.3839,-3955.3113 2182.6875,-4055.4481 2228.5389,-4073.362 2233.4803,-4093.6238 2281.0071,-4106.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M787.2155,-3227.413C921.9683,-3180.4793 1440.2269,-2993.9429 1549.3953,-2864.4481 1588.0375,-2818.6109 1537.6799,-2770.7457 1585.3953,-2734.4481 1677.9575,-2664.0349 1730.6372,-2741.2265 1846.9164,-2743.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1846.9164,-2743.4481C2015.3958,-2717.4007 1949.9104,-2477.4292 2120.3654,-2474.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1102.7076,-3388.4481C1378.8006,-3465.8412 1470.5633,-3439.0815 1747.415,-3364.4481 1774.9857,-3357.0156 1803.448,-3340.841 1822.8311,-3328.3025"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1824.9224,-3331.1152 1831.3174,-3322.668 1821.0505,-3325.2835 1824.9224,-3331.1152"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M1474.8094,-4144.4481C1508.3159,-4164.7591 1524.0796,-4161.5426 1549.3953,-4191.4481 1576.1673,-4223.0739 1559.7097,-4244.9336 1585.3953,-4277.4481 1613.101,-4312.5198 1881.7264,-4480.1779 1910.4177,-4514.4481 2024.2946,-4650.4678 2094.079,-4858.7476 2114.256,-4924.6838"/>
<polygon fill="#ffc500" stroke="#ffc500" points="2110.9278,-4925.77 2117.1636,-4934.3353 2117.6302,-4923.7508 2110.9278,-4925.77"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M759.0537,-3249.7827C770.5004,-3281.8759 806.2246,-3375.2625 855.7932,-3440.4481 917.3211,-3521.3607 1117.5807,-3681.5186 1195.79,-3746.4481 1433.9801,-3944.1938 1479.0205,-4064.0406 1783.415,-4120.4481 1838.9158,-4130.7329 1856.6089,-4137.4987 1910.4177,-4120.4481 1948.6721,-4108.3262 1944.5632,-4062.3784 1984.2305,-4068.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M760.6298,-3227.2044C773.7568,-3199.7133 806.8042,-3126.5778 819.7932,-3061.4481 837.8037,-2971.1396 814.2603,-2315.637 855.7932,-2233.4481 895.3999,-2155.071 962.5711,-2183.5937 1009.6252,-2109.4481 1045.8984,-2052.2906 1000.7543,-2012.1365 1045.6252,-1961.4481 1081.5638,-1920.8501 1118.6476,-1953.7619 1159.79,-1918.4481 1184.5543,-1897.1921 1169.8921,-1874.3072 1195.79,-1854.4481 1257.0997,-1807.4344 1315.1382,-1871.112 1364.2236,-1811.4481 1409.6147,-1756.2747 1391.7368,-1240.3876 1400.2236,-1169.4481 1417.9728,-1021.0872 1456.4511,-845.0427 1469.9838,-785.393"/>
<polygon fill="#73ff00" stroke="#73ff00" points="1473.3962,-786.1707 1472.2097,-775.6425 1466.5718,-784.6127 1473.3962,-786.1707"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M757.9893,-3249.6344C767.7085,-3287.9898 799.9921,-3417.8055 819.7932,-3526.4481 840.3949,-3639.4833 807.3949,-3678.2416 855.7932,-3782.4481 951.2534,-3987.9838 1028.094,-4010.0157 1195.79,-4162.4481 1264.5771,-4224.9741 1312.0672,-4209.5009 1364.2236,-4286.4481 1399.788,-4338.9167 1356.9579,-4378.1247 1400.2236,-4424.4481 1404.6894,-4429.2295 1410.0957,-4433.0968 1415.9342,-4436.2248"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1414.8423,-4439.5743 1425.3915,-4440.5566 1417.7574,-4433.2101 1414.8423,-4439.5743"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1102.7076,-3426.4481C1156.8117,-3442.1057 1149.7244,-3480.0386 1195.79,-3512.4481 1355.4807,-3624.7984 1405.116,-3640.4608 1585.3953,-3715.4481 1670.6682,-3750.9174 1692.1527,-3764.2804 1783.415,-3778.4481 1839.1926,-3787.107 1854.0129,-3780.5942 1910.4177,-3778.4481 2003.9307,-3774.8899 2049.1083,-3701.787 2120.3654,-3762.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe6" stroke-dasharray="5,2" d="M760.5235,-3227.1826C773.4146,-3199.6428 805.978,-3126.4075 819.7932,-3061.4481 868.1691,-2833.9843 813.7029,-2768.1584 855.7932,-2539.4481 872.0324,-2451.2073 908.3051,-2350.2435 924.5584,-2307.4115"/>
<polygon fill="#00ffe6" stroke="#00ffe6" points="927.9247,-2308.408 928.2349,-2297.8177 921.3882,-2305.903 927.9247,-2308.408"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M760.7338,-3227.2245C774.0916,-3199.778 807.6128,-3126.7338 819.7932,-3061.4481 839.4618,-2956.0263 800.6715,-1223.4383 855.7932,-1131.4481 896.054,-1064.2585 946.629,-1091.9974 1009.6252,-1045.4481 1038.7333,-1023.9395 1068.2474,-994.0465 1086.0157,-974.9722"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1088.6808,-977.2448 1092.8761,-967.5159 1083.5295,-972.5052 1088.6808,-977.2448"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M932.7092,-3308.4481C987.6157,-3319.5501 994.6885,-3341.1366 1045.6252,-3364.4481 1070.6502,-3375.9009 1076.208,-3381.0198 1102.7076,-3388.4481"/>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M1102.7076,-3388.4481C1141.5067,-3399.324 1239.7696,-3352.5979 1280.0068,-3350.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M775.9826,-3249.4813C808.4247,-3265.9907 873.432,-3296.4622 932.7092,-3308.4481"/>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M932.7092,-3308.4481C986.1586,-3319.2555 995.3984,-3281.6824 1045.6252,-3260.4481 1070.9741,-3249.7314 1076.0674,-3243.3553 1102.7076,-3236.4481"/>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M1280.0068,-3160.4481C1312.4522,-3138.9526 1334.1253,-3161.1229 1364.2236,-3136.4481 1391.2784,-3114.2684 1378.4383,-3093.8215 1400.2236,-3066.4481 1414.3839,-3048.6556 1434.1861,-3032.2099 1449.8281,-3020.5857"/>
<polygon fill="#0052ff" stroke="#0052ff" points="1451.9826,-3023.3468 1458.0279,-3014.6459 1447.8761,-3017.6779 1451.9826,-3023.3468"/>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M1102.7076,-3236.4481C1185.6975,-3214.9306 1208.5351,-3207.7991 1280.0068,-3160.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M760.6222,-3227.2029C773.7325,-3199.7085 806.7456,-3126.566 819.7932,-3061.4481 837.1653,-2974.7475 799.7173,-2334.8167 855.7932,-2266.4481 878.1239,-2239.2221 918.0089,-2279.4452 932.7092,-2247.4481"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M932.7092,-2247.4481C947.6592,-2214.9076 984.9765,-2249.4255 1009.6252,-2223.4481 1054.1432,-2176.5304 1021.5033,-2142.4584 1045.6252,-2082.4481 1057.6224,-2052.6017 1076.8668,-2020.6862 1089.6467,-2000.8994"/>
<polygon fill="#0020ff" stroke="#0020ff" points="1092.6194,-2002.7487 1095.1778,-1992.4674 1086.7663,-1998.9093 1092.6194,-2002.7487"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M768.8965,-3227.2894C782.2605,-3216.2797 802.9411,-3198.7747 819.7932,-3182.4481 836.7352,-3166.0343 837.9825,-3158.9149 855.7932,-3143.4481 925.1407,-3083.2266 1110.6589,-2942.9211 1195.79,-2908.4481 1230.9593,-2894.2066 1246.1302,-2911.5381 1280.0068,-2894.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1280.0068,-2894.4481C1340.1808,-2857.9867 1344.6786,-2834.6348 1400.2236,-2791.4481 1464.2293,-2741.6832 1508.3269,-2756.3527 1549.3953,-2686.4481 1626.8153,-2554.6674 1499.3721,-2470.781 1585.3953,-2344.4481 1669.621,-2220.7547 2063.2166,-2123.5632 2182.6875,-2033.4481 2201.2608,-2019.4385 2198.4911,-2006.9954 2218.6875,-1995.4481 2263.385,-1969.8921 2421.5909,-1897.3236 2444.4712,-1943.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M1474.8094,-4144.4481C1670.9583,-4254.7713 1890.6351,-4415.4967 1961.1439,-4468.089"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1959.254,-4471.0461 1969.3588,-4474.2313 1963.4458,-4465.4399 1959.254,-4471.0461"/>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M757.0526,-3249.6074C766.5131,-3303.5527 809.5856,-3536.9699 855.7932,-3592.4481 904.5977,-3651.0441 956.149,-3614.0822 1009.6252,-3668.4481 1035.8349,-3695.0937 1026.3039,-3712.4539 1045.6252,-3744.4481 1089.3016,-3816.7715 1123.9273,-3819.9487 1159.79,-3896.4481 1189.2586,-3959.3079 1147.818,-3998.2641 1195.79,-4048.4481 1249.5771,-4104.7152 1290.9328,-4070.228 1364.2236,-4096.4481 1414.6719,-4114.4962 1428.9909,-4116.6736 1474.8094,-4144.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge341" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1102.7076,-3236.4481C1263.6697,-3194.7141 1309.2568,-3181.8652 1474.8094,-3197.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge351" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M932.7092,-3426.4481C1062.2719,-3518.389 1073.7121,-3566.7791 1195.79,-3668.4481 1286.7945,-3744.2384 1401.3758,-3826.6373 1450.5656,-3861.4303"/>
<polygon fill="#ff0062" stroke="#ff0062" points="1448.7806,-3864.4544 1458.969,-3867.3606 1452.8167,-3858.7351 1448.7806,-3864.4544"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-2894.4481C1281.2475,-2893.7665 1548.8109,-2589.7374 1549.3953,-2588.4481 1600.6453,-2475.3738 1531.9255,-2423.4897 1585.3953,-2311.4481 1650.9703,-2174.0408 1918.0926,-1875.4035 2058.0432,-1815.4481 2108.9646,-1793.6331 2128.868,-1802.3201 2182.6875,-1815.4481 2209.7814,-1822.057 2237.7324,-1837.5463 2256.8736,-1849.7328"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2254.9825,-1852.6781 2265.2665,-1855.2259 2258.8159,-1846.8211 2254.9825,-1852.6781"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M762.5687,-3227.3983C774.8731,-3208.9906 800.0693,-3170.7744 819.7932,-3137.4481 836.8114,-3108.6935 837.1191,-3099.1558 855.7932,-3071.4481 1127.5314,-2668.2567 1277.6571,-2628.6394 1549.3953,-2225.4481 1568.0694,-2197.7403 1568.8893,-2188.4997 1585.3953,-2159.4481 1609.2229,-2117.5096 1638.2221,-2069.0651 1654.2609,-2042.4873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1657.3722,-2044.1059 1659.55,-2033.7373 1651.3816,-2040.4848 1657.3722,-2044.1059"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M932.7092,-2247.4481C947.6592,-2214.9076 983.8793,-2248.3385 1009.6252,-2223.4481 1044.4896,-2189.7422 1020.2597,-2161.7784 1045.6252,-2120.4481 1083.9625,-2057.9819 1121.9928,-2064.2425 1159.79,-2001.4481 1186.1004,-1957.7373 1158.9761,-1927.7694 1195.79,-1892.4481 1223.874,-1865.5027 1258.7437,-1901.0462 1280.0068,-1868.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M760.7096,-3227.22C774.0136,-3199.7633 807.4246,-3126.6984 819.7932,-3061.4481 850.3043,-2900.4877 789.3313,-1737.1877 855.7932,-1587.4481 900.6249,-1486.4417 1175.6687,-1266.031 1257.2312,-1202.1359"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1259.6306,-1204.703 1265.3558,-1195.7882 1255.3209,-1199.1869 1259.6306,-1204.703"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.6518,-3227.2088C773.8276,-3199.7274 806.9753,-3126.6117 819.7932,-3061.4481 840.0091,-2958.6744 814.0162,-2215.4991 855.7932,-2119.4481 867.7273,-2092.0099 1020.8166,-1945.1754 1045.6252,-1928.4481 1068.444,-1913.0625 1079.3123,-1918.9418 1102.7076,-1904.4481"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M788.749,-3241.3052C799.5299,-3243.5722 810.9539,-3247.5419 819.7932,-3254.4481 846.74,-3275.5017 837.5751,-3293.5088 855.7932,-3322.4481 886.4211,-3371.1003 885.8246,-3393.1775 932.7092,-3426.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-3426.4481C994.3263,-3470.1731 1030.2157,-3405.1536 1102.7076,-3426.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-3426.4481C1240.1547,-3466.8231 1265.8074,-3500.9091 1400.2236,-3550.4481 1465.573,-3574.5325 1500.4645,-3548.8862 1549.3953,-3598.4481 1587.6187,-3637.1646 1547.1081,-3676.7945 1585.3953,-3715.4481 1650.3887,-3781.0636 1695.2871,-3750.8253 1783.415,-3778.4481 1872.5475,-3806.3857 1892.1461,-3856.1188 1984.2305,-3840.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-3840.4481C2007.4452,-3836.368 2033.2321,-3835.315 2056.0642,-3835.5499"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2056.263,-3839.0541 2066.3269,-3835.7421 2056.3942,-3832.0553 2056.263,-3839.0541"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M757.6516,-3249.6849C772.6459,-3316.525 849.7131,-3659.198 855.7932,-3668.4481 902.5348,-3739.559 960.2183,-3713.1625 1009.6252,-3782.4481 1040.4739,-3825.7086 1019.8838,-3849.967 1045.6252,-3896.4481 1083.53,-3964.8924 1113.1607,-3967.622 1159.79,-4030.4481 1177.424,-4054.2072 1173.3836,-4067.1243 1195.79,-4086.4481 1257.9831,-4140.0847 1301.1007,-4109.9089 1364.2236,-4162.4481 1475.2187,-4254.8327 1485.6214,-4299.8807 1549.3953,-4429.4481 1572.6723,-4476.7392 1555.071,-4499.3353 1585.3953,-4542.4481 1611.4793,-4579.5324 1628.028,-4580.3064 1666.4052,-4604.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-4604.4481C1696.8972,-4626.3644 1713.4088,-4612.5211 1747.415,-4628.4481 1764.8293,-4636.6041 1766.3721,-4643.5422 1783.415,-4652.4481 1790.4293,-4656.1134 1798.1064,-4659.568 1805.623,-4662.6724"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1804.4109,-4665.957 1814.9962,-4666.4067 1807.0017,-4659.454 1804.4109,-4665.957"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge387" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2608.0172,-2986.4481C2615.8156,-2986.4481 2624.5407,-2986.4481 2633.5511,-2986.4481"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2633.8113,-2989.9482 2643.8113,-2986.4481 2633.8113,-2982.9482 2633.8113,-2989.9482"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge388" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-4486.4481C2246.8185,-4547.9295 2150.4786,-5046.173 2281.0071,-5098.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-5098.4481C2530.5665,-5198.3936 2437.6956,-4797.478 2509.6157,-4538.4481 2535.6066,-4444.8384 2483.8236,-4134.9173 2576.7096,-4106.4481"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M1992.2768,-4496.5176C2000.7849,-4508.695 2014.0572,-4529.1119 2022.0432,-4548.4481 2078.7013,-4685.6308 2108.3862,-4863.4693 2117.3721,-4924.1117"/>
<polygon fill="#ffc500" stroke="#ffc500" points="2113.9553,-4924.9393 2118.8532,-4934.334 2120.883,-4923.9355 2113.9553,-4924.9393"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M2022.0257,-4477.3094C2050.5089,-4473.11 2089.7568,-4471.5662 2120.3654,-4486.4481"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M2120.3654,-4486.4481C2231.9175,-4540.6847 2203.1255,-4342.8303 2218.6875,-4320.4481 2226.1914,-4309.6555 2237.3421,-4300.7333 2248.1455,-4293.8671"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2250.2342,-4296.6978 2257.0511,-4288.5872 2246.6643,-4290.6765 2250.2342,-4296.6978"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1991.2677,-4474.247C1998.913,-4462.0432 2011.4528,-4441.9238 2022.0432,-4424.4481 2110.9243,-4277.7814 2129.9579,-4239.2065 2218.6875,-4092.4481 2235.8046,-4064.1364 2255.9665,-4031.6056 2268.6195,-4011.2866"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2271.7041,-4012.9546 2274.0242,-4002.6169 2265.7638,-4009.2514 2271.7041,-4012.9546"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2172.6481,-1120.4535 2068.0827,-1120.4535 2068.0827,-1098.4426 2172.6481,-1098.4426 2172.6481,-1120.4535"/>
<text text-anchor="middle" x="2120.3654" y="-1106.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1993.8467,-4474.2234C2003.0985,-4462.6336 2016.4778,-4443.5913 2022.0432,-4424.4481 2047.5574,-4336.6873 2006.4287,-1209.8727 2058.0432,-1134.4481 2060.2117,-1131.2792 2062.8539,-1128.5119 2065.812,-1126.0953"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2067.8738,-1128.9277 2074.2715,-1120.4826 2064.0038,-1123.0948 2067.8738,-1128.9277"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1993.332,-4474.0556C2002.1834,-4462.3353 2015.2577,-4443.1936 2022.0432,-4424.4481 2061.1507,-4316.4111 2039.3456,-4281.8138 2058.0432,-4168.4481 2077.3009,-4051.6863 2105.3383,-3912.5903 2116.0162,-3860.507"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2119.4898,-3860.9908 2118.0759,-3850.4907 2112.6333,-3859.5808 2119.4898,-3860.9908"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-699.4535 539.0902,-699.4535 539.0902,-677.4426 632.3482,-677.4426 632.3482,-699.4535"/>
<text text-anchor="middle" x="585.7192" y="-685.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge389" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M591.8858,-677.1273C604.5187,-653.7015 633.8819,-598.0331 654.4731,-549.4481 673.0691,-505.5709 659.1701,-484.3804 690.4731,-448.4481 856.7802,-257.5462 955.8387,-266.2252 1195.79,-185.4481 1283.1539,-156.0379 1308.3734,-158.2539 1400.2236,-150.4481 1466.284,-144.834 1483.5281,-142.8981 1549.3953,-150.4481 1653.9233,-162.4295 2089.7514,-266.5073 2120.3654,-288.4481"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M602.7709,-677.3203C677.7103,-629.9352 981.9773,-453.616 1159.79,-592.4481 1211.7877,-633.0466 1166.1261,-677.5239 1195.79,-736.4481 1248.814,-841.7743 1289.6233,-850.1247 1364.2236,-941.4481 1537.7977,-1153.932 1605.6892,-1190.5201 1747.415,-1425.4481 1753.0593,-1434.8041 1906.9491,-1773.0865 1910.4177,-1783.4481 1982.9729,-2000.1866 1977.272,-2061.3155 2022.0432,-2285.4481 2039.992,-2375.3029 2037.2026,-2399.2196 2058.0432,-2488.4481 2103.1053,-2681.3801 2151.7802,-2720.749 2182.6875,-2916.4481 2224.4447,-3180.8461 2164.4916,-3858.3169 2218.6875,-4120.4481 2229.3102,-4171.827 2255.522,-4228.0714 2270.346,-4257.2875"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2267.374,-4259.1607 2275.0702,-4266.4421 2273.5945,-4255.9505 2267.374,-4259.1607"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M932.7092,-841.4481C992.9792,-863.4946 990.6761,-898.2952 1045.6252,-931.4481 1051.4757,-934.9779 1057.9137,-938.2876 1064.2933,-941.271"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1062.9652,-944.5111 1073.523,-945.3963 1065.8216,-938.1204 1062.9652,-944.5111"/>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M617.7631,-699.4813C629.4035,-703.6514 642.6082,-708.5714 654.4731,-713.4481 780.3724,-765.1941 804.8748,-794.6867 932.7092,-841.4481"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M588.0372,-699.6754C598.2608,-749.7858 639.4778,-958.1445 654.4731,-1131.4481 672.9624,-1345.1314 651.1359,-2850.6045 690.4731,-3061.4481 701.4641,-3120.3583 729.8312,-3185.5855 745.0809,-3217.9287"/>
<polygon fill="#1000ff" stroke="#1000ff" points="742.0567,-3219.7171 749.5326,-3227.2245 748.3701,-3216.6936 742.0567,-3219.7171"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1134,-677.38C616.5308,-665.5806 639.9908,-645.5766 654.4731,-623.4481 680.3405,-583.9235 651.9033,-550.7185 690.4731,-523.4481 860.7891,-403.0276 998.6207,-389.0357 1159.79,-521.4481 1223.5015,-573.7917 1138.2657,-644.3722 1195.79,-703.4481 1249.3272,-758.4293 1298.7134,-701.4784 1364.2236,-741.4481 1385.5006,-754.4298 1381.4735,-768.0265 1400.2236,-784.4481 1537.6478,-904.8052 1593.2601,-906.4303 1747.415,-1004.4481 1819.9325,-1050.5575 1845.9355,-1051.6422 1910.4177,-1108.4481 2052.3225,-1233.4598 2098.848,-1265.9316 2182.6875,-1435.4481 2254.5853,-1580.8196 2274.7786,-1779.8623 2279.6377,-1844.9226"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2276.164,-1845.4213 2280.355,-1855.152 2283.1468,-1844.9316 2276.164,-1845.4213"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1549.4812,-2822.4535 1400.1377,-2822.4535 1400.1377,-2800.4426 1549.4812,-2800.4426 1549.4812,-2822.4535"/>
<text text-anchor="middle" x="1474.8094" y="-2808.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M632.5091,-689.6682C737.1292,-695.2026 989.6443,-724.7537 1102.7076,-879.4481"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1102.7076,-879.4481C1122.1976,-898.8788 1140.9699,-883.3679 1159.79,-903.4481 1193.239,-939.1365 1166.787,-968.0613 1195.79,-1007.4481 1250.9093,-1082.3014 1320.6398,-1049.3408 1364.2236,-1131.4481 1411.355,-1220.2384 1393.4122,-1935.155 1400.2236,-2035.4481 1420.5833,-2335.2258 1461.7229,-2698.6537 1472.2901,-2789.8891"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1468.8428,-2790.5465 1473.4741,-2800.0755 1475.796,-2789.7382 1468.8428,-2790.5465"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1102.7076,-879.4481C1118.9472,-901.6672 1142.998,-881.6435 1159.79,-903.4481 1229.8946,-994.4796 1120.8117,-1072.387 1195.79,-1159.4481 1198.6452,-1162.7634 1201.9181,-1165.6496 1205.4791,-1168.1612"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1203.8645,-1171.273 1214.2502,-1173.3677 1207.4376,-1165.2536 1203.8645,-1171.273"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.8044,-699.6825C591.2392,-738.9169 611.6885,-870.7397 690.4731,-931.4481 804.0946,-1019.0003 903.2212,-883.2534 1009.6252,-979.4481 1057.6025,-1022.822 1027.4997,-1058.3628 1045.6252,-1120.4481 1105.4223,-1325.2707 1123.4815,-1375.7008 1195.79,-1576.4481 1221.7429,-1648.4999 1255.8603,-1732.7449 1271.5039,-1770.8603"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1268.3623,-1772.4233 1275.4042,-1780.3391 1274.8357,-1769.7596 1268.3623,-1772.4233"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-1158.4535 -.2403,-1158.4535 -.2403,-1136.4426 130.719,-1136.4426 130.719,-1158.4535"/>
<text text-anchor="middle" x="65.2394" y="-1144.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge390" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-5811.4481C2114.8947,-5786.4458 2154.8576,-5814.6921 2281.0071,-5772.4481"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4068.4481C302.387,-4242.7856 378.3407,-3391.1536 516.9653,-3259.4481 518.8259,-3257.6804 520.8311,-3256.0612 522.9458,-3254.5781"/>
<polygon fill="#ff0000" stroke="#ff0000" points="524.725,-3257.5921 531.5702,-3249.5055 521.1761,-3251.5584 524.725,-3257.5921"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M223.8406,-4068.4481C327.375,-4293.7378 149.8206,-4435.5323 317.2024,-4618.4481 368.0032,-4673.9635 431.9018,-4604.3915 480.9653,-4661.4481 530.0707,-4718.5533 482.7412,-4931.3582 516.9653,-4998.4481 554.3606,-5071.7544 615.4625,-5049.9884 654.4731,-5122.4481 704.9784,-5216.2582 622.2651,-5277.6021 690.4731,-5359.4481 740.2298,-5419.1533 779.1415,-5403.6048 855.7932,-5416.4481 1152.2621,-5466.1224 1989.1164,-5383.4298 2182.6875,-5153.4481 2276.273,-5042.2591 2124.7909,-4611.3744 2218.6875,-4500.4481 2237.0285,-4478.7806 2276.421,-4514.4631 2281.0071,-4486.4481"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M399.0839,-4794.4481C426.4622,-4819.8665 455.026,-4786.5627 480.9653,-4813.4481 539.1257,-4873.7296 452.3251,-4945.174 516.9653,-4998.4481 564.1269,-5037.3169 594.7715,-5011.5137 654.4731,-4998.4481 656.9418,-4997.9078 817.7797,-4923.9752 819.7932,-4922.4481 835.2385,-4910.7334 1031.5489,-4669.7765 1045.6252,-4656.4481 1106.4704,-4598.8357 1125.2461,-4587.6684 1195.79,-4542.4481 1267.2454,-4496.6435 1295.8984,-4502.8027 1364.2236,-4452.4481 1457.3681,-4383.8021 1497.373,-4372.8011 1549.3953,-4269.4481 1600.4598,-4167.9977 1544.375,-4122.3589 1585.3953,-4016.4481 1631.6107,-3897.1236 1697.1358,-3896.1179 1747.415,-3778.4481 1816.6941,-3616.3126 1839.5388,-3401.2261 1845.2852,-3333.098"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1848.8014,-3333.0373 1846.1165,-3322.7883 1841.824,-3332.4746 1848.8014,-3333.0373"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M223.8406,-4068.4481C226.1907,-4074.412 297.9066,-4056.6004 348.8547,-4043.1109"/>
<polygon fill="#ff9400" stroke="#ff9400" points="349.9778,-4046.4339 358.7407,-4040.4789 348.1768,-4039.6695 349.9778,-4046.4339"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M932.7092,-5630.4481C1032.354,-5579.8443 1060.4491,-5573.6458 1159.79,-5522.4481 1501.1551,-5346.5175 1586.4675,-5300.6953 1910.4177,-5094.4481 1960.4218,-5062.6123 1979.3897,-5062.6136 2022.0432,-5021.4481 2042.0069,-5002.1808 2036.2757,-4987.6514 2058.0432,-4970.4481 2062.6721,-4966.7898 2067.9065,-4963.6008 2073.3261,-4960.8387"/>
<polygon fill="#ffc500" stroke="#ffc500" points="2074.9327,-4963.9521 2082.5475,-4956.5855 2072.0009,-4957.5956 2074.9327,-4963.9521"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#fff600" stroke-dasharray="5,2" d="M223.8406,-4068.4481C345.3713,-4376.8633 103.6508,-4554.9025 317.2024,-4808.4481 325.2065,-4817.9512 336.7142,-4823.9138 348.5837,-4827.6347"/>
<polygon fill="#fff600" stroke="#fff600" points="348.009,-4831.1025 358.5704,-4830.2616 349.7897,-4824.3328 348.009,-4831.1025"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1102.7076,-5858.4481C1198.4934,-5853.1736 1839.2242,-5617.7458 1910.4177,-5553.4481 1950.6342,-5517.1269 2171.9663,-5148.7095 2182.6875,-5113.4481 2234.0034,-4944.6732 2133.1735,-4474.7388 2218.6875,-4320.4481 2224.8605,-4309.3102 2235.2858,-4300.4443 2245.861,-4293.7257"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2247.8093,-4296.6414 2254.6894,-4288.5845 2244.2866,-4290.5924 2247.8093,-4296.6414"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M755.1332,-5783.4481C774.8872,-5783.3739 1082.9642,-5857.7979 1102.7076,-5858.4481"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#a4ff00" stroke-dasharray="5,2" d="M223.8406,-4068.4481C240.6432,-4111.0889 295.9616,-4117.6115 340.0052,-4115.4398"/>
<polygon fill="#a4ff00" stroke="#a4ff00" points="340.3164,-4118.927 350.0688,-4114.7869 339.8632,-4111.9417 340.3164,-4118.927"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M585.7192,-309.4481C744.6257,-204.5499 828.5445,-312.5868 1009.6252,-371.4481 1078.1331,-393.7169 1115.1064,-375.945 1159.79,-432.4481 1224.7871,-514.6377 1126.4423,-586.8946 1195.79,-665.4481 1221.5478,-694.6251 1246.3416,-669.9184 1280.0068,-689.4481"/>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M1280.0068,-689.4481C1313.7385,-708.8629 1329.2046,-696.4649 1364.2236,-713.4481 1381.982,-722.0604 1382.6671,-730.4314 1400.2236,-739.4481 1407.9911,-743.4372 1416.5311,-746.9932 1424.9733,-750.0836"/>
<polygon fill="#73ff00" stroke="#73ff00" points="1423.8219,-753.3887 1434.4168,-753.3731 1426.1246,-746.7783 1423.8219,-753.3887"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M399.0839,-497.4481C435.8632,-504.0018 456.9165,-487.8592 480.9653,-516.4481 573.0909,-625.9658 449.133,-1033.4322 516.9653,-1159.4481 561.3074,-1241.8248 662.5851,-1296.3971 717.7097,-1321.1603"/>
<polygon fill="#41ff00" stroke="#41ff00" points="716.5547,-1324.4758 727.1176,-1325.2979 719.3728,-1318.0681 716.5547,-1324.4758"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#10ff00" stroke-dasharray="5,2" d="M585.7192,-5136.4481C775.6623,-5210.8519 849.2133,-5086.473 1009.6252,-4960.4481 1064.6554,-4917.2146 1138.5678,-4746.7353 1195.79,-4706.4481 1203.2082,-4701.2253 1211.726,-4697.0799 1220.4319,-4693.7931"/>
<polygon fill="#10ff00" stroke="#10ff00" points="1221.5791,-4697.0999 1229.9094,-4690.5533 1219.3148,-4690.4762 1221.5791,-4697.0999"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M223.8406,-4068.4481C236.8902,-4093.9505 460.2316,-4069.2162 480.9653,-4049.4481 576.5622,-3958.3033 434.0979,-3857.3029 516.9653,-3754.4481 557.5766,-3704.0415 597.3389,-3736.8748 654.4731,-3706.4481 741.5058,-3660.099 945.0788,-3514.9912 1009.6252,-3440.4481 1031.4974,-3415.1884 1022.7328,-3398.7869 1045.6252,-3374.4481 1160.1706,-3252.6656 1251.1686,-3297.6152 1364.2236,-3174.4481 1387.8806,-3148.6751 1375.7651,-3129.4617 1400.2236,-3104.4481 1452.9672,-3050.5073 1494.3222,-3075.0082 1549.3953,-3023.4481 1571.2684,-3002.9702 1560.7288,-2983.4582 1585.3953,-2966.4481 1640.9542,-2928.1342 1717.971,-2916.2634 1774.031,-2913.1473"/>
<polygon fill="#00ff20" stroke="#00ff20" points="1774.422,-2916.6328 1784.2449,-2912.6629 1774.0903,-2909.6406 1774.422,-2916.6328"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M585.7192,-5136.4481C652.3504,-5162.7529 793.563,-4995.9311 855.7932,-4960.4481 922.0395,-4922.6751 961.8145,-4943.8577 1009.6252,-4884.4481 1051.2557,-4832.7181 1006.4958,-4793.0948 1045.6252,-4739.4481 1094.6784,-4672.1958 1308.8883,-4604.634 1364.2236,-4542.4481 1389.3368,-4514.2259 1370.6687,-4488.9782 1400.2236,-4465.4481 1404.8698,-4461.749 1410.177,-4458.8549 1415.7708,-4456.5973"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1417.023,-4459.869 1425.3897,-4453.369 1414.7957,-4453.2328 1417.023,-4459.869"/>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M399.0839,-4794.4481C426.1715,-4820.1761 456.0156,-4785.6419 480.9653,-4813.4481 570.3552,-4913.0719 433.0745,-5008.1515 516.9653,-5112.4481 537.2507,-5137.6677 555.9299,-5123.7942 585.7192,-5136.4481"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M755.1332,-5783.4481C784.2636,-5783.4481 981.9843,-5729.6439 1009.6252,-5720.4481 1256.7305,-5638.2388 1330.1576,-5632.9979 1549.3953,-5492.4481 1788.9795,-5338.8544 1843.4971,-5282.0624 2022.0432,-5060.4481 2042.034,-5035.6352 2032.3499,-5017.2938 2058.0432,-4998.4481 2080.9345,-4981.6575 2109.7055,-5010.7597 2120.3654,-4984.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M585.7192,-5783.4481C649.6477,-5823.2287 679.8386,-5783.7307 755.1332,-5783.4481"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M1102.7076,-5858.4481C1267.8696,-5849.9868 1309.4309,-5858.4481 1474.8094,-5858.4481 1474.8094,-5858.4481 1474.8094,-5858.4481 1666.4052,-5858.4481 1775.3785,-5858.4481 1803.6177,-5856.1033 1910.4177,-5834.4481 1944.0938,-5827.6198 1950.8218,-5819.4832 1984.2305,-5811.4481"/>
<path fill="none" stroke="#00ffb4" stroke-dasharray="5,2" d="M1984.2305,-5811.4481C2016.241,-5805.3229 2051.6038,-5795.0836 2078.2635,-5786.6334"/>
<polygon fill="#00ffb4" stroke="#00ffb4" points="2079.5803,-5789.8866 2088.0298,-5783.4947 2077.4385,-5783.2223 2079.5803,-5789.8866"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe6" stroke-dasharray="5,2" d="M68.4797,-1158.804C78.143,-1190.796 109.6747,-1282.7599 166.4788,-1335.4481 278.6508,-1439.4923 349.7344,-1396.7957 480.9653,-1475.4481 498.3516,-1485.8684 499.352,-1493.4163 516.9653,-1503.4481 642.6222,-1575.0168 735.0276,-1505.2878 819.7932,-1622.4481 903.1615,-1737.6771 768.9967,-2148.7788 855.7932,-2261.4481 859.2744,-2265.9669 863.5876,-2269.6811 868.3812,-2272.7322"/>
<polygon fill="#00ffe6" stroke="#00ffe6" points="866.9776,-2275.9494 877.4525,-2277.5388 870.255,-2269.7641 866.9776,-2275.9494"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M755.1332,-119.4481C810.5829,-94.5988 958.5174,-186.5824 1009.6252,-219.4481 1058.0266,-250.5733 1057.4745,-273.8751 1102.7076,-309.4481"/>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M1102.7076,-309.4481C1127.0194,-329.4735 1143.1083,-324.731 1159.79,-351.4481 1207.161,-427.3163 1148.7202,-473.3926 1195.79,-549.4481 1208.2278,-569.545 1229.6179,-585.425 1247.7277,-596.2147"/>
<polygon fill="#00e6ff" stroke="#00e6ff" points="1246.4105,-599.4918 1256.8342,-601.3884 1249.8684,-593.4054 1246.4105,-599.4918"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M223.8406,-575.4481C263.5958,-546.6576 273.2014,-612.6931 317.2024,-634.4481 402.0748,-676.4107 427.3615,-677.8645 516.9653,-708.4481 577.5656,-729.1321 596.6911,-723.8534 654.4731,-751.4481 671.8255,-759.735 672.9701,-767.4842 690.4731,-775.4481 792.0391,-821.6605 828.13,-802.5327 932.7092,-841.4481"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M399.0839,-4794.4481C445.0361,-4839.7223 617.0162,-4708.968 654.4731,-4656.4481 711.4935,-4576.4973 639.4088,-4522.3283 690.4731,-4438.4481 782.4834,-4287.3086 893.5655,-4334.0114 1009.6252,-4200.4481 1136.4137,-4054.538 1410.4482,-3485.596 1465.1832,-3370.7295"/>
<polygon fill="#0083ff" stroke="#0083ff" points="1468.3938,-3372.1278 1469.5297,-3361.594 1462.0728,-3369.1203 1468.3938,-3372.1278"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M223.8406,-922.4481C268.3818,-905.3393 271.0695,-881.6295 317.2024,-869.4481 387.574,-850.8663 409.7339,-854.4973 480.9653,-869.4481 580.4934,-890.338 597.2542,-920.7976 690.4731,-961.4481 747.8849,-986.4839 779.1946,-969.7547 819.7932,-1017.4481 861.9959,-1067.0258 827.3581,-1100.878 855.7932,-1159.4481 904.7697,-1260.329 970.1227,-1254.4947 1009.6252,-1359.4481 1097.3228,-1592.4497 948.6221,-1689.1643 1045.6252,-1918.4481 1053.0788,-1936.0658 1067.6168,-1951.9928 1080.1552,-1963.4252"/>
<polygon fill="#0020ff" stroke="#0020ff" points="1078.17,-1966.3374 1088.0114,-1970.2615 1082.7651,-1961.0567 1078.17,-1966.3374"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M223.8406,-4068.4481C353.3822,-4321.6065 197.5769,-4443.4559 317.2024,-4701.4481 340.3684,-4751.4095 361.6629,-4754.0441 399.0839,-4794.4481"/>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M399.0839,-4794.4481C436.5048,-4834.852 455.5598,-4750.3087 480.9653,-4701.4481 512.3943,-4641.003 497.7432,-4617.8078 516.9653,-4552.4481 569.4138,-4374.1116 618.2726,-4339.7782 654.4731,-4157.4481 709.1765,-3881.9256 651.5755,-3804.6424 690.4731,-3526.4481 704.6601,-3424.9833 736.1245,-3306.3466 749.2276,-3259.2432"/>
<polygon fill="#1000ff" stroke="#1000ff" points="752.6072,-3260.1536 751.9384,-3249.5799 745.8674,-3258.2628 752.6072,-3260.1536"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1102.7076,-18.4481C1299.6441,9.3608 1358.1351,9.1125 1549.3953,-45.4481 1645.593,-72.8903 1660.9091,-102.2106 1747.415,-152.4481 1944.4792,-266.8911 2017.6751,-266.2782 2182.6875,-423.4481 2203.0415,-442.8347 2198.6327,-455.7522 2218.6875,-475.4481 2266.1712,-522.0819 2297.0682,-510.5986 2343.3267,-558.4481 2441.0196,-659.5013 2469.1045,-692.8579 2509.6157,-827.4481 2542.1352,-935.4873 2572.8149,-2748.9062 2576.3675,-2965.3743"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2572.8689,-2965.4997 2576.532,-2975.4412 2579.868,-2965.3853 2572.8689,-2965.4997"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M399.0839,-497.4481C474.5694,-506.6166 462.915,-426.9336 516.9653,-373.4481 546.6397,-344.0837 550.5414,-331.9281 585.7192,-309.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M755.1332,-119.4481C832.6634,-82.5862 847.6427,-54.9988 932.7092,-43.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M223.8406,-575.4481C292.1397,-524.4263 314.4533,-487.1688 399.0839,-497.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M67.4819,-1136.3004C83.0266,-1059.5611 175.5434,-611.5276 223.8406,-575.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M585.7192,-309.4481C681.0537,-248.5255 652.956,-168.0283 755.1332,-119.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M932.7092,-43.4481C1008.3823,-33.1728 1026.4543,-22.6221 1102.7076,-18.4481"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M585.7192,-5783.4481C660.766,-5821.7855 850.2921,-5648.0323 932.7092,-5630.4481"/>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M223.8406,-4068.4481C384.1352,-4381.0994 251.2454,-4508.3468 317.2024,-4853.4481 382.2011,-5193.5355 409.7235,-5277.2316 516.9653,-5606.4481 543.1044,-5686.6911 516.1843,-5735.6246 585.7192,-5783.4481"/>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M932.7092,-5630.4481C1061.0969,-5566.8094 1837.5624,-4912.8392 1910.4177,-4789.4481 1966.511,-4694.446 1980.0599,-4558.8002 1983.2636,-4506.8302"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1986.7756,-4506.7045 1983.8269,-4496.5283 1979.7861,-4506.3223 1986.7756,-4506.7045"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge333" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#a400ff" stroke-dasharray="5,2" d="M223.8406,-575.4481C270.1872,-541.7633 428.2506,-572.0019 480.9653,-594.4481 483.5341,-595.5418 535.8538,-643.0092 565.5592,-670.0606"/>
<polygon fill="#a400ff" stroke="#a400ff" points="563.5287,-672.9455 573.2778,-677.0936 568.2433,-667.7713 563.5287,-672.9455"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1352.5923,-4994.4535 1207.4214,-4994.4535 1207.4214,-4972.4426 1352.5923,-4972.4426 1352.5923,-4994.4535"/>
<text text-anchor="middle" x="1280.0068" y="-4980.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge335" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff00f6" stroke-dasharray="5,2" d="M585.7192,-5278.4481C750.2181,-5391.6783 833.2292,-5223.0717 1009.6252,-5129.4481 1055.1121,-5105.3055 1056.9899,-5084.1506 1102.7076,-5060.4481"/>
<path fill="none" stroke="#ff00f6" stroke-dasharray="5,2" d="M399.0839,-4794.4481C424.969,-4821.3856 456.2025,-4785.4754 480.9653,-4813.4481 530.8871,-4869.841 494.7321,-5078.4896 516.9653,-5150.4481 536.0285,-5212.1464 537.056,-5235.9983 585.7192,-5278.4481"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1461.4535 180.0456,-1461.4535 180.0456,-1439.4426 267.6355,-1439.4426 267.6355,-1461.4535"/>
<text text-anchor="middle" x="223.8406" y="-1447.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge336" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#ff00c5" stroke-dasharray="5,2" d="M68.4569,-1158.6183C78.9618,-1194.0397 114.5901,-1306.2958 166.4788,-1387.4481 177.068,-1404.0093 192.1206,-1420.3531 204.1492,-1432.2424"/>
<polygon fill="#ff00c5" stroke="#ff00c5" points="201.912,-1434.9473 211.5398,-1439.3697 206.7712,-1429.9086 201.912,-1434.9473"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge345" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M399.0839,-4794.4481C441.6675,-4834.8943 612.5273,-4767.5555 654.4731,-4726.4481 695.7642,-4685.9824 661.7069,-4651.5971 690.4731,-4601.4481 792.7935,-4423.0705 882.852,-4428.3634 1009.6252,-4266.4481 1246.7971,-3963.5311 1267.7209,-3860.6756 1474.8094,-3536.4481"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge352" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M399.0839,-4794.4481C425.4286,-4820.9363 447.9147,-4796.0319 480.9653,-4813.4481 500.1675,-4823.5667 496.7367,-4838.5795 516.9653,-4846.4481 573.9226,-4868.6035 605.7207,-4883.3017 654.4731,-4846.4481 701.2742,-4811.0695 658.7063,-4768.7719 690.4731,-4719.4481 742.6066,-4638.5013 780.2119,-4639.0948 855.7932,-4579.4481 922.3872,-4526.8939 947.5776,-4524.2995 1009.6252,-4466.4481 1187.8108,-4300.3131 1218.7103,-4243.8369 1364.2236,-4048.4481 1403.1031,-3996.2425 1443.501,-3930.7798 1462.9475,-3898.4343"/>
<polygon fill="#ff0062" stroke="#ff0062" points="1466.1556,-3899.8892 1468.2851,-3889.5106 1460.1482,-3896.2959 1466.1556,-3899.8892"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge358" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M65.4132,-1158.5706C68.3592,-1343.5518 109.2175,-3777.5627 223.8406,-4068.4481"/>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M223.8406,-4068.4481C380.8378,-4466.8687 250.5241,-3532.4624 317.2024,-3109.4481 381.8107,-2699.5659 243.7209,-2509.7222 516.9653,-2197.4481 519.9632,-2194.022 523.4695,-2191.0652 527.283,-2188.5134"/>
<polygon fill="#ff0031" stroke="#ff0031" points="529.0691,-2191.5242 536.0441,-2183.5493 525.6182,-2185.4339 529.0691,-2191.5242"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-43.4481C1044.5183,-24.9409 1062.3942,-101.5012 1159.79,-159.4481 1227.8294,-199.9289 1685.8034,-512.7283 1747.415,-562.4481 1764.5418,-576.2691 1767.0935,-581.6849 1783.415,-596.4481 1811.1051,-621.4944 1818.2887,-627.4791 1846.9164,-651.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1846.9164,-651.4481C1956.9637,-750.2803 1952.319,-803.9998 2022.0432,-934.4481 2040.2316,-968.4771 2032.4443,-984.578 2058.0432,-1013.4481 2101.0897,-1061.9952 2147.4258,-1034.9831 2182.6875,-1089.4481 2266.9041,-1219.5285 2279.0965,-1733.9381 2280.7577,-1845.1685"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2277.2614,-1845.4765 2280.8972,-1855.4279 2284.2608,-1845.3812 2277.2614,-1845.4765"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2164.2495,-1004.4535 2076.4812,-1004.4535 2076.4812,-982.4426 2164.2495,-982.4426 2164.2495,-1004.4535"/>
<text text-anchor="middle" x="2120.3654" y="-990.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1102.7076,-18.4481C1220.2592,2.7695 1261.2092,-19.9782 1364.2236,-80.4481 1469.2561,-142.1025 1482.1655,-180.8939 1549.3953,-282.4481 1570.6944,-314.6216 1562.1309,-330.6656 1585.3953,-361.4481 1699.6588,-512.6368 1788.359,-492.4796 1910.4177,-637.4481 1959.9799,-696.3128 2073.8721,-906.4466 2109.5045,-973.0459"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2106.5563,-974.9552 2114.354,-982.1278 2112.7311,-971.658 2106.5563,-974.9552"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-4794.4481C437.2415,-4834.157 453.7087,-4749.3007 480.9653,-4701.4481 506.6343,-4656.3828 495.1524,-4637.5009 516.9653,-4590.4481 565.7791,-4485.1517 596.1417,-4468.7852 654.4731,-4368.4481 890.5046,-3962.4455 942.315,-3856.6855 1159.79,-3440.4481 1283.7396,-3203.2141 1426.3411,-2911.1769 1464.8165,-2832.0381"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1468.1362,-2833.2145 1469.3581,-2822.6904 1461.84,-2830.1555 1468.1362,-2833.2145"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="459.7908,-4692.4535 338.377,-4692.4535 338.377,-4670.4426 459.7908,-4670.4426 459.7908,-4692.4535"/>
<text text-anchor="middle" x="399.0839" y="-4678.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-4068.4481C320.8489,-4314.6315 143.5286,-4456.8127 317.2024,-4656.4481 320.6504,-4660.4115 324.707,-4663.757 329.1385,-4666.5797"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="327.5978,-4669.7252 338.0613,-4671.3886 330.9188,-4663.5632 327.5978,-4669.7252"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-309.4481C740.9158,-202.6093 832.7415,-239.5432 1009.6252,-304.4481 1026.6096,-310.6802 1029.5021,-315.2412 1045.6252,-323.4481 1095.9914,-349.0849 1126.5832,-333.7173 1159.79,-379.4481 1226.5246,-471.3516 1119.9565,-547.8962 1195.79,-632.4481 1247.3755,-689.9642 1294.2474,-642.6993 1364.2236,-675.4481 1382.0994,-683.8139 1382.4783,-692.8089 1400.2236,-701.4481 1462.2603,-731.6503 1506.9097,-690.0817 1549.3953,-744.4481 1583.113,-787.5947 1577.0423,-1675.3301 1585.3953,-1729.4481 1601.5244,-1833.9472 1642.0245,-1954.3379 1658.8711,-2001.7433"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1655.5954,-2002.9776 1662.2667,-2011.2082 1662.1842,-2000.6137 1655.5954,-2002.9776"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-309.4481C613.9838,-291.8534 1138.9417,-455.4902 1159.79,-481.4481 1227.8821,-566.2282 1124.8055,-887.0746 1195.79,-969.4481 1245.8862,-1027.5818 1312.8541,-950.4364 1364.2236,-1007.4481 1455.2976,-1108.525 1314.3955,-1205.8803 1400.2236,-1311.4481 1403.5311,-1315.5162 1407.5239,-1318.9264 1411.9222,-1321.7846"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1410.3511,-1324.9144 1420.8064,-1326.6283 1413.7019,-1318.7684 1410.3511,-1324.9144"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1280.0068,-421.4481C1385.0457,-491.2071 1444.2466,-440.8547 1549.3953,-510.4481 1569.617,-523.832 1569.1411,-533.4522 1585.3953,-551.4481 1776.5098,-763.0404 1834.6418,-806.5602 2022.0432,-1021.4481 2038.6502,-1040.4908 2039.5541,-1048.2268 2058.0432,-1065.4481 2068.7496,-1075.4203 2081.8209,-1084.9793 2093.2225,-1092.6247"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2091.6458,-1095.7755 2101.9312,-1098.3174 2095.4759,-1089.9163 2091.6458,-1095.7755"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M755.1332,-119.4481C926.0167,-39.5714 1008.0724,-135.3623 1159.79,-247.4481 1235.3918,-303.301 1204.0477,-366.0822 1280.0068,-421.4481"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-4068.4481C246.2003,-4112.1449 271.9118,-4028.3725 317.2024,-4009.4481 351.6729,-3995.0448 361.7873,-3988.2956 399.0839,-3990.4481"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.3078,-547.4535 341.8599,-547.4535 341.8599,-525.4426 456.3078,-525.4426 456.3078,-547.4535"/>
<text text-anchor="middle" x="399.0839" y="-533.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-575.4481C254.8197,-552.9324 296.4313,-543.0459 331.3323,-538.8523"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="331.8836,-542.3134 341.4549,-537.7702 331.1395,-535.3531 331.8836,-542.3134"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-1232.4535 334.3841,-1232.4535 334.3841,-1210.4426 463.7837,-1210.4426 463.7837,-1232.4535"/>
<text text-anchor="middle" x="399.0839" y="-1218.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-922.4481C301.0564,-892.7886 275.3506,-1012.1011 317.2024,-1083.4481 341.9333,-1125.608 371.2265,-1174.8 387.2117,-1201.5815"/>
<polygon fill="#ff0000" stroke="#ff0000" points="384.3337,-1203.5887 392.4657,-1210.3799 390.3436,-1199.9997 384.3337,-1203.5887"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-497.4481C481.1022,-509.8394 503.1883,-505.7661 585.7192,-497.4481"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-497.4481C843.0282,-471.5146 1015.1449,-378.0693 1159.79,-592.4481 1230.4053,-697.107 1117.1097,-1060.709 1195.79,-1159.4481 1198.337,-1162.6443 1201.2735,-1165.4454 1204.4901,-1167.899"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1202.6835,-1170.8978 1213.0002,-1173.3092 1206.439,-1164.9905 1202.6835,-1170.8978"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-625.4535 353.1239,-625.4535 353.1239,-603.4426 445.0438,-603.4426 445.0438,-625.4535"/>
<text text-anchor="middle" x="399.0839" y="-611.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-575.4481C234.3076,-567.8406 304.933,-586.5128 353.2666,-600.5719"/>
<polygon fill="#ff0000" stroke="#ff0000" points="352.331,-603.9449 362.9119,-603.4019 354.3018,-597.228 352.331,-603.9449"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-497.4481C704.0751,-543.5262 795.0795,-605.8336 1009.6252,-827.4481 1032.866,-851.4546 1020.4134,-871.5208 1045.6252,-893.4481 1086.5365,-929.0295 1127.6986,-892.7455 1159.79,-936.4481 1201.9456,-993.8562 1180.6111,-1506.8608 1195.79,-1576.4481 1212.0331,-1650.9141 1250.6007,-1733.3589 1269.374,-1770.8581"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1266.4658,-1772.8621 1274.1091,-1780.199 1272.7094,-1769.697 1266.4658,-1772.8621"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1141.9456,-623.4535 1063.4697,-623.4535 1063.4697,-601.4426 1141.9456,-601.4426 1141.9456,-623.4535"/>
<text text-anchor="middle" x="1102.7076" y="-609.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-497.4481C776.0779,-477.446 826.0521,-519.2503 1009.6252,-573.4481 1015.6334,-575.2219 1043.9791,-587.1855 1067.8294,-597.4002"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1066.457,-600.6199 1077.0268,-601.3476 1069.2178,-594.1873 1066.457,-600.6199"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~datazoneenergydemands.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/datazoneenergydemands.f90.html" xlink:title="DataZoneEnergyDemands.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1009.5414,-5794.4535 855.8771,-5794.4535 855.8771,-5772.4426 1009.5414,-5772.4426 1009.5414,-5794.4535"/>
<text text-anchor="middle" x="932.7092" y="-5780.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEnergyDemands.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M755.1332,-5783.4481C784.6413,-5783.4481 816.9075,-5783.4481 845.7445,-5783.4481"/>
<polygon fill="#0000ff" stroke="#0000ff" points="845.7914,-5786.9482 855.7914,-5783.4481 845.7913,-5779.9482 845.7914,-5786.9482"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-817.4535 340.6161,-817.4535 340.6161,-795.4426 457.5516,-795.4426 457.5516,-817.4535"/>
<text text-anchor="middle" x="399.0839" y="-803.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-922.4481C277.9316,-901.6711 267.3389,-860.9634 317.2024,-831.4481 324.2042,-827.3035 331.9557,-823.7883 339.816,-820.8229"/>
<polygon fill="#ff0000" stroke="#ff0000" points="341.1266,-824.0726 349.4148,-817.4729 338.82,-817.4635 341.1266,-824.0726"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M68.3378,-1136.241C80.1702,-1096.072 126.8057,-959.7202 223.8406,-922.4481"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-779.4535 168.8556,-779.4535 168.8556,-757.4426 278.8255,-757.4426 278.8255,-779.4535"/>
<text text-anchor="middle" x="223.8406" y="-765.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M69.986,-1136.1054C92.1943,-1083.0355 185.9876,-858.903 215.1506,-789.2139"/>
<polygon fill="#7fff00" stroke="#7fff00" points="218.4808,-790.3225 219.1125,-779.7466 212.0234,-787.6203 218.4808,-790.3225"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-933.4535 323.0941,-933.4535 323.0941,-911.4426 475.0737,-911.4426 475.0737,-933.4535"/>
<text text-anchor="middle" x="399.0839" y="-919.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-922.4481C254.8499,-910.5371 291.2853,-908.7861 322.8777,-910.6953"/>
<polygon fill="#00ffff" stroke="#00ffff" points="322.7221,-914.1932 332.9518,-911.4356 323.2352,-907.2121 322.7221,-914.1932"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-1026.4535 317.3208,-1026.4535 317.3208,-1004.4426 480.847,-1004.4426 480.847,-1026.4535"/>
<text text-anchor="middle" x="399.0839" y="-1012.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-922.4481C268.3818,-905.3393 274.9991,-953.1879 317.2024,-975.4481 333.0438,-983.8036 350.8863,-992.5912 365.8624,-999.7948"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="364.7085,-1003.1226 375.24,-1004.2794 367.7286,-996.8076 364.7085,-1003.1226"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-421.4481C1410.8812,-520.1939 1458.6428,-536.9093 1549.3953,-673.4481 2100.1036,-1501.9987 1944.4995,-1869.5999 2022.0432,-2861.4481 2029.9736,-2962.8839 2017.5186,-3683.1214 2058.0432,-3776.4481 2066.0102,-3794.7959 2081.9599,-3810.7569 2095.7288,-3822.0229"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2093.8893,-3825.0265 2103.9293,-3828.4103 2098.1908,-3819.5041 2093.8893,-3825.0265"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5345.4481C836.1132,-5363.1343 853.6863,-5427.467 932.7092,-5402.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-5402.4481C960.8196,-5393.5482 1348.8106,-5118.5845 1364.2236,-5093.4481 1419.9163,-5002.6217 1339.0109,-4943.6497 1400.2236,-4856.4481 1443.5683,-4794.7007 1486.695,-4817.4024 1549.3953,-4775.4481 1605.068,-4738.196 1600.2813,-4691.1629 1666.4052,-4680.4481"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node59"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1532.2126,-4766.4535 1417.4063,-4766.4535 1417.4063,-4744.4426 1532.2126,-4744.4426 1532.2126,-4766.4535"/>
<text text-anchor="middle" x="1474.8094" y="-4752.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5278.4481C646.7361,-5331.6741 676.5152,-5326.0758 755.1332,-5345.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5345.4481C905.8554,-5382.5877 1275.3463,-5130.7169 1364.2236,-5003.4481 1421.7044,-4921.1379 1335.2629,-4856.9929 1400.2236,-4780.4481 1403.0569,-4777.1095 1406.3505,-4774.2151 1409.9446,-4771.7059"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1411.9384,-4774.5944 1418.801,-4766.5225 1408.4025,-4768.553 1411.9384,-4774.5944"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge391" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1288.297,-4994.6576C1306.4579,-5018.6396 1351.9998,-5075.7255 1400.2236,-5112.4481 1452.2864,-5152.0941 2395.6907,-5701.0692 2444.4712,-5657.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2444.4712,-5657.4481C2465.9077,-5635.2549 2491.4159,-5658.3645 2509.6157,-5633.4481 2559.7022,-5564.8774 2494.2586,-4126.7564 2576.7096,-4106.4481"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M1474.8094,-5098.4481C1681.4717,-5128.3115 1729.7313,-5027.1071 1910.4177,-4922.4481 1945.1421,-4902.3346 1945.9245,-4858.4903 1984.2305,-4870.4481"/>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M1339.1297,-4994.5154C1348.14,-4997.9699 1356.871,-5002.5022 1364.2236,-5008.4481 1390.2047,-5029.4583 1374.4832,-5053.1437 1400.2236,-5074.4481 1427.0502,-5096.6514 1440.0561,-5096.245 1474.8094,-5098.4481"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M1283.3509,-4972.2369C1301.9731,-4909.8346 1392.3302,-4607.4366 1400.2236,-4588.4481 1418.5743,-4544.3036 1446.5788,-4495.7316 1462.5391,-4469.296"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1465.6189,-4470.9679 1467.8341,-4460.6072 1459.6414,-4467.3251 1465.6189,-4470.9679"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1348.6695,-4972.3893C1457.7106,-4953.2532 1675.6463,-4908.534 1846.9164,-4832.4481"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1292.3545,-4972.3069C1310.8299,-4954.9401 1345.4943,-4919.5394 1364.2236,-4882.4481 1394.5426,-4822.4047 1352.8816,-4783.2307 1400.2236,-4735.4481 1424.3,-4711.1476 1443.7967,-4730.8839 1474.8094,-4716.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge392" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-288.4481C2205.4004,-349.9166 2179.5781,-434.5874 2281.0071,-461.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-461.4481C2379.765,-487.6014 2433.7417,-417.0358 2509.6157,-485.4481 2616.8923,-582.1747 2508.9278,-675.8944 2576.7096,-803.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.3094,-1439.3046C244.1754,-1419.437 270.1955,-1376.1543 281.2024,-1335.4481 313.1157,-1217.4246 264.6779,-896.8527 317.2024,-786.4481 359.8638,-696.7753 423.9451,-715.7493 480.9653,-634.4481 504.5227,-600.8592 486.1187,-576.497 516.9653,-549.4481 564.6381,-507.6446 610.4092,-557.0397 654.4731,-511.4481 702.1193,-462.1501 652.5976,-418.596 690.4731,-361.4481 740.9205,-285.3312 773.4591,-278.9424 855.7932,-239.4481 1362.9209,3.8128 1664.5338,41.0545 2120.3654,-288.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2576.7096,-803.4481C2685.2218,-1004.1534 2711.5903,-2751.9257 2714.412,-2965.1631"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2710.9147,-2965.4017 2714.5442,-2975.3554 2717.9142,-2965.3108 2710.9147,-2965.4017"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3123.4481C460.3722,-3147.7099 459.1318,-3181.8225 516.9653,-3213.4481 523.9389,-3217.2615 531.6114,-3220.7044 539.2245,-3223.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="538.1871,-3227.0794 548.7789,-3227.3359 540.6589,-3220.5303 538.1871,-3227.0794"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M585.7192,-1681.4481C1097.9596,-1746.7476 1243.8152,-1587.2489 1747.415,-1701.4481 1895.4548,-1735.0184 1916.1014,-1789.6404 2058.0432,-1843.4481 2112.1974,-1863.977 2133.4404,-1850.9713 2182.6875,-1881.4481 2202.4702,-1893.6907 2199.3563,-1906.5044 2218.6875,-1919.4481 2243.3501,-1935.9615 2262.2416,-1920.4526 2281.0071,-1943.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2281.0071,-1943.4481C2411.9355,-2106.128 2439.8059,-2814.8819 2443.8823,-2946.4057"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2440.3839,-2946.5155 2444.18,-2956.4069 2447.3808,-2946.3072 2440.3839,-2946.5155"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M755.1332,-3047.4481C803.4379,-3047.8621 809.8976,-3073.3777 855.7932,-3088.4481 1191.2391,-3198.596 1608.1148,-3272.8383 1773.9531,-3299.9765"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1773.6038,-3303.4656 1784.0365,-3301.619 1774.7293,-3296.5567 1773.6038,-3303.4656"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff9400" stroke-dasharray="5,2" d="M223.8771,-1461.6101C224.5043,-1639.9271 234.0782,-3896.3434 317.2024,-4004.4481 322.0439,-4010.7445 328.4319,-4015.5016 335.5099,-4019.0877"/>
<polygon fill="#ff9400" stroke="#ff9400" points="334.2078,-4022.3372 344.7798,-4023.0315 336.9482,-4015.8959 334.2078,-4022.3372"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M1984.2305,-4870.4481C2000.5466,-4877.8596 2005.9454,-4876.5736 2022.0432,-4884.4481 2048.4888,-4897.3844 2076.8787,-4915.5008 2096.3196,-4928.6267"/>
<polygon fill="#ffc500" stroke="#ffc500" points="2094.3511,-4931.5207 2104.5831,-4934.2698 2098.2987,-4925.74 2094.3511,-4931.5207"/>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M399.0839,-4604.4481C421.8163,-4634.8022 447.2077,-4611.1692 480.9653,-4628.4481 499.0089,-4637.6836 497.7927,-4649.8698 516.9653,-4656.4481 574.772,-4676.282 593.4217,-4659.2257 654.4731,-4656.4481 1140.6071,-4634.3303 1282.3769,-4447.0782 1747.415,-4590.4481 1765.7912,-4596.1134 1766.1607,-4605.9589 1783.415,-4614.4481 1836.8867,-4640.7564 1868.1291,-4615.4598 1910.4177,-4657.4481 1981.5146,-4728.04 1893.0108,-4829.0119 1984.2305,-4870.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#fff600" stroke-dasharray="5,2" d="M224.0583,-1461.5042C228.1843,-1670.4915 289.877,-4772.5875 317.2024,-4808.4481 324.9504,-4818.6162 336.7346,-4824.7738 348.9683,-4828.4681"/>
<polygon fill="#fff600" stroke="#fff600" points="348.2566,-4831.8979 358.8074,-4830.9322 349.9573,-4825.1076 348.2566,-4831.8979"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M399.0839,-4604.4481C417.3019,-4626.8914 1372.2344,-4327.6733 1400.2236,-4320.4481 1517.8377,-4290.0867 1544.9355,-4258.4481 1666.4052,-4258.4481 1666.4052,-4258.4481 1666.4052,-4258.4481 1984.2305,-4258.4481 2060.9775,-4258.4481 2148.6607,-4264.8543 2208.7026,-4270.2271"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2208.5625,-4273.7287 2218.8381,-4271.1477 2209.1958,-4266.7574 2208.5625,-4273.7287"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M399.0839,-961.4481C424.5618,-934.1251 445.8257,-955.1317 480.9653,-942.4481 562.1071,-913.1601 581.5179,-901.4839 654.4731,-855.4481 671.6154,-844.6311 672.1817,-836.1824 690.4731,-827.4481 811.8898,-769.4706 1161.2211,-626.255 1280.0068,-689.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M267.7705,-1441.022C363.7476,-1420.4281 592.0635,-1371.4381 698.5877,-1348.5811"/>
<polygon fill="#41ff00" stroke="#41ff00" points="699.4646,-1351.9727 708.5078,-1346.4525 697.996,-1345.1285 699.4646,-1351.9727"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#10ff00" stroke-dasharray="5,2" d="M399.0839,-4604.4481C423.4385,-4633.5167 455.8268,-4600.0545 480.9653,-4628.4481 546.0616,-4701.9731 442.0832,-4782.9176 516.9653,-4846.4481 563.5676,-4885.9857 593.866,-4854.307 654.4731,-4846.4481 712.6754,-4838.901 1092.8427,-4733.6821 1230.4179,-4695.317"/>
<polygon fill="#10ff00" stroke="#10ff00" points="1231.5902,-4698.6237 1240.2817,-4692.5649 1229.709,-4691.8812 1231.5902,-4698.6237"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M1666.4052,-2819.4481C1723.5526,-2840.8998 1785.7751,-2876.2066 1820.1979,-2896.8995"/>
<polygon fill="#00ff20" stroke="#00ff20" points="1818.7771,-2900.1312 1829.1424,-2902.3248 1822.4074,-2894.1461 1818.7771,-2900.1312"/>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M585.7192,-2211.4481C624.723,-2232.3395 634.824,-2243.8039 654.4731,-2283.4481 699.6414,-2374.5794 625.2866,-2431.3725 690.4731,-2509.4481 740.3777,-2569.22 781.8654,-2542.9974 855.7932,-2567.4481 1213.9901,-2685.9168 1313.1908,-2686.8602 1666.4052,-2819.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M585.7192,-4604.4481C934.235,-4565.8412 1022.7902,-4556.3034 1364.2236,-4476.4481 1380.5143,-4472.638 1384.0299,-4469.6509 1400.2236,-4465.4481 1405.1449,-4464.1708 1410.2674,-4462.9169 1415.4203,-4461.7079"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1416.3536,-4465.0849 1425.322,-4459.4442 1414.7934,-4458.261 1416.3536,-4465.0849"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M223.8796,-1461.5353C224.5128,-1603.1555 235.0023,-3055.0168 399.0839,-3123.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M755.1332,-2933.4481C832.4083,-2976.4332 1461.9236,-2970.4918 1549.3953,-2983.4481 1712.4579,-3007.6008 1755.0621,-3013.3354 1910.4177,-3068.4481 1962.3578,-3086.8739 1983.8649,-3082.7026 2022.0432,-3122.4481 2031.5285,-3132.3227 2113.5172,-3336.5913 2120.3654,-3348.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M2120.3654,-3348.4481C2136.4584,-3373.3882 2164.6293,-3348.8918 2182.6875,-3372.4481 2229.1812,-3433.0973 2206.2796,-3639.0422 2218.6875,-3714.4481 2234.5805,-3811.034 2263.3157,-3924.4511 2275.4065,-3970.4701"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2272.0379,-3971.4223 2277.9783,-3980.1951 2278.8053,-3969.6326 2272.0379,-3971.4223"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M399.0839,-3123.4481C577.8333,-3197.9967 445.1014,-2885.7705 480.9653,-2695.4481 489.0849,-2652.3593 483.2508,-2529.4819 516.9653,-2501.4481 563.9571,-2462.3742 607.2516,-2462.6522 654.4731,-2501.4481 718.1846,-2553.7917 672.142,-2603.0554 690.4731,-2683.4481 715.9876,-2795.3433 671.3994,-2854.9612 755.1332,-2933.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe6" stroke-dasharray="5,2" d="M399.0839,-2211.4481C432.8348,-2235.5523 548.6648,-2192.8173 585.7192,-2211.4481"/>
<path fill="none" stroke="#00ffe6" stroke-dasharray="5,2" d="M585.7192,-2211.4481C676.6459,-2257.1655 794.6429,-2275.1095 866.9558,-2282.0881"/>
<polygon fill="#00ffe6" stroke="#00ffe6" points="867.0057,-2285.6075 877.2848,-2283.0402 867.6483,-2278.637 867.0057,-2285.6075"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M399.0839,-883.4481C421.0367,-844.9226 456.1724,-863.2101 480.9653,-826.4481 521.2357,-766.7366 479.8915,-730.1951 516.9653,-668.4481 558.5692,-599.1563 608.947,-616.2283 654.4731,-549.4481 681.5526,-509.7264 656.2045,-481.1641 690.4731,-447.4481 759.3358,-379.696 1027.7394,-248.5205 1102.7076,-309.4481"/>
<path fill="none" stroke="#00e6ff" stroke-dasharray="5,2" d="M231.2364,-1439.2845C243.9895,-1419.3859 269.8404,-1376.0566 281.2024,-1335.4481 307.2186,-1242.4649 254.0552,-975.4902 317.2024,-902.4481 341.6352,-874.1867 380.1043,-915.6264 399.0839,-883.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M755.1332,-1031.4481C830.7836,-1003.3227 852.9886,-1006.0433 932.7092,-993.4481"/>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M932.7092,-993.4481C971.7785,-987.2754 1015.3603,-977.7361 1048.6149,-969.8896"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1049.6704,-973.2362 1058.5873,-967.5145 1048.0485,-966.4267 1049.6704,-973.2362"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M399.0839,-3123.4481C482.359,-3156.4137 498.9553,-3177.2332 585.7192,-3199.4481"/>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M585.7192,-3199.4481C686.8326,-3225.3369 717.1075,-3199.7455 819.7932,-3218.4481 1029.1359,-3256.5765 1067.5233,-3361.8008 1280.0068,-3350.4481"/>
<path fill="none" stroke="#0083ff" stroke-dasharray="5,2" d="M1280.0068,-3350.4481C1325.3289,-3349.8091 1376.5882,-3349.8392 1415.146,-3350.0129"/>
<polygon fill="#0083ff" stroke="#0083ff" points="1415.148,-3353.5129 1425.1652,-3350.0625 1415.1827,-3346.5129 1415.148,-3353.5129"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M755.1332,-2933.4481C967.0314,-3032.8819 1252.0443,-3024.6046 1391.2528,-3012.7702"/>
<polygon fill="#0052ff" stroke="#0052ff" points="1391.7711,-3016.2383 1401.4265,-3011.8767 1391.1586,-3009.2651 1391.7711,-3016.2383"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M399.0839,-1489.4481C493.8977,-1514.4367 753.3317,-1550.3582 819.7932,-1622.4481 864.8013,-1671.2677 821.085,-1710.8404 855.7932,-1767.4481 912.5762,-1860.0589 1022.5754,-1933.8651 1074.3986,-1965.1768"/>
<polygon fill="#0020ff" stroke="#0020ff" points="1072.6982,-1968.2378 1083.0799,-1970.3521 1076.2826,-1962.2252 1072.6982,-1968.2378"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M585.7192,-3199.4481C628.2472,-3210.3368 677.1394,-3221.4423 711.4347,-3229.003"/>
<polygon fill="#1000ff" stroke="#1000ff" points="711.0683,-3232.5058 721.5862,-3231.2315 712.5692,-3225.6686 711.0683,-3232.5058"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M399.0839,-961.4481C423.8046,-933.4382 452.4698,-966.6074 480.9653,-942.4481 512.8838,-915.3867 488.325,-885.9578 516.9653,-855.4481 545.2059,-825.3642 816.4633,-715.9271 855.7932,-703.4481 921.9174,-682.4675 1108.0453,-678.6549 1159.79,-632.4481 1195.3357,-600.7066 1159.383,-562.1977 1195.79,-531.4481 1266.2718,-471.9187 1309.2568,-510.8256 1400.2236,-495.4481 1596.5427,-462.2611 1648.4432,-445.6068 1846.9164,-461.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M231.1426,-1439.2577C243.7503,-1419.3175 269.3835,-1375.9259 281.2024,-1335.4481 302.4976,-1262.5155 271.746,-1056.328 317.2024,-995.4481 340.7774,-963.874 373.6313,-991.5292 399.0839,-961.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2120.3654,-537.4481C2181.3172,-588.8183 2165.2144,-628.3325 2218.6875,-687.4481 2280.2998,-755.5617 2299.4703,-772.0773 2379.3267,-817.4481 2406.1545,-832.6904 2427.5916,-815.619 2444.4712,-841.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1846.9164,-461.4481C1973.021,-458.4807 2016.9639,-465.2033 2120.3654,-537.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M399.0839,-4604.4481C423.9453,-4637.6451 544.6393,-4610.1553 585.7192,-4604.4481"/>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M585.7192,-4604.4481C633.8105,-4597.7667 642.7602,-4582.4415 690.4731,-4573.4481 1169.5445,-4483.1482 1296.3467,-4501.1334 1783.415,-4480.4481 1839.8098,-4478.053 1854.0044,-4478.5396 1910.4177,-4480.4481 1918.7225,-4480.729 1927.5438,-4481.1873 1936.0903,-4481.7153"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1936.1178,-4485.2246 1946.3255,-4482.3868 1936.5761,-4478.2396 1936.1178,-4485.2246"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#a400ff" stroke-dasharray="5,2" d="M399.0839,-883.4481C421.5618,-845.2266 452.2275,-860.216 480.9653,-826.4481 504.9288,-798.2902 494.9354,-781.143 516.9653,-751.4481 529.867,-734.0575 548.0549,-717.6419 562.4836,-705.9295"/>
<polygon fill="#a400ff" stroke="#a400ff" points="564.806,-708.555 570.4762,-699.6051 560.4624,-703.0656 564.806,-708.555"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge334" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff00f6" stroke-dasharray="5,2" d="M585.7192,-4984.4481C760.411,-5137.4814 898.9201,-5171.835 1102.7076,-5060.4481"/>
<path fill="none" stroke="#ff00f6" stroke-dasharray="5,2" d="M1102.7076,-5060.4481C1127.1403,-5047.7809 1134.5129,-5047.3329 1159.79,-5036.4481 1188.882,-5023.9205 1221.7861,-5009.3887 1245.8062,-4998.7134"/>
<polygon fill="#ff00f6" stroke="#ff00f6" points="1247.4817,-5001.7988 1255.1954,-4994.5359 1244.6361,-4995.4032 1247.4817,-5001.7988"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge346" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M755.1332,-3047.4481C1080.0496,-3081.8238 1153.3815,-3138.8268 1474.8094,-3197.4481"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M399.0839,-3123.4481C549.5333,-3183.0057 594.9331,-3024.6867 755.1332,-3047.4481"/>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1474.8094,-3197.4481C1515.1973,-3199.4645 1560.4337,-3199.5658 1596.8056,-3199.1161"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1596.868,-3202.6157 1606.8179,-3198.9758 1596.7698,-3195.6164 1596.868,-3202.6157"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge353" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M399.0839,-4604.4481C457.637,-4673.4379 454.537,-4503.952 516.9653,-4438.4481 649.0497,-4299.8565 686.8721,-4262.5567 855.7932,-4172.4481 1030.7252,-4079.1331 1106.2073,-4129.8557 1280.0068,-4034.4481"/>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M224.0202,-1461.7122C226.6856,-1626.8605 258.9517,-3560.7607 317.2024,-4127.4481 339.1971,-4341.4214 270.1439,-4432.2771 399.0839,-4604.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge359" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M399.0839,-2211.4481C410.3218,-2219.474 486.213,-2200.4647 537.6931,-2186.256"/>
<polygon fill="#ff0031" stroke="#ff0031" points="538.9423,-2189.5414 547.6373,-2183.4877 537.0649,-2182.7979 538.9423,-2189.5414"/>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M224.4817,-1461.6754C229.7283,-1548.9774 268.7587,-2118.3726 399.0839,-2211.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1069.4481C459.8422,-1018.0667 680.5495,-1059.1768 755.1332,-1031.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-1449.4481C2044.4768,-1455.0303 2074.4349,-1410.0632 2120.3654,-1449.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1031.4481C826.6282,-1011.0411 973.7657,-884.5319 1045.6252,-865.4481 1186.3206,-828.0835 1232.1369,-880.2567 1364.2236,-941.4481 1449.8698,-981.1251 1471.5031,-992.1343 1549.3953,-1045.4481 1643.4614,-1109.8322 1663.3467,-1131.4659 1747.415,-1208.4481 1858.1653,-1309.8631 1834.7023,-1435.5932 1984.2305,-1449.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-1335.4481C432.5746,-1317.6574 445.3635,-1324.5113 480.9653,-1311.4481 497.4028,-1305.4167 500.0565,-1299.9935 516.9653,-1295.4481 699.8357,-1246.2892 1218.2796,-1325.1067 1364.2236,-1204.4481 1406.4824,-1169.5108 1358.3417,-1121.8363 1400.2236,-1086.4481 1595.9325,-921.0835 1934.8056,-959.6744 2066.1586,-982.6015"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2065.9069,-986.1119 2076.3667,-984.4253 2067.1382,-979.221 2065.9069,-986.1119"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.4839,-1461.5807C229.7908,-1551.8697 267.3908,-2162.4693 317.2024,-2225.4481 416.2767,-2350.7116 556.1445,-2223.5983 654.4731,-2349.4481 700.1627,-2407.9256 638.4593,-2628.5168 690.4731,-2681.4481 796.2451,-2789.0857 1218.2317,-2728.239 1364.2236,-2766.4481 1391.8221,-2773.6711 1421.7093,-2786.1345 1443.4471,-2796.1158"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1441.9868,-2799.2967 1452.5283,-2800.3588 1444.95,-2792.9547 1441.9868,-2799.2967"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M224.0354,-1461.6389C227.5729,-1663.9636 278.5643,-4542.8013 317.2024,-4618.4481 327.6238,-4638.8515 348.031,-4654.5785 365.8642,-4665.2161"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="364.4603,-4668.4428 374.8888,-4670.3128 367.9026,-4662.3477 364.4603,-4668.4428"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-1373.4481C1029.0336,-1383.1784 1268.3688,-1327.0464 1364.2236,-1313.4481 1413.3923,-1306.4728 1447.4137,-1256.0272 1474.8094,-1297.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1335.4481C482.7965,-1293.608 730.2225,-1289.3283 819.7932,-1316.4481 838.1977,-1322.0205 838.8868,-1331.2856 855.7932,-1340.4481 888.4975,-1358.1723 896.1937,-1366.3532 932.7092,-1373.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-1489.4481C663.2854,-1490.0204 1212.4951,-1600.645 1280.0068,-1562.4481"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1280.0068,-1562.4481C1355.9936,-1514.189 1338.7046,-1465.1621 1400.2236,-1399.4481 1416.0575,-1382.5344 1436.2463,-1365.7219 1451.6255,-1353.7244"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1453.8194,-1356.4525 1459.6165,-1347.5844 1449.5544,-1350.9018 1453.8194,-1356.4525"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-1489.4481C480.8993,-1503.1146 503.165,-1481.3642 585.7192,-1489.4481"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M267.5177,-1461.5326C302.818,-1470.1604 353.8923,-1481.8992 399.0839,-1489.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M230.3146,-1439.3615C241.8525,-1419.2318 266.1671,-1375.0833 281.2024,-1335.4481 303.0746,-1277.7899 292.6868,-1258.0329 317.2024,-1201.4481 344.6479,-1138.1007 347.0927,-1114.869 399.0839,-1069.4481"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-1069.4481C428.7589,-1043.5232 445.9756,-1053.5706 480.9653,-1035.4481 650.1413,-947.8252 669.677,-868.1793 855.7932,-827.4481 1076.5379,-779.1385 1141.8443,-787.3299 1364.2236,-827.4481 1659.7525,-880.7627 1990.464,-1042.4804 2090.283,-1093.7074"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2088.7211,-1096.8399 2099.2131,-1098.3126 2091.9295,-1090.6185 2088.7211,-1096.8399"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-3990.4481C436.9437,-3992.6331 457.4158,-3996.1727 480.9653,-3966.4481 572.4544,-3850.969 429.196,-3422.7791 516.9653,-3304.4481 519.3653,-3301.2124 522.2261,-3298.3947 525.3966,-3295.9411"/>
<polygon fill="#0066ff" stroke="#0066ff" points="527.2812,-3298.8905 533.8295,-3290.5615 523.5165,-3292.989 527.2812,-3298.8905"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.9967,-1461.4598C226.6255,-1642.0212 263.3194,-3982.6128 399.0839,-3990.4481"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M231.3803,-1439.3235C244.356,-1419.485 270.5406,-1376.246 281.2024,-1335.4481 322.886,-1175.9439 237.9441,-739.0068 317.2024,-594.4481 327.3074,-576.0175 346.0761,-562.0762 363.097,-552.4865"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="365.1101,-555.3809 372.3072,-547.6058 361.8323,-549.1957 365.1101,-555.3809"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1539.4535 334.8633,-1539.4535 334.8633,-1517.4426 463.3044,-1517.4426 463.3044,-1539.4535"/>
<text text-anchor="middle" x="399.0839" y="-1525.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M240.8033,-1461.5958C259.0764,-1473.2372 289.2956,-1491.4407 317.2024,-1503.4481 326.5207,-1507.4574 336.6903,-1511.1059 346.5949,-1514.3009"/>
<polygon fill="#ff0000" stroke="#ff0000" points="345.7816,-1517.7133 356.37,-1517.3414 347.8608,-1511.0292 345.7816,-1517.7133"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1731.4535 354.6193,-1731.4535 354.6193,-1709.4426 443.5485,-1709.4426 443.5485,-1731.4535"/>
<text text-anchor="middle" x="399.0839" y="-1717.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M224.7048,-1461.6066C228.2876,-1500.0516 245.3651,-1628.3201 317.2024,-1695.4481 324.9384,-1702.6769 334.7091,-1707.8185 344.7832,-1711.4747"/>
<polygon fill="#7fff00" stroke="#7fff00" points="343.8882,-1714.8625 354.4783,-1714.5446 346.0014,-1708.1891 343.8882,-1714.8625"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1335.4481C432.6557,-1317.8109 451.4368,-1335.2431 480.9653,-1311.4481 506.9825,-1290.4826 492.1668,-1267.8418 516.9653,-1245.4481 559.5679,-1206.9769 697.8205,-1148.6519 755.1332,-1145.4481"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M238.1369,-1439.3752C267.1556,-1417.2917 335.6097,-1367.1728 399.0839,-1335.4481"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="819.9536,-1653.4535 690.3127,-1653.4535 690.3127,-1631.4426 819.9536,-1631.4426 819.9536,-1653.4535"/>
<text text-anchor="middle" x="755.1332" y="-1639.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M232.3037,-1461.7677C269.0218,-1509.435 420.151,-1690.9454 585.7192,-1681.4481"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7192,-1681.4481C609.4866,-1684.4779 668.9379,-1668.7482 710.6685,-1656.3629"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="711.7649,-1659.6882 720.3358,-1653.46 709.7517,-1652.9839 711.7649,-1659.6882"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.3249,-1439.3088C244.2149,-1419.4477 270.2709,-1376.1746 281.2024,-1335.4481 348.3863,-1085.1467 241.3427,-1001.258 317.2024,-753.4481 331.5028,-706.733 364.3311,-659.1445 383.7988,-633.5617"/>
<polygon fill="#ff0000" stroke="#ff0000" points="386.713,-635.5152 390.0753,-625.468 381.1814,-631.2255 386.713,-635.5152"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1489.4481C647.8337,-1489.4481 811.3539,-1547.7835 819.7932,-1554.4481 844.4988,-1573.9583 833.5753,-1593.1461 855.7932,-1615.4481 925.0902,-1685.0071 955.1805,-1690.2345 1045.6252,-1728.4481 1103.0592,-1752.7144 1172.4067,-1769.9767 1220.7056,-1780.2244"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1220.1767,-1783.6893 1230.6807,-1782.3046 1221.6058,-1776.8368 1220.1767,-1783.6893"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-883.4481C408.5847,-867.2928 673.0976,-720.4729 690.4731,-713.4481 816.1625,-662.6326 974.1201,-632.6894 1053.0393,-619.8647"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1053.8605,-623.2778 1063.1811,-618.2404 1052.7535,-616.3659 1053.8605,-623.2778"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M231.2609,-1439.2913C244.0517,-1419.4032 269.9592,-1376.0896 281.2024,-1335.4481 308.8955,-1235.3439 267.7681,-960.7936 317.2024,-869.4481 328.1795,-849.1643 348.7875,-833.3627 366.5819,-822.6579"/>
<polygon fill="#ff0000" stroke="#ff0000" points="368.6168,-825.5264 375.5648,-817.5279 365.1454,-819.4478 368.6168,-825.5264"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M231.1965,-1439.2733C243.8879,-1419.3572 269.6462,-1376.0017 281.2024,-1335.4481 304.9331,-1252.1707 262.5188,-1014.5895 317.2024,-947.4481 319.8203,-944.2338 322.8397,-941.4231 326.1419,-938.9663"/>
<polygon fill="#00ffff" stroke="#00ffff" points="328.2095,-941.8027 334.8658,-933.5598 324.522,-935.8527 328.2095,-941.8027"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M231.0496,-1439.23C243.5136,-1419.247 268.9312,-1375.7911 281.2024,-1335.4481 317.7145,-1215.4094 244.0837,-1157.4092 317.2024,-1055.4481 324.9904,-1044.588 336.5535,-1036.5398 348.5526,-1030.6302"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="350.056,-1033.7921 357.7581,-1026.5169 347.2002,-1027.4011 350.056,-1033.7921"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1364.441,-1387.4535 1195.5727,-1387.4535 1195.5727,-1365.4426 1364.441,-1365.4426 1364.441,-1387.4535"/>
<text text-anchor="middle" x="1280.0068" y="-1373.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-1373.4481C1017.9981,-1381.0969 1115.5386,-1381.1826 1185.4903,-1379.7426"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1185.6857,-1383.2392 1195.6062,-1379.5198 1185.5315,-1376.2409 1185.6857,-1383.2392"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-993.4481C1131.5951,-962.0256 1208.9936,-1003.2039 1364.2236,-1131.4481 1389.9831,-1152.7294 1376.8777,-1173.5439 1400.2236,-1197.4481 1453.6936,-1252.1965 1508.4742,-1218.7805 1549.3953,-1283.4481 1602.5649,-1367.4719 1555.2444,-1634.6961 1585.3953,-1729.4481 1628.1782,-1863.8976 1706.8493,-1867.3131 1747.415,-2002.4481 1771.5615,-2082.8862 1731.6674,-2691.3003 1783.415,-2757.4481 1819.718,-2803.8533 1873.9229,-2749.1936 1910.4177,-2795.4481 1954.7409,-2851.6243 1933.0827,-3368.1452 1946.4177,-3438.4481 1975.8998,-3593.8791 1975.4226,-3641.5339 2058.0432,-3776.4481 2068.6892,-3793.8324 2085.0103,-3810.0981 2098.2798,-3821.7461"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2096.1844,-3824.5586 2106.0697,-3828.3706 2100.7192,-3819.2261 2096.1844,-3824.5586"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4604.4481C421.8163,-4634.8022 456.4259,-4599.5352 480.9653,-4628.4481 566.1497,-4728.8144 456.2428,-4805.6468 516.9653,-4922.4481 535.945,-4958.956 554.553,-4957.5832 585.7192,-4984.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4984.4481C667.2354,-5054.7138 716.3379,-4952.0984 819.7932,-4922.4481 1063.2204,-4852.6818 1130.2493,-4851.2994 1364.2236,-4754.4481 1380.9398,-4747.5286 1383.3402,-4741.9486 1400.2236,-4735.4481 1432.1471,-4723.1568 1443.5353,-4730.3084 1474.8094,-4716.4481"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge393" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1846.9164,-3272.4481C2061.2741,-3311.7025 2068.0814,-2998.05 2281.0071,-3044.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1706.8345,-3208.4825C1719.9423,-3212.441 1734.4427,-3217.2292 1747.415,-3222.4481 1793.3309,-3240.9202 1798.7095,-3261.2416 1846.9164,-3272.4481"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1846.9164,-3120.4481C1870.4884,-3101.6154 1890.3229,-3118.9537 1910.4177,-3096.4481 1953.7811,-3047.8824 1923.9833,-3015.5685 1946.4177,-2954.4481 1985.2947,-2848.5316 1987.1931,-2814.2546 2058.0432,-2726.4481 2137.3217,-2628.196 2181.7299,-2472.4572 2281.0071,-2550.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1689.9658,-3186.2402C1713.4586,-3175.1919 1750.6642,-3158.0381 1783.415,-3144.4481 1811.2824,-3132.8845 1822.7154,-3138.4652 1846.9164,-3120.4481"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M1722.3855,-3208.5604C1731.3548,-3212.0132 1740.0836,-3216.5331 1747.415,-3222.4481 1772.8148,-3242.9404 1758.8092,-3265.0089 1783.415,-3286.4481 1787.6024,-3290.0965 1792.3853,-3293.247 1797.4053,-3295.9597"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1796.0902,-3299.2107 1806.62,-3300.3825 1799.1192,-3292.8999 1796.0902,-3299.2107"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1846.9164,-3272.4481C1875.4325,-3279.8417 1882.947,-3280.8087 1910.4177,-3291.4481 1978.3089,-3317.7422 1991.2124,-3333.5648 2058.0432,-3362.4481 2085.2891,-3374.2234 2103.1193,-3362.2909 2120.3654,-3386.4481"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M1685.6222,-3186.3345C1703.5719,-3175.1488 1730.1232,-3156.4351 1747.415,-3134.4481 1773.769,-3100.9385 1820.7427,-2982.0156 1839.1825,-2933.8883"/>
<polygon fill="#00ff20" stroke="#00ff20" points="1842.4699,-2935.0902 1842.7613,-2924.4994 1835.929,-2932.597 1842.4699,-2935.0902"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1846.9164,-3272.4481C1969.3535,-3302.7852 2059.4829,-3237.9741 2120.3654,-3348.4481"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1846.9164,-3120.4481C1871.1173,-3102.4309 1885.908,-3114.043 1910.4177,-3096.4481 1994.4671,-3036.1111 1964.5198,-2960.6997 2058.0432,-2916.4481 2108.1181,-2892.7546 2131.0515,-2896.3832 2182.6875,-2916.4481 2237.906,-2937.905 2222.6251,-2996.3973 2281.0071,-3006.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2281.0071,-3006.4481C2352.8632,-3017.1634 2372.1417,-2999.624 2444.4712,-3006.4481"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1675.7425,-3208.789C1693.6918,-3231.3837 1732.5486,-3284.3408 1747.415,-3336.4481 1786.3892,-3473.0534 1726.9515,-4484.0952 1783.415,-4614.4481 1791.3893,-4632.8575 1807.4866,-4648.7303 1821.4778,-4659.9385"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1819.7493,-4663.0216 1829.8257,-4666.2954 1823.9902,-4657.4524 1819.7493,-4663.0216"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge394" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1485.2114,-3889.7367C1512.1531,-3918.2351 1587.6195,-3993.4464 1666.4052,-4030.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-4030.4481C1809.7991,-4097.7931 1865.0167,-4033.4757 2022.0432,-4054.4481 2138.4025,-4069.9889 2166.4684,-4080.7208 2281.0071,-4106.4481"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffc500" stroke-dasharray="5,2" d="M1846.9164,-4106.4481C2022.5639,-4129.5015 2104.0216,-4795.6342 2118.1204,-4924.1179"/>
<polygon fill="#ffc500" stroke="#ffc500" points="2114.6609,-4924.6827 2119.2136,-4934.2495 2121.6205,-4923.9317 2114.6609,-4924.6827"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1984.2305,-4068.4481C2062.2395,-4080.3846 2049.8379,-4147.0394 2120.3654,-4182.4481"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1666.4052,-4030.4481C1745.1962,-4067.4523 1768.5574,-4068.5376 1846.9164,-4106.4481"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M2120.3654,-4182.4481C2169.6492,-4207.1912 2224.407,-4241.0251 2255.576,-4260.9252"/>
<polygon fill="#d5ff00" stroke="#d5ff00" points="2253.7825,-4263.9329 2264.0888,-4266.3888 2257.5635,-4258.0419 2253.7825,-4263.9329"/>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M1846.9164,-4106.4481C1903.918,-4134.0257 1921.6367,-4058.8703 1984.2305,-4068.4481"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1525.1254,-3885.3111C1544.0055,-3887.7565 1565.6645,-3890.4074 1585.3953,-3892.4481 1850.3012,-3919.8462 1926.6923,-3867.0158 2182.6875,-3940.4481 2209.0557,-3948.0118 2236.5675,-3962.9827 2255.7603,-3974.7567"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2254.1436,-3977.8745 2264.4725,-3980.2334 2257.8691,-3971.9482 2254.1436,-3977.8745"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge340" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1477.6201,-3867.1679C1487.9806,-3825.3774 1524.7112,-3675.3401 1549.3953,-3550.4481 1568.0957,-3455.8309 1552.58,-3427.1414 1585.3953,-3336.4481 1601.9722,-3290.6334 1633.57,-3242.7183 1652.0225,-3216.836"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1654.927,-3218.7924 1657.9549,-3208.6395 1649.2564,-3214.6882 1654.927,-3218.7924"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1525.2697,-3877.0538C1563.9254,-3876.3235 1618.5678,-3876.02 1666.4052,-3878.4481"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge395" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-1714.4481C1149.7839,-1698.4916 1152.3053,-1676.5284 1195.79,-1652.4481 1267.6366,-1612.6619 1309.3572,-1637.5589 1364.2236,-1576.4481 1398.5894,-1538.1712 1370.0907,-1508.1389 1400.2236,-1466.4481 1448.4774,-1399.6859 1502.4886,-1424.1635 1549.3953,-1356.4481 1582.8027,-1308.2203 1552.3769,-1277.9431 1585.3953,-1229.4481 1647.684,-1137.9628 1690.9151,-1139.2198 1783.415,-1078.4481 1900.3698,-1001.6097 1930.2942,-981.5684 2058.0432,-924.4481 2222.3364,-850.9878 2264.5708,-798.4993 2444.4712,-803.4481"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M755.1332,-2057.4481C816.9888,-2029.1645 1296.8044,-2005.4326 1364.2236,-1996.4481 1380.3022,-1994.3054 1384.1152,-1992.3536 1400.2236,-1990.4481 1569.771,-1970.3917 1612.7911,-1969.4518 1783.415,-1963.4481 1839.8258,-1961.4632 1859.8869,-1938.2937 1910.4177,-1963.4481 2196.1496,-2105.6862 2207.734,-2247.5034 2343.3267,-2536.4481 2412.3228,-2683.4771 2436.3295,-2881.441 2442.6084,-2946.0742"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2439.1422,-2946.6015 2443.5535,-2956.2343 2446.1121,-2945.9531 2439.1422,-2946.6015"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff6200" stroke-dasharray="5,2" d="M932.7092,-2553.4481C982.693,-2572.6526 1717.8302,-3023.817 1747.415,-3068.4481 1801.6722,-3150.2993 1721.6898,-3210.071 1783.415,-3286.4481 1786.0961,-3289.7655 1789.2788,-3292.6443 1792.7691,-3295.1422"/>
<polygon fill="#ff6200" stroke="#ff6200" points="1791.0041,-3298.1647 1801.3802,-3300.3065 1794.6044,-3292.1616 1791.0041,-3298.1647"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#d5ff00" stroke-dasharray="5,2" d="M755.1332,-2363.4481C856.8821,-2412.8672 898.0791,-2379.2249 1009.6252,-2360.4481 1026.2567,-2357.6484 1028.9775,-2351.1496 1045.6252,-2348.4481 1095.71,-2340.3204 1109.8218,-2339.6326 1159.79,-2348.4481 1433.5093,-2396.738 1512.5136,-2413.87 1747.415,-2562.4481 1750.49,-2564.393 2119.2133,-2926.9968 2120.3654,-2930.4481"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#41ff00" stroke-dasharray="5,2" d="M587.465,-2161.3749C595.6663,-2109.1547 630.9539,-1882.2269 654.4731,-1695.4481 663.7997,-1621.3808 645.0209,-1420.6682 690.4731,-1361.4481 693.1112,-1358.0109 696.286,-1355.0461 699.7943,-1352.4887"/>
<polygon fill="#41ff00" stroke="#41ff00" points="701.7442,-1355.3999 708.4904,-1347.2304 698.1221,-1349.4098 701.7442,-1355.3999"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M635.4425,-2183.0496C642.7147,-2186.5592 649.4363,-2191.2306 654.4731,-2197.4481 726.798,-2286.7257 620.0733,-2362.6448 690.4731,-2453.4481 761.8388,-2545.4971 817.6893,-2535.1043 932.7092,-2553.4481"/>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M932.7092,-2553.4481C1210.3905,-2612.8061 1281.222,-2627.1027 1549.3953,-2720.4481 1639.8466,-2751.9323 1669.2389,-2750.12 1747.415,-2805.4481 1783.0287,-2830.6531 1815.4934,-2870.4236 1833.1038,-2894.0215"/>
<polygon fill="#00ff20" stroke="#00ff20" points="1830.3687,-2896.2105 1839.1014,-2902.2096 1836.0158,-2892.0741 1830.3687,-2896.2105"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M635.3681,-2182.2451C642.84,-2185.8409 649.6476,-2190.7496 654.4731,-2197.4481 698.5546,-2258.6388 664.606,-3483.6076 690.4731,-3554.4481 722.0725,-3640.9867 781.3082,-3632.7442 819.7932,-3716.4481 855.5141,-3794.1399 815.8075,-3829.8627 855.7932,-3905.4481 894.8739,-3979.3227 1328.1492,-4382.1392 1400.2236,-4424.4481 1407.0142,-4428.4342 1414.5293,-4431.893 1422.0982,-4434.8597"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1421.0698,-4438.2102 1431.6636,-4438.357 1423.4736,-4431.6359 1421.0698,-4438.2102"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M755.1332,-2363.4481C874.8259,-2417.2746 914.9203,-2322.274 1045.6252,-2310.4481 1357.9851,-2282.1865 1460.7027,-2257.3125 1747.415,-2384.4481 1825.5393,-2419.0904 1849.7627,-2426.2447 1910.4177,-2486.4481 1914.2733,-2490.2749 2118.7564,-2811.2595 2120.3654,-2816.4481"/>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M630.8278,-2183.5355C639.3014,-2187.0284 647.635,-2191.5693 654.4731,-2197.4481 679.8103,-2219.2305 673.3899,-2234.7321 690.4731,-2263.4481 717.5328,-2308.9337 707.5254,-2340.3251 755.1332,-2363.4481"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M586.7358,-2161.3197C592.2397,-2103.536 620.8349,-1832.3328 690.4731,-1622.4481 731.8692,-1497.6831 782.9754,-1482.6399 819.7932,-1356.4481 839.2793,-1289.6601 809.8171,-1097.6644 855.7932,-1045.4481 902.3325,-992.5921 944.0097,-1033.0265 1009.6252,-1007.4481 1033.3096,-998.2153 1058.4982,-984.1233 1076.6922,-973.0903"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1078.851,-975.8709 1085.5238,-967.6415 1075.1755,-969.9135 1078.851,-975.8709"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M635.6116,-2182.9148C642.8642,-2186.4401 649.5355,-2191.1516 654.4731,-2197.4481 746.0606,-2314.2401 610.4641,-2404.4393 690.4731,-2529.4481 831.6371,-2750.0073 955.5109,-2728.3347 1195.79,-2832.4481 1267.2132,-2863.3959 1307.1729,-2827.4928 1364.2236,-2880.4481 1398.2323,-2912.0154 1366.9466,-2946.1104 1400.2236,-2978.4481 1403.924,-2982.044 1408.1567,-2985.123 1412.6839,-2987.7594"/>
<polygon fill="#0052ff" stroke="#0052ff" points="1411.1861,-2990.9239 1421.6908,-2992.3034 1414.3391,-2984.6742 1411.1861,-2990.9239"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M755.1332,-2057.4481C847.7179,-2017.9117 963.2965,-1997.9123 1035.0628,-1988.5985"/>
<polygon fill="#0020ff" stroke="#0020ff" points="1035.8436,-1992.0278 1045.3255,-1987.3008 1034.9654,-1985.0831 1035.8436,-1992.0278"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M635.2837,-2182.3063C642.7647,-2185.8956 649.5971,-2190.7862 654.4731,-2197.4481 711.2231,-2274.9816 671.7663,-2967.2034 690.4731,-3061.4481 702.1405,-3120.228 730.2161,-3185.5114 745.2452,-3217.897"/>
<polygon fill="#1000ff" stroke="#1000ff" points="742.202,-3219.6501 749.629,-3227.206 748.5349,-3216.6678 742.202,-3219.6501"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M755.1332,-1757.4481C762.7764,-1745.5245 995.5031,-1743.5223 1009.6252,-1742.4481 1076.4615,-1737.3643 1099.5123,-1757.7658 1159.79,-1728.4481 1180.7111,-1718.2725 1175.5679,-1701.9502 1195.79,-1690.4481 1262.4954,-1652.5066 1305.735,-1702.1295 1364.2236,-1652.4481 1396.7441,-1624.8245 1372.5532,-1595.9287 1400.2236,-1563.4481 1462.5963,-1490.2325 1500.8643,-1497.3326 1585.3953,-1451.4481 1844.5779,-1310.7602 1933.5169,-1320.1907 2182.6875,-1162.4481 2224.6311,-1135.8948 2245.6855,-1074.5664 2281.0071,-1109.4481"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M635.3161,-2183.1532C642.6029,-2186.6509 649.3622,-2191.2914 654.4731,-2197.4481 717.1976,-2273.0067 625.1517,-2342.123 690.4731,-2415.4481 692.0919,-2417.2651 1361.8934,-2607.7466 1364.2236,-2608.4481 1535.2382,-2659.9326 1609.5206,-2615.9503 1747.415,-2729.4481 1773.2134,-2750.6822 1761.7248,-2770.032 1783.415,-2795.4481 1829.6973,-2849.6804 1878.2207,-2829.8356 1910.4177,-2893.4481 1987.26,-3045.2672 1897.8895,-4261.3567 1946.4177,-4424.4481 1950.904,-4439.5254 1960.1618,-4454.5674 1968.3937,-4465.9419"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1965.8326,-4468.3569 1974.6649,-4474.2084 1971.4094,-4464.1261 1965.8326,-4468.3569"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge349" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M635.3856,-2182.6549C642.7584,-2186.2083 649.5281,-2190.9966 654.4731,-2197.4481 711.1911,-2271.4441 646.1705,-2533.4138 690.4731,-2615.4481 734.8893,-2697.6925 778.6551,-2692.6595 855.7932,-2745.4481 1000.6597,-2844.5858 1041.9913,-2861.8282 1195.79,-2946.4481 1269.4322,-2986.9659 1299.367,-2978.9833 1364.2236,-3032.4481 1384.2556,-3048.9615 1380.3593,-3061.7333 1400.2236,-3078.4481 1429.0055,-3102.6664 1445.1858,-3095.267 1474.8094,-3118.4481"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge355" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0062" stroke-dasharray="5,2" d="M635.3268,-2182.275C642.8031,-2185.8676 649.6228,-2190.7674 654.4731,-2197.4481 723.7741,-2292.9005 646.1009,-3149.1554 690.4731,-3258.4481 832.0294,-3607.1131 1296.3358,-3809.8847 1435.2214,-3863.812"/>
<polygon fill="#ff0062" stroke="#ff0062" points="1434.0599,-3867.1151 1444.6499,-3867.4375 1436.5723,-3860.5815 1434.0599,-3867.1151"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-1866.4481C1159.3905,-1849.6778 1147.7465,-1805.8865 1195.79,-1771.4481 1263.3026,-1723.054 1289.6331,-1727.0018 1364.2236,-1690.4481 1579.5416,-1584.9296 1607.5352,-1435.5705 1846.9164,-1449.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2057.4481C823.4822,-2024.4078 792.1271,-1960.7987 855.7932,-1919.4481 949.9214,-1858.3125 994.543,-1896.4162 1102.7076,-1866.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M598.8333,-2161.2325C626.1236,-2138.4404 691.7683,-2086.4217 755.1332,-2057.4481"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2057.4481C796.9904,-2040.4729 810.7326,-2068.3295 855.7932,-2071.4481 923.9999,-2076.1685 941.3478,-2075.0006 1009.6252,-2071.4481 1167.8661,-2063.2147 1216.7068,-2092.2991 1364.2236,-2034.4481 1382.843,-2027.1462 1381.25,-2013.7726 1400.2236,-2007.4481 1472.9773,-1983.1968 1563.0568,-1996.6206 1617.5593,-2009.1101"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1616.7722,-2012.5204 1627.3099,-2011.422 1618.3872,-2005.7093 1616.7722,-2012.5204"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1102.7076,-1714.4481C1157.8723,-1698.0671 1151.8357,-1661.5896 1195.79,-1624.4481 1231.2916,-1594.4492 1239.3201,-1584.9175 1280.0068,-1562.4481"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M755.1332,-1757.4481C775.9486,-1724.5695 1065.4038,-1725.5253 1102.7076,-1714.4481"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M588.7189,-2161.186C602.3814,-2111.0782 662.0964,-1904.4026 755.1332,-1757.4481"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-1757.4481C782.4533,-1714.295 801.8999,-1710.2854 819.7932,-1662.4481 902.191,-1442.1597 729.2407,-1263.418 932.7092,-1145.4481"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M587.0524,-2161.415C593.375,-2111.3706 622.8893,-1901.3257 690.4731,-1743.4481 703.5469,-1712.9074 725.443,-1681.2005 740.0847,-1661.646"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="742.9659,-1663.6396 746.2437,-1653.5645 737.3985,-1659.3965 742.9659,-1663.6396"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-1866.4481C1129.098,-1858.6402 1135.7946,-1855.9252 1159.79,-1842.4481 1176.9981,-1832.7831 1178.0791,-1825.1574 1195.79,-1816.4481 1204.3226,-1812.2522 1213.6939,-1808.6173 1222.9894,-1805.519"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1224.1271,-1808.8302 1232.6106,-1802.4834 1222.0209,-1802.1545 1224.1271,-1808.8302"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-4720.4481C1332.4688,-4733.3504 1346.5586,-4708.6765 1400.2236,-4702.4481 1518.1384,-4688.7628 1548.651,-4695.4527 1666.4052,-4680.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-4680.4481C1701.0236,-4674.8384 1739.864,-4673.5593 1772.6225,-4673.8969"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1772.978,-4677.4028 1783.0316,-4674.0598 1773.0877,-4670.4036 1772.978,-4677.4028"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.3894,-2182.2297C642.8591,-2185.8272 649.6603,-2190.7404 654.4731,-2197.4481 705.8199,-2269.0113 647.9896,-3705.2929 690.4731,-3782.4481 723.7664,-3842.9125 783.9522,-3809.4582 819.7932,-3868.4481 858.327,-3931.8698 806.9541,-4144.5741 855.7932,-4200.4481 902.1411,-4253.472 960.0674,-4188.4113 1009.6252,-4238.4481 1058.4791,-4287.7741 1015.4426,-4327.928 1045.6252,-4390.4481 1081.2848,-4464.313 1124.8337,-4461.2478 1159.79,-4535.4481 1191.9637,-4603.7417 1142.6315,-4647.8447 1195.79,-4701.4481 1222.8088,-4728.6929 1244.2986,-4706.405 1280.0068,-4720.4481"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2297.157,-1877.6149C2311.9547,-1888.8392 2333.0702,-1907.5799 2343.3267,-1929.4481 2432.3249,-2119.2046 2443.0729,-2814.6704 2444.3148,-2945.9817"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2440.8176,-2946.3304 2444.4032,-2956.3 2447.8173,-2946.2703 2440.8176,-2946.3304"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2327.6303,-1873.5197C2367.0803,-1882.3205 2420.8562,-1901.6632 2444.4712,-1943.4481"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2162.3551,-1004.4934C2169.8601,-1007.982 2177.0667,-1012.5319 2182.6875,-1018.4481 2216.6672,-1054.2134 2184.4603,-1087.9195 2218.6875,-1123.4481 2239.2797,-1144.8232 2269.0996,-1120.2608 2281.0071,-1147.4481"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2154.4569,-1004.5299C2163.9447,-1008.2946 2174.0181,-1012.9629 2182.6875,-1018.4481 2233.0038,-1050.2836 2238.0132,-1068.2564 2281.0071,-1109.4481"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2164.3619,-1004.0579C2171.4172,-1007.5709 2177.9458,-1012.2412 2182.6875,-1018.4481 2208.6975,-1052.495 2267.9542,-1717.1033 2279.16,-1845.1899"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2275.6851,-1845.6311 2280.0411,-1855.289 2282.6586,-1845.0227 2275.6851,-1845.6311"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M1531.2705,-2800.2597C1538.164,-2796.8144 1544.4915,-2792.3169 1549.3953,-2786.4481 1620.528,-2701.317 1509.7719,-2620.6162 1585.3953,-2539.4481 1719.8327,-2395.1537 1825.3198,-2446.5127 2022.0432,-2460.4481 2066.0724,-2463.567 2076.3846,-2470.7075 2120.3654,-2474.4481"/>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M2120.3654,-2474.4481C2154.5375,-2473.8504 2280.0306,-2549.7831 2281.0071,-2550.4481"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff20" stroke-dasharray="5,2" d="M1549.7482,-2803.8804C1586.0459,-2802.8639 1629.6263,-2805.6422 1666.4052,-2819.4481"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1531.4913,-2800.4404C1538.3525,-2796.9686 1544.6121,-2792.4156 1549.3953,-2786.4481 1645.8145,-2666.1549 1489.3031,-2562.0026 1585.3953,-2441.4481 1713.2059,-2281.1005 1843.0512,-2392.4919 2022.0432,-2292.4481 2075.1883,-2262.7437 2414.5157,-1890.4442 2444.4712,-1943.4481"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge342" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1480.0931,-2822.5573C1492.8892,-2849.6787 1526.1945,-2921.5833 1549.3953,-2983.4481 1567.9038,-3032.801 1560.4861,-3049.9959 1585.3953,-3096.4481 1602.4048,-3128.1685 1629.8298,-3159.7222 1647.986,-3178.9076"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1645.6841,-3181.563 1655.1423,-3186.3371 1650.7256,-3176.7067 1645.6841,-3181.563"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff3100" stroke-dasharray="5,2" d="M412.5053,-4692.5878C431.6287,-4709.372 466.0505,-4743.1731 480.9653,-4780.4481 565.7097,-4992.2402 427.2943,-5082.6943 516.9653,-5292.4481 578.8246,-5437.1459 597.7673,-5554.4481 755.1332,-5554.4481 755.1332,-5554.4481 755.1332,-5554.4481 932.7092,-5554.4481 1368.1192,-5554.4481 1483.321,-5577.125 1910.4177,-5492.4481 2055.1605,-5463.7511 2113.4568,-5432.7596 2182.6875,-5302.4481 2228.7605,-5215.7259 2200.4342,-5180.9378 2218.6875,-5084.4481 2268.0195,-4823.6722 2312.3275,-4764.0325 2343.3267,-4500.4481 2353.1148,-4417.22 2331.037,-3060.9377 2379.3267,-2992.4481 2381.5517,-2989.2923 2384.2326,-2986.5347 2387.2214,-2984.1252"/>
<polygon fill="#ff3100" stroke="#ff3100" points="2389.3118,-2986.9398 2395.7501,-2978.5255 2385.4699,-2981.0883 2389.3118,-2986.9398"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1671.9797,-2011.3535C1716.6833,-1923.0059 2017.7903,-1339.679 2120.3654,-1449.4481"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge339" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1477.2944,-1347.6149C1488.2594,-1397.4573 1532.5159,-1604.7236 1549.3953,-1777.4481 1563.6547,-1923.3631 1534.8963,-2958.8095 1585.3953,-3096.4481 1597.7122,-3130.0186 1626.0037,-3160.8685 1645.6599,-3179.4155"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1643.4925,-3182.1768 1653.2283,-3186.3559 1648.2236,-3177.0176 1643.4925,-3182.1768"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1499.3882,-1347.5254C1558.0092,-1373.1339 1711.2693,-1435.3251 1846.9164,-1449.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1846.9164,-1449.4481C1907.8426,-1452.9801 1923.3563,-1445.1109 1984.2305,-1449.4481"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1476.3601,-1347.7665C1484.1373,-1403.1626 1521.0881,-1650.8622 1585.3953,-1844.4481 1605.0865,-1903.7253 1638.312,-1969.7298 1655.4505,-2002.1805"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1652.428,-2003.9509 1660.2201,-2011.1296 1658.6054,-2000.6585 1652.428,-2003.9509"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2150.6628,-1098.4397C2186.815,-1087.4743 2246.6715,-1076.5517 2281.0071,-1109.4481"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2136.0241,-1120.5024C2150.6794,-1131.7766 2171.888,-1150.6705 2182.6875,-1172.4481 2243.7861,-1295.6557 2273.639,-1742.302 2279.792,-1845.202"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2276.3041,-1845.5124 2280.3844,-1855.29 2283.292,-1845.102 2276.3041,-1845.5124"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M631.5651,-3268.3529C656.5419,-3262.3082 687.2739,-3254.8707 711.8412,-3248.9252"/>
<polygon fill="#1000ff" stroke="#1000ff" points="712.7173,-3252.3143 721.6134,-3246.5602 711.0707,-3245.5107 712.7173,-3252.3143"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.3039,-3290.4909C590.1117,-3357.9083 613.6803,-3713.432 690.4731,-3782.4481 770.9391,-3854.7653 824.5216,-3806.4481 932.7092,-3806.4481 932.7092,-3806.4481 932.7092,-3806.4481 1102.7076,-3806.4481 1396.1122,-3806.4481 1516.7456,-3845.7706 1747.415,-3664.4481 1876.9619,-3562.615 1856.5465,-3487.173 1910.4177,-3331.4481 1917.1044,-3312.1188 2205.5098,-1907.0903 2218.6875,-1891.4481 2221.4759,-1888.1382 2224.7661,-1885.2626 2228.3541,-1882.7648"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2230.3137,-1885.6732 2237.1701,-1877.596 2226.7732,-1879.6345 2230.3137,-1885.6732"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M640.3458,-3268.3631C645.5359,-3265.729 650.3788,-3262.4727 654.4731,-3258.4481 691.4596,-3222.0918 659.1368,-3188.7737 690.4731,-3147.4481 732.1787,-3092.4478 781.8568,-3119.1127 819.7932,-3061.4481 868.9517,-2986.7256 817.1173,-2944.0965 855.7932,-2863.4481 880.7243,-2811.4609 1156.7136,-2513.8421 1195.79,-2471.4481 1268.3051,-2392.7763 1302.5931,-2386.9087 1364.2236,-2299.4481 1385.2911,-2269.5509 1373.6834,-2250.6134 1400.2236,-2225.4481 1452.4479,-2175.9292 1491.5456,-2205.2605 1549.3953,-2162.4481 1595.5768,-2128.2708 1635.0534,-2072.2491 1654.1451,-2042.4908"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1657.2428,-2044.1398 1659.6101,-2033.8128 1651.3195,-2040.4096 1657.2428,-2044.1398"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445.7231,-525.413C457.5586,-521.7561 470.0154,-517.1305 480.9653,-511.4481 498.9568,-502.1115 500.67,-495.5032 516.9653,-483.4481 655.763,-380.7666 686.4185,-326.9214 855.7932,-293.4481 988.3421,-267.2525 1053.5688,-211.9468 1159.79,-295.4481 1210.2985,-335.1532 1151.946,-388.4874 1195.79,-435.4481 1208.7946,-449.377 1832.0005,-639.5884 1846.9164,-651.4481"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff52" stroke-dasharray="5,2" d="M463.8306,-1226.249C547.2727,-1233.5092 696.302,-1250.125 819.7932,-1283.4481 907.535,-1307.1245 935.7271,-1306.5495 1009.6252,-1359.4481 1112.9528,-1433.4132 1112.8879,-1480.143 1195.79,-1576.4481 1270.5035,-1663.2406 1323.4787,-1664.4206 1364.2236,-1771.4481 1411.4102,-1895.3962 1382.6371,-4026.9931 1400.2236,-4158.4481 1414.05,-4261.7969 1451.7708,-4381.2046 1467.6319,-4428.5554"/>
<polygon fill="#00ff52" stroke="#00ff52" points="1464.3977,-4429.9171 1470.9189,-4438.2673 1471.0282,-4427.673 1464.3977,-4429.9171"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M415.9996,-1232.4989C433.2315,-1244.1468 460.2862,-1263.5355 480.9653,-1283.4481 533.918,-1334.4377 516.6053,-1386.4043 585.7192,-1411.4481"/>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M585.7192,-1411.4481C819.739,-1496.2464 895.9423,-1556.0159 1009.6252,-1777.4481 1039.1648,-1834.9853 1015.0116,-1861.4751 1045.6252,-1918.4481 1054.7945,-1935.5123 1069.5661,-1951.639 1081.7854,-1963.304"/>
<polygon fill="#0020ff" stroke="#0020ff" points="1079.6377,-1966.0846 1089.362,-1970.2904 1084.3829,-1960.9384 1079.6377,-1966.0846"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge363" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M422.9186,-1232.4945C442.1388,-1242.7768 468.0268,-1260.0394 480.9653,-1283.4481 525.424,-1363.8835 506.4055,-1604.1523 516.9653,-1695.4481 537.4129,-1872.2281 571.3437,-2084.5275 582.238,-2151.2937"/>
<polygon fill="#ff0031" stroke="#ff0031" points="578.8204,-2152.082 583.8904,-2161.385 585.7284,-2150.9508 578.8204,-2152.082"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-1145.4481C1314.2307,-1162.7979 1333.9516,-1140.8706 1364.2236,-1164.4481 1392.1365,-1186.188 1378.1624,-1207.7885 1400.2236,-1235.4481 1427.1028,-1269.1481 1451.0295,-1261.494 1474.8094,-1297.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.0801,-1210.2259C427.8636,-1190.0487 470.7233,-1148.1897 516.9653,-1131.4481 761.9695,-1042.7459 851.3394,-1037.8248 1102.7076,-1106.4481"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-1106.4481C1180.6612,-1127.2585 1208.0425,-1108.9656 1280.0068,-1145.4481"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1280.0068,-1145.4481C1314.2307,-1162.7979 1336.8448,-1137.5652 1364.2236,-1164.4481 1412.2191,-1211.5742 1354.6811,-1261.9473 1400.2236,-1311.4481 1403.5727,-1315.0882 1407.467,-1318.1987 1411.6854,-1320.8567"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1410.2606,-1324.0639 1420.7281,-1325.7014 1413.5664,-1317.8937 1410.2606,-1324.0639"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1102.7076,-1106.4481C1129.2572,-1113.6961 1136.1576,-1116.3442 1159.79,-1130.4481 1177.4326,-1140.9772 1177.598,-1149.8996 1195.79,-1159.4481 1203.8231,-1163.6644 1212.67,-1167.271 1221.5188,-1170.3237"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1220.4912,-1173.6698 1231.0831,-1173.4215 1222.6481,-1167.0104 1220.4912,-1173.6698"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-1326.4535 166.6166,-1326.4535 166.6166,-1304.4426 281.0645,-1304.4426 281.0645,-1326.4535"/>
<text text-anchor="middle" x="223.8406" y="-1312.2981" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0020ff" stroke-dasharray="5,2" d="M399.0839,-1297.4481C495.7787,-1287.5602 503.1115,-1360.2268 585.7192,-1411.4481"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1000ff" stroke-dasharray="5,2" d="M231.3941,-1326.5691C244.3912,-1346.4019 270.6078,-1389.6326 281.2024,-1430.4481 325.635,-1601.623 237.8818,-2067.3868 317.2024,-2225.4481 404.078,-2398.5642 565.9616,-2329.1627 654.4731,-2501.4481 711.458,-2612.3676 664.8167,-2939.4146 690.4731,-3061.4481 702.8027,-3120.0927 730.5928,-3185.4344 745.4059,-3217.8642"/>
<polygon fill="#1000ff" stroke="#1000ff" points="742.3449,-3219.5834 749.7234,-3227.1867 748.6968,-3216.6417 742.3449,-3219.5834"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge362" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M258.9495,-1326.4666C315.8477,-1346.2999 427.236,-1393.7378 480.9653,-1475.4481 485.779,-1482.7686 565.887,-2035.3016 582.6563,-2151.2512"/>
<polygon fill="#ff0031" stroke="#ff0031" points="579.2208,-2151.9496 584.1157,-2161.3459 586.1488,-2150.9479 579.2208,-2151.9496"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-1145.4481C606.1205,-1139.4512 1222.2206,-1278.9014 1416.6332,-1323.1711"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1415.8586,-1326.5842 1426.3862,-1325.3926 1417.4133,-1319.759 1415.8586,-1326.5842"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.6315,-1304.2959C275.5919,-1287.6888 333.9598,-1256.3805 369.4033,-1237.3687"/>
<polygon fill="#ff0000" stroke="#ff0000" points="371.1622,-1240.397 378.32,-1232.5857 367.8533,-1234.2284 371.1622,-1240.397"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M281.4568,-1309.5168C315.6434,-1306.0008 359.8349,-1301.4616 399.0839,-1297.4481"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M932.7092,-1145.4481C981.572,-1117.1177 1143.056,-1150.6232 1227.5039,-1171.0061"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1226.8632,-1174.4524 1237.4078,-1173.4218 1228.522,-1167.6518 1226.8632,-1174.4524"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1297.4481C442.9439,-1292.963 451.9836,-1274.6727 480.9653,-1241.4481 504.4834,-1214.487 490.1033,-1193.0792 516.9653,-1169.4481 541.2659,-1148.0703 554.6675,-1154.5756 585.7192,-1145.4481"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-1145.4481C833.9328,-1141.0431 864.0859,-1184.4306 932.7092,-1145.4481"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-1145.4481C657.9581,-1124.2137 679.9555,-1149.6505 755.1332,-1145.4481"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge356" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M405.5756,-1539.7462C420.8155,-1566.7069 459.2319,-1637.2763 480.9653,-1700.4481 539.0461,-1869.2693 572.9264,-2083.3834 582.7267,-2150.9913"/>
<polygon fill="#ff0031" stroke="#ff0031" points="579.3082,-2151.8115 584.1859,-2161.2168 586.238,-2150.8226 579.3082,-2151.8115"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M463.6014,-1534.7515C654.7516,-1552.8998 1209.2075,-1601.5474 1280.0068,-1562.4481"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge357" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0031" stroke-dasharray="5,2" d="M403.6973,-1731.6212C428.3555,-1791.3391 544.6886,-2073.0787 577.2383,-2151.9086"/>
<polygon fill="#ff0031" stroke="#ff0031" points="574.0483,-2153.3537 581.0999,-2161.2609 580.5184,-2150.682 574.0483,-2153.3537"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M443.5394,-1717.4435C494.6212,-1713.6793 580.8798,-1706.3675 654.4731,-1695.4481 728.5869,-1684.4514 756.1971,-1702.0625 819.7932,-1662.4481 842.1271,-1648.5361 833.342,-1629.1699 855.7932,-1615.4481 885.4408,-1597.3279 898.9095,-1609.5041 932.7092,-1601.4481"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#73ff00" stroke-dasharray="5,2" d="M1345.6283,-1173.2499C1352.6394,-1169.7816 1359.0775,-1165.2807 1364.2236,-1159.4481 1429.1931,-1085.8109 1372.9687,-1035.7912 1400.2236,-941.4481 1417.1764,-882.7659 1448.0554,-817.4404 1464.2519,-785.0228"/>
<polygon fill="#73ff00" stroke="#73ff00" points="1467.5742,-786.2082 1468.9583,-775.7041 1461.3259,-783.0524 1467.5742,-786.2082"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1299.215,-1195.5451C1317.5716,-1206.8509 1345.1906,-1225.7675 1364.2236,-1247.4481 1385.7544,-1271.9738 1375.0724,-1290.6513 1400.2236,-1311.4481 1404.8086,-1315.2392 1409.9928,-1318.464 1415.4397,-1321.2054"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1414.2364,-1324.501 1424.7949,-1325.3774 1417.0874,-1318.1079 1414.2364,-1324.501"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M932.7092,-1601.4481C1009.9575,-1593.4387 1213.2069,-1602.0613 1280.0068,-1562.4481"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M803.7901,-1631.4088C839.4993,-1623.2596 889.1582,-1611.8283 932.7092,-1601.4481"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M436.8684,-603.3677C539.3484,-575.7325 827.1011,-514.4496 1009.6252,-637.4481 1110.2477,-705.255 1117.9416,-751.5561 1159.79,-865.4481 1182.4914,-927.2307 1153.2844,-1109.1916 1195.79,-1159.4481 1198.4831,-1162.6323 1201.5617,-1165.4214 1204.9128,-1167.8637"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1203.3794,-1171.028 1213.7392,-1173.2472 1207.0244,-1165.0519 1203.3794,-1171.028"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1329.2935,-1798.6705C1449.748,-1819.0938 1760.166,-1888.9723 1910.4177,-2083.4481 1997.6504,-2196.3562 1973.8985,-2250.1355 2022.0432,-2384.4481 2038.548,-2430.4925 2036.9757,-2444.3045 2058.0432,-2488.4481 2103.1553,-2582.9733 2150.1068,-2588.9061 2182.6875,-2688.4481 2203.5126,-2752.0737 2269.5445,-3806.4952 2279.6926,-3970.1717"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2276.214,-3970.6266 2280.3253,-3980.3912 2283.2006,-3970.194 2276.214,-3970.6266"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2281.0071,-1905.4481C2349.8347,-1934.1904 2411.3255,-1876.6295 2444.4712,-1943.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1307.6161,-1780.3875C1360.4745,-1759.8751 1480.0847,-1716.6429 1585.3953,-1701.4481 1777.472,-1673.7342 1837.1442,-1642.5084 2022.0432,-1701.4481 2105.4562,-1728.0374 2125.5245,-1749.1374 2182.6875,-1815.4481 2205.7883,-1842.2456 2191.5984,-1863.69 2218.6875,-1886.4481 2240.8582,-1905.0741 2254.2871,-1894.2898 2281.0071,-1905.4481"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1119.7488,-623.5995C1132.1526,-632.4079 1148.6595,-645.6511 1159.79,-660.4481 1183.472,-691.9309 1168.6934,-712.8513 1195.79,-741.4481 1253.6025,-802.4611 1296.1735,-778.112 1364.2236,-827.4481 1679.1876,-1055.7958 1764.9627,-1150.6326 1910.4177,-1511.4481 2078.3156,-1927.9353 2107.7151,-2041.6948 2182.6875,-2484.4481 2225.3634,-2736.4728 2202.1697,-2803.37 2218.6875,-3058.4481 2242.3244,-3423.4624 2272.6295,-3868.6964 2279.5546,-3970.1822"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2276.0763,-3970.6215 2280.2493,-3980.3599 2283.0601,-3970.1447 2276.0763,-3970.6215"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2444.4712,-841.4481C2516.9571,-927.1616 2570.037,-2747.8606 2576.1253,-2965.279"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2572.6298,-2965.492 2576.4068,-2975.3906 2579.627,-2965.2971 2572.6298,-2965.492"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1106.5318,-601.2241C1117.6398,-569.3884 1151.9186,-476.3607 1195.79,-407.4481 1297.6589,-247.434 1369.9739,-106.8872 1549.3953,-168.4481 1568.5679,-175.0264 1568.4511,-185.3233 1585.3953,-196.4481 1838.3832,-362.5492 1959.419,-319.1353 2182.6875,-523.4481 2298.6583,-629.5728 2255.8312,-720.1826 2379.3267,-817.4481 2403.5666,-836.5396 2424.5469,-817.8879 2444.4712,-841.4481"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.0377,-623.9191C1116.1864,-659.4331 1146.8242,-770.874 1159.79,-865.4481 1202.7663,-1178.9206 1129.225,-1267.1245 1195.79,-1576.4481 1211.8245,-1650.9593 1250.4934,-1733.3821 1269.3325,-1770.8671"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1266.4296,-1772.8798 1274.085,-1780.2042 1272.6681,-1769.7045 1266.4296,-1772.8798"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff83" stroke-dasharray="5,2" d="M1009.6511,-5785.3019C1054.8657,-5783.9014 1112.2862,-5777.7169 1159.79,-5758.4481 1178.5734,-5750.829 1177.9174,-5740.0102 1195.79,-5730.4481 1490.9632,-5572.5262 1672.3168,-5727.7659 1910.4177,-5492.4481 1945.2073,-5458.0652 1916.0723,-5426.8101 1946.4177,-5388.4481 1971.1156,-5357.2255 1998.6935,-5372.6912 2022.0432,-5340.4481 2060.2309,-5287.7156 2032.521,-5258.3449 2058.0432,-5198.4481 2099.1006,-5102.0925 2151.8837,-5098.5542 2182.6875,-4998.4481 2241.9469,-4805.8671 2159.8591,-4285.1611 2218.6875,-4092.4481 2228.234,-4061.1751 2249.8929,-4029.8623 2264.9786,-4010.5766"/>
<polygon fill="#00ff83" stroke="#00ff83" points="2267.8475,-4012.5938 2271.3802,-4002.6053 2262.3896,-4008.2107 2267.8475,-4012.5938"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M438.367,-795.4366C488.9633,-781.6222 572.0527,-760.3205 585.7192,-765.4481"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge332" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#a400ff" stroke-dasharray="5,2" d="M447.6982,-795.359C459.0063,-791.7721 470.7243,-787.1924 480.9653,-781.4481 490.5213,-776.088 538.5336,-732.1888 566.1243,-706.6657"/>
<polygon fill="#a400ff" stroke="#a400ff" points="568.6858,-709.0638 573.6413,-699.6993 563.9276,-703.9296 568.6858,-709.0638"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M585.7192,-765.4481C654.5458,-791.2712 630.6513,-850.7248 690.4731,-893.4481 715.4182,-911.2632 724.6756,-913.9876 755.1332,-917.4481"/>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M755.1332,-917.4481C867.9369,-930.2645 897.105,-924.3439 1009.6252,-939.4481 1018.5927,-940.6518 1028.0102,-942.1245 1037.269,-943.6947"/>
<polygon fill="#00b4ff" stroke="#00b4ff" points="1036.7724,-947.1608 1047.2246,-945.4287 1037.9735,-940.2646 1036.7724,-947.1608"/>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M271.9965,-757.4242C343.1883,-743.4418 479.5414,-725.611 585.7192,-765.4481"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#a400ff" stroke-dasharray="5,2" d="M238.7754,-757.3334C256.4824,-744.8048 287.3661,-724.9485 317.2024,-715.4481 387.6632,-693.0121 473.3047,-687.9779 528.627,-687.4163"/>
<polygon fill="#a400ff" stroke="#a400ff" points="528.9527,-690.9147 538.9334,-687.36 528.9144,-683.9148 528.9527,-690.9147"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M274.9993,-779.5414C294.7941,-783.8337 317.6108,-788.7813 338.2375,-793.2541"/>
<polygon fill="#ff0000" stroke="#ff0000" points="337.6499,-796.7079 348.1645,-795.4066 339.1334,-789.8669 337.6499,-796.7079"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M474.9081,-917.5181C547.0698,-913.7401 658.6509,-910.2742 755.1332,-917.4481"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00b4ff" stroke-dasharray="5,2" d="M429.6411,-1004.4426C503.4105,-978.2977 689.9512,-914.8232 755.1332,-917.4481"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0052ff" stroke-dasharray="5,2" d="M1283.4367,-1387.5609C1296.822,-1431.5175 1345.7155,-1597.7036 1364.2236,-1738.4481 1395.9084,-1979.3943 1346.9416,-2594.3404 1400.2236,-2831.4481 1413.2308,-2889.3306 1445.5271,-2951.9835 1463.0505,-2983.2701"/>
<polygon fill="#0052ff" stroke="#0052ff" points="1460.1898,-2985.3198 1468.1777,-2992.2801 1466.2738,-2981.8577 1460.1898,-2985.3198"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M1302.424,-1365.3572C1321.6955,-1354.6715 1348.7561,-1336.7121 1364.2236,-1313.4481 1400.7485,-1258.5124 1348.8232,-1210.8002 1400.2236,-1169.4481 1649.7072,-968.7359 1800.4095,-1160.9245 2120.3654,-1148.4481"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2120.3654,-1148.4481C2129.4162,-1146.8914 2274.4726,-1102.995 2281.0071,-1109.4481"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2444.4712,-4068.4481C2544.3165,-3872.6983 2571.8344,-3141.6903 2576.0836,-3007.6355"/>
<polygon fill="#4100ff" stroke="#4100ff" points="2579.5872,-3007.5665 2576.397,-2997.4634 2572.5906,-3007.3508 2579.5872,-3007.5665"/>
<path fill="none" stroke="#4100ff" stroke-dasharray="5,2" d="M2127.5917,-3850.4752C2139.5372,-3868.8505 2163.9431,-3907.021 2182.6875,-3940.4481 2199.9921,-3971.3075 2191.0529,-3989.3555 2218.6875,-4011.4481 2259.1069,-4043.7616 2420.9582,-4114.5461 2444.4712,-4068.4481"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7300ff" stroke-dasharray="5,2" d="M1860.1189,-4666.2765C1873.7408,-4654.3336 1895.1017,-4634.4066 1910.4177,-4614.4481 1937.7189,-4578.8716 1961.971,-4532.1447 1974.7309,-4505.8044"/>
<polygon fill="#7300ff" stroke="#7300ff" points="1977.8926,-4507.3056 1979.041,-4496.7731 1971.5752,-4504.2906 1977.8926,-4507.3056"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge343" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff0094" stroke-dasharray="5,2" d="M1483.1546,-4744.3228C1499.5692,-4721.6909 1535.6505,-4668.0529 1549.3953,-4616.4481 1622.6326,-4341.4773 1507.3311,-3610.0877 1585.3953,-3336.4481 1598.6927,-3289.8362 1631.1884,-3242.5447 1650.7432,-3216.9146"/>
<polygon fill="#ff0094" stroke="#ff0094" points="1653.6875,-3218.8301 1657.0676,-3208.7889 1648.1635,-3214.5306 1653.6875,-3218.8301"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1509.9246,-4744.323C1522.4582,-4740.1826 1536.6313,-4735.3053 1549.3953,-4730.4481 1602.2509,-4710.3342 1610.3054,-4687.5965 1666.4052,-4680.4481"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplantwaterthermaltankf90EfferentGraph = svgPanZoom('#sourcefileplantwaterthermaltankf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~plantwaterthermaltank.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileplantwaterthermaltankf90AfferentGraph" width="641pt" height="216pt"
 viewBox="0.00 0.00 641.00 215.97" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph" class="graph" transform="scale(.2158 .2158) rotate(0) translate(4 996.7365)">
<title>sourcefile~~plantwaterthermaltank.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-996.7365 2966.2246,-996.7365 2966.2246,4 -4,4"/>
<!-- sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~plantwaterthermaltank.f90</title>
<polygon fill="none" stroke="#000000" points="141.6296,-216.492 .1233,-216.492 .1233,-194.4811 141.6296,-194.4811 141.6296,-216.492"/>
<text text-anchor="middle" x="70.8765" y="-202.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PlantWaterThermalTank.f90</text>
</g>
<!-- sourcefile~nonzoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~nonzoneequipmentmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/nonzoneequipmentmanager.f90.html" xlink:title="NonZoneEquipmentManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="547,-679.492 383.4533,-679.492 383.4533,-657.4811 547,-657.4811 547,-679.492"/>
<text text-anchor="middle" x="465.2267" y="-665.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NonZoneEquipmentManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~nonzoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge114" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~nonzoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.5465,-668.4865C308.958,-699.5045 375.6816,-692.079 419.7194,-681.9449"/>
<polygon fill="#ff0000" stroke="#ff0000" points="420.6891,-685.3111 429.577,-679.5443 419.0328,-678.5099 420.6891,-685.3111"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1761.9252,-392.492 1618.2296,-392.492 1618.2296,-370.4811 1761.9252,-370.4811 1761.9252,-392.492"/>
<text text-anchor="middle" x="1690.0774" y="-378.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge115" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1472.2368,-202.4865C1507.1798,-216.7315 1522.7711,-201.8385 1554.9873,-221.4865 1613.463,-257.1498 1659.0359,-326.9793 1679.026,-361.3702"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1676.2027,-363.4861 1684.1858,-370.4517 1682.2889,-360.028 1676.2027,-363.4861"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M92.4633,-194.4598C150.8793,-165.6763 317.604,-90.4865 465.2267,-90.4865 465.2267,-90.4865 465.2267,-90.4865 832.4246,-90.4865 1065.2941,-90.4865 1129.803,-80.7255 1353.4863,-145.4865 1409.72,-161.7674 1418.0254,-180.3865 1472.2368,-202.4865"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~heatbalanceinternalheatgains.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/heatbalanceinternalheatgains.f90.html" xlink:title="HeatBalanceInternalHeatGains.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="919.6928,-816.492 745.1563,-816.492 745.1563,-794.4811 919.6928,-794.4811 919.6928,-816.492"/>
<text text-anchor="middle" x="832.4246" y="-802.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceInternalHeatGains.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge116" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.5465,-668.4865C407.7416,-765.5242 614.3839,-794.0265 734.8284,-802.2734"/>
<polygon fill="#ff0000" stroke="#ff0000" points="734.9302,-805.7874 745.1364,-802.9441 735.3848,-798.8021 734.9302,-805.7874"/>
</g>
<!-- sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~packagedthermalstoragecoil.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/packagedthermalstoragecoil.f90.html" xlink:title="PackagedThermalStorageCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="347.1342,-216.492 177.9588,-216.492 177.9588,-194.4811 347.1342,-194.4811 347.1342,-216.492"/>
<text text-anchor="middle" x="262.5465" y="-202.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedThermalStorageCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge117" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M141.7027,-205.4865C150.134,-205.4865 158.8429,-205.4865 167.5426,-205.4865"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.734,-208.9866 177.734,-205.4865 167.7339,-201.9866 167.734,-208.9866"/>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1327.8196,-572.492 1200.8142,-572.492 1200.8142,-550.4811 1327.8196,-550.4811 1327.8196,-572.492"/>
<text text-anchor="middle" x="1264.3169" y="-558.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge118" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M262.5465,-668.4865C306.5898,-700.4458 329.3023,-654.8993 383.3401,-648.4865 499.6562,-634.6831 529.0696,-629.4865 646.2019,-629.4865 646.2019,-629.4865 646.2019,-629.4865 832.4246,-629.4865 971.0928,-629.4865 1131.7906,-594.8574 1212.4594,-575.0231"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1213.5014,-578.3707 1222.3628,-572.5632 1211.814,-571.5771 1213.5014,-578.3707"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M71.5298,-216.659C75.6232,-275.4316 103.0576,-550.5558 262.5465,-668.4865"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1945.2384,-606.492 1846.6803,-606.492 1846.6803,-584.4811 1945.2384,-584.4811 1945.2384,-606.492"/>
<text text-anchor="middle" x="1895.9594" y="-592.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~nonzoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~nonzoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M547.2609,-668.1354C621.6775,-667.8472 734.4091,-667.4865 832.4246,-667.4865 832.4246,-667.4865 832.4246,-667.4865 1047.353,-667.4865 1201.9533,-667.4865 1670.2441,-619.4413 1836.5657,-601.8453"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1837.0344,-605.3153 1846.6098,-600.7809 1836.2966,-598.3543 1837.0344,-605.3153"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1761.9993,-387.8178C1771.8867,-391.1239 1781.3213,-395.8331 1789.1675,-402.4865 1822.6559,-430.8842 1804.4196,-455.7899 1825.1675,-494.4865 1841.3853,-524.7341 1865.0456,-556.6977 1880.4715,-576.3715"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1877.7692,-578.5968 1886.728,-584.2528 1883.2518,-574.2445 1877.7692,-578.5968"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2674.1891,-644.492 2575.2316,-644.492 2575.2316,-622.4811 2674.1891,-622.4811 2674.1891,-644.492"/>
<text text-anchor="middle" x="2624.7103" y="-630.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1761.8353,-389.7108C1771.5235,-392.7733 1780.9438,-396.9108 1789.1675,-402.4865 1813.0417,-418.6736 1800.0961,-442.2238 1825.1675,-456.4865 2004.733,-558.6382 2084.7153,-452.2968 2289.3713,-480.4865"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M845.4942,-794.4341C866.9979,-776.8425 911.8291,-742.6141 955.5586,-724.4865 994.0451,-708.5323 1011.2983,-726.3624 1047.353,-705.4865"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1047.353,-705.4865C1168.189,-635.5218 1060.845,-498.682 1175.1475,-418.4865 1209.65,-394.2793 1471.4495,-385.6698 1607.8996,-382.8057"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1608.3761,-386.2968 1618.3026,-382.5933 1608.2332,-379.2982 1608.3761,-386.2968"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1047.353,-705.4865C1096.3521,-677.4698 1499.1703,-694.8715 1554.9873,-686.4865 1665.1225,-669.9417 1790.7656,-631.0116 1854.365,-609.8277"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1855.66,-613.0851 1864.0277,-606.5864 1853.4337,-606.4485 1855.66,-613.0851"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2372.5621,-836.492 2206.1806,-836.492 2206.1806,-814.4811 2372.5621,-814.4811 2372.5621,-836.492"/>
<text text-anchor="middle" x="2289.3713" y="-822.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1264.3169,-903.4865C1319.8051,-893.7466 1333.4952,-917.2581 1389.4863,-923.4865 1522.5284,-938.2861 1556.3481,-936.5131 1690.0774,-942.4865"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2538.9741,-798.492 2408.9634,-798.492 2408.9634,-776.4811 2538.9741,-776.4811 2538.9741,-798.492"/>
<text text-anchor="middle" x="2473.9688" y="-784.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M2086.3887,-786.4865C2176.4858,-781.8856 2199.2489,-790.5609 2289.3713,-786.4865"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1472.2368,-864.4865C1628.7289,-836.1617 1667.2598,-824.3866 1825.1675,-805.4865 1940.7475,-791.6527 1970.1351,-792.4232 2086.3887,-786.4865"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M2289.3713,-786.4865C2325.2042,-784.8666 2364.989,-784.8542 2398.4211,-785.3534"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2398.524,-788.8556 2408.5812,-785.5236 2398.6413,-781.8565 2398.524,-788.8556"/>
</g>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/daylightingmanager.f90.html" xlink:title="DaylightingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1751.4047,-895.492 1628.7501,-895.492 1628.7501,-873.4811 1751.4047,-873.4811 1751.4047,-895.492"/>
<text text-anchor="middle" x="1690.0774" y="-881.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1472.2368,-864.4865C1527.3633,-854.5087 1591.2879,-862.6699 1635.5685,-871.3791"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1635.0471,-874.8448 1645.5452,-873.416 1636.4474,-867.9863 1635.0471,-874.8448"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~roomairmodelcrossvent.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/roomairmodelcrossvent.f90.html" xlink:title="RoomAirModelCrossVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1121.2513,-919.492 973.4548,-919.492 973.4548,-897.4811 1121.2513,-897.4811 1121.2513,-919.492"/>
<text text-anchor="middle" x="1047.353" y="-905.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelCrossVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M845.5128,-816.5778C867.0426,-834.2496 911.9098,-868.7122 955.5586,-887.4865 961.7136,-890.1339 968.2506,-892.4719 974.8895,-894.5317"/>
<polygon fill="#00ff66" stroke="#00ff66" points="974.0779,-897.9403 984.6565,-897.354 976.0212,-891.2154 974.0779,-897.9403"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~zonecontaminantpredictorcorrector.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/zonecontaminantpredictorcorrector.f90.html" xlink:title="ZoneContaminantPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1789.2577,-760.492 1590.8971,-760.492 1590.8971,-738.4811 1789.2577,-738.4811 1789.2577,-760.492"/>
<text text-anchor="middle" x="1690.0774" y="-746.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneContaminantPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1472.2368,-864.4865C1550.9339,-850.2425 1630.9007,-795.4416 1668.2872,-766.9384"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1670.6744,-769.5165 1676.4353,-760.6247 1666.3868,-763.9832 1670.6744,-769.5165"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1264.3169,-903.4865C1356.9215,-887.2315 1379.7196,-881.232 1472.2368,-864.4865"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~roomairmodelusertemppattern.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/roomairmodelusertemppattern.f90.html" xlink:title="RoomAirModelUserTempPattern.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1137.5045,-878.492 957.2016,-878.492 957.2016,-856.4811 1137.5045,-856.4811 1137.5045,-878.492"/>
<text text-anchor="middle" x="1047.353" y="-864.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUserTempPattern.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M862.7861,-816.5066C887.555,-825.2757 923.5571,-837.5208 955.5586,-846.4865 965.1219,-849.1658 975.3157,-851.7561 985.3021,-854.1487"/>
<polygon fill="#00ff66" stroke="#00ff66" points="984.6529,-857.5914 995.1884,-856.4714 986.254,-850.777 984.6529,-857.5914"/>
</g>
<!-- sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~delightmanagerf.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/delightmanagerf.f90.html" xlink:title="DElightManagerF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1527.2898,-914.492 1417.1838,-914.492 1417.1838,-892.4811 1527.2898,-892.4811 1527.2898,-914.492"/>
<text text-anchor="middle" x="1472.2368" y="-900.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DElightManagerF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1264.3169,-903.4865C1311.5144,-895.2019 1365.6723,-895.5093 1406.8807,-897.7257"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1406.8775,-901.2315 1417.0662,-898.3262 1407.2896,-894.2436 1406.8775,-901.2315"/>
</g>
<!-- sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~roomairmodelufad.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/roomairmodelufad.f90.html" xlink:title="RoomAirModelUFAD.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1110.8147,-837.492 983.8914,-837.492 983.8914,-815.4811 1110.8147,-815.4811 1110.8147,-837.492"/>
<text text-anchor="middle" x="1047.353" y="-823.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUFAD.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M919.8442,-814.028C937.7201,-815.7746 956.3632,-817.5962 973.6993,-819.29"/>
<polygon fill="#00ff66" stroke="#00ff66" points="973.4468,-822.782 983.7398,-820.2711 974.1275,-815.8151 973.4468,-822.782"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~roomairmodeldisplacementvent.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/roomairmodeldisplacementvent.f90.html" xlink:title="RoomAirModelDisplacementVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1138.9424,-796.492 955.7637,-796.492 955.7637,-774.4811 1138.9424,-774.4811 1138.9424,-796.492"/>
<text text-anchor="middle" x="1047.353" y="-782.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelDisplacementVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M919.8442,-797.3518C928.281,-796.5667 936.8886,-795.7657 945.4491,-794.9691"/>
<polygon fill="#00ff66" stroke="#00ff66" points="945.831,-798.4488 955.4636,-794.0372 945.1823,-791.4789 945.831,-798.4488"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~zonetemppredictorcorrector.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/zonetemppredictorcorrector.f90.html" xlink:title="ZoneTempPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1554.5589,-760.492 1389.9147,-760.492 1389.9147,-738.4811 1554.5589,-738.4811 1554.5589,-760.492"/>
<text text-anchor="middle" x="1472.2368" y="-746.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneTempPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M839.2625,-816.863C855.5373,-842.6805 899.4416,-905.26 955.5586,-928.4865 1082.7681,-981.1378 1129.161,-929.7025 1264.3169,-903.4865"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1264.3169,-903.4865C1350.7427,-888.3161 1426.3339,-806.6323 1457.3046,-768.7734"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1460.3556,-770.563 1463.8755,-760.57 1454.8921,-766.1868 1460.3556,-770.563"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~roomairmodelmundt.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/roomairmodelmundt.f90.html" xlink:title="RoomAirModelMundt.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1111.4888,-755.492 983.2172,-755.492 983.2172,-733.4811 1111.4888,-733.4811 1111.4888,-755.492"/>
<text text-anchor="middle" x="1047.353" y="-741.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelMundt.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M863.8243,-794.4295C888.5685,-785.9248 924.0349,-774.194 955.5586,-765.4865 965.1317,-762.8423 975.3305,-760.2704 985.3191,-757.8855"/>
<polygon fill="#00ff66" stroke="#00ff66" points="986.2697,-761.2576 995.2066,-755.5672 984.6716,-754.4425 986.2697,-761.2576"/>
</g>
<!-- sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~hvacdxsystem.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/hvacdxsystem.f90.html" xlink:title="HVACDXSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="518.7327,-216.492 411.7207,-216.492 411.7207,-194.4811 518.7327,-194.4811 518.7327,-216.492"/>
<text text-anchor="middle" x="465.2267" y="-202.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACDXSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge110" class="edge">
<title>sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M347.3268,-205.4865C365.3829,-205.4865 384.16,-205.4865 401.2808,-205.4865"/>
<polygon fill="#0066ff" stroke="#0066ff" points="401.7056,-208.9866 411.7056,-205.4865 401.7056,-201.9866 401.7056,-208.9866"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node46" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node46"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1737.3911,-568.492 1642.7636,-568.492 1642.7636,-546.4811 1737.3911,-546.4811 1737.3911,-568.492"/>
<text text-anchor="middle" x="1690.0774" y="-554.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge112" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1328.0575,-560.8877C1410.5345,-560.1128 1553.0331,-558.774 1632.4237,-558.0282"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1632.7577,-561.5253 1642.7243,-557.9314 1632.6919,-554.5256 1632.7577,-561.5253"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node47" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node47"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1525.2292,-606.492 1419.2444,-606.492 1419.2444,-584.4811 1525.2292,-584.4811 1525.2292,-606.492"/>
<text text-anchor="middle" x="1472.2368" y="-592.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge113" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1327.8295,-571.8724C1353.5543,-576.079 1383.1938,-580.9258 1408.9007,-585.1295"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1408.4779,-588.6068 1418.9117,-586.7666 1409.6076,-581.6985 1408.4779,-588.6068"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2158.2262,-635.492 2014.5511,-635.492 2014.5511,-613.4811 2158.2262,-613.4811 2158.2262,-635.492"/>
<text text-anchor="middle" x="2086.3887" y="-621.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1945.4953,-603.0302C1963.5017,-605.7724 1984.3644,-608.9495 2004.4266,-612.0047"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2004.096,-615.4947 2014.5089,-613.5401 2005.1499,-608.5744 2004.096,-615.4947"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2829.8072,-683.492 2709.9967,-683.492 2709.9967,-661.4811 2829.8072,-661.4811 2829.8072,-683.492"/>
<text text-anchor="middle" x="2769.902" y="-669.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1912.384,-606.7551C1944.2979,-627.5674 2017.6028,-670.1414 2086.3887,-672.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2086.3887,-672.4865C2176.5508,-675.5605 2199.2192,-669.1322 2289.3713,-672.4865"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2117.8713,-635.5294C2157.3466,-648.5332 2227.3753,-668.8341 2289.3713,-672.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2289.3713,-672.4865C2438.1529,-681.2517 2479.8065,-637.6202 2624.7103,-672.4865"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2090.8927,-635.9366C2103.8049,-667.2603 2144.0481,-755.05 2206.0261,-800.4865 2211.4287,-804.4472 2217.4603,-807.7858 2223.741,-810.5991"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2222.4932,-813.8697 2233.0769,-814.3563 2225.1067,-807.3758 2222.4932,-813.8697"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2955.6229,-663.492 2872.2059,-663.492 2872.2059,-641.4811 2955.6229,-641.4811 2955.6229,-663.492"/>
<text text-anchor="middle" x="2913.9144" y="-649.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2829.7251,-664.1785C2840.3897,-662.6974 2851.4215,-661.1653 2861.8479,-659.7174"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2862.6129,-663.1448 2872.0364,-658.3024 2861.6499,-656.2113 2862.6129,-663.1448"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2962.0355,-704.492 2865.7933,-704.492 2865.7933,-682.4811 2962.0355,-682.4811 2962.0355,-704.492"/>
<text text-anchor="middle" x="2913.9144" y="-690.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2829.7251,-681.21C2838.186,-682.4438 2846.8781,-683.7112 2855.3156,-684.9416"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2855.0481,-688.4395 2865.4485,-686.4192 2856.0582,-681.5128 2855.0481,-688.4395"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2342.9417,-836.5189C2410.7565,-848.0712 2530.1359,-860.2704 2624.7103,-826.4865"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2343.2608,-814.3932C2364.3018,-810.0618 2388.5841,-805.0632 2410.4665,-800.5587"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2411.2425,-803.9724 2420.3314,-798.5279 2409.8311,-797.1162 2411.2425,-803.9724"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2501.425,-798.5155C2538.386,-812.6869 2602.1176,-834.5571 2624.7103,-826.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2624.7103,-826.4865C2690.8167,-802.872 2739.1147,-728.7419 2759.3696,-692.6409"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2762.6171,-693.996 2764.3303,-683.5406 2756.471,-690.6456 2762.6171,-693.996"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2480.4916,-776.1245C2494.895,-751.8463 2531.6208,-694.219 2575.2209,-658.4865 2579.2587,-655.1774 2583.8069,-652.1483 2588.4679,-649.4291"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2590.3165,-652.409 2597.4658,-644.5898 2587.0009,-646.244 2590.3165,-652.409"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2665.9281,-644.558C2682.3976,-648.9819 2701.5352,-654.1225 2718.869,-658.7785"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2718.267,-662.2408 2728.8327,-661.4549 2720.083,-655.4805 2718.267,-662.2408"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1716.1095,-895.5513C1754.5839,-911.0376 1829.2805,-937.8135 1895.9594,-942.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1895.9594,-942.4865C1956.8599,-946.7546 2119.3289,-957.4994 2170.0261,-923.4865 2200.0668,-903.3322 2178.4052,-873.8473 2206.0261,-850.4865 2210.5335,-846.6743 2215.6069,-843.4434 2220.9685,-840.7052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2222.5304,-843.8405 2230.2146,-836.5464 2219.6589,-837.4565 2222.5304,-843.8405"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2769.902,-864.4865C2842.8908,-843.8308 2888.3699,-755.0508 2905.8031,-714.2011"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2909.0541,-715.498 2909.6307,-704.9189 2902.5827,-712.8295 2909.0541,-715.498"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1705.4678,-873.2872C1729.7201,-856.1624 1778.8488,-823.5586 1825.1675,-805.4865 1935.8698,-762.2941 1967.5586,-748.4865 2086.3887,-748.4865 2086.3887,-748.4865 2086.3887,-748.4865 2289.3713,-748.4865 2400.7362,-748.4865 2430.9684,-741.3423 2539.2209,-767.4865 2593.2769,-780.5417 2716.3933,-879.6294 2769.902,-864.4865"/>
</g>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~solarshading.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/solarshading.f90.html" xlink:title="SolarShading.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2132.4495,-992.492 2040.3278,-992.492 2040.3278,-970.4811 2132.4495,-970.4811 2132.4495,-992.492"/>
<text text-anchor="middle" x="2086.3887" y="-978.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarShading.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1705.8053,-895.5601C1730.1134,-912.031 1778.8537,-942.5373 1825.1675,-956.4865 1893.6062,-977.0995 1976.2697,-981.8368 2030.0185,-982.4153"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2030.017,-985.9153 2040.0388,-982.4785 2030.0611,-978.9154 2030.017,-985.9153"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1966.5437,-836.492 1825.375,-836.492 1825.375,-814.4811 1966.5437,-814.4811 1966.5437,-836.492"/>
<text text-anchor="middle" x="1895.9594" y="-822.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1736.6122,-873.3686C1753.2525,-869.2288 1772.1049,-864.3502 1789.1675,-859.4865 1810.4574,-853.4179 1833.9175,-846.0276 1853.4134,-839.6891"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1854.5093,-843.0132 1862.9259,-836.578 1852.3333,-836.36 1854.5093,-843.0132"/>
</g>
<!-- sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~roomairmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/roomairmanager.f90.html" xlink:title="RoomAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1320.039,-817.492 1208.5947,-817.492 1208.5947,-795.4811 1320.039,-795.4811 1320.039,-817.492"/>
<text text-anchor="middle" x="1264.3169" y="-803.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M1109.5163,-897.3794C1119.6115,-894.6953 1129.8102,-891.4301 1139.1475,-887.4865 1178.2227,-870.983 1218.5622,-842.4167 1242.5354,-823.9941"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="1244.8628,-826.6175 1250.5945,-817.7068 1240.5571,-821.0983 1244.8628,-826.6175"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1763.4012,-738.4122C1772.6447,-734.9439 1781.5245,-730.4097 1789.1675,-724.4865 1815.5781,-704.019 1804.3801,-684.6462 1825.1675,-658.4865 1838.943,-641.1508 1857.8002,-624.6303 1872.5886,-612.8593"/>
<polygon fill="#aaff00" stroke="#aaff00" points="1875.0112,-615.4091 1880.7565,-606.5072 1870.7139,-609.8834 1875.0112,-615.4091"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1732.2804,-738.4477C1773.6308,-728.3574 1838.6155,-714.4244 1895.9594,-710.4865"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1099.0063,-856.4738C1112.1524,-853.451 1126.2173,-850.0248 1139.1475,-846.4865 1167.2869,-838.7863 1198.5473,-828.7977 1222.7887,-820.7285"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1224.0127,-824.0097 1232.3823,-817.5136 1221.7884,-817.3725 1224.0127,-824.0097"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1690.0774,-942.4865C1781.4893,-946.5697 1804.578,-937.7673 1895.9594,-942.4865"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1514.8461,-914.5705C1558.4884,-925.1037 1628.4733,-939.7348 1690.0774,-942.4865"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1527.4888,-898.6675C1555.1139,-896.258 1588.8795,-893.313 1618.4672,-890.7324"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="1619.0835,-894.192 1628.7415,-889.8362 1618.4752,-887.2184 1619.0835,-894.192"/>
</g>
<!-- sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1110.9834,-820.621C1138.4899,-818.0854 1170.6659,-815.1194 1198.4209,-812.5609"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1198.7931,-816.0415 1208.4295,-811.6383 1198.1505,-809.0711 1198.7931,-816.0415"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1139.0508,-794.362C1158.9575,-796.2888 1179.6371,-798.2903 1198.32,-800.0987"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1198.1856,-803.6019 1208.4763,-801.0817 1198.8601,-796.6345 1198.1856,-803.6019"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1481.156,-738.4488C1498.4065,-716.4833 1536.2851,-665.1242 1554.9873,-615.4865 1588.8381,-525.6427 1524.5185,-471.7662 1590.9873,-402.4865 1596.1349,-397.1213 1602.2851,-392.9555 1608.9663,-389.7392"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="1610.417,-392.9277 1618.3619,-385.9186 1607.7801,-386.4433 1610.417,-392.9277"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1690.0774,-710.4865C1734.2511,-700.3879 1748.802,-707.0761 1789.1675,-686.4865 1798.9434,-681.5001 1847.8759,-638.4395 1875.9921,-613.3803"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="1878.5248,-615.811 1883.6522,-606.5395 1873.8621,-610.59 1878.5248,-615.811"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1537.8441,-738.4485C1591.0903,-729.3583 1661.7992,-716.9513 1690.0774,-710.4865"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1690.0774,-710.4865C1779.2792,-690.0939 1804.6713,-716.7555 1895.9594,-710.4865"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1554.593,-749.4865C1563.0797,-749.4865 1571.7956,-749.4865 1580.5169,-749.4865"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="1580.7441,-752.9866 1590.7441,-749.4865 1580.744,-745.9866 1580.7441,-752.9866"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1099.5055,-755.5453C1112.5126,-758.5425 1126.3877,-761.9452 1139.1475,-765.4865 1167.6153,-773.3873 1199.23,-783.7563 1223.5643,-792.0897"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1222.5859,-795.4545 1233.1806,-795.4065 1224.8684,-788.8371 1222.5859,-795.4545"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2289.3713,-864.4865C2428.6325,-811.3912 2481.984,-907.4049 2624.7103,-864.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2624.7103,-864.4865C2648.1433,-857.5248 2656.3511,-857.1898 2674.1997,-840.4865 2719.9547,-797.6676 2749.8709,-727.957 2762.7166,-693.3474"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2766.0588,-694.3965 2766.1537,-683.802 2759.4727,-692.0249 2766.0588,-694.3965"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2132.5891,-975.8826C2146.0646,-972.2406 2159.8775,-966.2669 2170.0261,-956.4865 2205.8513,-921.961 2170.2175,-885.0293 2206.0261,-850.4865 2209.7363,-846.9075 2213.9384,-843.8384 2218.4352,-841.2069"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2220.0565,-844.3091 2227.3944,-836.6667 2216.8922,-838.0651 2220.0565,-844.3091"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2132.7067,-970.919C2145.1824,-967.2027 2158.4272,-962.4309 2170.0261,-956.4865 2229.6279,-925.9411 2226.7924,-888.3457 2289.3713,-864.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2289.3713,-864.4865C2324.8713,-850.9516 2337.3248,-859.302 2372.7166,-845.4865 2400.3735,-834.6904 2429.548,-817.2469 2449.4385,-804.3052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2451.4771,-807.1531 2457.8852,-798.7159 2447.6143,-801.3155 2451.4771,-807.1531"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2624.7103,-864.4865C2686.5678,-846.1092 2707.8109,-882.0582 2769.902,-864.4865"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1944.336,-836.5076C1962.5445,-840.1371 1983.4998,-843.6994 2002.7512,-845.4865 2076.7773,-852.3586 2095.9378,-851.6514 2170.0261,-845.4865 2187.965,-843.9938 2207.2652,-841.2598 2225.0059,-838.2827"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2225.9927,-841.664 2235.249,-836.5093 2224.7985,-834.7666 2225.9927,-841.664"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1933.1064,-814.4069C1971.178,-803.8772 2032.2954,-789.2489 2086.3887,-786.4865"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1907.0413,-836.603C1925.9558,-855.3556 1965.9968,-894.1029 2002.7512,-923.4865 2021.2671,-938.2892 2043.3456,-953.5056 2060.1678,-964.6369"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2058.6346,-967.8168 2068.9167,-970.3721 2062.4723,-961.9625 2058.6346,-967.8168"/>
</g>
<!-- sourcefile~windowmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~windowmanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/windowmanager.f90.html" xlink:title="WindowManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2140.1144,-836.492 2032.663,-836.492 2032.663,-814.4811 2140.1144,-814.4811 2140.1144,-836.492"/>
<text text-anchor="middle" x="2086.3887" y="-822.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1966.5976,-825.4865C1984.9101,-825.4865 2004.5247,-825.4865 2022.4703,-825.4865"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2022.5342,-828.9866 2032.5342,-825.4865 2022.5342,-821.9866 2022.5342,-828.9866"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~heatbalanceintradexchange.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/heatbalanceintradexchange.f90.html" xlink:title="HeatBalanceIntRadExchange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2170.1638,-914.492 2002.6135,-914.492 2002.6135,-892.4811 2170.1638,-892.4811 2170.1638,-914.492"/>
<text text-anchor="middle" x="2086.3887" y="-900.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceIntRadExchange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1915.9635,-836.7015C1937.0784,-848.2305 1971.5576,-866.1875 2002.7512,-878.4865 2012.898,-882.4872 2023.9498,-886.2143 2034.5959,-889.5055"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2033.6368,-892.8718 2044.2212,-892.4007 2035.6532,-886.1685 2033.6368,-892.8718"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2140.2514,-825.4865C2157.3753,-825.4865 2176.8386,-825.4865 2195.9205,-825.4865"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2196.1562,-828.9866 2206.1562,-825.4865 2196.1561,-821.9866 2196.1562,-828.9866"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2125.657,-814.4384C2166.2515,-803.8485 2231.6561,-789.0958 2289.3713,-786.4865"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2134.4692,-892.4267C2146.4276,-888.7887 2158.9789,-884.1783 2170.0261,-878.4865 2188.0449,-869.2029 2188.0118,-859.7788 2206.0261,-850.4865 2214.1109,-846.3162 2223.0038,-842.7245 2231.8774,-839.67"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2233.0257,-842.9771 2241.4594,-836.5644 2230.8674,-836.3181 2233.0257,-842.9771"/>
</g>
<!-- sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1304.8995,-795.361C1338.3871,-786.1806 1386.0622,-773.1108 1421.9641,-763.2685"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1423.0378,-766.6034 1431.7565,-760.584 1421.187,-759.8525 1423.0378,-766.6034"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node30"><a xlink:href="../sourcefile/hvacunitarysystem.f90.html" xlink:title="HVACUnitarySystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="709.3793,-216.492 583.0245,-216.492 583.0245,-194.4811 709.3793,-194.4811 709.3793,-216.492"/>
<text text-anchor="middle" x="646.2019" y="-202.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitarySystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge106" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M519.0352,-205.4865C535.9238,-205.4865 554.8643,-205.4865 572.8648,-205.4865"/>
<polygon fill="#ff0000" stroke="#ff0000" points="573.0396,-208.9866 583.0396,-205.4865 573.0395,-201.9866 573.0396,-208.9866"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node31" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node31"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1752.791,-118.492 1627.3638,-118.492 1627.3638,-96.4811 1752.791,-96.4811 1752.791,-118.492"/>
<text text-anchor="middle" x="1690.0774" y="-104.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge107" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1047.353,-52.4865C1269.4243,-11.3636 1336.8371,28.9704 1554.9873,-29.4865 1598.7453,-41.2122 1642.997,-70.9175 1668.414,-90.0993"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1666.5299,-93.0661 1676.5871,-96.3985 1670.8031,-87.5217 1666.5299,-93.0661"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M495.5612,-194.3924C546.5978,-176.0078 653.1065,-138.8422 745.2905,-114.4865 877.7927,-79.4786 912.4316,-76.54 1047.353,-52.4865"/>
</g>
<!-- sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node32" class="node">
<title>sourcefile~outdoorairunit.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node32"><a xlink:href="../sourcefile/outdoorairunit.f90.html" xlink:title="OutdoorAirUnit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="881.8828,-216.492 782.9663,-216.492 782.9663,-194.4811 881.8828,-194.4811 881.8828,-216.492"/>
<text text-anchor="middle" x="832.4246" y="-202.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutdoorAirUnit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge108" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M499.4577,-216.5125C535.5101,-227.303 594.1577,-242.5378 646.2019,-245.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M646.2019,-245.4865C659.2402,-246.2252 727.0955,-230.8215 777.1518,-218.9159"/>
<polygon fill="#ff0000" stroke="#ff0000" points="777.9906,-222.3141 786.9043,-216.5873 776.3648,-215.5055 777.9906,-222.3141"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node33" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node33"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="867.2057,-257.492 797.6435,-257.492 797.6435,-235.4811 867.2057,-235.4811 867.2057,-257.492"/>
<text text-anchor="middle" x="832.4246" y="-243.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge109" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M646.2019,-245.4865C694.2951,-248.2114 749.486,-248.1032 787.2225,-247.5367"/>
<polygon fill="#ff0000" stroke="#ff0000" points="787.4428,-251.0336 797.3829,-247.3667 787.3257,-244.0346 787.4428,-251.0336"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M832.4246,-128.4865C967.5126,-95.4105 1006.1417,-149.8386 1139.1475,-190.4865 1196.7577,-208.0928 1204.0785,-242.9887 1264.3169,-242.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1264.3169,-242.4865C1270.1983,-242.4965 1466.7905,-200.2663 1472.2368,-202.4865"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M666.9953,-194.4146C700.6768,-177.0562 769.7291,-143.8374 832.4246,-128.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M832.4246,-128.4865C930.8375,-104.3903 947.7269,-70.9352 1047.353,-52.4865"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M709.5083,-205.4865C729.9842,-205.4865 752.6098,-205.4865 772.8089,-205.4865"/>
<polygon fill="#ff0000" stroke="#ff0000" points="772.817,-208.9866 782.817,-205.4865 772.8169,-201.9866 772.817,-208.9866"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M696.5964,-216.5817C724.9641,-222.8273 760.0854,-230.5599 787.5074,-236.5973"/>
<polygon fill="#ff0000" stroke="#ff0000" points="787.0913,-240.0894 797.61,-238.8215 788.5965,-233.2531 787.0913,-240.0894"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1706.7456,-118.6465C1729.2317,-134.6432 1768.8066,-166.2997 1789.1675,-203.4865 1827.721,-273.9001 1804.5787,-302.8943 1825.1675,-380.4865 1844.4217,-453.0494 1874.362,-537.0427 1888.3171,-574.9975"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1885.0556,-576.2691 1891.8071,-584.4341 1891.621,-573.8409 1885.0556,-576.2691"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1748.6504,-118.5482C1762.2745,-122.1286 1776.4932,-126.7123 1789.1675,-132.4865 2035.6182,-244.7667 2020.6753,-446.6162 2289.3713,-480.4865"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2289.3713,-480.4865C2400.2056,-493.1507 2451.5504,-435.5048 2539.2209,-504.4865 2577.6614,-534.7326 2543.0369,-571.6533 2575.2209,-608.4865 2578.0355,-611.7076 2581.3641,-614.5638 2584.9435,-617.0846"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2583.2652,-620.1604 2593.6267,-622.3719 2586.9058,-614.1816 2583.2652,-620.1604"/>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1047.353,-242.4865C1143.6683,-247.1551 1167.8919,-243.2904 1264.3169,-242.4865"/>
</g>
<!-- sourcefile~generalroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node34" class="node">
<title>sourcefile~generalroutines.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node34"><a xlink:href="../sourcefile/generalroutines.f90.html" xlink:title="GeneralRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1744.3877,-234.492 1635.7671,-234.492 1635.7671,-212.4811 1744.3877,-212.4811 1744.3877,-234.492"/>
<text text-anchor="middle" x="1690.0774" y="-220.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GeneralRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M876.5224,-216.5088C919.7197,-226.4893 987.5814,-240.0007 1047.353,-242.4865"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1047.353,-242.4865C1124.2573,-245.6849 1312.7512,-194.505 1389.4863,-188.4865 1462.8171,-182.7351 1482.0214,-179.1878 1554.9873,-188.4865 1586.527,-192.5059 1621.2309,-201.6021 1647.5664,-209.5138"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1646.6393,-212.8903 1657.226,-212.475 1648.691,-206.1977 1646.6393,-212.8903"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge98" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1895.9594,-710.4865C1982.0605,-704.5738 2000.1349,-669.5458 2086.3887,-672.4865"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M838.5884,-257.5093C855.0295,-286.3107 902.3179,-365.331 955.5586,-419.4865 1040.5828,-505.9717 1063.7435,-533.5496 1175.1475,-581.4865 1193.8318,-589.5264 1875.6665,-711.8801 1895.9594,-710.4865"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge102" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1047.353,-204.4865C1107.6778,-187.9191 1114.5059,-160.8543 1175.1475,-145.4865 1303.4026,-112.9841 1340.0595,-132.3991 1472.2368,-126.4865"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1472.2368,-126.4865C1520.3831,-121.5514 1574.6011,-116.8196 1616.9029,-113.3125"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1617.435,-116.7806 1627.1135,-112.4705 1616.8596,-109.8043 1617.435,-116.7806"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M867.527,-240.1708C910.1703,-232.373 984.2404,-218.4257 1047.353,-204.4865"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node35" class="node">
<title>sourcefile~hvacstandaloneerv.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node35"><a xlink:href="../sourcefile/hvacstandaloneerv.f90.html" xlink:title="HVACStandAloneERV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1538.3847,-490.492 1406.0889,-490.492 1406.0889,-468.4811 1538.3847,-468.4811 1538.3847,-490.492"/>
<text text-anchor="middle" x="1472.2368" y="-476.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACStandAloneERV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge96" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1047.353,-360.4865C1086.9388,-373.4756 1106.5865,-353.4955 1139.1475,-379.4865 1169.3032,-403.5577 1143.4529,-436.4809 1175.1475,-458.4865 1244.5923,-506.7023 1346.5182,-501.8951 1411.1073,-492.1267"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1411.8195,-495.5574 1421.1422,-490.5237 1410.7153,-488.645 1411.8195,-495.5574"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node36" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node36"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1318.4963,-60.492 1210.1375,-60.492 1210.1375,-38.4811 1318.4963,-38.4811 1318.4963,-60.492"/>
<text text-anchor="middle" x="1264.3169" y="-46.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge97" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M867.4932,-242.4112C884.0452,-239.4191 903.6157,-234.2772 919.5586,-225.4865 939.1002,-214.7116 937.5095,-203.6093 955.5586,-190.4865 1044.8324,-125.5792 1072.6322,-115.3936 1175.1475,-74.4865 1185.6576,-70.2926 1197.1287,-66.5151 1208.2379,-63.242"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1209.2152,-66.603 1217.8742,-60.4978 1207.2979,-59.8706 1209.2152,-66.603"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node37" class="node">
<title>sourcefile~packagedterminalheatpump.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node37"><a xlink:href="../sourcefile/packagedterminalheatpump.f90.html" xlink:title="PackagedTerminalHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1554.7385,-371.492 1389.7351,-371.492 1389.7351,-349.4811 1554.7385,-349.4811 1554.7385,-371.492"/>
<text text-anchor="middle" x="1472.2368" y="-357.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedTerminalHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge99" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1047.353,-360.4865C1106.7984,-379.5838 1273.4241,-373.4235 1379.4811,-367.0595"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1379.7823,-370.5477 1389.55,-366.4438 1379.355,-363.5607 1379.7823,-370.5477"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node38" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node38"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1353.6561,-449.492 1174.9777,-449.492 1174.9777,-427.4811 1353.6561,-427.4811 1353.6561,-449.492"/>
<text text-anchor="middle" x="1264.3169" y="-435.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge100" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1047.353,-360.4865C1087.0187,-373.2294 1099.6302,-366.2905 1139.1475,-379.4865 1173.4971,-390.9569 1210.7939,-409.3759 1235.6571,-422.5832"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1234.0805,-425.7094 1244.5453,-427.3645 1237.3967,-419.5447 1234.0805,-425.7094"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node39" class="node">
<title>sourcefile~hvacvariablerefrigerantflow.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node39"><a xlink:href="../sourcefile/hvacvariablerefrigerantflow.f90.html" xlink:title="HVACVariableRefrigerantFlow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1132.0507,-410.492 962.6554,-410.492 962.6554,-388.4811 1132.0507,-388.4811 1132.0507,-410.492"/>
<text text-anchor="middle" x="1047.353" y="-396.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACVariableRefrigerantFlow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge101" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M839.9087,-257.6656C857.1973,-282.5977 902.5157,-343.0264 955.5586,-374.4865 962.7061,-378.7258 970.5898,-382.2643 978.6441,-385.2139"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="977.5497,-388.5384 988.1438,-388.4126 979.7835,-381.9044 977.5497,-388.5384"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node40" class="node">
<title>sourcefile~hvacunitarybypassvav.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node40"><a xlink:href="../sourcefile/hvacunitarybypassvav.f90.html" xlink:title="HVACUnitaryBypassVAV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1336.418,-176.492 1192.2158,-176.492 1192.2158,-154.4811 1336.418,-154.4811 1336.418,-176.492"/>
<text text-anchor="middle" x="1264.3169" y="-162.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitaryBypassVAV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge103" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1047.353,-204.4865C1091.3336,-192.4078 1141.3848,-183.1232 1182.3235,-176.6488"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1182.9121,-180.0994 1192.2557,-175.1047 1181.8366,-173.1825 1182.9121,-180.0994"/>
</g>
<!-- sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node41" class="node">
<title>sourcefile~fancoilunits.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node41"><a xlink:href="../sourcefile/fancoilunits.f90.html" xlink:title="FanCoilUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1516.8546,-252.492 1427.6191,-252.492 1427.6191,-230.4811 1516.8546,-230.4811 1516.8546,-252.492"/>
<text text-anchor="middle" x="1472.2368" y="-238.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FanCoilUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge104" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1047.353,-360.4865C1105.8947,-379.2934 1117.0418,-327.5999 1175.1475,-307.4865 1214.0421,-294.023 1224.1653,-291.5368 1264.3169,-282.4865"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M848.5233,-257.6277C883.1318,-280.974 967.9309,-334.9716 1047.353,-360.4865"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1264.3169,-282.4865C1316.0432,-270.8272 1375.4243,-259.3015 1417.4484,-251.4541"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1418.2836,-254.8589 1427.4754,-249.59 1417.0041,-247.9768 1418.2836,-254.8589"/>
</g>
<!-- sourcefile~windowac.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node42" class="node">
<title>sourcefile~windowac.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node42"><a xlink:href="../sourcefile/windowac.f90.html" xlink:title="WindowAC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1513.1826,-293.492 1431.291,-293.492 1431.291,-271.4811 1513.1826,-271.4811 1513.1826,-293.492"/>
<text text-anchor="middle" x="1472.2368" y="-279.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowAC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge105" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1264.3169,-282.4865C1316.8552,-270.6442 1378.7768,-272.6054 1421.2992,-276.303"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1421.1236,-279.8018 1431.4056,-277.2463 1421.7742,-272.832 1421.1236,-279.8018"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1536.762,-468.3189C1543.2376,-465.7002 1549.4541,-462.4702 1554.9873,-458.4865 1578.9996,-441.1988 1566.6367,-419.2944 1590.9873,-402.4865 1596.3534,-398.7826 1602.2437,-395.7111 1608.3939,-393.1665"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1610.0336,-396.2944 1618.2344,-389.5863 1607.6403,-389.7163 1610.0336,-396.2944"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1538.8161,-489.7596C1582.1148,-496.845 1639.6876,-507.0285 1690.0774,-518.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1690.0774,-518.4865C1733.8035,-528.4293 1749.1005,-517.3503 1789.1675,-537.4865 1808.5612,-547.2331 1806.5588,-559.3139 1825.1675,-570.4865 1831.6209,-574.3611 1838.7652,-577.7598 1845.9603,-580.7002"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1845.1524,-584.1377 1855.7433,-584.4273 1847.6446,-577.5964 1845.1524,-584.1377"/>
</g>
<!-- sourcefile~systemreports.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node43" class="node">
<title>sourcefile~systemreports.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node43"><a xlink:href="../sourcefile/systemreports.f90.html" xlink:title="SystemReports.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1740.8637,-433.492 1639.2911,-433.492 1639.2911,-411.4811 1740.8637,-411.4811 1740.8637,-433.492"/>
<text text-anchor="middle" x="1690.0774" y="-419.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemReports.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1516.0664,-468.4672C1528.6413,-465.2776 1542.3642,-461.7701 1554.9873,-458.4865 1582.8789,-451.2313 1613.959,-442.9617 1639.2695,-436.1794"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1640.2713,-439.5345 1649.023,-433.563 1638.4576,-432.7735 1640.2713,-439.5345"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1472.2368,-88.4865C1490.6642,-91.843 1772.8449,-194.2992 1789.1675,-203.4865 1936.8842,-286.6304 1916.8802,-442.4865 2086.3887,-442.4865 2086.3887,-442.4865 2086.3887,-442.4865 2289.3713,-442.4865 2400.9267,-442.4865 2451.5504,-397.5048 2539.2209,-466.4865 2577.6614,-496.7326 2541.9837,-534.6009 2575.2209,-570.4865 2607.8122,-605.6748 2631.6826,-591.2896 2674.1997,-613.4865 2687.7778,-620.5753 2720.6786,-641.1484 2744.1056,-656.0074"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2742.2436,-658.971 2752.5604,-661.3824 2745.9991,-653.0637 2742.2436,-658.971"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1318.5731,-59.8246C1360.5113,-67.7766 1420.0258,-78.9764 1472.2368,-88.4865"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1472.2368,-88.4865C1520.1255,-97.2094 1574.691,-101.9607 1617.2315,-104.5307"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1617.0361,-108.0251 1627.2213,-105.1076 1617.4398,-101.0368 1617.0361,-108.0251"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node44" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node44"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1520.6684,-60.492 1423.8052,-60.492 1423.8052,-38.4811 1520.6684,-38.4811 1520.6684,-60.492"/>
<text text-anchor="middle" x="1472.2368" y="-46.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1318.6738,-49.4865C1347.842,-49.4865 1383.8147,-49.4865 1413.6096,-49.4865"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="1413.8695,-52.9866 1423.8695,-49.4865 1413.8695,-45.9866 1413.8695,-52.9866"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1554.9036,-368.4557C1572.3101,-370.1337 1590.6677,-371.9034 1608.0505,-373.5791"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1607.8684,-377.0776 1618.1581,-374.5534 1608.5401,-370.11 1607.8684,-377.0776"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1501.2013,-371.6131C1525.0529,-380.5016 1559.8826,-392.8565 1590.9873,-401.4865 1603.2884,-404.8995 1616.5811,-408.0654 1629.3138,-410.8501"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1628.865,-414.3331 1639.3755,-412.999 1630.3271,-407.4875 1628.865,-414.3331"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1281.6961,-449.6972C1305.1119,-464.143 1348.5852,-488.6805 1389.4863,-499.4865 1518.9083,-533.6796 1559.5468,-488.8055 1690.0774,-518.4865"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node45" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_node45"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1549.5431,-449.492 1394.9305,-449.492 1394.9305,-427.4811 1549.5431,-427.4811 1549.5431,-449.492"/>
<text text-anchor="middle" x="1472.2368" y="-435.3365" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1353.7003,-438.4865C1363.9364,-438.4865 1374.3648,-438.4865 1384.578,-438.4865"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="1384.7043,-441.9866 1394.7043,-438.4865 1384.7042,-434.9866 1384.7043,-441.9866"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1095.7392,-388.4529C1161.7141,-374.0275 1283.789,-349.5334 1389.4863,-340.4865 1462.7744,-334.2137 1482.2282,-329.6885 1554.9873,-340.4865 1588.846,-345.5114 1625.9668,-357.2559 1652.7137,-366.8929"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1651.8348,-370.2988 1662.4284,-370.4648 1654.2505,-363.7288 1651.8348,-370.2988"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1062.2658,-410.6214C1099.4245,-438.3666 1196.355,-510.7416 1241.0833,-544.1387"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1239.1929,-547.0952 1249.2997,-550.2737 1243.3809,-541.4863 1239.1929,-547.0952"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1304.5602,-154.4521C1346.158,-143.8731 1413.1659,-129.1289 1472.2368,-126.4865"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1517.0407,-248.7804C1529.7626,-251.9194 1543.3193,-256.3326 1554.9873,-262.4865 1604.3799,-288.5372 1650.6284,-336.1878 1674.0637,-362.6002"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1671.6347,-365.1401 1680.8459,-370.3751 1676.9098,-360.5386 1671.6347,-365.1401"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1517.1094,-237.7787C1548.3969,-235.1935 1590.6198,-231.7046 1625.5162,-228.8212"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1625.9407,-232.2981 1635.6185,-227.9864 1625.3642,-225.3219 1625.9407,-232.2981"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1516.985,-244.0802C1530.7431,-246.9875 1544.9013,-252.4498 1554.9873,-262.4865 1600.2224,-307.5007 1544.8678,-357.3788 1590.9873,-401.4865 1601.3161,-411.3648 1615.074,-417.0875 1629.0425,-420.2975"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1628.7295,-423.8001 1639.205,-422.2143 1630.027,-416.9214 1628.7295,-423.8001"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge95" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1513.2357,-293.0441C1526.7438,-297.0031 1541.7019,-301.9123 1554.9873,-307.4865 1594.4713,-324.053 1637.4124,-348.8457 1664.0392,-365.093"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1662.3947,-368.1908 1672.7446,-370.456 1666.0663,-362.231 1662.3947,-368.1908"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge94" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1492.7942,-293.5277C1510.7648,-303.911 1536.7633,-320.7791 1554.9873,-340.4865 1576.3604,-363.5994 1565.4255,-383.1124 1590.9873,-401.4865 1602.2477,-409.5806 1615.9735,-414.6807 1629.5772,-417.8634"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1628.9286,-421.303 1639.4243,-419.8574 1630.3179,-414.4423 1628.9286,-421.303"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1730.1989,-433.5852C1749.7479,-440.5537 1772.5586,-451.1784 1789.1675,-466.4865 1813.7367,-489.1316 1804.3801,-506.3268 1825.1675,-532.4865 1838.943,-549.8222 1857.8002,-566.3427 1872.5886,-578.1138"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1870.7139,-581.0897 1880.7565,-584.4658 1875.0112,-575.5639 1870.7139,-581.0897"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2624.7103,-672.4865C2648.7731,-678.5421 2675.7981,-679.9406 2699.9495,-679.3683"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2700.2367,-682.8604 2710.1071,-679.0102 2699.9899,-675.8648 2700.2367,-682.8604"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1719.5489,-433.5338C1739.7205,-441.5807 1766.7647,-453.3395 1789.1675,-466.4865 1806.4166,-476.6092 1806.517,-486.2643 1825.1675,-493.4865 1933.9266,-535.6023 1969.7599,-518.4865 2086.3887,-518.4865 2086.3887,-518.4865 2086.3887,-518.4865 2289.3713,-518.4865 2453.3757,-518.4865 2465.6649,-632.4617 2624.7103,-672.4865"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1741.0311,-418.6912C1816.4439,-413.4102 1962.2415,-404.4865 2086.3887,-404.4865 2086.3887,-404.4865 2086.3887,-404.4865 2289.3713,-404.4865 2400.9267,-404.4865 2443.4734,-371.2413 2539.2209,-428.4865 2597.9373,-463.5917 2558.7401,-538.3779 2624.7103,-556.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2624.7103,-556.4865C2721.9464,-582.1427 2740.0648,-606.7069 2829.6042,-652.4865 2845.9011,-660.8187 2849.1919,-664.3842 2865.6042,-672.4865 2869.479,-674.3994 2873.5691,-676.3215 2877.6632,-678.1843"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2876.5641,-681.526 2887.1235,-682.391 2879.4082,-675.1298 2876.5641,-681.526"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1513.7237,-60.5324C1549.1928,-69.976 1600.3906,-83.6075 1638.4939,-93.7524"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1637.8106,-97.1924 1648.3745,-96.3831 1639.6117,-90.428 1637.8106,-97.1924"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1508.9068,-427.4351C1523.2796,-423.0964 1539.9098,-418.0676 1554.9873,-413.4865 1570.995,-408.6229 1574.7884,-406.6693 1590.9873,-402.4865 1601.5466,-399.76 1612.8049,-397.1221 1623.804,-394.6899"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1624.7758,-398.0605 1633.8048,-392.5174 1623.2898,-391.22 1624.7758,-398.0605"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1690.0774,-480.4865C1733.1977,-494.4129 1753.2191,-476.9 1789.1675,-504.4865 1815.6752,-524.8283 1799.7296,-548.8218 1825.1675,-570.4865 1829.6173,-574.2763 1834.6805,-577.5055 1840.0055,-580.2543"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1838.6027,-583.4614 1849.1522,-584.4406 1841.516,-577.0964 1838.6027,-583.4614"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1549.7567,-448.7224C1591.8873,-455.454 1644.5374,-465.7786 1690.0774,-480.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1690.0774,-480.4865C1733.1977,-494.4129 1748.3521,-484.8039 1789.1675,-504.4865 1807.4252,-513.2911 1807.1691,-523.1633 1825.1675,-532.4865 1883.5622,-562.7353 1904.7911,-553.4439 1966.7512,-575.4865 1995.9311,-585.8674 2028.4135,-599.2938 2052.1602,-609.4664"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2050.8779,-612.725 2061.4466,-613.4694 2053.6489,-606.2967 2050.8779,-612.725"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1497.1662,-427.4302C1516.008,-417.763 1540.9489,-401.9109 1554.9873,-380.4865 1598.9851,-313.3402 1552.4338,-273.9001 1590.9873,-203.4865 1609.0417,-170.5123 1642.2035,-141.8863 1665.1623,-124.671"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1667.399,-127.3716 1673.4092,-118.6465 1663.2697,-121.7192 1667.399,-127.3716"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1538.4802,-449.5791C1544.4098,-452.2204 1550.0339,-455.4761 1554.9873,-459.4865 1583.1028,-482.2497 1562.856,-509.7429 1590.9873,-532.4865 1602.814,-542.0482 1617.8303,-548.0095 1632.5742,-551.7096"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1632.1782,-555.2057 1642.6955,-553.9264 1633.6759,-548.3678 1632.1782,-555.2057"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1737.3109,-566.2045C1766.77,-571.6418 1804.9393,-578.6868 1836.4562,-584.5039"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1835.9665,-587.9726 1846.4357,-586.3459 1837.2371,-581.0889 1835.9665,-587.9726"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1895.9594,-672.4865C1979.9963,-682.5324 2001.8026,-669.6027 2086.3887,-672.4865"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1708.1749,-568.6472C1754.4682,-597.0439 1875.0236,-669.9838 1895.9594,-672.4865"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1895.9594,-672.4865C1951.8299,-679.1653 1949.3751,-622.2942 2002.7512,-604.4865 2265.7489,-516.7435 2354.9853,-492.3382 2624.7103,-556.4865"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~plantwaterthermaltank.f90~~AfferentGraph_edge111" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1525.2481,-586.2393C1557.7761,-580.5651 1599.4312,-573.2988 1632.7275,-567.4906"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1633.5233,-570.9047 1642.7731,-565.7383 1632.3203,-564.0089 1633.5233,-570.9047"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileplantwaterthermaltankf90AfferentGraph = svgPanZoom('#sourcefileplantwaterthermaltankf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/waterthermaltanks.html">WaterThermalTanks</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html#src">PlantWaterThermalTank.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">WaterThermalTanks</span>
<a name="ln-2"></a>
<a name="ln-3"></a>        <span class="c">! MODULE INFORMATION:</span>
<a name="ln-4"></a>        <span class="c">!       AUTHOR         Brandon Anderson</span>
<a name="ln-5"></a>        <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-6"></a>        <span class="c">!       MODIFIED       Feb 2005, PGE; July 2005, FSEC - added HPWH&#39;s and desuperheater water heating coils</span>
<a name="ln-7"></a>        <span class="c">!                      Jan 2007, PGE - added stratified water heater</span>
<a name="ln-8"></a>        <span class="c">!                      Oct 2007, BTG - extended for indirect water heater</span>
<a name="ln-9"></a>        <span class="c">!                      May 2008, Stovall - added desup from condenser and removed double counting</span>
<a name="ln-10"></a>        <span class="c">!                           (includes &quot;d0&quot;s from revision 145)</span>
<a name="ln-11"></a>        <span class="c">!                       Nov 2011, BAN; corrected use and source outlet temp. calculation of stratified tank</span>
<a name="ln-12"></a>        <span class="c">!       RE-ENGINEERED  Feb 2004, PGE</span>
<a name="ln-13"></a>        <span class="c">!                      Sep 2008, BTG - refactored, was PlantWaterHeater.f90 is now PlantWaterThermalTank.f90</span>
<a name="ln-14"></a>        <span class="c">!                                 reuse water heater code for chilled water storage</span>
<a name="ln-15"></a>
<a name="ln-16"></a>        <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-17"></a>        <span class="c">! This module simulates water thermal storage tanks heaters in the plant loop.  Tanks can</span>
<a name="ln-18"></a>        <span class="c">! be positioned as supply side equipment or demand side equipment.  Water heater versions can be stand-alone as</span>
<a name="ln-19"></a>        <span class="c">! non-zone equipment.</span>
<a name="ln-20"></a>
<a name="ln-21"></a>        <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-22"></a>        <span class="c">! Two water thermal tank models are implemented, MIXED and STRATIFIED with hot and cold versions of each:</span>
<a name="ln-23"></a>        <span class="c">!</span>
<a name="ln-24"></a>        <span class="c">! WaterHeater:Mixed simulates a well-mixed, single-node tank for hot water applications.  Source (e.g. heat recovery) and</span>
<a name="ln-25"></a>        <span class="c">! use plant connections are allowed.  A scheduled domestic hot water demand can also be specified</span>
<a name="ln-26"></a>        <span class="c">! to directly utilize the hot water without use side connections.</span>
<a name="ln-27"></a>        <span class="c">!</span>
<a name="ln-28"></a>        <span class="c">! WaterHeater:Stratified simulates a stratified, multi-node tank for hot water applicatons.</span>
<a name="ln-29"></a>        <span class="c">! The model shares most of the same capabilities as WaterHeater:Mixed</span>
<a name="ln-30"></a>        <span class="c">! but also has up to two heating elements which can be operated in</span>
<a name="ln-31"></a>        <span class="c">! a master-slave mode or simultaneous mode.</span>
<a name="ln-32"></a>
<a name="ln-33"></a>        <span class="c">! ThermalStorage:ChilledWater:Mixed simulates a well-mixed, single-node tank for chilled water applications</span>
<a name="ln-34"></a>
<a name="ln-35"></a>        <span class="c">! ThermalStorage:ChilledWater:Stratified simulates a stratified, multi-node tank for chilled water applications.</span>
<a name="ln-36"></a>
<a name="ln-37"></a>        <span class="c">! USE STATEMENTS:</span>
<a name="ln-38"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-39"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">OutputFileInits</span>
<a name="ln-40"></a><span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">NumRefrigeratedRacks</span><span class="p">,</span> <span class="n">HeatReclaimRefrigeratedRack</span><span class="p">,</span> <span class="n">HeatReclaimRefrigCondenser</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-41"></a>                           <span class="n">HeatReclaimDXCoil</span><span class="p">,</span> <span class="n">NumRefrigCondensers</span>
<a name="ln-42"></a><span class="k">USE </span><span class="n">DataPlant</span>
<a name="ln-43"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-44"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-45"></a><span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-46"></a>
<a name="ln-47"></a><span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-48"></a>
<a name="ln-49"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-50"></a>
<a name="ln-51"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-52"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cMixedWHModuleObj</span>          <span class="o">=</span> <span class="s1">&#39;WaterHeater:Mixed&#39;</span>
<a name="ln-53"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cStratifiedWHModuleObj</span>     <span class="o">=</span> <span class="s1">&#39;WaterHeater:Stratified&#39;</span>
<a name="ln-54"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cMixedCWTankModuleObj</span>      <span class="o">=</span> <span class="s1">&#39;ThermalStorage:ChilledWater:Mixed&#39;</span>
<a name="ln-55"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">cStratifiedCWTankModuleObj</span> <span class="o">=</span> <span class="s1">&#39;ThermalStorage:ChilledWater:Stratified&#39;</span>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HeatMode</span>               <span class="o">=</span>  <span class="mi">1</span> <span class="c">! heating source is on, source will not turn off until setpoint temp is reached</span>
<a name="ln-58"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FloatMode</span>              <span class="o">=</span>  <span class="mi">0</span> <span class="c">! heating source is off, source will not turn on until cutin temp is reached</span>
<a name="ln-59"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">VentMode</span>               <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c">! tank temp is above maximum temperature and water is venting</span>
<a name="ln-60"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolMode</span>               <span class="o">=</span>  <span class="mi">2</span> <span class="c">! cooling source is on, source will not turn off until setpoint temp is reached</span>
<a name="ln-61"></a>
<a name="ln-62"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AmbientTempSchedule</span>    <span class="o">=</span>  <span class="mi">1</span> <span class="c">! ambient temperature around tank (or HPWH inlet air) is scheduled</span>
<a name="ln-63"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AmbientTempZone</span>        <span class="o">=</span>  <span class="mi">2</span> <span class="c">! tank is located in a zone or HPWH inlet air is zone air only</span>
<a name="ln-64"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AmbientTempOutsideAir</span>  <span class="o">=</span>  <span class="mi">3</span> <span class="c">! tank is located outdoors or HPWH inlet air is outdoor air only</span>
<a name="ln-65"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AmbientTempZoneAndOA</span>   <span class="o">=</span>  <span class="mi">4</span> <span class="c">! applicable to HPWH only, inlet air is mixture of OA and zone air</span>
<a name="ln-66"></a>
<a name="ln-67"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CrankcaseTempSchedule</span>  <span class="o">=</span>  <span class="mi">1</span> <span class="c">! temperature controlling compressor crankcase heater is scheduled</span>
<a name="ln-68"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CrankcaseTempZone</span>      <span class="o">=</span>  <span class="mi">2</span> <span class="c">! temperature controlling compressor crankcase heater is zone air</span>
<a name="ln-69"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CrankcaseTempExterior</span>  <span class="o">=</span>  <span class="mi">3</span> <span class="c">! temperature controlling compressor crankcase heater is outdoor air</span>
<a name="ln-70"></a>
<a name="ln-71"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ControlTypeCycle</span>       <span class="o">=</span>  <span class="mi">1</span> <span class="c">! water heater only, cycling heating source control</span>
<a name="ln-72"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ControlTypeModulate</span>    <span class="o">=</span>  <span class="mi">2</span> <span class="c">! water heater only, modulating heating source control</span>
<a name="ln-73"></a>
<a name="ln-74"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TankShapeVertCylinder</span>  <span class="o">=</span>  <span class="mi">1</span> <span class="c">! tank shape is a vertical cylinder</span>
<a name="ln-75"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TankShapeHorizCylinder</span> <span class="o">=</span>  <span class="mi">2</span> <span class="c">! tank shape is a horizontal cylinder</span>
<a name="ln-76"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TankShapeOther</span>         <span class="o">=</span>  <span class="mi">3</span> <span class="c">! tank shape has an arbitrary perimeter shape</span>
<a name="ln-77"></a>
<a name="ln-78"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PriorityMasterSlave</span>    <span class="o">=</span>  <span class="mi">1</span> <span class="c">! water heater only, master-slave priority control of heater elements</span>
<a name="ln-79"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PrioritySimultaneous</span>   <span class="o">=</span>  <span class="mi">2</span> <span class="c">! water heater only, simultaneous control of heater elements</span>
<a name="ln-80"></a>
<a name="ln-81"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InletModeFixed</span>         <span class="o">=</span>  <span class="mi">1</span> <span class="c">! water heater only, inlet water always enters at the user-specified height</span>
<a name="ln-82"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">InletModeSeeking</span>       <span class="o">=</span>  <span class="mi">2</span> <span class="c">! water heater only, inlet water seeks out the node with the closest temperature</span>
<a name="ln-83"></a>
<a name="ln-84"></a><span class="c">! integer parameter for water heater</span>
<a name="ln-85"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MixedWaterHeater</span>       <span class="o">=</span>  <span class="n">TypeOf_WtrHeaterMixed</span> <span class="c">! WaterHeater:Mixed</span>
<a name="ln-86"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">StratifiedWaterHeater</span>  <span class="o">=</span>  <span class="n">TypeOf_WtrHeaterStratified</span> <span class="c">! WaterHeater:Stratified</span>
<a name="ln-87"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HeatPumpWaterHeater</span>    <span class="o">=</span>  <span class="n">TypeOf_HeatPumpWtrHeater</span> <span class="c">! WaterHeater:HeatPump</span>
<a name="ln-88"></a><span class="c">!stovall, next line never used because all desuperheater coils used in mixed water heater types</span>
<a name="ln-89"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoilWaterDesuperHeater</span> <span class="o">=</span>  <span class="mi">4</span> <span class="c">! Coil:WaterHeating:Desuperheater</span>
<a name="ln-90"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MixedChilledWaterStorage</span> <span class="o">=</span> <span class="n">TypeOf_ChilledWaterTankMixed</span> <span class="c">! &#39;ThermalStorage:ChilledWater:Mixed&#39;</span>
<a name="ln-91"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">StratifiedChilledWaterStorage</span> <span class="o">=</span> <span class="n">TypeOf_ChilledWaterTankStratified</span> <span class="c">! &#39;ThermalStorage:ChilledWater:Stratified&#39;</span>
<a name="ln-92"></a>
<a name="ln-93"></a><span class="c">! reclaim heat object types for Coil:WaterHeating:Desuperheater object</span>
<a name="ln-94"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">COMPRESSORRACK_REFRIGERATEDCASE</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! reclaim heating source is refrigerated case compressor rack</span>
<a name="ln-95"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">COIL_DX_COOLING</span>                 <span class="o">=</span> <span class="mi">2</span> <span class="c">! reclaim heating source is DX cooling coil</span>
<a name="ln-96"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">COIL_DX_MULTISPEED</span>              <span class="o">=</span> <span class="mi">3</span> <span class="c">! reclaim heating source is DX multispeed coil</span>
<a name="ln-97"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">COIL_DX_MULTIMODE</span>               <span class="o">=</span> <span class="mi">4</span> <span class="c">! reclaim heating source is DX multimode coil</span>
<a name="ln-98"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CONDENSER_REFRIGERATION</span>         <span class="o">=</span> <span class="mi">5</span> <span class="c">! reclaim heating source is detailed refrigeration system condenser</span>
<a name="ln-99"></a>
<a name="ln-100"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UseSide</span>                <span class="o">=</span> <span class="mi">101</span> <span class="c">! Indicates Use side of water heater</span>
<a name="ln-101"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SourceSide</span>             <span class="o">=</span> <span class="mi">102</span> <span class="c">! Indicates Source side of water heater</span>
<a name="ln-102"></a>
<a name="ln-103"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SizeNotSet</span>             <span class="o">=</span> <span class="mi">200</span>
<a name="ln-104"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SizePeakDraw</span>           <span class="o">=</span> <span class="mi">201</span>
<a name="ln-105"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SizeResidentialMin</span>     <span class="o">=</span> <span class="mi">202</span>
<a name="ln-106"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SizePerPerson</span>          <span class="o">=</span> <span class="mi">203</span>
<a name="ln-107"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SizePerFloorArea</span>       <span class="o">=</span> <span class="mi">204</span>
<a name="ln-108"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SizePerUnit</span>            <span class="o">=</span> <span class="mi">205</span>
<a name="ln-109"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SizePerSolarColArea</span>    <span class="o">=</span> <span class="mi">206</span>
<a name="ln-110"></a>
<a name="ln-111"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HPWHControlNotSet</span>      <span class="o">=</span> <span class="mi">500</span>
<a name="ln-112"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Heater1HPWHControl</span>     <span class="o">=</span> <span class="mi">501</span>
<a name="ln-113"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Heater2HPWHControl</span>     <span class="o">=</span> <span class="mi">502</span>
<a name="ln-114"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SourceInletHPWHControl</span> <span class="o">=</span> <span class="mi">503</span>
<a name="ln-115"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SourceOutletHPWHControl</span><span class="o">=</span> <span class="mi">504</span>
<a name="ln-116"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UseInletHPWHControl</span>    <span class="o">=</span> <span class="mi">505</span>
<a name="ln-117"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UseOutletHPWHControl</span>   <span class="o">=</span> <span class="mi">506</span>
<a name="ln-118"></a>
<a name="ln-119"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SourceSideStorageTank</span>                 <span class="o">=</span> <span class="mi">600</span>
<a name="ln-120"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SourceSideIndirectHeatPrimarySetpoint</span> <span class="o">=</span> <span class="mi">601</span>
<a name="ln-121"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SourceSideIndirectHeatAltSetpoint</span>     <span class="o">=</span> <span class="mi">602</span>
<a name="ln-122"></a>
<a name="ln-123"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-124"></a><span class="k">TYPE </span><span class="n">StratifiedNodeData</span>
<a name="ln-125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Mass</span> <span class="o">=</span> <span class="mf">0.0d0</span>                        <span class="c">! All nodes have the same mass (kg)</span>
<a name="ln-126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnCycLossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OffCycLossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-128"></a>
<a name="ln-129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Temp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SavedTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-131"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NewTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-132"></a>
<a name="ln-133"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempSum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-134"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempAvg</span> <span class="o">=</span> <span class="mf">0.0d0</span>                    <span class="c">! Average node temperature over the time step (C)</span>
<a name="ln-135"></a>
<a name="ln-136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondCoeffUp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondCoeffDn</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-138"></a>
<a name="ln-139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OffCycParaLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Heat delivered to the tank from off-cycle parasitic sources</span>
<a name="ln-140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnCycParaLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-141"></a>
<a name="ln-142"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-143"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-144"></a>
<a name="ln-145"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MassFlowFromUpper</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Mass flow rate into this node from node above</span>
<a name="ln-146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MassFlowFromLower</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Mass flow rate into this node from node below</span>
<a name="ln-147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MassFlowToUpper</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Mass flow rate from this node to node above</span>
<a name="ln-148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MassFlowToLower</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Mass flow rate from this node to node below</span>
<a name="ln-149"></a>
<a name="ln-150"></a>  <span class="c">! Report Variables</span>
<a name="ln-151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Volume</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Height</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Node height from top to bottom (like a thickness)</span>
<a name="ln-153"></a>
<a name="ln-154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaxCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! For reporting</span>
<a name="ln-155"></a>
<a name="ln-156"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Inlets</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-157"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Outlets</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-158"></a>
<a name="ln-159"></a><span class="k">END TYPE </span><span class="n">StratifiedNodeData</span>
<a name="ln-160"></a><span class="k">TYPE </span><span class="n">WaterHeaterSizingData</span>
<a name="ln-161"></a>  <span class="c">! input data</span>
<a name="ln-162"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DesignMode</span>                        <span class="o">=</span> <span class="n">SizeNotSet</span>  <span class="c">! what sizing method to use</span>
<a name="ln-163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TankDrawTime</span>                 <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! in hours, time storage can meet peak demand</span>
<a name="ln-164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RecoveryTime</span>                 <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! time for tank to recover</span>
<a name="ln-165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NominalVolForSizingDemandSideFlow</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! nominal tank size to use in sizing demand side connections</span>
<a name="ln-166"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">NumberOfBedrooms</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NumberOfBathrooms</span>            <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">!</span>
<a name="ln-168"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TankCapacityPerPerson</span>        <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">!</span>
<a name="ln-169"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RecoveryCapacityPerPerson</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-170"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TankCapacityPerArea</span>          <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RecoveryCapacityPerArea</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NumberOfUnits</span>                <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TankCapacityPerUnit</span>          <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RecoveryCapacityPerUnit</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TankCapacityPerCollectorArea</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeightAspectRatio</span>            <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-177"></a>
<a name="ln-178"></a>  <span class="c">! data from elsewhere in E+</span>
<a name="ln-179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PeakDemand</span>                   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PeakNumberOfPeople</span>           <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotalFloorArea</span>               <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-182"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotalSolarCollectorArea</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-183"></a>
<a name="ln-184"></a><span class="k">END TYPE </span><span class="n">WaterHeaterSizingData</span>
<a name="ln-185"></a>
<a name="ln-186"></a>
<a name="ln-187"></a><span class="k">TYPE </span><span class="n">WaterThermalTankData</span>
<a name="ln-188"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>                     <span class="c">! Name of water heater</span>
<a name="ln-189"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="k">Type</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>                     <span class="c">! Type of water heater (MIXED or STRATIFIED)</span>
<a name="ln-190"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TypeNum</span> <span class="o">=</span> <span class="mi">0</span>                   <span class="c">! integer parameter for water heater(if part of an HPWH,then=HPWH)</span>
<a name="ln-191"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">IsChilledWaterTank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! logical flag, true if for chilled water, false if for hot water</span>
<a name="ln-192"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EndUseSubcategoryName</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>    <span class="c">! User-defined end-use subcategory name</span>
<a name="ln-193"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">Init</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>                 <span class="c">! Flag for initialization:  TRUE means do the init</span>
<a name="ln-194"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">StandAlone</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>          <span class="c">! Flag for operation with no plant connections (no source or use)</span>
<a name="ln-195"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Volume</span> <span class="o">=</span> <span class="mf">0.0d0</span>                  <span class="c">! Tank volume (m3)</span>
<a name="ln-196"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Mass</span> <span class="o">=</span> <span class="mf">0.0d0</span>                    <span class="c">! Total mass of fluid in the tank (kg)</span>
<a name="ln-197"></a>
<a name="ln-198"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TimeElapsed</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Fraction of the current hour that has elapsed (h)</span>
<a name="ln-199"></a>                                                                <span class="c">! Saved in order to identify the beginning of a new system time</span>
<a name="ln-200"></a>
<a name="ln-201"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Indicator for ambient tank losses (SCHEDULE, ZONE, EXTERIOR)</span>
<a name="ln-202"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AmbientTempSchedule</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Schedule index pointer</span>
<a name="ln-203"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AmbientTempZone</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c">! Number of ambient zone around tank</span>
<a name="ln-204"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AmbientTempOutsideAirNode</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Number of outside air node</span>
<a name="ln-205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">AmbientTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Ambient temperature around tank (C)</span>
<a name="ln-206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">AmbientZoneGain</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Internal gain to zone from tank losses (W)</span>
<a name="ln-207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>               <span class="c">! Overall tank heat loss coefficient, UA (W/K)</span>
<a name="ln-208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycLossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Off-cycle overall tank heat loss coefficient, UA (W/K)</span>
<a name="ln-209"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycLossFracToZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Fraction of off-cycle losses added to zone</span>
<a name="ln-210"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycLossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! On-cycle overall tank heat loss coefficient, UA (W/K)</span>
<a name="ln-211"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycLossFracToZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Fraction of on-cycle losses added to zone</span>
<a name="ln-212"></a>
<a name="ln-213"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">Mode</span> <span class="o">=</span> <span class="mi">0</span>                      <span class="c">! Indicator for current operating mode</span>
<a name="ln-214"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SavedMode</span> <span class="o">=</span> <span class="mi">0</span>                 <span class="c">! Mode indicator saved from previous time step</span>
<a name="ln-215"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ControlType</span> <span class="o">=</span> <span class="mi">1</span>               <span class="c">! Indicator for control type</span>
<a name="ln-216"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>                 <span class="c">! Fuel type</span>
<a name="ln-217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Maximum capacity of auxiliary heater 1 (W)</span>
<a name="ln-218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MinCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Minimum capacity of auxiliary heater 1 (W)</span>
<a name="ln-219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Efficiency</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Thermal efficiency of auxiliary heater 1 ()</span>
<a name="ln-220"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PLFCurve</span> <span class="o">=</span> <span class="mi">0</span>                  <span class="c">! Part load factor curve as a function of part load ratio</span>
<a name="ln-221"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SetpointTempSchedule</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Schedule index pointer</span>
<a name="ln-222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SetpointTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Setpoint temperature of auxiliary heater 1 (C)</span>
<a name="ln-223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DeadbandDeltaTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! Deadband temperature difference of auxiliary heater 1 (deltaC)</span>
<a name="ln-224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TankTempLimit</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Maximum tank temperature limit before venting (C)</span>
<a name="ln-225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">IgnitionDelay</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Time delay before heater is allowed to turn on (s)</span>
<a name="ln-226"></a>
<a name="ln-227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Rate for off-cycle parasitic load (W)</span>
<a name="ln-228"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>       <span class="c">! Fuel type for off-cycle parasitic load</span>
<a name="ln-229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaFracToTank</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Fraction of off-cycle parasitic energy ending up in tank (W)</span>
<a name="ln-230"></a>
<a name="ln-231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Rate for on-cycle parasitic load (W)</span>
<a name="ln-232"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>        <span class="c">! Fuel type for on-cycle parasitic load</span>
<a name="ln-233"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaFracToTank</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Fraction of on-cycle parasitic energy ending up in tank (W)</span>
<a name="ln-234"></a>
<a name="ln-235"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseCurrentFlowLock</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! current flow lock setting on use side</span>
<a name="ln-236"></a>
<a name="ln-237"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseInletNode</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c">! Inlet node on the use side; colder water returning to a hottank</span>
<a name="ln-238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Use side inlet temperature (C)</span>
<a name="ln-239"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseOutletNode</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c">! Outlet node on the use side; hot tank water</span>
<a name="ln-240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Use side outlet temperature (C)</span>
<a name="ln-241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Mass flow rate on the use side (kg/s)</span>
<a name="ln-242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseEffectiveness</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! Heat transfer effectiveness on use side ()</span>
<a name="ln-243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PlantUseMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Plant demand-side max flow request on use side (kg/s)</span>
<a name="ln-244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SavedUseOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Use side outlet temp saved for demand-side flow control (C)</span>
<a name="ln-245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Use side plant volume flow rate (input data, autosizable) m3/s</span>
<a name="ln-246"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseBranchControlType</span> <span class="o">=</span> <span class="mi">2</span>      <span class="c">! Use side plant branch control type e.g active, passive, bypass</span>
<a name="ln-247"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseSidePlantSizNum</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! index in plant sizing that the use side is on</span>
<a name="ln-248"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">UseSideSeries</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-249"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseSideAvailSchedNum</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! use side availability schedule</span>
<a name="ln-250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseSideLoadRequested</span> <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! hold MyLoad request from plant management.</span>
<a name="ln-251"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseSidePlantLoopNum</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! if not zero, then this use side is on plant loop #</span>
<a name="ln-252"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseSidePlantLoopSide</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! use side is on loop side index</span>
<a name="ln-253"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseSidePlantBranchNum</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c">! use side branch num in plant topology</span>
<a name="ln-254"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseSidePlantCompNum</span>  <span class="o">=</span> <span class="mi">0</span>      <span class="c">! use side component num in plant topology</span>
<a name="ln-255"></a>
<a name="ln-256"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceCurrentFlowLock</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c">! current flow lock setting on source side</span>
<a name="ln-257"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceInletNode</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c">! Inlet node for the source side; hot water from supply</span>
<a name="ln-258"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceInletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Source side inlet temperature (C)</span>
<a name="ln-259"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceOutletNode</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Outlet node for the source side; colder tank water</span>
<a name="ln-260"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! Source side outlet temperature (C)</span>
<a name="ln-261"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Mass flow rate on the source side (kg/s)</span>
<a name="ln-262"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceEffectiveness</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Heat transfer effectiveness on source side ()</span>
<a name="ln-263"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Plant demand-side max flow request on source side (kg/s)</span>
<a name="ln-264"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SavedSourceOutletTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Source side outlet temp saved for demand-side flow control (C)</span>
<a name="ln-265"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Source side plant volume flow rate (input , autosizable) m3/s</span>
<a name="ln-266"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceBranchControlType</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c">! source side plant branch control type e.g active, passive, bypass</span>
<a name="ln-267"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceSidePlantSizNum</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c">! index in plant sizing that the source side is on</span>
<a name="ln-268"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">SourceSideSeries</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-269"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceSideAvailSchedNum</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! source side availability schedule.</span>
<a name="ln-270"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceSidePlantLoopNum</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! if not zero, then this use side is on plant loop #</span>
<a name="ln-271"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceSidePlantLoopSide</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! loop side that Source side is one eg. supply or demand</span>
<a name="ln-272"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceSidePlantBranchNum</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Source side branch num in plant topology</span>
<a name="ln-273"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceSidePlantCompNum</span>  <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Source side component num in plant topology</span>
<a name="ln-274"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceSideControlMode</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! flag for how source side flow is controlled </span>
<a name="ln-275"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceSideAltSetpointSchedNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! schedule of alternate temperature setpoint values </span>
<a name="ln-276"></a>
<a name="ln-277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SizingRecoveryTime</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! sizing parameter for autosizing indirect water heaters (hr)</span>
<a name="ln-278"></a>
<a name="ln-279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Maximum flow rate for scheduled DHW (kg/s)</span>
<a name="ln-280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">VolFlowRateMin</span>  <span class="o">=</span> <span class="mf">0.d0</span>        <span class="c">! Minimum flow rate for heater ignition (kg/s)</span>
<a name="ln-281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MassFlowRateMin</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Minimum mass flow rate for heater ignition (kg/s)</span>
<a name="ln-282"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">FlowRateSchedule</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Schedule index pointer</span>
<a name="ln-283"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseInletTempSchedule</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Cold water supply temperature schedule index pointer</span>
<a name="ln-284"></a>
<a name="ln-285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TankTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>                <span class="c">! Temperature of tank fluid (average, if stratified) (C)</span>
<a name="ln-286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SavedTankTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Tank temp that is carried from time step to time step (C)</span>
<a name="ln-287"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TankTempAvg</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Average tank temperature over the time step (C)</span>
<a name="ln-288"></a>
<a name="ln-289"></a>  <span class="c">! Stratified variables (in addition to the above)</span>
<a name="ln-290"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Height</span> <span class="o">=</span> <span class="mf">0.0d0</span>                  <span class="c">! Height of tank (m)</span>
<a name="ln-291"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Perimeter</span> <span class="o">=</span> <span class="mf">0.0d0</span>               <span class="c">! Perimeter of tank (m), only used for OTHER shape</span>
<a name="ln-292"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="nb">Shape</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c">! Tank shape:  VERTICAL CYLINDER, HORIZONTAL CYLINDER, or OTHER</span>
<a name="ln-293"></a>
<a name="ln-294"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterHeight1</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-295"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HeaterNode1</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-296"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">HeaterOn1</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-297"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">SavedHeaterOn1</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-298"></a>
<a name="ln-299"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterHeight2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-300"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HeaterNode2</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-301"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">HeaterOn2</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-302"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">SavedHeaterOn2</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-303"></a>
<a name="ln-304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">AdditionalCond</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Additional destratification conductivity (W/m K)</span>
<a name="ln-305"></a>
<a name="ln-306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SetpointTemp2</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Setpoint temperature of auxiliary heater 2 (C)</span>
<a name="ln-307"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SetpointTempSchedule2</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DeadbandDeltaTemp2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxCapacity2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-310"></a>
<a name="ln-311"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaHeight</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-312"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaHeight</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-313"></a>
<a name="ln-314"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SkinLossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SkinLossFracToZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycFlueLossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-317"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycFlueLossFracToZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-318"></a>
<a name="ln-319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseInletHeight</span> <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Height of use side inlet (m)</span>
<a name="ln-320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseOutletHeight</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Height of use side outlet (m)</span>
<a name="ln-321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceInletHeight</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! Height of source side inlet (m)</span>
<a name="ln-322"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceOutletHeight</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Height of source side outlet (m)</span>
<a name="ln-323"></a>
<a name="ln-324"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseInletStratNode</span> <span class="o">=</span> <span class="mi">0</span>         <span class="c">! Use-side inlet node number</span>
<a name="ln-325"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UseOutletStratNode</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! Use-side outlet node number</span>
<a name="ln-326"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceInletStratNode</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Source-side inlet node number</span>
<a name="ln-327"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SourceOutletStratNode</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c">! Source-side outlet node number</span>
<a name="ln-328"></a>
<a name="ln-329"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">InletMode</span> <span class="o">=</span> <span class="mi">1</span>                 <span class="c">! Inlet position mode:  1 = FIXED; 2 = SEEKING</span>
<a name="ln-330"></a>
<a name="ln-331"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">InversionMixingRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-332"></a>
<a name="ln-333"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">AdditionalLossCoeff</span>        <span class="c">! Loss coefficient added to the skin loss coefficient (W/m2-K)</span>
<a name="ln-334"></a>
<a name="ln-335"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">Nodes</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c">! Number of nodes</span>
<a name="ln-336"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">StratifiedNodeData</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">Node</span>   <span class="c">! Array of node data</span>
<a name="ln-337"></a>
<a name="ln-338"></a>  <span class="c">! Report variables</span>
<a name="ln-339"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Scheduled DHW demand (m3/s)</span>
<a name="ln-340"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">VolumeConsumed</span> <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Volume of DHW consumed (m3)</span>
<a name="ln-341"></a>
<a name="ln-342"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UnmetRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>               <span class="c">! Energy demand to heat tank water to setpoint (W)</span>
<a name="ln-343"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LossRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>                <span class="c">! Energy demand to support heat losses due to ambient temp (W)</span>
<a name="ln-344"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FlueLossRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Heat loss rate to flue (W)</span>
<a name="ln-345"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>                 <span class="c">! Energy demand to heat the Use Side water to tank temp (W)</span>
<a name="ln-346"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TotalDemandRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Total demand rate (sum of all above rates) (W)</span>
<a name="ln-347"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Energy supplied by the source side to help heat the tank (W)</span>
<a name="ln-348"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! The energy the water heater burner puts into the water (W)</span>
<a name="ln-349"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterRate1</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! The energy heater 1 puts into the water (W)</span>
<a name="ln-350"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterRate2</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! The energy heater 2 puts into the water (W)</span>
<a name="ln-351"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FuelRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>                <span class="c">! The fuel consumption rate for the water heater burner (W)</span>
<a name="ln-352"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FuelRate1</span> <span class="o">=</span> <span class="mf">0.0d0</span>               <span class="c">! The fuel consumption rate for heater 1 (W)</span>
<a name="ln-353"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FuelRate2</span> <span class="o">=</span> <span class="mf">0.0d0</span>               <span class="c">! The fuel consumption rate for heater 2 (W)</span>
<a name="ln-354"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">VentRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>                <span class="c">! Heat recovery energy lost due to setpoint temp (W)</span>
<a name="ln-355"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaFuelRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Fuel consumption rate for off-cycle parasitic load (W)</span>
<a name="ln-356"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaRateToTank</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Heat rate to tank for off-cycle parasitic load (W)</span>
<a name="ln-357"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaFuelRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! Fuel consumption rate for on-cycle parasitic load (W)</span>
<a name="ln-358"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaRateToTank</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Heat rate to tank for on-cycle parasitic load (W)</span>
<a name="ln-359"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">NetHeatTransferRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Net heat transfer rate to/from tank (W)</span>
<a name="ln-360"></a>
<a name="ln-361"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CycleOnCount</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c">! Number of times heater cycles on in the current time step</span>
<a name="ln-362"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CycleOnCount1</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c">! Number of times heater 1 cycles on in the current time step</span>
<a name="ln-363"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CycleOnCount2</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c">! Number of times heater 2 cycles on in the current time step</span>
<a name="ln-364"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">! Runtime fraction, fraction of timestep that any  heater is running</span>
<a name="ln-365"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RuntimeFraction1</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! Runtime fraction, fraction of timestep that heater 1 is running</span>
<a name="ln-366"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RuntimeFraction2</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! Runtime fraction, fraction of timestep that heater 2 is running</span>
<a name="ln-367"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! Part load ratio, fraction of maximum heater capacity</span>
<a name="ln-368"></a>
<a name="ln-369"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UnmetEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Energy to heat tank water to setpoint (J)</span>
<a name="ln-370"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LossEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Energy to support heat losses due to ambient temp (J)</span>
<a name="ln-371"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FlueLossEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! Energy to support heat losses to the flue (J)</span>
<a name="ln-372"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">UseEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>               <span class="c">! Energy to heat the use side water to tank temp (J)</span>
<a name="ln-373"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TotalDemandEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! Total energy demand (sum of all above energies) (J)</span>
<a name="ln-374"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Energy supplied by the source side to help heat the tank (J)</span>
<a name="ln-375"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! The energy the water heater burner puts into the water (J)</span>
<a name="ln-376"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterEnergy1</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! The energy heater 1 puts into the water (J)</span>
<a name="ln-377"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterEnergy2</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! The energy heater 2 puts into the water (J)</span>
<a name="ln-378"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FuelEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! The fuel consumption energy for the water heater burner (J)</span>
<a name="ln-379"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FuelEnergy1</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! The fuel consumption energy for heater 1 (J)</span>
<a name="ln-380"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FuelEnergy2</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! The fuel consumption energy for heater 2 (J)</span>
<a name="ln-381"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">VentEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! Heat recovery energy lost due to setpoint temp (J)</span>
<a name="ln-382"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Fuel consumption energy for off-cycle parasitic load (J)</span>
<a name="ln-383"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaEnergyToTank</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Energy to tank for off-cycle parasitic load (J)</span>
<a name="ln-384"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaFuelEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Fuel consumption energy for on-cycle parasitic load (J)</span>
<a name="ln-385"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaEnergyToTank</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Energy to tank for on-cycle parasitic load (J)</span>
<a name="ln-386"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">NetHeatTransferEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Net heat transfer energy to/from tank (J)</span>
<a name="ln-387"></a>
<a name="ln-388"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">FirstRecoveryDone</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>   <span class="c">! Flag to indicate when first recovery to the setpoint is done</span>
<a name="ln-389"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FirstRecoveryFuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! Fuel energy needed for first recovery to the setpoint (J)</span>
<a name="ln-390"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HeatPumpNum</span> <span class="o">=</span> <span class="mi">0</span>               <span class="c">! Index to heat pump water heater</span>
<a name="ln-391"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DesuperheaterNum</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Index to desuperheating coil</span>
<a name="ln-392"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">ShowSetpointWarning</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! Warn when set point is greater than max tank temp limit</span>
<a name="ln-393"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">MaxCycleErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! recurring error index</span>
<a name="ln-394"></a>  <span class="k">Type</span><span class="p">(</span><span class="n">WaterHeaterSizingData</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Sizing</span>                        <span class="c">! ancillary data for autosizing</span>
<a name="ln-395"></a><span class="k">END TYPE </span><span class="n">WaterThermalTankData</span>
<a name="ln-396"></a>
<a name="ln-397"></a>
<a name="ln-398"></a><span class="k">TYPE </span><span class="n">HeatPumpWaterHeaterData</span>
<a name="ln-399"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>                     <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Name of heat pump water heater</span>
<a name="ln-400"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="k">Type</span>                     <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Type of water heater (HEAT PUMP:WATER HEATER)</span>
<a name="ln-401"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TypeNum</span>                  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! integer parameter for heat pump water heater</span>
<a name="ln-402"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankName</span>                 <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Name of tank associated with heat pump water heater</span>
<a name="ln-403"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankType</span>                 <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Type of water heater (MIXED or STRATIFIED) used with heat pump</span>
<a name="ln-404"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TankTypeNum</span>              <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Parameter for tank type (MIXED or STRATIFIED)</span>
<a name="ln-405"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">StandAlone</span>          <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! Flag for operation with no plant connections (no use nodes)</span>
<a name="ln-406"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AvailSchedPtr</span>            <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to Availability Schedule curve index</span>
<a name="ln-407"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SetpointTempSchedule</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to Setpoint Temperature Schedule curve</span>
<a name="ln-408"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DeadbandTempDiff</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Dead band temperature difference (cut-in temperature)</span>
<a name="ln-409"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Capacity</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Heat Pump rated capacity (W)</span>
<a name="ln-410"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">BackupElementCapacity</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Tank backup element capacity (W)</span>
<a name="ln-411"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">BackupElementEfficiency</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Tank backup element efficiency</span>
<a name="ln-412"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">WHOnCycParaLoad</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! tank&#39;s on-cycle parasitic load (W), disable for rating</span>
<a name="ln-413"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">WHOffCycParaLoad</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! tank&#39;s off-cycle parasitic load (W), disable for rating</span>
<a name="ln-414"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">WHOnCycParaFracToTank</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! tank&#39;s on-cycle parasitic frac to tank, disable for rating</span>
<a name="ln-415"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">WHOffCycParaFracToTank</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! tank&#39;s off-cycle parasitic frac to tank, disable for rating</span>
<a name="ln-416"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WHPLFCurve</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">! tank part-load fraction curve index, used for rating procedure</span>
<a name="ln-417"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OperatingAirFlowRate</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Operating volumetric air flow rate (m3/s)</span>
<a name="ln-418"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OperatingWaterFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Operating volumetric water flow rate (m3/s)</span>
<a name="ln-419"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">COP</span>                      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Heat Pump coefficient of performance (W/W)</span>
<a name="ln-420"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SHR</span>                      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Heat Pump air-side coil sensible heat ratio</span>
<a name="ln-421"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedInletDBTemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated evaporator inlet air dry-bulb temperature (C)</span>
<a name="ln-422"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedInletWBTemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated evaporator inlet air wet-bulb temperature (C)</span>
<a name="ln-423"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedInletWaterTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rated condenser inlet water temperature (C)</span>
<a name="ln-424"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">FoundTank</span>            <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Found storage tank flag associated with HP water heater</span>
<a name="ln-425"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HeatPumpAirInletNode</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">! HP air inlet node (for zone, zone/outdoor or scheduled)</span>
<a name="ln-426"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HeatPumpAirOutletNode</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! HP air outlet node (for zone, zone/outdoor or scheduled)</span>
<a name="ln-427"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">OutsideAirNode</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! outdoor air node (for outdoor or zone/outdoor air unit only)</span>
<a name="ln-428"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ExhaustAirNode</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Exhaust air node (for outdoor or zone/outdoor air unit only)</span>
<a name="ln-429"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CondWaterInletNode</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Condenser water inlet node</span>
<a name="ln-430"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CondWaterOutletNode</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Condenser water outlet node</span>
<a name="ln-431"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WHUseInletNode</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Water heater tank use side inlet node</span>
<a name="ln-432"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WHUseOutletNode</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Water heater tank use side outlet node</span>
<a name="ln-433"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WHUseSidePlantLoopNum</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! if not zero, then this water heater is on plant loop #</span>
<a name="ln-434"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilType</span>               <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Type of DX coil (Coil:DX:HeatPumpWaterHeater)</span>
<a name="ln-435"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DXCoilName</span>               <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Name of DX coil</span>
<a name="ln-436"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DXCoilNum</span>                <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index of DX coil</span>
<a name="ln-437"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DXCoilAirInletNode</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Inlet air node number of DX coil</span>
<a name="ln-438"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DXCoilPLFFPLR</span>            <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to HPWH&#39;s DX Coil PLF as a function of PLR curve</span>
<a name="ln-439"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanType</span>                  <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Type of Fan (Fan:OnOff)</span>
<a name="ln-440"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">FanType_Num</span>              <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Integer type of fan (3 = Fan:OnOff)</span>
<a name="ln-441"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanName</span>                  <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Name of Fan</span>
<a name="ln-442"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">FanNum</span>                   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index of Fan</span>
<a name="ln-443"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">FanPlacement</span>             <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Location of Fan</span>
<a name="ln-444"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">FanOutletNode</span>            <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Outlet node of heat pump water heater fan</span>
<a name="ln-445"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WaterHeaterTankNum</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index of Water Heater Tank</span>
<a name="ln-446"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">OutletAirSplitterSchPtr</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to air-side outlet air splitter schedule</span>
<a name="ln-447"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">InletAirMixerSchPtr</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to air-side inlet air mixer schedule</span>
<a name="ln-448"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">Mode</span>                     <span class="o">=</span> <span class="mi">0</span>   <span class="c">! HP mode (0 = float, 1 = heating [-1 = venting na for HP])</span>
<a name="ln-449"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SaveMode</span>                 <span class="o">=</span> <span class="mi">0</span>   <span class="c">! HP mode on first iteration</span>
<a name="ln-450"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SaveWHMode</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">! mode of water heater tank element (backup element)</span>
<a name="ln-451"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Power</span>                    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! HP power used for reporting</span>
<a name="ln-452"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Energy</span>                   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! HP energy used for reporting</span>
<a name="ln-453"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeatingPLR</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! HP PLR used for reporting</span>
<a name="ln-454"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SetpointTemp</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! set point or cut-out temperature [C]</span>
<a name="ln-455"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MinAirTempForHPOperation</span> <span class="o">=</span> <span class="mf">5.0d0</span> <span class="c">! HP does not operate below this ambient temperature</span>
<a name="ln-456"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">InletAirMixerNode</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Inlet air mixer node number of HP water heater</span>
<a name="ln-457"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">OutletAirSplitterNode</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Outlet air splitter node number of HP water heater</span>
<a name="ln-458"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SourceMassFlowRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum mass flow rate on the source side (kg/s)</span>
<a name="ln-459"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">InletAirConfiguration</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Identifies source of HPWH inlet air</span>
<a name="ln-460"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AmbientTempSchedule</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Schedule index pointer for ambient air temp at HPWH inlet</span>
<a name="ln-461"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AmbientRHSchedule</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Schedule index pointer for ambient air RH at HPWH inlet</span>
<a name="ln-462"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AmbientTempZone</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index of ambient zone for ambient air at HPWH inlet</span>
<a name="ln-463"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CrankcaseTempIndicator</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Indicator for HPWH compressor/crankcase heater location</span>
<a name="ln-464"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CrankcaseTempSchedule</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Schedule index pointer where crankcase heater is located</span>
<a name="ln-465"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CrankcaseTempZone</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index of zone where compressor/crankcase heater is located</span>
<a name="ln-466"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaLoad</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rate for off-cycle parasitic load (W)</span>
<a name="ln-467"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaLoad</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rate for on-cycle parasitic load (W)</span>
<a name="ln-468"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ParasiticTempIndicator</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Indicator for HPWH parasitic heat rejection location</span>
<a name="ln-469"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaFuelRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric consumption rate for off-cycle parasitic load (W)</span>
<a name="ln-470"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaFuelRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric consumption rate for on-cycle parasitic load (W)</span>
<a name="ln-471"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaFuelEnergy</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric energy consumption for off-cycle parasitic load (J)</span>
<a name="ln-472"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaFuelEnergy</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric energy consumption for on-cycle parasitic load (J)</span>
<a name="ln-473"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">AirFlowRateAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Used to report air flow autosize info in Init</span>
<a name="ln-474"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">WaterFlowRateAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Used to report water flow autosize info in Init</span>
<a name="ln-475"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HPSetPointError</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Used when temperature SP&#39;s in tank and HP are reversed</span>
<a name="ln-476"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HPSetPointErrIndex1</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to recurring error for tank/HP set point temp</span>
<a name="ln-477"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">IterLimitErrIndex1</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring iteration limit warning messages</span>
<a name="ln-478"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">IterLimitExceededNum1</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for recurring iteration limit warning messages</span>
<a name="ln-479"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegulaFalsiFailedIndex1</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring RegulaFalsi failed warning messages</span>
<a name="ln-480"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegulaFalsiFailedNum1</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for recurring RegulaFalsi failed warning messages</span>
<a name="ln-481"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">IterLimitErrIndex2</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring iteration limit warning messages</span>
<a name="ln-482"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">IterLimitExceededNum2</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for recurring iteration limit warning messages</span>
<a name="ln-483"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegulaFalsiFailedIndex2</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring RegulaFalsi failed warning messages</span>
<a name="ln-484"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">RegulaFalsiFailedNum2</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for recurring RegulaFalsi failed warning messages</span>
<a name="ln-485"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">FirstTimeThroughFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! Flag for saving water heater status</span>
<a name="ln-486"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">ShowSetpointWarning</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! Warn when set point is greater than max tank temp limit</span>
<a name="ln-487"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">HPWaterHeaterSensibleCapacity</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! sensible capacity delivered when HPWH is attached to a zone (W)</span>
<a name="ln-488"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">HPWaterHeaterLatentCapacity</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! latent capacity delivered when HPWH is attached to a zone (kg/s)</span>
<a name="ln-489"></a>  <span class="kt">INTEGER</span>                 <span class="kd">::</span> <span class="n">ControlSensorLocation</span>         <span class="o">=</span> <span class="n">HPWHControlNotSet</span> <span class="c">! if using stratified tank, indicates control point</span>
<a name="ln-490"></a><span class="k">END TYPE </span><span class="n">HeatPumpWaterHeaterData</span>
<a name="ln-491"></a>
<a name="ln-492"></a><span class="k">TYPE </span><span class="n">WaterHeaterDesuperheaterData</span>
<a name="ln-493"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>                     <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Name of heat pump water heater desuperheater</span>
<a name="ln-494"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="k">Type</span>                     <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Type of water heater desuperheating coil</span>
<a name="ln-495"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">InsuffTemperatureWarn</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Used for recurring error count on low source temperature</span>
<a name="ln-496"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AvailSchedPtr</span>            <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to Availability Schedule curve index</span>
<a name="ln-497"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SetpointTempSchedule</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to Setpoint Temperature Schedule curve</span>
<a name="ln-498"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DeadbandTempDiff</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Dead band temperature difference (cut-in temperature)</span>
<a name="ln-499"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeatReclaimRecoveryEff</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! recovery efficiency of desuperheater (0.3 max)</span>
<a name="ln-500"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WaterInletNode</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Desuperheater water inlet node</span>
<a name="ln-501"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WaterOutletNode</span>          <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Desuperheater water outlet node</span>
<a name="ln-502"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedInletWaterTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Inlet water temp at rated heat reclaim recovery eff (C)</span>
<a name="ln-503"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedOutdoorAirTemp</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Outdoor air temp at rated heat reclaim recovery eff (C)</span>
<a name="ln-504"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxInletWaterTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Max water temp for heat reclaim recovery (C)</span>
<a name="ln-505"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankType</span>                 <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Type of water heater (MIXED or STRATIFIED)</span>
<a name="ln-506"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TankTypeNum</span>              <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Parameter for tank type (MIXED or STRATIFIED)</span>
<a name="ln-507"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankName</span>                 <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Name of tank associated with desuperheater</span>
<a name="ln-508"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">StandAlone</span>          <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! Flag for operation with no plant connections (no use nodes)</span>
<a name="ln-509"></a>  <span class="c">!note char variable heatingsourcetype doesn&#39;t seem to be used anywhere</span>
<a name="ln-510"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingSourceType</span>        <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Type of heating source (DX coil or refrigerated rack)</span>
<a name="ln-511"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingSourceName</span>        <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c">! Name of heating source</span>
<a name="ln-512"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterRate</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Report variable for desuperheater heating rate [W]</span>
<a name="ln-513"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HeaterEnergy</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Report variable for desuperheater heating energy [J]</span>
<a name="ln-514"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PumpPower</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Report variable for water circulation pump power [W]</span>
<a name="ln-515"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PumpEnergy</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Report variable for water circulation pump energy [J]</span>
<a name="ln-516"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PumpElecPower</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Nominal power input to the water circulation pump [W]</span>
<a name="ln-517"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PumpFracToWater</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Nominal power fraction to water for the water circulation pump</span>
<a name="ln-518"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OperatingWaterFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Operating volumetric water flow rate (m3/s)</span>
<a name="ln-519"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HEffFTemp</span>                <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Heating capacity as a function of temperature curve index</span>
<a name="ln-520"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">HEffFTempOutput</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! report variable for HEffFTemp curve</span>
<a name="ln-521"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">SetpointTemp</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! set point or cut-out temperature [C]</span>
<a name="ln-522"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">WaterHeaterTankNum</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index of Water Heater Tank</span>
<a name="ln-523"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DesuperheaterPLR</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! part load ratio of desuperheater</span>
<a name="ln-524"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaLoad</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rate for on-cycle parasitic load (W)</span>
<a name="ln-525"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaLoad</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Rate for off-cycle parasitic load (W)</span>
<a name="ln-526"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaFuelEnergy</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric energy consumption for on-cycle parasitic load (J)</span>
<a name="ln-527"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OnCycParaFuelRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric consumption rate for on-cycle parasitic load (W)</span>
<a name="ln-528"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaFuelEnergy</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric energy consumption for off-cycle parasitic load (J)</span>
<a name="ln-529"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">OffCycParaFuelRate</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Electric consumption rate for off-cycle parasitic load (W)</span>
<a name="ln-530"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">Mode</span>                     <span class="o">=</span> <span class="mi">0</span>   <span class="c">! mode (0 = float, 1 = heating [-1=venting na for desuperheater])</span>
<a name="ln-531"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SaveMode</span>                 <span class="o">=</span> <span class="mi">0</span>   <span class="c">! desuperheater mode on first iteration</span>
<a name="ln-532"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SaveWHMode</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">! mode of water heater tank element (backup element)</span>
<a name="ln-533"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">BackupElementCapacity</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Tank backup element capacity (W)</span>
<a name="ln-534"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DXSysPLR</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! runtime fraction of desuperheater heating coil</span>
<a name="ln-535"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReclaimHeatingSourceName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! The source name for the Desuperheater Heating Coil</span>
<a name="ln-536"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">ReclaimHeatingSourceIndexNum</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to reclaim heating source (condenser) of a specific type</span>
<a name="ln-537"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">ReclaimHeatingSource</span>         <span class="o">=</span> <span class="mi">0</span>   <span class="c">! The source for the Desuperheater Heating Coil</span>
<a name="ln-538"></a>                                                                 <span class="c">! COMPRESSOR RACK:REFRIGERATED CASE    = 1</span>
<a name="ln-539"></a>                                                                 <span class="c">! COIL:DX:COOLINGBYPASSFACTOREMPIRICAL = 2</span>
<a name="ln-540"></a>                                                                 <span class="c">! COIL:DX:MULTISPEED:COOLINGEMPIRICAL  = 3</span>
<a name="ln-541"></a>                                                                 <span class="c">! COIL:DX:MultiMode:CoolingEmpirical   = 4</span>
<a name="ln-542"></a>                                                                 <span class="c">! CONDENSER:REFRIGERATION              = 5</span>
<a name="ln-543"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">SetPointError</span>                <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Used when temp SP in tank and desuperheater are reversed</span>
<a name="ln-544"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">SetPointErrIndex1</span>            <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index to recurring error for tank/desuperheater set point temp</span>
<a name="ln-545"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">IterLimitErrIndex1</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring iteration limit warning messages</span>
<a name="ln-546"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">IterLimitExceededNum1</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for recurring iteration limit warning messages</span>
<a name="ln-547"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">RegulaFalsiFailedIndex1</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring RegulaFalsi failed warning messages</span>
<a name="ln-548"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">RegulaFalsiFailedNum1</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for recurring RegulaFalsi failed warning messages</span>
<a name="ln-549"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">IterLimitErrIndex2</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring iteration limit warning messages</span>
<a name="ln-550"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">IterLimitExceededNum2</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for recurring iteration limit warning messages</span>
<a name="ln-551"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">RegulaFalsiFailedIndex2</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Index for recurring RegulaFalsi failed warning messages</span>
<a name="ln-552"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">RegulaFalsiFailedNum2</span>        <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Counter for recurring RegulaFalsi failed warning messages</span>
<a name="ln-553"></a><span class="k">END TYPE </span><span class="n">WaterHeaterDesuperheaterData</span>
<a name="ln-554"></a>
<a name="ln-555"></a>          <span class="c">! MODULE VARIABLE TYPE DECLARATIONS:</span>
<a name="ln-556"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">WaterThermalTankData</span><span class="p">),</span>                 <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WaterThermalTank</span>
<a name="ln-557"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">HeatPumpWaterHeaterData</span><span class="p">),</span>         <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">HPWaterHeater</span>
<a name="ln-558"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">WaterHeaterDesuperheaterData</span><span class="p">),</span>    <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WaterHeaterDesuperheater</span>
<a name="ln-559"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ValidSourceType</span> <span class="c">! Used to determine if a source for a desuperheater heating coil is valid</span>
<a name="ln-560"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyHPSizeFlag</span>    <span class="c">! Used to report autosize info in Init</span>
<a name="ln-561"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckWTTEquipName</span>
<a name="ln-562"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckHPWHEquipName</span>
<a name="ln-563"></a>
<a name="ln-564"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-565"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumChilledWaterMixed</span>          <span class="o">=</span><span class="mi">0</span> <span class="c">! number of mixed chilled water tanks</span>
<a name="ln-566"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumChilledWaterStratified</span>     <span class="o">=</span><span class="mi">0</span> <span class="c">! number of stratified chilled water tanks</span>
<a name="ln-567"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumWaterHeaterMixed</span>           <span class="o">=</span><span class="mi">0</span> <span class="c">! number of mixed water heaters</span>
<a name="ln-568"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumWaterHeaterStratified</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! number of stratified water heaters</span>
<a name="ln-569"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumWaterThermalTank</span>           <span class="o">=</span><span class="mi">0</span> <span class="c">! total number of water thermal tanks, hot and cold (MIXED + STRATIFIED)</span>
<a name="ln-570"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumWaterHeaterDesuperheater</span>   <span class="o">=</span><span class="mi">0</span> <span class="c">! number of desuperheater heating coils</span>
<a name="ln-571"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumHeatPumpWaterHeater</span>        <span class="o">=</span><span class="mi">0</span> <span class="c">! number of heat pump water heaters</span>
<a name="ln-572"></a><span class="c">!INTEGER :: MaxCyclesErrorCount           =0 ! error counter for water heater that cycles more than max during time step</span>
<a name="ln-573"></a>
<a name="ln-574"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HPPartLoadRatio</span>               <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! part load ratio of HPWH</span>
<a name="ln-575"></a><span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">GetWaterThermalTankInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>             <span class="c">! Calls to Water Heater from multiple places in code</span>
<a name="ln-576"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MixerInletAirSchedule</span>         <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! output of inlet air mixer node schedule</span>
<a name="ln-577"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotAir</span>                       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! mass flow rate of evaporator air, kg/s</span>
<a name="ln-578"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumWaterHeaterSizing</span>          <span class="o">=</span><span class="mi">0</span> <span class="c">! Number of sizing/design objects for water heaters.</span>
<a name="ln-579"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">AlreadyRated</span> <span class="c">! control so we don&#39;t repeat again</span>
<a name="ln-580"></a>
<a name="ln-581"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS:</span>
<a name="ln-582"></a><span class="k">PUBLIC  </span><span class="n">SimWaterThermalTank</span>
<a name="ln-583"></a><span class="k">PUBLIC  </span><span class="n">SimulateWaterHeaterStandAlone</span>
<a name="ln-584"></a><span class="k">PUBLIC  </span><span class="n">CalcWaterThermalTankZoneGains</span>
<a name="ln-585"></a><span class="k">PUBLIC  </span><span class="n">SimHeatPumpWaterHeater</span>
<a name="ln-586"></a><span class="k">PRIVATE </span><span class="n">GetWaterThermalTankInput</span>
<a name="ln-587"></a><span class="k">PRIVATE </span><span class="n">InitWaterThermalTank</span>
<a name="ln-588"></a><span class="k">PRIVATE </span><span class="n">SetupStratifiedNodes</span>
<a name="ln-589"></a><span class="k">PRIVATE </span><span class="n">CalcWaterThermalTankMixed</span>
<a name="ln-590"></a><span class="k">PRIVATE </span><span class="n">CalcWaterThermalTankStratified</span>
<a name="ln-591"></a><span class="k">PRIVATE </span><span class="n">CalcHeatPumpWaterHeater</span>
<a name="ln-592"></a><span class="k">PRIVATE </span><span class="n">PLRResidualMixedTank</span>
<a name="ln-593"></a><span class="k">PRIVATE </span><span class="n">PLRResidualStratifiedTank</span>
<a name="ln-594"></a><span class="k">PRIVATE </span><span class="n">CalcDesuperheaterWaterHeater</span>
<a name="ln-595"></a><span class="k">PRIVATE </span><span class="n">PartLoadFactor</span>
<a name="ln-596"></a><span class="k">PRIVATE </span><span class="n">PlantMassFlowRatesFunc</span>
<a name="ln-597"></a><span class="k">PRIVATE </span><span class="n">MinePlantStructForInfo</span>
<a name="ln-598"></a><span class="k">PRIVATE </span><span class="n">SizeDemandSidePlantConnections</span>
<a name="ln-599"></a><span class="k">PRIVATE </span><span class="n">SizeSupplySidePlantConnections</span>
<a name="ln-600"></a><span class="k">PRIVATE </span><span class="n">SizeTankForDemandSide</span>
<a name="ln-601"></a><span class="k">PRIVATE </span><span class="n">SizeTankForSupplySide</span>
<a name="ln-602"></a><span class="k">PRIVATE </span><span class="n">SizeStandAloneWaterHeater</span>
<a name="ln-603"></a><span class="k">PRIVATE </span><span class="n">UpdateWaterThermalTank</span>
<a name="ln-604"></a><span class="k">PRIVATE </span><span class="n">ReportWaterThermalTank</span>
<a name="ln-605"></a><span class="k">PRIVATE </span><span class="n">CalcStandardRatings</span>
<a name="ln-606"></a><span class="k">PRIVATE </span><span class="n">ReportCWTankInits</span>
<a name="ln-607"></a><span class="k">PRIVATE </span><span class="n">FindStratifiedTankSensedTemp</span>
<a name="ln-608"></a>
<a name="ln-609"></a><span class="k">PUBLIC </span><span class="n">CalcTankTemp</span>
<a name="ln-610"></a><span class="k">PUBLIC </span><span class="n">CalcTempIntegral</span>
<a name="ln-611"></a>
<a name="ln-612"></a><span class="k">CONTAINS</span>
<a name="ln-613"></a>
<a name="ln-614"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-615"></a>
<a name="ln-616"></a><span class="k">SUBROUTINE </span><span class="n">SimWaterThermalTank</span><span class="p">(</span><span class="n">CompType</span><span class="p">,</span><span class="n">CompName</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span><span class="n">RunFlag</span><span class="p">,</span><span class="n">InitLoopEquip</span><span class="p">,</span>  <span class="p">&amp;</span>  <span class="c">!DSU</span>
<a name="ln-617"></a>                          <span class="n">MyLoad</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span><span class="p">)</span>
<a name="ln-618"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-619"></a>          <span class="c">!       AUTHOR         Brandon Anderson</span>
<a name="ln-620"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-621"></a>          <span class="c">!       MODIFIED       FSEC, July 2005</span>
<a name="ln-622"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-623"></a>
<a name="ln-624"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-625"></a>          <span class="c">! The main subroutine for simulating a water heater, heat pump water heater, or desuperheater</span>
<a name="ln-626"></a>          <span class="c">! heating coil.  This routine will:</span>
<a name="ln-627"></a>          <span class="c">!</span>
<a name="ln-628"></a>          <span class="c">! 1. Gets Input if necessary</span>
<a name="ln-629"></a>          <span class="c">! 2. Determines the load the water heater (or heat pump water heater) must support</span>
<a name="ln-630"></a>          <span class="c">! 3. Determine the type of water heater, heat pump water heater, or desuperheater</span>
<a name="ln-631"></a>          <span class="c">!    heating coil to be simulated</span>
<a name="ln-632"></a>          <span class="c">! 4. Calls simulation routines</span>
<a name="ln-633"></a>
<a name="ln-634"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-635"></a>          <span class="c">! Standard EnergyPlus methodology. Subroutine is called from PlantLoopEquipments</span>
<a name="ln-636"></a>
<a name="ln-637"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-638"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">KickOffSimulation</span>
<a name="ln-639"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">MakeUPPERCase</span>
<a name="ln-640"></a>
<a name="ln-641"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-642"></a>
<a name="ln-643"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-644"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompType</span>
<a name="ln-645"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-646"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-647"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">RunFlag</span> <span class="c">!unused1208</span>
<a name="ln-648"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">InitLoopEquip</span>
<a name="ln-649"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">MyLoad</span>
<a name="ln-650"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">MinCap</span>
<a name="ln-651"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">MaxCap</span>
<a name="ln-652"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">OptCap</span>
<a name="ln-653"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if First iteration of simulation</span>
<a name="ln-654"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="p">,</span> <span class="k">Optional</span>         <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-655"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="p">,</span> <span class="k">Optional</span>         <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-656"></a>
<a name="ln-657"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-658"></a>  <span class="kt">Logical</span><span class="p">,</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">OneTimeSetupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-659"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyOneTimeFlagWH</span>  <span class="c">! first pass log</span>
<a name="ln-660"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyTwoTimeFlagWH</span>  <span class="c">! second pass do input check</span>
<a name="ln-661"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyOneTimeFlagHP</span>  <span class="c">! first pass log</span>
<a name="ln-662"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyTwoTimeFlagHP</span>  <span class="c">! second pass do input check</span>
<a name="ln-663"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">tmpLoopNum</span>
<a name="ln-664"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">tmpLoopSideNum</span>
<a name="ln-665"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompNum</span>
<a name="ln-666"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TankNum</span>
<a name="ln-667"></a>
<a name="ln-668"></a>          <span class="c">! FLOW:</span>
<a name="ln-669"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterThermalTankInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-670"></a><span class="k">    CALL </span><span class="n">GetWaterThermalTankInput</span>
<a name="ln-671"></a>    <span class="n">GetWaterThermalTankInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-672"></a>  <span class="k">END IF</span>
<a name="ln-673"></a>
<a name="ln-674"></a><span class="k">  If</span> <span class="p">(</span><span class="n">OneTimeSetupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-675"></a><span class="k">    ALLOCATE</span> <span class="p">(</span><span class="n">MyOneTimeFlagWH</span> <span class="p">(</span> <span class="n">NumWaterThermalTank</span> <span class="p">))</span>
<a name="ln-676"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MyTwoTimeFlagWH</span> <span class="p">(</span> <span class="n">NumWaterThermalTank</span> <span class="p">))</span>
<a name="ln-677"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MyOneTimeFlagHP</span> <span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span> <span class="p">))</span>
<a name="ln-678"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MyTwoTimeFlagHP</span> <span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span> <span class="p">))</span>
<a name="ln-679"></a>    <span class="n">MyOneTimeFlagWH</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-680"></a>    <span class="n">MyTwoTimeFlagWH</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-681"></a>    <span class="n">MyOneTimeFlagHP</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-682"></a>    <span class="n">MyTwoTimeFlagHP</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-683"></a>    <span class="n">OneTimeSetupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-684"></a>  <span class="k">END IF</span>
<a name="ln-685"></a>
<a name="ln-686"></a>   <span class="c">! Find the correct Equipment</span>
<a name="ln-687"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompType</span> <span class="o">/=</span> <span class="n">TypeOf_HeatPumpWtrHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-688"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-689"></a><span class="k">      </span><span class="n">CompNum</span> <span class="o">=</span> <span class="n">FindItem</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterThermalTank</span><span class="p">)</span>
<a name="ln-690"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-691"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWaterThermalTank:  Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-692"></a>      <span class="n">ENDIF</span>
<a name="ln-693"></a>      <span class="n">CompIndex</span><span class="o">=</span><span class="n">CompNum</span>
<a name="ln-694"></a>    <span class="k">ELSE</span>
<a name="ln-695"></a><span class="k">      </span><span class="n">CompNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-696"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">&gt;</span> <span class="n">NumWaterThermalTank</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">CompNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-697"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWaterThermalTank:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-698"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-699"></a>                             <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumWaterThermalTank</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-700"></a>                             <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-701"></a>      <span class="n">ENDIF</span>
<a name="ln-702"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CheckWTTEquipName</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-703"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-704"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWaterThermalTank: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-705"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-706"></a>                              <span class="s1">&#39;, Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-707"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-708"></a>        <span class="n">ENDIF</span>
<a name="ln-709"></a>        <span class="n">CheckWTTEquipName</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-710"></a>      <span class="n">ENDIF</span>
<a name="ln-711"></a>    <span class="n">ENDIF</span>
<a name="ln-712"></a>  <span class="k">ELSE</span>
<a name="ln-713"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-714"></a><span class="k">      </span><span class="n">CompNum</span> <span class="o">=</span> <span class="n">FindItem</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumHeatPumpWaterHeater</span><span class="p">)</span>
<a name="ln-715"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-716"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWaterThermalTank:  Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-717"></a>      <span class="n">ENDIF</span>
<a name="ln-718"></a>      <span class="n">CompIndex</span><span class="o">=</span><span class="n">CompNum</span>
<a name="ln-719"></a>    <span class="k">ELSE</span>
<a name="ln-720"></a><span class="k">      </span><span class="n">CompNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-721"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CompNum</span> <span class="o">&gt;</span> <span class="n">NumWaterThermalTank</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">CompNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-722"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWaterThermalTank:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-723"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-724"></a>                             <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-725"></a>                             <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-726"></a>      <span class="n">ENDIF</span>
<a name="ln-727"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CheckHPWHEquipName</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-728"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-729"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimWaterThermalTank: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-730"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-731"></a>                              <span class="s1">&#39;, Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-732"></a>                              <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-733"></a>        <span class="n">ENDIF</span>
<a name="ln-734"></a>        <span class="n">CheckHPWHEquipName</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-735"></a>      <span class="n">ENDIF</span>
<a name="ln-736"></a>    <span class="n">ENDIF</span>
<a name="ln-737"></a>  <span class="n">ENDIF</span>
<a name="ln-738"></a>
<a name="ln-739"></a>
<a name="ln-740"></a>  <span class="c">! this case statement needs integerization.</span>
<a name="ln-741"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">CompType</span><span class="p">)</span>
<a name="ln-742"></a>
<a name="ln-743"></a><span class="c">! string comparisons to remove here.</span>
<a name="ln-744"></a><span class="c">! =========================  Water Heater and Chilled Water Storage</span>
<a name="ln-745"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">TypeOf_WtrHeaterMixed</span><span class="p">,</span> <span class="n">TypeOf_WtrHeaterStratified</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-746"></a>          <span class="n">TypeOf_ChilledWaterTankMixed</span><span class="p">,</span> <span class="n">TypeOf_ChilledWaterTankStratified</span><span class="p">)</span>
<a name="ln-747"></a>
<a name="ln-748"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-749"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-750"></a><span class="k">          CALL </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span><span class="p">)</span>
<a name="ln-751"></a>        <span class="k">ELSE</span>
<a name="ln-752"></a><span class="k">          CALL </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-753"></a>        <span class="n">ENDIF</span>
<a name="ln-754"></a>        <span class="k">Call </span><span class="n">MinePlantStructForInfo</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-755"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-756"></a><span class="k">          IF</span> <span class="p">(((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span> <span class="o">==</span> <span class="n">LoopNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-757"></a>                 <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">==</span> <span class="n">LoopSideNum</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-758"></a>              <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span>  <span class="o">==</span> <span class="n">LoopNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-759"></a>                     <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">==</span> <span class="n">LoopSideNum</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-760"></a><span class="k">            CALL </span><span class="n">SizeTankForDemandSide</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-761"></a>            <span class="k">CALL </span><span class="n">SizeDemandSidePlantConnections</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-762"></a>            <span class="k">CALL </span><span class="n">SizeSupplySidePlantConnections</span><span class="p">(</span><span class="n">CompNum</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span><span class="p">)</span>
<a name="ln-763"></a>            <span class="k">CALL </span><span class="n">SizeTankForSupplySide</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-764"></a>          <span class="k">ELSE</span>
<a name="ln-765"></a><span class="k">            RETURN</span>
<a name="ln-766"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-767"></a>        <span class="k">ELSE</span>
<a name="ln-768"></a><span class="k">          CALL </span><span class="n">SizeTankForDemandSide</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-769"></a>          <span class="k">CALL </span><span class="n">SizeDemandSidePlantConnections</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-770"></a>          <span class="k">CALL </span><span class="n">SizeSupplySidePlantConnections</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-771"></a>          <span class="k">CALL </span><span class="n">SizeTankForSupplySide</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-772"></a>        <span class="n">ENDIF</span>
<a name="ln-773"></a>
<a name="ln-774"></a>       <span class="c">! Calculate and report water heater standard ratings to EIO file (now that sizing is done)</span>
<a name="ln-775"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-776"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-777"></a><span class="k">            CALL </span><span class="n">CalcStandardRatings</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-778"></a>          <span class="k">ELSE</span>
<a name="ln-779"></a><span class="k">            CALL </span><span class="n">ReportCWTankInits</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-780"></a>          <span class="n">ENDIF</span>
<a name="ln-781"></a>        <span class="n">ENDIF</span>
<a name="ln-782"></a>        <span class="n">MinCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-783"></a>        <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-784"></a>        <span class="n">OptCap</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-785"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-786"></a><span class="k">          CALL </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span><span class="p">)</span>
<a name="ln-787"></a>        <span class="k">ELSE</span>
<a name="ln-788"></a><span class="k">          CALL </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-789"></a>        <span class="n">ENDIF</span>
<a name="ln-790"></a>        <span class="k">RETURN</span>
<a name="ln-791"></a><span class="k">      END IF</span>
<a name="ln-792"></a>
<a name="ln-793"></a><span class="k">      If</span> <span class="p">(</span><span class="n">MyOneTimeFlagWH</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span> <span class="k">THen</span>
<a name="ln-794"></a><span class="k">        </span><span class="n">MyOneTimeFlagWH</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span> <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-795"></a>      <span class="k">ELSE</span>
<a name="ln-796"></a><span class="k">        If</span> <span class="p">(</span><span class="n">MyTwoTimeFlagWH</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-797"></a><span class="k">          Call </span><span class="n">MinePlantStructForInfo</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>  <span class="c">! call it again to get control types filled out</span>
<a name="ln-798"></a>          <span class="n">MyTwoTimeFlagWH</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-799"></a>        <span class="n">ENDIF</span>
<a name="ln-800"></a>      <span class="n">ENDIF</span>
<a name="ln-801"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">UseSideLoadRequested</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-802"></a>      <span class="n">tmpLoopNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span>
<a name="ln-803"></a>      <span class="n">tmpLoopSideNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span>
<a name="ln-804"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">tmpLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">tmpLoopSideNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-805"></a><span class="k">         </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">UseCurrentFlowLock</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-806"></a>               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">tmpLoopNum</span><span class="p">)%</span><span class="n">Loopside</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">FlowLock</span>
<a name="ln-807"></a>      <span class="k">ELSE</span>
<a name="ln-808"></a><span class="k">         </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">UseCurrentFlowLock</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-809"></a>      <span class="n">ENDIF</span>
<a name="ln-810"></a>      <span class="n">tmpLoopNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span>
<a name="ln-811"></a>      <span class="n">tmpLoopSideNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span>
<a name="ln-812"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">tmpLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">tmpLoopSideNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-813"></a><span class="k">         </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">SourceCurrentFlowLock</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-814"></a>                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">tmpLoopNum</span><span class="p">)%</span><span class="n">Loopside</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">FlowLock</span>
<a name="ln-815"></a>      <span class="k">ELSE</span>
<a name="ln-816"></a><span class="k">         </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">SourceCurrentFlowLock</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-817"></a>      <span class="n">ENDIF</span>
<a name="ln-818"></a>      <span class="k">CALL </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-819"></a><span class="c">!       Plant connected water heaters may have a desuperheater heating coil attached</span>
<a name="ln-820"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-821"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">MixedWaterHeater</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-822"></a>               <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">MixedChilledWaterStorage</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-823"></a><span class="k">          CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-824"></a>        <span class="k">ELSE IF</span> <span class="p">(</span> <span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedWaterHeater</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-825"></a>               <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedChilledWaterStorage</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-826"></a><span class="k">          CALL </span><span class="n">CalcWaterThermalTankStratified</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-827"></a>        <span class="k">END IF</span>
<a name="ln-828"></a><span class="k">      </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-829"></a><span class="k">        CALL </span><span class="n">CalcDesuperheaterWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-830"></a>      <span class="k">END IF</span>
<a name="ln-831"></a><span class="k">      CALL </span><span class="n">UpdateWaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-832"></a>      <span class="k">CALL </span><span class="n">ReportWaterThermalTank</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-833"></a>
<a name="ln-834"></a><span class="c">! =========================  Heat Pump Water Heater</span>
<a name="ln-835"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">TypeOf_HeatPumpWtrHeater</span><span class="p">)</span>
<a name="ln-836"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-837"></a>        <span class="c">! CompNum is index to heatpump model, not tank so get the tank index</span>
<a name="ln-838"></a>        <span class="n">TankNum</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span>
<a name="ln-839"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-840"></a><span class="k">          CALL </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">TankNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span><span class="p">)</span>
<a name="ln-841"></a>        <span class="k">ELSE</span>
<a name="ln-842"></a><span class="k">          CALL </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">TankNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-843"></a>        <span class="n">ENDIF</span>
<a name="ln-844"></a>        <span class="k">Call </span><span class="n">MinePlantStructForInfo</span><span class="p">(</span><span class="n">TankNum</span><span class="p">)</span>
<a name="ln-845"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-846"></a><span class="k">          IF</span> <span class="p">(((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">TankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span> <span class="o">==</span> <span class="n">LoopNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-847"></a>                 <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">TankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">==</span> <span class="n">LoopSideNum</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-848"></a>              <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">TankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span>  <span class="o">==</span> <span class="n">LoopNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-849"></a>                     <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">TankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">==</span> <span class="n">LoopSideNum</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-850"></a><span class="k">            CALL </span><span class="n">SizeTankForDemandSide</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-851"></a>            <span class="k">CALL </span><span class="n">SizeDemandSidePlantConnections</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-852"></a>            <span class="k">CALL </span><span class="n">SizeSupplySidePlantConnections</span><span class="p">(</span><span class="n">TankNum</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span><span class="p">)</span>
<a name="ln-853"></a>            <span class="k">CALL </span><span class="n">SizeTankForSupplySide</span><span class="p">(</span><span class="n">TankNum</span><span class="p">)</span>
<a name="ln-854"></a>          <span class="k">ELSE</span>
<a name="ln-855"></a><span class="k">            RETURN</span>
<a name="ln-856"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-857"></a>        <span class="k">ELSE</span>
<a name="ln-858"></a><span class="k">          CALL </span><span class="n">SizeTankForDemandSide</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-859"></a>          <span class="k">CALL </span><span class="n">SizeDemandSidePlantConnections</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-860"></a>          <span class="k">CALL </span><span class="n">SizeSupplySidePlantConnections</span><span class="p">(</span><span class="n">TankNum</span><span class="p">)</span>
<a name="ln-861"></a>          <span class="k">CALL </span><span class="n">SizeTankForSupplySide</span><span class="p">(</span><span class="n">TankNum</span><span class="p">)</span>
<a name="ln-862"></a>        <span class="n">ENDIF</span>
<a name="ln-863"></a>
<a name="ln-864"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-865"></a><span class="k">          CALL </span><span class="n">CalcStandardRatings</span><span class="p">(</span><span class="n">TankNum</span><span class="p">)</span>
<a name="ln-866"></a>        <span class="n">ENDIF</span>
<a name="ln-867"></a>        <span class="n">MinCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-868"></a>        <span class="n">MaxCap</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Capacity</span>
<a name="ln-869"></a>        <span class="n">OptCap</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Capacity</span>
<a name="ln-870"></a>
<a name="ln-871"></a>        <span class="k">RETURN</span>
<a name="ln-872"></a><span class="k">      END IF</span>
<a name="ln-873"></a>
<a name="ln-874"></a><span class="k">      If</span> <span class="p">(</span><span class="n">MyOneTimeFlagHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span> <span class="k">THen</span>
<a name="ln-875"></a><span class="k">        </span><span class="n">MyOneTimeFlagHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span> <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-876"></a>      <span class="k">ELSE</span>
<a name="ln-877"></a><span class="k">        If</span> <span class="p">(</span><span class="n">MyTwoTimeFlagHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-878"></a><span class="k">          Call </span><span class="n">MinePlantStructForInfo</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">)</span>  <span class="c">! call it again to get control types filled out</span>
<a name="ln-879"></a>          <span class="n">MyTwoTimeFlagHP</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-880"></a>        <span class="n">ENDIF</span>
<a name="ln-881"></a>      <span class="n">ENDIF</span>
<a name="ln-882"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">)%</span><span class="n">UseSideLoadRequested</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-883"></a>      <span class="n">tmpLoopNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span>
<a name="ln-884"></a>      <span class="n">tmpLoopSideNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span>
<a name="ln-885"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">tmpLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">tmpLoopSideNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-886"></a><span class="k">         </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">)%</span><span class="n">UseCurrentFlowLock</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-887"></a>               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">tmpLoopNum</span><span class="p">)%</span><span class="n">Loopside</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">FlowLock</span>
<a name="ln-888"></a>      <span class="k">ELSE</span>
<a name="ln-889"></a><span class="k">         </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">)%</span><span class="n">UseCurrentFlowLock</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-890"></a>      <span class="n">ENDIF</span>
<a name="ln-891"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-892"></a><span class="k">        CALL </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span><span class="p">)</span>
<a name="ln-893"></a>      <span class="k">ELSE</span>
<a name="ln-894"></a><span class="k">        CALL </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-895"></a>      <span class="n">ENDIF</span>
<a name="ln-896"></a>      <span class="k">CALL </span><span class="n">CalcHeatPumpWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-897"></a>      <span class="k">CALL </span><span class="n">UpdateWaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">)</span>
<a name="ln-898"></a>      <span class="k">CALL </span><span class="n">ReportWaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span><span class="p">)</span>
<a name="ln-899"></a>
<a name="ln-900"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-901"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;SimWaterThermalTank: Invalid Water Thermal Tank Equipment Type=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CompType</span><span class="p">)))</span>
<a name="ln-902"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in Water Thermal Tank Equipment named = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-903"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-904"></a>
<a name="ln-905"></a>  <span class="k">END SELECT</span>
<a name="ln-906"></a>
<a name="ln-907"></a><span class="k">  RETURN</span>
<a name="ln-908"></a>
<a name="ln-909"></a><span class="k">END SUBROUTINE </span><span class="n">SimWaterThermalTank</span>
<a name="ln-910"></a>
<a name="ln-911"></a><span class="k">SUBROUTINE </span><span class="n">SimulateWaterHeaterStandAlone</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-912"></a>
<a name="ln-913"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-914"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-915"></a>          <span class="c">!       DATE WRITTEN   January 2004</span>
<a name="ln-916"></a>          <span class="c">!       MODIFIED       July 2005, FSEC - added HPWHs and desuperheater water heating coils</span>
<a name="ln-917"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-918"></a>
<a name="ln-919"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-920"></a>          <span class="c">! This subroutine acts an interface to SimWaterHeater for stand-alone water heaters with no plant connections,</span>
<a name="ln-921"></a>          <span class="c">! HPWHs not defined as zone equipment with no plant connections, and stand-alone water heaters with</span>
<a name="ln-922"></a>          <span class="c">! desuperheater heating coils with no plant connections.</span>
<a name="ln-923"></a>
<a name="ln-924"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-925"></a>          <span class="c">! The necessary control flags and dummy variables are set and passed into SimWaterHeater. This subroutine is</span>
<a name="ln-926"></a>          <span class="c">! called from NonZoneEquipmentManager.</span>
<a name="ln-927"></a>
<a name="ln-928"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-929"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">NumPlantLoops</span>
<a name="ln-930"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span>   <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">node</span>
<a name="ln-931"></a>  <span class="k">USE </span><span class="n">DataPlant</span>
<a name="ln-932"></a>
<a name="ln-933"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-934"></a>
<a name="ln-935"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-936"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterHeaterNum</span>
<a name="ln-937"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-938"></a>
<a name="ln-939"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-940"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">LocalRunFlag</span><span class="p">,</span><span class="n">LocalInitLoopEquip</span>     <span class="c">! local variables of similar name as others used in Sim modules</span>
<a name="ln-941"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MyLoad</span><span class="p">,</span> <span class="n">MinCap</span><span class="p">,</span> <span class="n">MaxCap</span><span class="p">,</span> <span class="n">OptCap</span>
<a name="ln-942"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TestNum</span>
<a name="ln-943"></a>
<a name="ln-944"></a>          <span class="c">! FLOW:</span>
<a name="ln-945"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterThermalTankInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-946"></a><span class="k">    CALL </span><span class="n">GetWaterThermalTankInput</span>
<a name="ln-947"></a>    <span class="n">GetWaterThermalTankInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-948"></a>  <span class="k">END IF</span>
<a name="ln-949"></a>
<a name="ln-950"></a>  <span class="c">! Only simulate stand-alone water heaters here.  Plant connected water heaters are called by the PlantLoopEquipments.</span>
<a name="ln-951"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">StandAlone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-952"></a><span class="k">    </span><span class="n">LocalRunFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-953"></a>    <span class="n">LocalInitLoopEquip</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-954"></a>    <span class="n">TestNum</span><span class="o">=</span><span class="n">WaterHeaterNum</span>
<a name="ln-955"></a>    <span class="k">CALL </span><span class="n">SimWaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">TestNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-956"></a>         <span class="n">LocalRunFlag</span><span class="p">,</span><span class="n">LocalInitLoopEquip</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-957"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TestNum</span> <span class="o">/=</span> <span class="n">WaterHeaterNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-958"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimulateWaterHeaterStandAlone: Input WaterHeater Num [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-959"></a>         <span class="s1">&#39;] does not match returned WaterHeater Num[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TestNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] Name=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-960"></a>         <span class="nb">trim</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-961"></a>    <span class="n">ENDIF</span>
<a name="ln-962"></a>
<a name="ln-963"></a><span class="c">! HPWHs with inlet air from a zone and not connected to a plant loop are simulated through a CALL from ZoneEquipmentManager.</span>
<a name="ln-964"></a><span class="c">! HPWHs that are plant connected are always simulated through a CALL from PlantLoopEquipments directly to SimWaterThermalTank.</span>
<a name="ln-965"></a>
<a name="ln-966"></a><span class="c">! NOTE: HPWHs with inlet air from a zone AND plant connected are not stand alone and are simulated in PlantLoopEquipments</span>
<a name="ln-967"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-968"></a><span class="c">!   Only HPWHs with inlet air from outdoors or scheduled HPWHs (not connected to a plant loop) are simulated here.</span>
<a name="ln-969"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">StandAlone</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-970"></a>       <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempOutsideAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-971"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempSchedule</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-972"></a><span class="k">      </span><span class="n">LocalRunFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-973"></a>      <span class="n">LocalInitLoopEquip</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-974"></a>      <span class="k">CALL </span><span class="n">SimWaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-975"></a>                          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-976"></a>                          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">,</span><span class="n">LocalRunFlag</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-977"></a>                          <span class="n">LocalInitLoopEquip</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-978"></a>    <span class="k">END IF</span>
<a name="ln-979"></a>
<a name="ln-980"></a><span class="c">! Only simulate stand-alone water heaters with desuperheater water heating coils here.  Plant connected water heaters</span>
<a name="ln-981"></a><span class="c">! with desuperheater water heating coils are called by PlantLoopEquipments.</span>
<a name="ln-982"></a>  <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-983"></a><span class="k">    IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">StandAlone</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-984"></a><span class="k">      </span><span class="n">LocalRunFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-985"></a>      <span class="n">LocalInitLoopEquip</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-986"></a>      <span class="n">TestNum</span><span class="o">=</span><span class="n">WaterHeaterNum</span>
<a name="ln-987"></a>      <span class="k">CALL </span><span class="n">SimWaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">TestNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-988"></a>           <span class="n">LocalRunFlag</span><span class="p">,</span><span class="n">LocalInitLoopEquip</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-989"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TestNum</span> <span class="o">/=</span> <span class="n">WaterHeaterNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-990"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimulateWaterHeaterStandAlone: Input WaterHeater Num [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-991"></a>           <span class="s1">&#39;] does not match returned WaterHeater Num[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TestNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] Name=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-992"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-993"></a>      <span class="n">ENDIF</span>
<a name="ln-994"></a>    <span class="k">END IF</span>
<a name="ln-995"></a><span class="k">  END IF</span>
<a name="ln-996"></a>
<a name="ln-997"></a><span class="k">  RETURN</span>
<a name="ln-998"></a>
<a name="ln-999"></a><span class="k">END SUBROUTINE </span><span class="n">SimulateWaterHeaterStandAlone</span>
<a name="ln-1000"></a>
<a name="ln-1001"></a><span class="k">SUBROUTINE </span><span class="n">SimHeatPumpWaterHeater</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">SensLoadMet</span><span class="p">,</span><span class="n">LatLoadMet</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">)</span>
<a name="ln-1002"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1003"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-1004"></a>          <span class="c">!       DATE WRITTEN   April 2005</span>
<a name="ln-1005"></a>          <span class="c">!       MODIFIED       Don Shirey, Aug 2009 (LatLoadMet)</span>
<a name="ln-1006"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1007"></a>
<a name="ln-1008"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1009"></a>          <span class="c">! This subroutine acts as an interface to SimWaterHeater.</span>
<a name="ln-1010"></a>          <span class="c">! HPWHs defined as zone equipment and not connected to a plant loop are called here by ZoneEquipmentManager</span>
<a name="ln-1011"></a>
<a name="ln-1012"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1013"></a>          <span class="c">! The necessary control flags and dummy variables are set and passed into SimWaterHeater.</span>
<a name="ln-1014"></a>
<a name="ln-1015"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1016"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-1017"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-1018"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">DoingSizing</span>
<a name="ln-1019"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span>
<a name="ln-1020"></a>
<a name="ln-1021"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1022"></a>
<a name="ln-1023"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1024"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-1025"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-1026"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">SensLoadMet</span> <span class="c">! sensible load met by this equipment and sent to zone, W</span>
<a name="ln-1027"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">LatLoadMet</span>  <span class="c">! net latent load met and sent to zone (kg/s), dehumid = negative</span>
<a name="ln-1028"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-1029"></a>
<a name="ln-1030"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1031"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">LocalRunFlag</span><span class="p">,</span><span class="n">LocalInitLoopEquip</span>     <span class="c">! local variables of similar name as others used in Sim modules</span>
<a name="ln-1032"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LocalFlowLock</span>                       <span class="c">! local variables of similar name as others used in sim modules</span>
<a name="ln-1033"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatPumpNum</span>
<a name="ln-1034"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MyLoad</span><span class="p">,</span> <span class="n">MinCap</span><span class="p">,</span> <span class="n">MaxCap</span><span class="p">,</span> <span class="n">OptCap</span>
<a name="ln-1035"></a>
<a name="ln-1036"></a>          <span class="c">! FLOW:</span>
<a name="ln-1037"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterThermalTankInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1038"></a><span class="k">    CALL </span><span class="n">GetWaterThermalTankInput</span>
<a name="ln-1039"></a>    <span class="n">GetWaterThermalTankInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1040"></a>  <span class="k">END IF</span>
<a name="ln-1041"></a>
<a name="ln-1042"></a>  <span class="c">! Find the correct Heat Pump Water Heater</span>
<a name="ln-1043"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1044"></a><span class="k">    </span><span class="n">HeatPumpNum</span>    <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumHeatPumpWaterHeater</span><span class="p">)</span>
<a name="ln-1045"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HeatPumpNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1046"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHeatPumpWaterHeater: Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-1047"></a>    <span class="n">ENDIF</span>
<a name="ln-1048"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">HeatPumpNum</span>
<a name="ln-1049"></a>  <span class="k">ELSE</span>
<a name="ln-1050"></a><span class="k">    </span><span class="n">HeatPumpNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-1051"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HeatPumpNum</span> <span class="o">&gt;</span> <span class="n">NumHeatPumpWaterHeater</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">HeatPumpNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1052"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimHeatPumpWaterHeater:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1053"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatPumpNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1054"></a>                          <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1055"></a>                          <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-1056"></a>    <span class="n">ENDIF</span>
<a name="ln-1057"></a>  <span class="k">END IF</span>
<a name="ln-1058"></a>
<a name="ln-1059"></a>  <span class="c">! Only simulate HPWHs specified as zone equipment and not connected to a plant loop.</span>
<a name="ln-1060"></a>  <span class="c">! HPWHs not defined as zone equipment with no plant connections are simulated in NonZoneEquipmentManager.</span>
<a name="ln-1061"></a>  <span class="c">! Plant connected HPWHs are called by PlantLoopEquipments (but only those on supply side ).</span>
<a name="ln-1062"></a>  <span class="n">SensLoadMet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1063"></a>  <span class="n">LatLoadMet</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1064"></a>
<a name="ln-1065"></a>  <span class="n">LocalRunFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1066"></a>  <span class="n">LocalFlowLock</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! .TRUE.</span>
<a name="ln-1067"></a>  <span class="n">LocalInitLoopEquip</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1068"></a>
<a name="ln-1069"></a><span class="c">! HPWH will not be included in sizing calculations, fan is initialized only during BeginEnvrnFlag (FALSE during sizing)</span>
<a name="ln-1070"></a><span class="c">! (fan will be turned off during Standard Ratings procedure yielding incorrect results)</span>
<a name="ln-1071"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DoingSizing</span><span class="p">)</span><span class="k">RETURN</span>
<a name="ln-1072"></a>
<a name="ln-1073"></a><span class="c">! For HPWHs, StandAlone means not connected to a plant loop (use nodes are not used, source nodes are connected to a HPWH)</span>
<a name="ln-1074"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">StandAlone</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1075"></a><span class="k">    CALL </span><span class="n">SimWaterThermalTank</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="n">HeatPumpNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1076"></a>                        <span class="n">LocalRunFlag</span><span class="p">,</span><span class="n">LocalInitLoopEquip</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">MinCap</span><span class="p">,</span><span class="n">MaxCap</span><span class="p">,</span><span class="n">OptCap</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-1077"></a>    <span class="n">SensLoadMet</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">HPWaterHeaterSensibleCapacity</span>
<a name="ln-1078"></a>    <span class="n">LatLoadMet</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">HPWaterHeaterLatentCapacity</span>
<a name="ln-1079"></a>  <span class="k">ELSE</span>
<a name="ln-1080"></a>    <span class="c">! HPWH is plant connected and will get simulated when called from plant SimWaterThermalTank, but need to update loads met here</span>
<a name="ln-1081"></a>    <span class="n">SensLoadMet</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">HPWaterHeaterSensibleCapacity</span>
<a name="ln-1082"></a>    <span class="n">LatLoadMet</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">HPWaterHeaterLatentCapacity</span>
<a name="ln-1083"></a>  <span class="k">END IF</span>
<a name="ln-1084"></a>
<a name="ln-1085"></a><span class="k">  RETURN</span>
<a name="ln-1086"></a>
<a name="ln-1087"></a><span class="k">END SUBROUTINE </span><span class="n">SimHeatPumpWaterHeater</span>
<a name="ln-1088"></a>
<a name="ln-1089"></a><span class="k">SUBROUTINE </span><span class="n">CalcWaterThermalTankZoneGains</span>
<a name="ln-1090"></a>
<a name="ln-1091"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1092"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-1093"></a>          <span class="c">!       DATE WRITTEN   March 2005</span>
<a name="ln-1094"></a>          <span class="c">!       MODIFIED       B. Griffith November 2011, new internal gains structure</span>
<a name="ln-1095"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1096"></a>
<a name="ln-1097"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1098"></a>          <span class="c">! Calculates the zone internal gains due to water heater skin losses during sizing.</span>
<a name="ln-1099"></a>          <span class="c">! initilizes gains to zone at begin environment.</span>
<a name="ln-1100"></a>
<a name="ln-1101"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1102"></a>          <span class="c">! Sums the tank losses from all of the water heaters in the zone to add as a gain to the zone.</span>
<a name="ln-1103"></a>          <span class="c">! Now used to determine tank losses during sizing.  Internal gains are summed in a centralized way now</span>
<a name="ln-1104"></a>          <span class="c">!</span>
<a name="ln-1105"></a>
<a name="ln-1106"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1107"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">DoingSizing</span>
<a name="ln-1108"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-1109"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-1110"></a>
<a name="ln-1111"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1112"></a>
<a name="ln-1113"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1114"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-1115"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>
<a name="ln-1116"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1117"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankTemp</span>
<a name="ln-1118"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QLossToZone</span>
<a name="ln-1119"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SchIndex</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a>          <span class="c">! FLOW:</span>
<a name="ln-1122"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterThermalTank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1123"></a>
<a name="ln-1124"></a><span class="k">   IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DoingSizing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1125"></a><span class="k">     RETURN</span>
<a name="ln-1126"></a><span class="k">   ELSE</span>
<a name="ln-1127"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">GetWaterThermalTankInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1128"></a><span class="k">       CALL </span><span class="n">GetWaterThermalTankInput</span>
<a name="ln-1129"></a>       <span class="n">GetWaterThermalTankInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1130"></a>     <span class="k">END IF</span>
<a name="ln-1131"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">NumWaterThermalTank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Return</span>
<a name="ln-1132"></a><span class="k">   </span><span class="n">ENDIF</span>
<a name="ln-1133"></a>
<a name="ln-1134"></a>  <span class="n">ENDIF</span>
<a name="ln-1135"></a>
<a name="ln-1136"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1137"></a><span class="k">    </span><span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">AmbientZoneGain</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1138"></a>    <span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">FuelEnergy</span>           <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1139"></a>    <span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1140"></a>    <span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">OnCycParaFuelEnergy</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1141"></a>    <span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1142"></a>  <span class="n">ENDIF</span>
<a name="ln-1143"></a>
<a name="ln-1144"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1145"></a>
<a name="ln-1146"></a>  <span class="k">DO </span><span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterThermalTank</span>
<a name="ln-1147"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1148"></a><span class="k">    </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span>
<a name="ln-1149"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">DoingSizing</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1150"></a>      <span class="c">! Initialize tank temperature to setpoint</span>
<a name="ln-1151"></a>      <span class="c">! (use HPWH or Desuperheater heating coil set point if applicable)</span>
<a name="ln-1152"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1153"></a><span class="k">        </span><span class="n">SchIndex</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-1154"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1155"></a><span class="k">        </span><span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-1156"></a>      <span class="k">ELSE</span>
<a name="ln-1157"></a><span class="k">        </span><span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-1158"></a>      <span class="k">END IF</span>
<a name="ln-1159"></a>
<a name="ln-1160"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SchIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1161"></a><span class="k">        </span><span class="n">TankTemp</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchIndex</span><span class="p">)</span>
<a name="ln-1162"></a>      <span class="k">ELSE</span>
<a name="ln-1163"></a><span class="k">        </span><span class="n">TankTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0d0</span>
<a name="ln-1164"></a>      <span class="k">END IF</span>
<a name="ln-1165"></a><span class="k">      SELECT CASE</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">)</span>
<a name="ln-1166"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-1167"></a>          <span class="n">QLossToZone</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1168"></a>                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycLossFracToZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1169"></a>                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1170"></a>                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossFracToZone</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1171"></a>                        <span class="p">(</span><span class="n">TankTemp</span><span class="o">-</span><span class="n">MAT</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">))</span>
<a name="ln-1172"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-1173"></a>          <span class="n">QLossToZone</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1174"></a>                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossFracToZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1175"></a>                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1176"></a>                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossFracToZone</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1177"></a>                        <span class="p">(</span><span class="n">TankTemp</span><span class="o">-</span><span class="n">MAT</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">))</span>
<a name="ln-1178"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">MixedChilledWaterStorage</span><span class="p">)</span>
<a name="ln-1179"></a>          <span class="n">QLossToZone</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span> <span class="o">*</span>          <span class="p">&amp;</span>
<a name="ln-1180"></a>                          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossFracToZone</span>   <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1181"></a>                         <span class="p">(</span><span class="n">TankTemp</span><span class="o">-</span><span class="n">MAT</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1182"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedChilledWaterStorage</span><span class="p">)</span>
<a name="ln-1183"></a>          <span class="n">QLossToZone</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span>  <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1184"></a>                          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossFracToZone</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1185"></a>                         <span class="p">(</span><span class="n">TankTemp</span><span class="o">-</span><span class="n">MAT</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1186"></a>      <span class="k">END SELECT</span>
<a name="ln-1187"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientZoneGain</span> <span class="o">=</span> <span class="n">QLossToZone</span>
<a name="ln-1188"></a>    <span class="k">END IF</span>
<a name="ln-1189"></a><span class="k">  END DO</span>
<a name="ln-1190"></a>
<a name="ln-1191"></a><span class="k">  RETURN</span>
<a name="ln-1192"></a>
<a name="ln-1193"></a><span class="k">END SUBROUTINE </span><span class="n">CalcWaterThermalTankZoneGains</span>
<a name="ln-1194"></a>
<a name="ln-1195"></a>
<a name="ln-1196"></a><span class="k">SUBROUTINE </span><span class="n">GetWaterThermalTankInput</span>
<a name="ln-1197"></a>
<a name="ln-1198"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1199"></a>          <span class="c">!       AUTHOR         Dan Fisher and Brandon Anderson</span>
<a name="ln-1200"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-1201"></a>          <span class="c">!       MODIFIED       R. Raustad, June 2005, added HPWH and desuperheater water heating coils</span>
<a name="ln-1202"></a>          <span class="c">!                      B. Griffith, Oct. 2007 extensions for indirect water heaters</span>
<a name="ln-1203"></a>          <span class="c">!                      B. Griffith, Feb. 2008 extensions for autosizing water heaters</span>
<a name="ln-1204"></a>          <span class="c">!                      BG Mar 2009.  Trap for bad heater height input for stratefied water heater CR7718</span>
<a name="ln-1205"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1206"></a>
<a name="ln-1207"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1208"></a>          <span class="c">! Gets the water heater, HPWH, and/or desuperheater heating coil input from the input file.</span>
<a name="ln-1209"></a>
<a name="ln-1210"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1211"></a>          <span class="c">! Standard EnergyPlus methodology.</span>
<a name="ln-1212"></a>
<a name="ln-1213"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1214"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">,</span> <span class="n">AutoCalculate</span><span class="p">,</span> <span class="n">ScheduleAlwaysOn</span><span class="p">,</span> <span class="n">outputfiledebug</span>
<a name="ln-1215"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1216"></a>                                <span class="n">SetupOutputVariable</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-1217"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-1218"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-1219"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-1220"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span><span class="p">,</span> <span class="n">CheckScheduleValueMinMax</span>
<a name="ln-1221"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span><span class="p">,</span> <span class="n">SetUpCompSets</span>
<a name="ln-1222"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyRhoAirFnPbTdbW</span>
<a name="ln-1223"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-1224"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span><span class="p">,</span> <span class="n">NodeType_Air</span><span class="p">,</span> <span class="n">NodeType_Water</span><span class="p">,</span> <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1225"></a>                                <span class="n">NodeConnectionType_ZoneExhaust</span><span class="p">,</span>  <span class="n">NodeConnectionType_ReliefAir</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! ,NodeConnectionType_Internal</span>
<a name="ln-1226"></a>                                <span class="n">NodeConnectionType_OutsideAir</span><span class="p">,</span> <span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1227"></a>                                <span class="n">ObjectIsParent</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span>
<a name="ln-1228"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveIndex</span><span class="p">,</span> <span class="n">GetCurveType</span><span class="p">,</span> <span class="n">CurveValue</span>
<a name="ln-1229"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span><span class="p">,</span> <span class="n">IntGainTypeOf_WaterHeaterMixed</span><span class="p">,</span> <span class="n">IntGainTypeOf_WaterHeaterStratified</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1230"></a>                                <span class="n">IntGainTypeOf_ThermalStorageChilledWaterMixed</span><span class="p">,</span> <span class="n">IntGainTypeOf_ThermalStorageChilledWaterStratified</span>
<a name="ln-1231"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoil</span><span class="p">,</span> <span class="n">GetDXCoilIndex</span><span class="p">,</span> <span class="n">NumDXCoils</span>
<a name="ln-1232"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span>  <span class="n">RoundSigDigits</span>
<a name="ln-1233"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-1234"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-1235"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanType</span><span class="p">,</span> <span class="n">GetFanIndex</span><span class="p">,</span> <span class="n">GetFanVolFlow</span>
<a name="ln-1236"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-1237"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneEquipConfig</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">,</span> <span class="n">ZoneEquipInputsFilled</span><span class="p">,</span> <span class="n">GetZoneEquipmentData</span>
<a name="ln-1238"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span>
<a name="ln-1239"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">FanType_SimpleOnOff</span><span class="p">,</span> <span class="n">BlowThru</span><span class="p">,</span> <span class="n">DrawThru</span>
<a name="ln-1240"></a>  <span class="k">USE </span><span class="n">OutAirNodeManager</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">,</span><span class="n">CheckAndAddAirNodeNumber</span>
<a name="ln-1241"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantSizData</span><span class="p">,</span> <span class="n">NumPltSizInput</span>
<a name="ln-1242"></a>  <span class="k">USE </span><span class="n">RefrigeratedCase</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckRefrigerationInput</span>
<a name="ln-1243"></a>  <span class="k">USE </span><span class="n">GlobalNames</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerifyUniqueCoilName</span>
<a name="ln-1244"></a>
<a name="ln-1245"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1246"></a>
<a name="ln-1247"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1248"></a>          <span class="c">! na</span>
<a name="ln-1249"></a>
<a name="ln-1250"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1251"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-1252"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span> <span class="o">=</span> <span class="s1">&#39;GetWaterThermalTankInput: &#39;</span>
<a name="ln-1253"></a>
<a name="ln-1254"></a>
<a name="ln-1255"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-1256"></a>
<a name="ln-1257"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-1258"></a>  <span class="k">TYPE </span><span class="n">WaterHeaterSaveNodes</span>
<a name="ln-1259"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletNodeName1</span>      <span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1260"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletNodeName1</span>     <span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1261"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletNodeName2</span>      <span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1262"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletNodeName2</span>     <span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1263"></a>  <span class="k">END TYPE</span>
<a name="ln-1264"></a>
<a name="ln-1265"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1266"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>          <span class="c">! Index to WATER HEATER:*</span>
<a name="ln-1267"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">WHsizingNum</span>             <span class="c">! Index to Water Heater:Sizing, for the IDF objects--not data storage</span>
<a name="ln-1268"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NodeNum</span>                 <span class="c">! Index to a stratified thermal node</span>
<a name="ln-1269"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">CheckWaterHeaterNum</span>     <span class="c">! Used to search WATER HEATER:* to find association with HP Water Heater</span>
<a name="ln-1270"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">DesuperheaterNum</span>        <span class="c">! Index to Coil:WaterHeating:Desuperheater</span>
<a name="ln-1271"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">HPWaterHeaterNum</span>        <span class="c">! Index to HEAT PUMP:WATER HEATER</span>
<a name="ln-1272"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">HeatingSourceNum</span>        <span class="c">! Index to DX cooling coil (heat source for desuperheater)</span>
<a name="ln-1273"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumAlphas</span>               <span class="c">! Number of elements in the alpha array</span>
<a name="ln-1274"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">NumNums</span>                 <span class="c">! Number of elements in the numeric array</span>
<a name="ln-1275"></a><span class="c">!unused1208  INTEGER                     :: NumArgs                 ! Number of elements in the object (alpha + numeric)</span>
<a name="ln-1276"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">RackNum</span>                 <span class="c">! Index to refrigrated display case rack</span>
<a name="ln-1277"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">CondNum</span>                 <span class="c">! Index to refrigration condenser</span>
<a name="ln-1278"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">DXCoilNum</span>               <span class="c">! Index to DX coils</span>
<a name="ln-1279"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">IOStat</span>                  <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-1280"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsNotOK</span>                 <span class="c">! Flag to verify name</span>
<a name="ln-1281"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsBlank</span>                 <span class="c">! Flag for blank name</span>
<a name="ln-1282"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">IsValid</span>                 <span class="c">! Flag for validating PLF curve, OutsideAirNode</span>
<a name="ln-1283"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>   <span class="c">! Flag for any error found during GetWaterThermalTankInput</span>
<a name="ln-1284"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span><span class="kd">::</span> <span class="n">FanInletNode</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>      <span class="c">! Used to set up comp set</span>
<a name="ln-1285"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span><span class="kd">::</span> <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! Used to set up comp set</span>
<a name="ln-1286"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span><span class="kd">::</span> <span class="n">CoilInletNode</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>     <span class="c">! Used to set up comp set</span>
<a name="ln-1287"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span><span class="kd">::</span> <span class="n">CoilOutletNode</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>    <span class="c">! Used to set up comp set</span>
<a name="ln-1288"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">SupAirIn</span>  <span class="o">=</span> <span class="mi">0</span>           <span class="c">! Used for error checking HPWHs</span>
<a name="ln-1289"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">ExhAirOut</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c">! Used for error checking HPWHs</span>
<a name="ln-1290"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">FoundInletNode</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Used for error checking HPWHs</span>
<a name="ln-1291"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">FoundOutletNode</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Used for error checking HPWHs</span>
<a name="ln-1292"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">0</span>               <span class="c">! Used for error checking HPWHs</span>
<a name="ln-1293"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">ValidScheduleValue</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Used for error checking HPWH&#39;s inlet air mixer schedule</span>
<a name="ln-1294"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">ZoneEquipConfigNum</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Used to determine if HPWH tank is in a Zone Equipment List (ZEL)</span>
<a name="ln-1295"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">ZoneEquipListNum</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Used to determine if HPWH tank is in a Zone Equipment List</span>
<a name="ln-1296"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">EquipmentTypeNum</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Used to determine if HPWH tank is in a Zone Equipment List</span>
<a name="ln-1297"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">FoundTankInList</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! Used to determine if HPWH tank is listed in a Zone Equipment List</span>
<a name="ln-1298"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">TankNotLowestPriority</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Used to determine if HPWH tank is prioritized correctly in ZEL</span>
<a name="ln-1299"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">TankCoolingPriority</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Used to determine if a HPWH tank is prioritized correctly in ZEL</span>
<a name="ln-1300"></a>  <span class="kt">INTEGER</span>                     <span class="kd">::</span> <span class="n">TankHeatingPriority</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Used to determine if a HPWH tank is prioritized correctly in ZEL</span>
<a name="ln-1301"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">DXCoilErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Used for error checking DX coils used with HPWHs</span>
<a name="ln-1302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">FanVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! Used for error checking fans used with HPWHs</span>
<a name="ln-1303"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! Used for error checking used with HPWHs</span>
<a name="ln-1304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">HEffFTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! Used for error checking desuperheater heating coils</span>
<a name="ln-1305"></a>  <span class="kt">LOGICAL</span>                     <span class="kd">::</span> <span class="n">Okay</span>
<a name="ln-1306"></a>
<a name="ln-1307"></a>  <span class="c">! Following allow for temporary storage of character strings but not saved in main structure</span>
<a name="ln-1308"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">WaterHeaterSaveNodes</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">HPWHSaveNodeNames</span>  <span class="c">! temporary for HPWH node names used in later checks</span>
<a name="ln-1309"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">WaterHeaterSaveNodes</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WHSaveNodeNames</span>    <span class="c">! temporary for WH node names used in later checks</span>
<a name="ln-1310"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">WaterHeaterSaveNodes</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CoilSaveNodeNames</span>  <span class="c">! temporary for coil node names used in later checks</span>
<a name="ln-1311"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local fluid density</span>
<a name="ln-1312"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a>          <span class="c">! FLOW:</span>
<a name="ln-1315"></a>
<a name="ln-1316"></a>  <span class="c">! Make sure refrigeration input is gotten before this input</span>
<a name="ln-1317"></a>  <span class="k">CALL </span><span class="n">CheckRefrigerationInput</span>
<a name="ln-1318"></a>
<a name="ln-1319"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterThermalTankInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1320"></a><span class="k">    </span><span class="n">NumWaterHeaterMixed</span>       <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cMixedWHModuleObj</span><span class="p">)</span>
<a name="ln-1321"></a>    <span class="n">NumWaterHeaterStratified</span>  <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cStratifiedWHModuleObj</span><span class="p">)</span>
<a name="ln-1322"></a>    <span class="n">NumChilledWaterMixed</span>      <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cMixedCWTankModuleObj</span><span class="p">)</span>
<a name="ln-1323"></a>    <span class="n">NumChilledWaterStratified</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cStratifiedCWTankModuleObj</span><span class="p">)</span>
<a name="ln-1324"></a>    <span class="n">NumWaterThermalTank</span>       <span class="o">=</span> <span class="n">NumWaterHeaterMixed</span> <span class="o">+</span> <span class="n">NumWaterHeaterStratified</span> <span class="p">&amp;</span>
<a name="ln-1325"></a>                                 <span class="o">+</span> <span class="n">NumChilledWaterMixed</span> <span class="o">+</span> <span class="n">NumChilledWaterStratified</span>
<a name="ln-1326"></a>    <span class="n">NumHeatPumpWaterHeater</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;WaterHeater:HeatPump&#39;</span><span class="p">)</span>
<a name="ln-1327"></a>    <span class="n">NumWaterHeaterDesuperheater</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:WaterHeating:Desuperheater&#39;</span><span class="p">)</span>
<a name="ln-1328"></a>
<a name="ln-1329"></a>
<a name="ln-1330"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterThermalTank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1331"></a>      <span class="c">! Write water heater header for EIO</span>
<a name="ln-1332"></a>      <span class="k">If</span> <span class="p">((</span><span class="n">NumWaterHeaterMixed</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">NumWaterHeaterStratified</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">))</span> <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span>
<a name="ln-1333"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">721</span><span class="p">)</span>
<a name="ln-1334"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterHeaterStratified</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">722</span><span class="p">)</span>
<a name="ln-1335"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumChilledWaterMixed</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">725</span> <span class="p">)</span>
<a name="ln-1336"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumChilledWaterStratified</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span> <span class="mi">726</span><span class="p">)</span>
<a name="ln-1337"></a>
<a name="ln-1338"></a>
<a name="ln-1339"></a>    <span class="k">END IF</span>
<a name="ln-1340"></a>
<a name="ln-1341"></a><span class="mi">720</span>  <span class="k">FORMAT</span><span class="p">(</span> <span class="s1">&#39;! &lt;Water Heater Information&gt;,Type,Name,Volume {m3},Maximum Capacity {W},Standard Rated Recovery Efficiency, &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1342"></a>              <span class="s1">&#39;Standard Rated Energy Factor&#39;</span><span class="p">)</span>
<a name="ln-1343"></a><span class="mi">721</span>  <span class="k">FORMAT</span><span class="p">(</span> <span class="s1">&#39;! &lt;Heat Pump Water Heater Information&gt;,Type,Name,Volume {m3},Maximum Capacity {W},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1344"></a>             <span class="s1">&#39;Standard Rated Recovery Efficiency,Standard Rated Energy Factor,&quot;DX Coil Total Cooling Rate {W, HPWH Only}&quot;&#39;</span><span class="p">)</span>
<a name="ln-1345"></a><span class="mi">722</span>  <span class="k">FORMAT</span><span class="p">(</span> <span class="s1">&#39;! &lt;Water Heater Stratified Node Information&gt;,Node Number,Height {m},Volume {m3},Maximum Capacity {W},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1346"></a>             <span class="s1">&#39;Off-Cycle UA {W/K},On-Cycle UA {W/K},Number Of Inlets,Number Of Outlets&#39;</span><span class="p">)</span>
<a name="ln-1347"></a><span class="mi">725</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;! &lt;Chilled Water Tank Information&gt;,Type,Name,Volume {m3},Use Side Design Flow Rate {m3/s}, &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1348"></a>             <span class="s1">&#39;Source Side Design Flow Rate {m3/s}&#39;</span><span class="p">)</span>
<a name="ln-1349"></a><span class="mi">726</span>  <span class="k">FORMAT</span><span class="p">(</span> <span class="s1">&#39;! &lt;Chilled Water Tank Stratified Node Information&gt;,Node Number,Height {m},Volume {m3},&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1350"></a>             <span class="s1">&#39;UA {W/K},Number Of Inlets,Number Of Outlets&#39;</span><span class="p">)</span>
<a name="ln-1351"></a>
<a name="ln-1352"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterThermalTank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1353"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">NumWaterThermalTank</span><span class="p">))</span>
<a name="ln-1354"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">NumWaterThermalTank</span><span class="p">))</span>
<a name="ln-1355"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckWTTEquipName</span><span class="p">(</span><span class="n">NumWaterThermalTank</span><span class="p">))</span>
<a name="ln-1356"></a>      <span class="n">CheckWTTEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1357"></a>    <span class="n">ENDIF</span>
<a name="ln-1358"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1359"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span><span class="p">))</span>
<a name="ln-1360"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyHPSizeFlag</span><span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span><span class="p">))</span>
<a name="ln-1361"></a>      <span class="n">MyHPSizeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1362"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckHPWHEquipName</span><span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span><span class="p">))</span>
<a name="ln-1363"></a>      <span class="n">CheckHPWHEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1364"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span><span class="p">))</span>
<a name="ln-1365"></a>    <span class="k">END IF</span>
<a name="ln-1366"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">NumWaterHeaterDesuperheater</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1367"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">NumWaterHeaterDesuperheater</span><span class="p">))</span>
<a name="ln-1368"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ValidSourceType</span><span class="p">(</span><span class="n">NumWaterHeaterDesuperheater</span><span class="p">))</span>
<a name="ln-1369"></a>      <span class="n">ValidSourceType</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1370"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CoilSaveNodeNames</span><span class="p">(</span><span class="n">NumWaterHeaterDesuperheater</span><span class="p">))</span>
<a name="ln-1371"></a>    <span class="n">ENDIF</span>
<a name="ln-1372"></a>
<a name="ln-1373"></a><span class="c">!!!=======   Get Coil:WaterHeating:Desuperheater ======================================================================</span>
<a name="ln-1374"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterHeaterDesuperheater</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1375"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:WaterHeating:Desuperheater&#39;</span>
<a name="ln-1376"></a>      <span class="k">DO </span><span class="n">DesuperheaterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterHeaterDesuperheater</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">DesuperheaterNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1379"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1380"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1381"></a>
<a name="ln-1382"></a>        <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1383"></a>        <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1384"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WaterHeaterDesuperheater</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">DesuperheaterNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1385"></a>                        <span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1386"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1387"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1388"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1389"></a>        <span class="k">END IF</span>
<a name="ln-1390"></a><span class="k">        CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1391"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1392"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1393"></a>        <span class="n">ENDIF</span>
<a name="ln-1394"></a>        <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1395"></a>        <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span> <span class="o">=</span> <span class="n">cCurrentModuleObject</span>
<a name="ln-1396"></a>
<a name="ln-1397"></a><span class="c">!       convert availability schedule name to pointer</span>
<a name="ln-1398"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-1399"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1400"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1401"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1402"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1403"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1404"></a>          <span class="k">END IF</span>
<a name="ln-1405"></a><span class="k">        ELSE</span>
<a name="ln-1406"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1407"></a>        <span class="k">END IF</span>
<a name="ln-1408"></a>
<a name="ln-1409"></a><span class="c">!       convert schedule name to pointer</span>
<a name="ln-1410"></a>        <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1411"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1412"></a><span class="k">           CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1413"></a>           <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1414"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1415"></a>        <span class="k">END IF</span>
<a name="ln-1416"></a>
<a name="ln-1417"></a><span class="k">        </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DeadbandTempDiff</span>       <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1418"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DeadbandTempDiff</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span>  <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1419"></a>           <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DeadbandTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1420"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1421"></a>                              <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 0 and &lt;= 20. &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1422"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1423"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1424"></a>        <span class="k">END IF</span>
<a name="ln-1425"></a>
<a name="ln-1426"></a>        <span class="c">!WaterHeaterDesuperheater(DesuperheaterNum)%HeatReclaimRecoveryEff       = rNumericArgs(2)</span>
<a name="ln-1427"></a>        <span class="c">! Error limits on heat reclaim efficiency applied after source type identified</span>
<a name="ln-1428"></a>
<a name="ln-1429"></a>        <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RatedInletWaterTemp</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1430"></a>        <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RatedOutdoorAirTemp</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1431"></a>        <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">MaxInletWaterTemp</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1432"></a>
<a name="ln-1433"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1434"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTemp</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-1435"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTemp</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1436"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1437"></a>                                 <span class="s1">&#39;:  &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1438"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1439"></a>          <span class="k">ELSE</span>
<a name="ln-1440"></a>            <span class="c">! Verify Curve Object, only legal type is Quadratic</span>
<a name="ln-1441"></a>            <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTemp</span><span class="p">))</span>
<a name="ln-1442"></a>
<a name="ln-1443"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;BIQUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-1444"></a>
<a name="ln-1445"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1446"></a><span class="k">                </span><span class="n">HEffFTemp</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1447"></a>                                           <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RatedInletWaterTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1448"></a>                                           <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RatedOutdoorAirTemp</span><span class="p">)))</span>
<a name="ln-1449"></a>                <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HEffFTemp</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.05d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1450"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1451"></a>                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-1452"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; should be normalized &#39;</span><span class="p">)</span>
<a name="ln-1453"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; to 1.0 at the rating point. Curve output at the rating point = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1454"></a>                                         <span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HEffFTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1455"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The simulation continues using the user-specified curve.&#39;</span><span class="p">)</span>
<a name="ln-1456"></a>                <span class="k">END IF</span>
<a name="ln-1457"></a><span class="k">              END IF</span>
<a name="ln-1458"></a>
<a name="ln-1459"></a><span class="k">            CASE </span><span class="n">DEFAULT</span>
<a name="ln-1460"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1461"></a>                                   <span class="s1">&#39;&quot; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; type for this object = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1462"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTemp</span><span class="p">)))</span>
<a name="ln-1463"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1464"></a>            <span class="k">END SELECT</span>
<a name="ln-1465"></a><span class="k">          END IF</span>
<a name="ln-1466"></a><span class="k">        END IF</span>
<a name="ln-1467"></a>
<a name="ln-1468"></a><span class="k">        </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">WaterInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1469"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1470"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1471"></a>
<a name="ln-1472"></a>        <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">WaterOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1473"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1474"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1475"></a>
<a name="ln-1476"></a>        <span class="n">CoilSaveNodeNames</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">InletNodeName1</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1477"></a>        <span class="n">CoilSaveNodeNames</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1478"></a>
<a name="ln-1479"></a>        <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankType</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1480"></a>
<a name="ln-1481"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">,</span><span class="n">cMixedWHModuleObj</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1482"></a>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">,</span><span class="n">cStratifiedWHModuleObj</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1483"></a>
<a name="ln-1484"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1485"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Desuperheater can only be used with &#39;</span><span class="o">//</span><span class="n">cMixedWHModuleObj</span><span class="o">//</span><span class="s1">&#39; or &#39;</span><span class="o">//</span><span class="n">cStratifiedWHModuleObj</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-1486"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1487"></a>        <span class="k">END IF</span>
<a name="ln-1488"></a>
<a name="ln-1489"></a><span class="k">        </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1490"></a>
<a name="ln-1491"></a><span class="c">!       get heat reclaim object</span>
<a name="ln-1492"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1493"></a>           <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1494"></a>           <span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Coil:Cooling:DX:TwoStageWithHumidityControlMode&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1495"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatingSourceType</span>  <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1496"></a>          <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatingSourceName</span>  <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1497"></a><span class="c">!         load DX coil structure for connection to desuperheater heating coil (refrigerated rack have been loaded)</span>
<a name="ln-1498"></a>          <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1499"></a>          <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatingSourceName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1500"></a>                              <span class="n">HeatingSourceNum</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">,</span> <span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-1501"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1502"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1503"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1504"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1505"></a>          <span class="n">ENDIF</span>
<a name="ln-1506"></a>        <span class="k">ELSE IF</span><span class="p">((</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Refrigeration:CompressorRack&#39;</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1507"></a>                <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Refrigeration:Condenser:AirCooled&#39;</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.&amp;</span>
<a name="ln-1508"></a>                <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Refrigeration:Condenser:EvaporativeCooled&#39;</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.&amp;</span>
<a name="ln-1509"></a>                <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Refrigeration:Condenser:WaterCooled&#39;</span><span class="p">)))&amp;</span>
<a name="ln-1510"></a>        <span class="k">THEN</span>
<a name="ln-1511"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatingSourceType</span>  <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1512"></a>          <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatingSourceName</span>  <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1513"></a>        <span class="k">ELSE</span>
<a name="ln-1514"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-1515"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; desuperheater can only be used with Coil:Cooling:DX:SingleSpeed, &#39;</span><span class="p">)</span>
<a name="ln-1516"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Coil:Cooling:DX:TwoSpeed, Coil:Cooling:DX:TwoStageWithHumidityControlMode, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1517"></a>             <span class="s1">&#39;Refrigeration:CompressorRack,&#39;</span><span class="p">)</span>
<a name="ln-1518"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Refrigeration:Condenser:AirCooled ,Refrigeration:Condenser:EvaporativeCooled, &#39;</span><span class="p">)</span>
<a name="ln-1519"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; or Refrigeration:Condenser:WaterCooled.&#39;</span><span class="p">)</span>
<a name="ln-1520"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1521"></a>        <span class="k">END IF</span>
<a name="ln-1522"></a>
<a name="ln-1523"></a><span class="c">!       Set up comp set for water side nodes (reverse inlet/outlet for water heater)</span>
<a name="ln-1524"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1525"></a>                     <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1526"></a>                     <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankName</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-1527"></a>
<a name="ln-1528"></a><span class="c">!       Find the DX equipment index associated with the desuperheater heating coil.</span>
<a name="ln-1529"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Refrigeration:CompressorRack&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1530"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="o">=</span> <span class="n">COMPRESSORRACK_REFRIGERATEDCASE</span>
<a name="ln-1531"></a>          <span class="k">DO </span><span class="n">RackNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumRefrigeratedRacks</span>
<a name="ln-1532"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HeatReclaimRefrigeratedRack</span><span class="p">(</span><span class="n">RackNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="k">CYCLE</span>
<a name="ln-1533"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="o">=</span> <span class="n">RackNum</span>
<a name="ln-1534"></a>            <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">HeatReclaimRefrigeratedRack</span><span class="p">))</span><span class="n">ValidSourceType</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1535"></a>            <span class="k">EXIT</span>
<a name="ln-1536"></a><span class="k">          END DO</span>
<a name="ln-1537"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1538"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1539"></a>                        <span class="s1">&#39;&quot; desuperheater heat source object not found: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1540"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1541"></a>          <span class="k">END IF</span>
<a name="ln-1542"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">((</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Refrigeration:Condenser:AirCooled&#39;</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.&amp;</span>
<a name="ln-1543"></a>                <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Refrigeration:Condenser:EvaporativeCooled&#39;</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.&amp;</span>
<a name="ln-1544"></a>                <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Refrigeration:Condenser:WaterCooled&#39;</span><span class="p">)))&amp;</span>
<a name="ln-1545"></a>        <span class="k">THEN</span>
<a name="ln-1546"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="o">=</span> <span class="n">CONDENSER_REFRIGERATION</span>
<a name="ln-1547"></a>          <span class="k">DO </span><span class="n">CondNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumRefrigCondensers</span>
<a name="ln-1548"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HeatReclaimRefrigCondenser</span><span class="p">(</span><span class="n">CondNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="k">CYCLE</span>
<a name="ln-1549"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="o">=</span> <span class="n">CondNum</span>
<a name="ln-1550"></a>            <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">HeatReclaimRefrigCondenser</span><span class="p">))</span><span class="n">ValidSourceType</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1551"></a>            <span class="k">EXIT</span>
<a name="ln-1552"></a><span class="k">          END DO</span>
<a name="ln-1553"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1554"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1555"></a>                        <span class="s1">&#39;&quot; desuperheater heat source object not found: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1556"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1557"></a>          <span class="k">END IF</span>
<a name="ln-1558"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1559"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="o">=</span> <span class="n">COIL_DX_COOLING</span>
<a name="ln-1560"></a>          <span class="k">DO </span><span class="n">DXCoilNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDXCoils</span>
<a name="ln-1561"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="k">CYCLE</span>
<a name="ln-1562"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span>
<a name="ln-1563"></a>            <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">HeatReclaimDXCoil</span><span class="p">))</span><span class="n">ValidSourceType</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1564"></a>            <span class="k">EXIT</span>
<a name="ln-1565"></a><span class="k">          END DO</span>
<a name="ln-1566"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1567"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1568"></a>                        <span class="s1">&#39;&quot; desuperheater heat source object not found: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1569"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1570"></a>          <span class="k">END IF</span>
<a name="ln-1571"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Coil:Cooling:DX:TwoSpeed&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1572"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="o">=</span> <span class="n">COIL_DX_MULTISPEED</span>
<a name="ln-1573"></a>          <span class="k">DO </span><span class="n">DXCoilNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDXCoils</span>
<a name="ln-1574"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="k">CYCLE</span>
<a name="ln-1575"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span>
<a name="ln-1576"></a>            <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">HeatReclaimDXCoil</span><span class="p">))</span><span class="n">ValidSourceType</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1577"></a>            <span class="k">EXIT</span>
<a name="ln-1578"></a><span class="k">          END DO</span>
<a name="ln-1579"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1580"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1581"></a>                        <span class="s1">&#39;&quot; desuperheater heat source object not found: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1582"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1583"></a>          <span class="k">END IF</span>
<a name="ln-1584"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;Coil:Cooling:DX:TwoStageWithHumidityControlMode&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1585"></a><span class="k">          </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="o">=</span> <span class="n">COIL_DX_MULTIMODE</span>
<a name="ln-1586"></a>          <span class="k">DO </span><span class="n">DXCoilNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumDXCoils</span>
<a name="ln-1587"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="k">CYCLE</span>
<a name="ln-1588"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="o">=</span> <span class="n">DXCoilNum</span>
<a name="ln-1589"></a>            <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">HeatReclaimDXCoil</span><span class="p">))</span><span class="n">ValidSourceType</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1590"></a>            <span class="k">EXIT</span>
<a name="ln-1591"></a><span class="k">          END DO</span>
<a name="ln-1592"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1593"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1594"></a>                        <span class="s1">&#39;&quot; desuperheater heat source object not found: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1595"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1596"></a>          <span class="k">END IF</span>
<a name="ln-1597"></a><span class="k">        ELSE</span>
<a name="ln-1598"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1599"></a>                           <span class="s1">&#39;&quot; invalid desuperheater heat source object: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1600"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1601"></a>        <span class="k">END IF</span>
<a name="ln-1602"></a>
<a name="ln-1603"></a>        <span class="c">!Now have source type, so set limits on heat recovery efficiency</span>
<a name="ln-1604"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="o">==</span> <span class="n">CONDENSER_REFRIGERATION</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1605"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1606"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span>       <span class="o">=</span> <span class="mf">0.8d0</span>
<a name="ln-1607"></a>          <span class="k">ELSE</span>
<a name="ln-1608"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span>       <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1609"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1610"></a>                 <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.9d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1611"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1612"></a>                                <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 0.0 and &lt;= 0.9, Efficiency = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1613"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1614"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1615"></a>            <span class="k">END IF</span>
<a name="ln-1616"></a><span class="k">          END IF</span> <span class="c">!Blank Num(2)</span>
<a name="ln-1617"></a>        <span class="k">ELSE</span> <span class="c">! max is 0.3 for all other sources</span>
<a name="ln-1618"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1619"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span>       <span class="o">=</span> <span class="mf">0.25d0</span>
<a name="ln-1620"></a>          <span class="k">ELSE</span>
<a name="ln-1621"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span>       <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1622"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1623"></a>               <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.3d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1624"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1625"></a>                                <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt; 0.0 and &lt;= 0.3, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1626"></a>                                <span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1627"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1628"></a>            <span class="k">END IF</span>
<a name="ln-1629"></a><span class="k">          END IF</span> <span class="c">!Blank Num(2)</span>
<a name="ln-1630"></a>        <span class="k">END IF</span>  <span class="c">!setting limits on heat recovery efficiency</span>
<a name="ln-1631"></a>
<a name="ln-1632"></a>        <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1633"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1634"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1635"></a>                           <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0. &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1636"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1637"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1638"></a>        <span class="k">END IF</span>
<a name="ln-1639"></a>
<a name="ln-1640"></a><span class="k">        </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpElecPower</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1641"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpElecPower</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1642"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1643"></a>                               <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0. &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1644"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1645"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1646"></a>        <span class="k">END IF</span>
<a name="ln-1647"></a>
<a name="ln-1648"></a><span class="k">        IF</span><span class="p">((</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpElecPower</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1649"></a>           <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">7.9264d6</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1650"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1651"></a>                                <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; ratio &gt; 7.9264E6.&#39;</span> <span class="p">&amp;</span>
<a name="ln-1652"></a>                                <span class="o">//</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1653"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">((</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpElecPower</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1654"></a>                                                     <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1655"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Suggest reducing &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; or increasing &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1656"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-1657"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The simulation will continue using the user defined values.&#39;</span><span class="p">)</span>
<a name="ln-1658"></a>        <span class="k">END IF</span>
<a name="ln-1659"></a>
<a name="ln-1660"></a><span class="k">        </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpFracToWater</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1661"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpFracToWater</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1662"></a>           <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpFracToWater</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1663"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1664"></a>                               <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0 or &lt;= 1. &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1665"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-1666"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1667"></a>        <span class="k">END IF</span>
<a name="ln-1668"></a>
<a name="ln-1669"></a><span class="k">        </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>        <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1670"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1671"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1672"></a>                               <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0. &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1673"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1674"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1675"></a>        <span class="k">END IF</span>
<a name="ln-1676"></a>
<a name="ln-1677"></a><span class="k">        </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span>        <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1678"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1679"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1680"></a>                               <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0. &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1681"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1682"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1683"></a>        <span class="k">END IF</span>
<a name="ln-1684"></a>
<a name="ln-1685"></a><span class="k">      END DO</span>
<a name="ln-1686"></a>
<a name="ln-1687"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1688"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1689"></a>           <span class="s1">&#39; input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-1690"></a>      <span class="k">END IF</span>
<a name="ln-1691"></a>
<a name="ln-1692"></a><span class="k">    END IF</span>
<a name="ln-1693"></a>
<a name="ln-1694"></a><span class="c">!!!=======   Get HEAT PUMP:WATER HEATER ===============================================================================</span>
<a name="ln-1695"></a>
<a name="ln-1696"></a><span class="c">!   get input for heat pump water heater object</span>
<a name="ln-1697"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1698"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;WaterHeater:HeatPump&#39;</span>
<a name="ln-1699"></a>      <span class="k">DO </span><span class="n">HPWaterHeaterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHeatPumpWaterHeater</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">HPWaterHeaterNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1702"></a>          <span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1703"></a>          <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1704"></a>          <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1705"></a>
<a name="ln-1706"></a>        <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1707"></a>        <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1708"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">HPWaterHeater</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1709"></a>                        <span class="n">HPWaterHeaterNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1710"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1711"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1712"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1713"></a>        <span class="k">END IF</span>
<a name="ln-1714"></a>
<a name="ln-1715"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span>    <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1716"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span>    <span class="o">=</span> <span class="n">cCurrentModuleObject</span>
<a name="ln-1717"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">=</span> <span class="n">HeatPumpWaterHeater</span>
<a name="ln-1718"></a>
<a name="ln-1719"></a><span class="c">!       convert schedule name to pointer</span>
<a name="ln-1720"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1721"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1722"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1723"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, not found&#39;</span><span class="p">)</span>
<a name="ln-1724"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1725"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1726"></a>          <span class="k">END IF</span>
<a name="ln-1727"></a><span class="k">        ELSE</span>
<a name="ln-1728"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1729"></a>        <span class="n">ENDIF</span>
<a name="ln-1730"></a>
<a name="ln-1731"></a><span class="c">!       convert schedule name to pointer</span>
<a name="ln-1732"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1733"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1734"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1735"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, not found&#39;</span><span class="p">)</span>
<a name="ln-1736"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1737"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1738"></a>          <span class="n">ENDIF</span>
<a name="ln-1739"></a>        <span class="k">ELSE</span>
<a name="ln-1740"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-1741"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1742"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1743"></a>        <span class="k">END IF</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DeadbandTempDiff</span>       <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1746"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DeadbandTempDiff</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span>  <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1747"></a>           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DeadbandTempDiff</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1748"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-1749"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; difference must be &gt; 0 and &lt;= 20. Dead band = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1750"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1751"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1752"></a>        <span class="k">END IF</span>
<a name="ln-1753"></a>
<a name="ln-1754"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">CondWaterInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1755"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1756"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1757"></a>        <span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName1</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1758"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">CondWaterOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1759"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1760"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1761"></a>        <span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1762"></a>
<a name="ln-1763"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1764"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1765"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-1766"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0. Condenser water flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1767"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1768"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1769"></a>        <span class="k">END IF</span>
<a name="ln-1770"></a>
<a name="ln-1771"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingAirFlowRate</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1772"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingAirFlowRate</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/=</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1773"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-1774"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than 0. Evaporator air flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1775"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1776"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1777"></a>        <span class="k">END IF</span>
<a name="ln-1778"></a>
<a name="ln-1779"></a><span class="k">        SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1780"></a>
<a name="ln-1781"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SCHEDULE&#39;</span><span class="p">)</span>
<a name="ln-1782"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="o">=</span> <span class="n">AmbientTempSchedule</span>
<a name="ln-1783"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1784"></a><span class="k">              </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-1785"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1786"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, not found&#39;</span><span class="p">)</span>
<a name="ln-1787"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1788"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1789"></a>              <span class="n">ENDIF</span>
<a name="ln-1790"></a>            <span class="k">ELSE</span>
<a name="ln-1791"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-1792"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1793"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1794"></a>            <span class="k">END IF</span>
<a name="ln-1795"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1796"></a><span class="k">              </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientRHSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-1797"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientRHSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1798"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, not found&#39;</span><span class="p">)</span>
<a name="ln-1799"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1800"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1801"></a>              <span class="k">ELSE</span>
<a name="ln-1802"></a><span class="k">                IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientRHSchedule</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1803"></a><span class="k">                  CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1804"></a>                     <span class="s1">&#39;&quot;, invalid values&#39;</span><span class="p">)</span>
<a name="ln-1805"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1806"></a>                                  <span class="s1">&#39; schedule values must be (&gt;=0., &lt;=1.)&#39;</span><span class="p">)</span>
<a name="ln-1807"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1808"></a>                <span class="k">END IF</span>
<a name="ln-1809"></a><span class="k">              END IF</span>
<a name="ln-1810"></a><span class="k">            ELSE</span>
<a name="ln-1811"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-1812"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1813"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1814"></a>            <span class="k">END IF</span>
<a name="ln-1815"></a>
<a name="ln-1816"></a><span class="k">          CASE</span> <span class="p">(</span><span class="s1">&#39;ZONEAIRONLY&#39;</span><span class="p">)</span>
<a name="ln-1817"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="o">=</span> <span class="n">AmbientTempZone</span>
<a name="ln-1818"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1819"></a><span class="k">              </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1820"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1821"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, not found&#39;</span><span class="p">)</span>
<a name="ln-1822"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1823"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1824"></a>              <span class="k">END IF</span>
<a name="ln-1825"></a><span class="k">            ELSE</span>
<a name="ln-1826"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-1827"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1828"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1829"></a>            <span class="n">ENDIF</span>
<a name="ln-1830"></a>
<a name="ln-1831"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OUTDOORAIRONLY&#39;</span><span class="p">)</span>
<a name="ln-1832"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="o">=</span> <span class="n">AmbientTempOutsideAir</span>
<a name="ln-1833"></a>
<a name="ln-1834"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ZONEANDOUTDOORAIR&#39;</span><span class="p">)</span>
<a name="ln-1835"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="o">=</span> <span class="n">AmbientTempZoneAndOA</span>
<a name="ln-1836"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1837"></a><span class="k">              </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1838"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1839"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, not found&#39;</span><span class="p">)</span>
<a name="ln-1840"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1841"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1842"></a>              <span class="k">END IF</span>
<a name="ln-1843"></a><span class="k">            ELSE</span>
<a name="ln-1844"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-1845"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1846"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1847"></a>            <span class="n">ENDIF</span>
<a name="ln-1848"></a>
<a name="ln-1849"></a>        <span class="k">END SELECT</span>
<a name="ln-1850"></a>
<a name="ln-1851"></a><span class="c">!       Read air inlet nodes after mixer/splitter nodes have been read in (cAlphaArgs 7-10),</span>
<a name="ln-1852"></a><span class="c">!       Node_ConnectionType differs for inlet node if mixer/splitter node exists</span>
<a name="ln-1853"></a>
<a name="ln-1854"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankType</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-1855"></a>
<a name="ln-1856"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">,</span><span class="n">cMixedWHModuleObj</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1857"></a>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">,</span><span class="n">cStratifiedWHModuleObj</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1858"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-1859"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump water heater can only be used with &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1860"></a>                                  <span class="n">cMixedWHModuleObj</span><span class="o">//</span><span class="s1">&#39; or &#39;</span><span class="o">//</span><span class="n">cStratifiedWHModuleObj</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-1861"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1862"></a>        <span class="k">END IF</span>
<a name="ln-1863"></a>
<a name="ln-1864"></a><span class="c">!       Verify tank name after Water Heater:Mixed objects have been read in</span>
<a name="ln-1865"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-1866"></a>
<a name="ln-1867"></a><span class="c">!       Get the water heater tank use side inlet node names for HPWHs connected to a plant loop</span>
<a name="ln-1868"></a><span class="c">!       Save the name of the node for use with set up comp sets</span>
<a name="ln-1869"></a>        <span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName2</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-1870"></a>        <span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span><span class="o">=</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-1871"></a>
<a name="ln-1872"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1873"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WHUseInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1874"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1875"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1876"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WHUseOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1877"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1878"></a>                            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1879"></a>        <span class="k">END IF</span>
<a name="ln-1880"></a>
<a name="ln-1881"></a><span class="c">!       get Coil:DX:HeatPumpWaterHeater object</span>
<a name="ln-1882"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilType</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-1883"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-1884"></a>
<a name="ln-1885"></a><span class="c">!       check that the DX Coil exists</span>
<a name="ln-1886"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:WaterHeating:AirToWaterHeatPump&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1887"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-1888"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump water heater can only be used with Coil:WaterHeating:AirToWaterHeatPump.&#39;</span><span class="p">)</span>
<a name="ln-1889"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1890"></a>        <span class="k">END IF</span>
<a name="ln-1891"></a>
<a name="ln-1892"></a><span class="k">        </span><span class="n">DXCoilErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1893"></a>        <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1894"></a>                            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">DXCoilErrFlag</span><span class="p">,</span> <span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-1895"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoilErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1896"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in WaterHeater:HeatPump =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1897"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...entered DX CoilType=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">))</span>
<a name="ln-1898"></a>          <span class="n">ErrorsFound</span>   <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1899"></a>        <span class="k">END IF</span>
<a name="ln-1900"></a>
<a name="ln-1901"></a><span class="c">!       Set up comp set for condenser water side nodes (reverse inlet/outlet for water heater)</span>
<a name="ln-1902"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1903"></a>                     <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1904"></a>                     <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-1905"></a>
<a name="ln-1906"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1907"></a>                     <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1908"></a>                     <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankName</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-1909"></a>
<a name="ln-1910"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">MinAirTempForHPOperation</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1911"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">MinAirTempForHPOperation</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1912"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1913"></a>               <span class="s1">&#39;&quot;: minimum inlet air temperature for heat pump compressor operation must be greater than or equal to 5 C.&#39;</span><span class="p">)</span>
<a name="ln-1914"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Minimum inlet air temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1915"></a>        <span class="k">END IF</span>
<a name="ln-1916"></a>
<a name="ln-1917"></a><span class="c">!       Get compressor location</span>
<a name="ln-1918"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<a name="ln-1919"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SCHEDULE&#39;</span><span class="p">)</span>
<a name="ln-1920"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">CrankcaseTempIndicator</span> <span class="o">=</span> <span class="n">CrankcaseTempSchedule</span>
<a name="ln-1921"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1922"></a><span class="k">              </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">CrankcaseTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<a name="ln-1923"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">CrankcaseTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1924"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, not found&#39;</span><span class="p">)</span>
<a name="ln-1925"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1926"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1927"></a>              <span class="k">END IF</span>
<a name="ln-1928"></a><span class="k">            ELSE</span>
<a name="ln-1929"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, &#39;</span><span class="p">)</span>
<a name="ln-1930"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;required &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank.&#39;</span><span class="p">)</span>
<a name="ln-1931"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1932"></a>            <span class="n">ENDIF</span>
<a name="ln-1933"></a>
<a name="ln-1934"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ZONE&#39;</span><span class="p">)</span>
<a name="ln-1935"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">CrankcaseTempIndicator</span> <span class="o">=</span> <span class="n">CrankcaseTempZone</span>
<a name="ln-1936"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempOutsideAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1937"></a>               <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempSchedule</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1938"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1939"></a>                                   <span class="s1">&#39;&quot;:  Inlet Air Configuration must be Zone Air Only or Zone And&#39;</span><span class="p">)</span>
<a name="ln-1940"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Outdoor Air when compressor location equals ZONE.&#39;</span><span class="p">)</span>
<a name="ln-1941"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1942"></a>            <span class="k">END IF</span>
<a name="ln-1943"></a>
<a name="ln-1944"></a><span class="k">            IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1945"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1946"></a>                        <span class="s1">&#39;&quot;  &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; was provided but will not be used based&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1947"></a>                        <span class="s1">&#39; on compressor location input=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1948"></a>            <span class="k">END IF</span>
<a name="ln-1949"></a><span class="k">          CASE</span> <span class="p">(</span><span class="s1">&#39;OUTDOORS&#39;</span><span class="p">)</span>
<a name="ln-1950"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">CrankcaseTempIndicator</span> <span class="o">=</span> <span class="n">CrankcaseTempExterior</span>
<a name="ln-1951"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1952"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1953"></a>                        <span class="s1">&#39;&quot;  &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; was provided but will not be used based&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1954"></a>                        <span class="s1">&#39; on &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1955"></a>            <span class="k">END IF</span>
<a name="ln-1956"></a>
<a name="ln-1957"></a><span class="k">        END SELECT</span>
<a name="ln-1958"></a>
<a name="ln-1959"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanType</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-1960"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<a name="ln-1961"></a>
<a name="ln-1962"></a><span class="c">!       check that the fan exists</span>
<a name="ln-1963"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1964"></a>        <span class="k">CALL </span><span class="n">GetFanIndex</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1965"></a>                         <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">,</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-1966"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1967"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in unit=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1968"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1969"></a>        <span class="n">ENDIF</span>
<a name="ln-1970"></a>
<a name="ln-1971"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1972"></a>        <span class="k">CALL </span><span class="n">GetFanType</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanType_Num</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1973"></a>                       <span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1974"></a>
<a name="ln-1975"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1976"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1977"></a>        <span class="k">ELSE</span>
<a name="ln-1978"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">FanType_SimpleOnOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1979"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal fan type specified.&#39;</span><span class="p">)</span>
<a name="ln-1980"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in unit=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1981"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The fan object (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1982"></a>                                   <span class="s1">&#39;) type must be Fan:OnOff when used with a heat pump water heater&#39;</span><span class="p">)</span>
<a name="ln-1983"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1984"></a>          <span class="k">ELSE</span>
<a name="ln-1985"></a><span class="k">            IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanType</span><span class="p">,</span><span class="s1">&#39;Fan:OnOff&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1986"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal fan type = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1987"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanType</span><span class="p">))</span>
<a name="ln-1988"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1989"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The fan object (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1990"></a>                                     <span class="s1">&#39;) is actually the correct fan type and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-1991"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Node connection errors will result due to the inconsistent fan type.&#39;</span><span class="p">)</span>
<a name="ln-1992"></a>            <span class="k">END IF</span>
<a name="ln-1993"></a><span class="k">          END IF</span>
<a name="ln-1994"></a><span class="k">        END IF</span>
<a name="ln-1995"></a>
<a name="ln-1996"></a><span class="k">        CALL </span><span class="n">GetFanVolFlow</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">,</span><span class="n">FanVolFlow</span><span class="p">)</span>
<a name="ln-1997"></a>
<a name="ln-1998"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1999"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingAirFlowRate</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2000"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - air flow rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FanVolFlow</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2001"></a>              <span class="s1">&#39; in fan object &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2002"></a>              <span class="s1">&#39; is less than the  HPWHs evaporator air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-2003"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The fan flow rate must be &gt;= to the HPWHs evaporator volumetric air flow rate.&#39;</span><span class="p">)</span>
<a name="ln-2004"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in unit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2005"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2006"></a>          <span class="k">END IF</span>
<a name="ln-2007"></a><span class="k">        END IF</span>
<a name="ln-2008"></a>
<a name="ln-2009"></a><span class="k">        IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2010"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanPlacement</span> <span class="o">=</span> <span class="n">BlowThru</span>
<a name="ln-2011"></a>
<a name="ln-2012"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2013"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanPlacement</span> <span class="o">=</span> <span class="n">DrawThru</span>
<a name="ln-2014"></a>
<a name="ln-2015"></a>        <span class="k">ELSE</span>
<a name="ln-2016"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid &#39;</span><span class="p">)</span>
<a name="ln-2017"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2018"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2019"></a>        <span class="k">END IF</span>
<a name="ln-2020"></a>
<a name="ln-2021"></a><span class="k">        IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2022"></a><span class="c">!         get HPWH capacity, air inlet node, and PLF curve info from DX coil object</span>
<a name="ln-2023"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Capacity</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span>
<a name="ln-2024"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilAirInletNode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span>
<a name="ln-2025"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilPLFFPLR</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">PLFFPLR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2026"></a><span class="c">!         check the range of condenser pump power to be &lt;= 5 gpm/ton</span>
<a name="ln-2027"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2028"></a>             <span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.1422d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2029"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2030"></a>                 <span class="s1">&#39;= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2031"></a>                <span class="s1">&#39;: Rated condenser pump power per watt of rated heating capacity has exceeded the recommended&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2032"></a>                <span class="s1">&#39; maximum of 0.1422 W/W (41.67 watt/MBH). Condenser pump power per watt = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2033"></a>                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">((</span><span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">HPWHCondPumpElecNomPower</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2034"></a>                                      <span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">RatedTotCap2</span><span class="p">),</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-2035"></a>          <span class="k">END IF</span>
<a name="ln-2036"></a><span class="k">        END IF</span>
<a name="ln-2037"></a>
<a name="ln-2038"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2039"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span> <span class="o">=</span> <span class="mf">0.00000004487d0</span> <span class="o">*</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Capacity</span>
<a name="ln-2040"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WaterFlowRateAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2041"></a>        <span class="k">END IF</span>
<a name="ln-2042"></a>
<a name="ln-2043"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingAirFlowRate</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2044"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingAirFlowRate</span> <span class="o">=</span> <span class="mf">0.00005035d0</span> <span class="o">*</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Capacity</span>
<a name="ln-2045"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AirFlowRateAutosized</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2046"></a>        <span class="k">END IF</span>
<a name="ln-2047"></a>
<a name="ln-2048"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2049"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2050"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="p">)</span>
<a name="ln-2051"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0. &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2052"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2053"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2054"></a>        <span class="k">END IF</span>
<a name="ln-2055"></a>
<a name="ln-2056"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2057"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2058"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="p">)</span>
<a name="ln-2059"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be &gt;= 0. &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2060"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2061"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2062"></a>        <span class="k">END IF</span>
<a name="ln-2063"></a>
<a name="ln-2064"></a><span class="k">        IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2065"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ParasiticTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempZone</span>
<a name="ln-2066"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempOutsideAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2067"></a>             <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempSchedule</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2068"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="p">)</span>
<a name="ln-2069"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be ZoneAirOnly or ZoneAndOutdoorAir&#39;</span><span class="p">)</span>
<a name="ln-2070"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; when parasitic heat rejection location equals Zone.&#39;</span><span class="p">)</span>
<a name="ln-2071"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2072"></a>          <span class="k">END IF</span>
<a name="ln-2073"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span><span class="s1">&#39;Outdoors&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2074"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ParasiticTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempOutsideAir</span>
<a name="ln-2075"></a>        <span class="k">ELSE</span>
<a name="ln-2076"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2077"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; parasitic heat rejection location must be either Zone or Outdoors.&#39;</span><span class="p">)</span>
<a name="ln-2078"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2079"></a>        <span class="k">END IF</span>
<a name="ln-2080"></a>
<a name="ln-2081"></a><span class="c">!       get mixer/splitter nodes only when Inlet Air Configuration is ZoneAndOutdoorAir</span>
<a name="ln-2082"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2083"></a><span class="c">!         For the inlet air mixer node, NodeConnectionType is outlet from the HPWH inlet air node</span>
<a name="ln-2084"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZoneAndOA</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2085"></a><span class="k">            </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2086"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="s1">&#39;WaterHeater:HeatPump inlet air mixer&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2087"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2088"></a>          <span class="k">ELSE</span>
<a name="ln-2089"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2090"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Inlet air mixer node name specified but only required &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2091"></a>               <span class="s1">&#39;when Inlet Air Configuration is selected&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2092"></a>               <span class="s1">&#39; as Zone and OutdoorAir. Node name disregarded and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2093"></a>          <span class="k">END IF</span>
<a name="ln-2094"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">26</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZoneAndOA</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2095"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2096"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Inlet air mixer node name required &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2097"></a>               <span class="s1">&#39;when Inlet Air Configuration is selected as ZoneAndOutdoorAir.&#39;</span><span class="p">)</span>
<a name="ln-2098"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2099"></a>        <span class="k">END IF</span>
<a name="ln-2100"></a>
<a name="ln-2101"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2102"></a><span class="c">!         For the outlet air splitter node, NodeConnectionType is inlet to the HPWH outlet air node</span>
<a name="ln-2103"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZoneAndOA</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2104"></a><span class="k">            </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletAirSplitterNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2105"></a>              <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-OUTLET AIR SPLITTER&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2106"></a>                          <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2107"></a>          <span class="k">ELSE</span>
<a name="ln-2108"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2109"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Outlet air splitter node name specified but only required when &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2110"></a>               <span class="s1">&#39;Inlet Air Configuration is selected&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2111"></a>               <span class="s1">&#39; as ZoneAndOutdoorAir. Node name disregarded and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2112"></a>          <span class="k">END IF</span>
<a name="ln-2113"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZoneAndOA</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2114"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2115"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Outlet air splitter node name required when &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2116"></a>               <span class="s1">&#39;Inlet Air Configuration is selected as ZoneAndOutdoorAir.&#39;</span><span class="p">)</span>
<a name="ln-2117"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2118"></a>        <span class="k">END IF</span>
<a name="ln-2119"></a>
<a name="ln-2120"></a><span class="c">!       get node data for HPWH</span>
<a name="ln-2121"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2122"></a><span class="c">!         when mixer/splitter nodes are used the HPWH&#39;s inlet/outlet node are set up as ObjectIsNotParent</span>
<a name="ln-2123"></a>
<a name="ln-2124"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2125"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-INLET AIR MIXER&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2126"></a>                           <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2127"></a>
<a name="ln-2128"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpAirOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2129"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-OUTLET AIR SPLITTER&#39;</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2130"></a>                           <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2131"></a>
<a name="ln-2132"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2133"></a>             <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2134"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2135"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2136"></a><span class="k">            Call </span><span class="n">CheckAndAddAirNodeNumber</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span><span class="p">,</span><span class="n">Okay</span><span class="p">)</span>
<a name="ln-2137"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Okay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2138"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2139"></a>                 <span class="s1">&#39;&quot;: Adding outdoor air node=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-2140"></a>            <span class="n">ENDIF</span>
<a name="ln-2141"></a>          <span class="n">ENDIF</span>
<a name="ln-2142"></a>
<a name="ln-2143"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ExhaustAirNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2144"></a>             <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2145"></a>                        <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_ReliefAir</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2146"></a>
<a name="ln-2147"></a>        <span class="k">ELSE</span>
<a name="ln-2148"></a><span class="c">!         when mixer/splitter nodes are NOT used the HPWH&#39;s inlet/outlet nodes are set up as ObjectIsParent</span>
<a name="ln-2149"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempSchedule</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2150"></a><span class="c">!           for scheduled HPWH&#39;s the inlet node is not on any branch or parent object, make it an outlet node</span>
<a name="ln-2151"></a><span class="c">!           to avoid node connection errors</span>
<a name="ln-2152"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2153"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2154"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2155"></a>
<a name="ln-2156"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpAirOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2157"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2158"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2159"></a>
<a name="ln-2160"></a>          <span class="k">ELSE</span> <span class="c">! HPWH is connected to a zone with no mixer/splitter nodes</span>
<a name="ln-2161"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZone</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2162"></a><span class="k">              </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2163"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2164"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2165"></a>
<a name="ln-2166"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpAirOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2167"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2168"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2169"></a>            <span class="k">ELSE</span> <span class="c">! HPWH is located outdoors</span>
<a name="ln-2170"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2171"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2172"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2173"></a>              <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2174"></a><span class="k">                CALL </span><span class="n">CheckAndAddAirNodeNumber</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span><span class="p">,</span><span class="n">Okay</span><span class="p">)</span>
<a name="ln-2175"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Okay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2176"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2177"></a>                     <span class="s1">&#39;&quot;: Adding outdoor air node =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-2178"></a>                <span class="n">ENDIF</span>
<a name="ln-2179"></a>              <span class="n">ENDIF</span>
<a name="ln-2180"></a>
<a name="ln-2181"></a>             <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ExhaustAirNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2182"></a>                 <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2183"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_ReliefAir</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2184"></a>            <span class="k">END IF</span>
<a name="ln-2185"></a><span class="k">          END IF</span>
<a name="ln-2186"></a><span class="k">        END IF</span>
<a name="ln-2187"></a>
<a name="ln-2188"></a><span class="c">!       check that the HPWH inlet and outlet nodes are in the same zone (ZoneHVAC:EquipmentConnections) when</span>
<a name="ln-2189"></a><span class="c">!       Inlet Air Configuration is Zone Air Only or Zone and Outdoor Air</span>
<a name="ln-2190"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZone</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2191"></a>           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZoneAndOA</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2192"></a>           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2193"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ZoneEquipInputsFilled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2194"></a><span class="k">            CALL </span><span class="n">GetZoneEquipmentData</span>
<a name="ln-2195"></a>            <span class="n">ZoneEquipInputsFilled</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2196"></a>          <span class="n">ENDIF</span>
<a name="ln-2197"></a>          <span class="k">IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2198"></a><span class="k">            </span><span class="n">FoundInletNode</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2199"></a>            <span class="n">FoundOutletNode</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2200"></a>            <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-2201"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-2202"></a><span class="k">            END DO</span>
<a name="ln-2203"></a><span class="k">            IF</span><span class="p">(</span><span class="n">ZoneNum</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">NumOfZones</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2204"></a><span class="k">              DO </span><span class="n">SupAirIn</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-2205"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpAirOutletNode</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">SupAirIn</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-2206"></a><span class="k">                </span><span class="n">FoundOutletNode</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2207"></a>              <span class="k">END DO</span>
<a name="ln-2208"></a><span class="k">              DO </span><span class="n">ExhAirOut</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">NumExhaustNodes</span>
<a name="ln-2209"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExhaustNode</span><span class="p">(</span><span class="n">ExhAirOut</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-2210"></a><span class="k">                </span><span class="n">FoundInletNode</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2211"></a>              <span class="k">END DO</span>
<a name="ln-2212"></a><span class="k">              IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FoundInletNode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2213"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2214"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The HPWH&#39;&#39;s air inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; was not properly specified &#39;</span><span class="p">)</span>
<a name="ln-2215"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;as an exhaust air node for zone = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in a &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2216"></a>                                       <span class="s1">&#39;ZoneHVAC:EquipmentConnections object.&#39;</span><span class="p">)</span>
<a name="ln-2217"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2218"></a>              <span class="k">END IF</span>
<a name="ln-2219"></a><span class="k">              IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FoundOutletNode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2220"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2221"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The HPWH&#39;&#39;s air outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; was not properly specified &#39;</span><span class="p">)</span>
<a name="ln-2222"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;as an inlet air node for zone = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in a &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2223"></a>                                       <span class="s1">&#39;ZoneHVAC:EquipmentConnections object.&#39;</span><span class="p">)</span>
<a name="ln-2224"></a>                <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2225"></a>              <span class="k">END IF</span>
<a name="ln-2226"></a><span class="k">            END IF</span>
<a name="ln-2227"></a><span class="k">          ELSE</span>
<a name="ln-2228"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-2229"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump water heater air inlet node name and air outlet node name must be&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2230"></a>                                   <span class="s1">&#39; listed in a ZoneHVAC:EquipmentConnections object when Inlet Air Configuration&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2231"></a>                                   <span class="s1">&#39; is equal to ZoneAirOnly or ZoneAndOutdoorAir.&#39;</span><span class="p">)</span>
<a name="ln-2232"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2233"></a>          <span class="k">END IF</span>
<a name="ln-2234"></a><span class="k">        END IF</span>
<a name="ln-2235"></a>
<a name="ln-2236"></a><span class="c">!       only get the inlet air mixer schedule if the inlet air configuration is zone and outdoor air</span>
<a name="ln-2237"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZoneAndOA</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2238"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirMixerSchPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span>
<a name="ln-2239"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirMixerSchPtr</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2240"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, not found&#39;</span><span class="p">)</span>
<a name="ln-2241"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;,&#39;</span><span class="p">)</span>
<a name="ln-2242"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2243"></a>          <span class="k">ELSE</span>
<a name="ln-2244"></a><span class="c">!           check schedule values to be between 0 and 1</span>
<a name="ln-2245"></a>            <span class="n">ValidScheduleValue</span><span class="o">=</span><span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirMixerSchPtr</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-2246"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ValidScheduleValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2247"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, not found&#39;</span><span class="p">)</span>
<a name="ln-2248"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; values out of range of 0 to 1, Schedule=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2249"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2250"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2251"></a>            <span class="n">ENDIF</span>
<a name="ln-2252"></a><span class="c">!           set outlet air splitter schedule index equal to inlet air mixer schedule index</span>
<a name="ln-2253"></a><span class="c">!           (place holder for when zone pressurization/depressurization is allowed and different schedules can be used)</span>
<a name="ln-2254"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletAirSplitterSchPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span>
<a name="ln-2255"></a>          <span class="k">END IF</span>
<a name="ln-2256"></a><span class="k">        END IF</span>
<a name="ln-2257"></a>
<a name="ln-2258"></a><span class="c">!       set fan outlet node variable for use in setting Node(FanOutletNode)%MassFlowRateMax for fan object</span>
<a name="ln-2259"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanPlacement</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2260"></a><span class="k">           IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletAirSplitterNode</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2261"></a><span class="k">             </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletAirSplitterNode</span>
<a name="ln-2262"></a>           <span class="k">ELSE</span>
<a name="ln-2263"></a><span class="k">             IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempOutsideAir</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2264"></a><span class="k">               </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ExhaustAirNode</span>
<a name="ln-2265"></a>             <span class="k">ELSE</span>
<a name="ln-2266"></a><span class="k">               </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpAirOutletNode</span>
<a name="ln-2267"></a>             <span class="k">END IF</span>
<a name="ln-2268"></a><span class="k">           END IF</span>
<a name="ln-2269"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanPlacement</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2270"></a><span class="c">!           set fan outlet node variable for use in setting Node(FanOutletNode)%MassFlowRateMax for fan object</span>
<a name="ln-2271"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">)%</span><span class="n">AirInNode</span>
<a name="ln-2272"></a>        <span class="k">END IF</span>
<a name="ln-2273"></a>
<a name="ln-2274"></a><span class="c">!       set the max mass flow rate for outdoor fans</span>
<a name="ln-2275"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-2276"></a>                <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OperatingAirFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-2277"></a>                    <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-2278"></a>
<a name="ln-2279"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanPlacement</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2280"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2281"></a><span class="c">!           cAlphaArgs(26) = Inlet Air Mixer Node</span>
<a name="ln-2282"></a>            <span class="n">FanInletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
<a name="ln-2283"></a>            <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2284"></a>          <span class="k">ELSE</span>
<a name="ln-2285"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2286"></a><span class="c">!             cAlphaArgs(7) = Heat Pump Air Inlet Node</span>
<a name="ln-2287"></a>              <span class="n">FanInletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2288"></a>              <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2289"></a>            <span class="k">ELSE</span>
<a name="ln-2290"></a><span class="c">!             cAlphaArgs(9) = Outside Air Node</span>
<a name="ln-2291"></a>              <span class="n">FanInletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2292"></a>              <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2293"></a>            <span class="k">END IF</span>
<a name="ln-2294"></a><span class="k">          END IF</span>
<a name="ln-2295"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletAirSplitterNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2296"></a><span class="c">!           cAlphaArgs(27) = Outlet Air Splitter Node</span>
<a name="ln-2297"></a>            <span class="n">CoilInletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2298"></a>            <span class="n">CoilOutletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<a name="ln-2299"></a>          <span class="k">ELSE</span>
<a name="ln-2300"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2301"></a><span class="c">!             cAlphaArgs(8) = Heat Pump Air Outlet Node</span>
<a name="ln-2302"></a>              <span class="n">CoilInletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2303"></a>              <span class="n">CoilOutletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2304"></a>            <span class="k">ELSE</span>
<a name="ln-2305"></a><span class="k">              </span><span class="n">CoilInletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2306"></a><span class="c">!             cAlphaArgs(10) = Exhaust Air Node</span>
<a name="ln-2307"></a>              <span class="n">CoilOutletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2308"></a>            <span class="k">END IF</span>
<a name="ln-2309"></a><span class="k">          END IF</span>
<a name="ln-2310"></a><span class="k">        ELSE</span>
<a name="ln-2311"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2312"></a><span class="k">            </span><span class="n">CoilInletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
<a name="ln-2313"></a>            <span class="n">CoilOutletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2314"></a>          <span class="k">ELSE</span>
<a name="ln-2315"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2316"></a><span class="k">              </span><span class="n">CoilInletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2317"></a>              <span class="n">CoilOutletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2318"></a>            <span class="k">ELSE</span>
<a name="ln-2319"></a><span class="k">              </span><span class="n">CoilInletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2320"></a>              <span class="n">CoilOutletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2321"></a>            <span class="k">END IF</span>
<a name="ln-2322"></a><span class="k">          END IF</span>
<a name="ln-2323"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletAirSplitterNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2324"></a><span class="k">            </span><span class="n">FanInletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2325"></a>            <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<a name="ln-2326"></a>          <span class="k">ELSE</span>
<a name="ln-2327"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2328"></a><span class="k">              </span><span class="n">FanInletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2329"></a>              <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2330"></a>            <span class="k">ELSE</span>
<a name="ln-2331"></a><span class="k">              </span><span class="n">FanInletNode</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-2332"></a>              <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2333"></a>            <span class="k">END IF</span>
<a name="ln-2334"></a><span class="k">          END IF</span>
<a name="ln-2335"></a><span class="k">        END IF</span>
<a name="ln-2336"></a>
<a name="ln-2337"></a><span class="c">!       set up comp set for air side nodes (can be blow thru or draw thru, may or may not have damper nodes)</span>
<a name="ln-2338"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2339"></a>                           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2340"></a>                           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2341"></a>                           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2342"></a>                           <span class="n">CoilInletNode</span><span class="p">,</span><span class="n">CoilOutletNode</span><span class="p">)</span>
<a name="ln-2343"></a>
<a name="ln-2344"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2345"></a>                           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2346"></a>                           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2347"></a>                           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2348"></a>                           <span class="n">FanInletNode</span><span class="p">,</span><span class="n">FanOutletNode</span><span class="p">)</span>
<a name="ln-2349"></a>
<a name="ln-2350"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2351"></a><span class="k">          SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span>
<a name="ln-2352"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;HEATER1&#39;</span><span class="p">)</span>
<a name="ln-2353"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span> <span class="o">=</span> <span class="n">Heater1HPWHControl</span>
<a name="ln-2354"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;HEATER2&#39;</span><span class="p">)</span>
<a name="ln-2355"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span> <span class="o">=</span> <span class="n">Heater2HPWHControl</span>
<a name="ln-2356"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SOURCEINLET&#39;</span><span class="p">)</span>
<a name="ln-2357"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span> <span class="o">=</span> <span class="n">SourceInletHPWHControl</span>
<a name="ln-2358"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SOURCEOUTLET&#39;</span><span class="p">)</span>
<a name="ln-2359"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span> <span class="o">=</span> <span class="n">SourceOutletHPWHControl</span>
<a name="ln-2360"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;USEINLET&#39;</span><span class="p">)</span>
<a name="ln-2361"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span> <span class="o">=</span> <span class="n">UseInletHPWHControl</span>
<a name="ln-2362"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;USEOUTLET&#39;</span><span class="p">)</span>
<a name="ln-2363"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span> <span class="o">=</span> <span class="n">UseOutletHPWHControl</span>
<a name="ln-2364"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2365"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid &#39;</span><span class="p">)</span>
<a name="ln-2366"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2367"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2368"></a>          <span class="k">END SELECT</span>
<a name="ln-2369"></a>
<a name="ln-2370"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-2371"></a>
<a name="ln-2372"></a>      <span class="k">END DO</span> <span class="c">! DO HPWaterHeaterNum = 1, NumHeatPumpWaterHeater</span>
<a name="ln-2373"></a>
<a name="ln-2374"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2375"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2376"></a>           <span class="s1">&#39; input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2377"></a>      <span class="k">END IF</span>
<a name="ln-2378"></a>
<a name="ln-2379"></a><span class="k">    END IF</span> <span class="c">!IF (NumHeatPumpWaterHeater &gt; 0) THEN</span>
<a name="ln-2380"></a>
<a name="ln-2381"></a>
<a name="ln-2382"></a><span class="c">!!!=======   Get WATER HEATER:MIXED ===================================================================================</span>
<a name="ln-2383"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterHeaterMixed</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2384"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cMixedWHModuleObj</span>
<a name="ln-2385"></a>      <span class="k">DO </span><span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterHeaterMixed</span>
<a name="ln-2386"></a>
<a name="ln-2387"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2388"></a>          <span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2389"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2390"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-2391"></a>
<a name="ln-2392"></a>
<a name="ln-2393"></a>        <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2394"></a>        <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2395"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterThermalTankNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2396"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2397"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2398"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2399"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-2400"></a>        <span class="k">END IF</span>
<a name="ln-2401"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2402"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span> <span class="o">=</span> <span class="n">cCurrentModuleObject</span>
<a name="ln-2403"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">=</span> <span class="n">MixedWaterHeater</span>
<a name="ln-2404"></a>
<a name="ln-2405"></a>        <span class="c">! default to always on</span>
<a name="ln-2406"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-2407"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-2408"></a>
<a name="ln-2409"></a>          <span class="c">! A user field will be added in a later release</span>
<a name="ln-2410"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span> <span class="o">=</span> <span class="s1">&#39;Water Heater&#39;</span>
<a name="ln-2411"></a>
<a name="ln-2412"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2413"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2414"></a>          <span class="c">! Set volume to a really small number to simulate a tankless/instantaneous water heater</span>
<a name="ln-2415"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="mf">0.000001d0</span> <span class="c">! = 1 cm3</span>
<a name="ln-2416"></a>        <span class="k">END IF</span>
<a name="ln-2417"></a>
<a name="ln-2418"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2419"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2420"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, missing data.&#39;</span><span class="p">)</span>
<a name="ln-2421"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;blank field, missing &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is required&#39;</span><span class="p">)</span>
<a name="ln-2422"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2423"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2424"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2425"></a>            <span class="s1">&#39;:  &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2426"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2427"></a>        <span class="k">END IF</span>
<a name="ln-2428"></a>
<a name="ln-2429"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2430"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2431"></a>        <span class="k">ELSE</span>
<a name="ln-2432"></a>          <span class="c">! Default to very small number (however it can&#39;t be TINY or it will break the algorithm)</span>
<a name="ln-2433"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span> <span class="o">=</span> <span class="mf">0.5d0</span>
<a name="ln-2434"></a>        <span class="k">END IF</span>
<a name="ln-2435"></a>
<a name="ln-2436"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2437"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2438"></a>        <span class="k">ELSE</span>
<a name="ln-2439"></a>          <span class="c">! Default to very large number</span>
<a name="ln-2440"></a>          <span class="c">! BG comment why a large number here why not boilng point of water?</span>
<a name="ln-2441"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0d0</span> <span class="c">!1.0E9</span>
<a name="ln-2442"></a>        <span class="k">END IF</span>
<a name="ln-2443"></a>
<a name="ln-2444"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2445"></a>
<a name="ln-2446"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-2447"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">/=</span> <span class="n">autosize</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2448"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2449"></a>            <span class="s1">&#39;:  Heater Minimum Capacity cannot be greater than Heater Maximum Capacity&#39;</span><span class="p">)</span>
<a name="ln-2450"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2451"></a>        <span class="k">ELSE</span>
<a name="ln-2452"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2453"></a>        <span class="k">END IF</span>
<a name="ln-2454"></a>
<a name="ln-2455"></a>        <span class="c">! Validate Heater Control Type</span>
<a name="ln-2456"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-2457"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CYCLE&#39;</span><span class="p">)</span>
<a name="ln-2458"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">=</span> <span class="n">ControlTypeCycle</span>
<a name="ln-2459"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-2460"></a>
<a name="ln-2461"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;MODULATE&#39;</span><span class="p">)</span>
<a name="ln-2462"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">=</span> <span class="n">ControlTypeModulate</span>
<a name="ln-2463"></a>
<a name="ln-2464"></a>          <span class="c">!CASE (&#39;MODULATE WITH OVERHEAT&#39;)  ! Not yet implemented</span>
<a name="ln-2465"></a>
<a name="ln-2466"></a>          <span class="c">!CASE (&#39;MODULATE WITH UNDERHEAT&#39;)  ! Not yet implemented</span>
<a name="ln-2467"></a>
<a name="ln-2468"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2469"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2470"></a>              <span class="s1">&#39;:  Invalid Control Type entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2471"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2472"></a>        <span class="k">END SELECT</span>
<a name="ln-2473"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolFlowRateMin</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2474"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolFlowRateMin</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolFlowRateMin</span><span class="p">)</span>
<a name="ln-2475"></a><span class="c">!        rho = GetDensityGlycol(&#39;WATER&#39;, InitConvTemp, DummyWaterIndex, &#39;GetWaterThermalTankInput&#39;)</span>
<a name="ln-2476"></a><span class="c">!        WaterThermalTank(WaterThermalTankNum)%MassFlowRateMin = rNumericArgs(6) * rho   ! Not yet implemented</span>
<a name="ln-2477"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IgnitionDelay</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c">! Not yet implemented</span>
<a name="ln-2478"></a>
<a name="ln-2479"></a>        <span class="c">! Validate Heater Fuel Type</span>
<a name="ln-2480"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-2481"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ELECTRICITY&#39;</span><span class="p">,</span><span class="s1">&#39;ELECTRIC&#39;</span><span class="p">,</span><span class="s1">&#39;ELEC&#39;</span><span class="p">)</span>
<a name="ln-2482"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-2483"></a>
<a name="ln-2484"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURALGAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURAL GAS&#39;</span><span class="p">)</span>
<a name="ln-2485"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-2486"></a>
<a name="ln-2487"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DIESEL&#39;</span><span class="p">)</span>
<a name="ln-2488"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Diesel&#39;</span>
<a name="ln-2489"></a>
<a name="ln-2490"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GASOLINE&#39;</span><span class="p">)</span>
<a name="ln-2491"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gasoline&#39;</span>
<a name="ln-2492"></a>
<a name="ln-2493"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COAL&#39;</span><span class="p">)</span>
<a name="ln-2494"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Coal&#39;</span>
<a name="ln-2495"></a>
<a name="ln-2496"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #1&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#1&#39;</span><span class="p">,</span><span class="s1">&#39;FUEL OIL&#39;</span><span class="p">,</span><span class="s1">&#39;DISTILLATE OIL&#39;</span><span class="p">)</span>
<a name="ln-2497"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#1&#39;</span>
<a name="ln-2498"></a>
<a name="ln-2499"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #2&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#2&#39;</span><span class="p">,</span><span class="s1">&#39;RESIDUAL OIL&#39;</span><span class="p">)</span>
<a name="ln-2500"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#2&#39;</span>
<a name="ln-2501"></a>
<a name="ln-2502"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PROPANE&#39;</span><span class="p">,</span><span class="s1">&#39;LPG&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANEGAS&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANE GAS&#39;</span><span class="p">)</span>
<a name="ln-2503"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Propane&#39;</span>
<a name="ln-2504"></a>
<a name="ln-2505"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL1&#39;</span><span class="p">)</span>
<a name="ln-2506"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel1&#39;</span>
<a name="ln-2507"></a>
<a name="ln-2508"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL2&#39;</span><span class="p">)</span>
<a name="ln-2509"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel2&#39;</span>
<a name="ln-2510"></a>
<a name="ln-2511"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">)</span>
<a name="ln-2512"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Steam&#39;</span>
<a name="ln-2513"></a>
<a name="ln-2514"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DISTRICTHEATING&#39;</span><span class="p">)</span>
<a name="ln-2515"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeating&#39;</span>
<a name="ln-2516"></a>
<a name="ln-2517"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2518"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2519"></a>              <span class="s1">&#39;:  Invalid Heater Fuel Type entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-2520"></a>            <span class="c">! Set to Electric to avoid errors when setting up output variables</span>
<a name="ln-2521"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-2522"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2523"></a>        <span class="k">END SELECT</span>
<a name="ln-2524"></a>
<a name="ln-2525"></a>
<a name="ln-2526"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2527"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2528"></a>        <span class="k">ELSE</span>
<a name="ln-2529"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2530"></a>             <span class="s1">&#39;:  Heater Thermal Efficiency must be greater than zero&#39;</span><span class="p">)</span>
<a name="ln-2531"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2532"></a>        <span class="k">END IF</span>
<a name="ln-2533"></a>
<a name="ln-2534"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2535"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PLFCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-2536"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PLFCurve</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2537"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2538"></a>              <span class="s1">&#39;:  Part Load Factor curve not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-2539"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2540"></a>          <span class="k">ELSE</span>
<a name="ln-2541"></a><span class="k">            CALL </span><span class="n">ValidatePLFCurve</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PLFCurve</span><span class="p">,</span> <span class="n">IsValid</span><span class="p">)</span>
<a name="ln-2542"></a>
<a name="ln-2543"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsValid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2544"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2545"></a>                <span class="s1">&#39;:  Part Load Factor curve failed to evaluate to greater than zero for all numbers in the domain of 0 to 1&#39;</span><span class="p">)</span>
<a name="ln-2546"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2547"></a>            <span class="k">END IF</span>
<a name="ln-2548"></a><span class="k">          END IF</span>
<a name="ln-2549"></a><span class="k">        END IF</span>
<a name="ln-2550"></a>
<a name="ln-2551"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2552"></a>
<a name="ln-2553"></a>        <span class="c">! Validate Off-Cycle Parasitic Fuel Type</span>
<a name="ln-2554"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-2555"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c">! If blank, default to Fuel Type for heater</span>
<a name="ln-2556"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span>
<a name="ln-2557"></a>
<a name="ln-2558"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ELECTRICITY&#39;</span><span class="p">,</span><span class="s1">&#39;ELECTRIC&#39;</span><span class="p">,</span><span class="s1">&#39;ELEC&#39;</span><span class="p">)</span>
<a name="ln-2559"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-2560"></a>
<a name="ln-2561"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURALGAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURAL GAS&#39;</span><span class="p">)</span>
<a name="ln-2562"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-2563"></a>
<a name="ln-2564"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DIESEL&#39;</span><span class="p">)</span>
<a name="ln-2565"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Diesel&#39;</span>
<a name="ln-2566"></a>
<a name="ln-2567"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GASOLINE&#39;</span><span class="p">)</span>
<a name="ln-2568"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Gasoline&#39;</span>
<a name="ln-2569"></a>
<a name="ln-2570"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COAL&#39;</span><span class="p">)</span>
<a name="ln-2571"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Coal&#39;</span>
<a name="ln-2572"></a>
<a name="ln-2573"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #1&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#1&#39;</span><span class="p">,</span><span class="s1">&#39;FUEL OIL&#39;</span><span class="p">,</span><span class="s1">&#39;DISTILLATE OIL&#39;</span><span class="p">)</span>
<a name="ln-2574"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#1&#39;</span>
<a name="ln-2575"></a>
<a name="ln-2576"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #2&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#2&#39;</span><span class="p">,</span><span class="s1">&#39;RESIDUAL OIL&#39;</span><span class="p">)</span>
<a name="ln-2577"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#2&#39;</span>
<a name="ln-2578"></a>
<a name="ln-2579"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PROPANE&#39;</span><span class="p">,</span><span class="s1">&#39;LPG&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANEGAS&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANE GAS&#39;</span><span class="p">)</span>
<a name="ln-2580"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Propane&#39;</span>
<a name="ln-2581"></a>
<a name="ln-2582"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL1&#39;</span><span class="p">)</span>
<a name="ln-2583"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel1&#39;</span>
<a name="ln-2584"></a>
<a name="ln-2585"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL2&#39;</span><span class="p">)</span>
<a name="ln-2586"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel2&#39;</span>
<a name="ln-2587"></a>
<a name="ln-2588"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">)</span>
<a name="ln-2589"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Steam&#39;</span>
<a name="ln-2590"></a>
<a name="ln-2591"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DISTRICTHEATING&#39;</span><span class="p">)</span>
<a name="ln-2592"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeating&#39;</span>
<a name="ln-2593"></a>
<a name="ln-2594"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2595"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2596"></a>              <span class="s1">&#39;:  Invalid Off-Cycle Parasitic Fuel Type entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2597"></a>            <span class="c">! Set to Electric to avoid errors when setting up output variables</span>
<a name="ln-2598"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-2599"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2600"></a>        <span class="k">END SELECT</span>
<a name="ln-2601"></a>
<a name="ln-2602"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2603"></a>
<a name="ln-2604"></a>
<a name="ln-2605"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-2606"></a>
<a name="ln-2607"></a>        <span class="c">! Validate On-Cycle Parasitic Fuel Type</span>
<a name="ln-2608"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-2609"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c">! If blank, default to Fuel Type for heater</span>
<a name="ln-2610"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span>
<a name="ln-2611"></a>
<a name="ln-2612"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ELECTRICITY&#39;</span><span class="p">,</span><span class="s1">&#39;ELECTRIC&#39;</span><span class="p">,</span><span class="s1">&#39;ELEC&#39;</span><span class="p">)</span>
<a name="ln-2613"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-2614"></a>
<a name="ln-2615"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURALGAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURAL GAS&#39;</span><span class="p">)</span>
<a name="ln-2616"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-2617"></a>
<a name="ln-2618"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DIESEL&#39;</span><span class="p">)</span>
<a name="ln-2619"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Diesel&#39;</span>
<a name="ln-2620"></a>
<a name="ln-2621"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GASOLINE&#39;</span><span class="p">)</span>
<a name="ln-2622"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Gasoline&#39;</span>
<a name="ln-2623"></a>
<a name="ln-2624"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COAL&#39;</span><span class="p">)</span>
<a name="ln-2625"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Coal&#39;</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #1&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#1&#39;</span><span class="p">,</span><span class="s1">&#39;FUEL OIL&#39;</span><span class="p">,</span><span class="s1">&#39;DISTILLATE OIL&#39;</span><span class="p">)</span>
<a name="ln-2628"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#1&#39;</span>
<a name="ln-2629"></a>
<a name="ln-2630"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #2&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#2&#39;</span><span class="p">,</span><span class="s1">&#39;RESIDUAL OIL&#39;</span><span class="p">)</span>
<a name="ln-2631"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#2&#39;</span>
<a name="ln-2632"></a>
<a name="ln-2633"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PROPANE&#39;</span><span class="p">,</span><span class="s1">&#39;LPG&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANEGAS&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANE GAS&#39;</span><span class="p">)</span>
<a name="ln-2634"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Propane&#39;</span>
<a name="ln-2635"></a>
<a name="ln-2636"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL1&#39;</span><span class="p">)</span>
<a name="ln-2637"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel1&#39;</span>
<a name="ln-2638"></a>
<a name="ln-2639"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL2&#39;</span><span class="p">)</span>
<a name="ln-2640"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel2&#39;</span>
<a name="ln-2641"></a>
<a name="ln-2642"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">)</span>
<a name="ln-2643"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Steam&#39;</span>
<a name="ln-2644"></a>
<a name="ln-2645"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DISTRICTHEATING&#39;</span><span class="p">)</span>
<a name="ln-2646"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeating&#39;</span>
<a name="ln-2647"></a>
<a name="ln-2648"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2649"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2650"></a>              <span class="s1">&#39;:  Invalid On-Cycle Parasitic Fuel Type entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-2651"></a>            <span class="c">! Set to Electric to avoid errors when setting up output variables</span>
<a name="ln-2652"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-2653"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2654"></a>        <span class="k">END SELECT</span>
<a name="ln-2655"></a>
<a name="ln-2656"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2657"></a>
<a name="ln-2658"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-2659"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SCHEDULE&#39;</span><span class="p">)</span>
<a name="ln-2660"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempSchedule</span>
<a name="ln-2661"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-2662"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2663"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2664"></a>                <span class="s1">&#39;:  Ambient Temperature Schedule not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-2665"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2666"></a>            <span class="k">END IF</span>
<a name="ln-2667"></a>
<a name="ln-2668"></a><span class="k">          CASE</span> <span class="p">(</span><span class="s1">&#39;ZONE&#39;</span><span class="p">)</span>
<a name="ln-2669"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempZone</span>
<a name="ln-2670"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-2671"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2672"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2673"></a>                <span class="s1">&#39;:  Ambient Temperature Zone not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-2674"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2675"></a>            <span class="k">END IF</span>
<a name="ln-2676"></a>
<a name="ln-2677"></a><span class="k">          CASE</span> <span class="p">(</span><span class="s1">&#39;OUTDOORS&#39;</span><span class="p">)</span>
<a name="ln-2678"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempOutsideAir</span>
<a name="ln-2679"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempOutsideAirNode</span> <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2680"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">NodeType_Air</span><span class="p">,</span> <span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2681"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2682"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempOutsideAirNode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2683"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2684"></a>                   <span class="s1">&#39;: Outdoor Air Node not on OutdoorAir:NodeList or OutdoorAir:Node&#39;</span><span class="p">)</span>
<a name="ln-2685"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Referenced Node Name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-2686"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2687"></a>              <span class="n">ENDIF</span>
<a name="ln-2688"></a>            <span class="k">ELSE</span>
<a name="ln-2689"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2690"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;An Ambient Outdoor Air Node name must be used when&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2691"></a>                               <span class="s1">&#39; the Ambient Temperature Indicator is Outdoors.&#39;</span><span class="p">)</span>
<a name="ln-2692"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2693"></a>            <span class="n">ENDIF</span>
<a name="ln-2694"></a>
<a name="ln-2695"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2696"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2697"></a>              <span class="s1">&#39;:  Invalid Ambient Temperature Indicator entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-2698"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Valid entries are SCHEDULE, ZONE, and OUTDOORS.&#39;</span><span class="p">)</span>
<a name="ln-2699"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2700"></a>        <span class="k">END SELECT</span>
<a name="ln-2701"></a>
<a name="ln-2702"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-2703"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossFracToZone</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-2704"></a>
<a name="ln-2705"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-2706"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycLossFracToZone</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-2707"></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-2708"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2709"></a>
<a name="ln-2710"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2711"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2712"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-2713"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2714"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2715"></a>                <span class="s1">&#39;:  Flow Rate Schedule not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-2716"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2717"></a>            <span class="k">END IF</span>
<a name="ln-2718"></a><span class="k">          END IF</span>
<a name="ln-2719"></a><span class="k">        END IF</span>
<a name="ln-2720"></a>
<a name="ln-2721"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2722"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<a name="ln-2723"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2724"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2725"></a>              <span class="s1">&#39;:  Cold Water Supply Temperature Schedule not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)))</span>
<a name="ln-2726"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2727"></a>          <span class="k">END IF</span>
<a name="ln-2728"></a><span class="k">        END IF</span>
<a name="ln-2729"></a>
<a name="ln-2730"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2731"></a><span class="k">          IF</span> <span class="p">((</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2732"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2733"></a>              <span class="s1">&#39;:  Use Side Effectiveness is out of bounds (0 to 1)&#39;</span><span class="p">)</span>
<a name="ln-2734"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2735"></a>          <span class="k">END IF</span>
<a name="ln-2736"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-2737"></a>        <span class="k">ELSE</span>
<a name="ln-2738"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! Default for stand-alone mode</span>
<a name="ln-2739"></a>        <span class="k">END IF</span>
<a name="ln-2740"></a>
<a name="ln-2741"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2742"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2743"></a>            <span class="s1">&#39;:  Source Side Effectiveness is out of bounds (0 to 1)&#39;</span><span class="p">)</span>
<a name="ln-2744"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2745"></a>        <span class="k">END IF</span>
<a name="ln-2746"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-2747"></a>
<a name="ln-2748"></a>        <span class="c">! If no plant nodes are connected, simulate in stand-alone mode.</span>
<a name="ln-2749"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2750"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">StandAlone</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2751"></a>        <span class="n">ENDIF</span>
<a name="ln-2752"></a>
<a name="ln-2753"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2754"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-2755"></a>        <span class="k">ELSE</span>
<a name="ln-2756"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2757"></a>        <span class="n">ENDIF</span>
<a name="ln-2758"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">=</span> <span class="n">DemandSupply_No</span>
<a name="ln-2759"></a>
<a name="ln-2760"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2761"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-2762"></a>        <span class="k">ELSE</span>
<a name="ln-2763"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2764"></a>        <span class="k">END IF</span>
<a name="ln-2765"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">=</span> <span class="n">DemandSupply_No</span>
<a name="ln-2766"></a>
<a name="ln-2767"></a>        <span class="k">If</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2768"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SizingRecoveryTime</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<a name="ln-2769"></a>        <span class="k">ELSE</span>
<a name="ln-2770"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SizingRecoveryTime</span>      <span class="o">=</span> <span class="mf">1.5d0</span>
<a name="ln-2771"></a>        <span class="k">END IF</span>
<a name="ln-2772"></a>
<a name="ln-2773"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2774"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2775"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2776"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2777"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName1</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-2778"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2779"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2780"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2781"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-2782"></a>
<a name="ln-2783"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2784"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2785"></a>              <span class="s1">&#39;:  Use side nodes are specified; Peak Volumetric Use Flow Rate will not be used&#39;</span><span class="p">)</span>
<a name="ln-2786"></a>          <span class="k">END IF</span>
<a name="ln-2787"></a>
<a name="ln-2788"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2789"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2790"></a>              <span class="s1">&#39;:  Use side nodes are specified; Use Flow Rate Fraction Schedule will not be used&#39;</span><span class="p">)</span>
<a name="ln-2791"></a>          <span class="k">END IF</span>
<a name="ln-2792"></a>
<a name="ln-2793"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTempSchedule</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2794"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2795"></a>              <span class="s1">&#39;:  Use side nodes are specified; Cold Water Supply Temperature Schedule will not be used&#39;</span><span class="p">)</span>
<a name="ln-2796"></a>          <span class="k">END IF</span>
<a name="ln-2797"></a><span class="k">        END IF</span>
<a name="ln-2798"></a>
<a name="ln-2799"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2800"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2801"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2802"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2803"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName2</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-2804"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2805"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2806"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-2807"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-2808"></a>
<a name="ln-2809"></a>        <span class="k">END IF</span>
<a name="ln-2810"></a>
<a name="ln-2811"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2812"></a><span class="k">          SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span>
<a name="ln-2813"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;STORAGETANK&#39;</span> <span class="p">)</span>
<a name="ln-2814"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">=</span> <span class="n">SourceSideStorageTank</span>
<a name="ln-2815"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;INDIRECTHEATPRIMARYSETPOINT&#39;</span><span class="p">)</span>
<a name="ln-2816"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">=</span> <span class="n">SourceSideIndirectHeatPrimarySetpoint</span>
<a name="ln-2817"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;INDIRECTHEATALTERNATESETPOINT&#39;</span> <span class="p">)</span>
<a name="ln-2818"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">=</span> <span class="n">SourceSideIndirectHeatAltSetpoint</span>
<a name="ln-2819"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2820"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2821"></a>              <span class="s1">&#39;:  Invalid Control Mode entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)))</span>
<a name="ln-2822"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2823"></a>          <span class="k">END SELECT</span>
<a name="ln-2824"></a><span class="k">        ELSE</span>
<a name="ln-2825"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">=</span> <span class="n">SourceSideIndirectHeatPrimarySetpoint</span>
<a name="ln-2826"></a>        <span class="n">ENDIF</span>
<a name="ln-2827"></a>
<a name="ln-2828"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2829"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAltSetpointSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span>
<a name="ln-2830"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAltSetpointSchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2831"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2832"></a>              <span class="s1">&#39;:  &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)))</span>
<a name="ln-2833"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2834"></a>          <span class="n">ENDIF</span>
<a name="ln-2835"></a>        <span class="n">ENDIF</span>
<a name="ln-2836"></a>
<a name="ln-2837"></a>
<a name="ln-2838"></a>      <span class="k">END DO</span> <span class="c">! WaterThermalTankNum</span>
<a name="ln-2839"></a>
<a name="ln-2840"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2841"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2842"></a>           <span class="s1">&#39; input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2843"></a>      <span class="k">END IF</span>
<a name="ln-2844"></a>
<a name="ln-2845"></a><span class="k">    END IF</span>
<a name="ln-2846"></a>
<a name="ln-2847"></a>
<a name="ln-2848"></a><span class="c">!!!=======   Get WATER HEATER:STRATIFIED ==============================================================================</span>
<a name="ln-2849"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterHeaterStratified</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2850"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cStratifiedWHModuleObj</span> <span class="c">!&#39;WaterHeater:Stratified&#39;</span>
<a name="ln-2851"></a>
<a name="ln-2852"></a>      <span class="k">DO </span><span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="n">NumWaterHeaterMixed</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterHeaterMixed</span> <span class="o">+</span> <span class="n">NumWaterHeaterStratified</span>
<a name="ln-2853"></a>
<a name="ln-2854"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">WaterThermalTankNum</span><span class="o">-</span><span class="n">NumWaterHeaterMixed</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2855"></a>          <span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2856"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2857"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-2858"></a>
<a name="ln-2859"></a>        <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2860"></a>        <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2861"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterThermalTankNum</span><span class="o">-</span><span class="n">NumWaterHeaterMixed</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2862"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2863"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2864"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2865"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-2866"></a>        <span class="k">END IF</span>
<a name="ln-2867"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2868"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span> <span class="o">=</span> <span class="n">cCurrentModuleObject</span>
<a name="ln-2869"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">=</span> <span class="n">StratifiedWaterHeater</span>
<a name="ln-2870"></a>
<a name="ln-2871"></a>        <span class="c">! default to always on</span>
<a name="ln-2872"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-2873"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-2874"></a>
<a name="ln-2875"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2876"></a>
<a name="ln-2877"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2878"></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-2879"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mass</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-2880"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2881"></a>
<a name="ln-2882"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-2883"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;VERTICALCYLINDER&#39;</span><span class="p">)</span>
<a name="ln-2884"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">TankShapeVertCylinder</span>
<a name="ln-2885"></a>
<a name="ln-2886"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;HORIZONTALCYLINDER&#39;</span><span class="p">)</span>
<a name="ln-2887"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">TankShapeHorizCylinder</span>
<a name="ln-2888"></a>
<a name="ln-2889"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHER&#39;</span><span class="p">)</span>
<a name="ln-2890"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">TankShapeOther</span>
<a name="ln-2891"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2892"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Perimeter</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2893"></a>            <span class="k">ELSE</span>
<a name="ln-2894"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2895"></a>                <span class="s1">&#39;:  Tank Perimeter must be greater than zero for Tank Shape=OTHER&#39;</span><span class="p">)</span>
<a name="ln-2896"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2897"></a>            <span class="k">END IF</span>
<a name="ln-2898"></a>
<a name="ln-2899"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-2900"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2901"></a>              <span class="s1">&#39;:  Invalid Tank Shape entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2902"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">TankShapeVertCylinder</span>
<a name="ln-2903"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2904"></a>        <span class="k">END SELECT</span>
<a name="ln-2905"></a>
<a name="ln-2906"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2907"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2908"></a>        <span class="k">ELSE</span>
<a name="ln-2909"></a>          <span class="c">! Default to very large number</span>
<a name="ln-2910"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">=</span> <span class="mf">1.0d9</span>
<a name="ln-2911"></a>        <span class="k">END IF</span>
<a name="ln-2912"></a>
<a name="ln-2913"></a>        <span class="c">! Validate Heater Priority Control</span>
<a name="ln-2914"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-2915"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;MASTERSLAVE&#39;</span><span class="p">)</span>
<a name="ln-2916"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">=</span> <span class="n">PriorityMasterSlave</span>
<a name="ln-2917"></a>
<a name="ln-2918"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SIMULTANEOUS&#39;</span><span class="p">)</span>
<a name="ln-2919"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">=</span> <span class="n">PrioritySimultaneous</span>
<a name="ln-2920"></a>
<a name="ln-2921"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2922"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2923"></a>              <span class="s1">&#39;:  Invalid Heater Priority Control entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-2924"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2925"></a>        <span class="k">END SELECT</span>
<a name="ln-2926"></a>
<a name="ln-2927"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-2928"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2929"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, missing data.&#39;</span><span class="p">)</span>
<a name="ln-2930"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;blank field, missing &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is required&#39;</span><span class="p">)</span>
<a name="ln-2931"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2932"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2933"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2934"></a>            <span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-2935"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2936"></a>        <span class="k">END IF</span>
<a name="ln-2937"></a>
<a name="ln-2938"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2939"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2940"></a>        <span class="k">ELSE</span>
<a name="ln-2941"></a>          <span class="c">! Default to very small number (however it can&#39;t be TINY or it will break the algorithm)</span>
<a name="ln-2942"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span> <span class="o">=</span> <span class="mf">0.0001d0</span>
<a name="ln-2943"></a>        <span class="k">END IF</span>
<a name="ln-2944"></a>
<a name="ln-2945"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2946"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight1</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2947"></a>
<a name="ln-2948"></a>        <span class="c">!Test if Heater height is within range</span>
<a name="ln-2949"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2950"></a>            <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight1</span> <span class="p">&amp;</span>
<a name="ln-2951"></a>                <span class="o">&gt;</span>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2952"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2953"></a>            <span class="s1">&#39;: Heater 1 is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-2954"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2955"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2956"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2957"></a>        <span class="n">ENDIF</span>
<a name="ln-2958"></a>
<a name="ln-2959"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule2</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-2960"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2961"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, missing data.&#39;</span><span class="p">)</span>
<a name="ln-2962"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;blank field, missing &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is required&#39;</span><span class="p">)</span>
<a name="ln-2963"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2964"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2965"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2966"></a>            <span class="s1">&#39;:  &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2967"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2968"></a>        <span class="k">END IF</span>
<a name="ln-2969"></a>
<a name="ln-2970"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2971"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp2</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-2972"></a>        <span class="k">ELSE</span>
<a name="ln-2973"></a>          <span class="c">! Default to very small number (however it can&#39;t be TINY or it will break the algorithm)</span>
<a name="ln-2974"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp2</span> <span class="o">=</span> <span class="mf">0.0001d0</span>
<a name="ln-2975"></a>        <span class="k">END IF</span>
<a name="ln-2976"></a>
<a name="ln-2977"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity2</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-2978"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight2</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-2979"></a>
<a name="ln-2980"></a>        <span class="c">!Test if Heater height is within range</span>
<a name="ln-2981"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2982"></a>            <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight2</span> <span class="p">&amp;</span>
<a name="ln-2983"></a>                 <span class="o">&gt;</span>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2984"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2985"></a>            <span class="s1">&#39;: Heater 2 is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-2986"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2987"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2988"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2989"></a>        <span class="n">ENDIF</span>
<a name="ln-2990"></a>
<a name="ln-2991"></a>        <span class="c">! Validate Heater Fuel Type</span>
<a name="ln-2992"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-2993"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ELECTRICITY&#39;</span><span class="p">,</span><span class="s1">&#39;ELECTRIC&#39;</span><span class="p">,</span><span class="s1">&#39;ELEC&#39;</span><span class="p">)</span>
<a name="ln-2994"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-2995"></a>
<a name="ln-2996"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURALGAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURAL GAS&#39;</span><span class="p">)</span>
<a name="ln-2997"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-2998"></a>
<a name="ln-2999"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DIESEL&#39;</span><span class="p">)</span>
<a name="ln-3000"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Diesel&#39;</span>
<a name="ln-3001"></a>
<a name="ln-3002"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GASOLINE&#39;</span><span class="p">)</span>
<a name="ln-3003"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Gasoline&#39;</span>
<a name="ln-3004"></a>
<a name="ln-3005"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COAL&#39;</span><span class="p">)</span>
<a name="ln-3006"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Coal&#39;</span>
<a name="ln-3007"></a>
<a name="ln-3008"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #1&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#1&#39;</span><span class="p">,</span><span class="s1">&#39;FUEL OIL&#39;</span><span class="p">,</span><span class="s1">&#39;DISTILLATE OIL&#39;</span><span class="p">)</span>
<a name="ln-3009"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#1&#39;</span>
<a name="ln-3010"></a>
<a name="ln-3011"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #2&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#2&#39;</span><span class="p">,</span><span class="s1">&#39;RESIDUAL OIL&#39;</span><span class="p">)</span>
<a name="ln-3012"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#2&#39;</span>
<a name="ln-3013"></a>
<a name="ln-3014"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PROPANE&#39;</span><span class="p">,</span><span class="s1">&#39;LPG&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANEGAS&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANE GAS&#39;</span><span class="p">)</span>
<a name="ln-3015"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Propane&#39;</span>
<a name="ln-3016"></a>
<a name="ln-3017"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL1&#39;</span><span class="p">)</span>
<a name="ln-3018"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel1&#39;</span>
<a name="ln-3019"></a>
<a name="ln-3020"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL2&#39;</span><span class="p">)</span>
<a name="ln-3021"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel2&#39;</span>
<a name="ln-3022"></a>
<a name="ln-3023"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">)</span>
<a name="ln-3024"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Steam&#39;</span>
<a name="ln-3025"></a>
<a name="ln-3026"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DISTRICTHEATING&#39;</span><span class="p">)</span>
<a name="ln-3027"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeating&#39;</span>
<a name="ln-3028"></a>
<a name="ln-3029"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3030"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3031"></a>              <span class="s1">&#39;:  Invalid Heater Fuel Type entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-3032"></a>            <span class="c">! Set to Electric to avoid errors when setting up output variables</span>
<a name="ln-3033"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3034"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3035"></a>        <span class="k">END SELECT</span>
<a name="ln-3036"></a>
<a name="ln-3037"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3038"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3039"></a>        <span class="k">ELSE</span>
<a name="ln-3040"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3041"></a>             <span class="s1">&#39;:  Heater Thermal Efficiency must be greater than zero&#39;</span><span class="p">)</span>
<a name="ln-3042"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3043"></a>        <span class="k">END IF</span>
<a name="ln-3044"></a>
<a name="ln-3045"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3046"></a>
<a name="ln-3047"></a>        <span class="c">! Validate Off-Cycle Parasitic Fuel Type</span>
<a name="ln-3048"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-3049"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c">! If blank, default to Fuel Type for heater</span>
<a name="ln-3050"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span>
<a name="ln-3051"></a>
<a name="ln-3052"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ELECTRICITY&#39;</span><span class="p">,</span><span class="s1">&#39;ELECTRIC&#39;</span><span class="p">,</span><span class="s1">&#39;ELEC&#39;</span><span class="p">)</span>
<a name="ln-3053"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3054"></a>
<a name="ln-3055"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURALGAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURAL GAS&#39;</span><span class="p">)</span>
<a name="ln-3056"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-3057"></a>
<a name="ln-3058"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DIESEL&#39;</span><span class="p">)</span>
<a name="ln-3059"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Diesel&#39;</span>
<a name="ln-3060"></a>
<a name="ln-3061"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GASOLINE&#39;</span><span class="p">)</span>
<a name="ln-3062"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Gasoline&#39;</span>
<a name="ln-3063"></a>
<a name="ln-3064"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COAL&#39;</span><span class="p">)</span>
<a name="ln-3065"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Coal&#39;</span>
<a name="ln-3066"></a>
<a name="ln-3067"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #1&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#1&#39;</span><span class="p">,</span><span class="s1">&#39;FUEL OIL&#39;</span><span class="p">,</span><span class="s1">&#39;DISTILLATE OIL&#39;</span><span class="p">)</span>
<a name="ln-3068"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#1&#39;</span>
<a name="ln-3069"></a>
<a name="ln-3070"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #2&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#2&#39;</span><span class="p">,</span><span class="s1">&#39;RESIDUAL OIL&#39;</span><span class="p">)</span>
<a name="ln-3071"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#2&#39;</span>
<a name="ln-3072"></a>
<a name="ln-3073"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PROPANE&#39;</span><span class="p">,</span><span class="s1">&#39;LPG&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANEGAS&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANE GAS&#39;</span><span class="p">)</span>
<a name="ln-3074"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Propane&#39;</span>
<a name="ln-3075"></a>
<a name="ln-3076"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL1&#39;</span><span class="p">)</span>
<a name="ln-3077"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel1&#39;</span>
<a name="ln-3078"></a>
<a name="ln-3079"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL2&#39;</span><span class="p">)</span>
<a name="ln-3080"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel2&#39;</span>
<a name="ln-3081"></a>
<a name="ln-3082"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">)</span>
<a name="ln-3083"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Steam&#39;</span>
<a name="ln-3084"></a>
<a name="ln-3085"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DISTRICTHEATING&#39;</span><span class="p">)</span>
<a name="ln-3086"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeating&#39;</span>
<a name="ln-3087"></a>
<a name="ln-3088"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3089"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3090"></a>              <span class="s1">&#39;:  Invalid Off-Cycle Parasitic Fuel Type entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-3091"></a>            <span class="c">! Set to Electric to avoid errors when setting up output variables</span>
<a name="ln-3092"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3093"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3094"></a>        <span class="k">END SELECT</span>
<a name="ln-3095"></a>
<a name="ln-3096"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3097"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-3098"></a>
<a name="ln-3099"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-3100"></a>
<a name="ln-3101"></a>        <span class="c">! Validate On-Cycle Parasitic Fuel Type</span>
<a name="ln-3102"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-3103"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c">! If blank, default to Fuel Type for heater</span>
<a name="ln-3104"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span>
<a name="ln-3105"></a>
<a name="ln-3106"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ELECTRICITY&#39;</span><span class="p">,</span><span class="s1">&#39;ELECTRIC&#39;</span><span class="p">,</span><span class="s1">&#39;ELEC&#39;</span><span class="p">)</span>
<a name="ln-3107"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3108"></a>
<a name="ln-3109"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURALGAS&#39;</span><span class="p">,</span><span class="s1">&#39;NATURAL GAS&#39;</span><span class="p">)</span>
<a name="ln-3110"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Gas&#39;</span>
<a name="ln-3111"></a>
<a name="ln-3112"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DIESEL&#39;</span><span class="p">)</span>
<a name="ln-3113"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Diesel&#39;</span>
<a name="ln-3114"></a>
<a name="ln-3115"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;GASOLINE&#39;</span><span class="p">)</span>
<a name="ln-3116"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Gasoline&#39;</span>
<a name="ln-3117"></a>
<a name="ln-3118"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COAL&#39;</span><span class="p">)</span>
<a name="ln-3119"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Coal&#39;</span>
<a name="ln-3120"></a>
<a name="ln-3121"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #1&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#1&#39;</span><span class="p">,</span><span class="s1">&#39;FUEL OIL&#39;</span><span class="p">,</span><span class="s1">&#39;DISTILLATE OIL&#39;</span><span class="p">)</span>
<a name="ln-3122"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#1&#39;</span>
<a name="ln-3123"></a>
<a name="ln-3124"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FUEL OIL #2&#39;</span><span class="p">,</span><span class="s1">&#39;FUELOIL#2&#39;</span><span class="p">,</span><span class="s1">&#39;RESIDUAL OIL&#39;</span><span class="p">)</span>
<a name="ln-3125"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;FuelOil#2&#39;</span>
<a name="ln-3126"></a>
<a name="ln-3127"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;PROPANE&#39;</span><span class="p">,</span><span class="s1">&#39;LPG&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANEGAS&#39;</span><span class="p">,</span><span class="s1">&#39;PROPANE GAS&#39;</span><span class="p">)</span>
<a name="ln-3128"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Propane&#39;</span>
<a name="ln-3129"></a>
<a name="ln-3130"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL1&#39;</span><span class="p">)</span>
<a name="ln-3131"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel1&#39;</span>
<a name="ln-3132"></a>
<a name="ln-3133"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHERFUEL2&#39;</span><span class="p">)</span>
<a name="ln-3134"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;OtherFuel2&#39;</span>
<a name="ln-3135"></a>
<a name="ln-3136"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">)</span>
<a name="ln-3137"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Steam&#39;</span>
<a name="ln-3138"></a>
<a name="ln-3139"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DISTRICTHEATING&#39;</span><span class="p">)</span>
<a name="ln-3140"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;DistrictHeating&#39;</span>
<a name="ln-3141"></a>
<a name="ln-3142"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3143"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3144"></a>              <span class="s1">&#39;:  Invalid On-Cycle Parasitic Fuel Type entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-3145"></a>            <span class="c">! Set to Electric to avoid errors when setting up output variables</span>
<a name="ln-3146"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3147"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3148"></a>        <span class="k">END SELECT</span>
<a name="ln-3149"></a>
<a name="ln-3150"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-3151"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-3152"></a>
<a name="ln-3153"></a>
<a name="ln-3154"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-3155"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SCHEDULE&#39;</span><span class="p">)</span>
<a name="ln-3156"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempSchedule</span>
<a name="ln-3157"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-3158"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3159"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3160"></a>                <span class="s1">&#39;:  Ambient Temperature Schedule not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-3161"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3162"></a>            <span class="k">END IF</span>
<a name="ln-3163"></a>
<a name="ln-3164"></a><span class="k">          CASE</span> <span class="p">(</span><span class="s1">&#39;ZONE&#39;</span><span class="p">)</span>
<a name="ln-3165"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempZone</span>
<a name="ln-3166"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-3167"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3168"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3169"></a>                <span class="s1">&#39;:  Ambient Temperature Zone not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-3170"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3171"></a>            <span class="k">END IF</span>
<a name="ln-3172"></a>
<a name="ln-3173"></a><span class="k">          CASE</span> <span class="p">(</span><span class="s1">&#39;OUTDOORS&#39;</span><span class="p">)</span>
<a name="ln-3174"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempOutsideAir</span>
<a name="ln-3175"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempOutsideAirNode</span> <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3176"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">NodeType_Air</span><span class="p">,</span> <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3177"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3178"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempOutsideAirNode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3179"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3180"></a>                   <span class="s1">&#39;: Outdoor Air Node not on OutdoorAir:NodeList or OutdoorAir:Node&#39;</span><span class="p">)</span>
<a name="ln-3181"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Referenced Node Name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)))</span>
<a name="ln-3182"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3183"></a>              <span class="n">ENDIF</span>
<a name="ln-3184"></a>            <span class="k">ELSE</span>
<a name="ln-3185"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3186"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;An Ambient Outdoor Air Node name must be used when&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3187"></a>                               <span class="s1">&#39; the Ambient Temperature Indicator is Outdoors.&#39;</span><span class="p">)</span>
<a name="ln-3188"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3189"></a>            <span class="n">ENDIF</span>
<a name="ln-3190"></a>
<a name="ln-3191"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3192"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3193"></a>              <span class="s1">&#39;:  Invalid Ambient Temperature Indicator entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-3194"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Valid entries are Schedule, Zone, and Outdoors.&#39;</span><span class="p">)</span>
<a name="ln-3195"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3196"></a>        <span class="k">END SELECT</span>
<a name="ln-3197"></a>
<a name="ln-3198"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossCoeff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-3199"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossFracToZone</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-3200"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycFlueLossCoeff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<a name="ln-3201"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycFlueLossFracToZone</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-3202"></a>
<a name="ln-3203"></a>        <span class="c">!this is temporary until we know fluid type</span>
<a name="ln-3204"></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-3205"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-3206"></a>
<a name="ln-3207"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3208"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3209"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<a name="ln-3210"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3211"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3212"></a>                <span class="s1">&#39;:  Flow Rate Schedule not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)))</span>
<a name="ln-3213"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3214"></a>            <span class="k">END IF</span>
<a name="ln-3215"></a><span class="k">          END IF</span>
<a name="ln-3216"></a><span class="k">        END IF</span>
<a name="ln-3217"></a>
<a name="ln-3218"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3219"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<a name="ln-3220"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3221"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3222"></a>              <span class="s1">&#39;:  Cold Water Supply Temperature Schedule not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-3223"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3224"></a>          <span class="k">END IF</span>
<a name="ln-3225"></a><span class="k">        END IF</span>
<a name="ln-3226"></a>
<a name="ln-3227"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">22</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3228"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<a name="ln-3229"></a>        <span class="k">ELSE</span>
<a name="ln-3230"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">! Default for stand-alone mode</span>
<a name="ln-3231"></a>        <span class="k">END IF</span>
<a name="ln-3232"></a>
<a name="ln-3233"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">23</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3234"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<a name="ln-3235"></a>        <span class="k">ELSE</span>
<a name="ln-3236"></a>         <span class="c">! Defaults to bottom of tank</span>
<a name="ln-3237"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletHeight</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3238"></a>        <span class="k">END IF</span>
<a name="ln-3239"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3240"></a>            <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletHeight</span> <span class="p">&amp;</span>
<a name="ln-3241"></a>                   <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3242"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3243"></a>            <span class="s1">&#39;: Use inlet is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-3244"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3245"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3246"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3247"></a>        <span class="n">ENDIF</span>
<a name="ln-3248"></a>
<a name="ln-3249"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Autocalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3250"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<a name="ln-3251"></a>        <span class="k">ELSE</span>
<a name="ln-3252"></a>          <span class="c">! Defaults to top of tank</span>
<a name="ln-3253"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletHeight</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-3254"></a>        <span class="k">END IF</span>
<a name="ln-3255"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3256"></a>            <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletHeight</span> <span class="p">&amp;</span>
<a name="ln-3257"></a>              <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3258"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3259"></a>            <span class="s1">&#39;: Use outlet is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-3260"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3261"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3262"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3263"></a>        <span class="n">ENDIF</span>
<a name="ln-3264"></a>
<a name="ln-3265"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3266"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
<a name="ln-3267"></a>        <span class="k">ELSE</span>
<a name="ln-3268"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-3269"></a>        <span class="k">END IF</span>
<a name="ln-3270"></a>
<a name="ln-3271"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">26</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Autocalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3272"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<a name="ln-3273"></a>        <span class="k">ELSE</span>
<a name="ln-3274"></a>          <span class="c">! Defaults to top of tank</span>
<a name="ln-3275"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletHeight</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-3276"></a>        <span class="k">END IF</span>
<a name="ln-3277"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3278"></a>            <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletHeight</span> <span class="p">&amp;</span>
<a name="ln-3279"></a>              <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3280"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3281"></a>            <span class="s1">&#39;: Source inlet is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-3282"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3283"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3284"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3285"></a>        <span class="n">ENDIF</span>
<a name="ln-3286"></a>
<a name="ln-3287"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">27</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Autocalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3288"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
<a name="ln-3289"></a>        <span class="k">ELSE</span>
<a name="ln-3290"></a>          <span class="c">! Defaults to bottom of tank</span>
<a name="ln-3291"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletHeight</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3292"></a>        <span class="k">END IF</span>
<a name="ln-3293"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3294"></a>            <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletHeight</span> <span class="p">&amp;</span>
<a name="ln-3295"></a>              <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3296"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3297"></a>            <span class="s1">&#39;: Source outlet is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-3298"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3299"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3300"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3301"></a>        <span class="n">ENDIF</span>
<a name="ln-3302"></a>
<a name="ln-3303"></a>        <span class="c">! If no plant nodes are connected, simulate in stand-alone mode.</span>
<a name="ln-3304"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">==</span> <span class="n">Blank</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3305"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">StandAlone</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3306"></a>
<a name="ln-3307"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3308"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<a name="ln-3309"></a>        <span class="k">ELSE</span>
<a name="ln-3310"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3311"></a>        <span class="k">END IF</span>
<a name="ln-3312"></a>
<a name="ln-3313"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">=</span> <span class="n">DemandSupply_No</span>
<a name="ln-3314"></a>
<a name="ln-3315"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span>  <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3316"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<a name="ln-3317"></a>        <span class="k">ELSE</span>
<a name="ln-3318"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3319"></a>        <span class="k">END IF</span>
<a name="ln-3320"></a>
<a name="ln-3321"></a><span class="k">        If</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3322"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SizingRecoveryTime</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<a name="ln-3323"></a>        <span class="k">ELSE</span>
<a name="ln-3324"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SizingRecoveryTime</span>      <span class="o">=</span> <span class="mf">1.5d0</span>
<a name="ln-3325"></a>        <span class="k">END IF</span>
<a name="ln-3326"></a>
<a name="ln-3327"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">=</span> <span class="n">DemandSupply_No</span>
<a name="ln-3328"></a>
<a name="ln-3329"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3330"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3331"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3332"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3333"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName1</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-3334"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3335"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3336"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3337"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-3338"></a>
<a name="ln-3339"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3340"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3341"></a>              <span class="s1">&#39;:  Use side nodes are specified; Peak Volumetric Use Flow Rate will not be used&#39;</span><span class="p">)</span>
<a name="ln-3342"></a>          <span class="k">END IF</span>
<a name="ln-3343"></a>
<a name="ln-3344"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3345"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3346"></a>              <span class="s1">&#39;:  Use side nodes are specified; Use Flow Rate Fraction Schedule will not be used&#39;</span><span class="p">)</span>
<a name="ln-3347"></a>          <span class="k">END IF</span>
<a name="ln-3348"></a>
<a name="ln-3349"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTempSchedule</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3350"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3351"></a>              <span class="s1">&#39;:  Use side nodes are specified; Cold Water Supply Temperature Schedule will not be used&#39;</span><span class="p">)</span>
<a name="ln-3352"></a>          <span class="k">END IF</span>
<a name="ln-3353"></a><span class="k">        END IF</span>
<a name="ln-3354"></a>
<a name="ln-3355"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">/=</span> <span class="n">Blank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3356"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3357"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3358"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3359"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName2</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-3360"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3361"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3362"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3363"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-3364"></a>
<a name="ln-3365"></a>        <span class="k">END IF</span>
<a name="ln-3366"></a>
<a name="ln-3367"></a>        <span class="c">! Validate inlet mode</span>
<a name="ln-3368"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<a name="ln-3369"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FIXED&#39;</span><span class="p">)</span>
<a name="ln-3370"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletMode</span> <span class="o">=</span> <span class="n">InletModeFixed</span>
<a name="ln-3371"></a>
<a name="ln-3372"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SEEKING&#39;</span><span class="p">)</span>
<a name="ln-3373"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletMode</span> <span class="o">=</span> <span class="n">InletModeSeeking</span>
<a name="ln-3374"></a>        <span class="k">END SELECT</span>
<a name="ln-3375"></a>
<a name="ln-3376"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<a name="ln-3377"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalCond</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<a name="ln-3378"></a>
<a name="ln-3379"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalLossCoeff</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span><span class="p">))</span>
<a name="ln-3380"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalLossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3381"></a>        <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-3382"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">32</span> <span class="o">+</span> <span class="n">NodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3383"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalLossCoeff</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">33</span> <span class="o">+</span> <span class="n">NodeNum</span><span class="p">)</span>
<a name="ln-3384"></a>          <span class="k">ELSE</span>
<a name="ln-3385"></a><span class="k">            EXIT</span>
<a name="ln-3386"></a><span class="k">          END IF</span>
<a name="ln-3387"></a><span class="k">        END DO</span>
<a name="ln-3388"></a>
<a name="ln-3389"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">33</span> <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3390"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3391"></a>            <span class="s1">&#39;:  More Additional Loss Coefficients were entered than the number of nodes; extra coefficients will not be used&#39;</span><span class="p">)</span>
<a name="ln-3392"></a>        <span class="k">END IF</span>
<a name="ln-3393"></a>
<a name="ln-3394"></a><span class="k">        CALL </span><span class="n">SetupStratifiedNodes</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-3395"></a>
<a name="ln-3396"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3397"></a><span class="k">          SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<a name="ln-3398"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;STORAGETANK&#39;</span> <span class="p">)</span>
<a name="ln-3399"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">=</span> <span class="n">SourceSideStorageTank</span>
<a name="ln-3400"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;INDIRECTHEATPRIMARYSETPOINT&#39;</span><span class="p">)</span>
<a name="ln-3401"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">=</span> <span class="n">SourceSideIndirectHeatPrimarySetpoint</span>
<a name="ln-3402"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;INDIRECTHEATALTERNATESETPOINT&#39;</span> <span class="p">)</span>
<a name="ln-3403"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">=</span> <span class="n">SourceSideIndirectHeatAltSetpoint</span>
<a name="ln-3404"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3405"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3406"></a>              <span class="s1">&#39;:  Invalid Control Mode entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">)))</span>
<a name="ln-3407"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3408"></a>          <span class="k">END SELECT</span>
<a name="ln-3409"></a><span class="k">        ELSE</span>
<a name="ln-3410"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">=</span> <span class="n">SourceSideIndirectHeatPrimarySetpoint</span>
<a name="ln-3411"></a>        <span class="n">ENDIF</span>
<a name="ln-3412"></a>
<a name="ln-3413"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3414"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAltSetpointSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
<a name="ln-3415"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAltSetpointSchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3416"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3417"></a>              <span class="s1">&#39;:  &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)))</span>
<a name="ln-3418"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3419"></a>          <span class="n">ENDIF</span>
<a name="ln-3420"></a>        <span class="n">ENDIF</span>
<a name="ln-3421"></a>
<a name="ln-3422"></a>
<a name="ln-3423"></a>      <span class="k">END DO</span> <span class="c">! WaterThermalTankNum</span>
<a name="ln-3424"></a>
<a name="ln-3425"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3426"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3427"></a>           <span class="s1">&#39; input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-3428"></a>      <span class="k">END IF</span>
<a name="ln-3429"></a>
<a name="ln-3430"></a><span class="k">    END IF</span>
<a name="ln-3431"></a>
<a name="ln-3432"></a><span class="c">!!!=======   Get Chilled Water :MIXED ===================================================================================</span>
<a name="ln-3433"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumChilledWaterMixed</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3434"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cMixedCWTankModuleObj</span>  <span class="c">! &#39;ThermalStorage:ChilledWater:Mixed&#39;</span>
<a name="ln-3435"></a>      <span class="k">DO </span><span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="n">NumWaterHeaterMixed</span> <span class="o">+</span> <span class="n">NumWaterHeaterStratified</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3436"></a>                                   <span class="n">NumWaterHeaterMixed</span> <span class="o">+</span> <span class="n">NumWaterHeaterStratified</span> <span class="o">+</span> <span class="n">NumChilledWaterMixed</span>
<a name="ln-3437"></a>
<a name="ln-3438"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">WaterThermalTankNum</span> <span class="o">-</span> <span class="p">(</span><span class="n">NumWaterHeaterMixed</span> <span class="o">+</span> <span class="n">NumWaterHeaterStratified</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3439"></a>                           <span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3440"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3441"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-3442"></a>
<a name="ln-3443"></a>        <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3444"></a>        <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3445"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterThermalTankNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,&amp;</span>
<a name="ln-3446"></a>                               <span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3447"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3448"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3449"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3450"></a>        <span class="k">END IF</span>
<a name="ln-3451"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3452"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span> <span class="o">=</span> <span class="n">cCurrentModuleObject</span>
<a name="ln-3453"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">=</span> <span class="n">MixedChilledWaterStorage</span>
<a name="ln-3454"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3455"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span> <span class="o">=</span> <span class="s1">&#39;Chilled Water Storage&#39;</span>
<a name="ln-3456"></a>
<a name="ln-3457"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3458"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3459"></a>          <span class="c">! Set volume to a really small number to continue simulation</span>
<a name="ln-3460"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="mf">0.000001d0</span> <span class="c">! = 1 cm3</span>
<a name="ln-3461"></a>        <span class="k">END IF</span>
<a name="ln-3462"></a>
<a name="ln-3463"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-3464"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3465"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3466"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3467"></a>
<a name="ln-3468"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3469"></a>        <span class="k">END IF</span>
<a name="ln-3470"></a>
<a name="ln-3471"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3472"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3473"></a>        <span class="k">ELSE</span>
<a name="ln-3474"></a>          <span class="c">! Default to very small number (however it can&#39;t be TINY or it will break the algorithm)</span>
<a name="ln-3475"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span> <span class="o">=</span> <span class="mf">0.5d0</span>
<a name="ln-3476"></a>        <span class="k">END IF</span>
<a name="ln-3477"></a>
<a name="ln-3478"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3479"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3480"></a>        <span class="k">ELSE</span>
<a name="ln-3481"></a>          <span class="c">! default to just above freezing</span>
<a name="ln-3482"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-3483"></a>        <span class="k">END IF</span>
<a name="ln-3484"></a>
<a name="ln-3485"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3486"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3487"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">=</span> <span class="n">ControlTypeCycle</span>
<a name="ln-3488"></a>
<a name="ln-3489"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMin</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3490"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IgnitionDelay</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3491"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span>        <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3492"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span>      <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-3493"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PLFCurve</span>        <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3494"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span>  <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3495"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3496"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3497"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3498"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3499"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3500"></a>
<a name="ln-3501"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3502"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SCHEDULE&#39;</span><span class="p">)</span>
<a name="ln-3503"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempSchedule</span>
<a name="ln-3504"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-3505"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3506"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-3507"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3508"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found.&#39;</span><span class="p">)</span>
<a name="ln-3509"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3510"></a>            <span class="k">END IF</span>
<a name="ln-3511"></a>
<a name="ln-3512"></a><span class="k">          CASE</span> <span class="p">(</span><span class="s1">&#39;ZONE&#39;</span><span class="p">)</span>
<a name="ln-3513"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempZone</span>
<a name="ln-3514"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-3515"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3516"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3517"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3518"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone was not found.&#39;</span><span class="p">)</span>
<a name="ln-3519"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3520"></a>            <span class="k">END IF</span>
<a name="ln-3521"></a>
<a name="ln-3522"></a><span class="k">          CASE</span> <span class="p">(</span><span class="s1">&#39;OUTDOORS&#39;</span><span class="p">)</span>
<a name="ln-3523"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempOutsideAir</span>
<a name="ln-3524"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempOutsideAirNode</span> <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3525"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">NodeType_Air</span><span class="p">,</span> <span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3526"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3527"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempOutsideAirNode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3528"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3529"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3530"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Outdoor Air Node not on OutdoorAir:NodeList or OutdoorAir:Node&#39;</span><span class="p">)</span>
<a name="ln-3531"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3532"></a>              <span class="n">ENDIF</span>
<a name="ln-3533"></a>            <span class="k">ELSE</span>
<a name="ln-3534"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3535"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;An Ambient Outdoor Air Node name must be used when&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3536"></a>                               <span class="s1">&#39; the Ambient Temperature Indicator is Outdoors.&#39;</span><span class="p">)</span>
<a name="ln-3537"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3538"></a>            <span class="n">ENDIF</span>
<a name="ln-3539"></a>
<a name="ln-3540"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3541"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3542"></a>              <span class="s1">&#39;:  Invalid Ambient Temperature Indicator entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3543"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Valid entries are Schedule, Zone, and Outdoors.&#39;</span><span class="p">)</span>
<a name="ln-3544"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3545"></a>        <span class="k">END SELECT</span>
<a name="ln-3546"></a>
<a name="ln-3547"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3548"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossFracToZone</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-3549"></a>
<a name="ln-3550"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3551"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycLossFracToZone</span> <span class="o">=</span><span class="mf">1.0D0</span>
<a name="ln-3552"></a>
<a name="ln-3553"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3554"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3555"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTempSchedule</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3556"></a>
<a name="ln-3557"></a>        <span class="c">! default to always on</span>
<a name="ln-3558"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3559"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3560"></a>
<a name="ln-3561"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3562"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3563"></a>            <span class="s1">&#39;:  Use Side Effectiveness is out of bounds (0 to 1)&#39;</span><span class="p">)</span>
<a name="ln-3564"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3565"></a>        <span class="k">END IF</span>
<a name="ln-3566"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3567"></a>
<a name="ln-3568"></a>
<a name="ln-3569"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3570"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3571"></a>            <span class="s1">&#39;:  Source Side Effectiveness is out of bounds (0 to 1)&#39;</span><span class="p">)</span>
<a name="ln-3572"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3573"></a>        <span class="k">END IF</span>
<a name="ln-3574"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3575"></a>
<a name="ln-3576"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3577"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3578"></a>        <span class="k">ELSE</span>
<a name="ln-3579"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3580"></a>        <span class="n">ENDIF</span>
<a name="ln-3581"></a>
<a name="ln-3582"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">=</span> <span class="n">DemandSupply_No</span>
<a name="ln-3583"></a>
<a name="ln-3584"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3585"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3586"></a>        <span class="k">ELSE</span>
<a name="ln-3587"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-3588"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3589"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-3590"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3591"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found.&#39;</span><span class="p">)</span>
<a name="ln-3592"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3593"></a>          <span class="n">ENDIF</span>
<a name="ln-3594"></a>        <span class="n">ENDIF</span>
<a name="ln-3595"></a>
<a name="ln-3596"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">=</span> <span class="n">DemandSupply_No</span>
<a name="ln-3597"></a>
<a name="ln-3598"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3599"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3600"></a>        <span class="k">ELSE</span>
<a name="ln-3601"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3602"></a>        <span class="n">ENDIF</span>
<a name="ln-3603"></a>
<a name="ln-3604"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3605"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3606"></a>        <span class="k">ELSE</span>
<a name="ln-3607"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-3608"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3609"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-3610"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3611"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found.&#39;</span><span class="p">)</span>
<a name="ln-3612"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3613"></a>          <span class="n">ENDIF</span>
<a name="ln-3614"></a>        <span class="n">ENDIF</span>
<a name="ln-3615"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3616"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SizingRecoveryTime</span>   <span class="o">=</span> <span class="mf">4.0D0</span>
<a name="ln-3617"></a>        <span class="k">ELSE</span>
<a name="ln-3618"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SizingRecoveryTime</span>   <span class="o">=</span>  <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3619"></a>        <span class="n">ENDIF</span>
<a name="ln-3620"></a>
<a name="ln-3621"></a>        <span class="k">IF</span> <span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3622"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3623"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3624"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3625"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName1</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3626"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3627"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3628"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3629"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3630"></a>
<a name="ln-3631"></a>        <span class="k">END IF</span>
<a name="ln-3632"></a>
<a name="ln-3633"></a><span class="k">        IF</span> <span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3634"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3635"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3636"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3637"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName2</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3638"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3639"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3640"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3641"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3642"></a>
<a name="ln-3643"></a>        <span class="k">END IF</span>
<a name="ln-3644"></a>
<a name="ln-3645"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">==</span> <span class="n">DemandSide</span>   <span class="p">&amp;</span>
<a name="ln-3646"></a>            <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3647"></a><span class="k">          CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3648"></a>                                    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-3649"></a>        <span class="n">ENDIF</span>
<a name="ln-3650"></a>
<a name="ln-3651"></a>      <span class="k">END DO</span> <span class="c">! WaterThermalTankNum</span>
<a name="ln-3652"></a>
<a name="ln-3653"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3654"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3655"></a>           <span class="s1">&#39; input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-3656"></a>      <span class="k">END IF</span>
<a name="ln-3657"></a>
<a name="ln-3658"></a><span class="k">    END IF</span>
<a name="ln-3659"></a>
<a name="ln-3660"></a><span class="c">!! end chilled water mixed storage</span>
<a name="ln-3661"></a>
<a name="ln-3662"></a><span class="c">!!!=======   Get &#39;ThermalStorage:ChilledWater:Stratified&#39; =======================================================</span>
<a name="ln-3663"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumChilledWaterStratified</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3664"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="n">cStratifiedCWTankModuleObj</span> <span class="c">! &#39;ThermalStorage:ChilledWater:Stratified&#39;</span>
<a name="ln-3665"></a>
<a name="ln-3666"></a>      <span class="k">DO </span><span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="n">NumWaterHeaterMixed</span> <span class="o">+</span> <span class="n">NumWaterHeaterStratified</span> <span class="o">+</span> <span class="n">NumChilledWaterMixed</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">&amp;</span>
<a name="ln-3667"></a>                              <span class="p">,</span> <span class="n">NumWaterHeaterMixed</span> <span class="o">+</span> <span class="n">NumWaterHeaterStratified</span> <span class="o">+</span> <span class="n">NumChilledWaterMixed</span> <span class="o">+</span> <span class="n">NumChilledWaterStratified</span>
<a name="ln-3668"></a>
<a name="ln-3669"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">WaterThermalTankNum</span>  <span class="p">&amp;</span>
<a name="ln-3670"></a>                            <span class="o">-</span>  <span class="p">(</span><span class="n">NumWaterHeaterMixed</span> <span class="o">+</span> <span class="n">NumWaterHeaterStratified</span> <span class="o">+</span> <span class="n">NumChilledWaterMixed</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-3671"></a>                              <span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3672"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3673"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-3674"></a>
<a name="ln-3675"></a>        <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3676"></a>        <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3677"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterThermalTankNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3678"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3679"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3680"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3681"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3682"></a>        <span class="k">END IF</span>
<a name="ln-3683"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3684"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span> <span class="o">=</span> <span class="n">cCurrentModuleObject</span>
<a name="ln-3685"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">=</span> <span class="n">StratifiedChilledWaterStorage</span>
<a name="ln-3686"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3687"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span> <span class="o">=</span> <span class="s1">&#39;Chilled Water Storage&#39;</span>
<a name="ln-3688"></a>
<a name="ln-3689"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3690"></a>        <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-3691"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mass</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-3692"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3693"></a>
<a name="ln-3694"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-3695"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;VERTICALCYLINDER&#39;</span><span class="p">)</span>
<a name="ln-3696"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">TankShapeVertCylinder</span>
<a name="ln-3697"></a>
<a name="ln-3698"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;HORIZONTALCYLINDER&#39;</span><span class="p">)</span>
<a name="ln-3699"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">TankShapeHorizCylinder</span>
<a name="ln-3700"></a>
<a name="ln-3701"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OTHER&#39;</span><span class="p">)</span>
<a name="ln-3702"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">TankShapeOther</span>
<a name="ln-3703"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3704"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Perimeter</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3705"></a>            <span class="k">ELSE</span>
<a name="ln-3706"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3707"></a>                <span class="s1">&#39;:  Tank Perimeter must be greater than zero for Tank Shape=OTHER&#39;</span><span class="p">)</span>
<a name="ln-3708"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3709"></a>            <span class="k">END IF</span>
<a name="ln-3710"></a>
<a name="ln-3711"></a><span class="k">          CASE </span><span class="n">DEFAULT</span>
<a name="ln-3712"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3713"></a>              <span class="s1">&#39;:  Invalid Tank Shape entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3714"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">=</span> <span class="n">TankShapeVertCylinder</span>
<a name="ln-3715"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3716"></a>        <span class="k">END SELECT</span>
<a name="ln-3717"></a>
<a name="ln-3718"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3719"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3720"></a>        <span class="k">ELSE</span>
<a name="ln-3721"></a>          <span class="c">! default to just above freezing</span>
<a name="ln-3722"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-3723"></a>        <span class="k">END IF</span>
<a name="ln-3724"></a>
<a name="ln-3725"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3726"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3727"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3728"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3729"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found.&#39;</span><span class="p">)</span>
<a name="ln-3730"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3731"></a>        <span class="k">END IF</span>
<a name="ln-3732"></a>
<a name="ln-3733"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3734"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3735"></a>        <span class="k">ELSE</span>
<a name="ln-3736"></a>          <span class="c">! Default to very small number (however it can&#39;t be TINY or it will break the algorithm)</span>
<a name="ln-3737"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span> <span class="o">=</span> <span class="mf">0.0001d0</span>
<a name="ln-3738"></a>        <span class="k">END IF</span>
<a name="ln-3739"></a>
<a name="ln-3740"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight1</span>         <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3741"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>          <span class="o">=</span>  <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3742"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span>            <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-3743"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule2</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3744"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity2</span>          <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3745"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight2</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3746"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3747"></a>
<a name="ln-3748"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3749"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3750"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3751"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaHeight</span> <span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-3752"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3753"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span> <span class="o">=</span> <span class="s1">&#39;Electric&#39;</span>
<a name="ln-3754"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3755"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaHeight</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3756"></a>
<a name="ln-3757"></a>
<a name="ln-3758"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-3759"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SCHEDULE&#39;</span><span class="p">)</span>
<a name="ln-3760"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempSchedule</span>
<a name="ln-3761"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-3762"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3763"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3764"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3765"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found.&#39;</span><span class="p">)</span>
<a name="ln-3766"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3767"></a>            <span class="k">END IF</span>
<a name="ln-3768"></a>
<a name="ln-3769"></a><span class="k">          CASE</span> <span class="p">(</span><span class="s1">&#39;ZONE&#39;</span><span class="p">)</span>
<a name="ln-3770"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempZone</span>
<a name="ln-3771"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-3772"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3773"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3774"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3775"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone was not found.&#39;</span><span class="p">)</span>
<a name="ln-3776"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3777"></a>            <span class="k">END IF</span>
<a name="ln-3778"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossFracToZone</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-3779"></a>
<a name="ln-3780"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;OUTDOORS&#39;</span><span class="p">)</span>
<a name="ln-3781"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span> <span class="o">=</span> <span class="n">AmbientTempOutsideAir</span>
<a name="ln-3782"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempOutsideAirNode</span> <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3783"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">NodeType_Air</span><span class="p">,</span> <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3784"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3785"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempOutsideAirNode</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3786"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-3787"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3788"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Outdoor Air Node not on OutdoorAir:NodeList or OutdoorAir:Node&#39;</span><span class="p">)</span>
<a name="ln-3789"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3790"></a>              <span class="n">ENDIF</span>
<a name="ln-3791"></a>            <span class="k">ELSE</span>
<a name="ln-3792"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3793"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;An Ambient Outdoor Air Node name must be used when&#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3794"></a>                               <span class="s1">&#39; the Ambient Temperature Indicator is Outdoors.&#39;</span><span class="p">)</span>
<a name="ln-3795"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3796"></a>            <span class="n">ENDIF</span>
<a name="ln-3797"></a>
<a name="ln-3798"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3799"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3800"></a>              <span class="s1">&#39;:  Invalid Ambient Temperature Indicator entered=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-3801"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Valid entries are Schedule, Zone, and Outdoors.&#39;</span><span class="p">)</span>
<a name="ln-3802"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3803"></a>        <span class="k">END SELECT</span>
<a name="ln-3804"></a>
<a name="ln-3805"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossCoeff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3806"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossFracToZone</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-3807"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycFlueLossCoeff</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3808"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycFlueLossFracToZone</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3809"></a>
<a name="ln-3810"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3811"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3812"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTempSchedule</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3813"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3814"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3815"></a>
<a name="ln-3816"></a>        <span class="c">! default to always on</span>
<a name="ln-3817"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3818"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3819"></a>
<a name="ln-3820"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="n">Autocalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3821"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletHeight</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>  <span class="c">! top of tank</span>
<a name="ln-3822"></a>        <span class="n">ENDIF</span>
<a name="ln-3823"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletHeight</span> <span class="p">&amp;</span>
<a name="ln-3824"></a>             <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3825"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3826"></a>            <span class="s1">&#39;: Use inlet is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-3827"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3828"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3829"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3830"></a>        <span class="n">ENDIF</span>
<a name="ln-3831"></a>
<a name="ln-3832"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3833"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletHeight</span> <span class="p">&amp;</span>
<a name="ln-3834"></a>             <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3835"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3836"></a>            <span class="s1">&#39;: Use outlet is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-3837"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3838"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3839"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3840"></a>        <span class="n">ENDIF</span>
<a name="ln-3841"></a>
<a name="ln-3842"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3843"></a>
<a name="ln-3844"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-3845"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletHeight</span> <span class="p">&amp;</span>
<a name="ln-3846"></a>             <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3847"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3848"></a>            <span class="s1">&#39;: Source inlet is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-3849"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3850"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3851"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3852"></a>        <span class="n">ENDIF</span>
<a name="ln-3853"></a>
<a name="ln-3854"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletHeight</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-3855"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">==</span> <span class="n">Autocalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3856"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletHeight</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>  <span class="c">! top of tank</span>
<a name="ln-3857"></a>        <span class="n">ENDIF</span>
<a name="ln-3858"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletHeight</span> <span class="p">&amp;</span>
<a name="ln-3859"></a>             <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3860"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3861"></a>            <span class="s1">&#39;: Source outlet is located higher than overall tank height.&#39;</span> <span class="p">)</span>
<a name="ln-3862"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3863"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-3864"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3865"></a>        <span class="n">ENDIF</span>
<a name="ln-3866"></a>
<a name="ln-3867"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">StandAlone</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3868"></a>
<a name="ln-3869"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3870"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3871"></a>        <span class="k">ELSE</span>
<a name="ln-3872"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3873"></a>        <span class="n">ENDIF</span>
<a name="ln-3874"></a>
<a name="ln-3875"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">=</span> <span class="n">DemandSupply_No</span>
<a name="ln-3876"></a>
<a name="ln-3877"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3878"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3879"></a>        <span class="k">ELSE</span>
<a name="ln-3880"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-3881"></a>        <span class="n">ENDIF</span>
<a name="ln-3882"></a>
<a name="ln-3883"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SizingRecoveryTime</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<a name="ln-3884"></a>
<a name="ln-3885"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">=</span> <span class="n">DemandSupply_No</span>
<a name="ln-3886"></a>
<a name="ln-3887"></a>        <span class="k">IF</span> <span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3888"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3889"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3890"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3891"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName1</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3892"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3893"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3894"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3895"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3896"></a>
<a name="ln-3897"></a>        <span class="n">ENDIF</span>
<a name="ln-3898"></a>
<a name="ln-3899"></a>        <span class="k">IF</span> <span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3900"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3901"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3902"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3903"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName2</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3904"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3905"></a>            <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3906"></a>            <span class="n">NodeType_Water</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-3907"></a>          <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3908"></a>
<a name="ln-3909"></a>        <span class="k">END IF</span>
<a name="ln-3910"></a>
<a name="ln-3911"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3912"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3913"></a>        <span class="k">ELSE</span>
<a name="ln-3914"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-3915"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3916"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-3917"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3918"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found.&#39;</span><span class="p">)</span>
<a name="ln-3919"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3920"></a>          <span class="n">ENDIF</span>
<a name="ln-3921"></a>        <span class="n">ENDIF</span>
<a name="ln-3922"></a>
<a name="ln-3923"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">==</span> <span class="n">DemandSide</span>   <span class="p">&amp;</span>
<a name="ln-3924"></a>            <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3925"></a><span class="k">          CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3926"></a>                                    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-3927"></a>        <span class="n">ENDIF</span>
<a name="ln-3928"></a>
<a name="ln-3929"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3930"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3931"></a>        <span class="k">ELSE</span>
<a name="ln-3932"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<a name="ln-3933"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3934"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Invalid, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)))</span>
<a name="ln-3935"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3936"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found.&#39;</span><span class="p">)</span>
<a name="ln-3937"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3938"></a>          <span class="n">ENDIF</span>
<a name="ln-3939"></a>        <span class="n">ENDIF</span>
<a name="ln-3940"></a>
<a name="ln-3941"></a>        <span class="c">! Validate inlet mode</span>
<a name="ln-3942"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<a name="ln-3943"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;FIXED&#39;</span><span class="p">)</span>
<a name="ln-3944"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletMode</span> <span class="o">=</span> <span class="n">InletModeFixed</span>
<a name="ln-3945"></a>
<a name="ln-3946"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SEEKING&#39;</span><span class="p">)</span>
<a name="ln-3947"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletMode</span> <span class="o">=</span> <span class="n">InletModeSeeking</span>
<a name="ln-3948"></a>        <span class="k">END SELECT</span>
<a name="ln-3949"></a>
<a name="ln-3950"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<a name="ln-3951"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalCond</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="ln-3952"></a>
<a name="ln-3953"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalLossCoeff</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span><span class="p">))</span>
<a name="ln-3954"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalLossCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3955"></a>        <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-3956"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">19</span> <span class="o">+</span> <span class="n">NodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3957"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalLossCoeff</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">19</span> <span class="o">+</span> <span class="n">NodeNum</span><span class="p">)</span>
<a name="ln-3958"></a>          <span class="k">ELSE</span>
<a name="ln-3959"></a><span class="k">            EXIT</span>
<a name="ln-3960"></a><span class="k">          END IF</span>
<a name="ln-3961"></a><span class="k">        END DO</span>
<a name="ln-3962"></a>
<a name="ln-3963"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NumNums</span> <span class="o">&gt;</span> <span class="mi">19</span> <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3964"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3965"></a>            <span class="s1">&#39;:  More Additional Loss Coefficients were entered than the number of nodes; extra coefficients will not be used&#39;</span><span class="p">)</span>
<a name="ln-3966"></a>        <span class="k">END IF</span>
<a name="ln-3967"></a>
<a name="ln-3968"></a><span class="k">        CALL </span><span class="n">SetupStratifiedNodes</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-3969"></a>
<a name="ln-3970"></a>      <span class="k">END DO</span> <span class="c">! WaterThermalTankNum</span>
<a name="ln-3971"></a>
<a name="ln-3972"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3973"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3974"></a>           <span class="s1">&#39; input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-3975"></a>      <span class="k">END IF</span>
<a name="ln-3976"></a>
<a name="ln-3977"></a><span class="k">    END IF</span>
<a name="ln-3978"></a><span class="c">!!  end stratified chilled water storage</span>
<a name="ln-3979"></a>
<a name="ln-3980"></a><span class="c">!!!=======   Check Water Heaters ======================================================================================</span>
<a name="ln-3981"></a>
<a name="ln-3982"></a><span class="c">!   Loop through all desuperheating coils and then search all water heaters for the tank connected to the desuperheating coil</span>
<a name="ln-3983"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterHeaterDesuperheater</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3984"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:WaterHeating:Desuperheater&#39;</span>
<a name="ln-3985"></a>      <span class="k">DO </span><span class="n">DesuperheaterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterHeaterDesuperheater</span>
<a name="ln-3986"></a>
<a name="ln-3987"></a>        <span class="k">DO </span><span class="n">CheckWaterHeaterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterThermalTank</span>
<a name="ln-3988"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankName</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3989"></a>             <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3990"></a>             <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">))</span>   <span class="p">&amp;</span>
<a name="ln-3991"></a>                <span class="k">CYCLE</span>
<a name="ln-3992"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="o">=</span> <span class="n">DesuperheaterNum</span>
<a name="ln-3993"></a>            <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span> <span class="o">=</span> <span class="n">CheckWaterHeaterNum</span>
<a name="ln-3994"></a>            <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankTypeNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">TypeNum</span>
<a name="ln-3995"></a>            <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-3996"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span> <span class="p">&amp;</span>
<a name="ln-3997"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">UseOutletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3998"></a>                <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">StandAlone</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3999"></a>
<a name="ln-4000"></a><span class="c">!         verify Desuperheater/tank source node connections</span>
<a name="ln-4001"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">WaterInletNode</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4002"></a>             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4003"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4004"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Desuperheater inlet node name does not match &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4005"></a>                                   <span class="s1">&#39; thermal tank source outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4006"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Desuperheater water inlet and outlet node names = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4007"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilSaveNodeNames</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">InletNodeName1</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4008"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilSaveNodeNames</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span><span class="p">))</span>
<a name="ln-4009"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Thermal tank source side inlet and outlet node names      = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4010"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4011"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span><span class="p">))</span>
<a name="ln-4012"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4013"></a>          <span class="k">END IF</span>
<a name="ln-4014"></a>
<a name="ln-4015"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">WaterOutletNode</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4016"></a>             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4017"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4018"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Desuperheater water outlet node name does not match thermal&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4019"></a>                                   <span class="s1">&#39; tank source inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4020"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Desuperheater water inlet and outlet node names = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4021"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilSaveNodeNames</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">InletNodeName1</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4022"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilSaveNodeNames</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span><span class="p">))</span>
<a name="ln-4023"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Thermal tank source side inlet and outlet node names      = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4024"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4025"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span><span class="p">))</span>
<a name="ln-4026"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4027"></a>          <span class="k">END IF</span>
<a name="ln-4028"></a>
<a name="ln-4029"></a><span class="k">        END DO</span> <span class="c">! DO CheckWaterHeaterNum = 1, NumWaterHeater</span>
<a name="ln-4030"></a>
<a name="ln-4031"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4032"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4033"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Water heater tank = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; not found.&#39;</span><span class="p">)</span>
<a name="ln-4034"></a>         <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4035"></a>        <span class="k">END IF</span>
<a name="ln-4036"></a>
<a name="ln-4037"></a><span class="k">      END DO</span> <span class="c">! DO DesuperheaterNum = 1, NumWaterHeaterDesuperheater</span>
<a name="ln-4038"></a>    <span class="k">END IF</span>
<a name="ln-4039"></a>
<a name="ln-4040"></a><span class="c">!   Loop through HPWH&#39;s and then search all water heaters for the tank connected to the HPWH</span>
<a name="ln-4041"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumHeatPumpWaterHeater</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4042"></a>
<a name="ln-4043"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;WaterHeater:HeatPump&#39;</span>
<a name="ln-4044"></a>
<a name="ln-4045"></a>      <span class="k">DO </span><span class="n">HPWaterHeaterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHeatPumpWaterHeater</span>
<a name="ln-4046"></a>
<a name="ln-4047"></a><span class="c">!       find the tank associated with the heat pump water heater and change its %TYPE to HEAT PUMP:WATER HEATER</span>
<a name="ln-4048"></a>        <span class="k">DO </span><span class="n">CheckWaterHeaterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterThermalTank</span>
<a name="ln-4049"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankName</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4050"></a>             <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-4051"></a>
<a name="ln-4052"></a><span class="c">!         save backup element and on/off-cycle parasitic properties for use during standard rating procedure</span>
<a name="ln-4053"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>   <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-4054"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">BackupElementEfficiency</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">Efficiency</span>
<a name="ln-4055"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WHOnCycParaLoad</span>         <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>
<a name="ln-4056"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WHOffCycParaLoad</span>        <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span>
<a name="ln-4057"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WHOnCycParaFracToTank</span>   <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span>
<a name="ln-4058"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WHOffCycParaFracToTank</span>  <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span>
<a name="ln-4059"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WHPLFCurve</span>              <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">PLFCurve</span>
<a name="ln-4060"></a>
<a name="ln-4061"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="s1">&#39;WATER HEATER:SIMPLE&#39;</span><span class="p">)</span><span class="k">THEN</span>  <span class="c">! name change issue here.</span>
<a name="ln-4062"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4063"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;WaterHeater:HeatPump cannot be used with WATER HEATER:SIMPLE.&#39;</span><span class="p">)</span>
<a name="ln-4064"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4065"></a>          <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">cMixedWHModuleObj</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-4066"></a>            <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">cStratifiedWHModuleObj</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4067"></a><span class="k">            </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankTypeNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">TypeNum</span>
<a name="ln-4068"></a><span class="c">!           use typenum parameter to simulate heatpumpwaterheater in standard ratings procedure</span>
<a name="ln-4069"></a><span class="c">!           WaterThermalTank%TypeNum = HeatPumpWaterHeater for a HPWH</span>
<a name="ln-4070"></a><span class="c">!            WaterThermalTank(CheckWaterHeaterNum)%TypeNum = HPWaterHeater(HPWaterHeaterNum)%TypeNum</span>
<a name="ln-4071"></a>          <span class="k">ELSE</span>
<a name="ln-4072"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4073"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid water heater tank type =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">))</span>
<a name="ln-4074"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4075"></a>          <span class="k">END IF</span>
<a name="ln-4076"></a>
<a name="ln-4077"></a><span class="c">!         do not allow modulating control for HPWH&#39;s (i.e. modulating control usually used for tankless WH&#39;s)</span>
<a name="ln-4078"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ControlTypeModulate</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4079"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4080"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heater Control Type for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4081"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; must be CYCLE.&#39;</span><span class="p">)</span>
<a name="ln-4082"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4083"></a>          <span class="k">END IF</span>
<a name="ln-4084"></a>
<a name="ln-4085"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">=</span> <span class="n">HPWaterHeaterNum</span>
<a name="ln-4086"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WaterHeaterTankNum</span> <span class="o">=</span> <span class="n">CheckWaterHeaterNum</span>
<a name="ln-4087"></a>
<a name="ln-4088"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4089"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4090"></a>               <span class="s1">&#39;and Coil:WaterHeating:Desuperheater = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4091"></a>               <span class="s1">&#39;:  cannot be connected to the same water heater tank = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4092"></a>          <span class="k">END IF</span>
<a name="ln-4093"></a>
<a name="ln-4094"></a><span class="c">!         check that water heater source side effectiveness is greater than 0</span>
<a name="ln-4095"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4096"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4097"></a>               <span class="s1">&#39;:  Invalid source side effectiveness for heat pump water heater = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4098"></a>                 <span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-4099"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; water heater source effectiveness will default to 1.0 and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-4100"></a>             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4101"></a>          <span class="k">END IF</span>
<a name="ln-4102"></a>
<a name="ln-4103"></a><span class="c">!         Set HPWH structure variable StandAlone to TRUE if use nodes are not connected</span>
<a name="ln-4104"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4105"></a>             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">UseOutletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4106"></a>            <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">StandAlone</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4107"></a>
<a name="ln-4108"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WHUseInletNode</span> <span class="o">/=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4109"></a>             <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">WHUseOutletNode</span> <span class="o">/=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">UseOutletNode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4110"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4111"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump water heater tank use side inlet and outlet node names must match&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4112"></a>                                   <span class="s1">&#39; the use side inlet and outlet node names for water heater tank = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4113"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span> <span class="p">&amp;</span>
<a name="ln-4114"></a>                                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankName</span><span class="p">))</span>
<a name="ln-4115"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump water heater use side inlet and outlet node names = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4116"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4117"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span><span class="p">))</span>
<a name="ln-4118"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Water heater tank use side inlet and outlet node names      = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4119"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName1</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4120"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span><span class="p">))</span>
<a name="ln-4121"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4122"></a>          <span class="k">ELSE</span>
<a name="ln-4123"></a><span class="k">            IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">StandAlone</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4124"></a><span class="c">!              removed next to avoid duplicate comp set issue, (should change so that Branch has tank object)</span>
<a name="ln-4125"></a><span class="c">!              CALL SetUpCompSets(HPWaterHeater(HPWaterHeaterNum)%Type, HPWaterHeater(HPWaterHeaterNum)%Name, &amp;</span>
<a name="ln-4126"></a><span class="c">!                     HPWaterHeater(HPWaterHeaterNum)%TankType, &amp;</span>
<a name="ln-4127"></a><span class="c">!                     HPWaterHeater(HPWaterHeaterNum)%TankName, &amp;</span>
<a name="ln-4128"></a><span class="c">!                     WHSaveNodeNames(CheckWaterHeaterNum)%InletNodeName1,WHSaveNodeNames(CheckWaterHeaterNum)%OutletNodeName1)</span>
<a name="ln-4129"></a>              <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4130"></a>                     <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName1</span><span class="p">,</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4131"></a>                    <span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-4132"></a>            <span class="k">END IF</span>
<a name="ln-4133"></a><span class="k">          END IF</span>
<a name="ln-4134"></a>
<a name="ln-4135"></a><span class="c">!         verify HP/tank source node connections</span>
<a name="ln-4136"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">CondWaterInletNode</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4137"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4138"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat Pump condenser water inlet node name does not match water&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4139"></a>                                   <span class="s1">&#39; heater tank source outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4140"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump condenser water inlet and outlet node names = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4141"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName1</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4142"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span><span class="p">))</span>
<a name="ln-4143"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Water heater tank source side inlet and outlet node names      = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4144"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4145"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span><span class="p">))</span>
<a name="ln-4146"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4147"></a>          <span class="k">END IF</span>
<a name="ln-4148"></a>
<a name="ln-4149"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">CondWaterOutletNode</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4150"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4151"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat Pump condenser water outlet node name does not match water heater&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4152"></a>                                   <span class="s1">&#39; tank source inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4153"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump condenser water inlet and outlet node names = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4154"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName1</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4155"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWHSaveNodeNames</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span><span class="p">))</span>
<a name="ln-4156"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Water heater tank source side inlet and outlet node names      = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4157"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">InletNodeName2</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; and &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4158"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">CheckWaterHeaterNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span><span class="p">))</span>
<a name="ln-4159"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4160"></a>          <span class="k">END IF</span>
<a name="ln-4161"></a>
<a name="ln-4162"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FoundTank</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4163"></a>
<a name="ln-4164"></a><span class="c">!         Verify tank name is in a zone equipment list if HPWH Inlet Air Configuration is Zone Air Only or Zone and Outdoor Air</span>
<a name="ln-4165"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZone</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4166"></a>             <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZoneAndOA</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4167"></a><span class="k">            IF</span><span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4168"></a><span class="k">              </span><span class="n">FoundTankInList</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4169"></a>              <span class="n">TankNotLowestPriority</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4170"></a>              <span class="k">DO </span><span class="n">ZoneEquipConfigNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-4171"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneEquipConfigNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-4172"></a><span class="k">                IF</span><span class="p">(</span><span class="n">ZoneEquipConfigNum</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">NumOfZones</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4173"></a><span class="k">                  DO </span><span class="n">ZoneEquipListNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-4174"></a>                    <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ZoneEquipConfigNum</span><span class="p">)%</span><span class="n">EquipListName</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipListNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-4175"></a><span class="k">                    IF</span><span class="p">(</span><span class="n">ZoneEquipConfigNum</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">NumOfZones</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4176"></a><span class="k">                      DO </span><span class="n">EquipmentTypeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipListNum</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-4177"></a>                        <span class="k">IF</span><span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipListNum</span><span class="p">)%</span><span class="n">EquipName</span><span class="p">(</span><span class="n">EquipmentTypeNum</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4178"></a>                           <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-4179"></a><span class="k">                        </span><span class="n">FoundTankInList</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4180"></a>                        <span class="n">TankCoolingPriority</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipListNum</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipmentTypeNum</span><span class="p">)</span>
<a name="ln-4181"></a>                        <span class="n">TankHeatingPriority</span> <span class="o">=</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipListNum</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipmentTypeNum</span><span class="p">)</span>
<a name="ln-4182"></a>                        <span class="k">EXIT</span>
<a name="ln-4183"></a><span class="k">                      END DO</span> <span class="c">! EquipmentTypeNum</span>
<a name="ln-4184"></a>                      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FoundTankInList</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4185"></a><span class="k">                        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4186"></a>                        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump water heater type and name must be listed in the correct&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4187"></a>                                               <span class="s1">&#39; ZoneHVAC:EquipmentList object when Inlet Air Configuration is equal&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4188"></a>                                               <span class="s1">&#39; to ZoneAirOnly or ZoneAndOutdoorAir.&#39;</span><span class="p">)</span>
<a name="ln-4189"></a>                        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4190"></a>                      <span class="k">END IF</span>
<a name="ln-4191"></a><span class="c">!                     check that tank has lower priority than all other non-HPWH objects in Zone Equipment List</span>
<a name="ln-4192"></a>                      <span class="k">DO </span><span class="n">EquipmentTypeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipListNum</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-4193"></a>                        <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipListNum</span><span class="p">)%</span><span class="n">EquipType</span><span class="p">(</span><span class="n">EquipmentTypeNum</span><span class="p">),</span><span class="n">cCurrentModuleObject</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-4194"></a><span class="k">                          IF</span><span class="p">(</span><span class="n">TankCoolingPriority</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipListNum</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipmentTypeNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4195"></a>                             <span class="n">TankHeatingPriority</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipListNum</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipmentTypeNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4196"></a><span class="k">                            </span><span class="n">TankNotLowestPriority</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4197"></a>                        <span class="k">END IF</span>
<a name="ln-4198"></a><span class="k">                      END DO</span> <span class="c">! EquipmentTypeNum</span>
<a name="ln-4199"></a>                      <span class="k">IF</span><span class="p">(</span><span class="n">TankNotLowestPriority</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FoundTankInList</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4200"></a><span class="k">                          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4201"></a>                          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump water heaters must have lower priorities than&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4202"></a>                                                 <span class="s1">&#39; all other equipment types in a ZoneHVAC:EquipmentList.&#39;</span><span class="p">)</span>
<a name="ln-4203"></a>                        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4204"></a>                      <span class="k">END IF</span>
<a name="ln-4205"></a><span class="k">                      EXIT</span>
<a name="ln-4206"></a><span class="k">                   END IF</span> <span class="c">! ZoneEquipConfigNum .LE. NumOfZoneEquipLists</span>
<a name="ln-4207"></a>                  <span class="k">END DO</span> <span class="c">! ZoneEquipListNum</span>
<a name="ln-4208"></a>                  <span class="k">EXIT</span>
<a name="ln-4209"></a><span class="k">                END IF</span> <span class="c">! ZoneEquipConfigNum .LE. NumOfZones</span>
<a name="ln-4210"></a>              <span class="k">END DO</span> <span class="c">! ZoneEquipConfigNum</span>
<a name="ln-4211"></a>            <span class="k">ELSE</span>
<a name="ln-4212"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4213"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ZoneHVAC:EquipmentList and ZoneHVAC:EquipmentConnections objects are &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4214"></a>                                     <span class="s1">&#39; required when Inlet Air Configuration is either ZoneAirOnly or ZoneAndOutdoorAir.&#39;</span><span class="p">)</span>
<a name="ln-4215"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4216"></a>            <span class="k">END IF</span> <span class="c">! ALLOCATED</span>
<a name="ln-4217"></a>          <span class="k">END IF</span> <span class="c">!InletAirConfiguration</span>
<a name="ln-4218"></a>
<a name="ln-4219"></a>        <span class="k">END DO</span> <span class="c">! DO CheckWaterHeaterNum = 1, NumWaterHeater</span>
<a name="ln-4220"></a>
<a name="ln-4221"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">FoundTank</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4222"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<a name="ln-4223"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Water heater tank object not found = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">)&amp;</span>
<a name="ln-4224"></a>                                <span class="o">//</span><span class="s1">&#39;, &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPWaterHeaterNum</span><span class="p">)%</span><span class="n">TankName</span><span class="p">))</span>
<a name="ln-4225"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4226"></a>        <span class="k">END IF</span>
<a name="ln-4227"></a>
<a name="ln-4228"></a><span class="k">      END DO</span> <span class="c">! DO HPWaterHeaterNum = 1, NumHeatPumpWaterHeater</span>
<a name="ln-4229"></a>
<a name="ln-4230"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4231"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4232"></a>           <span class="s1">&#39; input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-4233"></a>      <span class="k">END IF</span>
<a name="ln-4234"></a>
<a name="ln-4235"></a><span class="k">    END IF</span>
<a name="ln-4236"></a>
<a name="ln-4237"></a>   <span class="c">!Get water heater sizing input.</span>
<a name="ln-4238"></a>    <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;WaterHeater:Sizing&#39;</span>
<a name="ln-4239"></a>    <span class="n">NumWaterHeaterSizing</span>  <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-4240"></a>
<a name="ln-4241"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">NumWaterHeaterSizing</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4242"></a>
<a name="ln-4243"></a><span class="k">      DO </span><span class="n">WHsizingNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterHeaterSizing</span>
<a name="ln-4244"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span> <span class="n">WHsizingNum</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-4245"></a>
<a name="ln-4246"></a>        <span class="c">! find which water heater this object is for</span>
<a name="ln-4247"></a>        <span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WaterThermalTank</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumWaterThermalTank</span><span class="p">)</span>
<a name="ln-4248"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTankNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4249"></a>          <span class="c">! did not match name throw warning.</span>
<a name="ln-4250"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; object name: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; does not match &#39;</span> <span class="p">&amp;</span>
<a name="ln-4251"></a>               <span class="o">//</span><span class="s1">&#39;any of the water heaters defined in the file&#39;</span><span class="p">)</span>
<a name="ln-4252"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4253"></a>          <span class="k">cycle</span>
<a name="ln-4254"></a><span class="k">        ELSE</span> <span class="c">! we have a match</span>
<a name="ln-4255"></a>          <span class="c">! store the sizing data in &quot;sizing&quot; nested derived type for the correct water heater</span>
<a name="ln-4256"></a>
<a name="ln-4257"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;PeakDraw&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4258"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span> <span class="o">=</span> <span class="n">SizePeakDraw</span>
<a name="ln-4259"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;ResidentialHUD-FHAMinimum&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4260"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span> <span class="o">=</span> <span class="n">SizeResidentialMin</span>
<a name="ln-4261"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;PerPerson&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4262"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span> <span class="o">=</span> <span class="n">SizePerPerson</span>
<a name="ln-4263"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;PerFloorArea&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4264"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span> <span class="o">=</span> <span class="n">SizePerFloorArea</span>
<a name="ln-4265"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;PerUnit&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4266"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span> <span class="o">=</span> <span class="n">SizePerUnit</span>
<a name="ln-4267"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;PerSolarCollectorArea&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4268"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span> <span class="o">=</span> <span class="n">SizePerSolarColArea</span>
<a name="ln-4269"></a>          <span class="k">ELSE</span>
<a name="ln-4270"></a>            <span class="c">! wrong design mode entered, throw error</span>
<a name="ln-4271"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; object named: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="p">&amp;</span>
<a name="ln-4272"></a>              <span class="o">//</span> <span class="s1">&#39; contains an incorrect Design Mode of: &#39;</span> <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<a name="ln-4273"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4274"></a>          <span class="n">ENDIF</span>
<a name="ln-4275"></a>
<a name="ln-4276"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankDrawTime</span>              <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4277"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">RecoveryTime</span>              <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4278"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NominalVolForSizingDemandSideFlow</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4279"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span>          <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-4280"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span>         <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-4281"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankCapacityPerPerson</span>     <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4282"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerPerson</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4283"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankCapacityPerArea</span>       <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-4284"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerArea</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-4285"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfUnits</span>             <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-4286"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankCapacityPerUnit</span>       <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-4287"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerUnit</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-4288"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankCapacityPerCollectorArea</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4289"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">HeightAspectRatio</span>         <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-4290"></a>
<a name="ln-4291"></a>          <span class="k">Select Case</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span><span class="p">)</span>
<a name="ln-4292"></a>
<a name="ln-4293"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SizeNotSet</span><span class="p">)</span>
<a name="ln-4294"></a>            <span class="c">! do nothing, error thrown if design mode not found</span>
<a name="ln-4295"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePeakDraw</span><span class="p">)</span> <span class="c">! need to have entered a reasonable value for TankDrawTime</span>
<a name="ln-4296"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankDrawTime</span> <span class="o">&lt;=</span> <span class="mf">0.0D0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-4297"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4298"></a>                 <span class="s1">&#39;, design mode set to Peak Draw but needs a positive value for tank draw time&#39;</span> <span class="p">)</span>
<a name="ln-4299"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4300"></a>            <span class="n">ENDIF</span>
<a name="ln-4301"></a>            <span class="c">!constrain crazy sizes by limiting to 10 years or 8760*10</span>
<a name="ln-4302"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankDrawTime</span> <span class="o">&gt;</span> <span class="mi">8760</span><span class="mf">0.0D0</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-4303"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4304"></a>                <span class="s1">&#39;,  has input with an unreasonably large Tank Draw Time, more than 10 years&#39;</span><span class="p">)</span>
<a name="ln-4305"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4306"></a>            <span class="n">ENDIF</span>
<a name="ln-4307"></a>            <span class="c">! if both volume and demand side flow connections are autosized, must be a good NominalVolForSizingDemandSideFlow</span>
<a name="ln-4308"></a>            <span class="k">If</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">==</span> <span class="n">DemandSide</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4309"></a>                <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-4310"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NominalVolForSizingDemandSideFlow</span> <span class="o">&lt;=</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4311"></a><span class="k">                  Call </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4312"></a>                    <span class="s1">&#39; needs a value for Nominal Tank Volume for Autosizing Plant Connections&#39;</span><span class="p">)</span>
<a name="ln-4313"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4314"></a>                <span class="n">ENDIF</span>
<a name="ln-4315"></a>            <span class="n">ENDIF</span>
<a name="ln-4316"></a>            <span class="k">If</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">==</span> <span class="n">DemandSide</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4317"></a>                <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-4318"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NominalVolForSizingDemandSideFlow</span> <span class="o">&lt;=</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4319"></a><span class="k">                  Call </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4320"></a>                    <span class="s1">&#39; needs a value for Nominal Tank Volume for Autosizing Plant Connections&#39;</span><span class="p">)</span>
<a name="ln-4321"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4322"></a>                <span class="n">ENDIF</span>
<a name="ln-4323"></a>            <span class="n">ENDIF</span>
<a name="ln-4324"></a>
<a name="ln-4325"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SizeResidentialMin</span><span class="p">)</span>
<a name="ln-4326"></a>            <span class="c">! it would have to have at least on bedroom and any more than 10 is crazy for this mode</span>
<a name="ln-4327"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-4328"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4329"></a>                <span class="s1">&#39;, mode needs at least one bedroom&#39;</span><span class="p">)</span>
<a name="ln-4330"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4331"></a>            <span class="n">ENDIF</span>
<a name="ln-4332"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-4333"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4334"></a>                <span class="s1">&#39;, probably has too many bedrooms for the selected design mode&#39;</span><span class="p">)</span>
<a name="ln-4335"></a>            <span class="n">ENDIF</span>
<a name="ln-4336"></a>
<a name="ln-4337"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerPerson</span><span class="p">)</span>
<a name="ln-4338"></a>
<a name="ln-4339"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4340"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankCapacityPerPerson</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4341"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4342"></a>                <span class="s1">&#39;, PerPerson mode needs positive value input for storage capacity per person&#39;</span><span class="p">)</span>
<a name="ln-4343"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4344"></a>            <span class="n">ENDIF</span>
<a name="ln-4345"></a>
<a name="ln-4346"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4347"></a>                <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerPerson</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4348"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4349"></a>                <span class="s1">&#39;, PerPerson mode needs positive value input for recovery capacity per person&#39;</span><span class="p">)</span>
<a name="ln-4350"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4351"></a>            <span class="n">ENDIF</span>
<a name="ln-4352"></a>
<a name="ln-4353"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerFloorArea</span><span class="p">)</span>
<a name="ln-4354"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4355"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankCapacityPerArea</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4356"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4357"></a>                <span class="s1">&#39;, PerArea mode needs positive value input for storage capacity per floor area&#39;</span><span class="p">)</span>
<a name="ln-4358"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4359"></a>            <span class="n">ENDIF</span>
<a name="ln-4360"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4361"></a>                <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerArea</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4362"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4363"></a>                <span class="s1">&#39;, PerArea mode needs positive value input for recovery capacity per floor area&#39;</span><span class="p">)</span>
<a name="ln-4364"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4365"></a>            <span class="n">ENDIF</span>
<a name="ln-4366"></a>
<a name="ln-4367"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerUnit</span><span class="p">)</span>
<a name="ln-4368"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4369"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankCapacityPerUnit</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4370"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4371"></a>                <span class="s1">&#39;, PerUnit mode needs positive value input for storage capacity per unit&#39;</span><span class="p">)</span>
<a name="ln-4372"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4373"></a>            <span class="n">ENDIF</span>
<a name="ln-4374"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4375"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfUnits</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4376"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4377"></a>                <span class="s1">&#39;, PerUnit mode needs positive value input for number of units&#39;</span><span class="p">)</span>
<a name="ln-4378"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4379"></a>            <span class="n">ENDIF</span>
<a name="ln-4380"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4381"></a>                <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerUnit</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4382"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4383"></a>                <span class="s1">&#39;, PerUnit mode needs positive value input for recovery capacity per unit&#39;</span><span class="p">)</span>
<a name="ln-4384"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4385"></a>            <span class="n">ENDIF</span>
<a name="ln-4386"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4387"></a>                <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">NumberOfUnits</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4388"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4389"></a>                <span class="s1">&#39;, PerUnit mode needs positive value input for number of units&#39;</span><span class="p">)</span>
<a name="ln-4390"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4391"></a>            <span class="n">ENDIF</span>
<a name="ln-4392"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerSolarColArea</span><span class="p">)</span>
<a name="ln-4393"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4394"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankCapacityPerCollectorArea</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4395"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4396"></a>                <span class="s1">&#39;, PerSolarCollectorArea mode needs positive value input for storage capacity per collector area&#39;</span><span class="p">)</span>
<a name="ln-4397"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4398"></a>            <span class="n">ENDIF</span>
<a name="ln-4399"></a>          <span class="k">END SELECT</span>
<a name="ln-4400"></a>
<a name="ln-4401"></a>
<a name="ln-4402"></a><span class="k">        </span><span class="n">ENDIF</span> <span class="c">!found water heater num okay</span>
<a name="ln-4403"></a>      <span class="n">ENDDO</span> <span class="c">! loop over sizing objects</span>
<a name="ln-4404"></a>
<a name="ln-4405"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4406"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4407"></a>           <span class="s1">&#39; input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-4408"></a>      <span class="k">END IF</span>
<a name="ln-4409"></a>
<a name="ln-4410"></a><span class="k">    </span><span class="n">ENDIF</span> <span class="c">! any water heater sizing objects</span>
<a name="ln-4411"></a>
<a name="ln-4412"></a>    <span class="c">!now check that if water heater fields were autosized, that there was also a sizing object for that water heater</span>
<a name="ln-4413"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterThermalTank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4414"></a><span class="k">      DO </span><span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterThermalTank</span>
<a name="ln-4415"></a>
<a name="ln-4416"></a>        <span class="k">If</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4417"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span> <span class="o">==</span> <span class="n">SizeNotSet</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4418"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Water heater named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4419"></a>                <span class="s1">&#39;has tank volume set to AUTOSIZE but it is missing associated WaterHeater:Sizing object&#39;</span><span class="p">)</span>
<a name="ln-4420"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4421"></a>        <span class="n">ENDIF</span>
<a name="ln-4422"></a>        <span class="k">If</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4423"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span> <span class="o">==</span> <span class="n">SizeNotSet</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4424"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Water heater named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4425"></a>                <span class="s1">&#39;has heater capacity set to AUTOSIZE but it is missing associated WaterHeater:Sizing object&#39;</span><span class="p">)</span>
<a name="ln-4426"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4427"></a>        <span class="n">ENDIF</span>
<a name="ln-4428"></a>        <span class="k">If</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4429"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span> <span class="o">==</span> <span class="n">SizeNotSet</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-4430"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Water heater named &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4431"></a>                <span class="s1">&#39;has tank height set to AUTOSIZE but it is missing associated WaterHeater:Sizing object&#39;</span><span class="p">)</span>
<a name="ln-4432"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4433"></a>        <span class="n">ENDIF</span>
<a name="ln-4434"></a>      <span class="n">ENDDO</span>
<a name="ln-4435"></a>
<a name="ln-4436"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-4437"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in water heater input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-4438"></a>      <span class="n">ENDIF</span>
<a name="ln-4439"></a>    <span class="n">ENDIF</span>
<a name="ln-4440"></a>
<a name="ln-4441"></a><span class="c">!!   now do calls to TestCompSet for tanks, depending on nodes and heat pump water heater</span>
<a name="ln-4442"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterThermalTank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4443"></a><span class="k">      DO </span><span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterThermalTank</span>
<a name="ln-4444"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="p">&amp;</span>
<a name="ln-4445"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4446"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4447"></a>            <span class="c">! do nothing, Use nodes are tested for HeatPump:WaterHeater not tank</span>
<a name="ln-4448"></a>          <span class="k">ELSE</span>
<a name="ln-4449"></a><span class="k">            CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4450"></a>                             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4451"></a>                             <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName1</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4452"></a>                             <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4453"></a>                            <span class="s1">&#39;Use Side Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-4454"></a>          <span class="n">ENDIF</span>
<a name="ln-4455"></a>        <span class="n">ENDIF</span>
<a name="ln-4456"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="p">&amp;</span>
<a name="ln-4457"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4458"></a>
<a name="ln-4459"></a><span class="k">          CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4460"></a>                           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4461"></a>                           <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletNodeName2</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4462"></a>                           <span class="n">WHSaveNodeNames</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OutletNodeName2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4463"></a>                          <span class="s1">&#39;Source Side Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-4464"></a>        <span class="n">ENDIF</span>
<a name="ln-4465"></a>      <span class="n">ENDDO</span>
<a name="ln-4466"></a>    <span class="n">ENDIF</span>
<a name="ln-4467"></a>
<a name="ln-4468"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterThermalTank</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4469"></a><span class="k">      DO </span><span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterThermalTank</span>
<a name="ln-4470"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">/=</span> <span class="n">MixedChilledWaterStorage</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-4471"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">/=</span> <span class="n">StratifiedChilledWaterStorage</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4472"></a>          <span class="c">! Setup report variables for WaterHeater:Mixed</span>
<a name="ln-4473"></a>          <span class="c">! CurrentModuleObject=&#39;WaterHeater:Mixed&#39;</span>
<a name="ln-4474"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Tank Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4475"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempAvg</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4476"></a>
<a name="ln-4477"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Final Tank Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4478"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4479"></a>
<a name="ln-4480"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heat Loss Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4481"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">LossRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4482"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heat Loss Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4483"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">LossEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4484"></a>
<a name="ln-4485"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Use Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4486"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4487"></a>
<a name="ln-4488"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Use Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4489"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4490"></a>
<a name="ln-4491"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Use Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4492"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4493"></a>
<a name="ln-4494"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Use Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4495"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4496"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Use Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4497"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4498"></a>
<a name="ln-4499"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4500"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4501"></a>
<a name="ln-4502"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4503"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4504"></a>
<a name="ln-4505"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4506"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4507"></a>
<a name="ln-4508"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4509"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4510"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4511"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4512"></a>            <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPHEATINGDEMAND&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4513"></a>            <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span><span class="p">)</span>
<a name="ln-4514"></a>
<a name="ln-4515"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Off Cycle Parasitic Tank Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4516"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaRateToTank</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4517"></a>               <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4518"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Off Cycle Parasitic Tank Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4519"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaEnergyToTank</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4520"></a>
<a name="ln-4521"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater On Cycle Parasitic Tank Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4522"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaRateToTank</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4523"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater On Cycle Parasitic Tank Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4524"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaEnergyToTank</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4525"></a>
<a name="ln-4526"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Total Demand Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4527"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TotalDemandRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4528"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Total Demand Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4529"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TotalDemandEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4530"></a>
<a name="ln-4531"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4532"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4533"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heating Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4534"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4535"></a>
<a name="ln-4536"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Unmet Demand Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4537"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UnmetRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4538"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Unmet Demand Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4539"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UnmetEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4540"></a>
<a name="ln-4541"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Venting Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4542"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VentRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4543"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Venting Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4544"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VentEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4545"></a>
<a name="ln-4546"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Net Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4547"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">NetHeatTransferRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4548"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Net Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4549"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">NetHeatTransferEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4550"></a>
<a name="ln-4551"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Cycle On Count []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4552"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">CycleOnCount</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4553"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4554"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4555"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4556"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4557"></a>
<a name="ln-4558"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4559"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4560"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4561"></a>          <span class="k">ELSE</span>
<a name="ln-4562"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4563"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4564"></a>          <span class="n">ENDIF</span>
<a name="ln-4565"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4566"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4567"></a>            <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4568"></a>            <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span><span class="p">)</span>
<a name="ln-4569"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span><span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4570"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-4571"></a>              <span class="s1">&#39;Water Heater Off Cycle Parasitic Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4572"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4573"></a>             <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4574"></a>          <span class="k">ELSE</span>
<a name="ln-4575"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-4576"></a>              <span class="s1">&#39;Water Heater Off Cycle Parasitic &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4577"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4578"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span><span class="p">,&amp;</span>
<a name="ln-4579"></a>              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4580"></a>          <span class="n">ENDIF</span>
<a name="ln-4581"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-4582"></a>              <span class="s1">&#39;Water Heater Off Cycle Parasitic &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4583"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4584"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4585"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4586"></a>              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelType</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4587"></a>              <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span><span class="p">)</span>
<a name="ln-4588"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span><span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4589"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-4590"></a>              <span class="s1">&#39;Water Heater On Cycle Parasitic Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4591"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4592"></a>          <span class="k">ELSE</span>
<a name="ln-4593"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-4594"></a>              <span class="s1">&#39;Water Heater On Cycle Parasitic &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4595"></a>                 <span class="s1">&#39; Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4596"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4597"></a>          <span class="n">ENDIF</span>
<a name="ln-4598"></a>
<a name="ln-4599"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-4600"></a>            <span class="s1">&#39;Water Heater On Cycle Parasitic &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4601"></a>               <span class="s1">&#39; Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4602"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4603"></a>            <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelType</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4604"></a>            <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span><span class="p">)</span>
<a name="ln-4605"></a>
<a name="ln-4606"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Water Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4607"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4608"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Water Volume [m3]&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolumeConsumed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4609"></a>            <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4610"></a>            <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span><span class="p">)</span>
<a name="ln-4611"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Mains Water Volume [m3]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4612"></a>             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolumeConsumed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4613"></a>            <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;MainsWater&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4614"></a>            <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">EndUseSubcategoryName</span><span class="p">)</span>
<a name="ln-4615"></a>
<a name="ln-4616"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4617"></a>            <span class="c">!CurrentModuleObject=&#39;WaterHeater:HeatPump&#39;</span>
<a name="ln-4618"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Compressor Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4619"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">HeatingPLR</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4620"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4621"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Off Cycle Ancillary Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4622"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4623"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4624"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Off Cycle Ancillary Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4625"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4626"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4627"></a>              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="s1">&#39;Water Heater Parasitic&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-4628"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater On Cycle Ancillary Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4629"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4630"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4631"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater On Cycle Ancillary Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4632"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">OnCycParaFuelEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4633"></a>              <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4634"></a>              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="s1">&#39;Water Heater Parasitic&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-4635"></a>          <span class="k">END IF</span>
<a name="ln-4636"></a>
<a name="ln-4637"></a><span class="k">         IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4638"></a>            <span class="c">!CurrentModuleObject=&#39;Coil:WaterHeating:Desuperheater&#39;</span>
<a name="ln-4639"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Part Load Ratio []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4640"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DesuperheaterPLR</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4641"></a>                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4642"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4643"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater On Cycle Parasitic Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4644"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4645"></a>                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4646"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4647"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater On Cycle Parasitic Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4648"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaFuelEnergy</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4649"></a>                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4650"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4651"></a>              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="s1">&#39;Water Heater Parasitic&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-4652"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Off Cycle Parasitic Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4653"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4654"></a>                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4655"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4656"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Off Cycle Parasitic Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4657"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4658"></a>                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4659"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4660"></a>              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="s1">&#39;Water Heater Parasitic&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-4661"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heat Reclaim Efficiency Modifier Multiplier []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4662"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTempOutput</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4663"></a>                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4664"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4665"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Pump Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4666"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpPower</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4667"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4668"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4669"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4670"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4671"></a>              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="s1">&#39;Desuperheater Pump&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-4672"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4673"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4674"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4675"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heating Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4676"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4677"></a>              <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4678"></a>              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;EnergyTransfer&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;DHW&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="s1">&#39;Water Heater&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-4679"></a>          <span class="k">END IF</span>
<a name="ln-4680"></a>
<a name="ln-4681"></a>          <span class="c">! Setup report variables for WaterHeater:Stratified</span>
<a name="ln-4682"></a>          <span class="c">! CurrentModuleObject=&#39;WaterHeater:Stratified&#39;</span>
<a name="ln-4683"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedWaterHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4684"></a>
<a name="ln-4685"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heater 1 Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4686"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate1</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4687"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heater 2 Heating Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4688"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate2</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4689"></a>
<a name="ln-4690"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heater 1 Heating Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4691"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterEnergy1</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4692"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heater 2 Heating Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4693"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterEnergy2</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4694"></a>
<a name="ln-4695"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heater 1 Cycle On Count []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4696"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">CycleOnCount1</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4697"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heater 2 Cycle On Count  []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4698"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">CycleOnCount2</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4699"></a>
<a name="ln-4700"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heater 1 Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4701"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">RuntimeFraction1</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4702"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Heater 2 Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4703"></a>              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">RuntimeFraction2</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4704"></a>
<a name="ln-4705"></a>            <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-4706"></a>              <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Temperature Node &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4707"></a>                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">TempAvg</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4708"></a>                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4709"></a>            <span class="k">END DO</span>
<a name="ln-4710"></a>
<a name="ln-4711"></a><span class="k">            DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-4712"></a>              <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Water Heater Final Temperature Node &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;  [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4713"></a>                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4714"></a>                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4715"></a>            <span class="k">END DO</span>
<a name="ln-4716"></a><span class="k">          END IF</span>
<a name="ln-4717"></a>
<a name="ln-4718"></a>
<a name="ln-4719"></a>
<a name="ln-4720"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedWaterHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4721"></a>
<a name="ln-4722"></a><span class="k">    </span><span class="mi">723</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;Water Heater Stratified Node Information&#39;</span><span class="p">,</span><span class="mi">8</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-4723"></a>
<a name="ln-4724"></a>            <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-4725"></a>              <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">723</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)),</span>                            <span class="p">&amp;</span>
<a name="ln-4726"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>          <span class="p">&amp;</span>
<a name="ln-4727"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>          <span class="p">&amp;</span>
<a name="ln-4728"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MaxCapacity</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>     <span class="p">&amp;</span>
<a name="ln-4729"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-4730"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-4731"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Inlets</span><span class="p">)),</span>            <span class="p">&amp;</span>
<a name="ln-4732"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Outlets</span><span class="p">))</span>
<a name="ln-4733"></a>            <span class="k">END DO</span>
<a name="ln-4734"></a><span class="k">          END IF</span>
<a name="ln-4735"></a>
<a name="ln-4736"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4737"></a><span class="k">            CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting water heater input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-4738"></a>          <span class="k">END IF</span>
<a name="ln-4739"></a>
<a name="ln-4740"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">MixedChilledWaterStorage</span><span class="p">)</span>        <span class="p">&amp;</span>
<a name="ln-4741"></a>                <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedChilledWaterStorage</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4742"></a>          <span class="c">! CurrentModuleObject=&#39;ThermalStorage:ChilledWater:Mixed/ThermalStorage:ChilledWater:Stratified&#39;</span>
<a name="ln-4743"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Tank Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4744"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempAvg</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4745"></a>
<a name="ln-4746"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Final Tank Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4747"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4748"></a>
<a name="ln-4749"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Tank Heat Gain Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4750"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">LossRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4751"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Tank Heat Gain Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4752"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">LossEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4753"></a>
<a name="ln-4754"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Use Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4755"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4756"></a>
<a name="ln-4757"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Use Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4758"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4759"></a>
<a name="ln-4760"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Use Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4761"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4762"></a>
<a name="ln-4763"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Use Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4764"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4765"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Use Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4766"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4767"></a>
<a name="ln-4768"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Source Side Mass Flow Rate [kg/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4769"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4770"></a>
<a name="ln-4771"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Source Side Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4772"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4773"></a>
<a name="ln-4774"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Source Side Outlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4775"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4776"></a>
<a name="ln-4777"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Source Side Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4778"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4779"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4780"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEnergy</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4781"></a>
<a name="ln-4782"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedChilledWaterStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4783"></a>
<a name="ln-4784"></a><span class="k">            DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-4785"></a>              <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Temperature Node &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4786"></a>                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">TempAvg</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4787"></a>                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4788"></a>            <span class="k">END DO</span>
<a name="ln-4789"></a>
<a name="ln-4790"></a><span class="k">            DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-4791"></a>              <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Chilled Water Thermal Storage Final Temperature Node &#39;</span> <span class="p">&amp;</span>
<a name="ln-4792"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4793"></a>                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4794"></a>                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4795"></a>            <span class="k">END DO</span>
<a name="ln-4796"></a><span class="k">          END IF</span>
<a name="ln-4797"></a>
<a name="ln-4798"></a>
<a name="ln-4799"></a>
<a name="ln-4800"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedChilledWaterStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4801"></a>
<a name="ln-4802"></a><span class="k">    </span><span class="mi">724</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;Chilled Water Tank Stratified Node Information&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-4803"></a>
<a name="ln-4804"></a>            <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-4805"></a>              <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">724</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)),</span>                            <span class="p">&amp;</span>
<a name="ln-4806"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Height</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>          <span class="p">&amp;</span>
<a name="ln-4807"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>          <span class="p">&amp;</span>
<a name="ln-4808"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-4809"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Inlets</span><span class="p">)),</span>            <span class="p">&amp;</span>
<a name="ln-4810"></a>                <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Outlets</span><span class="p">))</span>
<a name="ln-4811"></a>            <span class="k">END DO</span>
<a name="ln-4812"></a><span class="k">          END IF</span>
<a name="ln-4813"></a>
<a name="ln-4814"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4815"></a><span class="k">            CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting chilled water tank input. Preceding condition causes termination.&#39;</span><span class="p">)</span>
<a name="ln-4816"></a>          <span class="k">END IF</span>
<a name="ln-4817"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-4818"></a>
<a name="ln-4819"></a>        <span class="c">! set up internal gains if tank is in a thermal zone</span>
<a name="ln-4820"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4821"></a><span class="k">          SELECT CASE</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">)</span>
<a name="ln-4822"></a>
<a name="ln-4823"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-4824"></a>            <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4825"></a>                                   <span class="s1">&#39;WaterHeater:Mixed&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4826"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4827"></a>                                   <span class="n">IntGainTypeOf_WaterHeaterMixed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4828"></a>                                   <span class="n">ConvectionGainRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientZoneGain</span> <span class="p">)</span>
<a name="ln-4829"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-4830"></a>            <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4831"></a>                                   <span class="s1">&#39;WaterHeater:Stratified&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4832"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4833"></a>                                   <span class="n">IntGainTypeOf_WaterHeaterStratified</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4834"></a>                                   <span class="n">ConvectionGainRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientZoneGain</span> <span class="p">)</span>
<a name="ln-4835"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">MixedChilledWaterStorage</span><span class="p">)</span>
<a name="ln-4836"></a>            <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4837"></a>                                   <span class="s1">&#39;ThermalStorage:ChilledWater:Mixed&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4838"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4839"></a>                                   <span class="n">IntGainTypeOf_ThermalStorageChilledWaterMixed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4840"></a>                                   <span class="n">ConvectionGainRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientZoneGain</span> <span class="p">)</span>
<a name="ln-4841"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">StratifiedChilledWaterStorage</span><span class="p">)</span>
<a name="ln-4842"></a>            <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4843"></a>                                   <span class="s1">&#39;ThermalStorage:ChilledWater:Stratified&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4844"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4845"></a>                                   <span class="n">IntGainTypeOf_ThermalStorageChilledWaterStratified</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4846"></a>                                   <span class="n">ConvectionGainRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientZoneGain</span> <span class="p">)</span>
<a name="ln-4847"></a>          <span class="k">END SELECT</span>
<a name="ln-4848"></a>
<a name="ln-4849"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-4850"></a>
<a name="ln-4851"></a>      <span class="k">END DO</span> <span class="c">! WaterThermalTankNum</span>
<a name="ln-4852"></a>    <span class="k">END IF</span>
<a name="ln-4853"></a>
<a name="ln-4854"></a><span class="k">  END IF</span> <span class="c">! get input flag</span>
<a name="ln-4855"></a>
<a name="ln-4856"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">HPWHSaveNodeNames</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">HPWHSaveNodeNames</span><span class="p">)</span>
<a name="ln-4857"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">WHSaveNodeNames</span><span class="p">)</span>
<a name="ln-4858"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">CoilSaveNodeNames</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">CoilSaveNodeNames</span><span class="p">)</span>
<a name="ln-4859"></a>
<a name="ln-4860"></a>  <span class="k">RETURN</span>
<a name="ln-4861"></a>
<a name="ln-4862"></a><span class="k">END SUBROUTINE </span><span class="n">GetWaterThermalTankInput</span>
<a name="ln-4863"></a>
<a name="ln-4864"></a><span class="k">SUBROUTINE </span><span class="n">ValidatePLFCurve</span><span class="p">(</span><span class="n">CurveIndex</span><span class="p">,</span> <span class="n">IsValid</span><span class="p">)</span>
<a name="ln-4865"></a>
<a name="ln-4866"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4867"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-4868"></a>          <span class="c">!       DATE WRITTEN   February 2005</span>
<a name="ln-4869"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4870"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4871"></a>
<a name="ln-4872"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4873"></a>          <span class="c">! Validates the Part Load Factor curve by making sure it can never be less than or equal to zero</span>
<a name="ln-4874"></a>          <span class="c">! over the domain of Part Load Ratio inputs from 0 to 1.</span>
<a name="ln-4875"></a>
<a name="ln-4876"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4877"></a>          <span class="c">! Currently can only check 0 and 1.  Need changes in CurveManager to be able to check minimums and</span>
<a name="ln-4878"></a>          <span class="c">! maximums.</span>
<a name="ln-4879"></a>
<a name="ln-4880"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4881"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span><span class="p">,</span> <span class="n">GetCurveType</span>
<a name="ln-4882"></a>
<a name="ln-4883"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4884"></a>
<a name="ln-4885"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4886"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CurveIndex</span>
<a name="ln-4887"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IsValid</span>
<a name="ln-4888"></a>
<a name="ln-4889"></a>          <span class="c">! FLOW:</span>
<a name="ln-4890"></a>  <span class="n">IsValid</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4891"></a>
<a name="ln-4892"></a>  <span class="c">! Check 0 and 1</span>
<a name="ln-4893"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">CurveIndex</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">IsValid</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4894"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">CurveIndex</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">IsValid</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4895"></a>
<a name="ln-4896"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IsValid</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Check min/maxs</span>
<a name="ln-4897"></a>
<a name="ln-4898"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">CurveIndex</span><span class="p">))</span>
<a name="ln-4899"></a>
<a name="ln-4900"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;QUADRATIC&#39;</span><span class="p">)</span>
<a name="ln-4901"></a>        <span class="c">! Curve coeffs are not currently exposed so there&#39;s no good way to do this yet</span>
<a name="ln-4902"></a>
<a name="ln-4903"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CUBIC&#39;</span><span class="p">)</span>
<a name="ln-4904"></a>
<a name="ln-4905"></a>    <span class="k">END SELECT</span>
<a name="ln-4906"></a>
<a name="ln-4907"></a><span class="k">  END IF</span>
<a name="ln-4908"></a>
<a name="ln-4909"></a><span class="k">  RETURN</span>
<a name="ln-4910"></a>
<a name="ln-4911"></a><span class="k">END SUBROUTINE </span><span class="n">ValidatePLFCurve</span>
<a name="ln-4912"></a>
<a name="ln-4913"></a>
<a name="ln-4914"></a><span class="k">SUBROUTINE </span><span class="n">SetupStratifiedNodes</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-4915"></a>
<a name="ln-4916"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4917"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-4918"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-4919"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4920"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4921"></a>
<a name="ln-4922"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4923"></a>          <span class="c">! Sets up node properties based on the tank shape, i.e., vertical cylinder, horizontal cylinder, or other.</span>
<a name="ln-4924"></a>          <span class="c">! Node height, skin area, vertical conduction area, and loss coefficients are calculated and assigned.</span>
<a name="ln-4925"></a>          <span class="c">! Heating elements, parasitics, and fluid inlet and outlet flows are assigned according to node height.</span>
<a name="ln-4926"></a>
<a name="ln-4927"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4928"></a>          <span class="c">! Tank is divided into nodes of equal mass.  For horizontal cylinders, node heights are calculated using</span>
<a name="ln-4929"></a>          <span class="c">! the Newton-Raphson iterative method.  For vertical cylinders and other shapes, the node heights are calculated</span>
<a name="ln-4930"></a>          <span class="c">! using basic geometry.</span>
<a name="ln-4931"></a>
<a name="ln-4932"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4933"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Pi</span>
<a name="ln-4934"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-4935"></a>
<a name="ln-4936"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4937"></a>
<a name="ln-4938"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4939"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>      <span class="c">! Water Heater being simulated</span>
<a name="ln-4940"></a>
<a name="ln-4941"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4942"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">1.0d-8</span>  <span class="c">! Tolerance for Newton-Raphson solution</span>
<a name="ln-4943"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FluidCond</span> <span class="o">=</span> <span class="mf">0.6d0</span>     <span class="c">! Conductivity of water (W/m-K)</span>
<a name="ln-4944"></a>
<a name="ln-4945"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4946"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">NumNodes</span>            <span class="c">! Number of stratified nodes</span>
<a name="ln-4947"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">NodeNum</span>             <span class="c">! Node number index</span>
<a name="ln-4948"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NodeMass</span>            <span class="c">! Mass of one node (kg)</span>
<a name="ln-4949"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">EndArea</span>             <span class="c">! Circular area of one end of the cylinder (m2)</span>
<a name="ln-4950"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CrossArea</span>           <span class="c">! Cross sectional area (for horizontal cylinders) (m2)</span>
<a name="ln-4951"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NodeEndArea</span>         <span class="c">! Area of the node at the end of the horizontal cylinder (m2)</span>
<a name="ln-4952"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NodeHeight</span>          <span class="c">! Height of one node (m)</span>
<a name="ln-4953"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ApproxEndArea</span>       <span class="c">! End area approximated by Newton-Raphson iteration (m2)</span>
<a name="ln-4954"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CondCoeff</span>           <span class="c">! Coefficient for vertical conduction between nodes (W/K)</span>
<a name="ln-4955"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Radius</span>              <span class="c">! Radius of the tank (m)</span>
<a name="ln-4956"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Perimeter</span>           <span class="c">! Perimeter of the tank (m)</span>
<a name="ln-4957"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SkinArea</span>            <span class="c">! Area of skin exposed to ambient environment (m2)</span>
<a name="ln-4958"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">ChordLength</span>         <span class="c">! Chord length for horizontal tanks (m)</span>
<a name="ln-4959"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankHeight</span>          <span class="c">! Dimension in the vertical direction; for horizontal tanks it is radius * 2 (m)</span>
<a name="ln-4960"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankLength</span>          <span class="c">! For horizontal tanks, it is the length in the axial direction (m)</span>
<a name="ln-4961"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">R</span>                   <span class="c">! Radius (m)</span>
<a name="ln-4962"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H0</span>                  <span class="c">! Starting height (m)</span>
<a name="ln-4963"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">H</span>                   <span class="c">! Ending height (m)</span>
<a name="ln-4964"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>             <span class="c">! Intermediate variables</span>
<a name="ln-4965"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">c0</span>          <span class="c">! Intermediate variables</span>
<a name="ln-4966"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">G</span>                   <span class="c">! Function that should converge to zero for the Newton-Raphson solution</span>
<a name="ln-4967"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span>                 <span class="c">! local fluid density (kg/m3)</span>
<a name="ln-4968"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4969"></a>
<a name="ln-4970"></a>          <span class="c">! FLOW:</span>
<a name="ln-4971"></a>  <span class="n">NumNodes</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-4972"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NumNodes</span><span class="p">))</span>
<a name="ln-4973"></a>
<a name="ln-4974"></a>  <span class="k">IF</span> <span class="p">((</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">Allocated</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4975"></a><span class="k">    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4976"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4977"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4978"></a>                                 <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-4979"></a>  <span class="k">ELSE</span>
<a name="ln-4980"></a><span class="k">    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-4981"></a>  <span class="n">ENDIF</span>
<a name="ln-4982"></a>
<a name="ln-4983"></a>
<a name="ln-4984"></a>  <span class="n">NodeMass</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">NumNodes</span>
<a name="ln-4985"></a>
<a name="ln-4986"></a>  <span class="c">! Mixing rate set to 50% of the max value for dt = 1.0</span>
<a name="ln-4987"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InversionMixingRate</span> <span class="o">=</span> <span class="n">NodeMass</span> <span class="o">*</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="mf">1.0d0</span>
<a name="ln-4988"></a>
<a name="ln-4989"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">TankShapeVertCylinder</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4990"></a>    <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">TankShapeOther</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4991"></a>
<a name="ln-4992"></a><span class="k">    </span><span class="n">TankHeight</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-4993"></a>    <span class="n">EndArea</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">/</span> <span class="n">TankHeight</span>
<a name="ln-4994"></a>    <span class="n">NodeHeight</span> <span class="o">=</span> <span class="n">TankHeight</span> <span class="o">/</span> <span class="n">NumNodes</span>
<a name="ln-4995"></a>    <span class="n">CondCoeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidCond</span> <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalCond</span><span class="p">)</span><span class="o">*</span> <span class="n">EndArea</span> <span class="o">/</span> <span class="n">NodeHeight</span>
<a name="ln-4996"></a>
<a name="ln-4997"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">TankShapeVertCylinder</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4998"></a><span class="k">      </span><span class="n">Radius</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">EndArea</span> <span class="o">/</span> <span class="n">Pi</span><span class="p">)</span>
<a name="ln-4999"></a>      <span class="n">Perimeter</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">Radius</span>
<a name="ln-5000"></a>    <span class="k">ELSE</span>  <span class="c">! TankShapeOther</span>
<a name="ln-5001"></a>      <span class="n">Perimeter</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Perimeter</span>
<a name="ln-5002"></a>    <span class="k">END IF</span>
<a name="ln-5003"></a>
<a name="ln-5004"></a><span class="k">    DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumNodes</span>
<a name="ln-5005"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Mass</span> <span class="o">=</span> <span class="n">NodeMass</span>
<a name="ln-5006"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">/</span> <span class="n">NumNodes</span>
<a name="ln-5007"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">=</span> <span class="n">NodeHeight</span>
<a name="ln-5008"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">CondCoeffUp</span> <span class="o">=</span> <span class="n">CondCoeff</span>
<a name="ln-5009"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">CondCoeffDn</span> <span class="o">=</span> <span class="n">CondCoeff</span>
<a name="ln-5010"></a>
<a name="ln-5011"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">NodeNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">==</span> <span class="n">NumNodes</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5012"></a><span class="k">        </span><span class="n">SkinArea</span> <span class="o">=</span> <span class="n">Perimeter</span> <span class="o">*</span> <span class="n">NodeHeight</span> <span class="o">+</span> <span class="n">EndArea</span>
<a name="ln-5013"></a>      <span class="k">ELSE</span>
<a name="ln-5014"></a><span class="k">        </span><span class="n">SkinArea</span> <span class="o">=</span> <span class="n">Perimeter</span> <span class="o">*</span> <span class="n">NodeHeight</span>
<a name="ln-5015"></a>      <span class="k">END IF</span>
<a name="ln-5016"></a>
<a name="ln-5017"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5018"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossCoeff</span> <span class="o">*</span> <span class="n">SkinArea</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-5019"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalLossCoeff</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)</span>
<a name="ln-5020"></a>
<a name="ln-5021"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5022"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-5023"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycFlueLossCoeff</span>
<a name="ln-5024"></a>
<a name="ln-5025"></a>    <span class="k">END DO</span>  <span class="c">! NodeNum</span>
<a name="ln-5026"></a>
<a name="ln-5027"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">CondCoeffUp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5028"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NumNodes</span><span class="p">)%</span><span class="n">CondCoeffDn</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5029"></a>
<a name="ln-5030"></a>  <span class="k">ELSE</span>  <span class="c">! WaterThermalTank(WaterThermalTankNum)%Shape == TankShapeHorizCylinder</span>
<a name="ln-5031"></a>    <span class="n">TankLength</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>  <span class="c">! Height is the length in the axial direction</span>
<a name="ln-5032"></a>    <span class="n">EndArea</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">/</span> <span class="n">TankLength</span>
<a name="ln-5033"></a>    <span class="n">Radius</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">EndArea</span> <span class="o">/</span> <span class="n">Pi</span><span class="p">)</span>
<a name="ln-5034"></a>    <span class="n">TankHeight</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">Radius</span>  <span class="c">! Actual vertical height</span>
<a name="ln-5035"></a>    <span class="n">NodeEndArea</span> <span class="o">=</span> <span class="n">EndArea</span> <span class="o">/</span> <span class="n">NumNodes</span>
<a name="ln-5036"></a>
<a name="ln-5037"></a>    <span class="n">R</span> <span class="o">=</span> <span class="n">Radius</span>
<a name="ln-5038"></a>    <span class="n">H0</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5039"></a>    <span class="n">ChordLength</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5040"></a>    <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumNodes</span>
<a name="ln-5041"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Mass</span> <span class="o">=</span> <span class="n">NodeMass</span>
<a name="ln-5042"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">/</span> <span class="n">NumNodes</span>
<a name="ln-5043"></a>
<a name="ln-5044"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">==</span> <span class="n">NumNodes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5045"></a><span class="k">        </span><span class="n">H</span> <span class="o">=</span> <span class="n">TankHeight</span>
<a name="ln-5046"></a>
<a name="ln-5047"></a>      <span class="k">ELSE</span>
<a name="ln-5048"></a>        <span class="c">! Use the Newton-Raphson method to solve the nonlinear algebraic equation for node height</span>
<a name="ln-5049"></a>        <span class="n">H</span> <span class="o">=</span> <span class="n">H0</span> <span class="o">+</span> <span class="n">TankHeight</span> <span class="o">/</span> <span class="n">NumNodes</span>  <span class="c">! Initial guess</span>
<a name="ln-5050"></a>
<a name="ln-5051"></a>        <span class="k">DO WHILE</span> <span class="p">(.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-5052"></a>          <span class="n">a</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a name="ln-5053"></a>          <span class="n">b</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">R</span> <span class="o">-</span> <span class="n">H</span><span class="p">)</span>
<a name="ln-5054"></a>          <span class="n">c</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="nb">ATAN</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">R</span> <span class="o">-</span> <span class="mf">3.0d0</span> <span class="o">*</span> <span class="n">H</span> <span class="o">*</span> <span class="n">R</span> <span class="o">+</span> <span class="n">H</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>
<a name="ln-5055"></a>
<a name="ln-5056"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">H0</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5057"></a><span class="k">            </span><span class="n">a0</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">H0</span><span class="p">)</span>
<a name="ln-5058"></a>            <span class="n">b0</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">R</span> <span class="o">-</span> <span class="n">H0</span><span class="p">)</span>
<a name="ln-5059"></a>            <span class="n">c0</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="nb">ATAN</span><span class="p">(</span><span class="n">a0</span> <span class="o">/</span> <span class="n">b0</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">R</span> <span class="o">-</span> <span class="mf">3.0d0</span> <span class="o">*</span> <span class="n">H0</span> <span class="o">*</span> <span class="n">R</span> <span class="o">+</span> <span class="n">H0</span> <span class="o">*</span> <span class="n">H0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a0</span> <span class="o">/</span> <span class="n">b0</span><span class="p">)</span>
<a name="ln-5060"></a>          <span class="k">ELSE</span>
<a name="ln-5061"></a><span class="k">            </span><span class="n">c0</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5062"></a>          <span class="k">END IF</span>
<a name="ln-5063"></a>
<a name="ln-5064"></a><span class="k">          </span><span class="n">ApproxEndArea</span> <span class="o">=</span> <span class="n">c</span> <span class="o">-</span> <span class="n">c0</span>  <span class="c">! Area approximated by iteration</span>
<a name="ln-5065"></a>          <span class="n">G</span> <span class="o">=</span> <span class="n">ApproxEndArea</span> <span class="o">-</span> <span class="n">NodeEndArea</span>  <span class="c">! G is the function that should converge to zero</span>
<a name="ln-5066"></a>
<a name="ln-5067"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Tolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5068"></a><span class="k">            EXIT</span>  <span class="c">! Converged !!!</span>
<a name="ln-5069"></a>          <span class="k">ELSE</span>
<a name="ln-5070"></a><span class="k">            </span><span class="n">H</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="n">G</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>  <span class="c">! Calculate next guess:  H = Hprev - G/G&#39;</span>
<a name="ln-5071"></a>          <span class="k">END IF</span>
<a name="ln-5072"></a><span class="k">        END DO</span>  <span class="c">! Newton-Raphson</span>
<a name="ln-5073"></a>
<a name="ln-5074"></a>      <span class="k">END IF</span>
<a name="ln-5075"></a>
<a name="ln-5076"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="n">H0</span>
<a name="ln-5077"></a>
<a name="ln-5078"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5079"></a><span class="k">        </span><span class="n">CrossArea</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">ChordLength</span> <span class="o">*</span> <span class="n">TankLength</span>  <span class="c">! Use old ChordLength from previous node</span>
<a name="ln-5080"></a>        <span class="n">CondCoeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">FluidCond</span> <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalCond</span><span class="p">)</span><span class="o">*</span> <span class="n">CrossArea</span> <span class="p">&amp;</span>
<a name="ln-5081"></a>          <span class="o">/</span> <span class="p">(</span><span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">H</span> <span class="o">-</span> <span class="n">H0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Height</span><span class="p">)</span>
<a name="ln-5082"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">CondCoeffUp</span> <span class="o">=</span> <span class="n">CondCoeff</span>  <span class="c">! Set for previous node</span>
<a name="ln-5083"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">CondCoeffDn</span> <span class="o">=</span> <span class="n">CondCoeff</span>  <span class="c">! Set for this node</span>
<a name="ln-5084"></a>      <span class="k">END IF</span>
<a name="ln-5085"></a>
<a name="ln-5086"></a><span class="k">      </span><span class="n">ChordLength</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">H</span> <span class="o">-</span> <span class="n">H</span> <span class="o">*</span> <span class="n">H</span><span class="p">)</span>  <span class="c">! Calc new ChordLength to be used with next node</span>
<a name="ln-5087"></a>
<a name="ln-5088"></a>      <span class="n">Perimeter</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="p">(</span><span class="nb">ACOS</span><span class="p">((</span><span class="n">R</span> <span class="o">-</span> <span class="n">H</span><span class="p">)</span><span class="o">/</span> <span class="n">R</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ACOS</span><span class="p">((</span><span class="n">R</span> <span class="o">-</span> <span class="n">H0</span><span class="p">)</span><span class="o">/</span> <span class="n">R</span><span class="p">))</span>  <span class="c">! Segments of circular perimeter</span>
<a name="ln-5089"></a>      <span class="n">SkinArea</span> <span class="o">=</span> <span class="n">Perimeter</span> <span class="o">*</span> <span class="n">TankLength</span> <span class="o">+</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">NodeEndArea</span>
<a name="ln-5090"></a>
<a name="ln-5091"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5092"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossCoeff</span> <span class="o">*</span> <span class="n">SkinArea</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-5093"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AdditionalLossCoeff</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)</span>
<a name="ln-5094"></a>
<a name="ln-5095"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5096"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-5097"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycFlueLossCoeff</span>
<a name="ln-5098"></a>        <span class="c">! Although it doesn&#39;t make much sense to have a flue in a horizontal tank, keep it in anyway</span>
<a name="ln-5099"></a>
<a name="ln-5100"></a>      <span class="n">H0</span> <span class="o">=</span> <span class="n">H</span>
<a name="ln-5101"></a>    <span class="k">END DO</span>  <span class="c">! NodeNum</span>
<a name="ln-5102"></a>
<a name="ln-5103"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">CondCoeffUp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5104"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NumNodes</span><span class="p">)%</span><span class="n">CondCoeffDn</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5105"></a>  <span class="k">END IF</span>
<a name="ln-5106"></a>
<a name="ln-5107"></a>  <span class="c">! Loop through nodes again (from top to bottom this time) and assign heating elements, parasitics, flow inlets/outlets</span>
<a name="ln-5108"></a>  <span class="c">! according to their vertical heights in the tank.</span>
<a name="ln-5109"></a>  <span class="n">H0</span> <span class="o">=</span> <span class="n">TankHeight</span>
<a name="ln-5110"></a>  <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumNodes</span>
<a name="ln-5111"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">==</span> <span class="n">NumNodes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5112"></a><span class="k">      </span><span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0d0</span>  <span class="c">! Avoids rounding errors and ensures that anything at height 0.0 goes into the bottom node</span>
<a name="ln-5113"></a>    <span class="k">ELSE</span>
<a name="ln-5114"></a><span class="k">      </span><span class="n">H</span> <span class="o">=</span> <span class="n">H0</span> <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-5115"></a>    <span class="k">END IF</span>
<a name="ln-5116"></a>
<a name="ln-5117"></a>    <span class="c">! Assign heater elements to the nodes at the specified heights</span>
<a name="ln-5118"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight1</span> <span class="o">&lt;=</span> <span class="n">H0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5119"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight1</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5120"></a><span class="c">!       sensor node will not get set if user enters 0 for this heater capacity</span>
<a name="ln-5121"></a><span class="c">!       (WaterThermalTank(WaterThermalTankNum)%MaxCapacity &gt; 0.0d0)) THEN</span>
<a name="ln-5122"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode1</span> <span class="o">=</span> <span class="n">NodeNum</span>
<a name="ln-5123"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-5124"></a>    <span class="k">END IF</span>
<a name="ln-5125"></a>
<a name="ln-5126"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight2</span> <span class="o">&lt;=</span> <span class="n">H0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5127"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterHeight2</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5128"></a><span class="c">!       sensor node will not get set if user enters 0 for this heater capacity</span>
<a name="ln-5129"></a><span class="c">!      .AND. (WaterThermalTank(WaterThermalTankNum)%MaxCapacity2 &gt; 0.0d0)) THEN</span>
<a name="ln-5130"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode2</span> <span class="o">=</span> <span class="n">NodeNum</span>
<a name="ln-5131"></a>
<a name="ln-5132"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">NodeNum</span> <span class="o">==</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode1</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5133"></a>        <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">PrioritySimultaneous</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5134"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5135"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>  <span class="p">&amp;</span>
<a name="ln-5136"></a>          <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity2</span>
<a name="ln-5137"></a>      <span class="k">ELSE</span>
<a name="ln-5138"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity2</span>
<a name="ln-5139"></a>      <span class="k">END IF</span>
<a name="ln-5140"></a><span class="k">    END IF</span>
<a name="ln-5141"></a>
<a name="ln-5142"></a>    <span class="c">! Assign parasitic heat gains to the nodes at the specified heights</span>
<a name="ln-5143"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaHeight</span> <span class="o">&lt;=</span> <span class="n">H0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5144"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaHeight</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5145"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-5146"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span>
<a name="ln-5147"></a>    <span class="k">END IF</span>
<a name="ln-5148"></a>
<a name="ln-5149"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaHeight</span> <span class="o">&lt;=</span> <span class="n">H0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5150"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaHeight</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5151"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-5152"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>
<a name="ln-5153"></a>    <span class="k">END IF</span>
<a name="ln-5154"></a>
<a name="ln-5155"></a>    <span class="c">! Assign inlets and outlets to the nodes at the specified heights</span>
<a name="ln-5156"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletHeight</span> <span class="o">&lt;=</span> <span class="n">H0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5157"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletHeight</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5158"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletStratNode</span> <span class="o">=</span> <span class="n">NodeNum</span>
<a name="ln-5159"></a>
<a name="ln-5160"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5161"></a>         <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span>  <span class="p">&amp;</span>
<a name="ln-5162"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Inlets</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5163"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Inlets</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5164"></a>    <span class="k">END IF</span>
<a name="ln-5165"></a>
<a name="ln-5166"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletHeight</span> <span class="o">&lt;=</span> <span class="n">H0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5167"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletHeight</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5168"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletStratNode</span> <span class="o">=</span> <span class="n">NodeNum</span>
<a name="ln-5169"></a>
<a name="ln-5170"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5171"></a>         <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span>  <span class="p">&amp;</span>
<a name="ln-5172"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Outlets</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5173"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Outlets</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5174"></a>    <span class="k">END IF</span>
<a name="ln-5175"></a>
<a name="ln-5176"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletHeight</span> <span class="o">&lt;=</span> <span class="n">H0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5177"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletHeight</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5178"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5179"></a>
<a name="ln-5180"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletStratNode</span> <span class="o">=</span> <span class="n">NodeNum</span>
<a name="ln-5181"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Inlets</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Inlets</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5182"></a>    <span class="k">END IF</span>
<a name="ln-5183"></a>
<a name="ln-5184"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletHeight</span> <span class="o">&lt;=</span> <span class="n">H0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5185"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletHeight</span> <span class="o">&gt;</span> <span class="n">H</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5186"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5187"></a>
<a name="ln-5188"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletStratNode</span> <span class="o">=</span> <span class="n">NodeNum</span>
<a name="ln-5189"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Outlets</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Outlets</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5190"></a>    <span class="k">END IF</span>
<a name="ln-5191"></a>
<a name="ln-5192"></a><span class="k">    </span><span class="n">H0</span> <span class="o">=</span> <span class="n">H</span>
<a name="ln-5193"></a>  <span class="k">END DO</span>  <span class="c">! NodeNum</span>
<a name="ln-5194"></a>
<a name="ln-5195"></a>  <span class="k">RETURN</span>
<a name="ln-5196"></a>
<a name="ln-5197"></a><span class="k">END SUBROUTINE </span><span class="n">SetupStratifiedNodes</span>
<a name="ln-5198"></a>
<a name="ln-5199"></a>
<a name="ln-5200"></a><span class="k">SUBROUTINE </span><span class="n">InitWaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span> <span class="p">)</span>
<a name="ln-5201"></a>
<a name="ln-5202"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5203"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-5204"></a>          <span class="c">!       DATE WRITTEN   February 2004</span>
<a name="ln-5205"></a>          <span class="c">!       MODIFIED       FSEC, July 2005</span>
<a name="ln-5206"></a>          <span class="c">!                      Brent Griffith, October 2007 indirect fired water heater</span>
<a name="ln-5207"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5208"></a>
<a name="ln-5209"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5210"></a>          <span class="c">! Initialize the water heater, heat pump water heater, or desuperheater heating coil objects during the simulation.</span>
<a name="ln-5211"></a>          <span class="c">! determine flow rates thru use side and source side plant connections (if any)</span>
<a name="ln-5212"></a>
<a name="ln-5213"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5214"></a>          <span class="c">! Inlet and outlet nodes are initialized.  Scheduled values are retrieved for the current timestep.</span>
<a name="ln-5215"></a>
<a name="ln-5216"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5217"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">AnyPlantInModel</span>
<a name="ln-5218"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowContinueErrorTimeStamp</span>
<a name="ln-5219"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-5220"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterMainsTemp</span><span class="p">,</span> <span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">OutBaroPress</span>
<a name="ln-5221"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-5222"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-5223"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">RhoH2O</span><span class="p">,</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyWFnTdbRhPb</span><span class="p">,</span> <span class="n">PsyHFnTdbW</span><span class="p">,</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">,</span> <span class="n">PsyWFnTdbTwbPb</span>
<a name="ln-5224"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">HPWHInletDBTemp</span><span class="p">,</span> <span class="n">HPWHInletWBTemp</span><span class="p">,</span> <span class="n">HPWHCrankcaseDBTemp</span><span class="p">,</span> <span class="n">NumPlantLoops</span>
<a name="ln-5225"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-5226"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-5227"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-5228"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneEquipInputsFilled</span><span class="p">,</span><span class="n">CheckZoneEquipmentList</span>
<a name="ln-5229"></a>  <span class="k">USE </span><span class="n">DataPlant</span>
<a name="ln-5230"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">SetComponentFlowRate</span><span class="p">,</span> <span class="n">InterConnectTwoPlantLoopSides</span>
<a name="ln-5231"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-5232"></a>
<a name="ln-5233"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5234"></a>
<a name="ln-5235"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5236"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-5237"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-5238"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-5239"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-5240"></a>
<a name="ln-5241"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5242"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">UseInletNode</span>            <span class="c">! Water heater use inlet node number</span>
<a name="ln-5243"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">UseOutletNode</span>           <span class="c">! Water heater use outlet node number</span>
<a name="ln-5244"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SourceInletNode</span>         <span class="c">! Water heater source inlet node number</span>
<a name="ln-5245"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SourceOutletNode</span>        <span class="c">! Water heater source outlet node number</span>
<a name="ln-5246"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SchIndex</span>                <span class="c">! Index to schedule</span>
<a name="ln-5247"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPNum</span>                   <span class="c">! Index to heat pump</span>
<a name="ln-5248"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPAirInletNode</span>          <span class="c">! HP air inlet node number</span>
<a name="ln-5249"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPAirOutletNode</span>         <span class="c">! HP air outlet node number</span>
<a name="ln-5250"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">OutdoorAirNode</span>          <span class="c">! Outdoor air inlet node number</span>
<a name="ln-5251"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">ExhaustAirNode</span>          <span class="c">! Exhaust air outlet node number</span>
<a name="ln-5252"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPWaterInletNode</span>        <span class="c">! HP condenser water inlet node number</span>
<a name="ln-5253"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPWaterOutletNode</span>       <span class="c">! HP condenser water outlet node number</span>
<a name="ln-5254"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">InletAirMixerNode</span>       <span class="c">! HP inlet node number after inlet mixing damper</span>
<a name="ln-5255"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">OutletAirSplitterNode</span>   <span class="c">! HP outlet node number before outlet mixing damper</span>
<a name="ln-5256"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">HPInletDryBulbTemp</span>      <span class="c">! HPWH&#39;s air inlet dry-bulb temperature, C</span>
<a name="ln-5257"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">HPInletHumRat</span>           <span class="c">! HPWH&#39;s air inlet humidity ratio, kg/kg</span>
<a name="ln-5258"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">HPInletRelHum</span>           <span class="c">! HPWH&#39;s air inlet relative humidity</span>
<a name="ln-5259"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DeadBandTemp</span>                 <span class="c">! Minimum tank temperature (SetpointTemp - DeadbandDeltaTemp) (C)</span>
<a name="ln-5260"></a><span class="c">!  LOGICAL,SAVE        :: ZoneEquipmentListChecked = .false.  ! True after the Zone Equipment List has been checked for items</span>
<a name="ln-5261"></a><span class="c">!  Integer             :: Loop</span>
<a name="ln-5262"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">InitWaterThermalTanksOnce</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! flag for 1 time initialization</span>
<a name="ln-5263"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! flag for init once at start of environment</span>
<a name="ln-5264"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyWarmupFlag</span> <span class="c">! flag for init after warmup complete</span>
<a name="ln-5265"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SetLoopIndexFlag</span>    <span class="c">! get loop number flag</span>
<a name="ln-5266"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizingDoneFlag</span> <span class="c">! true if sizing is finished</span>
<a name="ln-5267"></a>
<a name="ln-5268"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">sensedTemp</span>
<a name="ln-5269"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">tmpNodeNum</span>
<a name="ln-5270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">mdotUse</span> <span class="c">! local temporary for use side mass flow</span>
<a name="ln-5271"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">mdotSource</span> <span class="c">! local temporary for source side mass flow</span>
<a name="ln-5272"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-5273"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local fluid density</span>
<a name="ln-5274"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5275"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5276"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankChangeRateScale</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! local temporary for nominal tank change rate</span>
<a name="ln-5277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MaxSideVolFlow</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! local temporary for largest connection design flow</span>
<a name="ln-5278"></a>
<a name="ln-5279"></a>          <span class="c">! FLOW:</span>
<a name="ln-5280"></a>
<a name="ln-5281"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">InitWaterThermalTanksOnce</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5282"></a><span class="k">    ALLOCATE</span> <span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span>  <span class="n">NumWaterThermalTank</span>  <span class="p">))</span>
<a name="ln-5283"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MyWarmupFlag</span><span class="p">(</span> <span class="n">NumWaterThermalTank</span>  <span class="p">))</span>
<a name="ln-5284"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SetLoopIndexFlag</span><span class="p">(</span> <span class="n">NumWaterThermalTank</span> <span class="p">))</span>
<a name="ln-5285"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MySizingDoneFlag</span><span class="p">(</span> <span class="n">NumWaterThermalTank</span> <span class="p">))</span>
<a name="ln-5286"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AlreadyRated</span><span class="p">(</span><span class="n">NumWaterThermalTank</span><span class="p">))</span>
<a name="ln-5287"></a>    <span class="n">AlreadyRated</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5288"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5289"></a>    <span class="n">MyWarmupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5290"></a>    <span class="n">InitWaterThermalTanksOnce</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5291"></a>    <span class="n">SetLoopIndexFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5292"></a>    <span class="n">MySizingDoneFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5293"></a>  <span class="k">END IF</span>
<a name="ln-5294"></a>
<a name="ln-5295"></a><span class="k">  </span><span class="n">UseInletNode</span>     <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span>
<a name="ln-5296"></a>  <span class="n">UseOutletNode</span>    <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletNode</span>
<a name="ln-5297"></a>  <span class="n">SourceInletNode</span>  <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span>
<a name="ln-5298"></a>  <span class="n">SourceOutletNode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span>
<a name="ln-5299"></a>
<a name="ln-5300"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SetLoopIndexFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-5301"></a>
<a name="ln-5302"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-5303"></a><span class="k">      </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5304"></a>      <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5305"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5306"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5307"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5308"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5309"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5310"></a>                                   <span class="n">InletNodeNumber</span> <span class="o">=</span> <span class="n">UseInletNode</span><span class="p">,</span>                              <span class="p">&amp;</span>
<a name="ln-5311"></a>                                   <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-5312"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5313"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-5314"></a>      <span class="n">ENDIF</span>
<a name="ln-5315"></a>      <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5316"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5317"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5318"></a>                                 <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-5319"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5320"></a>                             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5321"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mass</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5322"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantSizNum</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5323"></a>                      <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">PlantSizNum</span>
<a name="ln-5324"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5325"></a>          <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantSizNum</span>   <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5326"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Did not find Sizing:Plant object for use side of plant thermal tank = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5327"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5328"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-5329"></a>      <span class="n">ENDIF</span>
<a name="ln-5330"></a>    <span class="n">ENDIF</span>
<a name="ln-5331"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>  <span class="k">THEN</span>
<a name="ln-5332"></a>      <span class="c">! this is a heat pump water heater, need a separate block because TypeOf_HeatPumpWtrHeater shows up on Branch</span>
<a name="ln-5333"></a>      <span class="c">!  (input should probably have been the associated tank )</span>
<a name="ln-5334"></a>      <span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5335"></a>      <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5336"></a>                                   <span class="n">TypeOf_HeatPumpWtrHeater</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5337"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5338"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5339"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5340"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5341"></a>                                   <span class="n">InletNodeNumber</span> <span class="o">=</span> <span class="n">UseInletNode</span><span class="p">,</span>                              <span class="p">&amp;</span>
<a name="ln-5342"></a>                                   <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-5343"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5344"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-5345"></a>      <span class="n">ENDIF</span>
<a name="ln-5346"></a>      <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5347"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5348"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5349"></a>                                 <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-5350"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5351"></a>                             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5352"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mass</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5353"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantSizNum</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5354"></a>                      <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">PlantSizNum</span>
<a name="ln-5355"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5356"></a>          <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantSizNum</span>   <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5357"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Did not find Sizing:Plant object for use side of plant thermal tank = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5358"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5359"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-5360"></a>      <span class="n">ENDIF</span>
<a name="ln-5361"></a>    <span class="n">ENDIF</span>
<a name="ln-5362"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5363"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5364"></a><span class="k">      </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5365"></a>      <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5366"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5367"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5368"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5369"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5370"></a>                                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5371"></a>                                   <span class="n">InletNodeNumber</span> <span class="o">=</span> <span class="n">SourceInletNode</span><span class="p">,</span>                              <span class="p">&amp;</span>
<a name="ln-5372"></a>                                   <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-5373"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5374"></a><span class="k">        CALL </span><span class="n">InterConnectTwoPlantLoopSides</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5375"></a>                                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5376"></a>                                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5377"></a>                                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5378"></a>                                            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">)</span>
<a name="ln-5379"></a>      <span class="n">ENDIF</span>
<a name="ln-5380"></a>
<a name="ln-5381"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5382"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-5383"></a>      <span class="n">ENDIF</span>
<a name="ln-5384"></a>      <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5385"></a>                               <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5386"></a>                               <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5387"></a>                               <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-5388"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5389"></a>                           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5390"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantSizNum</span>  <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5391"></a>                      <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">PlantSizNum</span>
<a name="ln-5392"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5393"></a>          <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantSizNum</span>   <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5394"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Did not find Sizing:Plant object for source side of plant thermal tank = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5395"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5396"></a>        <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-5397"></a>      <span class="n">ENDIF</span>
<a name="ln-5398"></a>    <span class="n">ENDIF</span>
<a name="ln-5399"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5400"></a>         <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5401"></a><span class="k">      </span><span class="n">SetLoopIndexFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5402"></a>    <span class="n">ENDIF</span>
<a name="ln-5403"></a>
<a name="ln-5404"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="n">SetLoopIndexFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5405"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">StandAlone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5406"></a><span class="k">      CALL </span><span class="n">SizeStandAloneWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-5407"></a>      <span class="n">SetLoopIndexFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5408"></a>    <span class="n">ENDIF</span>
<a name="ln-5409"></a>
<a name="ln-5410"></a>  <span class="n">ELSEIF</span><span class="p">(</span> <span class="n">SetLoopIndexFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyPlantInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5411"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">StandAlone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5412"></a><span class="k">      CALL </span><span class="n">SizeStandAloneWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-5413"></a>    <span class="n">ENDIF</span>
<a name="ln-5414"></a>
<a name="ln-5415"></a>    <span class="k">CALL </span><span class="n">CalcStandardRatings</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-5416"></a>    <span class="n">SetLoopIndexFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5417"></a>  <span class="n">ENDIF</span>
<a name="ln-5418"></a>
<a name="ln-5419"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">StandAlone</span>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AlreadyRated</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-5420"></a><span class="k">    CALL </span><span class="n">CalcStandardRatings</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-5421"></a>  <span class="n">ENDIF</span>
<a name="ln-5422"></a>
<a name="ln-5423"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SetLoopIndexFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5424"></a>
<a name="ln-5425"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MySizingDoneFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5426"></a><span class="c">!      IF (WaterThermalTank(WaterThermalTankNum)%UseSidePlantLoopNum &gt; 0 ) THEN</span>
<a name="ln-5427"></a><span class="c">!        WaterThermalTank(WaterThermalTankNum)%UseSidePlantSizNum  = &amp;</span>
<a name="ln-5428"></a><span class="c">!                      PlantLoop(WaterThermalTank(WaterThermalTankNum)%UseSidePlantLoopNum)%PlantSizNum</span>
<a name="ln-5429"></a><span class="c">!      ENDIF</span>
<a name="ln-5430"></a><span class="c">!      IF (WaterThermalTank(WaterThermalTankNum)%SourceSidePlantLoopNum &gt; 0) THEN</span>
<a name="ln-5431"></a><span class="c">!      WaterThermalTank(WaterThermalTankNum)%SourceSidePlantSizNum  = &amp;</span>
<a name="ln-5432"></a><span class="c">!                      PlantLoop(WaterThermalTank(WaterThermalTankNum)%SourceSidePlantLoopNum)%PlantSizNum</span>
<a name="ln-5433"></a><span class="c">!      ENDIF</span>
<a name="ln-5434"></a><span class="c">!   !   CALL MinePlantStructForInfo(WaterThermalTankNum)</span>
<a name="ln-5435"></a>      <span class="k">CALL </span><span class="n">SizeTankForDemandSide</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-5436"></a>      <span class="k">CALL </span><span class="n">SizeDemandSidePlantConnections</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-5437"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5438"></a><span class="k">        CALL </span><span class="n">SizeSupplySidePlantConnections</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span><span class="p">)</span>
<a name="ln-5439"></a>      <span class="k">ELSE</span>
<a name="ln-5440"></a><span class="k">        CALL </span><span class="n">SizeSupplySidePlantConnections</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-5441"></a>      <span class="n">ENDIF</span>
<a name="ln-5442"></a>
<a name="ln-5443"></a>      <span class="k">CALL </span><span class="n">SizeTankForSupplySide</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-5444"></a><span class="c">!</span>
<a name="ln-5445"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5446"></a>        <span class="c">! check to see if any autosize values left, depending on the nature of this tank</span>
<a name="ln-5447"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! this is heat pump water heater, source side not sized</span>
<a name="ln-5448"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5449"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5450"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>                  <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5451"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>             <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5452"></a><span class="k">              </span><span class="n">MySizingDoneFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5453"></a>            <span class="n">ENDIF</span>
<a name="ln-5454"></a>          <span class="k">ELSE</span>
<a name="ln-5455"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>                  <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5456"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>             <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5457"></a><span class="k">              </span><span class="n">MySizingDoneFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5458"></a>            <span class="n">ENDIF</span>
<a name="ln-5459"></a>          <span class="n">ENDIF</span>
<a name="ln-5460"></a>        <span class="k">ELSE</span> <span class="c">! not a heat pump water heater</span>
<a name="ln-5461"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5462"></a>              <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5463"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5464"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5465"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>                  <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5466"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>                  <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5467"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>             <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5468"></a><span class="k">              </span><span class="n">MySizingDoneFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5469"></a>            <span class="n">ENDIF</span>
<a name="ln-5470"></a>          <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5471"></a>                   <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5472"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5473"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>                  <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5474"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>                  <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5475"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>             <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5476"></a><span class="k">              </span><span class="n">MySizingDoneFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5477"></a>            <span class="n">ENDIF</span>
<a name="ln-5478"></a>          <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5479"></a>                  <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5480"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>                  <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5481"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>                  <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5482"></a>                 <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>             <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5483"></a><span class="k">              </span><span class="n">MySizingDoneFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5484"></a>            <span class="n">ENDIF</span>
<a name="ln-5485"></a>          <span class="n">ENDIF</span>
<a name="ln-5486"></a>        <span class="n">ENDIF</span>
<a name="ln-5487"></a>      <span class="n">ENDIF</span>
<a name="ln-5488"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">MySizingDoneFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5489"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5490"></a>           <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5491"></a><span class="k">          IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span>            <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>        <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5492"></a>               <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>                  <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5493"></a>               <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>             <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5494"></a><span class="k">              </span><span class="n">MySizingDoneFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5495"></a>          <span class="k">ELSE</span>
<a name="ln-5496"></a><span class="k">            RETURN</span>
<a name="ln-5497"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-5498"></a>        <span class="k">ELSE</span>
<a name="ln-5499"></a><span class="k">          RETURN</span>
<a name="ln-5500"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-5501"></a>      <span class="n">ENDIF</span>
<a name="ln-5502"></a>
<a name="ln-5503"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">ControlTypeCycle</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizingDoneFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5504"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-5505"></a>      <span class="n">ENDIF</span>
<a name="ln-5506"></a>
<a name="ln-5507"></a>      <span class="c">! check for sizing issues that model can not suppport</span>
<a name="ln-5508"></a>
<a name="ln-5509"></a>      <span class="c">! if stratified tank model, ensure that nominal change over rate is greater than one minute, avoid numerical problems.</span>
<a name="ln-5510"></a>
<a name="ln-5511"></a>      <span class="k">IF</span> <span class="p">(</span>    <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedWaterHeater</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-5512"></a>         <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedChilledWaterStorage</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5513"></a><span class="k">        </span><span class="n">MaxSideVolFlow</span>  <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5514"></a>                               <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-5515"></a>
<a name="ln-5516"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MaxSideVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! protect div by zero</span>
<a name="ln-5517"></a>          <span class="n">TankChangeRateScale</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">/</span> <span class="n">MaxSideVolFlow</span>
<a name="ln-5518"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">TankChangeRateScale</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! nominal change over in less than one minute</span>
<a name="ln-5519"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Detected problem for stratified tank model.  Model cannot be applied.&#39;</span><span class="p">)</span>
<a name="ln-5520"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for stratified tank name = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-5521"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Tank volume = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [m3]&#39;</span><span class="p">)</span>
<a name="ln-5522"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Tank use side volume flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5523"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [m3/s]&#39;</span> <span class="p">)</span>
<a name="ln-5524"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Tank source side volume flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5525"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [m3/s]&#39;</span> <span class="p">)</span>
<a name="ln-5526"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Nominal tank change over rate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TankChangeRateScale</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [s]&#39;</span><span class="p">)</span>
<a name="ln-5527"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Change over rate is too fast, increase tank volume, decrease connection flow rates&#39;</span> <span class="p">&amp;</span>
<a name="ln-5528"></a>                              <span class="o">//</span><span class="s1">&#39; or use mixed tank model&#39;</span><span class="p">)</span>
<a name="ln-5529"></a>
<a name="ln-5530"></a>            <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitWaterThermalTank: Simulation halted because of sizing problem in stratified tank model.&#39;</span><span class="p">)</span>
<a name="ln-5531"></a>          <span class="n">ENDIF</span>
<a name="ln-5532"></a>        <span class="n">ENDIF</span>
<a name="ln-5533"></a>      <span class="n">ENDIF</span>
<a name="ln-5534"></a>
<a name="ln-5535"></a>    <span class="n">ENDIF</span>
<a name="ln-5536"></a>
<a name="ln-5537"></a>
<a name="ln-5538"></a>    <span class="c">! Clear node initial conditions</span>
<a name="ln-5539"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UseOutletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5540"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">UseInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5541"></a>      <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5542"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5543"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5544"></a>                                 <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-5545"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMin</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolFlowRateMin</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5546"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5547"></a>                             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5548"></a>      <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMin</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5549"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5550"></a>                              <span class="n">UseInletNode</span><span class="p">,</span> <span class="n">UseOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5551"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5552"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5553"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5554"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantCompNum</span> <span class="p">)</span>
<a name="ln-5555"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5556"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5557"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedUseOutletTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5558"></a>
<a name="ln-5559"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mass</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5560"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseBranchControlType</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5561"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-5562"></a>                        <span class="n">LoopSide</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-5563"></a>                          <span class="n">Branch</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantBranchNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-5564"></a>                            <span class="n">Comp</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantCompNum</span> <span class="p">)%</span><span class="n">FlowCtrl</span>
<a name="ln-5565"></a>
<a name="ln-5566"></a>    <span class="k">END IF</span>
<a name="ln-5567"></a>
<a name="ln-5568"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5569"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5570"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5571"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5572"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5573"></a>                                 <span class="s1">&#39;GetWaterThermalTankInput&#39;</span><span class="p">)</span>
<a name="ln-5574"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5575"></a>                             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5576"></a>      <span class="k">CALL </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5577"></a>                              <span class="n">SourceInletNode</span><span class="p">,</span> <span class="n">SourceOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5578"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5579"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5580"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5581"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantCompNum</span> <span class="p">)</span>
<a name="ln-5582"></a>
<a name="ln-5583"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5584"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5585"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedSourceOutletTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5586"></a>
<a name="ln-5587"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceBranchControlType</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5588"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-5589"></a>                        <span class="n">LoopSide</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-5590"></a>                          <span class="n">Branch</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantBranchNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-5591"></a>                            <span class="n">Comp</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantCompNum</span> <span class="p">)%</span><span class="n">FlowCtrl</span>
<a name="ln-5592"></a>    <span class="k">END IF</span>
<a name="ln-5593"></a>
<a name="ln-5594"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5595"></a>         <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-5596"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">SourceInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5597"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5598"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5599"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedSourceOutletTemp</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5600"></a>      <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-5601"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5602"></a>                             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5603"></a>    <span class="n">ENDIF</span>
<a name="ln-5604"></a>
<a name="ln-5605"></a>    <span class="c">! Initialize tank temperature to setpoint of first hour of warm up period</span>
<a name="ln-5606"></a>    <span class="c">! (use HPWH or Desuperheater heating coil set point if applicable)</span>
<a name="ln-5607"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5608"></a><span class="k">      </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-5609"></a>      <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SaveMode</span>  <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-5610"></a>      <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SaveWHMode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-5611"></a>      <span class="n">SchIndex</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-5612"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5613"></a><span class="k">      </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-5614"></a>      <span class="n">SchIndex</span><span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-5615"></a>    <span class="k">ELSE</span>
<a name="ln-5616"></a><span class="k">      </span><span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-5617"></a>    <span class="k">END IF</span>
<a name="ln-5618"></a>
<a name="ln-5619"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SchIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5620"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchIndex</span><span class="p">)</span>
<a name="ln-5621"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5622"></a>
<a name="ln-5623"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5624"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5625"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">SavedTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5626"></a>      <span class="k">END IF</span>
<a name="ln-5627"></a><span class="k">    ELSE</span>
<a name="ln-5628"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0d0</span>
<a name="ln-5629"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5630"></a>
<a name="ln-5631"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5632"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5633"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">SavedTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5634"></a>      <span class="k">END IF</span>
<a name="ln-5635"></a><span class="k">    END IF</span>
<a name="ln-5636"></a><span class="k">    </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>      <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-5637"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedSourceOutletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-5638"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span>         <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-5639"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedUseOutletTemp</span>    <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-5640"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempAvg</span>           <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-5641"></a>
<a name="ln-5642"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn1</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5643"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn2</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5644"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span>           <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5645"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5646"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryDone</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5647"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryFuel</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5648"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UnmetEnergy</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5649"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">LossEnergy</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5650"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlueLossEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5651"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEnergy</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5652"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TotalDemandEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5653"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEnergy</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5654"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterEnergy</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5655"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterEnergy1</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5656"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterEnergy2</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5657"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelEnergy</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5658"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelEnergy1</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5659"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelEnergy2</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5660"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VentEnergy</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5661"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5662"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaEnergyToTank</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5663"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5664"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaEnergyToTank</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5665"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">NetHeatTransferEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-5666"></a>
<a name="ln-5667"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5668"></a>        <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">==</span>  <span class="n">Autosize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5669"></a><span class="k">      </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5670"></a>      <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5671"></a>    <span class="k">ELSE</span>
<a name="ln-5672"></a><span class="k">      </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5673"></a>      <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5674"></a>    <span class="n">ENDIF</span>
<a name="ln-5675"></a>  <span class="k">END IF</span>
<a name="ln-5676"></a>
<a name="ln-5677"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span>  <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5678"></a>
<a name="ln-5679"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-5680"></a>      <span class="c">! reInitialize tank temperature to setpoint of first hour (use HPWH or Desuperheater heating coil set point if applicable)</span>
<a name="ln-5681"></a>      <span class="c">! BG&#39;s interpetation here is that its better to reset initial condition to setpoint once warm up is over.</span>
<a name="ln-5682"></a>      <span class="c">! (otherwise with a dynamic storage model it is difficult for the user to see the initial performance if it isn&#39;t periodic.)</span>
<a name="ln-5683"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5684"></a><span class="k">      </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-5685"></a>      <span class="n">SchIndex</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-5686"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5687"></a><span class="k">      </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-5688"></a>      <span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-5689"></a>    <span class="k">ELSE</span>
<a name="ln-5690"></a><span class="k">      </span><span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-5691"></a>    <span class="k">END IF</span>
<a name="ln-5692"></a>
<a name="ln-5693"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SchIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5694"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchIndex</span><span class="p">)</span>
<a name="ln-5695"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5696"></a>
<a name="ln-5697"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5698"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5699"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">SavedTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5700"></a>      <span class="k">END IF</span>
<a name="ln-5701"></a><span class="k">    ELSE</span>
<a name="ln-5702"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0d0</span>
<a name="ln-5703"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5704"></a>
<a name="ln-5705"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5706"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5707"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">SavedTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-5708"></a>      <span class="k">END IF</span>
<a name="ln-5709"></a><span class="k">    END IF</span>
<a name="ln-5710"></a><span class="k">    </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>      <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-5711"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedSourceOutletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-5712"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span>         <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-5713"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedUseOutletTemp</span>    <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-5714"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn1</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5715"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn2</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5716"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span>           <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5717"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5718"></a>    <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5719"></a>
<a name="ln-5720"></a>
<a name="ln-5721"></a>  <span class="k">END IF</span>
<a name="ln-5722"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">WarmUpFlag</span><span class="p">)</span>  <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5723"></a>
<a name="ln-5724"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5725"></a>    <span class="c">! Get all scheduled values</span>
<a name="ln-5726"></a>    <span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span>
<a name="ln-5727"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchIndex</span><span class="p">)</span>
<a name="ln-5728"></a>
<a name="ln-5729"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5730"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">&gt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5731"></a>        <span class="c">! Setpoint temperature scheduled higher than maximum tank temperature limit</span>
<a name="ln-5732"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">-</span> <span class="mf">1.0d0</span>
<a name="ln-5733"></a>
<a name="ln-5734"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ShowSetpointWarning</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5735"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Water heater = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5736"></a>            <span class="s1">&#39;:  Water heater tank set point temperature is greater than the maximum tank temperature limit.&#39;</span><span class="p">)</span>
<a name="ln-5737"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Water heater tank set point temperature is reset to Tank Temperature&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5738"></a>                                 <span class="s1">&#39; Limit minus 1 C (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5739"></a>                                 <span class="s1">&#39;) and simulation continues. &#39;</span><span class="p">)</span>
<a name="ln-5740"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ShowSetpointWarning</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5741"></a>        <span class="k">END IF</span>
<a name="ln-5742"></a>
<a name="ln-5743"></a><span class="k">      END IF</span>
<a name="ln-5744"></a><span class="k">    ELSE</span>
<a name="ln-5745"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">&lt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5746"></a>        <span class="c">! Setpoint temperature scheduled lower than minimum tank temperature limit</span>
<a name="ln-5747"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">+</span> <span class="mf">1.0d0</span>
<a name="ln-5748"></a>
<a name="ln-5749"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ShowSetpointWarning</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5750"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Chilled Water Tank = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5751"></a>            <span class="s1">&#39;:  Water heater tank set point temperature is lower than the minimum tank temperature limit.&#39;</span><span class="p">)</span>
<a name="ln-5752"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Chilled water tank set point temperature is reset to Tank Temperature&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5753"></a>                                 <span class="s1">&#39; Limit plus 1 C (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5754"></a>                                 <span class="s1">&#39;) and simulation continues. &#39;</span><span class="p">)</span>
<a name="ln-5755"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ShowSetpointWarning</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5756"></a>        <span class="k">END IF</span>
<a name="ln-5757"></a>
<a name="ln-5758"></a><span class="k">      END IF</span>
<a name="ln-5759"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-5760"></a>
<a name="ln-5761"></a>    <span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule2</span>
<a name="ln-5762"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SchIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5763"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp2</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchIndex</span><span class="p">)</span>
<a name="ln-5764"></a>    <span class="k">END IF</span>
<a name="ln-5765"></a>
<a name="ln-5766"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempIndicator</span><span class="p">)</span>
<a name="ln-5767"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AmbientTempSchedule</span><span class="p">)</span>
<a name="ln-5768"></a>        <span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span>
<a name="ln-5769"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchIndex</span><span class="p">)</span>
<a name="ln-5770"></a>
<a name="ln-5771"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AmbientTempZone</span><span class="p">)</span>
<a name="ln-5772"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">)</span>
<a name="ln-5773"></a>
<a name="ln-5774"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AmbientTempOutsideAir</span><span class="p">)</span>
<a name="ln-5775"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5776"></a>           <span class="n">Node</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempOutsideAirNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5777"></a>
<a name="ln-5778"></a>    <span class="k">END SELECT</span>
<a name="ln-5779"></a>
<a name="ln-5780"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UseInletNode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Stand-alone operation</span>
<a name="ln-5781"></a>
<a name="ln-5782"></a>      <span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTempSchedule</span>
<a name="ln-5783"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SchIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5784"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchIndex</span><span class="p">)</span>
<a name="ln-5785"></a>      <span class="k">ELSE</span>
<a name="ln-5786"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span> <span class="o">=</span> <span class="n">WaterMainsTemp</span>
<a name="ln-5787"></a>      <span class="k">END IF</span>
<a name="ln-5788"></a>
<a name="ln-5789"></a><span class="k">      </span><span class="n">SchIndex</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span>
<a name="ln-5790"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SchIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5791"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchIndex</span><span class="p">)</span><span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-5792"></a>                               <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-5793"></a>
<a name="ln-5794"></a>
<a name="ln-5795"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolFlowRate</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5796"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">/</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">InitConvTemp</span><span class="p">)</span>
<a name="ln-5797"></a>      <span class="k">ELSE</span>
<a name="ln-5798"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5799"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-5800"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolFlowRate</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-5801"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">/</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">InitConvTemp</span><span class="p">)</span>
<a name="ln-5802"></a>      <span class="k">END IF</span>
<a name="ln-5803"></a>
<a name="ln-5804"></a><span class="k">    END IF</span>
<a name="ln-5805"></a>
<a name="ln-5806"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5807"></a><span class="k">      </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5808"></a>          <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span><span class="p">)</span>
<a name="ln-5809"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5810"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5811"></a>        <span class="c">! HP setpoint temperature scheduled equal to or higher than tank temperature limit</span>
<a name="ln-5812"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5813"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span> <span class="o">-</span> <span class="mf">1.0d0</span>
<a name="ln-5814"></a>
<a name="ln-5815"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">ShowSetpointWarning</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5816"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Heat Pump Water Heater = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5817"></a>                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5818"></a>            <span class="s1">&#39;:  Heat Pump water heater set point temperature is equal to or greater than the maximum tank temperature limit.&#39;</span><span class="p">)</span>
<a name="ln-5819"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; Heat Pump water heater tank set point temperature is reset to Tank Temperature&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5820"></a>              <span class="s1">&#39; Limit minus 1 C (&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5821"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">SetpointTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5822"></a>              <span class="s1">&#39;) and simulation continues. &#39;</span><span class="p">)</span>
<a name="ln-5823"></a>          <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">ShowSetpointWarning</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5824"></a>        <span class="k">END IF</span>
<a name="ln-5825"></a>
<a name="ln-5826"></a><span class="k">      END IF</span>
<a name="ln-5827"></a><span class="k">    END IF</span>
<a name="ln-5828"></a>
<a name="ln-5829"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5830"></a><span class="k">      </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5831"></a>          <span class="n">GetCurrentScheduleValue</span><span class="p">(</span>  <span class="p">&amp;</span>
<a name="ln-5832"></a>             <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetpointTempSchedule</span><span class="p">)</span>
<a name="ln-5833"></a>    <span class="k">END IF</span>
<a name="ln-5834"></a>
<a name="ln-5835"></a>
<a name="ln-5836"></a><span class="k">  </span><span class="n">ENDIF</span> <span class="c">! first HVAC Iteration</span>
<a name="ln-5837"></a>
<a name="ln-5838"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SetLoopIndexFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! setup mass flows for plant connections</span>
<a name="ln-5839"></a>
<a name="ln-5840"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5841"></a><span class="k">      </span><span class="n">DeadBandTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span>
<a name="ln-5842"></a>    <span class="k">ELSE</span>
<a name="ln-5843"></a><span class="k">      </span><span class="n">DeadBandTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span>
<a name="ln-5844"></a>    <span class="n">ENDIF</span>
<a name="ln-5845"></a>
<a name="ln-5846"></a>    <span class="n">mdotUse</span> <span class="o">=</span> <span class="n">PlantMassFlowRatesFunc</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">UseInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5847"></a>                                        <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">UseSide</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-5848"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5849"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideSeries</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-5850"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseBranchControlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5851"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedUseOutletTemp</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5852"></a>                                        <span class="n">DeadBandTemp</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span><span class="p">)</span>
<a name="ln-5853"></a>    <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdotUse</span><span class="p">,</span> <span class="n">UseInletNode</span><span class="p">,</span> <span class="n">UseOutletNode</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-5854"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5855"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5856"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5857"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantCompNum</span><span class="p">)</span>
<a name="ln-5858"></a>
<a name="ln-5859"></a>
<a name="ln-5860"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UseInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5861"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="n">mdotUse</span>
<a name="ln-5862"></a>
<a name="ln-5863"></a>
<a name="ln-5864"></a>  <span class="n">ENDIF</span>
<a name="ln-5865"></a>
<a name="ln-5866"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SetLoopIndexFlag</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! setup mass flows for plant connections</span>
<a name="ln-5867"></a>
<a name="ln-5868"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5869"></a><span class="k">      </span><span class="n">DeadBandTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span>
<a name="ln-5870"></a>    <span class="k">ELSE</span>
<a name="ln-5871"></a><span class="k">      </span><span class="n">DeadBandTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span>
<a name="ln-5872"></a>    <span class="n">ENDIF</span>
<a name="ln-5873"></a>
<a name="ln-5874"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedChilledWaterStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5875"></a><span class="k">      </span><span class="n">tmpNodeNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode1</span>
<a name="ln-5876"></a>      <span class="n">sensedTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">tmpNodeNum</span><span class="p">)%</span><span class="n">SavedTemp</span>
<a name="ln-5877"></a>    <span class="k">ELSE</span>
<a name="ln-5878"></a><span class="k">      </span><span class="n">sensedTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedSourceOutletTemp</span>
<a name="ln-5879"></a>    <span class="n">ENDIF</span>
<a name="ln-5880"></a>
<a name="ln-5881"></a>    <span class="n">mdotSource</span> <span class="o">=</span> <span class="n">PlantMassFlowRatesFunc</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">SourceInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5882"></a>                                           <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SourceSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5883"></a>                                           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5884"></a>                                           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideSeries</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5885"></a>                                           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceBranchControlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5886"></a>                                           <span class="n">sensedTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5887"></a>                                           <span class="n">DeadBandTemp</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span><span class="p">)</span>
<a name="ln-5888"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5889"></a><span class="k">      CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdotSource</span><span class="p">,</span> <span class="n">SourceInletNode</span><span class="p">,</span> <span class="n">SourceOutletNode</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-5890"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5891"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5892"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5893"></a>                                        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantCompNum</span><span class="p">)</span>
<a name="ln-5894"></a>    <span class="k">ELSE</span> <span class="c">!not really plant connected (desuperheater or heat pump)</span>
<a name="ln-5895"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">SourceInletNode</span><span class="p">)%</span><span class="n">MassFLowRate</span>  <span class="o">=</span> <span class="n">mdotSource</span>
<a name="ln-5896"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">SourceOutletNode</span><span class="p">)%</span><span class="n">MassFLowRate</span> <span class="o">=</span> <span class="n">mdotSource</span>
<a name="ln-5897"></a>
<a name="ln-5898"></a>    <span class="n">ENDIF</span>
<a name="ln-5899"></a>
<a name="ln-5900"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5901"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">mdotSource</span>
<a name="ln-5902"></a>
<a name="ln-5903"></a>  <span class="n">ENDIF</span>
<a name="ln-5904"></a><span class="c">!</span>
<a name="ln-5905"></a>
<a name="ln-5906"></a><span class="c">! initialize HPWHs each iteration</span>
<a name="ln-5907"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5908"></a>
<a name="ln-5909"></a><span class="k">    </span><span class="n">HPNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span>
<a name="ln-5910"></a>
<a name="ln-5911"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MyHPSizeFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5912"></a><span class="c">!     autosize info must be calculated in GetWaterThermalTankInputFlag for use in StandardRating procedure</span>
<a name="ln-5913"></a><span class="c">!       (called at end of GetWaterThermalTankInputFlag)</span>
<a name="ln-5914"></a><span class="c">!     report autosizing information here (must be done after GetWaterThermalTankInputFlag is complete)</span>
<a name="ln-5915"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WaterFlowRateAutosized</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5916"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5917"></a>            <span class="s1">&#39;Condenser water flow rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span><span class="p">)</span>
<a name="ln-5918"></a>      <span class="k">END IF</span>
<a name="ln-5919"></a><span class="k">      IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AirFlowRateAutosized</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5920"></a><span class="k">        CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5921"></a>            <span class="s1">&#39;Evaporator air flow rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OperatingAirFlowRate</span><span class="p">)</span>
<a name="ln-5922"></a>      <span class="k">END IF</span>
<a name="ln-5923"></a><span class="k">      </span><span class="n">MyHPSizeFlag</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5924"></a>    <span class="k">END IF</span>
<a name="ln-5925"></a>
<a name="ln-5926"></a><span class="k">    </span><span class="n">HPAirInletNode</span>          <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span>
<a name="ln-5927"></a>    <span class="n">HPAirOutletNode</span>         <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPumpAirOutletNode</span>
<a name="ln-5928"></a>    <span class="n">OutdoorAirNode</span>          <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span>
<a name="ln-5929"></a>    <span class="n">ExhaustAirNode</span>          <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">ExhaustAirNode</span>
<a name="ln-5930"></a>    <span class="n">HPWaterInletNode</span>        <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CondWaterInletNode</span>
<a name="ln-5931"></a>    <span class="n">HPWaterOutletNode</span>       <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CondWaterOutletNode</span>
<a name="ln-5932"></a>    <span class="n">InletAirMixerNode</span>       <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span>
<a name="ln-5933"></a>    <span class="n">OutletAirSplitterNode</span>   <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirSplitterNode</span>
<a name="ln-5934"></a>
<a name="ln-5935"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CrankcaseTempIndicator</span><span class="p">)</span>
<a name="ln-5936"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankcaseTempZone</span><span class="p">)</span>
<a name="ln-5937"></a>        <span class="n">HPWHCrankcaseDBTemp</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span><span class="p">)</span>
<a name="ln-5938"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankcaseTempExterior</span><span class="p">)</span>
<a name="ln-5939"></a>        <span class="n">HPWHCrankcaseDBTemp</span> <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-5940"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">CrankcaseTempSchedule</span><span class="p">)</span>
<a name="ln-5941"></a>        <span class="n">HPWHCrankcaseDBTemp</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CrankcaseTempSchedule</span><span class="p">)</span>
<a name="ln-5942"></a>    <span class="k">END SELECT</span>
<a name="ln-5943"></a>
<a name="ln-5944"></a><span class="c">!   initialize HPWH report variables to 0 and set tank inlet node equal to outlet node</span>
<a name="ln-5945"></a>    <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPWaterHeaterSensibleCapacity</span>                  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5946"></a>    <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPWaterHeaterLatentCapacity</span>                    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5947"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5948"></a>    <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatingPLR</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5949"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>    <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-5950"></a>
<a name="ln-5951"></a><span class="c">!   determine HPWH inlet air conditions based on inlet air configuration (Zone, ZoneAndOA, OutdoorAir, or Schedule)</span>
<a name="ln-5952"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span><span class="p">)</span>
<a name="ln-5953"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AmbientTempZone</span><span class="p">)</span>
<a name="ln-5954"></a>          <span class="n">MixerInletAirSchedule</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5955"></a>          <span class="n">HPInletDryBulbTemp</span>          <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5956"></a>          <span class="n">HPInletHumRat</span>               <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-5957"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AmbientTempZoneandOA</span><span class="p">)</span>
<a name="ln-5958"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerSchPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5959"></a><span class="c">!         schedule values are checked for boundary of 0 and 1 in GetWaterThermalTankInputFlag</span>
<a name="ln-5960"></a>          <span class="n">MixerInletAirSchedule</span>       <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerSchPtr</span><span class="p">)</span>
<a name="ln-5961"></a>        <span class="k">ELSE</span>
<a name="ln-5962"></a><span class="k">          </span><span class="n">MixerInletAirSchedule</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5963"></a>        <span class="k">END IF</span>
<a name="ln-5964"></a><span class="k">        </span><span class="n">HPInletDryBulbTemp</span>            <span class="o">=</span> <span class="n">MixerInletAirSchedule</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5965"></a>                                        <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">MixerInletAirSchedule</span><span class="p">)</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5966"></a>        <span class="n">HPInletHumRat</span>                 <span class="o">=</span> <span class="n">MixerInletAirSchedule</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">Humrat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5967"></a>                                        <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">MixerInletAirSchedule</span><span class="p">)</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-5968"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AmbientTempOutsideAir</span><span class="p">)</span>
<a name="ln-5969"></a>        <span class="n">MixerInletAirSchedule</span>         <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5970"></a>        <span class="n">HPInletDryBulbTemp</span>            <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5971"></a>        <span class="n">HPInletHumRat</span>                 <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">Humrat</span>
<a name="ln-5972"></a>
<a name="ln-5973"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">AmbientTempSchedule</span><span class="p">)</span>
<a name="ln-5974"></a>        <span class="n">HPInletDryBulbTemp</span>            <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AmbientTempSchedule</span><span class="p">)</span>
<a name="ln-5975"></a>        <span class="n">HPInletRelHum</span>                 <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AmbientRHSchedule</span><span class="p">)</span>
<a name="ln-5976"></a>        <span class="n">HPInletHumRat</span>                 <span class="o">=</span> <span class="n">PsyWFnTdbRhPb</span><span class="p">(</span><span class="n">HPInletDryBulbTemp</span><span class="p">,</span><span class="n">HPInletRelHum</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;InitWaterThermalTank&#39;</span><span class="p">)</span>
<a name="ln-5977"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">Temp</span>     <span class="o">=</span> <span class="n">HPInletDryBulbTemp</span>
<a name="ln-5978"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">HumRat</span>   <span class="o">=</span> <span class="n">HPInletHumRat</span>
<a name="ln-5979"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">HPInletDryBulbTemp</span><span class="p">,</span><span class="n">HPInletHumRat</span><span class="p">)</span>
<a name="ln-5980"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">Press</span>    <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-5981"></a>
<a name="ln-5982"></a>    <span class="k">END SELECT</span>
<a name="ln-5983"></a>
<a name="ln-5984"></a><span class="k">    </span><span class="n">MdotAir</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OperatingAirFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5985"></a>              <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">HPInletDryBulbTemp</span><span class="p">,</span> <span class="n">HPInletHumRat</span><span class="p">)</span>
<a name="ln-5986"></a>
<a name="ln-5987"></a><span class="c">!   set up initial conditions on nodes</span>
<a name="ln-5988"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">InletAirMixerNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5989"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5990"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>      <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-5991"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-5992"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">Temp</span>                 <span class="o">=</span> <span class="n">HPInletDryBulbTemp</span>
<a name="ln-5993"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">HumRat</span>               <span class="o">=</span> <span class="n">HPInletHumRat</span>
<a name="ln-5994"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">Enthalpy</span>             <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">HPInletDryBulbTemp</span><span class="p">,</span><span class="n">HPInletHumRat</span><span class="p">)</span>
<a name="ln-5995"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5996"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5997"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5998"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">ExhaustAirNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5999"></a>    <span class="k">ELSE</span>
<a name="ln-6000"></a><span class="k">      IF</span><span class="p">(</span><span class="n">OutdoorAirNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6001"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6002"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>       <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-6003"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>  <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-6004"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6005"></a>      <span class="k">ELSE</span>
<a name="ln-6006"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6007"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>       <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-6008"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>  <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-6009"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">ExhaustAirNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6010"></a>      <span class="k">END IF</span>
<a name="ln-6011"></a><span class="k">    END IF</span>
<a name="ln-6012"></a>
<a name="ln-6013"></a><span class="k">    IF</span><span class="p">(</span><span class="n">OutletAirSplitterNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletAirSplitterNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6014"></a>    <span class="c">!these are water nodes are not managed by plant. the HP connects</span>
<a name="ln-6015"></a>    <span class="c">! directly to the WH without using plant. will not change this code for DSU because of this</span>
<a name="ln-6016"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6017"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6018"></a>
<a name="ln-6019"></a><span class="c">!   set the max mass flow rate for outdoor fans</span>
<a name="ln-6020"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-6021"></a>
<a name="ln-6022"></a><span class="c">!   Curve objects in CalcHPWHDXCoil will use inlet conditions to HPWH not inlet air conditions to DX Coil</span>
<a name="ln-6023"></a><span class="c">!   HPWHInletDBTemp and HPWHInletWBTemp are DataHVACGlobals to pass info to HPWHDXCoil</span>
<a name="ln-6024"></a>    <span class="n">HPWHInletDBTemp</span>   <span class="o">=</span> <span class="n">HPInletDryBulbTemp</span>
<a name="ln-6025"></a>    <span class="n">HPWHInletWBTemp</span>   <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">HPWHInletDBTemp</span><span class="p">,</span><span class="n">HPInletHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-6026"></a>
<a name="ln-6027"></a>  <span class="k">END IF</span> <span class="c">!  IF(WaterThermalTank(WaterThermalTankNum)%HeatPumpNum .GT. 0)THEN</span>
<a name="ln-6028"></a>
<a name="ln-6029"></a>  <span class="k">RETURN</span>
<a name="ln-6030"></a>
<a name="ln-6031"></a><span class="k">END SUBROUTINE </span><span class="n">InitWaterThermalTank</span>
<a name="ln-6032"></a>
<a name="ln-6033"></a>
<a name="ln-6034"></a><span class="k">SUBROUTINE </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-6035"></a>
<a name="ln-6036"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6037"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-6038"></a>          <span class="c">!       DATE WRITTEN   January 2005</span>
<a name="ln-6039"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6040"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6041"></a>
<a name="ln-6042"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6043"></a>          <span class="c">! Simulates a well-mixed, single node water heater tank.</span>
<a name="ln-6044"></a>
<a name="ln-6045"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6046"></a>          <span class="c">! This model uses analytical calculations based on the differential equation describing the tank energy</span>
<a name="ln-6047"></a>          <span class="c">! balance.  The model operates in three different modes:  heating, floating, and venting.  Temperatures and</span>
<a name="ln-6048"></a>          <span class="c">! energies change dynamically over the timestep.  The final reported tank temperature is the average over</span>
<a name="ln-6049"></a>          <span class="c">! the timestep.  The final reported heat rates are averages based on the total energy transfer over the</span>
<a name="ln-6050"></a>          <span class="c">! timestep.</span>
<a name="ln-6051"></a>
<a name="ln-6052"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6053"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-6054"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStep</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">HourOfDay</span>
<a name="ln-6055"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowContinueErrorTimeStamp</span><span class="p">,</span> <span class="n">ShowWarningMessage</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6056"></a>                             <span class="n">ShowRecurringWarningErrorAtEnd</span>
<a name="ln-6057"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-6058"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-6059"></a>
<a name="ln-6060"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6061"></a>
<a name="ln-6062"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6063"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>      <span class="c">! Water Heater being simulated</span>
<a name="ln-6064"></a>
<a name="ln-6065"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6066"></a>          <span class="c">! na</span>
<a name="ln-6067"></a>
<a name="ln-6068"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6069"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TimeElapsed</span>         <span class="c">! Fraction of the current hour that has elapsed (h)</span>
<a name="ln-6070"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SetpointTemp</span>        <span class="c">! Current setpoint temperature (C)</span>
<a name="ln-6071"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DeadBandTemp</span>        <span class="c">! Heating: Minimum tank temperature (SetpointTemp - DeadbandDeltaTemp) (C)</span>
<a name="ln-6072"></a>                                             <span class="c">! Cooling: Maximum Tank temperature (SetpointTemp + DeadbandDeltaTemp) (C)</span>
<a name="ln-6073"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MaxTemp</span>             <span class="c">! Maximum tank temperature before venting (C)</span>
<a name="ln-6074"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AmbientTemp</span>         <span class="c">! Current ambient air temperature around tank (C)</span>
<a name="ln-6075"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankMass</span>            <span class="c">! Mass of water in tank (kg)</span>
<a name="ln-6076"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LossCoeff</span>           <span class="c">! Loss coefficient to ambient environment (W/K)</span>
<a name="ln-6077"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LossFracToZone</span>      <span class="c">! Fraction of losses added to the zone as a gain</span>
<a name="ln-6078"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankTemp</span>            <span class="c">! Instantaneous tank temperature (C)</span>
<a name="ln-6079"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NewTankTemp</span>         <span class="c">! Predicted new tank temperature (C)</span>
<a name="ln-6080"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankTempAvg</span>         <span class="c">! Average tank temperature over the timestep (C)</span>
<a name="ln-6081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Cp</span>                  <span class="c">! Specific heat of water (J/kg K)</span>
<a name="ln-6082"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Quse</span>                <span class="c">! Heating rate due to use side mass flow (W)</span>
<a name="ln-6083"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qsource</span>             <span class="c">! Heating rate due to source side mass flow (W)</span>
<a name="ln-6084"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qloss</span>               <span class="c">! Heating rate due to ambient environment (W)</span>
<a name="ln-6085"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qlosszone</span>           <span class="c">! Heating rate of fraction of losses added to the zone as a gain (W)</span>
<a name="ln-6086"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qheat</span>               <span class="c">! Net heating rate for non-temp dependent sources, i.e. heater and parasitics (W)</span>
<a name="ln-6087"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qheater</span>             <span class="c">! Heating rate of the burner or electric heating element (W)</span>
<a name="ln-6088"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qmaxcap</span>             <span class="c">! Maximum capacity heating rate of the burner or electric heating element (W)</span>
<a name="ln-6089"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qmincap</span>             <span class="c">! Minimum capacity heating rate of the burner or electric heating element (W)</span>
<a name="ln-6090"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qoffcycfuel</span>         <span class="c">! Fuel consumption rate of off-cycle parasitics (W)</span>
<a name="ln-6091"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qoffcycheat</span>         <span class="c">! Heating rate of fraction of off-cycle parasitics added to the tank (W)</span>
<a name="ln-6092"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qoncycfuel</span>          <span class="c">! Fuel consumption rate on-cycle parasitics added to the tank (W)</span>
<a name="ln-6093"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qoncycheat</span>          <span class="c">! Heating rate of fraction of on-cycle parasitics added to the tank (W)</span>
<a name="ln-6094"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qneeded</span>             <span class="c">! Heating rate needed to recover or maintain the setpoint temperature (W)</span>
<a name="ln-6095"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qunmet</span>              <span class="c">! The difference between Qneeded and Qheater (W)</span>
<a name="ln-6096"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qvent</span>               <span class="c">! Heating rate due to venting because tank exceeded max temperature limit (W)</span>
<a name="ln-6097"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qnet</span>                <span class="c">! Net heat transfer rate including everything (W)</span>
<a name="ln-6098"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qfuel</span>               <span class="c">! Heating rate for fuel consumed (W)</span>
<a name="ln-6099"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UseInletTemp</span>        <span class="c">! Use side inlet temperature (C)</span>
<a name="ln-6100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UseMassFlowRate</span>     <span class="c">! Use side flow rate, including effectiveness factor (kg/s)</span>
<a name="ln-6101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MinMassFlowRate</span>     <span class="c">! Minimum use side flow rate required before heater is enabled (kg/s)</span>
<a name="ln-6102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SourceInletTemp</span>     <span class="c">! Source side inlet temperature (C)</span>
<a name="ln-6103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SourceMassFlowRate</span>  <span class="c">! Source side flow rate, including effectiveness factor (kg/s)</span>
<a name="ln-6104"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">Mode</span>                <span class="c">! Indicator for current operating mode (HeatMode=1 | FloatMode=0 | VentMode=-1)</span>
<a name="ln-6105"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SecInTimeStep</span>       <span class="c">! Seconds in one timestep (s)</span>
<a name="ln-6106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TimeRemaining</span>       <span class="c">! Time remaining in the current timestep (s)</span>
<a name="ln-6107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TimeNeeded</span>          <span class="c">! Time needed to reach the next substep (s)</span>
<a name="ln-6108"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">CycleOnCount</span>        <span class="c">! Number of times heater cycles on in the current time step</span>
<a name="ln-6109"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">MaxCycles</span>           <span class="c">! Maximum number of cycles allowed before exiting loop</span>
<a name="ln-6110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Runtime</span>             <span class="c">! Time that heater is running (s)</span>
<a name="ln-6111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RTF</span>                 <span class="c">! Runtime fraction, fraction of timestep that heater is running</span>
<a name="ln-6112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PLR</span>                 <span class="c">! Part load ratio, fraction of maximum heater capacity</span>
<a name="ln-6113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PLRsum</span>              <span class="c">! Integrated part load ratio over the timestep (J)</span>
<a name="ln-6114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PLF</span>                 <span class="c">! Part load factor, modifies thermal efficiency to get total energy efficiency</span>
<a name="ln-6115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Tsum</span>                <span class="c">! Integrated tank temp over the timestep, dividing by time gives the average (C s)</span>
<a name="ln-6116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">deltaTsum</span>           <span class="c">! Change in integrated tank temperature, dividing by time gives the average (C s)</span>
<a name="ln-6117"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eloss</span>               <span class="c">! Energy change due to ambient losses over the timestep (J)</span>
<a name="ln-6118"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Elosszone</span>           <span class="c">! Energy change to the zone due to ambient losses over the timestep (J)</span>
<a name="ln-6119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Euse</span>                <span class="c">! Energy change due to use side mass flow over the timestep (J)</span>
<a name="ln-6120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Esource</span>             <span class="c">! Energy change due to source side mass flow over the timestep (J)</span>
<a name="ln-6121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eheater</span>             <span class="c">! Energy change due to the heater over the timestep (J)</span>
<a name="ln-6122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eoncycfuel</span>          <span class="c">! Fuel energy consumed by on-cycle parasitics over the timestep (J)</span>
<a name="ln-6123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eoffcycfuel</span>         <span class="c">! Fuel energy consumed by off-cycle parasitics over the timestep (J)</span>
<a name="ln-6124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Event</span>               <span class="c">! Energy change due to venting over the timestep (J)</span>
<a name="ln-6125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eneeded</span>             <span class="c">! Energy change needed over the timestep (J)</span>
<a name="ln-6126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eunmet</span>              <span class="c">! Energy change unmet over the timestep (J)</span>
<a name="ln-6127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Efuel</span>               <span class="c">! Energy change for fuel consumed over the timestep (J)</span>
<a name="ln-6128"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">SetpointRecovered</span>   <span class="c">! Flag to indicate when setpoint is recovered for the first time</span>
<a name="ln-6129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-6130"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6131"></a>
<a name="ln-6132"></a>          <span class="c">! FLOW:</span>
<a name="ln-6133"></a>  <span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">HourOfDay</span> <span class="o">+</span> <span class="n">TimeStep</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-6134"></a>
<a name="ln-6135"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">/=</span> <span class="n">TimeElapsed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6136"></a>    <span class="c">! The simulation has advanced to the next system timestep.  Save conditions from the end of the previous system</span>
<a name="ln-6137"></a>    <span class="c">! timestep for use as the initial conditions of each iteration that does not advance the system timestep.</span>
<a name="ln-6138"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-6139"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span>
<a name="ln-6140"></a>
<a name="ln-6141"></a>    <span class="c">! Save outlet temperatures for demand-side flow control</span>
<a name="ln-6142"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedUseOutletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span>
<a name="ln-6143"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedSourceOutletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-6144"></a>
<a name="ln-6145"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">TimeElapsed</span>
<a name="ln-6146"></a>  <span class="k">END IF</span>
<a name="ln-6147"></a>
<a name="ln-6148"></a><span class="k">  </span><span class="n">TankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-6149"></a>  <span class="n">Mode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span>
<a name="ln-6150"></a>
<a name="ln-6151"></a>  <span class="n">Qmaxcap</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-6152"></a>  <span class="n">Qmincap</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span>
<a name="ln-6153"></a>  <span class="n">Qoffcycfuel</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span>
<a name="ln-6154"></a>  <span class="n">Qoffcycheat</span> <span class="o">=</span> <span class="n">Qoffcycfuel</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span>
<a name="ln-6155"></a>  <span class="n">Qoncycfuel</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>
<a name="ln-6156"></a>  <span class="n">Qoncycheat</span> <span class="o">=</span> <span class="n">Qoncycfuel</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span>
<a name="ln-6157"></a>
<a name="ln-6158"></a>  <span class="n">SetpointTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span>
<a name="ln-6159"></a>  <span class="n">DeadBandTemp</span> <span class="o">=</span> <span class="n">SetpointTemp</span> <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span>
<a name="ln-6160"></a>  <span class="n">MaxTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span>
<a name="ln-6161"></a>  <span class="n">AmbientTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span>
<a name="ln-6162"></a>
<a name="ln-6163"></a>  <span class="n">UseInletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span>
<a name="ln-6164"></a>  <span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-6165"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span>
<a name="ln-6166"></a>  <span class="n">MinMassFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>
<a name="ln-6167"></a>  <span class="n">SourceInletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>
<a name="ln-6168"></a>  <span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-6169"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span>
<a name="ln-6170"></a>
<a name="ln-6171"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6172"></a><span class="k">    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6173"></a>                         <span class="n">TankTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6174"></a>                         <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6175"></a>                         <span class="s1">&#39;CalcWaterThermalTankMixed&#39;</span><span class="p">)</span>
<a name="ln-6176"></a>  <span class="k">ELSE</span>
<a name="ln-6177"></a><span class="k">    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">TankTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;CalcWaterThermalTankMixed&#39;</span><span class="p">)</span>
<a name="ln-6178"></a>  <span class="n">ENDIF</span>
<a name="ln-6179"></a>
<a name="ln-6180"></a>  <span class="n">TankMass</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>
<a name="ln-6181"></a>
<a name="ln-6182"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6183"></a><span class="k">    </span><span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6184"></a>                         <span class="n">TankTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6185"></a>                         <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6186"></a>                         <span class="s1">&#39;CalcWaterThermalTankMixed&#39;</span><span class="p">)</span>
<a name="ln-6187"></a>  <span class="k">ELSE</span>
<a name="ln-6188"></a><span class="k">    </span><span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">TankTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;CalcWaterThermalTankMixed&#39;</span><span class="p">)</span>
<a name="ln-6189"></a>  <span class="n">ENDIF</span>
<a name="ln-6190"></a>
<a name="ln-6191"></a>  <span class="n">SecInTimeStep</span> <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-6192"></a>  <span class="n">TimeRemaining</span> <span class="o">=</span> <span class="n">SecInTimeStep</span>
<a name="ln-6193"></a>  <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6194"></a>  <span class="n">CycleOnCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-6195"></a>  <span class="n">MaxCycles</span> <span class="o">=</span> <span class="n">SecInTimeStep</span>
<a name="ln-6196"></a>  <span class="n">Runtime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6197"></a>  <span class="n">SetpointRecovered</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6198"></a>
<a name="ln-6199"></a>  <span class="n">Tsum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6200"></a>  <span class="n">Eloss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6201"></a>  <span class="n">Elosszone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6202"></a>  <span class="n">Euse</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6203"></a>  <span class="n">Esource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6204"></a>  <span class="n">Eheater</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6205"></a>  <span class="n">Event</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6206"></a>  <span class="n">Eneeded</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6207"></a>  <span class="n">Eunmet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6208"></a>  <span class="n">Efuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6209"></a>  <span class="n">Eoncycfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6210"></a>  <span class="n">Eoffcycfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6211"></a>  <span class="n">PLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6212"></a>  <span class="n">PLRSum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6213"></a>
<a name="ln-6214"></a>  <span class="n">Qheat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6215"></a>  <span class="n">Qheater</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6216"></a>  <span class="n">Qvent</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6217"></a>  <span class="n">Qneeded</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6218"></a>  <span class="n">Qunmet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6219"></a>  <span class="n">Qnet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6220"></a>  <span class="n">Qfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6221"></a>
<a name="ln-6222"></a>  <span class="c">! Calculate steady-state heat rates</span>
<a name="ln-6223"></a>  <span class="n">Quse</span> <span class="o">=</span> <span class="n">UseMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">UseInletTemp</span> <span class="o">-</span> <span class="n">SetpointTemp</span><span class="p">)</span>
<a name="ln-6224"></a>  <span class="n">Qsource</span> <span class="o">=</span> <span class="n">SourceMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">SourceInletTemp</span> <span class="o">-</span> <span class="n">SetpointTemp</span><span class="p">)</span>
<a name="ln-6225"></a>
<a name="ln-6226"></a>  <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">TimeRemaining</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-6227"></a>
<a name="ln-6228"></a>    <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6229"></a>
<a name="ln-6230"></a>    <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">TankTemp</span>
<a name="ln-6231"></a>
<a name="ln-6232"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-6233"></a>
<a name="ln-6234"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">HeatMode</span><span class="p">)</span>  <span class="c">! Heater is on</span>
<a name="ln-6235"></a>
<a name="ln-6236"></a>        <span class="c">! Calculate heat rate needed to maintain the setpoint at steady-state conditions</span>
<a name="ln-6237"></a>        <span class="n">LossCoeff</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span>
<a name="ln-6238"></a>        <span class="n">LossFracToZone</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycLossFracToZone</span>
<a name="ln-6239"></a>        <span class="n">Qloss</span> <span class="o">=</span> <span class="n">LossCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">AmbientTemp</span> <span class="o">-</span> <span class="n">SetpointTemp</span><span class="p">)</span>
<a name="ln-6240"></a>        <span class="n">Qneeded</span> <span class="o">=</span> <span class="o">-</span><span class="n">Quse</span> <span class="o">-</span> <span class="n">Qsource</span> <span class="o">-</span> <span class="n">Qloss</span> <span class="o">-</span> <span class="n">Qoncycheat</span>
<a name="ln-6241"></a>
<a name="ln-6242"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TankTemp</span> <span class="o">&gt;</span> <span class="n">SetpointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6243"></a>          <span class="c">! Heater is not needed after all, possibly due to step change in scheduled SetpointTemp</span>
<a name="ln-6244"></a>
<a name="ln-6245"></a>          <span class="n">Qheater</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6246"></a>          <span class="n">Qunmet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6247"></a>          <span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-6248"></a>          <span class="k">CYCLE</span>
<a name="ln-6249"></a>
<a name="ln-6250"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">TankTemp</span> <span class="o">&lt;</span> <span class="n">SetpointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6251"></a>          <span class="c">! Attempt to recover to the setpoint as quickly as possible by using maximum heater capacity</span>
<a name="ln-6252"></a>
<a name="ln-6253"></a>          <span class="c">! Qneeded is calculated above</span>
<a name="ln-6254"></a>          <span class="c">! Qneeded does not account for the extra energy needed to recover to the setpoint</span>
<a name="ln-6255"></a>          <span class="n">Qheater</span> <span class="o">=</span> <span class="n">Qmaxcap</span>
<a name="ln-6256"></a>          <span class="n">Qunmet</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Qneeded</span> <span class="o">-</span> <span class="n">Qheater</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-6257"></a>          <span class="n">Qheat</span> <span class="o">=</span> <span class="n">Qoncycheat</span> <span class="o">+</span> <span class="n">Qheater</span>
<a name="ln-6258"></a>
<a name="ln-6259"></a>          <span class="c">! Calculate time needed to recover to the setpoint at maximum heater capacity</span>
<a name="ln-6260"></a>          <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">CalcTimeNeeded</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">SetpointTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6261"></a>                                      <span class="n">TankMass</span><span class="p">,</span> <span class="n">Cp</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">)</span>
<a name="ln-6262"></a>
<a name="ln-6263"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">TimeNeeded</span> <span class="o">&gt;</span> <span class="n">TimeRemaining</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6264"></a>            <span class="c">! Heater is at maximum capacity and heats for all of the remaining time</span>
<a name="ln-6265"></a>            <span class="c">! Setpoint temperature WILL NOT be recovered</span>
<a name="ln-6266"></a>
<a name="ln-6267"></a>            <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">TimeRemaining</span>
<a name="ln-6268"></a>
<a name="ln-6269"></a>            <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">CalcTankTemp</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="n">TankMass</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6270"></a>                                       <span class="n">Cp</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">,</span> <span class="n">TimeNeeded</span><span class="p">)</span>
<a name="ln-6271"></a>
<a name="ln-6272"></a>          <span class="k">ELSE</span>  <span class="c">! TimeNeeded &lt;= TimeRemaining</span>
<a name="ln-6273"></a>            <span class="c">! Heater is at maximum capacity but will not heat for all of the remaining time (at maximum anyway)</span>
<a name="ln-6274"></a>            <span class="c">! Setpoint temperature WILL be recovered</span>
<a name="ln-6275"></a>
<a name="ln-6276"></a>            <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">SetpointTemp</span>
<a name="ln-6277"></a>
<a name="ln-6278"></a>            <span class="n">SetpointRecovered</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6279"></a>
<a name="ln-6280"></a>          <span class="k">END IF</span>  <span class="c">! TimeNeeded &gt; TimeRemaining</span>
<a name="ln-6281"></a>
<a name="ln-6282"></a>
<a name="ln-6283"></a>        <span class="k">ELSE</span>  <span class="c">! TankTemp == SetpointTemp</span>
<a name="ln-6284"></a>          <span class="c">! Attempt to maintain the setpoint by using the needed heater capacity (modulating, if allowed)</span>
<a name="ln-6285"></a>
<a name="ln-6286"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Qneeded</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6287"></a>            <span class="c">! Heater is not needed</span>
<a name="ln-6288"></a>
<a name="ln-6289"></a>            <span class="n">Qneeded</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6290"></a>            <span class="n">Qheater</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6291"></a>            <span class="n">Qunmet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6292"></a>            <span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-6293"></a>            <span class="k">CYCLE</span>
<a name="ln-6294"></a>
<a name="ln-6295"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">Qneeded</span> <span class="o">&lt;</span> <span class="n">Qmincap</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6296"></a>            <span class="c">! Heater is required at less than the minimum capacity</span>
<a name="ln-6297"></a>            <span class="c">! If cycling, Qmincap = Qmaxcap.  Once the setpoint is reached, heater will almost always be shut off here</span>
<a name="ln-6298"></a>
<a name="ln-6299"></a>            <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span><span class="p">)</span>
<a name="ln-6300"></a>
<a name="ln-6301"></a>              <span class="k">CASE</span> <span class="p">(</span><span class="n">ControlTypeCycle</span><span class="p">)</span>
<a name="ln-6302"></a>                <span class="c">! Control will cycle on and off based on DeadBandTemp</span>
<a name="ln-6303"></a>                <span class="n">Qheater</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6304"></a>                <span class="n">Qunmet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6305"></a>                <span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-6306"></a>                <span class="k">CYCLE</span>
<a name="ln-6307"></a>
<a name="ln-6308"></a><span class="k">              CASE</span> <span class="p">(</span><span class="n">ControlTypeModulate</span><span class="p">)</span>
<a name="ln-6309"></a>                <span class="c">! Control will cycle on and off based on DeadBandTemp until Qneeded &gt; Qmincap again</span>
<a name="ln-6310"></a>                <span class="n">Qheater</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6311"></a>                <span class="n">Qunmet</span> <span class="o">=</span> <span class="n">Qneeded</span>
<a name="ln-6312"></a>                <span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-6313"></a>                <span class="k">CYCLE</span>
<a name="ln-6314"></a>
<a name="ln-6315"></a>              <span class="c">!CASE (ControlTypeModulateWithOverheat)  ! Not yet implemented</span>
<a name="ln-6316"></a>                <span class="c">! Calculate time to reach steady-state temp; check for venting at MaxTemp limit</span>
<a name="ln-6317"></a>                <span class="c">!Qheater = Qmincap</span>
<a name="ln-6318"></a>
<a name="ln-6319"></a>              <span class="c">!CASE (ControlTypeModulateWithUnderheat)  ! Not yet implemented</span>
<a name="ln-6320"></a>                <span class="c">! Heater must not come back on until Qneeded &gt;= Qmincap</span>
<a name="ln-6321"></a>                <span class="c">!Mode = FloatMode</span>
<a name="ln-6322"></a>
<a name="ln-6323"></a>            <span class="k">END SELECT</span>
<a name="ln-6324"></a>
<a name="ln-6325"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">Qneeded</span> <span class="o">&lt;=</span> <span class="n">Qmaxcap</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6326"></a>            <span class="c">! Heater can exactly meet the needed heat rate (usually by modulating) and heats for all of the remaining time</span>
<a name="ln-6327"></a>            <span class="c">! Setpoint temperature WILL be maintained</span>
<a name="ln-6328"></a>
<a name="ln-6329"></a>            <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">TimeRemaining</span>
<a name="ln-6330"></a>
<a name="ln-6331"></a>            <span class="n">Qheater</span> <span class="o">=</span> <span class="n">Qneeded</span>
<a name="ln-6332"></a>            <span class="n">Qunmet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6333"></a>
<a name="ln-6334"></a>            <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">SetpointTemp</span>
<a name="ln-6335"></a>
<a name="ln-6336"></a>          <span class="k">ELSE</span>  <span class="c">! Qneeded &gt; Qmaxcap</span>
<a name="ln-6337"></a>            <span class="c">! Heater is at maximum capacity and heats for all of the remaining time</span>
<a name="ln-6338"></a>            <span class="c">! Setpoint temperature WILL NOT be maintained</span>
<a name="ln-6339"></a>
<a name="ln-6340"></a>            <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">TimeRemaining</span>
<a name="ln-6341"></a>
<a name="ln-6342"></a>            <span class="n">Qheater</span> <span class="o">=</span> <span class="n">Qmaxcap</span>
<a name="ln-6343"></a>            <span class="n">Qunmet</span> <span class="o">=</span> <span class="n">Qneeded</span> <span class="o">-</span> <span class="n">Qheater</span>
<a name="ln-6344"></a>            <span class="n">Qheat</span> <span class="o">=</span> <span class="n">Qoncycheat</span> <span class="o">+</span> <span class="n">Qheater</span>
<a name="ln-6345"></a>
<a name="ln-6346"></a>            <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">CalcTankTemp</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="n">TankMass</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6347"></a>                                       <span class="n">Cp</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">,</span> <span class="n">TimeNeeded</span><span class="p">)</span>
<a name="ln-6348"></a>
<a name="ln-6349"></a>          <span class="k">END IF</span>  <span class="c">! Qneeded &gt; Qmaxcap</span>
<a name="ln-6350"></a>
<a name="ln-6351"></a>
<a name="ln-6352"></a>
<a name="ln-6353"></a>        <span class="k">END IF</span>  <span class="c">! TankTemp &gt; SetpointTemp</span>
<a name="ln-6354"></a>
<a name="ln-6355"></a>        <span class="c">! Update summed values</span>
<a name="ln-6356"></a>        <span class="n">Eneeded</span> <span class="o">=</span> <span class="n">Eneeded</span> <span class="o">+</span> <span class="n">Qneeded</span> <span class="o">*</span> <span class="n">TimeNeeded</span>
<a name="ln-6357"></a>        <span class="n">Eheater</span> <span class="o">=</span> <span class="n">Eheater</span> <span class="o">+</span> <span class="n">Qheater</span> <span class="o">*</span> <span class="n">TimeNeeded</span>
<a name="ln-6358"></a>        <span class="n">Eunmet</span> <span class="o">=</span> <span class="n">Eunmet</span> <span class="o">+</span> <span class="n">Qunmet</span> <span class="o">*</span> <span class="n">TimeNeeded</span>
<a name="ln-6359"></a>        <span class="n">Eoncycfuel</span> <span class="o">=</span> <span class="n">Eoncycfuel</span> <span class="o">+</span> <span class="n">Qoncycfuel</span> <span class="o">*</span> <span class="n">TimeNeeded</span>
<a name="ln-6360"></a>
<a name="ln-6361"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Qmaxcap</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">PLR</span> <span class="o">=</span> <span class="n">Qheater</span> <span class="o">/</span> <span class="n">Qmaxcap</span>
<a name="ln-6362"></a>        <span class="n">PLF</span> <span class="o">=</span> <span class="n">PartLoadFactor</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-6363"></a>        <span class="n">Efuel</span> <span class="o">=</span> <span class="n">Efuel</span> <span class="o">+</span> <span class="n">Qheater</span> <span class="o">*</span> <span class="n">TimeNeeded</span> <span class="o">/</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span><span class="p">)</span>
<a name="ln-6364"></a>
<a name="ln-6365"></a>        <span class="n">Runtime</span> <span class="o">=</span> <span class="n">Runtime</span> <span class="o">+</span> <span class="n">TimeNeeded</span>
<a name="ln-6366"></a>        <span class="n">PLRsum</span> <span class="o">=</span> <span class="n">PLRsum</span> <span class="o">+</span> <span class="n">PLR</span> <span class="o">*</span> <span class="n">TimeNeeded</span>
<a name="ln-6367"></a>
<a name="ln-6368"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6369"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryFuel</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryFuel</span> <span class="p">&amp;</span>
<a name="ln-6370"></a>              <span class="o">+</span> <span class="n">Efuel</span> <span class="o">+</span> <span class="n">Eoffcycfuel</span> <span class="o">+</span> <span class="n">Eoncycfuel</span>
<a name="ln-6371"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SetpointRecovered</span><span class="p">)</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryDone</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6372"></a>        <span class="k">END IF</span>
<a name="ln-6373"></a>
<a name="ln-6374"></a>
<a name="ln-6375"></a><span class="k">      CASE</span> <span class="p">(</span><span class="n">FloatMode</span><span class="p">,</span> <span class="n">CoolMode</span><span class="p">)</span>  <span class="c">! Heater is off</span>
<a name="ln-6376"></a>
<a name="ln-6377"></a>        <span class="c">! Calculate heat rate needed to maintain the setpoint at steady-state conditions</span>
<a name="ln-6378"></a>        <span class="n">LossCoeff</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span>
<a name="ln-6379"></a>        <span class="n">LossFracToZone</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossFracToZone</span>
<a name="ln-6380"></a>        <span class="n">Qloss</span> <span class="o">=</span> <span class="n">LossCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">AmbientTemp</span> <span class="o">-</span> <span class="n">SetpointTemp</span><span class="p">)</span>
<a name="ln-6381"></a>        <span class="n">Qneeded</span> <span class="o">=</span> <span class="o">-</span><span class="n">Quse</span> <span class="o">-</span> <span class="n">Qsource</span> <span class="o">-</span> <span class="n">Qloss</span> <span class="o">-</span> <span class="n">Qoffcycheat</span>
<a name="ln-6382"></a>
<a name="ln-6383"></a>        <span class="c">! This section really needs to work differently depending on ControlType</span>
<a name="ln-6384"></a>        <span class="c">! CYCLE will look at TankTemp, MODULATE will look at Qneeded</span>
<a name="ln-6385"></a>
<a name="ln-6386"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">TankTemp</span> <span class="o">&lt;</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6387"></a>          <span class="c">! Tank temperature is already below the minimum, possibly due to step change in scheduled SetpointTemp</span>
<a name="ln-6388"></a>
<a name="ln-6389"></a>          <span class="n">Mode</span> <span class="o">=</span> <span class="n">HeatMode</span>
<a name="ln-6390"></a>          <span class="n">CycleOnCount</span> <span class="o">=</span> <span class="n">CycleOnCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6391"></a>          <span class="k">CYCLE</span>
<a name="ln-6392"></a>
<a name="ln-6393"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">((</span> <span class="n">TankTemp</span> <span class="o">&gt;=</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6394"></a>
<a name="ln-6395"></a><span class="k">          </span><span class="n">Qheat</span> <span class="o">=</span> <span class="n">Qoffcycheat</span>
<a name="ln-6396"></a>
<a name="ln-6397"></a>          <span class="c">! Calculate time needed for tank temperature to fall to minimum (setpoint - deadband)</span>
<a name="ln-6398"></a>          <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">CalcTimeNeeded</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">DeadBandTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6399"></a>                                      <span class="n">TankMass</span><span class="p">,</span> <span class="n">Cp</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">)</span>
<a name="ln-6400"></a>
<a name="ln-6401"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">TimeNeeded</span> <span class="o">&lt;=</span> <span class="n">TimeRemaining</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6402"></a>            <span class="c">! Heating will be needed in this timestep</span>
<a name="ln-6403"></a>
<a name="ln-6404"></a>            <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">DeadBandTemp</span>
<a name="ln-6405"></a>            <span class="n">Mode</span> <span class="o">=</span> <span class="n">HeatMode</span>
<a name="ln-6406"></a>            <span class="n">CycleOnCount</span> <span class="o">=</span> <span class="n">CycleOnCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6407"></a>
<a name="ln-6408"></a>          <span class="k">ELSE</span>  <span class="c">! TimeNeeded &gt; TimeRemaining</span>
<a name="ln-6409"></a>            <span class="c">! Heating will not be needed for all of the remaining time</span>
<a name="ln-6410"></a>
<a name="ln-6411"></a>            <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">CalcTankTemp</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="n">TankMass</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6412"></a>                                       <span class="n">Cp</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">,</span> <span class="n">TimeRemaining</span><span class="p">)</span>
<a name="ln-6413"></a>
<a name="ln-6414"></a>            <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">NewTankTemp</span> <span class="o">&lt;</span> <span class="n">MaxTemp</span><span class="p">)</span>  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-6415"></a>              <span class="c">! Neither heating nor venting is needed for all of the remaining time</span>
<a name="ln-6416"></a>
<a name="ln-6417"></a>              <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">TimeRemaining</span>
<a name="ln-6418"></a>
<a name="ln-6419"></a>            <span class="k">ELSE</span>  <span class="c">! NewTankTemp &gt;= MaxTemp</span>
<a name="ln-6420"></a>              <span class="c">! Venting will be needed in this timestep</span>
<a name="ln-6421"></a>
<a name="ln-6422"></a>              <span class="c">! Calculate time needed for tank temperature to rise to the maximum</span>
<a name="ln-6423"></a>              <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">CalcTimeNeeded</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">MaxTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6424"></a>                                          <span class="n">TankMass</span><span class="p">,</span> <span class="n">Cp</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">)</span>
<a name="ln-6425"></a>
<a name="ln-6426"></a>              <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">MaxTemp</span>
<a name="ln-6427"></a>              <span class="n">Mode</span> <span class="o">=</span> <span class="n">VentMode</span>
<a name="ln-6428"></a>
<a name="ln-6429"></a>            <span class="k">END IF</span>  <span class="c">! NewTankTemp &gt;= MaxTemp</span>
<a name="ln-6430"></a>
<a name="ln-6431"></a>          <span class="k">END IF</span>  <span class="c">! TimeNeeded &lt;= TimeRemaining</span>
<a name="ln-6432"></a>
<a name="ln-6433"></a>        <span class="n">ELSEIF</span><span class="p">((</span> <span class="n">TankTemp</span> <span class="o">&gt;</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6434"></a><span class="k">          </span><span class="n">Mode</span> <span class="o">=</span> <span class="n">CoolMode</span>
<a name="ln-6435"></a>          <span class="n">Qheat</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-6436"></a>
<a name="ln-6437"></a>          <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">CalcTankTemp</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="n">TankMass</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6438"></a>                                     <span class="n">Cp</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">,</span> <span class="n">TimeRemaining</span><span class="p">)</span>
<a name="ln-6439"></a>          <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">TimeRemaining</span>
<a name="ln-6440"></a>        <span class="n">ELSEIF</span><span class="p">((</span> <span class="n">TankTemp</span> <span class="o">&lt;=</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6441"></a>
<a name="ln-6442"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">TankTemp</span> <span class="o">&lt;</span> <span class="n">SetpointTemp</span><span class="p">)</span> <span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-6443"></a>
<a name="ln-6444"></a>          <span class="n">Qheat</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-6445"></a>
<a name="ln-6446"></a>          <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">CalcTankTemp</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="n">TankMass</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6447"></a>                                     <span class="n">Cp</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">,</span> <span class="n">TimeRemaining</span><span class="p">)</span>
<a name="ln-6448"></a>          <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">TimeRemaining</span>
<a name="ln-6449"></a>        <span class="k">END IF</span>  <span class="c">! TankTemp vs DeadBandTemp for heaters and chilled water tanks</span>
<a name="ln-6450"></a>
<a name="ln-6451"></a>        <span class="c">! Update summed values</span>
<a name="ln-6452"></a>        <span class="n">Eneeded</span> <span class="o">=</span> <span class="n">Eneeded</span> <span class="o">+</span> <span class="n">Qneeded</span> <span class="o">*</span> <span class="n">TimeNeeded</span>
<a name="ln-6453"></a>        <span class="n">Eunmet</span> <span class="o">=</span> <span class="n">Eunmet</span> <span class="o">+</span> <span class="n">Qunmet</span> <span class="o">*</span> <span class="n">TimeNeeded</span>  <span class="c">! Qunmet may be propagated thru from the previous iteration</span>
<a name="ln-6454"></a>        <span class="n">Eoffcycfuel</span> <span class="o">=</span> <span class="n">Eoffcycfuel</span> <span class="o">+</span> <span class="n">Qoffcycfuel</span> <span class="o">*</span> <span class="n">TimeNeeded</span>
<a name="ln-6455"></a>
<a name="ln-6456"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">VentMode</span><span class="p">)</span>  <span class="c">! Excess heat is vented</span>
<a name="ln-6457"></a>
<a name="ln-6458"></a>        <span class="n">LossCoeff</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span>
<a name="ln-6459"></a>        <span class="n">LossFracToZone</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycLossFracToZone</span>
<a name="ln-6460"></a>        <span class="n">Qheat</span> <span class="o">=</span> <span class="n">Qoffcycheat</span>
<a name="ln-6461"></a>
<a name="ln-6462"></a>        <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">CalcTankTemp</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="n">TankMass</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6463"></a>                                   <span class="n">Cp</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">,</span> <span class="n">TimeRemaining</span><span class="p">)</span>
<a name="ln-6464"></a>
<a name="ln-6465"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NewTankTemp</span> <span class="o">&lt;</span> <span class="n">MaxTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6466"></a>          <span class="c">! Venting is no longer needed because conditions have changed</span>
<a name="ln-6467"></a>
<a name="ln-6468"></a>          <span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-6469"></a>          <span class="k">CYCLE</span>
<a name="ln-6470"></a>
<a name="ln-6471"></a><span class="k">        ELSE</span>  <span class="c">! NewTankTemp &gt;= MaxTemp</span>
<a name="ln-6472"></a>
<a name="ln-6473"></a>          <span class="n">TimeNeeded</span> <span class="o">=</span> <span class="n">TimeRemaining</span>
<a name="ln-6474"></a>
<a name="ln-6475"></a>          <span class="c">! Calculate the steady-state venting rate needed to maintain the tank at maximum temperature</span>
<a name="ln-6476"></a>          <span class="n">Qloss</span> <span class="o">=</span> <span class="n">LossCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">AmbientTemp</span> <span class="o">-</span> <span class="n">MaxTemp</span><span class="p">)</span>
<a name="ln-6477"></a>          <span class="n">Quse</span> <span class="o">=</span> <span class="n">UseMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">UseInletTemp</span> <span class="o">-</span> <span class="n">MaxTemp</span><span class="p">)</span>
<a name="ln-6478"></a>          <span class="n">Qsource</span> <span class="o">=</span> <span class="n">SourceMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">SourceInletTemp</span> <span class="o">-</span> <span class="n">MaxTemp</span><span class="p">)</span>
<a name="ln-6479"></a>          <span class="n">Qvent</span> <span class="o">=</span> <span class="o">-</span><span class="n">Quse</span> <span class="o">-</span> <span class="n">Qsource</span> <span class="o">-</span> <span class="n">Qloss</span> <span class="o">-</span> <span class="n">Qoffcycheat</span>
<a name="ln-6480"></a>
<a name="ln-6481"></a>          <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">MaxTemp</span>
<a name="ln-6482"></a>
<a name="ln-6483"></a>        <span class="k">END IF</span>  <span class="c">! NewTankTemp &lt; MaxTemp</span>
<a name="ln-6484"></a>
<a name="ln-6485"></a>        <span class="c">! Update summed values</span>
<a name="ln-6486"></a>        <span class="n">Event</span> <span class="o">=</span> <span class="n">Event</span> <span class="o">+</span> <span class="n">Qvent</span> <span class="o">*</span> <span class="n">TimeNeeded</span>
<a name="ln-6487"></a>        <span class="n">Eoffcycfuel</span> <span class="o">=</span> <span class="n">Eoffcycfuel</span> <span class="o">+</span> <span class="n">Qoffcycfuel</span> <span class="o">*</span> <span class="n">TimeNeeded</span>
<a name="ln-6488"></a>
<a name="ln-6489"></a>
<a name="ln-6490"></a>
<a name="ln-6491"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-6492"></a>        <span class="c">! No default</span>
<a name="ln-6493"></a>    <span class="k">END SELECT</span>
<a name="ln-6494"></a>
<a name="ln-6495"></a>
<a name="ln-6496"></a><span class="k">    </span><span class="n">deltaTsum</span> <span class="o">=</span> <span class="n">CalcTempIntegral</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">NewTankTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="n">TankMass</span><span class="p">,</span> <span class="n">Cp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6497"></a>                                 <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">Qheat</span><span class="p">,</span> <span class="n">TimeNeeded</span><span class="p">)</span>
<a name="ln-6498"></a>
<a name="ln-6499"></a>    <span class="c">! Update summed values</span>
<a name="ln-6500"></a>    <span class="n">Tsum</span> <span class="o">=</span> <span class="n">Tsum</span> <span class="o">+</span> <span class="n">deltaTsum</span>
<a name="ln-6501"></a>    <span class="n">Eloss</span> <span class="o">=</span> <span class="n">Eloss</span> <span class="o">+</span> <span class="n">LossCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">AmbientTemp</span> <span class="o">*</span> <span class="n">TimeNeeded</span> <span class="o">-</span> <span class="n">deltaTsum</span><span class="p">)</span>
<a name="ln-6502"></a>    <span class="n">Elosszone</span> <span class="o">=</span> <span class="n">Elosszone</span> <span class="o">+</span> <span class="n">LossFracToZone</span> <span class="o">*</span> <span class="n">LossCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">AmbientTemp</span> <span class="o">*</span> <span class="n">TimeNeeded</span> <span class="o">-</span> <span class="n">deltaTsum</span><span class="p">)</span>
<a name="ln-6503"></a>    <span class="n">Euse</span> <span class="o">=</span> <span class="n">Euse</span> <span class="o">+</span> <span class="n">UseMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">UseInletTemp</span> <span class="o">*</span> <span class="n">TimeNeeded</span> <span class="o">-</span> <span class="n">deltaTsum</span><span class="p">)</span>
<a name="ln-6504"></a>    <span class="n">Esource</span> <span class="o">=</span> <span class="n">Esource</span> <span class="o">+</span> <span class="n">SourceMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">SourceInletTemp</span> <span class="o">*</span> <span class="n">TimeNeeded</span> <span class="o">-</span> <span class="n">deltaTsum</span><span class="p">)</span>
<a name="ln-6505"></a>
<a name="ln-6506"></a>    <span class="n">TankTemp</span> <span class="o">=</span> <span class="n">NewTankTemp</span>  <span class="c">! Update tank temperature</span>
<a name="ln-6507"></a>
<a name="ln-6508"></a>    <span class="n">TimeRemaining</span> <span class="o">=</span> <span class="n">TimeRemaining</span> <span class="o">-</span> <span class="n">TimeNeeded</span>
<a name="ln-6509"></a>
<a name="ln-6510"></a>
<a name="ln-6511"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CycleOnCount</span> <span class="o">&gt;</span> <span class="n">MaxCycles</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6512"></a>
<a name="ln-6513"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6514"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCycleErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6515"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;WaterHeater:Mixed = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6516"></a>            <span class="s1">&#39;:  Heater is cycling on and off more than once per second.&#39;</span><span class="p">)</span>
<a name="ln-6517"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Try increasing Deadband Temperature Difference or Tank Volume&#39;</span><span class="p">)</span>
<a name="ln-6518"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6519"></a>        <span class="n">ENDIF</span>
<a name="ln-6520"></a>        <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;WaterHeater:Mixed = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6521"></a>            <span class="s1">&#39; Heater is cycling on and off more than once per second:&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6522"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCycleErrorIndex</span><span class="p">)</span>
<a name="ln-6523"></a>      <span class="k">END IF</span>
<a name="ln-6524"></a>
<a name="ln-6525"></a><span class="k">      EXIT</span>
<a name="ln-6526"></a>
<a name="ln-6527"></a><span class="k">    END IF</span>  <span class="c">! CycleOnCount &gt; MaxCycles</span>
<a name="ln-6528"></a>
<a name="ln-6529"></a>  <span class="k">END DO</span>  <span class="c">! TimeRemaining &gt; 0.0</span>
<a name="ln-6530"></a>
<a name="ln-6531"></a>  <span class="c">! Calculate average values over the timestep based on summed values, Q &gt; 0 is a gain to the tank,  Q &lt; 0 is a loss to the tank</span>
<a name="ln-6532"></a>  <span class="n">TankTempAvg</span> <span class="o">=</span> <span class="n">Tsum</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6533"></a>  <span class="n">Qloss</span> <span class="o">=</span> <span class="n">Eloss</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6534"></a>  <span class="n">Qlosszone</span> <span class="o">=</span> <span class="n">Elosszone</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6535"></a>  <span class="n">Quse</span> <span class="o">=</span> <span class="n">Euse</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6536"></a>  <span class="n">Qsource</span> <span class="o">=</span> <span class="n">Esource</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6537"></a>  <span class="n">Qheater</span> <span class="o">=</span> <span class="n">Eheater</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6538"></a>  <span class="n">Qoffcycfuel</span> <span class="o">=</span> <span class="n">Eoffcycfuel</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6539"></a>  <span class="n">Qoffcycheat</span> <span class="o">=</span> <span class="n">Qoffcycfuel</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span>
<a name="ln-6540"></a>  <span class="n">Qoncycfuel</span> <span class="o">=</span> <span class="n">Eoncycfuel</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6541"></a>  <span class="n">Qoncycheat</span> <span class="o">=</span> <span class="n">Qoncycfuel</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span>
<a name="ln-6542"></a>  <span class="n">Qvent</span> <span class="o">=</span> <span class="n">Event</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6543"></a>  <span class="n">Qneeded</span> <span class="o">=</span> <span class="n">Eneeded</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6544"></a>  <span class="n">Qunmet</span> <span class="o">=</span> <span class="n">Eunmet</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6545"></a>  <span class="n">RTF</span> <span class="o">=</span> <span class="n">Runtime</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6546"></a>  <span class="n">PLR</span> <span class="o">=</span> <span class="n">PLRSum</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6547"></a>
<a name="ln-6548"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">ControlTypeCycle</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6549"></a>    <span class="c">! Recalculate Part Load Factor and fuel energy based on Runtime Fraction, instead of Part Load Ratio</span>
<a name="ln-6550"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">PartLoadFactor</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">RTF</span><span class="p">)</span>
<a name="ln-6551"></a>    <span class="n">Efuel</span> <span class="o">=</span> <span class="n">Eheater</span> <span class="o">/</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span><span class="p">)</span>
<a name="ln-6552"></a>  <span class="k">END IF</span>
<a name="ln-6553"></a>
<a name="ln-6554"></a><span class="k">  </span><span class="n">Qfuel</span> <span class="o">=</span> <span class="n">Efuel</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-6555"></a>
<a name="ln-6556"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">Mode</span>  <span class="c">! Operating mode for carry-over to next timestep</span>
<a name="ln-6557"></a>
<a name="ln-6558"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span> <span class="o">=</span> <span class="n">TankTemp</span>  <span class="c">! Final tank temperature for carry-over to next timestep</span>
<a name="ln-6559"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempAvg</span> <span class="o">=</span> <span class="n">TankTempAvg</span>  <span class="c">! Average tank temperature over the timestep for reporting</span>
<a name="ln-6560"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span> <span class="o">=</span> <span class="n">TankTempAvg</span>  <span class="c">! Because entire tank is at same temperature</span>
<a name="ln-6561"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span> <span class="o">=</span> <span class="n">TankTempAvg</span>  <span class="c">! Because entire tank is at same temperature</span>
<a name="ln-6562"></a>
<a name="ln-6563"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">LossRate</span> <span class="o">=</span> <span class="n">Qloss</span>
<a name="ln-6564"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseRate</span> <span class="o">=</span> <span class="n">Quse</span>
<a name="ln-6565"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceRate</span> <span class="o">=</span> <span class="n">Qsource</span>
<a name="ln-6566"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaRateToTank</span> <span class="o">=</span> <span class="n">Qoffcycheat</span>
<a name="ln-6567"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaRateToTank</span> <span class="o">=</span> <span class="n">Qoncycheat</span>
<a name="ln-6568"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TotalDemandRate</span> <span class="o">=</span> <span class="o">-</span><span class="n">Quse</span> <span class="o">-</span> <span class="n">Qsource</span> <span class="o">-</span> <span class="n">Qloss</span> <span class="o">-</span> <span class="n">Qoffcycheat</span> <span class="o">-</span> <span class="n">Qoncycheat</span>
<a name="ln-6569"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate</span> <span class="o">=</span> <span class="n">Qheater</span>
<a name="ln-6570"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UnmetRate</span> <span class="o">=</span> <span class="n">Qunmet</span>
<a name="ln-6571"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VentRate</span> <span class="o">=</span> <span class="n">Qvent</span>
<a name="ln-6572"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">NetHeatTransferRate</span> <span class="o">=</span> <span class="n">Quse</span> <span class="o">+</span> <span class="n">Qsource</span> <span class="o">+</span> <span class="n">Qloss</span> <span class="o">+</span> <span class="n">Qoffcycheat</span> <span class="o">+</span> <span class="n">Qoncycheat</span> <span class="o">+</span> <span class="n">Qheater</span> <span class="o">+</span> <span class="n">Qvent</span>
<a name="ln-6573"></a>
<a name="ln-6574"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">CycleOnCount</span> <span class="o">=</span> <span class="n">CycleOnCount</span>
<a name="ln-6575"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="n">RTF</span>
<a name="ln-6576"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">PLR</span>
<a name="ln-6577"></a>
<a name="ln-6578"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelRate</span> <span class="o">=</span> <span class="n">Qfuel</span>
<a name="ln-6579"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span> <span class="o">=</span> <span class="n">Qoffcycfuel</span>
<a name="ln-6580"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span> <span class="o">=</span> <span class="n">Qoncycfuel</span>
<a name="ln-6581"></a>
<a name="ln-6582"></a>  <span class="c">! Add water heater skin losses and venting losses to ambient zone, if specified</span>
<a name="ln-6583"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-6584"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientZoneGain</span> <span class="o">=</span> <span class="o">-</span><span class="n">Qlosszone</span> <span class="o">-</span> <span class="n">Qvent</span>
<a name="ln-6585"></a>
<a name="ln-6586"></a>  <span class="k">RETURN</span>
<a name="ln-6587"></a>
<a name="ln-6588"></a><span class="k">END SUBROUTINE </span><span class="n">CalcWaterThermalTankMixed</span>
<a name="ln-6589"></a>
<a name="ln-6590"></a>
<a name="ln-6591"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">CalcTimeNeeded</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">Tf</span><span class="p">,</span> <span class="n">Ta</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">Cp</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<a name="ln-6592"></a>
<a name="ln-6593"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6594"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-6595"></a>          <span class="c">!       DATE WRITTEN   February 2005</span>
<a name="ln-6596"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6597"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6598"></a>
<a name="ln-6599"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6600"></a>          <span class="c">! Calculates the time needed for the tank temperature to change from Ti to Tf given heat loss,</span>
<a name="ln-6601"></a>          <span class="c">! mass flow rates and temperatures, and net heat transfer due to heater and parasitics.</span>
<a name="ln-6602"></a>
<a name="ln-6603"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6604"></a>          <span class="c">! Equations are derived by solving the differential equation governing the tank energy balance.</span>
<a name="ln-6605"></a>          <span class="c">! Special cases which cause the natural logarithm to blow up are trapped and interpreted as</span>
<a name="ln-6606"></a>          <span class="c">! requiring an infinite amount of time because Tf can never be reached under the given conditions.</span>
<a name="ln-6607"></a>
<a name="ln-6608"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6609"></a>
<a name="ln-6610"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6611"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Ti</span>        <span class="c">! Initial tank temperature (C)</span>
<a name="ln-6612"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tf</span>        <span class="c">! Final tank temperature (C)</span>
<a name="ln-6613"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Ta</span>        <span class="c">! Ambient environment temperature (C)</span>
<a name="ln-6614"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">T1</span>        <span class="c">! Temperature of flow 1 (C)</span>
<a name="ln-6615"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">T2</span>        <span class="c">! Temperature of flow 2 (C)</span>
<a name="ln-6616"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">m</span>         <span class="c">! Mass of tank fluid (kg)</span>
<a name="ln-6617"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Cp</span>        <span class="c">! Specific heat of fluid (J/kg deltaC)</span>
<a name="ln-6618"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">m1</span>        <span class="c">! Mass flow rate 1 (kg/s)</span>
<a name="ln-6619"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">m2</span>        <span class="c">! Mass flow rate 2 (kg/s)</span>
<a name="ln-6620"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UA</span>        <span class="c">! Heat loss coefficient to ambient environment (W/deltaC)</span>
<a name="ln-6621"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Q</span>         <span class="c">! Net heating rate for non-temp dependent sources, i.e. heater and parasitics (W)</span>
<a name="ln-6622"></a>
<a name="ln-6623"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6624"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">Infinity</span> <span class="o">=</span> <span class="mi">9999999</span><span class="mf">9.9d0</span>  <span class="c">! A time interval much larger than any single timestep (s)</span>
<a name="ln-6625"></a>
<a name="ln-6626"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6627"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">a</span>         <span class="c">! Intermediate variable</span>
<a name="ln-6628"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">b</span>         <span class="c">! Intermediate variable</span>
<a name="ln-6629"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Tm</span>        <span class="c">! Mixed temperature after an infinite amount of time has passed (C)</span>
<a name="ln-6630"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">quotient</span>  <span class="c">! Intermediate variable</span>
<a name="ln-6631"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">t</span>         <span class="c">! Time elapsed from Ti to Tf (s)</span>
<a name="ln-6632"></a>
<a name="ln-6633"></a>          <span class="c">! FLOW:</span>
<a name="ln-6634"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Tf</span> <span class="o">==</span> <span class="n">Ti</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6635"></a>    <span class="c">! Already at Tf; no time is needed</span>
<a name="ln-6636"></a>    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6637"></a>
<a name="ln-6638"></a>  <span class="k">ELSE</span>
<a name="ln-6639"></a>
<a name="ln-6640"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UA</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6641"></a>
<a name="ln-6642"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Q</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6643"></a>        <span class="c">! With no mass flow and no heat flow and Tf&lt;&gt;Ti, then Tf can never be reached</span>
<a name="ln-6644"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">Infinity</span>
<a name="ln-6645"></a>
<a name="ln-6646"></a>      <span class="k">ELSE</span>
<a name="ln-6647"></a><span class="k">        </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-6648"></a>
<a name="ln-6649"></a>        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tf</span> <span class="o">-</span> <span class="n">Ti</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
<a name="ln-6650"></a>
<a name="ln-6651"></a>      <span class="k">END IF</span>
<a name="ln-6652"></a>
<a name="ln-6653"></a><span class="k">    ELSE</span>
<a name="ln-6654"></a><span class="k">      </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">UA</span> <span class="o">*</span> <span class="n">Ta</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">*</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">m2</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span>
<a name="ln-6655"></a>      <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">UA</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span>
<a name="ln-6656"></a>
<a name="ln-6657"></a>      <span class="c">! Calculate the mixed temperature Tm of the tank after an infinite amount of time has passed</span>
<a name="ln-6658"></a>      <span class="n">Tm</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
<a name="ln-6659"></a>
<a name="ln-6660"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Tm</span> <span class="o">==</span> <span class="n">Ti</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6661"></a>        <span class="c">! Mixed temperature is the same as Ti; if Tf&lt;&gt;Ti, then Tf can never be reached</span>
<a name="ln-6662"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">Infinity</span>
<a name="ln-6663"></a>
<a name="ln-6664"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Tm</span> <span class="o">==</span> <span class="n">Tf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6665"></a>        <span class="c">! Tf only approaches Tm; it can never actually get there in finite time (also avoids divide by zero error)</span>
<a name="ln-6666"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">Infinity</span>
<a name="ln-6667"></a>
<a name="ln-6668"></a>      <span class="k">ELSE</span>
<a name="ln-6669"></a><span class="k">        </span><span class="n">quotient</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tf</span> <span class="o">-</span> <span class="n">Tm</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Ti</span> <span class="o">-</span> <span class="n">Tm</span><span class="p">)</span>
<a name="ln-6670"></a>
<a name="ln-6671"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">quotient</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!Objexx:Num Changed &lt; to &lt;= to elim poss floating point error in LOG call</span>
<a name="ln-6672"></a>          <span class="c">! Tm is in between Ti and Tf; Tf can never be reached</span>
<a name="ln-6673"></a>          <span class="n">t</span> <span class="o">=</span> <span class="n">Infinity</span>
<a name="ln-6674"></a>
<a name="ln-6675"></a>        <span class="k">ELSE</span>
<a name="ln-6676"></a><span class="k">          </span><span class="n">t</span> <span class="o">=</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">quotient</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span>
<a name="ln-6677"></a>
<a name="ln-6678"></a>        <span class="k">END IF</span>
<a name="ln-6679"></a><span class="k">      END IF</span>
<a name="ln-6680"></a><span class="k">    END IF</span>
<a name="ln-6681"></a>
<a name="ln-6682"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">t</span> <span class="o">=</span> <span class="n">Infinity</span>  <span class="c">! If negative time, Tf can never be reached in the future</span>
<a name="ln-6683"></a>
<a name="ln-6684"></a>  <span class="k">END IF</span>
<a name="ln-6685"></a>
<a name="ln-6686"></a><span class="k">  </span><span class="n">CalcTimeNeeded</span> <span class="o">=</span> <span class="n">t</span>
<a name="ln-6687"></a>
<a name="ln-6688"></a>  <span class="k">RETURN</span>
<a name="ln-6689"></a>
<a name="ln-6690"></a><span class="k">END FUNCTION </span><span class="n">CalcTimeNeeded</span>
<a name="ln-6691"></a>
<a name="ln-6692"></a>
<a name="ln-6693"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">CalcTankTemp</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">Ta</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">Cp</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-6694"></a>
<a name="ln-6695"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6696"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-6697"></a>          <span class="c">!       DATE WRITTEN   February 2005</span>
<a name="ln-6698"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6699"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6700"></a>
<a name="ln-6701"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6702"></a>          <span class="c">! Calculates the final tank temperature Tf after time t has elapsed given heat loss,</span>
<a name="ln-6703"></a>          <span class="c">! mass flow rates and temperatures, and net heat transfer due to heater and parasitics.</span>
<a name="ln-6704"></a>
<a name="ln-6705"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6706"></a>          <span class="c">! Equations are derived by solving the differential equation governing the tank energy balance.</span>
<a name="ln-6707"></a>
<a name="ln-6708"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6709"></a>
<a name="ln-6710"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6711"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Ti</span>       <span class="c">! Initial tank temperature (C)</span>
<a name="ln-6712"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Ta</span>       <span class="c">! Ambient environment temperature (C)</span>
<a name="ln-6713"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">T1</span>       <span class="c">! Temperature of flow 1 (C)</span>
<a name="ln-6714"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">T2</span>       <span class="c">! Temperature of flow 2 (C)</span>
<a name="ln-6715"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">m</span>        <span class="c">! Mass of tank fluid (kg)</span>
<a name="ln-6716"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Cp</span>       <span class="c">! Specific heat of fluid (J/kg deltaC)</span>
<a name="ln-6717"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">m1</span>       <span class="c">! Mass flow rate 1 (kg/s)</span>
<a name="ln-6718"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">m2</span>       <span class="c">! Mass flow rate 2 (kg/s)</span>
<a name="ln-6719"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UA</span>       <span class="c">! Heat loss coefficient to ambient environment (W/deltaC)</span>
<a name="ln-6720"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Q</span>        <span class="c">! Net heating rate for non-temp dependent sources, i.e. heater and parasitics (W)</span>
<a name="ln-6721"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">t</span>        <span class="c">! Time elapsed from Ti to Tf (s)</span>
<a name="ln-6722"></a>
<a name="ln-6723"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6724"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">a</span>        <span class="c">! Intermediate variable</span>
<a name="ln-6725"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">b</span>        <span class="c">! Intermediate variable</span>
<a name="ln-6726"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Tf</span>       <span class="c">! Final tank temperature (C)</span>
<a name="ln-6727"></a>
<a name="ln-6728"></a>          <span class="c">! FLOW:</span>
<a name="ln-6729"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UA</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6730"></a><span class="k">    </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-6731"></a>
<a name="ln-6732"></a>    <span class="n">Tf</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">Ti</span>
<a name="ln-6733"></a>
<a name="ln-6734"></a>  <span class="k">ELSE</span>
<a name="ln-6735"></a><span class="k">    </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">UA</span> <span class="o">*</span> <span class="n">Ta</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">*</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">m2</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span>
<a name="ln-6736"></a>    <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">UA</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span>
<a name="ln-6737"></a>
<a name="ln-6738"></a>    <span class="n">Tf</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="o">+</span> <span class="n">Ti</span><span class="p">)</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
<a name="ln-6739"></a>
<a name="ln-6740"></a>  <span class="k">END IF</span>
<a name="ln-6741"></a>
<a name="ln-6742"></a><span class="k">  </span><span class="n">CalcTankTemp</span> <span class="o">=</span> <span class="n">Tf</span>
<a name="ln-6743"></a>
<a name="ln-6744"></a>  <span class="k">RETURN</span>
<a name="ln-6745"></a>
<a name="ln-6746"></a><span class="k">END FUNCTION </span><span class="n">CalcTankTemp</span>
<a name="ln-6747"></a>
<a name="ln-6748"></a>
<a name="ln-6749"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">CalcTempIntegral</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="n">Tf</span><span class="p">,</span> <span class="n">Ta</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">Cp</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-6750"></a>
<a name="ln-6751"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6752"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-6753"></a>          <span class="c">!       DATE WRITTEN   February 2005</span>
<a name="ln-6754"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6755"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6756"></a>
<a name="ln-6757"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6758"></a>          <span class="c">! Calculates the integral of the tank temperature from Ti to Tf.  The integral is added to a sum which is</span>
<a name="ln-6759"></a>          <span class="c">! later divided by the elapsed time to yield the average tank temperature over the timestep.</span>
<a name="ln-6760"></a>
<a name="ln-6761"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6762"></a>          <span class="c">! Equations are the mathematical integrals of the governing differential equations.</span>
<a name="ln-6763"></a>
<a name="ln-6764"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6765"></a>
<a name="ln-6766"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6767"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Ti</span>        <span class="c">! Initial tank temperature (C)</span>
<a name="ln-6768"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tf</span>        <span class="c">! Final tank temperature (C)</span>
<a name="ln-6769"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Ta</span>        <span class="c">! Ambient environment temperature (C)</span>
<a name="ln-6770"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">T1</span>        <span class="c">! Temperature of flow 1 (C)</span>
<a name="ln-6771"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">T2</span>        <span class="c">! Temperature of flow 2 (C)</span>
<a name="ln-6772"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">m</span>         <span class="c">! Mass of tank fluid (kg)</span>
<a name="ln-6773"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Cp</span>        <span class="c">! Specific heat of fluid (J/kg deltaC)</span>
<a name="ln-6774"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">m1</span>        <span class="c">! Mass flow rate 1 (kg/s)</span>
<a name="ln-6775"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">m2</span>        <span class="c">! Mass flow rate 2 (kg/s)</span>
<a name="ln-6776"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UA</span>        <span class="c">! Heat loss coefficient to ambient environment (W/deltaC)</span>
<a name="ln-6777"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Q</span>         <span class="c">! Net heating rate for non-temp dependent sources, i.e. heater and parasitics (W)</span>
<a name="ln-6778"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">t</span>         <span class="c">! Time elapsed from Ti to Tf (s)</span>
<a name="ln-6779"></a>
<a name="ln-6780"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6781"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">a</span>         <span class="c">! Intermediate variable</span>
<a name="ln-6782"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">b</span>         <span class="c">! Intermediate variable</span>
<a name="ln-6783"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">dTsum</span>     <span class="c">! Integral of tank temperature (C s)</span>
<a name="ln-6784"></a>
<a name="ln-6785"></a>          <span class="c">! FLOW:</span>
<a name="ln-6786"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6787"></a><span class="k">    </span><span class="n">dTsum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6788"></a>
<a name="ln-6789"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Tf</span> <span class="o">==</span> <span class="n">Ti</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Steady-state conditions</span>
<a name="ln-6790"></a>    <span class="n">dTsum</span> <span class="o">=</span> <span class="n">Tf</span> <span class="o">*</span> <span class="n">t</span>
<a name="ln-6791"></a>
<a name="ln-6792"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">UA</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6793"></a><span class="k">    </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-6794"></a>
<a name="ln-6795"></a>    <span class="c">! Integral of T(t) = a * t + Ti, evaluated from 0 to t</span>
<a name="ln-6796"></a>    <span class="n">dTsum</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">Ti</span> <span class="o">*</span> <span class="n">t</span>
<a name="ln-6797"></a>
<a name="ln-6798"></a>  <span class="k">ELSE</span>
<a name="ln-6799"></a><span class="k">    </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">UA</span> <span class="o">*</span> <span class="n">Ta</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">*</span> <span class="n">T1</span> <span class="o">+</span> <span class="n">m2</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span>
<a name="ln-6800"></a>    <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">UA</span> <span class="o">/</span> <span class="n">Cp</span> <span class="o">+</span> <span class="n">m1</span> <span class="o">+</span> <span class="n">m2</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span>
<a name="ln-6801"></a>
<a name="ln-6802"></a>    <span class="c">! Integral of T(t) = (a / b + Ti) * EXP(b * t) - a / b, evaluated from 0 to t</span>
<a name="ln-6803"></a>    <span class="n">dTsum</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="o">+</span> <span class="n">Ti</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nb">EXP</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">b</span>
<a name="ln-6804"></a>  <span class="k">END IF</span>
<a name="ln-6805"></a>
<a name="ln-6806"></a><span class="k">  </span><span class="n">CalcTempIntegral</span> <span class="o">=</span> <span class="n">dTsum</span>
<a name="ln-6807"></a>
<a name="ln-6808"></a>  <span class="k">RETURN</span>
<a name="ln-6809"></a>
<a name="ln-6810"></a><span class="k">END FUNCTION </span><span class="n">CalcTempIntegral</span>
<a name="ln-6811"></a>
<a name="ln-6812"></a>
<a name="ln-6813"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">PartLoadFactor</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-6814"></a>
<a name="ln-6815"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6816"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-6817"></a>          <span class="c">!       DATE WRITTEN   January 2005</span>
<a name="ln-6818"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6819"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6820"></a>
<a name="ln-6821"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6822"></a>          <span class="c">! Calculates the Part Load Factor (PLF) based on a curve correlated to Part Load Ratio, if Heater Control Type</span>
<a name="ln-6823"></a>          <span class="c">! is MODULATE, or correlated to Runtime Fraction, if Heater Control Type is CYCLE.</span>
<a name="ln-6824"></a>
<a name="ln-6825"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6826"></a>          <span class="c">! Uses CurveManager.  Part Load Factor is not allowed below 0.1.</span>
<a name="ln-6827"></a>
<a name="ln-6828"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6829"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-6830"></a>
<a name="ln-6831"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6832"></a>
<a name="ln-6833"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6834"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-6835"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-6836"></a>
<a name="ln-6837"></a>          <span class="c">! FLOW:</span>
<a name="ln-6838"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PLFCurve</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6839"></a><span class="k">    </span><span class="n">PartLoadFactor</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PLFCurve</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-6840"></a>
<a name="ln-6841"></a>    <span class="n">PartLoadFactor</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">PartLoadFactor</span><span class="p">,</span><span class="mf">0.1d0</span><span class="p">)</span>
<a name="ln-6842"></a>  <span class="k">ELSE</span>
<a name="ln-6843"></a>    <span class="c">! No curve was defined</span>
<a name="ln-6844"></a>    <span class="n">PartLoadFactor</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6845"></a>  <span class="k">END IF</span>
<a name="ln-6846"></a>
<a name="ln-6847"></a><span class="k">  RETURN</span>
<a name="ln-6848"></a>
<a name="ln-6849"></a><span class="k">END FUNCTION </span><span class="n">PartLoadFactor</span>
<a name="ln-6850"></a>
<a name="ln-6851"></a>
<a name="ln-6852"></a><span class="k">SUBROUTINE </span><span class="n">CalcWaterThermalTankStratified</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-6853"></a>
<a name="ln-6854"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6855"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-6856"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-6857"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6858"></a>          <span class="c">!                      Nov 2011, BAN; modified the use and source outlet temperature calculation</span>
<a name="ln-6859"></a>          <span class="c">!</span>
<a name="ln-6860"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6861"></a>
<a name="ln-6862"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6863"></a>          <span class="c">! Simulates a stratified, multi-node water heater tank with up to two heating elements.</span>
<a name="ln-6864"></a>
<a name="ln-6865"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6866"></a>          <span class="c">! This model uses a numerical calculation based on the forward Euler method.  A heat balance is calculated for each</span>
<a name="ln-6867"></a>          <span class="c">! node at a sub time step interval of one second.  Temperatures and energies change dynamically over the system</span>
<a name="ln-6868"></a>          <span class="c">! time step.  Final node temperatures are reported as final instantaneous values as well as averages over the</span>
<a name="ln-6869"></a>          <span class="c">! time step.  Heat transfer rates are averages over the time step.</span>
<a name="ln-6870"></a>
<a name="ln-6871"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6872"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStep</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">HourOfDay</span>
<a name="ln-6873"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-6874"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-6875"></a>
<a name="ln-6876"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6877"></a>
<a name="ln-6878"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6879"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>      <span class="c">! Water Heater being simulated</span>
<a name="ln-6880"></a>
<a name="ln-6881"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6882"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0d0</span>          <span class="c">! Sub time step interval (s)</span>
<a name="ln-6883"></a>
<a name="ln-6884"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6885"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TimeElapsed</span>         <span class="c">! Fraction of the current hour that has elapsed (h)</span>
<a name="ln-6886"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SecInTimeStep</span>       <span class="c">! Seconds in one timestep (s)</span>
<a name="ln-6887"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TimeRemaining</span>       <span class="c">! Time remaining in the current timestep (s)</span>
<a name="ln-6888"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">NumNodes</span>            <span class="c">! Number of stratified nodes</span>
<a name="ln-6889"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">NodeNum</span>             <span class="c">! Node number index</span>
<a name="ln-6890"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NodeMass</span>            <span class="c">! Mass of water in a node (kg)</span>
<a name="ln-6891"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NodeTemp</span>            <span class="c">! Instantaneous node temperature (C)</span>
<a name="ln-6892"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TempUp</span>              <span class="c">! Temperature of the upper node (C)</span>
<a name="ln-6893"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TempDn</span>              <span class="c">! Temperature of the lower node (C)</span>
<a name="ln-6894"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">InvMixUp</span>            <span class="c">! Inversion mixing rate with the upper node (kg/s)</span>
<a name="ln-6895"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">InvMixDn</span>            <span class="c">! Inversion mixing rate with the lower node (kg/s)</span>
<a name="ln-6896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Cp</span>                  <span class="c">! Specific heat of water (J/kg K)</span>
<a name="ln-6897"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LossCoeff</span>           <span class="c">! Loss coefficient to ambient environment (W/K)</span>
<a name="ln-6898"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AmbientTemp</span>         <span class="c">! Current ambient air temperature around tank (C)</span>
<a name="ln-6899"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SetPointTemp1</span>       <span class="c">! Current set point temperature for heater 1 (C)</span>
<a name="ln-6900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SetPointTemp2</span>       <span class="c">! Current set point temperature for heater 2 (C)</span>
<a name="ln-6901"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MinTemp1</span>            <span class="c">! Minimum tank temperature (SetPointTemp1 - DeadbandDeltaTemp1) (C)</span>
<a name="ln-6902"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MinTemp2</span>            <span class="c">! Minimum tank temperature (SetPointTemp2 - DeadbandDeltaTemp2) (C)</span>
<a name="ln-6903"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MaxTemp</span>             <span class="c">! Maximum tank temperature before venting (C)</span>
<a name="ln-6904"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Quse</span>                <span class="c">! Heating rate due to use side mass flow (W)</span>
<a name="ln-6905"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qsource</span>             <span class="c">! Heating rate due to source side mass flow (W)</span>
<a name="ln-6906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qcond</span>               <span class="c">! Heating rate due to vertical conduction between nodes</span>
<a name="ln-6907"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qflow</span>               <span class="c">! Heating rate due to fluid flow between inlet and outlet nodes</span>
<a name="ln-6908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qmix</span>                <span class="c">! Heating rate due to temperature inversion mixing between nodes</span>
<a name="ln-6909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qloss</span>               <span class="c">! Heating rate due to ambient environment (W)</span>
<a name="ln-6910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qlosszone</span>           <span class="c">! Heating rate of fraction of losses added to the zone as a gain (W)</span>
<a name="ln-6911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qheat</span>               <span class="c">! Net heating rate for non-temp dependent sources, i.e. heater and parasitics (W)</span>
<a name="ln-6912"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qheater1</span>            <span class="c">! Heating rate of burner or electric heating element 1 (W)</span>
<a name="ln-6913"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qheater2</span>            <span class="c">! Heating rate of burner or electric heating element 2 (W)</span>
<a name="ln-6914"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qheater</span>             <span class="c">! Combined heating rate of heater 1 and 2 (W)</span>
<a name="ln-6915"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qoffcycfuel</span>         <span class="c">! Fuel consumption rate of off-cycle parasitics (W)</span>
<a name="ln-6916"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qoffcycheat</span>         <span class="c">! Heating rate of fraction of off-cycle parasitics added to the tank (W)</span>
<a name="ln-6917"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qoncycfuel</span>          <span class="c">! Fuel consumption rate on-cycle parasitics added to the tank (W)</span>
<a name="ln-6918"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qoncycheat</span>          <span class="c">! Heating rate of fraction of on-cycle parasitics added to the tank (W)</span>
<a name="ln-6919"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qneeded</span>             <span class="c">! Heating rate needed to recover or maintain the setpoint temperature (W)</span>
<a name="ln-6920"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qunmet</span>              <span class="c">! The difference between Qneeded and Qheater (W)</span>
<a name="ln-6921"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qvent</span>               <span class="c">! Heating rate due to venting because tank exceeded max temperature limit (W)</span>
<a name="ln-6922"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Qfuel</span>               <span class="c">! Heating rate for fuel consumed (W)</span>
<a name="ln-6923"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UseInletTemp</span>        <span class="c">! Use side inlet temperature (C)</span>
<a name="ln-6924"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UseMassFlowRate</span>     <span class="c">! Use side flow rate, including effectiveness factor (kg/s)</span>
<a name="ln-6925"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SourceInletTemp</span>     <span class="c">! Source side inlet temperature (C)</span>
<a name="ln-6926"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SourceMassFlowRate</span>  <span class="c">! Source side flow rate, including effectiveness factor (kg/s)</span>
<a name="ln-6927"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">CycleOnCount1</span>       <span class="c">! Number of times heater 1 cycles on in the current time step</span>
<a name="ln-6928"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">CycleOnCount2</span>       <span class="c">! Number of times heater 2 cycles on in the current time step</span>
<a name="ln-6929"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Runtime1</span>            <span class="c">! Time that heater 1 is running (s)</span>
<a name="ln-6930"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Runtime2</span>            <span class="c">! Time that heater 2 is running (s)</span>
<a name="ln-6931"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Runtime</span>             <span class="c">! Time that either heater is running (s)</span>
<a name="ln-6932"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RTF1</span>                <span class="c">! Runtime fraction, fraction of timestep that heater 1 is running</span>
<a name="ln-6933"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RTF2</span>                <span class="c">! Runtime fraction, fraction of timestep that heater 2 is running</span>
<a name="ln-6934"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RTF</span>                 <span class="c">! Runtime fraction, fraction of timestep that either heater is running</span>
<a name="ln-6935"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eloss</span>               <span class="c">! Energy change due to ambient losses over the timestep (J)</span>
<a name="ln-6936"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Elosszone</span>           <span class="c">! Energy change to the zone due to ambient losses over the timestep (J)</span>
<a name="ln-6937"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Euse</span>                <span class="c">! Energy change due to use side mass flow over the timestep (J)</span>
<a name="ln-6938"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Esource</span>             <span class="c">! Energy change due to source side mass flow over the timestep (J)</span>
<a name="ln-6939"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eheater1</span>            <span class="c">! Energy change due to heater 1 over the timestep (J)</span>
<a name="ln-6940"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eheater2</span>            <span class="c">! Energy change due to heater 2 over the timestep (J)</span>
<a name="ln-6941"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eoncycfuel</span>          <span class="c">! Fuel energy consumed by on-cycle parasitics over the timestep (J)</span>
<a name="ln-6942"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eoffcycfuel</span>         <span class="c">! Fuel energy consumed by off-cycle parasitics over the timestep (J)</span>
<a name="ln-6943"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Event</span>               <span class="c">! Energy change due to venting over the timestep (J)</span>
<a name="ln-6944"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eneeded</span>             <span class="c">! Energy change needed over the timestep (J)</span>
<a name="ln-6945"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Eunmet</span>              <span class="c">! Energy change unmet over the timestep (J)</span>
<a name="ln-6946"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Efuel</span>               <span class="c">! Energy change for fuel consumed over the timestep (J)</span>
<a name="ln-6947"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">SetPointRecovered</span>   <span class="c">! Flag to indicate when set point is recovered for the first time</span>
<a name="ln-6948"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6949"></a>
<a name="ln-6950"></a>  <span class="c">! FLOW:</span>
<a name="ln-6951"></a>  <span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">HourOfDay</span> <span class="o">+</span> <span class="n">TimeStep</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-6952"></a>
<a name="ln-6953"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">/=</span> <span class="n">TimeElapsed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6954"></a>    <span class="c">! The simulation has advanced to the next system timestep.  Save conditions from the end of the previous system</span>
<a name="ln-6955"></a>    <span class="c">! timestep for use as the initial conditions of each iteration that does not advance the system timestep.</span>
<a name="ln-6956"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">SavedTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span>
<a name="ln-6957"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn1</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span>
<a name="ln-6958"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn2</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span>
<a name="ln-6959"></a>
<a name="ln-6960"></a>    <span class="c">! Save outlet temperatures for demand-side flow control</span>
<a name="ln-6961"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedUseOutletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span>
<a name="ln-6962"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedSourceOutletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-6963"></a>
<a name="ln-6964"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">TimeElapsed</span>
<a name="ln-6965"></a>  <span class="k">END IF</span>
<a name="ln-6966"></a>
<a name="ln-6967"></a><span class="k">  </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">SavedTemp</span>
<a name="ln-6968"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn1</span>
<a name="ln-6969"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn2</span>
<a name="ln-6970"></a>
<a name="ln-6971"></a>  <span class="n">SecInTimeStep</span> <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-6972"></a>  <span class="n">NumNodes</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-6973"></a>
<a name="ln-6974"></a>  <span class="n">AmbientTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span>
<a name="ln-6975"></a>  <span class="n">UseInletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span>
<a name="ln-6976"></a>  <span class="n">SourceInletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>
<a name="ln-6977"></a>
<a name="ln-6978"></a>  <span class="n">SetPointTemp1</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetPointTemp</span>
<a name="ln-6979"></a>  <span class="n">MinTemp1</span> <span class="o">=</span> <span class="n">SetPointTemp1</span> <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span>
<a name="ln-6980"></a>  <span class="n">SetPointTemp2</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetPointTemp2</span>
<a name="ln-6981"></a>  <span class="n">MinTemp2</span> <span class="o">=</span> <span class="n">SetPointTemp2</span> <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp2</span>
<a name="ln-6982"></a>  <span class="n">MaxTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span>
<a name="ln-6983"></a>
<a name="ln-6984"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6985"></a><span class="k">    </span><span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6986"></a>                         <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6987"></a>                         <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6988"></a>                         <span class="s1">&#39;CalcWaterThermalTankStratified&#39;</span><span class="p">)</span>
<a name="ln-6989"></a>  <span class="k">ELSE</span>
<a name="ln-6990"></a><span class="k">    </span><span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6991"></a>                                    <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;CalcWaterThermalTankStratified&#39;</span><span class="p">)</span>
<a name="ln-6992"></a>  <span class="n">ENDIF</span>
<a name="ln-6993"></a>
<a name="ln-6994"></a>  <span class="n">TempUp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6995"></a>  <span class="n">TempDn</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6996"></a>  <span class="n">Eloss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6997"></a>  <span class="n">Elosszone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6998"></a>  <span class="n">Euse</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6999"></a>  <span class="n">Esource</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7000"></a>  <span class="n">Eheater1</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7001"></a>  <span class="n">Eheater2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7002"></a>  <span class="n">Event</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7003"></a>  <span class="n">Eneeded</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7004"></a>  <span class="n">Eunmet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7005"></a>  <span class="n">Efuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7006"></a>  <span class="n">Eoncycfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7007"></a>  <span class="n">Eoffcycfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7008"></a>  <span class="n">CycleOnCount1</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7009"></a>  <span class="n">CycleOnCount2</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7010"></a>  <span class="n">Runtime</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7011"></a>  <span class="n">Runtime1</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7012"></a>  <span class="n">Runtime2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7013"></a>  <span class="n">SetPointRecovered</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7014"></a>
<a name="ln-7015"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletMode</span> <span class="o">==</span> <span class="n">InletModeFixed</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-7016"></a>     <span class="k">CALL </span><span class="n">CalcNodeMassFlows</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">InletModeFixed</span><span class="p">)</span>
<a name="ln-7017"></a>
<a name="ln-7018"></a>  <span class="n">TimeRemaining</span> <span class="o">=</span> <span class="n">SecInTimeStep</span>
<a name="ln-7019"></a>  <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">TimeRemaining</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7020"></a>
<a name="ln-7021"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InletMode</span> <span class="o">==</span> <span class="n">InletModeSeeking</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-7022"></a>       <span class="k">CALL </span><span class="n">CalcNodeMassFlows</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">InletModeSeeking</span><span class="p">)</span>
<a name="ln-7023"></a>
<a name="ln-7024"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7025"></a>
<a name="ln-7026"></a>      <span class="c">! Control the first heater element (master)</span>
<a name="ln-7027"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7028"></a><span class="k">        </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode1</span>
<a name="ln-7029"></a>        <span class="n">NodeTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7030"></a>
<a name="ln-7031"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7032"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">NodeTemp</span> <span class="o">&gt;=</span> <span class="n">SetPointTemp1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7033"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7034"></a>            <span class="n">SetPointRecovered</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7035"></a>          <span class="k">END IF</span>
<a name="ln-7036"></a><span class="k">        ELSE</span>  <span class="c">! Heater is off</span>
<a name="ln-7037"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NodeTemp</span> <span class="o">&lt;</span> <span class="n">MinTemp1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7038"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7039"></a>            <span class="n">CycleOnCount1</span> <span class="o">=</span> <span class="n">CycleOnCount1</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7040"></a>          <span class="k">END IF</span>
<a name="ln-7041"></a><span class="k">        END IF</span>
<a name="ln-7042"></a><span class="k">      END IF</span>
<a name="ln-7043"></a>
<a name="ln-7044"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7045"></a><span class="k">        </span><span class="n">Qheater1</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-7046"></a>        <span class="n">Runtime1</span> <span class="o">=</span> <span class="n">Runtime1</span> <span class="o">+</span> <span class="n">dt</span>
<a name="ln-7047"></a>      <span class="k">ELSE</span>
<a name="ln-7048"></a><span class="k">        </span><span class="n">Qheater1</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-7049"></a>      <span class="k">END IF</span>
<a name="ln-7050"></a>
<a name="ln-7051"></a>      <span class="c">! Control the second heater element (slave)</span>
<a name="ln-7052"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity2</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7053"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">PriorityMasterSlave</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-7054"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7055"></a><span class="k">          </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7056"></a>
<a name="ln-7057"></a>        <span class="k">ELSE</span>
<a name="ln-7058"></a><span class="k">          </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode2</span>
<a name="ln-7059"></a>          <span class="n">NodeTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7060"></a>
<a name="ln-7061"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7062"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">NodeTemp</span> <span class="o">&gt;=</span> <span class="n">SetPointTemp2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7063"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7064"></a>              <span class="n">SetPointRecovered</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7065"></a>            <span class="k">END IF</span>
<a name="ln-7066"></a><span class="k">          ELSE</span>  <span class="c">! Heater is off</span>
<a name="ln-7067"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">NodeTemp</span> <span class="o">&lt;</span> <span class="n">MinTemp2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7068"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7069"></a>              <span class="n">CycleOnCount2</span> <span class="o">=</span> <span class="n">CycleOnCount2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7070"></a>            <span class="k">END IF</span>
<a name="ln-7071"></a><span class="k">          END IF</span>
<a name="ln-7072"></a><span class="k">        END IF</span>
<a name="ln-7073"></a><span class="k">      END IF</span>
<a name="ln-7074"></a>
<a name="ln-7075"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7076"></a><span class="k">        </span><span class="n">Qheater2</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity2</span>
<a name="ln-7077"></a>        <span class="n">Runtime2</span> <span class="o">=</span> <span class="n">Runtime2</span> <span class="o">+</span> <span class="n">dt</span>
<a name="ln-7078"></a>      <span class="k">ELSE</span>
<a name="ln-7079"></a><span class="k">        </span><span class="n">Qheater2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7080"></a>      <span class="k">END IF</span>
<a name="ln-7081"></a><span class="k">    ELSE</span> <span class="c">! chilled water thank, no heating</span>
<a name="ln-7082"></a>
<a name="ln-7083"></a>      <span class="n">Qheater1</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-7084"></a>      <span class="n">Qheater2</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-7085"></a>
<a name="ln-7086"></a>    <span class="n">ENDIF</span>
<a name="ln-7087"></a>
<a name="ln-7088"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7089"></a><span class="k">      </span><span class="n">Runtime</span> <span class="o">=</span> <span class="n">Runtime</span> <span class="o">+</span> <span class="n">dt</span>
<a name="ln-7090"></a>
<a name="ln-7091"></a>      <span class="n">Qfuel</span> <span class="o">=</span> <span class="p">(</span><span class="n">Qheater1</span> <span class="o">+</span> <span class="n">Qheater2</span><span class="p">)</span> <span class="o">/</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span>
<a name="ln-7092"></a>      <span class="n">Qoncycfuel</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>
<a name="ln-7093"></a>      <span class="n">Qoffcycfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7094"></a>    <span class="k">ELSE</span>
<a name="ln-7095"></a><span class="k">      </span><span class="n">Qfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7096"></a>      <span class="n">Qoncycfuel</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7097"></a>      <span class="n">Qoffcycfuel</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span>
<a name="ln-7098"></a>    <span class="k">END IF</span>
<a name="ln-7099"></a>
<a name="ln-7100"></a>    <span class="c">! Loop through all nodes and simulate heat balance</span>
<a name="ln-7101"></a>    <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumNodes</span>
<a name="ln-7102"></a>      <span class="n">NodeMass</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Mass</span>
<a name="ln-7103"></a>      <span class="n">NodeTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7104"></a>
<a name="ln-7105"></a>      <span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-7106"></a>         <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span>
<a name="ln-7107"></a>      <span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span>  <span class="p">&amp;</span>
<a name="ln-7108"></a>        <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span>
<a name="ln-7109"></a>
<a name="ln-7110"></a>      <span class="c">! Heat transfer due to fluid flow entering an inlet node</span>
<a name="ln-7111"></a>      <span class="n">Quse</span> <span class="o">=</span> <span class="n">UseMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">UseInletTemp</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span>
<a name="ln-7112"></a>      <span class="n">Qsource</span> <span class="o">=</span> <span class="n">SourceMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">SourceInletTemp</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span>
<a name="ln-7113"></a>
<a name="ln-7114"></a>      <span class="n">InvMixUp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7115"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7116"></a><span class="k">        </span><span class="n">TempUp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7117"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TempUp</span> <span class="o">&lt;</span> <span class="n">NodeTemp</span><span class="p">)</span> <span class="n">InvMixUp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InversionMixingRate</span>
<a name="ln-7118"></a>      <span class="k">END IF</span>
<a name="ln-7119"></a>
<a name="ln-7120"></a><span class="k">      </span><span class="n">InvMixDn</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7121"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">&lt;</span> <span class="n">NumNodes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7122"></a><span class="k">        </span><span class="n">TempDn</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7123"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TempDn</span> <span class="o">&gt;</span> <span class="n">NodeTemp</span><span class="p">)</span> <span class="n">InvMixDn</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">InversionMixingRate</span>
<a name="ln-7124"></a>      <span class="k">END IF</span>
<a name="ln-7125"></a>
<a name="ln-7126"></a>      <span class="c">! Heat transfer due to vertical conduction between nodes</span>
<a name="ln-7127"></a>      <span class="n">Qcond</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">CondCoeffUp</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempUp</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-7128"></a>        <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">CondCoeffDn</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempDn</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span>
<a name="ln-7129"></a>
<a name="ln-7130"></a>      <span class="c">! Heat transfer due to fluid flow between inlet and outlet nodes</span>
<a name="ln-7131"></a>      <span class="n">Qflow</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromUpper</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempUp</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-7132"></a>        <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromLower</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempDn</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span>
<a name="ln-7133"></a>
<a name="ln-7134"></a>      <span class="c">! Heat transfer due to temperature inversion mixing between nodes</span>
<a name="ln-7135"></a>      <span class="n">Qmix</span> <span class="o">=</span> <span class="n">InvMixUp</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempUp</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span> <span class="o">+</span> <span class="n">InvMixDn</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempDn</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span>
<a name="ln-7136"></a>
<a name="ln-7137"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7138"></a><span class="k">        </span><span class="n">LossCoeff</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OnCycLossCoeff</span>
<a name="ln-7139"></a>        <span class="n">Qloss</span> <span class="o">=</span> <span class="n">LossCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">AmbientTemp</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span>
<a name="ln-7140"></a>        <span class="n">Qlosszone</span> <span class="o">=</span> <span class="n">Qloss</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossFracToZone</span>
<a name="ln-7141"></a>        <span class="n">Qoncycheat</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-7142"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span>
<a name="ln-7143"></a>
<a name="ln-7144"></a>        <span class="n">Qneeded</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="o">-</span> <span class="n">Quse</span> <span class="o">-</span> <span class="n">Qsource</span> <span class="o">-</span> <span class="n">Qloss</span> <span class="o">-</span> <span class="n">Qoncycheat</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7145"></a>
<a name="ln-7146"></a>        <span class="n">Qheat</span> <span class="o">=</span> <span class="n">Qoncycheat</span>
<a name="ln-7147"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">==</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode1</span><span class="p">)</span> <span class="n">Qheat</span> <span class="o">=</span> <span class="n">Qheat</span> <span class="o">+</span> <span class="n">Qheater1</span>
<a name="ln-7148"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">==</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode2</span><span class="p">)</span> <span class="n">Qheat</span> <span class="o">=</span> <span class="n">Qheat</span> <span class="o">+</span> <span class="n">Qheater2</span>
<a name="ln-7149"></a>      <span class="k">ELSE</span>
<a name="ln-7150"></a><span class="k">        </span><span class="n">LossCoeff</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OffCycLossCoeff</span>
<a name="ln-7151"></a>        <span class="n">Qloss</span> <span class="o">=</span> <span class="n">LossCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">AmbientTemp</span> <span class="o">-</span> <span class="n">NodeTemp</span><span class="p">)</span>
<a name="ln-7152"></a>        <span class="n">Qlosszone</span> <span class="o">=</span> <span class="n">Qloss</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SkinLossFracToZone</span>
<a name="ln-7153"></a>        <span class="n">Qoffcycheat</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-7154"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span>
<a name="ln-7155"></a>
<a name="ln-7156"></a>        <span class="n">Qneeded</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="o">-</span> <span class="n">Quse</span> <span class="o">-</span> <span class="n">Qsource</span> <span class="o">-</span> <span class="n">Qloss</span> <span class="o">-</span> <span class="n">Qoffcycheat</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7157"></a>        <span class="n">Qheat</span> <span class="o">=</span> <span class="n">Qoffcycheat</span>
<a name="ln-7158"></a>      <span class="k">END IF</span>
<a name="ln-7159"></a>
<a name="ln-7160"></a><span class="k">      </span><span class="n">Qunmet</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Qneeded</span> <span class="o">-</span> <span class="n">Qheater1</span> <span class="o">-</span> <span class="n">Qheater2</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7161"></a>
<a name="ln-7162"></a>      <span class="c">! Calculate node heat balance</span>
<a name="ln-7163"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">NewTemp</span> <span class="o">=</span> <span class="n">NodeTemp</span>  <span class="p">&amp;</span>
<a name="ln-7164"></a>        <span class="o">+</span> <span class="p">(</span><span class="n">Quse</span> <span class="o">+</span> <span class="n">Qsource</span> <span class="o">+</span> <span class="n">Qcond</span> <span class="o">+</span> <span class="n">Qflow</span> <span class="o">+</span> <span class="n">Qmix</span> <span class="o">+</span> <span class="n">Qloss</span> <span class="o">+</span> <span class="n">Qheat</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="n">NodeMass</span> <span class="o">*</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-7165"></a>
<a name="ln-7166"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7167"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">NodeNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">NewTemp</span> <span class="o">&gt;</span> <span class="n">MaxTemp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7168"></a><span class="k">          </span><span class="n">Event</span> <span class="o">=</span> <span class="n">Event</span> <span class="o">+</span> <span class="n">NodeMass</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">(</span><span class="n">MaxTemp</span> <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">NewTemp</span><span class="p">)</span>
<a name="ln-7169"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">NewTemp</span> <span class="o">=</span> <span class="n">MaxTemp</span>
<a name="ln-7170"></a>        <span class="k">END IF</span>
<a name="ln-7171"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-7172"></a>
<a name="ln-7173"></a>      <span class="n">Euse</span> <span class="o">=</span> <span class="n">Euse</span> <span class="o">+</span> <span class="n">Quse</span> <span class="o">*</span> <span class="n">dt</span>
<a name="ln-7174"></a>      <span class="n">Esource</span> <span class="o">=</span> <span class="n">Esource</span> <span class="o">+</span> <span class="n">Qsource</span> <span class="o">*</span> <span class="n">dt</span>
<a name="ln-7175"></a>      <span class="n">Eloss</span> <span class="o">=</span> <span class="n">Eloss</span> <span class="o">+</span> <span class="n">Qloss</span> <span class="o">*</span> <span class="n">dt</span>
<a name="ln-7176"></a>      <span class="n">Elosszone</span> <span class="o">=</span> <span class="n">Elosszone</span> <span class="o">+</span> <span class="n">Qlosszone</span> <span class="o">*</span> <span class="n">dt</span>
<a name="ln-7177"></a>      <span class="n">Eneeded</span> <span class="o">=</span> <span class="n">Eneeded</span> <span class="o">+</span> <span class="n">Qneeded</span> <span class="o">*</span> <span class="n">dt</span>
<a name="ln-7178"></a>      <span class="n">Eunmet</span> <span class="o">=</span> <span class="n">Eunmet</span> <span class="o">+</span> <span class="n">Qunmet</span> <span class="o">*</span> <span class="n">dt</span>
<a name="ln-7179"></a>
<a name="ln-7180"></a>    <span class="k">END DO</span>  <span class="c">! NodeNum</span>
<a name="ln-7181"></a>
<a name="ln-7182"></a>    <span class="c">! Calculation for standard ratings</span>
<a name="ln-7183"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7184"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryFuel</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryFuel</span> <span class="p">&amp;</span>
<a name="ln-7185"></a>          <span class="o">+</span> <span class="p">(</span><span class="n">Qfuel</span> <span class="o">+</span> <span class="n">Qoffcycfuel</span> <span class="o">+</span> <span class="n">Qoncycfuel</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
<a name="ln-7186"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SetpointRecovered</span><span class="p">)</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryDone</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7187"></a>    <span class="k">END IF</span>
<a name="ln-7188"></a>
<a name="ln-7189"></a>    <span class="c">! Update node temperatures</span>
<a name="ln-7190"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">NewTemp</span>
<a name="ln-7191"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">TempSum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">TempSum</span>  <span class="p">&amp;</span>
<a name="ln-7192"></a>      <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span> <span class="o">*</span> <span class="n">dt</span>
<a name="ln-7193"></a>
<a name="ln-7194"></a>    <span class="n">TimeRemaining</span> <span class="o">=</span> <span class="n">TimeRemaining</span> <span class="o">-</span> <span class="n">dt</span>
<a name="ln-7195"></a>
<a name="ln-7196"></a>  <span class="k">END DO</span>  <span class="c">! TimeRemaining &gt; 0.0</span>
<a name="ln-7197"></a>
<a name="ln-7198"></a>  <span class="n">Eheater1</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">*</span> <span class="n">Runtime1</span>
<a name="ln-7199"></a>  <span class="n">Eheater2</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity2</span> <span class="o">*</span> <span class="n">Runtime2</span>
<a name="ln-7200"></a>  <span class="n">Efuel</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eheater1</span> <span class="o">+</span> <span class="n">Eheater2</span><span class="p">)</span> <span class="o">/</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span>
<a name="ln-7201"></a>  <span class="n">Eoffcycfuel</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">*</span> <span class="p">(</span><span class="n">SecInTimeStep</span> <span class="o">-</span> <span class="n">Runtime</span><span class="p">)</span>
<a name="ln-7202"></a>  <span class="n">Eoncycfuel</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="o">*</span> <span class="n">Runtime</span>
<a name="ln-7203"></a>
<a name="ln-7204"></a>  <span class="c">! Calculate average values over the time step based on summed values, Q &gt; 0 is a gain to the tank,  Q &lt; 0 is a loss to the tank</span>
<a name="ln-7205"></a>  <span class="n">Qloss</span> <span class="o">=</span> <span class="n">Eloss</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7206"></a>  <span class="n">Qlosszone</span> <span class="o">=</span> <span class="n">Elosszone</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7207"></a>  <span class="n">Quse</span> <span class="o">=</span> <span class="n">Euse</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7208"></a>  <span class="n">Qsource</span> <span class="o">=</span> <span class="n">Esource</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7209"></a>  <span class="n">Qheater1</span> <span class="o">=</span> <span class="n">Eheater1</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7210"></a>  <span class="n">Qheater2</span> <span class="o">=</span> <span class="n">Eheater2</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7211"></a>  <span class="n">Qheater</span> <span class="o">=</span> <span class="n">Qheater1</span> <span class="o">+</span> <span class="n">Qheater2</span>
<a name="ln-7212"></a>  <span class="n">Qoffcycfuel</span> <span class="o">=</span> <span class="n">Eoffcycfuel</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7213"></a>  <span class="n">Qoffcycheat</span> <span class="o">=</span> <span class="n">Qoffcycfuel</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span>
<a name="ln-7214"></a>  <span class="n">Qoncycfuel</span> <span class="o">=</span> <span class="n">Eoncycfuel</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7215"></a>  <span class="n">Qoncycheat</span> <span class="o">=</span> <span class="n">Qoncycfuel</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span>
<a name="ln-7216"></a>  <span class="n">Qvent</span> <span class="o">=</span> <span class="n">Event</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7217"></a>  <span class="n">Qneeded</span> <span class="o">=</span> <span class="n">Eneeded</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7218"></a>  <span class="n">Qunmet</span> <span class="o">=</span> <span class="n">Eunmet</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7219"></a>  <span class="n">RTF</span> <span class="o">=</span> <span class="n">Runtime</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7220"></a>  <span class="n">RTF1</span> <span class="o">=</span> <span class="n">Runtime1</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7221"></a>  <span class="n">RTF2</span> <span class="o">=</span> <span class="n">Runtime2</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7222"></a>  <span class="n">Qfuel</span> <span class="o">=</span> <span class="n">Efuel</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7223"></a>
<a name="ln-7224"></a>  <span class="c">! Calculate average node temperatures over the time step</span>
<a name="ln-7225"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">TempAvg</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">TempSum</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-7226"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">TempSum</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Reset for next time step</span>
<a name="ln-7227"></a>
<a name="ln-7228"></a>  <span class="c">! Calculate instantaneous and average tank temperature (all nodes have equal mass)</span>
<a name="ln-7229"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span> <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span><span class="p">)</span> <span class="o">/</span> <span class="n">NumNodes</span>
<a name="ln-7230"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempAvg</span> <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">TempAvg</span><span class="p">)</span> <span class="o">/</span> <span class="n">NumNodes</span>
<a name="ln-7231"></a>
<a name="ln-7232"></a>  <span class="n">NodeNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletStratNode</span>
<a name="ln-7233"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">TempAvg</span>
<a name="ln-7234"></a>  <span class="c">! Revised use outlet temperature to ensure energy balance. Assumes a constant CP. CR8341/CR8570</span>
<a name="ln-7235"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7236"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7237"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span> <span class="o">=</span>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span>     <span class="p">&amp;</span>
<a name="ln-7238"></a>                                                          <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-7239"></a>                                                          <span class="o">+</span>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span>   <span class="p">&amp;</span>
<a name="ln-7240"></a>                                                          <span class="o">*</span>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span>
<a name="ln-7241"></a>    <span class="k">End If</span>
<a name="ln-7242"></a><span class="k">  End If</span>
<a name="ln-7243"></a><span class="k">  </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletStratNode</span>
<a name="ln-7244"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-7245"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">TempAvg</span>
<a name="ln-7246"></a>  <span class="c">! Revised use outlet temperature to ensure energy balance. Assumes a constant CP. CR8341/CR8570</span>
<a name="ln-7247"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NodeNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7248"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7249"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span> <span class="o">=</span>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>     <span class="p">&amp;</span>
<a name="ln-7250"></a>                                                       <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-7251"></a>                                                       <span class="o">+</span>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>   <span class="p">&amp;</span>
<a name="ln-7252"></a>                                                       <span class="o">*</span>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span>
<a name="ln-7253"></a>    <span class="k">End If</span>
<a name="ln-7254"></a><span class="k">  End If</span>
<a name="ln-7255"></a>
<a name="ln-7256"></a><span class="k">  </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">LossRate</span> <span class="o">=</span> <span class="n">Qloss</span>
<a name="ln-7257"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseRate</span> <span class="o">=</span> <span class="n">Quse</span>
<a name="ln-7258"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceRate</span> <span class="o">=</span> <span class="n">Qsource</span>
<a name="ln-7259"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaRateToTank</span> <span class="o">=</span> <span class="n">Qoffcycheat</span>
<a name="ln-7260"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaRateToTank</span> <span class="o">=</span> <span class="n">Qoncycheat</span>
<a name="ln-7261"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TotalDemandRate</span> <span class="o">=</span> <span class="o">-</span><span class="n">Quse</span> <span class="o">-</span> <span class="n">Qsource</span> <span class="o">-</span> <span class="n">Qloss</span> <span class="o">-</span> <span class="n">Qoffcycheat</span> <span class="o">-</span> <span class="n">Qoncycheat</span>
<a name="ln-7262"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate</span> <span class="o">=</span> <span class="n">Qheater</span>
<a name="ln-7263"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate1</span> <span class="o">=</span> <span class="n">Qheater1</span>
<a name="ln-7264"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate2</span> <span class="o">=</span> <span class="n">Qheater2</span>
<a name="ln-7265"></a>
<a name="ln-7266"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UnmetRate</span> <span class="o">=</span> <span class="n">Qunmet</span>
<a name="ln-7267"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VentRate</span> <span class="o">=</span> <span class="n">Qvent</span>
<a name="ln-7268"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">NetHeatTransferRate</span> <span class="o">=</span> <span class="n">Quse</span> <span class="o">+</span> <span class="n">Qsource</span> <span class="o">+</span> <span class="n">Qloss</span> <span class="o">+</span> <span class="n">Qoffcycheat</span> <span class="o">+</span> <span class="n">Qoncycheat</span> <span class="o">+</span> <span class="n">Qheater</span> <span class="o">+</span> <span class="n">Qvent</span>
<a name="ln-7269"></a>
<a name="ln-7270"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">CycleOnCount</span> <span class="o">=</span> <span class="n">CycleOnCount1</span> <span class="o">+</span> <span class="n">CycleOnCount2</span>
<a name="ln-7271"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">CycleOnCount1</span> <span class="o">=</span> <span class="n">CycleOnCount1</span>
<a name="ln-7272"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">CycleOnCount2</span> <span class="o">=</span> <span class="n">CycleOnCount2</span>
<a name="ln-7273"></a>
<a name="ln-7274"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="n">RTF</span>
<a name="ln-7275"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">RuntimeFraction1</span> <span class="o">=</span> <span class="n">RTF1</span>
<a name="ln-7276"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">RuntimeFraction2</span> <span class="o">=</span> <span class="n">RTF2</span>
<a name="ln-7277"></a>
<a name="ln-7278"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelRate</span> <span class="o">=</span> <span class="n">Qfuel</span>
<a name="ln-7279"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span> <span class="o">=</span> <span class="n">Qoffcycfuel</span>
<a name="ln-7280"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span> <span class="o">=</span> <span class="n">Qoncycfuel</span>
<a name="ln-7281"></a>
<a name="ln-7282"></a>  <span class="c">! Add water heater skin losses and venting losses to ambient zone, if specified</span>
<a name="ln-7283"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTempZone</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-7284"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientZoneGain</span> <span class="o">=</span> <span class="o">-</span><span class="n">Qlosszone</span> <span class="o">-</span> <span class="n">Qvent</span>
<a name="ln-7285"></a>
<a name="ln-7286"></a>  <span class="k">RETURN</span>
<a name="ln-7287"></a>
<a name="ln-7288"></a><span class="k">END SUBROUTINE </span><span class="n">CalcWaterThermalTankStratified</span>
<a name="ln-7289"></a>
<a name="ln-7290"></a>
<a name="ln-7291"></a><span class="k">SUBROUTINE </span><span class="n">CalcNodeMassFlows</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">InletMode</span><span class="p">)</span>
<a name="ln-7292"></a>
<a name="ln-7293"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7294"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-7295"></a>          <span class="c">!       DATE WRITTEN   January 2007</span>
<a name="ln-7296"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7297"></a>          <span class="c">!</span>
<a name="ln-7298"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7299"></a>
<a name="ln-7300"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7301"></a>          <span class="c">! Determines mass flow rates between nodes according to the locations of the use- and source-side inlet and outlet</span>
<a name="ln-7302"></a>          <span class="c">! nodes.</span>
<a name="ln-7303"></a>
<a name="ln-7304"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7305"></a>          <span class="c">! In &#39;Seeking&#39; mode, nodes are searched between the user-specified inlet and outlet nodes to find the node closest</span>
<a name="ln-7306"></a>          <span class="c">! in temperature to the inlet fluid temperature.  In &#39;Fixed&#39; mode, the user-specified nodes are always used.</span>
<a name="ln-7307"></a>          <span class="c">! Upward and downward flows are added to each node between an inlet and outlet.  Flows in both directions cancel out</span>
<a name="ln-7308"></a>          <span class="c">! to leave only the net flow in one direction.</span>
<a name="ln-7309"></a>
<a name="ln-7310"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7311"></a>          <span class="c">! na</span>
<a name="ln-7312"></a>
<a name="ln-7313"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7314"></a>
<a name="ln-7315"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7316"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>      <span class="c">! Water Heater being simulated</span>
<a name="ln-7317"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletMode</span>           <span class="c">! InletModeFixed or InletModeSeeking</span>
<a name="ln-7318"></a>
<a name="ln-7319"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7320"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNodes</span>               <span class="c">! Number of stratified nodes</span>
<a name="ln-7321"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UseInletStratNode</span>      <span class="c">! Use-side inlet node number</span>
<a name="ln-7322"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UseOutletStratNode</span>     <span class="c">! Use-side outlet node number</span>
<a name="ln-7323"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SourceInletStratNode</span>   <span class="c">! Source-side inlet node number</span>
<a name="ln-7324"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SourceOutletStratNode</span>  <span class="c">! Source-side outlet node number</span>
<a name="ln-7325"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NodeNum</span>                <span class="c">! Node number index</span>
<a name="ln-7326"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UseMassFlowRate</span>           <span class="c">! Use side flow rate, including effectiveness factor (kg/s)</span>
<a name="ln-7327"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SourceMassFlowRate</span>        <span class="c">! Source side flow rate, including effectiveness factor (kg/s)</span>
<a name="ln-7328"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Step</span>                   <span class="c">! DO loop step direction, 1 or -1</span>
<a name="ln-7329"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTemp</span>                 <span class="c">! Temperature difference between node and inlet (delta C)</span>
<a name="ln-7330"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinDeltaTemp</span>              <span class="c">! Smallest temperature difference found so far (delta C)</span>
<a name="ln-7331"></a>
<a name="ln-7332"></a>          <span class="c">! FLOW:</span>
<a name="ln-7333"></a>  <span class="n">NumNodes</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span>
<a name="ln-7334"></a>
<a name="ln-7335"></a>  <span class="n">UseInletStratNode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletStratNode</span>
<a name="ln-7336"></a>  <span class="n">UseOutletStratNode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletStratNode</span>
<a name="ln-7337"></a>  <span class="n">SourceInletStratNode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletStratNode</span>
<a name="ln-7338"></a>  <span class="n">SourceOutletStratNode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletStratNode</span>
<a name="ln-7339"></a>
<a name="ln-7340"></a>  <span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-7341"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span>
<a name="ln-7342"></a>  <span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-7343"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span>
<a name="ln-7344"></a>
<a name="ln-7345"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7346"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7347"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">MassFlowFromUpper</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7348"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">MassFlowFromLower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7349"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">MassFlowToUpper</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7350"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">MassFlowToLower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7351"></a>
<a name="ln-7352"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">InletMode</span> <span class="o">==</span> <span class="n">InletModeSeeking</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7353"></a>    <span class="c">! &#39;Seek&#39; the node with the temperature closest to the inlet temperature</span>
<a name="ln-7354"></a>    <span class="c">! Start at the user-specified inlet node and search to the user-specified outlet node</span>
<a name="ln-7355"></a>
<a name="ln-7356"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">UseMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7357"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UseInletStratNode</span> <span class="o">&gt;</span> <span class="n">UseOutletStratNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7358"></a><span class="k">        </span><span class="n">Step</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-7359"></a>      <span class="k">ELSE</span>
<a name="ln-7360"></a><span class="k">        </span><span class="n">Step</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7361"></a>      <span class="k">END IF</span>
<a name="ln-7362"></a><span class="k">      </span><span class="n">MinDeltaTemp</span> <span class="o">=</span> <span class="mf">1.0d6</span>  <span class="c">! Some big number</span>
<a name="ln-7363"></a>      <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">UseInletStratNode</span><span class="p">,</span> <span class="n">UseOutletStratNode</span><span class="p">,</span> <span class="n">Step</span>
<a name="ln-7364"></a>        <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span>   <span class="p">&amp;</span>
<a name="ln-7365"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span><span class="p">)</span>
<a name="ln-7366"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="n">MinDeltaTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7367"></a><span class="k">          </span><span class="n">MinDeltaTemp</span> <span class="o">=</span> <span class="n">DeltaTemp</span>
<a name="ln-7368"></a>          <span class="n">UseInletStratNode</span> <span class="o">=</span> <span class="n">NodeNum</span>
<a name="ln-7369"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="n">MinDeltaTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7370"></a><span class="k">          EXIT</span>
<a name="ln-7371"></a><span class="k">        END IF</span>
<a name="ln-7372"></a><span class="k">      END DO</span>
<a name="ln-7373"></a><span class="k">    END IF</span>
<a name="ln-7374"></a>
<a name="ln-7375"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SourceMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7376"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SourceInletStratNode</span> <span class="o">&gt;</span> <span class="n">SourceOutletStratNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7377"></a><span class="k">        </span><span class="n">Step</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-7378"></a>      <span class="k">ELSE</span>
<a name="ln-7379"></a><span class="k">        </span><span class="n">Step</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7380"></a>      <span class="k">END IF</span>
<a name="ln-7381"></a><span class="k">      </span><span class="n">MinDeltaTemp</span> <span class="o">=</span> <span class="mf">1.0d6</span>  <span class="c">! Some big number</span>
<a name="ln-7382"></a>      <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">SourceInletStratNode</span><span class="p">,</span> <span class="n">SourceOutletStratNode</span><span class="p">,</span> <span class="n">Step</span>
<a name="ln-7383"></a>        <span class="n">DeltaTemp</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span>   <span class="p">&amp;</span>
<a name="ln-7384"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span><span class="p">)</span>
<a name="ln-7385"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&lt;</span> <span class="n">MinDeltaTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7386"></a><span class="k">          </span><span class="n">MinDeltaTemp</span> <span class="o">=</span> <span class="n">DeltaTemp</span>
<a name="ln-7387"></a>          <span class="n">SourceInletStratNode</span> <span class="o">=</span> <span class="n">NodeNum</span>
<a name="ln-7388"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">DeltaTemp</span> <span class="o">&gt;</span> <span class="n">MinDeltaTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7389"></a><span class="k">          EXIT</span>
<a name="ln-7390"></a><span class="k">        END IF</span>
<a name="ln-7391"></a><span class="k">      END DO</span>
<a name="ln-7392"></a><span class="k">    END IF</span>
<a name="ln-7393"></a>
<a name="ln-7394"></a><span class="k">  END IF</span>
<a name="ln-7395"></a>
<a name="ln-7396"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">UseInletStratNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-7397"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">UseInletStratNode</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="n">UseMassFlowRate</span>
<a name="ln-7398"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SourceInletStratNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-7399"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">SourceInletStratNode</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">SourceMassFlowRate</span>
<a name="ln-7400"></a>
<a name="ln-7401"></a>
<a name="ln-7402"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UseMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7403"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UseOutletStratNode</span> <span class="o">&gt;</span> <span class="n">UseInletStratNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7404"></a>      <span class="c">! Use-side flow is down</span>
<a name="ln-7405"></a>      <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">UseInletStratNode</span><span class="p">,</span> <span class="n">UseOutletStratNode</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-7406"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToLower</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7407"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToLower</span> <span class="o">+</span> <span class="n">UseMassFlowRate</span>
<a name="ln-7408"></a>      <span class="k">END DO</span>
<a name="ln-7409"></a><span class="k">      DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">UseInletStratNode</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">UseOutletStratNode</span>
<a name="ln-7410"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromUpper</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7411"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromUpper</span> <span class="o">+</span> <span class="n">UseMassFlowRate</span>
<a name="ln-7412"></a>      <span class="k">END DO</span>
<a name="ln-7413"></a>
<a name="ln-7414"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">UseOutletStratNode</span> <span class="o">&lt;</span> <span class="n">UseInletStratNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7415"></a>      <span class="c">! Use-side flow is up</span>
<a name="ln-7416"></a>      <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">UseOutletStratNode</span><span class="p">,</span> <span class="n">UseInletStratNode</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-7417"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromLower</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7418"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromLower</span> <span class="o">+</span> <span class="n">UseMassFlowRate</span>
<a name="ln-7419"></a>      <span class="k">END DO</span>
<a name="ln-7420"></a><span class="k">      DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">UseOutletStratNode</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">UseInletStratNode</span>
<a name="ln-7421"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToUpper</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7422"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToUpper</span> <span class="o">+</span> <span class="n">UseMassFlowRate</span>
<a name="ln-7423"></a>      <span class="k">END DO</span>
<a name="ln-7424"></a>
<a name="ln-7425"></a><span class="k">    ELSE</span>
<a name="ln-7426"></a>      <span class="c">! Use-side flow is across the node; no flow to other nodes</span>
<a name="ln-7427"></a>    <span class="k">END IF</span>
<a name="ln-7428"></a><span class="k">  END IF</span>
<a name="ln-7429"></a>
<a name="ln-7430"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SourceMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7431"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SourceOutletStratNode</span> <span class="o">&gt;</span> <span class="n">SourceInletStratNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7432"></a>      <span class="c">! Source-side flow is down</span>
<a name="ln-7433"></a>      <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">SourceInletStratNode</span><span class="p">,</span> <span class="n">SourceOutletStratNode</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-7434"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToLower</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7435"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToLower</span> <span class="o">+</span> <span class="n">SourceMassFlowRate</span>
<a name="ln-7436"></a>      <span class="k">END DO</span>
<a name="ln-7437"></a><span class="k">      DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">SourceInletStratNode</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SourceOutletStratNode</span>
<a name="ln-7438"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromUpper</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7439"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromUpper</span> <span class="o">+</span> <span class="n">SourceMassFlowRate</span>
<a name="ln-7440"></a>      <span class="k">END DO</span>
<a name="ln-7441"></a>
<a name="ln-7442"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">SourceOutletStratNode</span> <span class="o">&lt;</span> <span class="n">SourceInletStratNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7443"></a>      <span class="c">! Source-side flow is up</span>
<a name="ln-7444"></a>      <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">SourceOutletStratNode</span><span class="p">,</span> <span class="n">SourceInletStratNode</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-7445"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromLower</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7446"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromLower</span> <span class="o">+</span> <span class="n">SourceMassFlowRate</span>
<a name="ln-7447"></a>      <span class="k">END DO</span>
<a name="ln-7448"></a><span class="k">      DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="n">SourceOutletStratNode</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SourceInletStratNode</span>
<a name="ln-7449"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToUpper</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7450"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToUpper</span> <span class="o">+</span> <span class="n">SourceMassFlowRate</span>
<a name="ln-7451"></a>      <span class="k">END DO</span>
<a name="ln-7452"></a>
<a name="ln-7453"></a><span class="k">    ELSE</span>
<a name="ln-7454"></a>      <span class="c">! Source-side flow is across the node; no flow to other nodes</span>
<a name="ln-7455"></a>    <span class="k">END IF</span>
<a name="ln-7456"></a><span class="k">  END IF</span>
<a name="ln-7457"></a>
<a name="ln-7458"></a>  <span class="c">! Cancel out any up and down flows</span>
<a name="ln-7459"></a>  <span class="k">DO </span><span class="n">NodeNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumNodes</span>
<a name="ln-7460"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromUpper</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7461"></a>      <span class="nb">MAX</span><span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromUpper</span>  <span class="p">&amp;</span>
<a name="ln-7462"></a>      <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToUpper</span><span class="p">),</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7463"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromLower</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-7464"></a>      <span class="nb">MAX</span><span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowFromLower</span>  <span class="p">&amp;</span>
<a name="ln-7465"></a>      <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">NodeNum</span><span class="p">)%</span><span class="n">MassFlowToLower</span><span class="p">),</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7466"></a>  <span class="k">END DO</span>
<a name="ln-7467"></a>
<a name="ln-7468"></a><span class="k">  RETURN</span>
<a name="ln-7469"></a>
<a name="ln-7470"></a><span class="k">END SUBROUTINE </span><span class="n">CalcNodeMassFlows</span>
<a name="ln-7471"></a>
<a name="ln-7472"></a>
<a name="ln-7473"></a><span class="k">SUBROUTINE </span><span class="n">CalcDesuperheaterWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7474"></a>
<a name="ln-7475"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7476"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-7477"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-7478"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7479"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7480"></a>
<a name="ln-7481"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7482"></a>          <span class="c">! Simulates a refrigerant desuperheater to heat water</span>
<a name="ln-7483"></a>
<a name="ln-7484"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7485"></a>          <span class="c">! This model uses the rated heat reclaim recovery efficiency, recovery efficiency modifier curve,</span>
<a name="ln-7486"></a>          <span class="c">! set point temperature, and dead band temperature difference to simulate the desuperheater coil</span>
<a name="ln-7487"></a>          <span class="c">! and sets up inputs to the tank model associated with the desuperheater coil</span>
<a name="ln-7488"></a>
<a name="ln-7489"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7490"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-7491"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-7492"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoil</span>
<a name="ln-7493"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CPHW</span><span class="p">,</span> <span class="n">RhoH2O</span>
<a name="ln-7494"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-7495"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">HeatReclaimDXCoil</span>
<a name="ln-7496"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">DoingSizing</span><span class="p">,</span> <span class="n">KickOffSimulation</span>
<a name="ln-7497"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7498"></a>                               <span class="n">ShowContinueErrorTimeStamp</span><span class="p">,</span> <span class="n">ShowRecurringWarningErrorAtEnd</span>
<a name="ln-7499"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">ShortenTimeStepSys</span>
<a name="ln-7500"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-7501"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-7502"></a>
<a name="ln-7503"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7504"></a>
<a name="ln-7505"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7506"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>      <span class="c">! Water Heater being simulated</span>
<a name="ln-7507"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! TRUE if First iteration of simulation</span>
<a name="ln-7508"></a>
<a name="ln-7509"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7510"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>          <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>            <span class="c">! Maximum number of iterations for RegulaFalsi</span>
<a name="ln-7511"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">0.00001D0</span>        <span class="c">! Accuracy of result from RegulaFalsi</span>
<a name="ln-7512"></a>
<a name="ln-7513"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7514"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AvailSchedule</span>           <span class="c">! desuperheater availability schedule</span>
<a name="ln-7515"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SetPointTemp</span>            <span class="c">! desuperheater set point temperature (cut-out temperature, C)</span>
<a name="ln-7516"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DeadbandTempDiff</span>        <span class="c">! desuperheater dead band temperature difference (C)</span>
<a name="ln-7517"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CutInTemp</span>               <span class="c">! desuperheater cut-in temperature (SetpointTemp - DeadbandTempDiff, C)</span>
<a name="ln-7518"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankTemp</span>                <span class="c">! tank temperature before simulation, C</span>
<a name="ln-7519"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NewTankTemp</span>             <span class="c">! tank temperature after simulation, C</span>
<a name="ln-7520"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MdotWater</span>               <span class="c">! mass flow rate through desuperheater, kg/s</span>
<a name="ln-7521"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PartLoadRatio</span>           <span class="c">! desuperheater part load ratio</span>
<a name="ln-7522"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">QHeatRate</span>               <span class="c">! desuperheater heating rate (W)</span>
<a name="ln-7523"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AverageWasteHeat</span>        <span class="c">! average hating rate from DX system condenser (W)</span>
<a name="ln-7524"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">HEffFTemp</span>               <span class="c">! output of heating efficiency as a function of temperature curve</span>
<a name="ln-7525"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Effic</span>                   <span class="c">! efficiency of desuperheater heating coil</span>
<a name="ln-7526"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CpWater</span>                 <span class="c">! specific heat of water (J/Kg/k)</span>
<a name="ln-7527"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">WaterInletNode</span>          <span class="c">! desuperheater water inlet node number</span>
<a name="ln-7528"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">WaterOutletNode</span>         <span class="c">! desuperheater water outlet node number</span>
<a name="ln-7529"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">DesuperheaterNum</span>        <span class="c">! Index to desuperheater</span>
<a name="ln-7530"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFla</span>                  <span class="c">! Flag of RegulaFalsi solver</span>
<a name="ln-7531"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SourceID</span>                <span class="c">! Waste Heat Source ID number</span>
<a name="ln-7532"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>                     <span class="c">! Parameters passed to RegulaFalsi</span>
<a name="ln-7533"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MinTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! used for error messages, C</span>
<a name="ln-7534"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">IterNum</span>                    <span class="c">! Max number of iterations for warning message</span>
<a name="ln-7535"></a>
<a name="ln-7536"></a>          <span class="c">! FLOW:</span>
<a name="ln-7537"></a>  <span class="n">DesuperheaterNum</span>  <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span>
<a name="ln-7538"></a>  <span class="n">AvailSchedule</span>     <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span>
<a name="ln-7539"></a>  <span class="n">WaterInletNode</span>    <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">WaterInletNode</span>
<a name="ln-7540"></a>  <span class="n">WaterOutletNode</span>   <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">WaterOutletNode</span>
<a name="ln-7541"></a>
<a name="ln-7542"></a>
<a name="ln-7543"></a><span class="c">! initialize variables before invoking any RETURN statement</span>
<a name="ln-7544"></a>  <span class="n">PartLoadRatio</span>                                    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7545"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7546"></a><span class="c">! reset tank inlet temp from previous time step</span>
<a name="ln-7547"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>      <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-7548"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DesuperheaterPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7549"></a>
<a name="ln-7550"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>                <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7551"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>               <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7552"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>                       <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-7553"></a>
<a name="ln-7554"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DesuperheaterPLR</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7555"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7556"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaFuelEnergy</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7557"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7558"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7559"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTempOutput</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7560"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7561"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterEnergy</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7562"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpPower</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7563"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpEnergy</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7564"></a>
<a name="ln-7565"></a><span class="c">! set up initial conditions</span>
<a name="ln-7566"></a>  <span class="n">QHeatRate</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7567"></a>  <span class="n">SetPointTemp</span>      <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetpointTemp</span>
<a name="ln-7568"></a>  <span class="n">DeadbandTempDiff</span>  <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DeadbandTempDiff</span>
<a name="ln-7569"></a>
<a name="ln-7570"></a><span class="c">! simulate only the water heater tank if the desuperheater coil is scheduled off</span>
<a name="ln-7571"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">AvailSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7572"></a><span class="k">    </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Mode</span>     <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-7573"></a>    <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-7574"></a>    <span class="k">RETURN</span>
<a name="ln-7575"></a><span class="k">  END IF</span>
<a name="ln-7576"></a>
<a name="ln-7577"></a><span class="c">! simulate only the water heater tank if the lowest temperature available from the desuperheater coil</span>
<a name="ln-7578"></a><span class="c">! is less than water inlet temperature if the reclaim source is a refrigeration condenser</span>
<a name="ln-7579"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ValidSourceType</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7580"></a><span class="k">    </span><span class="n">SourceID</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span>
<a name="ln-7581"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="o">==</span> <span class="n">CONDENSER_REFRIGERATION</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7582"></a><span class="k">      IF</span><span class="p">(</span><span class="n">HeatReclaimRefrigCondenser</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">AvailTemperature</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7583"></a><span class="k">        </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Mode</span>     <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-7584"></a>        <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-7585"></a>        <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;WaterHeating:Desuperheater &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7586"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7587"></a>          <span class="s1">&#39; - Waste heat source temperature was too low to be useful.&#39;</span><span class="p">,&amp;</span>
<a name="ln-7588"></a>          <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">InsuffTemperatureWarn</span><span class="p">)</span>
<a name="ln-7589"></a>        <span class="k">RETURN</span>
<a name="ln-7590"></a><span class="k">      END IF</span> <span class="c">! Temp too low</span>
<a name="ln-7591"></a>    <span class="k">END IF</span>   <span class="c">! desuperheater source is condenser_refrigeration</span>
<a name="ln-7592"></a>  <span class="k">END IF</span>     <span class="c">! validsourcetype</span>
<a name="ln-7593"></a>
<a name="ln-7594"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span>   <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7595"></a>                                                                    <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-7596"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span> <span class="o">*</span><span class="p">&amp;</span>
<a name="ln-7597"></a>                                                                    <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7598"></a>
<a name="ln-7599"></a><span class="c">! check that water heater tank cut-in temp is greater than desuperheater cut-in temp</span>
<a name="ln-7600"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7601"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">KickOffSimulation</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7602"></a><span class="k">      </span><span class="n">MinTemp</span> <span class="o">=</span> <span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span>
<a name="ln-7603"></a>      <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetPointError</span><span class="o">=</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetPointError</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7604"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetPointError</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7605"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7606"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7607"></a>            <span class="s1">&#39;&quot;:  Water heater tank set point temperature is greater than or equal to the cut-in temperature&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7608"></a>            <span class="s1">&#39; of the desuperheater. Desuperheater will be disabled.&#39;</span><span class="p">)</span>
<a name="ln-7609"></a>        <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Desuperheater cut-in temperature = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7610"></a>      <span class="k">ELSE</span>
<a name="ln-7611"></a><span class="k">        CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7612"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7613"></a>          <span class="s1">&#39;&quot;:  Water heater tank set point temperature is greater than or equal to the cut-in temperature&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7614"></a>          <span class="s1">&#39; of the desuperheater. Desuperheater will be disabled warning continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-7615"></a>          <span class="p">,</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetPointErrIndex1</span><span class="p">,</span> <span class="n">MinTemp</span><span class="p">,</span> <span class="n">MinTemp</span><span class="p">)</span>
<a name="ln-7616"></a>      <span class="k">END IF</span>
<a name="ln-7617"></a><span class="k">    END IF</span>
<a name="ln-7618"></a>
<a name="ln-7619"></a><span class="c">!   Simulate tank if desuperheater unavailable for water heating</span>
<a name="ln-7620"></a>    <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-7621"></a>    <span class="k">RETURN</span>
<a name="ln-7622"></a><span class="k">  END IF</span>
<a name="ln-7623"></a>
<a name="ln-7624"></a><span class="k">  </span><span class="n">Effic</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeatReclaimRecoveryEff</span>
<a name="ln-7625"></a>
<a name="ln-7626"></a><span class="c">! store first iteration tank temperature and desuperheater mode of operation</span>
<a name="ln-7627"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ShortenTimeStepSys</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7628"></a>    <span class="c">! Save conditions from end of previous system timestep</span>
<a name="ln-7629"></a>    <span class="c">! Every iteration that does not advance time should reset to these values</span>
<a name="ln-7630"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-7631"></a>    <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SaveMode</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Mode</span>
<a name="ln-7632"></a>  <span class="k">END IF</span>
<a name="ln-7633"></a>
<a name="ln-7634"></a><span class="k">  </span><span class="n">TankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-7635"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SaveMode</span>
<a name="ln-7636"></a>
<a name="ln-7637"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7638"></a><span class="k">    </span><span class="n">HEffFTemp</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTemp</span><span class="p">,</span> <span class="n">TankTemp</span><span class="p">,</span> <span class="n">OutDryBulbTemp</span><span class="p">))</span>
<a name="ln-7639"></a>  <span class="k">ELSE</span>
<a name="ln-7640"></a><span class="k">    </span><span class="n">HEffFTemp</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7641"></a>  <span class="k">END IF</span>
<a name="ln-7642"></a>
<a name="ln-7643"></a><span class="c">!set limits on heat recovery efficiency</span>
<a name="ln-7644"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="o">==</span> <span class="n">CONDENSER_REFRIGERATION</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7645"></a><span class="k">    IF</span><span class="p">((</span><span class="n">HEffFTemp</span> <span class="o">*</span> <span class="n">Effic</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.9d0</span><span class="p">)</span><span class="n">HEffFTemp</span> <span class="o">=</span> <span class="mf">0.9d0</span> <span class="o">/</span> <span class="n">Effic</span>
<a name="ln-7646"></a>  <span class="k">ELSE</span> <span class="c">! max is 0.3 for all other sources</span>
<a name="ln-7647"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">HEffFTemp</span> <span class="o">*</span> <span class="n">Effic</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.3d0</span><span class="p">)</span><span class="n">HEffFTemp</span> <span class="o">=</span> <span class="mf">0.3d0</span> <span class="o">/</span> <span class="n">Effic</span>
<a name="ln-7648"></a>  <span class="k">END IF</span>  <span class="c">!setting limits on heat recovery efficiency</span>
<a name="ln-7649"></a>
<a name="ln-7650"></a>  <span class="c">! Access the appropriate structure to find the average heating capacity of the desuperheater heating coil</span>
<a name="ln-7651"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ValidSourceType</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7652"></a><span class="k">     </span><span class="n">SourceID</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span>
<a name="ln-7653"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">COMPRESSORRACK_REFRIGERATEDCASE</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7654"></a>       <span class="c">!Refrigeration systems are solved outside the time step iteration, so the</span>
<a name="ln-7655"></a>       <span class="c">!  appropriate decrement for other waste heat applications is handled differently</span>
<a name="ln-7656"></a>       <span class="n">AverageWasteHeat</span> <span class="o">=</span> <span class="n">HeatReclaimRefrigeratedRack</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-7657"></a>          <span class="n">HeatReclaimRefrigeratedRack</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">UsedHVACCoil</span>
<a name="ln-7658"></a>       <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7659"></a>     <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CONDENSER_REFRIGERATION</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7660"></a><span class="k">       </span><span class="n">AverageWasteHeat</span> <span class="o">=</span> <span class="n">HeatReclaimRefrigCondenser</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-7661"></a>          <span class="n">HeatReclaimRefrigCondenser</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">UsedHVACCoil</span>
<a name="ln-7662"></a>       <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7663"></a>     <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">COIL_DX_COOLING</span>    <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7664"></a>            <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">COIL_DX_MULTISPEED</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7665"></a>            <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">COIL_DX_MULTIMODE</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7666"></a><span class="k">       </span><span class="n">AverageWasteHeat</span> <span class="o">=</span> <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">AvailCapacity</span>
<a name="ln-7667"></a>       <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span> <span class="o">=</span> <span class="n">DXCoil</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-7668"></a>     <span class="k">END IF</span>
<a name="ln-7669"></a><span class="k">  ELSE</span>
<a name="ln-7670"></a><span class="k">     </span><span class="n">AverageWasteHeat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7671"></a>  <span class="k">END IF</span>
<a name="ln-7672"></a>
<a name="ln-7673"></a><span class="c">! simulate only water heater tank if reclaim heating source is off</span>
<a name="ln-7674"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7675"></a><span class="k">    CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-7676"></a>    <span class="k">RETURN</span>
<a name="ln-7677"></a><span class="k">  END IF</span>
<a name="ln-7678"></a>
<a name="ln-7679"></a><span class="c">! If the set point is higher than the maximum water temp, reset both the set point and the dead band temperature difference</span>
<a name="ln-7680"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SetPointTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">MaxInletWaterTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7681"></a><span class="k">    </span><span class="n">CutInTemp</span>    <span class="o">=</span> <span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span>
<a name="ln-7682"></a>    <span class="n">SetPointTemp</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">MaxInletWaterTemp</span>
<a name="ln-7683"></a>    <span class="n">DeadbandTempDiff</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">CutInTemp</span><span class="p">))</span>
<a name="ln-7684"></a>  <span class="k">END IF</span>
<a name="ln-7685"></a>
<a name="ln-7686"></a><span class="c">! set the water-side mass flow rate</span>
<a name="ln-7687"></a>  <span class="n">CpWater</span>   <span class="o">=</span> <span class="n">CPHW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-7688"></a>  <span class="n">MdotWater</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span> <span class="o">*</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-7689"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">MaxInletWaterTemp</span><span class="o">+</span><span class="n">Acc</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7690"></a><span class="k">    </span><span class="n">QHeatRate</span>   <span class="o">=</span> <span class="p">((</span><span class="n">AverageWasteHeat</span> <span class="o">*</span> <span class="n">Effic</span> <span class="o">*</span> <span class="n">HEffFTemp</span><span class="p">)</span><span class="o">/</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7691"></a>                   <span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpElecPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7692"></a>                    <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpFracToWater</span><span class="p">)</span>
<a name="ln-7693"></a>  <span class="k">END IF</span>
<a name="ln-7694"></a>
<a name="ln-7695"></a><span class="k">  IF</span><span class="p">(</span><span class="n">MdotWater</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7696"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">+</span> <span class="n">QHeatRate</span><span class="o">/</span><span class="p">(</span><span class="n">MdotWater</span> <span class="o">*</span> <span class="n">CpWater</span><span class="p">)</span>
<a name="ln-7697"></a>  <span class="k">ELSE</span>
<a name="ln-7698"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7699"></a>  <span class="k">END IF</span>
<a name="ln-7700"></a>
<a name="ln-7701"></a><span class="c">! change to tanktypenum using parameters?</span>
<a name="ln-7702"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-7703"></a>
<a name="ln-7704"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-7705"></a>
<a name="ln-7706"></a>      <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SaveWHMode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span>
<a name="ln-7707"></a>
<a name="ln-7708"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-7709"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">HeatMode</span><span class="p">)</span>
<a name="ln-7710"></a>
<a name="ln-7711"></a>          <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span>
<a name="ln-7712"></a>
<a name="ln-7713"></a><span class="c">!         set the full load outlet temperature on the water heater source inlet node (init has already been called)</span>
<a name="ln-7714"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7715"></a>
<a name="ln-7716"></a><span class="c">!         set the source mass flow rate for the tank</span>
<a name="ln-7717"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-7718"></a>
<a name="ln-7719"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>        <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-7720"></a>             <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-7721"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span>        <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-7722"></a>             <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-7723"></a>
<a name="ln-7724"></a>          <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-7725"></a>          <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-7726"></a>
<a name="ln-7727"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SetPointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7728"></a><span class="c">!           Only revert to floating mode if the tank temperature is higher than the cut out temperature</span>
<a name="ln-7729"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SetpointTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7730"></a><span class="k">              </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-7731"></a>            <span class="k">END IF</span>
<a name="ln-7732"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SetPointTemp</span>
<a name="ln-7733"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SaveWHMode</span>
<a name="ln-7734"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-7735"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7736"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7737"></a>            <span class="k">ELSE</span>
<a name="ln-7738"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7739"></a>            <span class="k">END IF</span>
<a name="ln-7740"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">MdotWater</span>
<a name="ln-7741"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">PLRResidualMixedTank</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7742"></a>                                  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-7743"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7744"></a><span class="k">              WRITE</span><span class="p">(</span><span class="n">IterNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">MaxIte</span>
<a name="ln-7745"></a>              <span class="n">IterNum</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">IterNum</span><span class="p">)</span>
<a name="ln-7746"></a>              <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7747"></a><span class="k">                </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7748"></a>                  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum1</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7749"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum1</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7750"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7751"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7752"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating desuperheater unit part-load ratio, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7753"></a>                                        <span class="s1">&#39;maximum iterations = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">IterNum</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7754"></a>                                        <span class="s1">&#39;. Part-load ratio returned = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-7755"></a>                  <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;This error occurred in heating mode.&#39;</span><span class="p">)</span>
<a name="ln-7756"></a>                <span class="k">ELSE</span>
<a name="ln-7757"></a><span class="k">                  CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7758"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7759"></a>                  <span class="s1">&#39;&quot;:  Iteration limit exceeded in heating mode warning continues. Part-load ratio statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-7760"></a>                  <span class="p">,</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">IterLimitErrIndex1</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-7761"></a>                <span class="k">END IF</span>
<a name="ln-7762"></a><span class="k">              END IF</span>
<a name="ln-7763"></a><span class="k">            ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7764"></a><span class="k">              </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7765"></a>                                         <span class="p">(</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">TankTemp</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="o">-</span> <span class="n">TankTemp</span><span class="p">)))</span>
<a name="ln-7766"></a>              <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7767"></a><span class="k">                </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum1</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7768"></a>                  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum1</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7769"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum1</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7770"></a><span class="k">                  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7771"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7772"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Desuperheater unit part-load ratio calculation failed: PLR limits &#39;</span> <span class="p">&amp;</span>
<a name="ln-7773"></a>                                   <span class="o">//</span><span class="s1">&#39;of 0 to 1 exceeded. Part-load ratio used = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-7774"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Please send this information to the EnergyPlus support group.&#39;</span><span class="p">)</span>
<a name="ln-7775"></a>                  <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;This error occured in heating mode.&#39;</span><span class="p">)</span>
<a name="ln-7776"></a>                <span class="k">ELSE</span>
<a name="ln-7777"></a><span class="k">                  CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7778"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7779"></a>                  <span class="s1">&#39;&quot;:  Part-load ratio calculation failed in heating mode warning continues. Part-load ratio statistics follow.&#39;</span><span class="p">&amp;</span>
<a name="ln-7780"></a>                  <span class="p">,</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedIndex1</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-7781"></a>                <span class="k">END IF</span>
<a name="ln-7782"></a><span class="k">              END IF</span>
<a name="ln-7783"></a><span class="k">            END IF</span>
<a name="ln-7784"></a><span class="k">            </span><span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-7785"></a>          <span class="k">ELSE</span>
<a name="ln-7786"></a><span class="k">            </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span>
<a name="ln-7787"></a>          <span class="k">END IF</span>
<a name="ln-7788"></a>
<a name="ln-7789"></a><span class="k">        CASE</span><span class="p">(</span><span class="n">FloatMode</span><span class="p">)</span>
<a name="ln-7790"></a>
<a name="ln-7791"></a><span class="c">!         check tank temperature by setting source inlet mass flow rate to zero</span>
<a name="ln-7792"></a>          <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7793"></a>
<a name="ln-7794"></a><span class="c">!         set the full load outlet temperature on the water heater source inlet node (init has already been called)</span>
<a name="ln-7795"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7796"></a>
<a name="ln-7797"></a><span class="c">!         check tank temperature by setting source inlet mass flow rate to zero</span>
<a name="ln-7798"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7799"></a>
<a name="ln-7800"></a><span class="c">!         disable the tank heater to find PLR of the HPWH</span>
<a name="ln-7801"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7802"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7803"></a>
<a name="ln-7804"></a>          <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-7805"></a>          <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-7806"></a>
<a name="ln-7807"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="p">(</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7808"></a><span class="k">            </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">HeatMode</span>
<a name="ln-7809"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SaveWHMode</span>
<a name="ln-7810"></a>            <span class="k">IF</span><span class="p">((</span><span class="n">Tanktemp</span> <span class="o">-</span> <span class="n">NewTankTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7811"></a><span class="k">              </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7812"></a>                              <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,((</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span><span class="p">)</span> <span class="o">-</span> <span class="n">NewTankTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Tanktemp</span> <span class="o">-</span> <span class="n">NewTankTemp</span><span class="p">)))</span>
<a name="ln-7813"></a>            <span class="k">ELSE</span>
<a name="ln-7814"></a><span class="k">              </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span>
<a name="ln-7815"></a>            <span class="k">END IF</span>
<a name="ln-7816"></a>
<a name="ln-7817"></a><span class="c">!           set the full load outlet temperature on the water heater source inlet node</span>
<a name="ln-7818"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-7819"></a>
<a name="ln-7820"></a><span class="c">!           set the source mass flow rate for the tank and enable backup heating element</span>
<a name="ln-7821"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-7822"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-7823"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-7824"></a>
<a name="ln-7825"></a>            <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-7826"></a>            <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-7827"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SetPointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7828"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SetPointTemp</span>
<a name="ln-7829"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">SaveWHMode</span>
<a name="ln-7830"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-7831"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7832"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7833"></a>              <span class="k">ELSE</span>
<a name="ln-7834"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7835"></a>              <span class="k">END IF</span>
<a name="ln-7836"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">MdotWater</span>
<a name="ln-7837"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">PLRResidualMixedTank</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7838"></a>                                    <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-7839"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7840"></a><span class="k">                WRITE</span><span class="p">(</span><span class="n">IterNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">MaxIte</span>
<a name="ln-7841"></a>                <span class="n">IterNum</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">IterNum</span><span class="p">)</span>
<a name="ln-7842"></a>                <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7843"></a><span class="k">                  </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum2</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7844"></a>                    <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7845"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7846"></a><span class="k">                    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7847"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7848"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating desuperheater unit part-load ratio, &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7849"></a>                                        <span class="s1">&#39;maximum iterations = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">IterNum</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7850"></a>                                        <span class="s1">&#39;. Part-load ratio returned = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-7851"></a>                    <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;This error occurred in float mode.&#39;</span><span class="p">)</span>
<a name="ln-7852"></a>                  <span class="k">ELSE</span>
<a name="ln-7853"></a><span class="k">                    CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7854"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7855"></a>                    <span class="s1">&#39;&quot;:  Iteration limit exceeded in float mode warning continues. Part-load ratio statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-7856"></a>                    <span class="p">,</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">IterLimitErrIndex2</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-7857"></a>                  <span class="k">END IF</span>
<a name="ln-7858"></a><span class="k">                END IF</span>
<a name="ln-7859"></a><span class="k">              ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7860"></a><span class="k">                </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DXSysPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7861"></a>                                           <span class="p">(</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">TankTemp</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="o">-</span> <span class="n">TankTemp</span><span class="p">)))</span>
<a name="ln-7862"></a>                <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7863"></a><span class="k">                  </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum2</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7864"></a>                    <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7865"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7866"></a><span class="k">                    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7867"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7868"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Desuperheater unit part-load ratio calculation failed: PLR limits &#39;</span> <span class="p">&amp;</span>
<a name="ln-7869"></a>                                   <span class="o">//</span><span class="s1">&#39;of 0 to 1 exceeded. Part-load ratio used = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-7870"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Please send this information to the EnergyPlus support group.&#39;</span><span class="p">)</span>
<a name="ln-7871"></a>                    <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;This error occured in float mode.&#39;</span><span class="p">)</span>
<a name="ln-7872"></a>                  <span class="k">ELSE</span>
<a name="ln-7873"></a><span class="k">                    CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-7874"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-7875"></a>                    <span class="s1">&#39;&quot;: Part-load ratio calculation failed in float mode warning continues. Part-load ratio statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-7876"></a>                    <span class="p">,</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedIndex2</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-7877"></a>                  <span class="k">END IF</span>
<a name="ln-7878"></a><span class="k">                END IF</span>
<a name="ln-7879"></a><span class="k">              END IF</span>
<a name="ln-7880"></a><span class="k">            END IF</span>
<a name="ln-7881"></a><span class="k">          ELSE</span>
<a name="ln-7882"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-7883"></a>            <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-7884"></a>          <span class="k">END IF</span>
<a name="ln-7885"></a>
<a name="ln-7886"></a><span class="k">        CASE </span><span class="n">DEFAULT</span>
<a name="ln-7887"></a>      <span class="k">END SELECT</span>
<a name="ln-7888"></a>
<a name="ln-7889"></a><span class="c">!   should never get here, case is checked in GetWaterThermalTankInput</span>
<a name="ln-7890"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-7891"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Coil:WaterHeating:Desuperheater = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7892"></a>          <span class="o">//</span><span class="s1">&#39;:  invalid water heater tank type and name entered = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7893"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="p">&amp;</span>
<a name="ln-7894"></a>          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">TankName</span><span class="p">))</span>
<a name="ln-7895"></a>
<a name="ln-7896"></a>  <span class="k">END SELECT</span>
<a name="ln-7897"></a>
<a name="ln-7898"></a><span class="k">  IF</span><span class="p">(</span><span class="n">QHeatRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7899"></a>
<a name="ln-7900"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-7901"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTempOutput</span> <span class="o">=</span> <span class="n">HEffFtemp</span>
<a name="ln-7902"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterRate</span> <span class="o">=</span> <span class="n">QHeatRate</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-7903"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-7904"></a>
<a name="ln-7905"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7906"></a><span class="k">    </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-7907"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-7908"></a>    <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HEffFTempOutput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7909"></a>    <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7910"></a>  <span class="k">END IF</span>
<a name="ln-7911"></a>
<a name="ln-7912"></a><span class="k">  </span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterEnergy</span>        <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7913"></a>                                                                    <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7914"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">DesuperheaterPLR</span>    <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-7915"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span>   <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7916"></a>                                                                    <span class="n">PartLoadRatio</span>
<a name="ln-7917"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaFuelEnergy</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span><span class="o">*</span><span class="p">&amp;</span>
<a name="ln-7918"></a>                                                                    <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7919"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span>   <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7920"></a>                                                                    <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-7921"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span> <span class="o">*</span><span class="p">&amp;</span>
<a name="ln-7922"></a>                                                                    <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7923"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpPower</span>           <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpElecPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7924"></a>                                                                    <span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-7925"></a>  <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpEnergy</span>          <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">PumpPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7926"></a>                                                                    <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7927"></a>
<a name="ln-7928"></a><span class="c">! Update remaining waste heat (just in case multiple users of waste heat use same source)</span>
<a name="ln-7929"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ValidSourceType</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7930"></a><span class="k">     </span><span class="n">SourceID</span> <span class="o">=</span> <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSourceIndexNum</span>
<a name="ln-7931"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">COMPRESSORRACK_REFRIGERATEDCASE</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7932"></a><span class="c">!    Refrigeration systems are simulated at the zone time step, do not decrement available capacity</span>
<a name="ln-7933"></a>          <span class="n">HeatReclaimRefrigeratedRack</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">UsedWaterHeater</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7934"></a>             <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterRate</span>
<a name="ln-7935"></a>     <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CONDENSER_REFRIGERATION</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7936"></a><span class="k">          </span><span class="n">HeatReclaimRefrigCondenser</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">UsedWaterHeater</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7937"></a>             <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterRate</span>
<a name="ln-7938"></a>     <span class="n">ELSEIF</span><span class="p">(</span><span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">COIL_DX_COOLING</span>    <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7939"></a>            <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">COIL_DX_MULTISPEED</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7940"></a>            <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">ReclaimHeatingSource</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">COIL_DX_MULTIMODE</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7941"></a><span class="k">       </span><span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">=</span> <span class="n">HeatReclaimDXCoil</span><span class="p">(</span><span class="n">SourceID</span><span class="p">)%</span><span class="n">AvailCapacity</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-7942"></a>           <span class="n">WaterHeaterDesuperheater</span><span class="p">(</span><span class="n">DesuperheaterNum</span><span class="p">)%</span><span class="n">HeaterRate</span>
<a name="ln-7943"></a>     <span class="k">END IF</span>
<a name="ln-7944"></a><span class="k">  END IF</span>
<a name="ln-7945"></a>
<a name="ln-7946"></a><span class="k">  RETURN</span>
<a name="ln-7947"></a>
<a name="ln-7948"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDesuperheaterWaterHeater</span>
<a name="ln-7949"></a>
<a name="ln-7950"></a>
<a name="ln-7951"></a><span class="k">SUBROUTINE </span><span class="n">CalcHeatPumpWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-7952"></a>
<a name="ln-7953"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7954"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-7955"></a>          <span class="c">!       DATE WRITTEN   March 2005</span>
<a name="ln-7956"></a>          <span class="c">!       MODIFIED       B. Griffith, Jan 2012 for stratified tank</span>
<a name="ln-7957"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7958"></a>
<a name="ln-7959"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7960"></a>          <span class="c">! Simulates a heat pump water heater</span>
<a name="ln-7961"></a>
<a name="ln-7962"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7963"></a>          <span class="c">! Simulate the water heater tank, DX coil, and fan to meet the water heating requirements.</span>
<a name="ln-7964"></a>
<a name="ln-7965"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7966"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-7967"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShortenTimeStepSys</span><span class="p">,</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">HPWHInletDBTemp</span><span class="p">,</span> <span class="n">HPWHInletWBTemp</span><span class="p">,</span> <span class="n">HPWHCrankcaseDBTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7968"></a>                               <span class="n">BlowThru</span><span class="p">,</span> <span class="n">CycFanCycCoil</span><span class="p">,</span> <span class="n">SmallTempDiff</span>
<a name="ln-7969"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">DoingSizing</span><span class="p">,</span> <span class="n">KickOffSimulation</span>
<a name="ln-7970"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7971"></a>                               <span class="n">ShowContinueErrorTimeStamp</span><span class="p">,</span> <span class="n">ShowRecurringWarningErrorAtEnd</span>
<a name="ln-7972"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimDXCoil</span><span class="p">,</span> <span class="n">CalcHPWHDXCoil</span>
<a name="ln-7973"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-7974"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-7975"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-7976"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CPHW</span><span class="p">,</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">,</span> <span class="n">RhoH2O</span> <span class="c">!, PsyWFnTdbTwbPb</span>
<a name="ln-7977"></a>
<a name="ln-7978"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7979"></a>
<a name="ln-7980"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7981"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>          <span class="c">! Water Heater tank being simulated</span>
<a name="ln-7982"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>      <span class="c">! TRUE if First iteration of simulation</span>
<a name="ln-7983"></a>
<a name="ln-7984"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7985"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>          <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>            <span class="c">! maximum number of iterations</span>
<a name="ln-7986"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">0.001D0</span>          <span class="c">! Accuracy of result from RegulaFalsi</span>
<a name="ln-7987"></a>
<a name="ln-7988"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7989"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AvailSchedule</span>           <span class="c">! HP compressor availability schedule</span>
<a name="ln-7990"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SetPointTemp</span>            <span class="c">! HP set point temperature (cut-out temperature, C)</span>
<a name="ln-7991"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DeadbandTempDiff</span>        <span class="c">! HP dead band temperature difference (C)</span>
<a name="ln-7992"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankTemp</span>                <span class="c">! tank temperature before simulation, C</span>
<a name="ln-7993"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NewTankTemp</span>             <span class="c">! tank temperature after simulation, C</span>
<a name="ln-7994"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CpAir</span>                   <span class="c">! specific heat of air, kJ/kg/K</span>
<a name="ln-7995"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MdotWater</span>               <span class="c">! mass flow rate of condenser water, kg/s</span>
<a name="ln-7996"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletAirSplitterSch</span>    <span class="c">! output of outlet air splitter schedule</span>
<a name="ln-7997"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPAirInletNode</span>          <span class="c">! HP air inlet node number</span>
<a name="ln-7998"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPAirOutletNode</span>         <span class="c">! HP air outlet node number</span>
<a name="ln-7999"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">OutdoorAirNode</span>          <span class="c">! Outdoor air inlet node number</span>
<a name="ln-8000"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">ExhaustAirNode</span>          <span class="c">! Exhaust air outlet node number</span>
<a name="ln-8001"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPWaterInletNode</span>        <span class="c">! HP condenser water inlet node number</span>
<a name="ln-8002"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPWaterOutletNode</span>       <span class="c">! HP condenser water outlet node number</span>
<a name="ln-8003"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">InletAirMixerNode</span>       <span class="c">! HP inlet air mixer node number</span>
<a name="ln-8004"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">OutletAirSplitterNode</span>   <span class="c">! HP outlet air splitter node number</span>
<a name="ln-8005"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">DXCoilAirInletNode</span>      <span class="c">! Inlet air node number of DX coil</span>
<a name="ln-8006"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">HPNum</span>                   <span class="c">! Index to heat pump water heater</span>
<a name="ln-8007"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFla</span>                  <span class="c">! Flag of RegulaFalsi solver</span>
<a name="ln-8008"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>                     <span class="c">! Parameters passed to RegulaFalsi</span>
<a name="ln-8009"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">HPMinTemp</span>               <span class="c">! used for error messages, C</span>
<a name="ln-8010"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HPMinTempChar</span>  <span class="c">! used for error messages</span>
<a name="ln-8011"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">IterNum</span>                 <span class="c">! Max number of iterations for warning message</span>
<a name="ln-8012"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">CompOp</span>                  <span class="c">! DX compressor operation; 1=on, 0=off</span>
<a name="ln-8013"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CondenserDeltaT</span>         <span class="c">! HPWH condenser water temperature difference</span>
<a name="ln-8014"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">HPWHCondInletNodeLast</span>   <span class="c">! Water temp sent from WH on last iteration</span>
<a name="ln-8015"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">loopIter</span>                <span class="c">! iteration loop counter</span>
<a name="ln-8016"></a>
<a name="ln-8017"></a>          <span class="c">! FLOW:</span>
<a name="ln-8018"></a><span class="c">! initialize local variables</span>
<a name="ln-8019"></a>  <span class="n">HPNum</span>                   <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span>
<a name="ln-8020"></a>  <span class="n">AvailSchedule</span>           <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span>
<a name="ln-8021"></a>  <span class="n">HPAirInletNode</span>          <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span>
<a name="ln-8022"></a>  <span class="n">HPAirOutletNode</span>         <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPumpAirOutletNode</span>
<a name="ln-8023"></a>  <span class="n">OutdoorAirNode</span>          <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span>
<a name="ln-8024"></a>  <span class="n">ExhaustAirNode</span>          <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">ExhaustAirNode</span>
<a name="ln-8025"></a>  <span class="n">HPWaterInletNode</span>        <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CondWaterInletNode</span>
<a name="ln-8026"></a>  <span class="n">HPWaterOutletNode</span>       <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CondWaterOutletNode</span>
<a name="ln-8027"></a>  <span class="n">InletAirMixerNode</span>       <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span>
<a name="ln-8028"></a>  <span class="n">OutletAirSplitterNode</span>   <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirSplitterNode</span>
<a name="ln-8029"></a>  <span class="n">DXCoilAirInletNode</span>      <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilAirInletNode</span>
<a name="ln-8030"></a>  <span class="n">HPPartLoadRatio</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8031"></a>  <span class="n">CompOp</span>                  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8032"></a>  <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8033"></a>  <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OnCycParaFuelEnergy</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8034"></a>  <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8035"></a>  <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8036"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterOutletNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)</span>
<a name="ln-8037"></a>
<a name="ln-8038"></a><span class="c">! assign set point temperature (cut-out) and dead band temp diff (cut-in = cut-out minus dead band temp diff)</span>
<a name="ln-8039"></a>  <span class="n">SetPointTemp</span>      <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SetpointTemp</span>
<a name="ln-8040"></a>  <span class="n">DeadbandTempDiff</span>  <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DeadbandTempDiff</span>
<a name="ln-8041"></a>
<a name="ln-8042"></a><span class="c">! store first iteration tank temperature and HP mode of operation</span>
<a name="ln-8043"></a><span class="c">! this code can be called more than once with FirstHVACIteration = .TRUE., use FirstTimeThroughFlag to control save</span>
<a name="ln-8044"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ShortenTimeStepSys</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FirstTimeThroughFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8045"></a><span class="k">    </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-8046"></a>    <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SaveMode</span>             <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Mode</span>
<a name="ln-8047"></a>    <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SaveWHMode</span>           <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span>
<a name="ln-8048"></a>    <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FirstTimeThroughFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8049"></a>  <span class="k">END IF</span>
<a name="ln-8050"></a>
<a name="ln-8051"></a><span class="k">  IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FirstTimeThroughFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8052"></a>
<a name="ln-8053"></a><span class="c">! check if HPWH is off for some reason and simulate HPWH air- and water-side mass flow rates of 0</span>
<a name="ln-8054"></a><span class="c">! simulate only water heater tank if HP compressor is scheduled off</span>
<a name="ln-8055"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">AvailSchedule</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8056"></a><span class="c">!   simulate only water heater tank if HP compressor cut-out temperature is lower than the tank&#39;s cut-in temperature</span>
<a name="ln-8057"></a>    <span class="p">(</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8058"></a><span class="c">!    simulate only water heater tank if HP inlet air temperature is below minimum temperature for HP compressor operation</span>
<a name="ln-8059"></a>     <span class="n">HPWHInletDBTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">MinAirTempForHPOperation</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8060"></a><span class="c">!    if the tank maximum temperature limit is less than the HPWH set point temp, disable HPWH</span>
<a name="ln-8061"></a>     <span class="n">SetPointTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8062"></a><span class="c">!   revert to float mode any time HPWH compressor is OFF</span>
<a name="ln-8063"></a>    <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Mode</span>     <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-8064"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">InletAirMixerNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8065"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">InletAirMixerNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)</span>
<a name="ln-8066"></a>    <span class="k">END IF</span>
<a name="ln-8067"></a><span class="c">!   pass node info and simulate crankcase heater</span>
<a name="ln-8068"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanPlacement</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8069"></a><span class="k">      CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-8070"></a>      <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8071"></a>                     <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-8072"></a>    <span class="k">ELSE</span>
<a name="ln-8073"></a><span class="k">      CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8074"></a>                     <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-8075"></a>      <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-8076"></a>    <span class="k">END IF</span>
<a name="ln-8077"></a><span class="k">    IF</span><span class="p">(</span><span class="n">OutletAirSplitterNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8078"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletAirSplitterNode</span><span class="p">)</span>
<a name="ln-8079"></a>    <span class="k">END IF</span>
<a name="ln-8080"></a>
<a name="ln-8081"></a><span class="c">!   Simulate tank if HP compressor unavailable for water heating</span>
<a name="ln-8082"></a>    <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-8083"></a>
<a name="ln-8084"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-8085"></a>      <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8086"></a>    <span class="k">CASE</span><span class="p">((</span><span class="n">StratifiedWaterHeater</span><span class="p">))</span>
<a name="ln-8087"></a>      <span class="k">CALL </span><span class="n">CalcWaterThermalTankStratified</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8088"></a>    <span class="k">END SELECT</span>
<a name="ln-8089"></a>
<a name="ln-8090"></a><span class="c">!   If HPWH compressor is available and unit is off for another reason, off-cycle parasitics are calculated</span>
<a name="ln-8091"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">AvailSchedule</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8092"></a><span class="k">      </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span>   <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">HPPartLoadRatio</span><span class="p">)</span>
<a name="ln-8093"></a>      <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-8094"></a>    <span class="k">END IF</span>
<a name="ln-8095"></a>
<a name="ln-8096"></a><span class="c">!   Warn if HPWH compressor cut-in temperature is less than the water heater tank&#39;s set point temp</span>
<a name="ln-8097"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">KickOffSimulation</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8098"></a><span class="k">      IF</span><span class="p">((</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8099"></a><span class="k">        </span><span class="n">HPMinTemp</span> <span class="o">=</span> <span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span>
<a name="ln-8100"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">HPMinTempChar</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">HPMinTemp</span>
<a name="ln-8101"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPSetPointError</span><span class="o">=</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPSetPointError</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-8102"></a>       <span class="c">!!add logic for warmup, kickoffsimulation and doing sizing here</span>
<a name="ln-8103"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPSetPointError</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8104"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8105"></a>              <span class="s1">&#39;:  Water heater tank set point temperature is greater than or equal to the cut-in temperature&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8106"></a>              <span class="s1">&#39; of the heat pump water heater. Heat Pump will be disabled and simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-8107"></a>          <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">//</span><span class="s1">&#39;...Heat Pump cut-in temperature=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPMinTempChar</span><span class="p">))</span>
<a name="ln-8108"></a>        <span class="k">ELSE</span>
<a name="ln-8109"></a><span class="k">          CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8110"></a>            <span class="s1">&#39;:  Water heater tank set point temperature is greater than or equal to the cut-in temperature&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8111"></a>            <span class="s1">&#39; of the heat pump water heater. Heat Pump will be disabled error continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-8112"></a>            <span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPSetPointErrIndex1</span><span class="p">,</span> <span class="n">HPMinTemp</span><span class="p">,</span> <span class="n">HPMinTemp</span><span class="p">)</span>
<a name="ln-8113"></a>        <span class="k">END IF</span>
<a name="ln-8114"></a><span class="k">      END IF</span>
<a name="ln-8115"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-8116"></a>    <span class="k">RETURN</span>
<a name="ln-8117"></a><span class="k">  END IF</span>
<a name="ln-8118"></a><span class="k">  SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-8119"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-8120"></a>    <span class="n">TankTemp</span>                    <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span>
<a name="ln-8121"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-8122"></a>    <span class="n">TankTemp</span>                    <span class="o">=</span> <span class="n">FindStratifiedTankSensedTemp</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8123"></a>                                        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span><span class="p">)</span>
<a name="ln-8124"></a>  <span class="k">END SELECT</span>
<a name="ln-8125"></a><span class="k">  </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Mode</span>     <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SaveMode</span>
<a name="ln-8126"></a>
<a name="ln-8127"></a><span class="c">! set the heat pump air- and water-side mass flow rate</span>
<a name="ln-8128"></a>  <span class="n">MdotWater</span>         <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span> <span class="o">*</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">)</span>
<a name="ln-8129"></a>
<a name="ln-8130"></a><span class="c">!     select mode of operation (float mode or heat mode)</span>
<a name="ln-8131"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Mode</span><span class="p">)</span>
<a name="ln-8132"></a><span class="c">!       HPWH was heating last iteration and will continue to heat until the set point is reached</span>
<a name="ln-8133"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">HeatMode</span><span class="p">)</span>
<a name="ln-8134"></a>
<a name="ln-8135"></a>      <span class="n">HPPartLoadRatio</span>                        <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8136"></a>
<a name="ln-8137"></a><span class="c">!         set up full air flow on DX coil inlet node</span>
<a name="ln-8138"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">DXCoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-8139"></a>
<a name="ln-8140"></a><span class="c">!         set the condenser inlet node mass flow rate prior to calling the HPWH DX coil</span>
<a name="ln-8141"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span>
<a name="ln-8142"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span>
<a name="ln-8143"></a>
<a name="ln-8144"></a>      <span class="n">HPWHCondInletNodeLast</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8145"></a>      <span class="k">DO </span><span class="n">loopIter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8146"></a>        <span class="k">CALL </span><span class="n">CalcHPWHDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">)</span>
<a name="ln-8147"></a><span class="c">!       Currently, HPWH heating rate is only a function of inlet evap conditions and air flow rate</span>
<a name="ln-8148"></a><span class="c">!       If HPWH is ever allowed to vary fan speed, this next sub should be called.</span>
<a name="ln-8149"></a><span class="c">!       (possibly with an iteration loop to converge on a solution)</span>
<a name="ln-8150"></a><span class="c">!       CALL CalcDOE2DXCoil(DXCoilNum, HPPartLoadRatio, FirstHVACIteration,PartLoadRatio, FanOpMode)</span>
<a name="ln-8151"></a>        <span class="n">CondenserDeltaT</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8152"></a>
<a name="ln-8153"></a><span class="c">!           move the full load outlet temperature rate to the water heater structure variables</span>
<a name="ln-8154"></a><span class="c">!           (water heaters source inlet node temperature/mdot are set in Init, set it here after CalcHPWHDXCoil has been called)</span>
<a name="ln-8155"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">+</span> <span class="n">CondenserDeltaT</span>
<a name="ln-8156"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span>
<a name="ln-8157"></a>
<a name="ln-8158"></a><span class="c">!           this CALL does not update node temps, must use WaterThermalTank variables</span>
<a name="ln-8159"></a>      <span class="c">! select tank type</span>
<a name="ln-8160"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-8161"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-8162"></a>          <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8163"></a>          <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-8164"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-8165"></a>          <span class="k">CALL </span><span class="n">CalcWaterThermalTankStratified</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8166"></a>          <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">FindStratifiedTankSensedTemp</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8167"></a>                               <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span><span class="p">)</span>
<a name="ln-8168"></a>        <span class="k">END SELECT</span>
<a name="ln-8169"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-8170"></a>        <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">HPWHCondInletNodeLast</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SmallTempDiff</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-8171"></a><span class="k">        </span><span class="n">HPWHCondInletNodeLast</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8172"></a>      <span class="k">END DO</span>
<a name="ln-8173"></a>
<a name="ln-8174"></a><span class="c">!         if tank temperature is greater than set point, calculate a PLR needed to exactly reach the set point</span>
<a name="ln-8175"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SetPointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8176"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-8177"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SetPointTemp</span>
<a name="ln-8178"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SaveWHMode</span>
<a name="ln-8179"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-8180"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8181"></a><span class="k">          </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8182"></a>        <span class="k">ELSE</span>
<a name="ln-8183"></a><span class="k">          </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8184"></a>        <span class="k">END IF</span>
<a name="ln-8185"></a><span class="k">        </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">MdotWater</span>
<a name="ln-8186"></a>        <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-8187"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-8188"></a>          <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">PLRResidualMixedTank</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-8189"></a>                             <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8190"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-8191"></a>          <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">PLRResidualStratifiedTank</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-8192"></a>                             <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8193"></a>        <span class="k">END SELECT</span>
<a name="ln-8194"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8195"></a><span class="k">          WRITE</span><span class="p">(</span><span class="n">IterNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">MaxIte</span>
<a name="ln-8196"></a>          <span class="n">IterNum</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">IterNum</span><span class="p">)</span>
<a name="ln-8197"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8198"></a><span class="k">            </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum1</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum1</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-8199"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum1</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8200"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8201"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating heat pump water heater compressor&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8202"></a>                                     <span class="s1">&#39; part-load ratio, maximum iterations = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">IterNum</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8203"></a>                                     <span class="s1">&#39;. Part-load ratio returned = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HPPartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-8204"></a>              <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;This error occurred in heating mode.&#39;</span><span class="p">)</span>
<a name="ln-8205"></a>            <span class="k">ELSE</span>
<a name="ln-8206"></a><span class="k">              CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-8207"></a>                                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8208"></a>              <span class="s1">&#39;&quot;:  Iteration limit exceeded in heating mode warning continues. Part-load ratio statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-8209"></a>              <span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">IterLimitErrIndex1</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">)</span>
<a name="ln-8210"></a>            <span class="k">END IF</span>
<a name="ln-8211"></a><span class="k">          END IF</span>
<a name="ln-8212"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8213"></a><span class="k">          </span><span class="n">HPPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">TankTemp</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="o">-</span> <span class="n">TankTemp</span><span class="p">)))</span>
<a name="ln-8214"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8215"></a><span class="k">            </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum1</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum1</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-8216"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum1</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8217"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8218"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump water heater compressor part-load ratio calculation failed: PLR limits &#39;</span> <span class="p">&amp;</span>
<a name="ln-8219"></a>                               <span class="o">//</span><span class="s1">&#39;of 0 to 1 exceeded. Part-load ratio used = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HPPartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-8220"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Please send this information to the EnergyPlus support group.&#39;</span><span class="p">)</span>
<a name="ln-8221"></a>              <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;This error occured in heating mode.&#39;</span><span class="p">)</span>
<a name="ln-8222"></a>            <span class="k">ELSE</span>
<a name="ln-8223"></a><span class="k">              CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-8224"></a>                                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8225"></a>              <span class="s1">&#39;&quot;:  Part-load ratio calculation failed in heating mode warning continues. Part-load ratio statistics follow.&#39;</span><span class="p">&amp;</span>
<a name="ln-8226"></a>              <span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedIndex1</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">)</span>
<a name="ln-8227"></a>            <span class="k">END IF</span>
<a name="ln-8228"></a><span class="k">          END IF</span>
<a name="ln-8229"></a><span class="k">        END IF</span>
<a name="ln-8230"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-8231"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-8232"></a>          <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-8233"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-8234"></a>          <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">FindStratifiedTankSensedTemp</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8235"></a>                                        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span><span class="p">)</span>
<a name="ln-8236"></a>        <span class="k">END SELECT</span>
<a name="ln-8237"></a><span class="k">      ELSE</span>
<a name="ln-8238"></a><span class="k">        </span><span class="n">HPPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8239"></a>      <span class="k">END IF</span>
<a name="ln-8240"></a>
<a name="ln-8241"></a><span class="c">!       HPWH was floating last iteration and will continue to float until the cut-in temperature is reached</span>
<a name="ln-8242"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">FloatMode</span><span class="p">)</span>
<a name="ln-8243"></a>
<a name="ln-8244"></a><span class="c">!         set the condenser inlet node temperature and full mass flow rate prior to calling the HPWH DX coil</span>
<a name="ln-8245"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-8246"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-8247"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="n">TankTemp</span>
<a name="ln-8248"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">TankTemp</span>
<a name="ln-8249"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-8250"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-8251"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>
<a name="ln-8252"></a>      <span class="k">END SELECT</span>
<a name="ln-8253"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8254"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8255"></a>
<a name="ln-8256"></a><span class="c">!         check tank temperature by setting source inlet mass flow rate to zero</span>
<a name="ln-8257"></a>      <span class="n">HPPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8258"></a>
<a name="ln-8259"></a><span class="c">!         set the full load outlet temperature on the water heater source inlet node (init has already been called)</span>
<a name="ln-8260"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8261"></a>
<a name="ln-8262"></a><span class="c">!         check tank temperature by setting source inlet mass flow rate to zero</span>
<a name="ln-8263"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8264"></a>
<a name="ln-8265"></a><span class="c">!         disable the tank&#39;s internal heating element to find PLR of the HPWH using floating temperatures</span>
<a name="ln-8266"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8267"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8268"></a>      <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-8269"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-8270"></a>        <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8271"></a>        <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-8272"></a>      <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-8273"></a>        <span class="k">CALL </span><span class="n">CalcWaterThermalTankStratified</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8274"></a>        <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">FindStratifiedTankSensedTemp</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8275"></a>                                        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span><span class="p">)</span>
<a name="ln-8276"></a>      <span class="k">END SELECT</span>
<a name="ln-8277"></a>
<a name="ln-8278"></a>
<a name="ln-8279"></a><span class="c">!         reset the tank&#39;s internal heating element capacity</span>
<a name="ln-8280"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-8281"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-8282"></a>
<a name="ln-8283"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="p">(</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8284"></a>
<a name="ln-8285"></a><span class="c">!           HPWH is now in heating mode</span>
<a name="ln-8286"></a>        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">HeatMode</span>
<a name="ln-8287"></a><span class="c">!           reset the water heater&#39;s mode (call above may have changed modes)</span>
<a name="ln-8288"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SaveWHMode</span>
<a name="ln-8289"></a>
<a name="ln-8290"></a><span class="c">!           estimate portion of time step that the HP operates based on a linear interpolation of the tank temperature decay</span>
<a name="ln-8291"></a><span class="c">!           this assumes that all heating sources are off</span>
<a name="ln-8292"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Tanktemp</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">NewTankTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8293"></a><span class="k">          </span><span class="n">HPPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,((</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">DeadbandTempDiff</span><span class="p">)</span> <span class="o">-</span> <span class="n">NewTankTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Tanktemp</span> <span class="o">-</span> <span class="n">NewTankTemp</span><span class="p">)))</span>
<a name="ln-8294"></a>        <span class="k">ELSE</span>
<a name="ln-8295"></a><span class="k">          </span><span class="n">HPPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8296"></a>        <span class="k">END IF</span>
<a name="ln-8297"></a>
<a name="ln-8298"></a><span class="c">!           set the condenser inlet node mass flow rate prior to calling the CalcHPWHDXCoil</span>
<a name="ln-8299"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>    <span class="o">=</span> <span class="n">MdotWater</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8300"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8301"></a>
<a name="ln-8302"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">DXCoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">MdotAir</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8303"></a>
<a name="ln-8304"></a>        <span class="n">HPWHCondInletNodeLast</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8305"></a>        <span class="k">DO </span><span class="n">loopIter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-8306"></a>          <span class="k">CALL </span><span class="n">CalcHPWHDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">)</span>
<a name="ln-8307"></a><span class="c">!         Currently, HPWH heating rate is only a function of inlet evap conditions and air flow rate</span>
<a name="ln-8308"></a><span class="c">!         If HPWH is ever allowed to vary fan speed, this next sub should be called.</span>
<a name="ln-8309"></a><span class="c">!         CALL CalcDOE2DXCoil(DXCoilNum, HPPartLoadRatio, FirstHVACIteration,PartLoadRatio, FanOpMode)</span>
<a name="ln-8310"></a><span class="c">!         (possibly with an iteration loop to converge on a solution)</span>
<a name="ln-8311"></a>          <span class="n">CondenserDeltaT</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8312"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">+</span> <span class="n">CondenserDeltaT</span>
<a name="ln-8313"></a>
<a name="ln-8314"></a><span class="c">!             this CALL does not update node temps, must use WaterThermalTank variables</span>
<a name="ln-8315"></a>        <span class="c">! select tank type</span>
<a name="ln-8316"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-8317"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-8318"></a>            <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8319"></a>            <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-8320"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-8321"></a>            <span class="k">CALL </span><span class="n">CalcWaterThermalTankStratified</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8322"></a>            <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">FindStratifiedTankSensedTemp</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8323"></a>                                        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span><span class="p">)</span>
<a name="ln-8324"></a>          <span class="k">END SELECT</span>
<a name="ln-8325"></a><span class="k">          </span><span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-8326"></a>          <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">HPWHCondInletNodeLast</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SmallTempDiff</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-8327"></a><span class="k">          </span><span class="n">HPWHCondInletNodeLast</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8328"></a>        <span class="k">END DO</span>
<a name="ln-8329"></a>
<a name="ln-8330"></a><span class="c">!           if tank temperature is greater than set point, calculate a PLR needed to exactly reach the set point</span>
<a name="ln-8331"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SetPointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8332"></a><span class="k">          </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="n">FloatMode</span>
<a name="ln-8333"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">SetPointTemp</span>
<a name="ln-8334"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">SaveWHMode</span>
<a name="ln-8335"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-8336"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8337"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8338"></a>          <span class="k">ELSE</span>
<a name="ln-8339"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8340"></a>          <span class="k">END IF</span>
<a name="ln-8341"></a><span class="k">          </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">MdotWater</span>
<a name="ln-8342"></a>          <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">TankTypeNum</span><span class="p">)</span>
<a name="ln-8343"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-8344"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">PLRResidualMixedTank</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-8345"></a>                               <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8346"></a>          <span class="k">CASE</span><span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-8347"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">PLRResidualStratifiedTank</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-8348"></a>                               <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8349"></a>          <span class="k">END SELECT</span>
<a name="ln-8350"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8351"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">IterNum</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">MaxIte</span>
<a name="ln-8352"></a>            <span class="n">IterNum</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">IterNum</span><span class="p">)</span>
<a name="ln-8353"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8354"></a><span class="k">              </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum2</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-8355"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">IterLimitExceededNum2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8356"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8357"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating heat pump water heater compressor&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8358"></a>                                       <span class="s1">&#39; part-load ratio, maximum iterations = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">IterNum</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8359"></a>                                       <span class="s1">&#39;. Part-load ratio returned = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HPPartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-8360"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;This error occurred in float mode.&#39;</span><span class="p">)</span>
<a name="ln-8361"></a>              <span class="k">ELSE</span>
<a name="ln-8362"></a><span class="k">                CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-8363"></a>                                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8364"></a>                <span class="s1">&#39;&quot;:  Iteration limit exceeded in float mode warning continues. Part-load ratio statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-8365"></a>                <span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">IterLimitErrIndex2</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">)</span>
<a name="ln-8366"></a>              <span class="k">END IF</span>
<a name="ln-8367"></a><span class="k">            END IF</span>
<a name="ln-8368"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8369"></a><span class="k">            </span><span class="n">HPPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,(</span><span class="n">SetPointTemp</span> <span class="o">-</span> <span class="n">TankTemp</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NewTankTemp</span> <span class="o">-</span> <span class="n">TankTemp</span><span class="p">)))</span>
<a name="ln-8370"></a>            <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8371"></a><span class="k">              </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum2</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-8372"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedNum2</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8373"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8374"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Heat pump water heater compressor part-load ratio calculation failed: PLR limits &#39;</span> <span class="p">&amp;</span>
<a name="ln-8375"></a>                               <span class="o">//</span><span class="s1">&#39;of 0 to 1 exceeded. Part-load ratio used = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HPPartLoadRatio</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-8376"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Please send this information to the EnergyPlus support group.&#39;</span><span class="p">)</span>
<a name="ln-8377"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;This error occured in float mode.&#39;</span><span class="p">)</span>
<a name="ln-8378"></a>              <span class="k">ELSE</span>
<a name="ln-8379"></a><span class="k">                CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span> <span class="p">&amp;</span>
<a name="ln-8380"></a>                                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-8381"></a>                <span class="s1">&#39;&quot;: Part-load ratio calculation failed in float mode warning continues. Part-load ratio statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-8382"></a>                <span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">RegulaFalsiFailedIndex2</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">)</span>
<a name="ln-8383"></a>              <span class="k">END IF</span>
<a name="ln-8384"></a><span class="k">            END IF</span>
<a name="ln-8385"></a><span class="k">          END IF</span>
<a name="ln-8386"></a><span class="k">        END IF</span>
<a name="ln-8387"></a><span class="k">      END IF</span>
<a name="ln-8388"></a>
<a name="ln-8389"></a><span class="k">    CASE </span><span class="n">DEFAULT</span>
<a name="ln-8390"></a><span class="c">!         Never gets here, only allowed modes for HPWH are float and heat</span>
<a name="ln-8391"></a>  <span class="k">END SELECT</span>
<a name="ln-8392"></a>
<a name="ln-8393"></a><span class="c">! set air-side mass flow rate for final calculation</span>
<a name="ln-8394"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">InletAirMixerNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8395"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">MdotAir</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8396"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>    <span class="o">=</span> <span class="n">MdotAir</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">MixerInletAirSchedule</span><span class="p">)</span>
<a name="ln-8397"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>    <span class="o">=</span> <span class="n">MdotAir</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span> <span class="o">*</span> <span class="n">MixerInletAirSchedule</span>
<a name="ln-8398"></a><span class="c">!   IF HPWH is off, pass zone node conditions through HPWH air-side</span>
<a name="ln-8399"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HPPartLoadRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="n">Node</span><span class="p">(</span><span class="n">InletAirMixerNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)</span>
<a name="ln-8400"></a>  <span class="k">ELSE</span>
<a name="ln-8401"></a><span class="k">    IF</span><span class="p">(</span><span class="n">OutdoorAirNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8402"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>    <span class="o">=</span> <span class="n">MdotAir</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8403"></a>    <span class="k">ELSE</span>
<a name="ln-8404"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">OutdoorAirNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>    <span class="o">=</span> <span class="n">MdotAir</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8405"></a>    <span class="k">END IF</span>
<a name="ln-8406"></a><span class="k">  END IF</span>
<a name="ln-8407"></a><span class="k">  IF</span><span class="p">(</span><span class="n">HPPartLoadRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletTemp</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-8408"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-8409"></a>
<a name="ln-8410"></a><span class="c">! set water-side mass flow rate for final calculation</span>
<a name="ln-8411"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>    <span class="o">=</span> <span class="n">MdotWater</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8412"></a>
<a name="ln-8413"></a><span class="c">! pass node information using resulting PLR</span>
<a name="ln-8414"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanPlacement</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8415"></a><span class="c">!   simulate fan and DX coil twice to pass PLF (OnOffFanPartLoadFraction) to fan</span>
<a name="ln-8416"></a>    <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-8417"></a>    <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8418"></a>                   <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-8419"></a>    <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-8420"></a>    <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8421"></a>                   <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-8422"></a>  <span class="k">ELSE</span>
<a name="ln-8423"></a><span class="c">!   simulate DX coil and fan twice to pass fan power (FanElecPower) to DX coil</span>
<a name="ln-8424"></a>    <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8425"></a>                   <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-8426"></a>    <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-8427"></a>    <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8428"></a>                   <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-8429"></a>    <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-8430"></a>  <span class="k">END IF</span>
<a name="ln-8431"></a>
<a name="ln-8432"></a><span class="c">! set HPWH outlet node equal to the outlet air splitter node conditions if outlet air splitter node exists</span>
<a name="ln-8433"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">OutletAirSplitterNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8434"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletAirSplitterNode</span><span class="p">)</span>
<a name="ln-8435"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">ExhaustAirNode</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletAirSplitterNode</span><span class="p">)</span>
<a name="ln-8436"></a>  <span class="k">END IF</span>
<a name="ln-8437"></a>
<a name="ln-8438"></a><span class="c">! Check schedule to divert air-side cooling to outdoors.</span>
<a name="ln-8439"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirSplitterSchPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8440"></a><span class="k">    </span><span class="n">OutletAirSplitterSch</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutletAirSplitterSchPtr</span><span class="p">)</span>
<a name="ln-8441"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">MdotAir</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">OutletAirSplitterSch</span><span class="p">)</span>
<a name="ln-8442"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">ExhaustAirNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">MdotAir</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span> <span class="o">*</span> <span class="n">OutletAirSplitterSch</span>
<a name="ln-8443"></a>  <span class="k">END IF</span>
<a name="ln-8444"></a>
<a name="ln-8445"></a><span class="k">  </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatingPLR</span>           <span class="o">=</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8446"></a>  <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span>    <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8447"></a>  <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OnCycParaFuelEnergy</span>  <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-8448"></a>  <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span>   <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">HPPartLoadRatio</span><span class="p">)</span>
<a name="ln-8449"></a>  <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-8450"></a>
<a name="ln-8451"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirConfiguration</span><span class="p">)</span>
<a name="ln-8452"></a>
<a name="ln-8453"></a><span class="c">!   no sensible capacity to zone for outdoor and scheduled HPWH</span>
<a name="ln-8454"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">AmbientTempOutsideAir</span><span class="p">)</span>
<a name="ln-8455"></a>      <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPWaterHeaterSensibleCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8456"></a>      <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPWaterHeaterLatentCapacity</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8457"></a>
<a name="ln-8458"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">AmbientTempSchedule</span><span class="p">)</span>
<a name="ln-8459"></a>      <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPWaterHeaterSensibleCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8460"></a>      <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPWaterHeaterLatentCapacity</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8461"></a>
<a name="ln-8462"></a><span class="c">!   calculate sensible capacity to zone for inlet air configuration equals Zone Only or Zone And Outdoor Air configurations</span>
<a name="ln-8463"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-8464"></a>      <span class="n">CpAir</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-8465"></a>
<a name="ln-8466"></a><span class="c">!     add parasitics to zone heat balance if parasitic heat load is to zone otherwise neglect parasitics</span>
<a name="ln-8467"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">ParasiticTempIndicator</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AmbientTempZone</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8468"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPWaterHeaterSensibleCapacity</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-8469"></a>                                        <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8470"></a>                                         <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span> <span class="o">+</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span>
<a name="ln-8471"></a>      <span class="k">ELSE</span>
<a name="ln-8472"></a><span class="k">        </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPWaterHeaterSensibleCapacity</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-8473"></a>                                       <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-8474"></a>      <span class="k">END IF</span>
<a name="ln-8475"></a>
<a name="ln-8476"></a><span class="k">      </span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HPWaterHeaterLatentCapacity</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-8477"></a>                                    <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">HPAirOutletNode</span><span class="p">)%</span><span class="n">HumRat</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">HPAirInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>
<a name="ln-8478"></a>
<a name="ln-8479"></a>  <span class="k">END SELECT</span>
<a name="ln-8480"></a>
<a name="ln-8481"></a><span class="k">  RETURN</span>
<a name="ln-8482"></a>
<a name="ln-8483"></a><span class="k">END SUBROUTINE </span><span class="n">CalcHeatPumpWaterHeater</span>
<a name="ln-8484"></a>
<a name="ln-8485"></a>
<a name="ln-8486"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">PLRResidualMixedTank</span><span class="p">(</span><span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8487"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8488"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-8489"></a>          <span class="c">!       DATE WRITTEN   May 2005</span>
<a name="ln-8490"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-8491"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-8492"></a>
<a name="ln-8493"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8494"></a>          <span class="c">!  Calculates residual function (desired tank temp - actual tank temp)</span>
<a name="ln-8495"></a>          <span class="c">!  HP water heater output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-8496"></a>
<a name="ln-8497"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8498"></a>          <span class="c">!  Calls CalcWaterThermalTankMixed to get tank temperature at the given part load ratio (source water mass flow rate)</span>
<a name="ln-8499"></a>          <span class="c">!  and calculates the residual as defined above</span>
<a name="ln-8500"></a>
<a name="ln-8501"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8502"></a>
<a name="ln-8503"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8504"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8505"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">NumPlantLoops</span>
<a name="ln-8506"></a>
<a name="ln-8507"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8508"></a>
<a name="ln-8509"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8510"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HPPartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-8511"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = HP set point temperature [C]</span>
<a name="ln-8512"></a>                                                  <span class="c">! par(2) = tank mode</span>
<a name="ln-8513"></a>                                                  <span class="c">! par(3) = water heater num</span>
<a name="ln-8514"></a>                                                  <span class="c">! par(4) = FirstHVACIteration</span>
<a name="ln-8515"></a>                                                  <span class="c">! par(5) = MdotWater</span>
<a name="ln-8516"></a>
<a name="ln-8517"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8518"></a>          <span class="c">!  na</span>
<a name="ln-8519"></a>
<a name="ln-8520"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8521"></a>          <span class="c">!  na</span>
<a name="ln-8522"></a>
<a name="ln-8523"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8524"></a>          <span class="c">!  na</span>
<a name="ln-8525"></a>
<a name="ln-8526"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8527"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>     <span class="c">! index of water heater</span>
<a name="ln-8528"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NewTankTemp</span>        <span class="c">! resulting tank temperature [C]</span>
<a name="ln-8529"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-8530"></a>
<a name="ln-8531"></a>  <span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-8532"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8533"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8534"></a>  <span class="c">! FirstHVACIteration is a logical, Par is real, so make 1.0=TRUE and 0.0=FALSE</span>
<a name="ln-8535"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8536"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8537"></a>  <span class="k">ELSE</span>
<a name="ln-8538"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8539"></a>  <span class="k">END IF</span>
<a name="ln-8540"></a><span class="k">  CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8541"></a>  <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-8542"></a>  <span class="n">PLRResidualMixedTank</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">NewTankTemp</span>
<a name="ln-8543"></a>  <span class="k">RETURN</span>
<a name="ln-8544"></a>
<a name="ln-8545"></a><span class="k">END FUNCTION </span><span class="n">PLRResidualMixedTank</span>
<a name="ln-8546"></a>
<a name="ln-8547"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">PLRResidualStratifiedTank</span><span class="p">(</span><span class="n">HPPartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8548"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8549"></a>          <span class="c">!       AUTHOR         B.Griffith,  Richard Raustad</span>
<a name="ln-8550"></a>          <span class="c">!       DATE WRITTEN   Jan 2012</span>
<a name="ln-8551"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-8552"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-8553"></a>
<a name="ln-8554"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8555"></a>          <span class="c">!  Calculates residual function (desired tank temp - actual tank temp)</span>
<a name="ln-8556"></a>          <span class="c">!  HP water heater output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-8557"></a>
<a name="ln-8558"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8559"></a>          <span class="c">!  Calls CalcWaterThermalTankStratified to get tank temperature at the given part load ratio (source water mass flow rate)</span>
<a name="ln-8560"></a>          <span class="c">!  and calculates the residual as defined above</span>
<a name="ln-8561"></a>
<a name="ln-8562"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8563"></a>
<a name="ln-8564"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8565"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8566"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">NumPlantLoops</span>
<a name="ln-8567"></a>
<a name="ln-8568"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8569"></a>
<a name="ln-8570"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8571"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">HPPartLoadRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-8572"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = HP set point temperature [C]</span>
<a name="ln-8573"></a>                                                  <span class="c">! par(2) = tank mode</span>
<a name="ln-8574"></a>                                                  <span class="c">! par(3) = water heater num</span>
<a name="ln-8575"></a>                                                  <span class="c">! par(4) = FirstHVACIteration</span>
<a name="ln-8576"></a>                                                  <span class="c">! par(5) = MdotWater</span>
<a name="ln-8577"></a>
<a name="ln-8578"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8579"></a>          <span class="c">!  na</span>
<a name="ln-8580"></a>
<a name="ln-8581"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8582"></a>          <span class="c">!  na</span>
<a name="ln-8583"></a>
<a name="ln-8584"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8585"></a>          <span class="c">!  na</span>
<a name="ln-8586"></a>
<a name="ln-8587"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8588"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>     <span class="c">! index of water heater</span>
<a name="ln-8589"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NewTankTemp</span>        <span class="c">! resulting tank temperature [C]</span>
<a name="ln-8590"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-8591"></a>
<a name="ln-8592"></a>  <span class="n">WaterThermalTankNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-8593"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-8594"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">HPPartLoadRatio</span>
<a name="ln-8595"></a>  <span class="c">! FirstHVACIteration is a logical, Par is real, so make 1.0=TRUE and 0.0=FALSE</span>
<a name="ln-8596"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8597"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8598"></a>  <span class="k">ELSE</span>
<a name="ln-8599"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8600"></a>  <span class="k">END IF</span>
<a name="ln-8601"></a><span class="k">  CALL </span><span class="n">CalcWaterThermalTankStratified</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8602"></a>  <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">FindStratifiedTankSensedTemp</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8603"></a>                        <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">ControlSensorLocation</span><span class="p">)</span>
<a name="ln-8604"></a>  <span class="n">PLRResidualStratifiedTank</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">NewTankTemp</span>
<a name="ln-8605"></a>  <span class="k">RETURN</span>
<a name="ln-8606"></a>
<a name="ln-8607"></a><span class="k">END FUNCTION </span><span class="n">PLRResidualStratifiedTank</span>
<a name="ln-8608"></a>
<a name="ln-8609"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">PlantMassFlowRatesFunc</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">InNodeNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8610"></a>                                <span class="n">WaterThermalTankSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8611"></a>                                <span class="n">PlantLoopSide</span><span class="p">,</span> <span class="n">PlumbedInSeries</span><span class="p">,</span> <span class="n">BranchControlType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8612"></a>                                <span class="n">OutletTemp</span><span class="p">,</span> <span class="n">DeadBandTemp</span><span class="p">,</span> <span class="n">SetpointTemp</span><span class="p">)</span>
<a name="ln-8613"></a>
<a name="ln-8614"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8615"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8616"></a>          <span class="c">!       DATE WRITTEN   October 2007</span>
<a name="ln-8617"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8618"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8619"></a>
<a name="ln-8620"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8621"></a>          <span class="c">! collect routines for setting flow rates for Water heaters</span>
<a name="ln-8622"></a>          <span class="c">! with plant connections.</span>
<a name="ln-8623"></a>
<a name="ln-8624"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8625"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-8626"></a>
<a name="ln-8627"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8628"></a>          <span class="c">! na</span>
<a name="ln-8629"></a>
<a name="ln-8630"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8631"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-8632"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span>
<a name="ln-8633"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-8634"></a>
<a name="ln-8635"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8636"></a>
<a name="ln-8637"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8638"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>     <span class="c">!</span>
<a name="ln-8639"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InNodeNum</span>          <span class="c">!</span>
<a name="ln-8640"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">!</span>
<a name="ln-8641"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankSide</span>    <span class="c">!</span>
<a name="ln-8642"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PlantLoopSide</span>      <span class="c">!</span>
<a name="ln-8643"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PlumbedInSeries</span>    <span class="c">! !unused1208</span>
<a name="ln-8644"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BranchControlType</span>  <span class="c">!</span>
<a name="ln-8645"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletTemp</span>         <span class="c">!</span>
<a name="ln-8646"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeadBandTemp</span>       <span class="c">!</span>
<a name="ln-8647"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SetpointTemp</span>       <span class="c">!</span>
<a name="ln-8648"></a>
<a name="ln-8649"></a>
<a name="ln-8650"></a>
<a name="ln-8651"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8652"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PassingFlowThru</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-8653"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaybeRequestingFlow</span>  <span class="o">=</span> <span class="mi">2</span>
<a name="ln-8654"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ThrottlingFlow</span>       <span class="o">=</span> <span class="mi">3</span>
<a name="ln-8655"></a>
<a name="ln-8656"></a>          <span class="c">! FUNCTION BLOCK SPECIFICATIONS:</span>
<a name="ln-8657"></a>          <span class="c">! na</span>
<a name="ln-8658"></a>
<a name="ln-8659"></a>          <span class="c">! FUNCTION TYPE DEFINITIONS:</span>
<a name="ln-8660"></a>          <span class="c">! na</span>
<a name="ln-8661"></a>
<a name="ln-8662"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8663"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CurrentMode</span>
<a name="ln-8664"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MassFlowRequest</span>
<a name="ln-8665"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">NeedsHeat</span>
<a name="ln-8666"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">NeedsCool</span>
<a name="ln-8667"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FlowResult</span>
<a name="ln-8668"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ScheduledAvail</span>
<a name="ln-8669"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AltSetpointTemp</span>
<a name="ln-8670"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AltDeadBandTemp</span>
<a name="ln-8671"></a>
<a name="ln-8672"></a>  <span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! init</span>
<a name="ln-8673"></a>  <span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! init</span>
<a name="ln-8674"></a>
<a name="ln-8675"></a>  <span class="c">! determine current mode.  there are three possible</span>
<a name="ln-8676"></a>  <span class="c">!  1.  passing thru what was given to inlet node</span>
<a name="ln-8677"></a>  <span class="c">!  2.  potentially making a flow request</span>
<a name="ln-8678"></a>  <span class="c">!  3.  throttling flow in response to Plant&#39;s restrictions (MassFlowRateMaxAvail)</span>
<a name="ln-8679"></a>  <span class="c">! init default mode to passing thru</span>
<a name="ln-8680"></a>  <span class="n">CurrentMode</span><span class="o">=</span><span class="n">PassingFlowThru</span>   <span class="c">! default</span>
<a name="ln-8681"></a>
<a name="ln-8682"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">PlantLoopSide</span> <span class="o">==</span> <span class="n">DemandSupply_No</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8683"></a><span class="k">    </span><span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">PassingFlowThru</span>
<a name="ln-8684"></a>  <span class="k">Else If</span> <span class="p">(</span><span class="n">PlantLoopSide</span> <span class="o">==</span> <span class="n">SupplySide</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8685"></a>  <span class="c">! If FlowLock is False (0), the tank sets the plant loop mdot</span>
<a name="ln-8686"></a>  <span class="c">! If FlowLock is True (1),  the new resolved plant loop mdot is used</span>
<a name="ln-8687"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseCurrentFlowLock</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8688"></a><span class="k">      </span><span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">PassingFlowThru</span>
<a name="ln-8689"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideLoadRequested</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8690"></a>                 <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">UseSide</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8691"></a><span class="k">        </span><span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">MaybeRequestingFlow</span>
<a name="ln-8692"></a>      <span class="n">ENDIF</span>
<a name="ln-8693"></a>    <span class="k">ELSE</span>
<a name="ln-8694"></a><span class="k">      </span><span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">PassingFlowThru</span>
<a name="ln-8695"></a>
<a name="ln-8696"></a>    <span class="n">ENDIF</span>
<a name="ln-8697"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">SourceSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8698"></a><span class="k">      </span><span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">MaybeRequestingFlow</span>
<a name="ln-8699"></a>    <span class="n">ENDIF</span>
<a name="ln-8700"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">PlantLoopSide</span> <span class="o">==</span> <span class="n">DemandSide</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-8701"></a>    <span class="c">!  1.  pass thru is default</span>
<a name="ln-8702"></a>    <span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">PassingFlowThru</span>
<a name="ln-8703"></a>
<a name="ln-8704"></a>    <span class="c">!  2.  Might be Requesting Flow.</span>
<a name="ln-8705"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8706"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">BranchControlType</span> <span class="o">==</span> <span class="n">ControlType_Bypass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8707"></a><span class="k">         </span><span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">PassingFlowThru</span>
<a name="ln-8708"></a>        <span class="k">ELSE</span>
<a name="ln-8709"></a>         <span class="c">! IF (.not. PlumbedInSeries) THEN</span>
<a name="ln-8710"></a>            <span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">MaybeRequestingFlow</span>
<a name="ln-8711"></a>         <span class="c">! ELSE</span>
<a name="ln-8712"></a>         <span class="c">!   CurrentMode = PassingFlowThru</span>
<a name="ln-8713"></a>         <span class="c">! ENDIF</span>
<a name="ln-8714"></a>        <span class="n">ENDIF</span>
<a name="ln-8715"></a>      <span class="c">! ENDIF</span>
<a name="ln-8716"></a>    <span class="k">ELSE</span> <span class="c">!(.not. FirstHVACIteration)</span>
<a name="ln-8717"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BranchControlType</span> <span class="o">==</span> <span class="n">ControlType_Bypass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8718"></a><span class="k">          </span><span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">PassingFlowThru</span>
<a name="ln-8719"></a>        <span class="k">ELSE</span>
<a name="ln-8720"></a>            <span class="c">! 3.  ThrottlingFlow</span>
<a name="ln-8721"></a>        <span class="c">!  IF (.not. PlumbedInSeries) THEN</span>
<a name="ln-8722"></a>            <span class="n">CurrentMode</span> <span class="o">=</span> <span class="n">ThrottlingFlow</span>
<a name="ln-8723"></a>        <span class="c">!  ELSE</span>
<a name="ln-8724"></a>        <span class="c">!    CurrentMode = PassingFlowThru</span>
<a name="ln-8725"></a>        <span class="c">!  ENDIF</span>
<a name="ln-8726"></a>
<a name="ln-8727"></a>        <span class="n">ENDIF</span>
<a name="ln-8728"></a>    <span class="n">ENDIF</span>
<a name="ln-8729"></a>  <span class="n">ENDIF</span>
<a name="ln-8730"></a>
<a name="ln-8731"></a>  <span class="c">! evaluate Availability schedule,</span>
<a name="ln-8732"></a>  <span class="n">ScheduledAvail</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8733"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">UseSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8734"></a><span class="c">!    IF (WaterThermalTank(WaterThermalTankNum)%UseSideAvailSchedNum &gt; 0) Then</span>
<a name="ln-8735"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideAvailSchedNum</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8736"></a><span class="k">        </span><span class="n">ScheduledAvail</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8737"></a>      <span class="n">ENDIF</span>
<a name="ln-8738"></a><span class="c">!    ENDIF</span>
<a name="ln-8739"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">SourceSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8740"></a><span class="c">!    IF (WaterThermalTank(WaterThermalTankNum)%SourceSideAvailSchedNum &gt; 0) Then</span>
<a name="ln-8741"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAvailSchedNum</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8742"></a><span class="k">        </span><span class="n">ScheduledAvail</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8743"></a>      <span class="n">ENDIF</span>
<a name="ln-8744"></a><span class="c">!    ENDIF</span>
<a name="ln-8745"></a>  <span class="k">END IF</span>
<a name="ln-8746"></a>
<a name="ln-8747"></a>  <span class="c">! now act based on current mode</span>
<a name="ln-8748"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">currentMode</span><span class="p">)</span>
<a name="ln-8749"></a>
<a name="ln-8750"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">PassingFlowThru</span><span class="p">)</span>
<a name="ln-8751"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ScheduledAvail</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-8752"></a><span class="k">      </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-8753"></a>    <span class="k">ELSE</span>
<a name="ln-8754"></a><span class="k">      </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-8755"></a>    <span class="n">ENDIF</span>
<a name="ln-8756"></a>
<a name="ln-8757"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">ThrottlingFlow</span><span class="p">)</span>
<a name="ln-8758"></a>        <span class="c">! first determine what mass flow would be if it is to requested</span>
<a name="ln-8759"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ScheduledAvail</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-8760"></a><span class="k">      </span><span class="n">MassFlowRequest</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-8761"></a>    <span class="k">ELSE</span>
<a name="ln-8762"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">UseSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8763"></a><span class="k">        </span><span class="n">MassFlowRequest</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span>
<a name="ln-8764"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">SourceSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8765"></a><span class="k">        </span><span class="n">MassFlowRequest</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span>
<a name="ln-8766"></a>      <span class="k">END IF</span>
<a name="ln-8767"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-8768"></a>
<a name="ln-8769"></a>    <span class="c">! next determine if tank temperature is such that source side flow might be requested</span>
<a name="ln-8770"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8771"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8772"></a><span class="k">        </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8773"></a>      <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">OutletTemp</span> <span class="o">&gt;=</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;</span> <span class="n">SetpointTemp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8774"></a>        <span class="c">! inside the deadband, use saved mode from water heater calcs</span>
<a name="ln-8775"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">HeatMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8776"></a><span class="k">          </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8777"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">FloatMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8778"></a><span class="k">          </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8779"></a>        <span class="n">ENDIF</span>
<a name="ln-8780"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&gt;=</span> <span class="n">SetpointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8781"></a><span class="k">       </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8782"></a>      <span class="n">ENDIF</span>
<a name="ln-8783"></a>    <span class="k">ELSE</span> <span class="c">! is a chilled water tank so flip logic</span>
<a name="ln-8784"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&gt;</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8785"></a><span class="k">        </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8786"></a>      <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">OutletTemp</span> <span class="o">&lt;=</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&gt;</span> <span class="n">SetpointTemp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8787"></a>        <span class="c">! inside the deadband, use saved mode from water thermal tank calcs (modes only for mixed)</span>
<a name="ln-8788"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">MixedChilledWaterStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8789"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">CoolMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8790"></a><span class="k">            </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8791"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">FloatMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8792"></a><span class="k">            </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8793"></a>          <span class="n">ENDIF</span>
<a name="ln-8794"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedChilledWaterStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8795"></a><span class="k">          </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8796"></a>
<a name="ln-8797"></a>        <span class="n">ENDIF</span>
<a name="ln-8798"></a>
<a name="ln-8799"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;=</span> <span class="n">SetpointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8800"></a><span class="k">       </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8801"></a>      <span class="n">ENDIF</span>
<a name="ln-8802"></a>    <span class="n">ENDIF</span>
<a name="ln-8803"></a>
<a name="ln-8804"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MassFlowRequest</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8805"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">UseSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8806"></a><span class="k">        </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="n">MassFlowRequest</span>
<a name="ln-8807"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">SourceSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8808"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NeedsHeat</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">NeedsCool</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8809"></a><span class="k">          </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="n">MassFlowRequest</span>
<a name="ln-8810"></a>        <span class="k">ELSE</span>
<a name="ln-8811"></a><span class="k">          </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-8812"></a>        <span class="n">ENDIF</span>
<a name="ln-8813"></a>      <span class="k">END IF</span>
<a name="ln-8814"></a><span class="k">    ELSE</span>
<a name="ln-8815"></a><span class="k">     </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-8816"></a>    <span class="n">ENDIF</span>
<a name="ln-8817"></a>
<a name="ln-8818"></a>    <span class="c">! now throttle against MassFlowRateMaxAvail, MassFlowRateMinAvail, MassFlowRateMax, and MassFlowRateMin</span>
<a name="ln-8819"></a>    <span class="c">! see notes about reverse dd compliance (specifically 5ZoneWaterSystems file)</span>
<a name="ln-8820"></a>    <span class="n">FlowResult</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span><span class="p">,</span> <span class="n">FlowResult</span><span class="p">)</span>  <span class="c">! okay for compliance (reverse dd)</span>
<a name="ln-8821"></a>    <span class="n">FlowResult</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMin</span><span class="p">,</span>      <span class="n">FlowResult</span><span class="p">)</span>  <span class="c">! okay for compliance (reverse dd)</span>
<a name="ln-8822"></a>    <span class="n">FlowResult</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="p">,</span> <span class="n">FlowResult</span><span class="p">)</span>
<a name="ln-8823"></a><span class="c">!=&gt; following might take out of reverse dd compliance</span>
<a name="ln-8824"></a>    <span class="n">FlowResult</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span><span class="p">,</span>      <span class="n">FlowResult</span><span class="p">)</span>
<a name="ln-8825"></a>
<a name="ln-8826"></a>    <span class="c">!DSU&gt; use SetComponentFlowRate for above?</span>
<a name="ln-8827"></a>
<a name="ln-8828"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">MaybeRequestingFlow</span><span class="p">)</span>
<a name="ln-8829"></a>
<a name="ln-8830"></a>    <span class="c">! first determine what mass flow would be if it is to requested</span>
<a name="ln-8831"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ScheduledAvail</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-8832"></a><span class="k">      </span><span class="n">MassFlowRequest</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-8833"></a>    <span class="k">ELSE</span>
<a name="ln-8834"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">UseSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8835"></a><span class="k">        IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-8836"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideLoadRequested</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8837"></a><span class="k">          </span><span class="n">MassFlowRequest</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span>
<a name="ln-8838"></a>        <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8839"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideLoadRequested</span> <span class="o">==</span> <span class="mf">0.0D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8840"></a><span class="k">          </span><span class="n">MassFlowRequest</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-8841"></a>        <span class="k">ELSE</span>
<a name="ln-8842"></a><span class="k">          </span><span class="n">MassFlowRequest</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span>
<a name="ln-8843"></a>        <span class="n">ENDIF</span>
<a name="ln-8844"></a>
<a name="ln-8845"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">SourceSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8846"></a><span class="k">        </span><span class="n">MassFlowRequest</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span>
<a name="ln-8847"></a>      <span class="k">END IF</span>
<a name="ln-8848"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-8849"></a>
<a name="ln-8850"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTankSide</span> <span class="o">==</span> <span class="n">SourceSide</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! temperature dependent controls for indirect heating/cooling</span>
<a name="ln-8851"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8852"></a>        <span class="c">! next determine if tank temperature is such that flow is requested depending on mode</span>
<a name="ln-8853"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">==</span> <span class="n">SourceSideIndirectHeatPrimarySetpoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8854"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8855"></a><span class="k">            </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8856"></a>          <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">OutletTemp</span> <span class="o">&gt;=</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;</span> <span class="n">SetpointTemp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8857"></a>            <span class="c">! inside the deadband, use saved mode from water heater calcs</span>
<a name="ln-8858"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">HeatMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8859"></a><span class="k">              </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8860"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">FloatMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8861"></a><span class="k">              </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8862"></a>            <span class="n">ENDIF</span>
<a name="ln-8863"></a>
<a name="ln-8864"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&gt;=</span> <span class="n">SetpointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8865"></a><span class="k">           </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8866"></a>          <span class="n">ENDIF</span>
<a name="ln-8867"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">==</span> <span class="n">SourceSideIndirectHeatAltSetpoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8868"></a>          <span class="c">! get alternate setpoint </span>
<a name="ln-8869"></a>          <span class="n">AltSetpointTemp</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideAltSetpointSchedNum</span><span class="p">)</span>
<a name="ln-8870"></a>          <span class="n">AltDeadBandTemp</span> <span class="o">=</span>  <span class="n">AltSetpointTemp</span>  <span class="o">-</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DeadbandDeltaTemp</span>
<a name="ln-8871"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;</span> <span class="n">AltDeadBandTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8872"></a><span class="k">            </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8873"></a>          <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">OutletTemp</span> <span class="o">&gt;=</span> <span class="n">AltDeadBandTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;</span> <span class="n">AltSetpointTemp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8874"></a>            <span class="c">! inside the deadband, use saved mode from water heater calcs</span>
<a name="ln-8875"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">HeatMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8876"></a><span class="k">              </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8877"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">FloatMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8878"></a><span class="k">              </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8879"></a>            <span class="n">ENDIF</span>
<a name="ln-8880"></a>
<a name="ln-8881"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&gt;=</span> <span class="n">AltSetpointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8882"></a><span class="k">           </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8883"></a>          <span class="n">ENDIF</span>
<a name="ln-8884"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideControlMode</span> <span class="o">==</span> <span class="n">SourceSideStorageTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8885"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&lt;</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTempLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8886"></a><span class="k">            </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8887"></a>          <span class="k">ELSE</span>
<a name="ln-8888"></a><span class="k">            </span><span class="n">NeedsHeat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8889"></a>          <span class="n">ENDIF</span>
<a name="ln-8890"></a>
<a name="ln-8891"></a>        <span class="n">ENDIF</span>
<a name="ln-8892"></a>      <span class="k">ELSE</span> <span class="c">! is a chilled water tank so flip logic</span>
<a name="ln-8893"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&gt;</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8894"></a><span class="k">          </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8895"></a>        <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">OutletTemp</span> <span class="o">&lt;=</span> <span class="n">DeadBandTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&gt;</span> <span class="n">SetpointTemp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8896"></a>        <span class="c">! inside the deadband, use saved mode from water thermal tank calcs (modes only for mixed)</span>
<a name="ln-8897"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">MixedChilledWaterStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8898"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">CoolMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8899"></a><span class="k">              </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8900"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">==</span> <span class="n">FloatMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8901"></a><span class="k">              </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8902"></a>            <span class="n">ENDIF</span>
<a name="ln-8903"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedChilledWaterStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8904"></a><span class="k">            </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8905"></a>          <span class="n">ENDIF</span>
<a name="ln-8906"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">OutletTemp</span> <span class="o">&gt;=</span> <span class="n">SetpointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8907"></a><span class="k">         </span><span class="n">NeedsCool</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8908"></a>        <span class="n">ENDIF</span>
<a name="ln-8909"></a>
<a name="ln-8910"></a>      <span class="n">ENDIF</span> <span class="c">! chilled water</span>
<a name="ln-8911"></a>
<a name="ln-8912"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MassFlowRequest</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8913"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NeedsHeat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">NeedsCool</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8914"></a><span class="k">          </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="n">MassFlowRequest</span>
<a name="ln-8915"></a>        <span class="k">ELSE</span>
<a name="ln-8916"></a><span class="k">          </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-8917"></a>        <span class="n">ENDIF</span>
<a name="ln-8918"></a>      <span class="k">ELSE</span>
<a name="ln-8919"></a><span class="k">        </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-8920"></a>      <span class="n">ENDIF</span>
<a name="ln-8921"></a>    <span class="k">Else</span> <span class="c">! end source side, begin use side</span>
<a name="ln-8922"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">MassFlowRequest</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8923"></a><span class="k">        </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="n">MassFlowRequest</span>
<a name="ln-8924"></a>      <span class="k">ELSE</span>
<a name="ln-8925"></a><span class="k">        </span><span class="n">FlowResult</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-8926"></a>      <span class="n">ENDIF</span>
<a name="ln-8927"></a>    <span class="n">ENDIF</span>
<a name="ln-8928"></a><span class="c">!    IF (FirstHVACIteration) Then</span>
<a name="ln-8929"></a><span class="c">!      Node(InNodeNum)%MassFlowRateMaxAvail = FlowResult</span>
<a name="ln-8930"></a><span class="c">!      Node(InNodeNum)%MassFlowRateMinAvail = 0.0D0</span>
<a name="ln-8931"></a><span class="c">!    ENDIF</span>
<a name="ln-8932"></a>
<a name="ln-8933"></a>  <span class="k">END SELECT</span>
<a name="ln-8934"></a>
<a name="ln-8935"></a><span class="k">  </span><span class="n">PlantMassFlowRatesFunc</span> <span class="o">=</span> <span class="n">FlowResult</span>
<a name="ln-8936"></a>
<a name="ln-8937"></a>  <span class="k">RETURN</span>
<a name="ln-8938"></a>
<a name="ln-8939"></a><span class="k">END FUNCTION </span><span class="n">PlantMassFlowRatesFunc</span>
<a name="ln-8940"></a>
<a name="ln-8941"></a><span class="k">SUBROUTINE </span><span class="n">MinePlantStructForInfo</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-8942"></a>
<a name="ln-8943"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8944"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-8945"></a>          <span class="c">!       DATE WRITTEN   October 2007</span>
<a name="ln-8946"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8947"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8948"></a>
<a name="ln-8949"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8950"></a>          <span class="c">! get information from plant loop data structure</span>
<a name="ln-8951"></a>          <span class="c">! check what we can learn from plant structure against user inputs</span>
<a name="ln-8952"></a>
<a name="ln-8953"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8954"></a>          <span class="c">! looping</span>
<a name="ln-8955"></a>
<a name="ln-8956"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8957"></a>          <span class="c">! na</span>
<a name="ln-8958"></a>
<a name="ln-8959"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8960"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span> <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">NumPlantLoops</span>
<a name="ln-8961"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-8962"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-8963"></a>
<a name="ln-8964"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8965"></a>
<a name="ln-8966"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8967"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">In</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-8968"></a>
<a name="ln-8969"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8970"></a>          <span class="c">! na</span>
<a name="ln-8971"></a>
<a name="ln-8972"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8973"></a>          <span class="c">! na</span>
<a name="ln-8974"></a>
<a name="ln-8975"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8976"></a>          <span class="c">! na</span>
<a name="ln-8977"></a>
<a name="ln-8978"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8979"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">PlantLoopNum</span>            <span class="c">! Used for looking up plant info</span>
<a name="ln-8980"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">LoopSideNum</span>             <span class="c">! Used for looking up plant info</span>
<a name="ln-8981"></a><span class="c">!unused  INTEGER             :: BranchNum               ! Used for looking up plant info</span>
<a name="ln-8982"></a><span class="c">!  INTEGER             :: CompNum                 ! Used for looking up plant info</span>
<a name="ln-8983"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SplitNum</span>                <span class="c">! used for checking series parallel in plant</span>
<a name="ln-8984"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">UseInletNode</span>            <span class="c">! Water heater use inlet node number</span>
<a name="ln-8985"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SourceInletNode</span>         <span class="c">! Water heater source inlet node number</span>
<a name="ln-8986"></a>  <span class="kt">Logical</span>             <span class="kd">::</span> <span class="n">errorsFound</span>
<a name="ln-8987"></a>
<a name="ln-8988"></a>  <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8989"></a>
<a name="ln-8990"></a>  <span class="c">!IF (WaterThermalTank(WaterThermalTankNum)%PlantStructureCheck .AND. ALLOCATED(PlantLoop)) THEN</span>
<a name="ln-8991"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8992"></a>
<a name="ln-8993"></a>    <span class="c">! check plant structure for useful data.</span>
<a name="ln-8994"></a>
<a name="ln-8995"></a>    <span class="n">UseInletNode</span>  <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span>
<a name="ln-8996"></a>    <span class="n">PlantLoopNum</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span>
<a name="ln-8997"></a>    <span class="n">LoopSideNum</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span>
<a name="ln-8998"></a>
<a name="ln-8999"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9000"></a>        <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantSizNum</span>  <span class="o">==</span>  <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9001"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Water heater = &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9002"></a>                            <span class="s1">&#39; for autosizing Use side flow rate, did not find Sizing:Plant object &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9003"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9004"></a>      <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9005"></a>    <span class="n">ENDIF</span>
<a name="ln-9006"></a>    <span class="c">!Is this wh Use side plumbed in series (default) or are there other branches in parallel?</span>
<a name="ln-9007"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">Splitter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9008"></a><span class="k">      DO </span><span class="n">SplitNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">NumSplitters</span>
<a name="ln-9009"></a>        <span class="k">If</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">Splitter</span><span class="p">(</span><span class="n">SplitNum</span><span class="p">)%</span><span class="n">NodeNumOut</span> <span class="p">&amp;</span>
<a name="ln-9010"></a>               <span class="o">==</span> <span class="n">UseInletNode</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! this wh is on the splitter</span>
<a name="ln-9011"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">Splitter</span><span class="p">(</span><span class="n">SplitNum</span><span class="p">)%</span><span class="n">TotalOutletNodes</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9012"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSideSeries</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9013"></a>          <span class="n">ENDIF</span>
<a name="ln-9014"></a>        <span class="n">ENDIF</span>
<a name="ln-9015"></a>      <span class="n">ENDDO</span>
<a name="ln-9016"></a>    <span class="n">ENDIF</span>
<a name="ln-9017"></a>  <span class="n">ENDIF</span>
<a name="ln-9018"></a>
<a name="ln-9019"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9020"></a><span class="k">    </span><span class="n">SourceInletNode</span>  <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span>
<a name="ln-9021"></a>    <span class="n">PlantLoopNum</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span>
<a name="ln-9022"></a>    <span class="n">LoopSideNum</span><span class="o">=</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span>
<a name="ln-9023"></a>    <span class="c">! was user&#39;s input correct for plant loop name?</span>
<a name="ln-9024"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9025"></a>        <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantSizNum</span>  <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>    <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9026"></a>        <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">DesuperheaterNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9027"></a>        <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9028"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Water heater = &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9029"></a>                            <span class="s1">&#39;for autosizing Source side flow rate, did not find Sizing:Plant object &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9030"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9031"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9032"></a>    <span class="n">ENDIF</span>
<a name="ln-9033"></a>    <span class="c">!Is this wh Source side plumbed in series (default) or are there other branches in parallel?</span>
<a name="ln-9034"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">Splitter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9035"></a><span class="k">      DO </span><span class="n">SplitNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">NumSplitters</span>
<a name="ln-9036"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ANY</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">Splitter</span><span class="p">(</span><span class="n">SplitNum</span><span class="p">)%</span><span class="n">NodeNumOut</span> <span class="p">&amp;</span>
<a name="ln-9037"></a>            <span class="o">==</span> <span class="n">SourceInletNode</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! this wh is on the splitter</span>
<a name="ln-9038"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">PlantLoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">)%</span><span class="n">Splitter</span><span class="p">(</span><span class="n">SplitNum</span><span class="p">)%</span><span class="n">TotalOutletNodes</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9039"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSideSeries</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9040"></a>          <span class="n">ENDIF</span>
<a name="ln-9041"></a>        <span class="n">ENDIF</span>
<a name="ln-9042"></a>      <span class="n">ENDDO</span>
<a name="ln-9043"></a>    <span class="n">ENDIF</span>
<a name="ln-9044"></a>  <span class="n">ENDIF</span>
<a name="ln-9045"></a>
<a name="ln-9046"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">errorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9047"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding water heater input errors cause program termination&#39;</span><span class="p">)</span>
<a name="ln-9048"></a>  <span class="n">ENDIF</span>
<a name="ln-9049"></a>
<a name="ln-9050"></a>  <span class="k">RETURN</span>
<a name="ln-9051"></a>
<a name="ln-9052"></a><span class="k">END SUBROUTINE </span><span class="n">MinePlantStructForInfo</span>
<a name="ln-9053"></a>
<a name="ln-9054"></a><span class="k">SUBROUTINE </span><span class="n">SizeSupplySidePlantConnections</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span> <span class="n">LoopNum</span><span class="p">,</span> <span class="n">LoopSideNum</span><span class="p">)</span>
<a name="ln-9055"></a>
<a name="ln-9056"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9057"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9058"></a>          <span class="c">!       DATE WRITTEN   October 2007</span>
<a name="ln-9059"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9060"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9061"></a>
<a name="ln-9062"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9063"></a>          <span class="c">! This subroutine is for sizing water heater plant connection flow rates</span>
<a name="ln-9064"></a>          <span class="c">! on the supply that have not been specified in the input.</span>
<a name="ln-9065"></a>
<a name="ln-9066"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9067"></a>          <span class="c">! This routine is called later in the simulation than the sizing routine for the demand side</span>
<a name="ln-9068"></a>          <span class="c">!  because the simulation needs to be further along before the needed data are available.</span>
<a name="ln-9069"></a>          <span class="c">! For water heaters sides on Supply loopside, obtains hot water flow rate from the plant sizing array</span>
<a name="ln-9070"></a>          <span class="c">!  (adapted approach from boiler sizing routines)</span>
<a name="ln-9071"></a>
<a name="ln-9072"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9073"></a>          <span class="c">! na</span>
<a name="ln-9074"></a>
<a name="ln-9075"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9076"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-9077"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-9078"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowWarningError</span>
<a name="ln-9079"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallWaterVolFlow</span><span class="p">,</span> <span class="n">NumPlantLoops</span>
<a name="ln-9080"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span>
<a name="ln-9081"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-9082"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-9083"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-9084"></a>
<a name="ln-9085"></a>
<a name="ln-9086"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9087"></a>
<a name="ln-9088"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9089"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-9090"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">LoopNum</span>
<a name="ln-9091"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">LoopSideNum</span>
<a name="ln-9092"></a>
<a name="ln-9093"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9094"></a>          <span class="c">! na</span>
<a name="ln-9095"></a>
<a name="ln-9096"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9097"></a>          <span class="c">! na</span>
<a name="ln-9098"></a>
<a name="ln-9099"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9100"></a>          <span class="c">! na</span>
<a name="ln-9101"></a>
<a name="ln-9102"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9103"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">PltSizNum</span>     <span class="c">! Plant Sizing index corresponding to CurLoopNum</span>
<a name="ln-9104"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">ErrorsFound</span>   <span class="c">! If errors detected in input</span>
<a name="ln-9105"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span> <span class="c">!temporary fluid density</span>
<a name="ln-9107"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">tmpLoopNum</span>
<a name="ln-9108"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">tmpLoopSideNum</span>
<a name="ln-9109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpUseDesignVolFlowRate</span> <span class="c">! local use side design flow rate</span>
<a name="ln-9110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpSourceDesignVolFlowRate</span> <span class="c">! local source side design flow rate</span>
<a name="ln-9111"></a>
<a name="ln-9112"></a>  <span class="n">PltSizNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9113"></a>  <span class="n">ErrorsFound</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9114"></a>  <span class="n">tmpUseDesignVolFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>
<a name="ln-9115"></a>  <span class="n">tmpSourceDesignVolFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span>
<a name="ln-9116"></a>
<a name="ln-9117"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">PRESENT</span><span class="p">(</span><span class="n">LoopSideNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9118"></a><span class="k">    </span><span class="n">tmpLoopSideNum</span> <span class="o">=</span> <span class="n">SupplySide</span>
<a name="ln-9119"></a>  <span class="k">ELSE</span>
<a name="ln-9120"></a><span class="k">    </span><span class="n">tmpLoopSideNum</span> <span class="o">=</span> <span class="n">LoopSideNum</span>
<a name="ln-9121"></a>  <span class="n">ENDIF</span>
<a name="ln-9122"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">PRESENT</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9123"></a><span class="k">    </span><span class="n">tmpLoopNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span>
<a name="ln-9124"></a>  <span class="k">ELSE</span>
<a name="ln-9125"></a><span class="k">    </span><span class="n">tmpLoopNum</span> <span class="o">=</span> <span class="n">LoopNum</span>
<a name="ln-9126"></a>  <span class="n">ENDIF</span>
<a name="ln-9127"></a>
<a name="ln-9128"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9129"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">tmpLoopNum</span> <span class="o">==</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9130"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9131"></a><span class="k">      </span><span class="n">PltSizNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantSizNum</span>
<a name="ln-9132"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! we have a Plant Sizing Object</span>
<a name="ln-9133"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">==</span> <span class="n">SupplySide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9134"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9135"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9136"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span>
<a name="ln-9137"></a>            <span class="k">ELSE</span>
<a name="ln-9138"></a><span class="k">              </span><span class="n">tmpUseDesignVolFlowRate</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span>
<a name="ln-9139"></a>            <span class="n">ENDIF</span>
<a name="ln-9140"></a>          <span class="k">ELSE</span>
<a name="ln-9141"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9142"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-9143"></a>            <span class="k">ELSE</span>
<a name="ln-9144"></a><span class="k">              </span><span class="n">tmpUseDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-9145"></a>            <span class="n">ENDIF</span>
<a name="ln-9146"></a>          <span class="k">END IF</span>
<a name="ln-9147"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-9148"></a>             <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9149"></a>                                <span class="s1">&#39;Use Side Design Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9150"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9151"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9152"></a><span class="k">            CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9153"></a>                                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9154"></a>          <span class="k">ELSE</span>
<a name="ln-9155"></a><span class="k">            CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9156"></a>                                                <span class="n">tmpUseDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9157"></a>          <span class="n">ENDIF</span>
<a name="ln-9158"></a>
<a name="ln-9159"></a>          <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9160"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9161"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9162"></a>                                 <span class="s1">&#39;SizeSupplySidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-9163"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9164"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9165"></a>                 <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">*</span> <span class="n">rho</span>
<a name="ln-9166"></a>          <span class="k">ELSE</span>
<a name="ln-9167"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span>  <span class="o">=</span> <span class="n">tmpUseDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-9168"></a>          <span class="n">ENDIF</span>
<a name="ln-9169"></a>        <span class="k">END IF</span>
<a name="ln-9170"></a><span class="k">      ELSE</span>
<a name="ln-9171"></a>         <span class="c">! do nothing</span>
<a name="ln-9172"></a>      <span class="n">ENDIF</span> <span class="c">!plant sizing object</span>
<a name="ln-9173"></a>    <span class="k">ELSE</span>
<a name="ln-9174"></a><span class="k">      CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-9175"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9176"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9177"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9178"></a>                                   <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9179"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9180"></a>                                   <span class="s1">&#39;SizeSupplySidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-9181"></a>      <span class="k">ELSE</span>
<a name="ln-9182"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeSupplySidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-9183"></a>      <span class="n">ENDIF</span>
<a name="ln-9184"></a>
<a name="ln-9185"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9186"></a>                 <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">*</span> <span class="n">rho</span>
<a name="ln-9187"></a>
<a name="ln-9188"></a>    <span class="k">END IF</span> <span class="c">!autosizing needed.</span>
<a name="ln-9189"></a>  <span class="n">ENDIF</span> <span class="c">! connected to plant</span>
<a name="ln-9190"></a>
<a name="ln-9191"></a>
<a name="ln-9192"></a>
<a name="ln-9193"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9194"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">tmpLoopNum</span> <span class="o">==</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9195"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sourceDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9196"></a><span class="k">      </span><span class="n">PltSizNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantSizNum</span>
<a name="ln-9197"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9198"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">==</span> <span class="n">SupplySide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9199"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallWaterVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9200"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9201"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span>
<a name="ln-9202"></a>            <span class="k">ELSE</span>
<a name="ln-9203"></a><span class="k">              </span><span class="n">tmpSourceDesignVolFlowRate</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">DesVolFlowRate</span>
<a name="ln-9204"></a>            <span class="n">ENDIF</span>
<a name="ln-9205"></a>          <span class="k">ELSE</span>
<a name="ln-9206"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9207"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9208"></a>            <span class="k">ELSE</span>
<a name="ln-9209"></a><span class="k">              </span><span class="n">tmpSourceDesignVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-9210"></a>            <span class="n">ENDIF</span>
<a name="ln-9211"></a>          <span class="k">END IF</span>
<a name="ln-9212"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-9213"></a>             <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9214"></a>                                                     <span class="s1">&#39;Source Side Design Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9215"></a>                                                     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9216"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9217"></a><span class="k">            CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9218"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9219"></a>          <span class="k">ELSE</span>
<a name="ln-9220"></a><span class="k">            CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">,</span> <span class="n">tmpSourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9221"></a>          <span class="n">ENDIF</span>
<a name="ln-9222"></a>          <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9223"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9224"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9225"></a>                                 <span class="s1">&#39;SizeSupplySidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-9226"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9227"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9228"></a>                           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-9229"></a>          <span class="k">ELSE</span>
<a name="ln-9230"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="n">tmpSourceDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-9231"></a>          <span class="n">ENDIF</span>
<a name="ln-9232"></a>        <span class="k">END IF</span> <span class="c">! plant loop allocation</span>
<a name="ln-9233"></a>      <span class="k">ELSE</span>
<a name="ln-9234"></a>        <span class="c">! do nothing</span>
<a name="ln-9235"></a>      <span class="n">ENDIF</span> <span class="c">!plant sizing object</span>
<a name="ln-9236"></a>    <span class="k">ELSE</span>
<a name="ln-9237"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">==</span> <span class="n">SupplySide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9238"></a><span class="k">        CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9239"></a>                 <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9240"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9241"></a><span class="k">          </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9242"></a>                                   <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9243"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9244"></a>                                   <span class="s1">&#39;SizeSupplySidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-9245"></a>        <span class="k">ELSE</span>
<a name="ln-9246"></a><span class="k">          </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeSupplySidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-9247"></a>        <span class="n">ENDIF</span>
<a name="ln-9248"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9249"></a>                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-9250"></a>      <span class="n">ENDIF</span>
<a name="ln-9251"></a>    <span class="k">END IF</span> <span class="c">!autosizing needed.</span>
<a name="ln-9252"></a>  <span class="n">ENDIF</span> <span class="c">! connected to plant</span>
<a name="ln-9253"></a>
<a name="ln-9254"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9255"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding sizing errors cause program termination&#39;</span><span class="p">)</span>
<a name="ln-9256"></a>  <span class="k">END IF</span>
<a name="ln-9257"></a>
<a name="ln-9258"></a><span class="k">  RETURN</span>
<a name="ln-9259"></a><span class="k">END SUBROUTINE </span><span class="n">SizeSupplySidePlantConnections</span>
<a name="ln-9260"></a>
<a name="ln-9261"></a><span class="k">SUBROUTINE </span><span class="n">SizeTankForDemandSide</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-9262"></a>
<a name="ln-9263"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9264"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9265"></a>          <span class="c">!       DATE WRITTEN   February 2008</span>
<a name="ln-9266"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9267"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9268"></a>
<a name="ln-9269"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9270"></a>          <span class="c">! This subroutine is for sizing water heater tank volume and heater</span>
<a name="ln-9271"></a>          <span class="c">!  as best we can at this point in simulation. (prior to demand side</span>
<a name="ln-9272"></a>          <span class="c">!  sizing that needs volume).</span>
<a name="ln-9273"></a>
<a name="ln-9274"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9275"></a>          <span class="c">!  depending on the sizing design mode...</span>
<a name="ln-9276"></a>          <span class="c">!</span>
<a name="ln-9277"></a>
<a name="ln-9278"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9279"></a>          <span class="c">! BA benchmark report for residential design mode</span>
<a name="ln-9280"></a>
<a name="ln-9281"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9282"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-9283"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">zone</span>
<a name="ln-9284"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-9285"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-9286"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PI</span>
<a name="ln-9287"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowWarningError</span>
<a name="ln-9288"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallWaterVolFlow</span><span class="p">,</span> <span class="n">NumPlantLoops</span>
<a name="ln-9289"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGLycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-9290"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-9291"></a>  <span class="k">USE </span><span class="n">SolarCollectors</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Collector</span><span class="p">,</span> <span class="n">NumOfCollectors</span>
<a name="ln-9292"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Surface</span>
<a name="ln-9293"></a>
<a name="ln-9294"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9295"></a>
<a name="ln-9296"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9297"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-9298"></a>
<a name="ln-9299"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9300"></a>          <span class="c">! na</span>
<a name="ln-9301"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">GalTocubicMeters</span> <span class="o">=</span> <span class="mf">0.0037854D0</span>
<a name="ln-9302"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">kBtuPerHrToWatts</span> <span class="o">=</span> <span class="mi">29</span><span class="mf">3.1D0</span>
<a name="ln-9303"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9304"></a>          <span class="c">! na</span>
<a name="ln-9305"></a>
<a name="ln-9306"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9307"></a>          <span class="c">! na</span>
<a name="ln-9308"></a>
<a name="ln-9309"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9310"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tstart</span>        <span class="c">! initial tank temp for sizing.</span>
<a name="ln-9311"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tfinish</span>       <span class="c">! final target temp for sizing</span>
<a name="ln-9312"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SumPeopleAllZones</span>
<a name="ln-9313"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SumFloorAreaAllZones</span>
<a name="ln-9314"></a><span class="c">!unused  INTEGER   :: CollectorNum  ! do loop index</span>
<a name="ln-9315"></a>  <span class="kt">Logical</span>   <span class="kd">::</span> <span class="n">SizeVolume</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9316"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">SizeMaxCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9317"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-9318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-9319"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpTankVolume</span> <span class="c">! local temporary for tank volume m3</span>
<a name="ln-9321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpMaxCapacity</span> <span class="c">! local temporary for heating capacity W</span>
<a name="ln-9322"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9323"></a>
<a name="ln-9324"></a>  <span class="c">! local inits</span>
<a name="ln-9325"></a>  <span class="n">Tstart</span>  <span class="o">=</span> <span class="mi">1</span><span class="mf">4.44d0</span>
<a name="ln-9326"></a>  <span class="n">TFinish</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">7.22d0</span>
<a name="ln-9327"></a>  <span class="n">SizeVolume</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9328"></a>  <span class="n">SizeMaxCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9329"></a>
<a name="ln-9330"></a>  <span class="n">tmpTankVolume</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>
<a name="ln-9331"></a>  <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-9332"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">tmpTankVolume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">SizeVolume</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9333"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">tmpMaxCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">SizeMaxCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9334"></a>
<a name="ln-9335"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span><span class="p">)</span>
<a name="ln-9336"></a>
<a name="ln-9337"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SizeNotSet</span><span class="p">)</span>
<a name="ln-9338"></a>
<a name="ln-9339"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePeakDraw</span><span class="p">)</span>
<a name="ln-9340"></a>
<a name="ln-9341"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SizeResidentialMin</span><span class="p">)</span>
<a name="ln-9342"></a>
<a name="ln-9343"></a>    <span class="c">! assume can propagate rules for gas to other fuels.</span>
<a name="ln-9344"></a>    <span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9345"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9346"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9347"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Diesel&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9348"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9349"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Gasoline&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9350"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9351"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Coal&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9352"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9353"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;FuelOil#1&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9354"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9355"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;FuelOil#2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9356"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9357"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Propane&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9358"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9359"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9360"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9361"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;OtherFuel1&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9362"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9363"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;OtherFuel2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9364"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9365"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9366"></a><span class="k">      </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9367"></a>    <span class="n">ENDIF</span>
<a name="ln-9368"></a>
<a name="ln-9369"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9370"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9371"></a><span class="k">        If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>   <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9372"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span>  <span class="o">=</span> <span class="mf">2.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!2.5 kW</span>
<a name="ln-9373"></a>      <span class="k">else if</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9374"></a><span class="k">        If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9375"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">7.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!27kBtu/hr</span>
<a name="ln-9376"></a>      <span class="n">endif</span>
<a name="ln-9377"></a>
<a name="ln-9378"></a>    <span class="k">Else If</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9379"></a><span class="k">      If</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;=</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9380"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9381"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">3</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9382"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">3.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!3.5 kW</span>
<a name="ln-9383"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9384"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">3</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9385"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-9386"></a>        <span class="n">ENDIF</span>
<a name="ln-9387"></a>      <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9388"></a>               <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;</span> <span class="mf">3.0D0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-9389"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9390"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9391"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">4.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!4.5 kW</span>
<a name="ln-9392"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9393"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">3</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9394"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-9395"></a>        <span class="n">ENDIF</span>
<a name="ln-9396"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;=</span> <span class="mf">3.0D0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9397"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9398"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9399"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-9400"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9401"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span> <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9402"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-9403"></a>        <span class="n">ENDIF</span>
<a name="ln-9404"></a>      <span class="n">ENDIF</span>
<a name="ln-9405"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9406"></a><span class="k">      If</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;=</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9407"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9408"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9409"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">4.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!4.5 kW</span>
<a name="ln-9410"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9411"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">3</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9412"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-9413"></a>        <span class="n">ENDIF</span>
<a name="ln-9414"></a>      <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9415"></a>               <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;</span> <span class="mf">3.0D0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-9416"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9417"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9418"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-9419"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9420"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9421"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-9422"></a>        <span class="n">ENDIF</span>
<a name="ln-9423"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;=</span> <span class="mf">3.0D0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9424"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9425"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9426"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-9427"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9428"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9429"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">8.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!38 kBtu/hr</span>
<a name="ln-9430"></a>        <span class="n">ENDIF</span>
<a name="ln-9431"></a>      <span class="n">ENDIF</span>
<a name="ln-9432"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9433"></a><span class="k">      If</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;=</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9434"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9435"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9436"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-9437"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9438"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9439"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-9440"></a>        <span class="n">ENDIF</span>
<a name="ln-9441"></a>      <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9442"></a>               <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;</span> <span class="mf">3.0D0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-9443"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9444"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9445"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-9446"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9447"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9448"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">8.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!38 kBtu/hr</span>
<a name="ln-9449"></a>        <span class="n">ENDIF</span>
<a name="ln-9450"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;=</span> <span class="mf">3.0D0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9451"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9452"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">6</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9453"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-9454"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9455"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9456"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">8.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!38 kBtu/hr</span>
<a name="ln-9457"></a>        <span class="n">ENDIF</span>
<a name="ln-9458"></a>      <span class="n">ENDIF</span>
<a name="ln-9459"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">5</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9460"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9461"></a><span class="k">        If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">6</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9462"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-9463"></a>      <span class="k">else if</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9464"></a><span class="k">        If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9465"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">4</span><span class="mf">7.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!47 kBtu/hr</span>
<a name="ln-9466"></a>      <span class="n">endif</span>
<a name="ln-9467"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">&gt;=</span> <span class="mi">6</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9468"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9469"></a><span class="k">        If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">6</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9470"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-9471"></a>      <span class="k">else if</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-9472"></a><span class="k">        If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-9473"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!50 kBtu/hr</span>
<a name="ln-9474"></a>      <span class="n">endif</span>
<a name="ln-9475"></a>    <span class="n">ENDIF</span>
<a name="ln-9476"></a>
<a name="ln-9477"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9478"></a><span class="k">       </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-9479"></a>       <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9480"></a>                               <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9481"></a>                              <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-9482"></a>    <span class="n">ENDIF</span>
<a name="ln-9483"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9484"></a><span class="k">       </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-9485"></a>       <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9486"></a>       <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9487"></a>                           <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-9488"></a>    <span class="n">ENDIF</span>
<a name="ln-9489"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerPerson</span><span class="p">)</span>
<a name="ln-9490"></a>    <span class="c">! how to get number of people?</span>
<a name="ln-9491"></a>
<a name="ln-9492"></a>    <span class="n">SumPeopleAllZones</span> <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">TotOccupants</span><span class="p">)</span>
<a name="ln-9493"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="n">tmpTankVolume</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-9494"></a>       <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TankCapacityPerPerson</span> <span class="p">&amp;</span>
<a name="ln-9495"></a>                                                         <span class="o">*</span> <span class="n">SumPeopleAllZones</span>
<a name="ln-9496"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9497"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9498"></a>                                   <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9499"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9500"></a>                                   <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9501"></a>      <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9502"></a>                                   <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9503"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9504"></a>                                   <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9505"></a>    <span class="k">ELSE</span>
<a name="ln-9506"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9507"></a>      <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9508"></a>    <span class="n">ENDIF</span>
<a name="ln-9509"></a>
<a name="ln-9510"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span>    <span class="n">tmpMaxCapacity</span>  <span class="o">=</span> <span class="n">SumPeopleAllZones</span>   <span class="p">&amp;</span>
<a name="ln-9511"></a>                                            <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerPerson</span> <span class="p">&amp;</span> <span class="c">!m3/hr/person</span>
<a name="ln-9512"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="n">Tfinish</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! delta T  in K</span>
<a name="ln-9513"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">/</span> <span class="n">SecInHour</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">!  1 hr/ 3600 s</span>
<a name="ln-9514"></a>                                            <span class="o">*</span> <span class="n">rho</span> <span class="p">&amp;</span>  <span class="c">! kg/m3</span>
<a name="ln-9515"></a>                                            <span class="o">*</span> <span class="n">Cp</span>  <span class="c">! J/Kg/k</span>
<a name="ln-9516"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9517"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-9518"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9519"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9520"></a>                              <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-9521"></a>    <span class="n">ENDIF</span>
<a name="ln-9522"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9523"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-9524"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9525"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9526"></a>                           <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-9527"></a>    <span class="n">ENDIF</span>
<a name="ln-9528"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerFloorArea</span><span class="p">)</span>
<a name="ln-9529"></a>
<a name="ln-9530"></a>    <span class="n">SumFloorAreaAllZones</span> <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">FloorArea</span><span class="p">)</span>
<a name="ln-9531"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="n">tmpTankVolume</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-9532"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TankCapacityPerArea</span> <span class="p">&amp;</span>
<a name="ln-9533"></a>                                                         <span class="o">*</span> <span class="n">SumFloorAreaAllZones</span>
<a name="ln-9534"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9535"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9536"></a>                                   <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9537"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9538"></a>                                   <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9539"></a>      <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9540"></a>                                   <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9541"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9542"></a>                                   <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9543"></a>    <span class="k">ELSE</span>
<a name="ln-9544"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9545"></a>      <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9546"></a>    <span class="n">ENDIF</span>
<a name="ln-9547"></a>
<a name="ln-9548"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span>     <span class="o">=</span> <span class="n">SumFloorAreaAllZones</span>   <span class="p">&amp;</span> <span class="c">! m2</span>
<a name="ln-9549"></a>                                            <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerArea</span> <span class="p">&amp;</span> <span class="c">!m3/hr/m2</span>
<a name="ln-9550"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="n">Tfinish</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! delta T  in K</span>
<a name="ln-9551"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">/</span> <span class="n">SecInHour</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">!  1 hr/ 3600 s</span>
<a name="ln-9552"></a>                                            <span class="o">*</span> <span class="n">rho</span> <span class="p">&amp;</span>  <span class="c">! kg/m3</span>
<a name="ln-9553"></a>                                            <span class="o">*</span> <span class="n">Cp</span>  <span class="c">! J/Kg/k</span>
<a name="ln-9554"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9555"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-9556"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9557"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9558"></a>                             <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-9559"></a>    <span class="n">ENDIF</span>
<a name="ln-9560"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9561"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-9562"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9563"></a>                                               <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9564"></a>                             <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-9565"></a>    <span class="n">ENDIF</span>
<a name="ln-9566"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerUnit</span><span class="p">)</span>
<a name="ln-9567"></a>
<a name="ln-9568"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="n">tmpTankVolume</span>  <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-9569"></a>         <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TankCapacityPerUnit</span> <span class="p">&amp;</span>
<a name="ln-9570"></a>                                       <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">NumberOfUnits</span>
<a name="ln-9571"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9572"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9573"></a>                                   <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9574"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9575"></a>                                   <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9576"></a>      <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9577"></a>                                   <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9578"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9579"></a>                                   <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9580"></a>    <span class="k">ELSE</span>
<a name="ln-9581"></a><span class="k">      </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9582"></a>      <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeTankForDemandSide&#39;</span><span class="p">)</span>
<a name="ln-9583"></a>    <span class="n">ENDIF</span>
<a name="ln-9584"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span>  <span class="n">tmpMaxCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-9585"></a>       <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">NumberOfUnits</span>   <span class="p">&amp;</span>
<a name="ln-9586"></a>                                            <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerUnit</span> <span class="p">&amp;</span> <span class="c">!m3/hr/ea</span>
<a name="ln-9587"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="n">Tfinish</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! delta T  in K</span>
<a name="ln-9588"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">/</span> <span class="n">SecInHour</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">!  1 hr/ 3600 s</span>
<a name="ln-9589"></a>                                            <span class="o">*</span> <span class="n">rho</span> <span class="p">&amp;</span>  <span class="c">! kg/m3</span>
<a name="ln-9590"></a>                                            <span class="o">*</span> <span class="n">Cp</span> <span class="c">! J/Kg/k</span>
<a name="ln-9591"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9592"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-9593"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9594"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9595"></a>                           <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-9596"></a>    <span class="n">ENDIF</span>
<a name="ln-9597"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9598"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-9599"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9600"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9601"></a>                           <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-9602"></a>    <span class="n">ENDIF</span>
<a name="ln-9603"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerSolarColArea</span><span class="p">)</span>
<a name="ln-9604"></a>
<a name="ln-9605"></a>  <span class="k">END SELECT</span>
<a name="ln-9606"></a>
<a name="ln-9607"></a>  <span class="c">! if stratified, might set height.</span>
<a name="ln-9608"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedWaterHeater</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9609"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! might set height</span>
<a name="ln-9610"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-9611"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">/=</span> <span class="n">autosize</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9612"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">4.0D0</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>  <span class="p">&amp;</span>
<a name="ln-9613"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">HeightAspectRatio</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9614"></a>                                            <span class="o">/</span> <span class="n">Pi</span><span class="p">)</span><span class="o">**</span> <span class="mf">0.33333333333333D0</span>
<a name="ln-9615"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9616"></a>                           <span class="s1">&#39;Tank Height [m]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="p">)</span>
<a name="ln-9617"></a>      <span class="c">! check if autocalculate Use outlet and source inlet are still set to autosize by earlier</span>
<a name="ln-9618"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletHeight</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9619"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletHeight</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9620"></a>      <span class="n">ENDIF</span>
<a name="ln-9621"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletHeight</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9622"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletHeight</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9623"></a>      <span class="n">ENDIF</span>
<a name="ln-9624"></a>    <span class="n">ENDIF</span>
<a name="ln-9625"></a>  <span class="n">ENDIF</span>
<a name="ln-9626"></a>
<a name="ln-9627"></a>  <span class="k">RETURN</span>
<a name="ln-9628"></a><span class="k">END SUBROUTINE </span><span class="n">SizeTankForDemandSide</span>
<a name="ln-9629"></a>
<a name="ln-9630"></a><span class="k">SUBROUTINE </span><span class="n">SizeTankForSupplySide</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-9631"></a>
<a name="ln-9632"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9633"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9634"></a>          <span class="c">!       DATE WRITTEN   February 2008</span>
<a name="ln-9635"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9636"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9637"></a>
<a name="ln-9638"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9639"></a>          <span class="c">! This subroutine is for sizing water heater tank volume and heater</span>
<a name="ln-9640"></a>          <span class="c">!   at a later point in the simulation when more of the plant is ready.</span>
<a name="ln-9641"></a>
<a name="ln-9642"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9643"></a>          <span class="c">!  depending on the sizing design mode...</span>
<a name="ln-9644"></a>          <span class="c">!</span>
<a name="ln-9645"></a>
<a name="ln-9646"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9647"></a>          <span class="c">! BA benchmark report for residential design mode</span>
<a name="ln-9648"></a>
<a name="ln-9649"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9650"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-9651"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-9652"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-9653"></a>  <span class="k">USE </span><span class="n">SolarCollectors</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Collector</span><span class="p">,</span> <span class="n">NumOfCollectors</span>
<a name="ln-9654"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Surface</span>
<a name="ln-9655"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Pi</span>
<a name="ln-9656"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span>
<a name="ln-9657"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9658"></a>
<a name="ln-9659"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9660"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-9661"></a>
<a name="ln-9662"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9663"></a>          <span class="c">! na</span>
<a name="ln-9664"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">GalTocubicMeters</span> <span class="o">=</span> <span class="mf">0.0037854D0</span>
<a name="ln-9665"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">kBtuPerHrToWatts</span> <span class="o">=</span> <span class="mi">29</span><span class="mf">3.1D0</span>
<a name="ln-9666"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9667"></a>          <span class="c">! na</span>
<a name="ln-9668"></a>
<a name="ln-9669"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9670"></a>          <span class="c">! na</span>
<a name="ln-9671"></a>
<a name="ln-9672"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9673"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tstart</span>        <span class="c">! initial tank temp for sizing.</span>
<a name="ln-9674"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tfinish</span>       <span class="c">! final target temp for sizing</span>
<a name="ln-9675"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CollectorNum</span>
<a name="ln-9676"></a>  <span class="kt">Logical</span>   <span class="kd">::</span> <span class="n">SizeVolume</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9677"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">SizeMaxCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9678"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-9679"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-9680"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9681"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpTankVolume</span> <span class="c">! local temporary for tank volume m3</span>
<a name="ln-9682"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpMaxCapacity</span> <span class="c">! local temporary for heating capacity W</span>
<a name="ln-9683"></a>
<a name="ln-9684"></a>  <span class="c">! local inits</span>
<a name="ln-9685"></a>  <span class="n">Tstart</span>  <span class="o">=</span> <span class="mi">1</span><span class="mf">4.44d0</span>
<a name="ln-9686"></a>  <span class="n">TFinish</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">7.22d0</span>
<a name="ln-9687"></a>  <span class="n">SizeVolume</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9688"></a>  <span class="n">SizeMaxCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9689"></a>
<a name="ln-9690"></a>  <span class="n">tmpTankVolume</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>
<a name="ln-9691"></a>  <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-9692"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">tmpTankVolume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">SizeVolume</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9693"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">tmpMaxCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">SizeMaxCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9694"></a>
<a name="ln-9695"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span><span class="p">)</span>
<a name="ln-9696"></a>
<a name="ln-9697"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePeakDraw</span><span class="p">)</span>
<a name="ln-9698"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="n">tmpTankVolume</span>      <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-9699"></a>       <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankDrawTime</span>  <span class="p">&amp;</span>  <span class="c">! hours</span>
<a name="ln-9700"></a>                                              <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="p">&amp;</span> <span class="c">! m3/s</span>
<a name="ln-9701"></a>                                              <span class="o">*</span> <span class="n">SecInHour</span>  <span class="c">!  (3600 s/1 hour)</span>
<a name="ln-9702"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9703"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-9704"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9705"></a>                           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9706"></a>                           <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-9707"></a>    <span class="n">ENDIF</span>
<a name="ln-9708"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9709"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">RecoveryTime</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9710"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9711"></a><span class="k">          </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9712"></a>                                   <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9713"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9714"></a>                                   <span class="s1">&#39;SizeTankForSupplySide&#39;</span><span class="p">)</span>
<a name="ln-9715"></a>          <span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9716"></a>                                   <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-9717"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9718"></a>                                   <span class="s1">&#39;SizeTankForSupplySide&#39;</span><span class="p">)</span>
<a name="ln-9719"></a>        <span class="k">ELSE</span>
<a name="ln-9720"></a><span class="k">          </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeTankForSupplySide&#39;</span><span class="p">)</span>
<a name="ln-9721"></a>          <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeTankForSupplySide&#39;</span><span class="p">)</span>
<a name="ln-9722"></a>        <span class="n">ENDIF</span>
<a name="ln-9723"></a>          <span class="n">tmpMaxCapacity</span> <span class="o">=</span>  <span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">&amp;</span> <span class="c">! m3</span>
<a name="ln-9724"></a>                                               <span class="o">*</span> <span class="n">rho</span> <span class="p">&amp;</span> <span class="c">! kg/m3</span>
<a name="ln-9725"></a>                                               <span class="o">*</span> <span class="n">Cp</span>  <span class="p">&amp;</span>  <span class="c">! J/Kg/K</span>
<a name="ln-9726"></a>                                               <span class="o">*</span> <span class="p">(</span><span class="n">Tfinish</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">!  K</span>
<a name="ln-9727"></a>                                              <span class="o">/</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">RecoveryTime</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span> <span class="c">! seconds</span>
<a name="ln-9728"></a>      <span class="k">ELSE</span>
<a name="ln-9729"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SizeTankForSupplySide: Tank=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9730"></a>          <span class="s1">&#39;&quot;, requested sizing for max capacity but entered Recovery Time is zero.&#39;</span><span class="p">)</span>
<a name="ln-9731"></a>      <span class="n">ENDIF</span>
<a name="ln-9732"></a>    <span class="n">ENDIF</span>
<a name="ln-9733"></a>
<a name="ln-9734"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9735"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-9736"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9737"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9738"></a>                           <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-9739"></a>    <span class="n">ENDIF</span>
<a name="ln-9740"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerSolarColArea</span><span class="p">)</span>
<a name="ln-9741"></a>
<a name="ln-9742"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TotalSolarCollectorArea</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9743"></a>    <span class="k">DO </span><span class="n">CollectorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfCollectors</span>
<a name="ln-9744"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TotalSolarCollectorArea</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-9745"></a>         <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TotalSolarCollectorArea</span> <span class="p">&amp;</span>
<a name="ln-9746"></a>                                         <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span> <span class="n">Collector</span><span class="p">(</span><span class="n">CollectorNum</span><span class="p">)%</span><span class="n">Surface</span> <span class="p">)%</span><span class="n">Area</span> <span class="c">!</span>
<a name="ln-9747"></a>    <span class="n">ENDDO</span>
<a name="ln-9748"></a>
<a name="ln-9749"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="n">tmpTankVolume</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-9750"></a>       <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TotalSolarCollectorArea</span> <span class="p">&amp;</span>
<a name="ln-9751"></a>                                         <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TankCapacityPerCollectorArea</span>
<a name="ln-9752"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-9753"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9754"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-9755"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9756"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9757"></a>                           <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-9758"></a>    <span class="n">ENDIF</span>
<a name="ln-9759"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9760"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-9761"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-9762"></a>                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9763"></a>                           <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-9764"></a>    <span class="n">ENDIF</span>
<a name="ln-9765"></a>  <span class="k">END SELECT</span>
<a name="ln-9766"></a>
<a name="ln-9767"></a><span class="k">  IF</span> <span class="p">((</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedWaterHeater</span><span class="p">)&amp;</span>
<a name="ln-9768"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PlantSizesOkayToFinalize</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! might set height</span>
<a name="ln-9769"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-9770"></a>       <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">/=</span> <span class="n">autosize</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9771"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span> <span class="mf">4.0D0</span> <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>  <span class="p">&amp;</span>
<a name="ln-9772"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">HeightAspectRatio</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9773"></a>                                            <span class="o">/</span> <span class="n">Pi</span><span class="p">)</span><span class="o">**</span> <span class="mf">0.33333333333333D0</span>
<a name="ln-9774"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9775"></a>                           <span class="s1">&#39;Tank Height [m]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Height</span> <span class="p">)</span>
<a name="ln-9776"></a>    <span class="n">ENDIF</span>
<a name="ln-9777"></a>  <span class="n">ENDIF</span>
<a name="ln-9778"></a>
<a name="ln-9779"></a>  <span class="k">RETURN</span>
<a name="ln-9780"></a><span class="k">END SUBROUTINE </span><span class="n">SizeTankForSupplySide</span>
<a name="ln-9781"></a>
<a name="ln-9782"></a><span class="k">SUBROUTINE </span><span class="n">SizeDemandSidePlantConnections</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-9783"></a>
<a name="ln-9784"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9785"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-9786"></a>          <span class="c">!       DATE WRITTEN   October 2007</span>
<a name="ln-9787"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9788"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9789"></a>
<a name="ln-9790"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9791"></a>          <span class="c">! This subroutine is for sizing water heater plant connection flow rates</span>
<a name="ln-9792"></a>          <span class="c">! on the demand side that have not been specified in the input.</span>
<a name="ln-9793"></a>
<a name="ln-9794"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9795"></a>          <span class="c">! For water heater sides on the Demand side, hot water flow rates are modeled entirely from user input data</span>
<a name="ln-9796"></a>          <span class="c">! because the plant loop is not yet set up nor is plant sizing info populated.</span>
<a name="ln-9797"></a>          <span class="c">! sizing is done by calculating an initial</span>
<a name="ln-9798"></a>          <span class="c">!  recovery rate that if continued would reheat tank in user specified amount of time.</span>
<a name="ln-9799"></a>          <span class="c">!  intial and final tank temperatures are 14.44 and reheat to 57.22 (values from CalcStandardRatings routine)</span>
<a name="ln-9800"></a>
<a name="ln-9801"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9802"></a>          <span class="c">! na</span>
<a name="ln-9803"></a>
<a name="ln-9804"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9805"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-9806"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-9807"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="n">ShowWarningError</span>
<a name="ln-9808"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallWaterVolFlow</span><span class="p">,</span> <span class="n">NumPlantLoops</span>
<a name="ln-9809"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-9810"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-9811"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-9812"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-9813"></a>
<a name="ln-9814"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9815"></a>
<a name="ln-9816"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9817"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-9818"></a>
<a name="ln-9819"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9820"></a>          <span class="c">! na</span>
<a name="ln-9821"></a>
<a name="ln-9822"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9823"></a>          <span class="c">! na</span>
<a name="ln-9824"></a>
<a name="ln-9825"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9826"></a>          <span class="c">! na</span>
<a name="ln-9827"></a>
<a name="ln-9828"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9829"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">R64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankVolume</span>    <span class="c">! local variable for tank volume.</span>
<a name="ln-9830"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Tpdesign</span>      <span class="c">! plant sizing exit temperature</span>
<a name="ln-9831"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Tstart</span>        <span class="c">! initial tank temp for sizing.</span>
<a name="ln-9832"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Tfinish</span>       <span class="c">! final target temp for sizing</span>
<a name="ln-9833"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">tankRecoverhours</span> <span class="c">! parameter in sizing, hours to recover</span>
<a name="ln-9834"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">PltSizNum</span>     <span class="c">! Plant Sizing index corresponding to CurLoopNum</span>
<a name="ln-9835"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">ErrorsFound</span>   <span class="c">! If errors detected in input</span>
<a name="ln-9836"></a>
<a name="ln-9837"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">eff</span>           <span class="c">! temporary effectiveness value for heat exchanger inside tank</span>
<a name="ln-9838"></a>
<a name="ln-9839"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9840"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-9841"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-9842"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">tmpUseDesignVolFlowRate</span> <span class="c">! local use side design flow rate</span>
<a name="ln-9843"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">tmpSourceDesignVolFlowRate</span> <span class="c">! local use side design flow rate</span>
<a name="ln-9844"></a>
<a name="ln-9845"></a>  <span class="n">tankRecoverhours</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SizingRecoveryTime</span>
<a name="ln-9846"></a>  <span class="n">PltSizNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9847"></a>  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9848"></a>  <span class="n">tmpUseDesignVolFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>
<a name="ln-9849"></a>  <span class="n">tmpSourceDesignVolFlowRate</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span>
<a name="ln-9850"></a>
<a name="ln-9851"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9852"></a><span class="k">    </span><span class="n">Tstart</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">4.44d0</span>
<a name="ln-9853"></a>    <span class="n">TFinish</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">7.22d0</span>
<a name="ln-9854"></a>  <span class="k">ELSE</span>
<a name="ln-9855"></a><span class="k">    </span><span class="n">Tstart</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">4.44d0</span>
<a name="ln-9856"></a>    <span class="n">TFinish</span> <span class="o">=</span> <span class="mf">9.0d0</span>
<a name="ln-9857"></a>  <span class="n">endif</span>
<a name="ln-9858"></a>
<a name="ln-9859"></a>  <span class="c">! determine tank volume to use for sizing.</span>
<a name="ln-9860"></a>  <span class="n">TankVolume</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>
<a name="ln-9861"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">TankVolume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9862"></a><span class="k">    </span><span class="n">TankVolume</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NominalVolForSizingDemandSideFlow</span>
<a name="ln-9863"></a>  <span class="n">ENDIF</span>
<a name="ln-9864"></a>
<a name="ln-9865"></a>
<a name="ln-9866"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9867"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9868"></a><span class="k">      </span><span class="n">PltSizNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantSizNum</span>
<a name="ln-9869"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! we have a Plant Sizing Object</span>
<a name="ln-9870"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopSide</span> <span class="o">==</span> <span class="n">DemandSide</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9871"></a>          <span class="c">! probably shouldn&#39;t come here as Use side is unlikley to be on demand side (?)</span>
<a name="ln-9872"></a>          <span class="c">! but going to treat component with symetry so if connections are reversed it&#39;ll still work</span>
<a name="ln-9873"></a>          <span class="c">! choose a flow rate that will allow the entire volume of the tank to go from 14.44 to 57.22 C</span>
<a name="ln-9874"></a>          <span class="c">! in user specified hours.</span>
<a name="ln-9875"></a>          <span class="c">!  using the plant inlet design temp for sizing.</span>
<a name="ln-9876"></a>          <span class="n">Tpdesign</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">ExitTemp</span>
<a name="ln-9877"></a>          <span class="n">eff</span>      <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEffectiveness</span>
<a name="ln-9878"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">Tpdesign</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="mf">8.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span>  <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9879"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9880"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">=</span>       <span class="p">&amp;</span>
<a name="ln-9881"></a>                 <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span>  <span class="p">(</span><span class="n">TankVolume</span>                <span class="p">&amp;</span>
<a name="ln-9882"></a>                   <span class="o">/</span> <span class="p">(</span><span class="n">tankRecoverhours</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="o">*</span> <span class="n">eff</span><span class="p">)</span> <span class="p">)</span>                   <span class="p">&amp;</span>
<a name="ln-9883"></a>                   <span class="o">*</span> <span class="nb">Log</span><span class="p">((</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tfinish</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9884"></a>            <span class="k">ELSE</span>
<a name="ln-9885"></a><span class="k">              </span><span class="n">tmpUseDesignVolFlowRate</span> <span class="o">=</span>       <span class="p">&amp;</span>
<a name="ln-9886"></a>                 <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span>  <span class="p">(</span><span class="n">TankVolume</span>                <span class="p">&amp;</span>
<a name="ln-9887"></a>                   <span class="o">/</span> <span class="p">(</span><span class="n">tankRecoverhours</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="o">*</span> <span class="n">eff</span><span class="p">)</span> <span class="p">)</span>                   <span class="p">&amp;</span>
<a name="ln-9888"></a>                   <span class="o">*</span> <span class="nb">Log</span><span class="p">((</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tfinish</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9889"></a>            <span class="n">ENDIF</span>
<a name="ln-9890"></a>          <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Tpdesign</span> <span class="o">&lt;=</span> <span class="mf">8.0D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span>  <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9891"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9892"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span> <span class="o">=</span>       <span class="p">&amp;</span>
<a name="ln-9893"></a>                  <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span>  <span class="p">(</span><span class="n">TankVolume</span>                <span class="p">&amp;</span>
<a name="ln-9894"></a>                   <span class="o">/</span> <span class="p">(</span><span class="n">tankRecoverhours</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="o">*</span> <span class="n">eff</span><span class="p">)</span> <span class="p">)</span>                   <span class="p">&amp;</span>
<a name="ln-9895"></a>                   <span class="o">*</span> <span class="nb">Log</span><span class="p">((</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tfinish</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9896"></a>            <span class="k">ELSE</span>
<a name="ln-9897"></a><span class="k">              </span><span class="n">tmpUseDesignVolFlowRate</span> <span class="o">=</span>        <span class="p">&amp;</span>
<a name="ln-9898"></a>                  <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span>  <span class="p">(</span><span class="n">TankVolume</span>                <span class="p">&amp;</span>
<a name="ln-9899"></a>                   <span class="o">/</span> <span class="p">(</span><span class="n">tankRecoverhours</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="o">*</span> <span class="n">eff</span><span class="p">)</span> <span class="p">)</span>                   <span class="p">&amp;</span>
<a name="ln-9900"></a>                   <span class="o">*</span> <span class="nb">Log</span><span class="p">((</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tfinish</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9901"></a>            <span class="n">ENDIF</span>
<a name="ln-9902"></a>          <span class="k">ELSE</span>
<a name="ln-9903"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9904"></a>            <span class="c">! plant sizing object design temperature is set too low throw warning.</span>
<a name="ln-9905"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of Use side water heater design flow rate requires &#39;</span> <span class="p">&amp;</span>
<a name="ln-9906"></a>                    <span class="o">//</span> <span class="s1">&#39;Sizing:Plant object to have an exit temperature &gt;= 58C&#39;</span><span class="p">)</span>
<a name="ln-9907"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for water heater object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9908"></a>            <span class="k">ELSE</span>
<a name="ln-9909"></a>            <span class="c">! plant sizing object design temperature is set too hi throw warning.</span>
<a name="ln-9910"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of Use side chilled water tank design flow rate requires &#39;</span> <span class="p">&amp;</span>
<a name="ln-9911"></a>                    <span class="o">//</span> <span class="s1">&#39;Sizing:Plant object to have an exit temperature &lt;= 8C&#39;</span><span class="p">)</span>
<a name="ln-9912"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for chilled water storage tank object=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9913"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9914"></a>
<a name="ln-9915"></a>            <span class="n">ENDIF</span>
<a name="ln-9916"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9917"></a>          <span class="k">END IF</span>
<a name="ln-9918"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-9919"></a>             <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9920"></a>                                              <span class="s1">&#39;Use Side Design Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9921"></a>                                              <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9922"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9923"></a><span class="k">            CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9924"></a>                                             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9925"></a>          <span class="k">ELSE</span>
<a name="ln-9926"></a><span class="k">            CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span><span class="p">,</span>  <span class="n">tmpUseDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9927"></a>          <span class="n">ENDIF</span>
<a name="ln-9928"></a>          <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9929"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9930"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9931"></a>                                 <span class="s1">&#39;SizeDemandSidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-9932"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9933"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9934"></a>                       <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">*</span> <span class="n">rho</span>
<a name="ln-9935"></a>          <span class="k">ELSE</span>
<a name="ln-9936"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span>    <span class="o">=</span> <span class="n">tmpUseDesignVolFlowRate</span>  <span class="o">*</span> <span class="n">rho</span>
<a name="ln-9937"></a>          <span class="n">ENDIF</span>
<a name="ln-9938"></a>        <span class="k">END IF</span> <span class="c">! Demand side</span>
<a name="ln-9939"></a>      <span class="k">ELSE</span>
<a name="ln-9940"></a>        <span class="c">! do nothing</span>
<a name="ln-9941"></a>      <span class="n">ENDIF</span> <span class="c">!plant sizing object</span>
<a name="ln-9942"></a>
<a name="ln-9943"></a>    <span class="k">ELSE</span>
<a name="ln-9944"></a>    <span class="c">! not autosized - report flow to RegisterPlantCompDesignFlow for supply side component sizing</span>
<a name="ln-9945"></a>      <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9946"></a>         <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-9947"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9948"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9949"></a>                                   <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9950"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9951"></a>                                   <span class="s1">&#39;SizeDemandSidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-9952"></a>      <span class="k">ELSE</span>
<a name="ln-9953"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeDemandSidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-9954"></a>      <span class="n">ENDIF</span>
<a name="ln-9955"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantUseMassFlowRateMax</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-9956"></a>                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span>    <span class="o">*</span> <span class="n">rho</span>
<a name="ln-9957"></a>    <span class="k">END IF</span> <span class="c">!autosizing needed.</span>
<a name="ln-9958"></a>  <span class="n">ENDIF</span> <span class="c">! connected to plant</span>
<a name="ln-9959"></a>
<a name="ln-9960"></a>
<a name="ln-9961"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9962"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9963"></a><span class="k">      </span><span class="n">PltSizNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantSizNum</span>
<a name="ln-9964"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9965"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopSide</span> <span class="o">==</span> <span class="n">DemandSide</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9966"></a>          <span class="c">!  choose a flow rate that will allow the entire volume of the tank to go from 14.44 to 57.22 C</span>
<a name="ln-9967"></a>          <span class="c">! in user specified hours.</span>
<a name="ln-9968"></a>          <span class="c">!  using the plant inlet design temp for sizing.</span>
<a name="ln-9969"></a>          <span class="n">Tpdesign</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizNum</span><span class="p">)%</span><span class="n">ExitTemp</span>
<a name="ln-9970"></a>          <span class="n">eff</span>      <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEffectiveness</span>
<a name="ln-9971"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">Tpdesign</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="mf">8.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span>  <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9972"></a>
<a name="ln-9973"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9974"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span>                                    <span class="p">&amp;</span>
<a name="ln-9975"></a>                  <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">TankVolume</span><span class="o">/</span> <span class="p">(</span><span class="n">tankRecoverhours</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="o">*</span> <span class="n">eff</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-9976"></a>                  <span class="nb">Log</span><span class="p">((</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tfinish</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9977"></a>            <span class="k">ELSE</span>
<a name="ln-9978"></a><span class="k">              </span><span class="n">tmpSourceDesignVolFlowRate</span> <span class="o">=</span>                               <span class="p">&amp;</span>
<a name="ln-9979"></a>                  <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">TankVolume</span><span class="o">/</span> <span class="p">(</span><span class="n">tankRecoverhours</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="o">*</span> <span class="n">eff</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-9980"></a>                  <span class="nb">Log</span><span class="p">((</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tfinish</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9981"></a>            <span class="n">ENDIF</span>
<a name="ln-9982"></a>          <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Tpdesign</span> <span class="o">&lt;=</span> <span class="mf">8.0D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span>  <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9983"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9984"></a><span class="k">              </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">=</span>       <span class="p">&amp;</span>
<a name="ln-9985"></a>                  <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">TankVolume</span>  <span class="o">/</span> <span class="p">(</span><span class="n">tankRecoverhours</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="o">*</span> <span class="n">eff</span><span class="p">)</span> <span class="p">)</span>                   <span class="p">&amp;</span>
<a name="ln-9986"></a>                   <span class="o">*</span> <span class="nb">Log</span><span class="p">((</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tfinish</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9987"></a>            <span class="k">ELSE</span>
<a name="ln-9988"></a><span class="k">              </span><span class="n">tmpSourceDesignVolFlowRate</span> <span class="o">=</span>       <span class="p">&amp;</span>
<a name="ln-9989"></a>                  <span class="o">-</span><span class="mf">1.0d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">TankVolume</span>  <span class="o">/</span> <span class="p">(</span><span class="n">tankRecoverhours</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="o">*</span> <span class="n">eff</span><span class="p">)</span> <span class="p">)</span>                   <span class="p">&amp;</span>
<a name="ln-9990"></a>                   <span class="o">*</span> <span class="nb">Log</span><span class="p">((</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tfinish</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tpdesign</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-9991"></a>            <span class="n">ENDIF</span>
<a name="ln-9992"></a>          <span class="k">ELSE</span>
<a name="ln-9993"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">IsChilledWaterTank</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9994"></a>            <span class="c">! plant sizing object design temperature is set too low throw warning.</span>
<a name="ln-9995"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of Source side water heater design flow rate requires &#39;</span> <span class="p">&amp;</span>
<a name="ln-9996"></a>                  <span class="o">//</span> <span class="s1">&#39;Sizing:Plant object to have an exit temperature &gt;= 58C&#39;</span><span class="p">)</span>
<a name="ln-9997"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for WaterHeater:Mixed object=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9998"></a>            <span class="k">ELSE</span>
<a name="ln-9999"></a>            <span class="c">! plant sizing object design temperature is set too hi throw warning.</span>
<a name="ln-10000"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of Source side chilled water tank design flow rate requires &#39;</span> <span class="p">&amp;</span>
<a name="ln-10001"></a>                    <span class="o">//</span> <span class="s1">&#39;Sizing:Plant object to have an exit temperature &lt;= 8C&#39;</span><span class="p">)</span>
<a name="ln-10002"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for chilled water storage tank object=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10003"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-10004"></a>            <span class="n">ENDIF</span>
<a name="ln-10005"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10006"></a>          <span class="k">END IF</span>
<a name="ln-10007"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-10008"></a>             <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10009"></a>                     <span class="s1">&#39;Source Side Design Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10010"></a>                     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-10011"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10012"></a><span class="k">            CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10013"></a>                                               <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-10014"></a>          <span class="k">ELSE</span>
<a name="ln-10015"></a><span class="k">            CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10016"></a>                                               <span class="n">tmpSourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-10017"></a>          <span class="n">ENDIF</span>
<a name="ln-10018"></a>          <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10019"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10020"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10021"></a>                                 <span class="s1">&#39;SizeDemandSidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-10022"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PlantSizesOkayToFinalize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10023"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10024"></a>                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-10025"></a>          <span class="k">ELSE</span>
<a name="ln-10026"></a><span class="k">            </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10027"></a>                <span class="n">tmpSourceDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-10028"></a>          <span class="n">ENDIF</span>
<a name="ln-10029"></a>        <span class="k">END IF</span> <span class="c">! demand side</span>
<a name="ln-10030"></a>      <span class="k">ELSE</span>
<a name="ln-10031"></a>        <span class="c">! do nothing</span>
<a name="ln-10032"></a>      <span class="n">ENDIF</span> <span class="c">!plant sizing object</span>
<a name="ln-10033"></a>
<a name="ln-10034"></a>    <span class="k">ELSE</span>
<a name="ln-10035"></a>    <span class="c">! not autosized - report flow to RegisterPlantCompDesignFlow for supply side component sizing</span>
<a name="ln-10036"></a>      <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10037"></a>         <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">)</span>
<a name="ln-10038"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10039"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10040"></a>                                   <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10041"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceSidePlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10042"></a>                                   <span class="s1">&#39;SizeDemandSidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-10043"></a>      <span class="k">ELSE</span>
<a name="ln-10044"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeDemandSidePlantConnections&#39;</span><span class="p">)</span>
<a name="ln-10045"></a>      <span class="n">ENDIF</span>
<a name="ln-10046"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PlantSourceMassFlowRateMax</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10047"></a>                  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-10048"></a>    <span class="k">END IF</span> <span class="c">!autosizing needed.</span>
<a name="ln-10049"></a>  <span class="n">ENDIF</span> <span class="c">! connected to plant</span>
<a name="ln-10050"></a>
<a name="ln-10051"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10052"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding sizing errors cause program termination&#39;</span><span class="p">)</span>
<a name="ln-10053"></a>  <span class="k">END IF</span>
<a name="ln-10054"></a>
<a name="ln-10055"></a><span class="k">  RETURN</span>
<a name="ln-10056"></a><span class="k">END SUBROUTINE </span><span class="n">SizeDemandSidePlantConnections</span>
<a name="ln-10057"></a>
<a name="ln-10058"></a><span class="k">SUBROUTINE </span><span class="n">SizeStandAloneWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-10059"></a>
<a name="ln-10060"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10061"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-10062"></a>          <span class="c">!       DATE WRITTEN   October 2013</span>
<a name="ln-10063"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10064"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10065"></a>
<a name="ln-10066"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10067"></a>          <span class="c">! allow autosizing of tank volume and heat capacity for stand alone tanks</span>
<a name="ln-10068"></a>
<a name="ln-10069"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10070"></a>          <span class="c">! same as for plant connected water heaters, only draws are scheduled. </span>
<a name="ln-10071"></a>
<a name="ln-10072"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10073"></a>          <span class="c">! na</span>
<a name="ln-10074"></a>
<a name="ln-10075"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10076"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-10077"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-10078"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleMaxValue</span>
<a name="ln-10079"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-10080"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span>
<a name="ln-10081"></a>  <span class="k">USE </span><span class="n">SolarCollectors</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Collector</span><span class="p">,</span> <span class="n">NumOfCollectors</span>
<a name="ln-10082"></a>  <span class="k">USE </span><span class="n">DataSurfaces</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">Surface</span>
<a name="ln-10083"></a>
<a name="ln-10084"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10085"></a>
<a name="ln-10086"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10087"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-10088"></a>
<a name="ln-10089"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10090"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">GalTocubicMeters</span> <span class="o">=</span> <span class="mf">0.0037854D0</span>
<a name="ln-10091"></a>  <span class="kt">Real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">kBtuPerHrToWatts</span> <span class="o">=</span> <span class="mi">29</span><span class="mf">3.1D0</span>
<a name="ln-10092"></a>
<a name="ln-10093"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10094"></a>          <span class="c">! na</span>
<a name="ln-10095"></a>
<a name="ln-10096"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10097"></a>          <span class="c">! na</span>
<a name="ln-10098"></a>
<a name="ln-10099"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpTankVolume</span> <span class="c">! local temporary for tank volume m3</span>
<a name="ln-10101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tmpMaxCapacity</span> <span class="c">! local temporary for heating capacity W</span>
<a name="ln-10102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tstart</span>        <span class="c">! initial tank temp for sizing.</span>
<a name="ln-10103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tfinish</span>       <span class="c">! final target temp for sizing</span>
<a name="ln-10104"></a>  <span class="kt">Logical</span>   <span class="kd">::</span> <span class="n">SizeVolume</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10105"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">SizeMaxCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10106"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10107"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DummyWaterIndex</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-10108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-10109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-10110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DrawDesignVolFlowRate</span>
<a name="ln-10111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SumPeopleAllZones</span>
<a name="ln-10112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SumFloorAreaAllZones</span>
<a name="ln-10113"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CollectorNum</span>
<a name="ln-10114"></a>
<a name="ln-10115"></a>  <span class="c">! local inits</span>
<a name="ln-10116"></a>  <span class="n">Tstart</span>  <span class="o">=</span> <span class="mi">1</span><span class="mf">4.44d0</span>
<a name="ln-10117"></a>  <span class="n">TFinish</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">7.22d0</span>
<a name="ln-10118"></a>  <span class="n">SizeVolume</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10119"></a>  <span class="n">SizeMaxCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10120"></a>
<a name="ln-10121"></a>  <span class="n">tmpTankVolume</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span>
<a name="ln-10122"></a>  <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-10123"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">tmpTankVolume</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">SizeVolume</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10124"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">tmpMaxCapacity</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">SizeMaxCapacity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10125"></a>
<a name="ln-10126"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10127"></a>
<a name="ln-10128"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">DesignMode</span><span class="p">)</span>
<a name="ln-10129"></a>
<a name="ln-10130"></a>
<a name="ln-10131"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePeakDraw</span><span class="p">)</span>
<a name="ln-10132"></a>      <span class="c">! get draw rate from maximum in schedule</span>
<a name="ln-10133"></a>      <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeStandAloneWaterHeater&#39;</span><span class="p">)</span>
<a name="ln-10134"></a>      <span class="n">DrawDesignVolFlowRate</span> <span class="o">=</span> <span class="n">GetScheduleMaxValue</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlowRateSchedule</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10135"></a>                              <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="p">&amp;</span>
<a name="ln-10136"></a>                              <span class="o">/</span> <span class="n">rho</span>
<a name="ln-10137"></a>
<a name="ln-10138"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10139"></a><span class="k">        </span><span class="n">tmpTankVolume</span>      <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10140"></a>          <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">TankDrawTime</span>  <span class="p">&amp;</span>  <span class="c">! hours</span>
<a name="ln-10141"></a>                                                <span class="o">*</span> <span class="n">DrawDesignVolFlowRate</span> <span class="p">&amp;</span> <span class="c">! m3/s</span>
<a name="ln-10142"></a>                                                <span class="o">*</span> <span class="n">SecInHour</span>  <span class="c">!  (3600 s/1 hour)</span>
<a name="ln-10143"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-10144"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10145"></a>                             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10146"></a>                             <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-10147"></a>      <span class="n">ENDIF</span>
<a name="ln-10148"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10149"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">RecoveryTime</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10150"></a><span class="k">          </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeStandAloneWaterHeater&#39;</span><span class="p">)</span>
<a name="ln-10151"></a>          <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeStandAloneWaterHeater&#39;</span><span class="p">)</span>
<a name="ln-10152"></a>
<a name="ln-10153"></a>          <span class="n">tmpMaxCapacity</span> <span class="o">=</span>  <span class="p">(</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">&amp;</span> <span class="c">! m3</span>
<a name="ln-10154"></a>                                                <span class="o">*</span> <span class="n">rho</span> <span class="p">&amp;</span> <span class="c">! kg/m3</span>
<a name="ln-10155"></a>                                                <span class="o">*</span> <span class="n">Cp</span>  <span class="p">&amp;</span>  <span class="c">! J/Kg/K</span>
<a name="ln-10156"></a>                                                <span class="o">*</span> <span class="p">(</span><span class="n">Tfinish</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">!  K</span>
<a name="ln-10157"></a>                                              <span class="o">/</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">RecoveryTime</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span> <span class="c">! seconds</span>
<a name="ln-10158"></a>        <span class="k">ELSE</span>
<a name="ln-10159"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SizeStandAloneWaterHeater: Tank=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10160"></a>            <span class="s1">&#39;&quot;, requested sizing for max capacity but entered Recovery Time is zero.&#39;</span><span class="p">)</span>
<a name="ln-10161"></a>        <span class="n">ENDIF</span>
<a name="ln-10162"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-10163"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10164"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10165"></a>                             <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-10166"></a>      <span class="n">ENDIF</span>
<a name="ln-10167"></a>
<a name="ln-10168"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">SizeResidentialMin</span><span class="p">)</span>
<a name="ln-10169"></a>      <span class="c">! assume can propagate rules for gas to other fuels.</span>
<a name="ln-10170"></a>      <span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10171"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Gas&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10172"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10173"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Diesel&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10174"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10175"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Gasoline&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10176"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10177"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Coal&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10178"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10179"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;FuelOil#1&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10180"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10181"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;FuelOil#2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10182"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10183"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Propane&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10184"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10185"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10186"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10187"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;OtherFuel1&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10188"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10189"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;OtherFuel2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10190"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10191"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;DistrictHeating&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10192"></a><span class="k">        </span><span class="n">FuelTypeIsLikeGas</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10193"></a>      <span class="n">ENDIF</span>
<a name="ln-10194"></a>
<a name="ln-10195"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10196"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10197"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>   <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10198"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span>  <span class="o">=</span> <span class="mf">2.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!2.5 kW</span>
<a name="ln-10199"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10200"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10201"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">7.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!27kBtu/hr</span>
<a name="ln-10202"></a>        <span class="n">ENDIF</span>
<a name="ln-10203"></a>
<a name="ln-10204"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10205"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;=</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10206"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10207"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">3</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10208"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">3.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!3.5 kW</span>
<a name="ln-10209"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10210"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">3</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10211"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-10212"></a>          <span class="n">ENDIF</span>
<a name="ln-10213"></a>        <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10214"></a>                 <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;</span> <span class="mf">3.0D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10215"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10216"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10217"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">4.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!4.5 kW</span>
<a name="ln-10218"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10219"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">3</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10220"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-10221"></a>          <span class="n">ENDIF</span>
<a name="ln-10222"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;=</span> <span class="mf">3.0D0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10223"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10224"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10225"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-10226"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10227"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span> <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10228"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-10229"></a>          <span class="n">ENDIF</span>
<a name="ln-10230"></a>        <span class="n">ENDIF</span>
<a name="ln-10231"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10232"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;=</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10233"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10234"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10235"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">4.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!4.5 kW</span>
<a name="ln-10236"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10237"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">3</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10238"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-10239"></a>          <span class="n">ENDIF</span>
<a name="ln-10240"></a>        <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10241"></a>                 <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;</span> <span class="mf">3.0D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10242"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10243"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10244"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-10245"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10246"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10247"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-10248"></a>          <span class="n">ENDIF</span>
<a name="ln-10249"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;=</span> <span class="mf">3.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10250"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10251"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10252"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-10253"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10254"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10255"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">8.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!38 kBtu/hr</span>
<a name="ln-10256"></a>          <span class="n">ENDIF</span>
<a name="ln-10257"></a>        <span class="n">ENDIF</span>
<a name="ln-10258"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10259"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;=</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10260"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10261"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10262"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-10263"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10264"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10265"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!36 kBtu/hr</span>
<a name="ln-10266"></a>          <span class="n">ENDIF</span>
<a name="ln-10267"></a>        <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;</span> <span class="mf">1.5D0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10268"></a>                 <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&lt;</span> <span class="mf">3.0D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10269"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10270"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10271"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-10272"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10273"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">4</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10274"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">8.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!38 kBtu/hr</span>
<a name="ln-10275"></a>          <span class="n">ENDIF</span>
<a name="ln-10276"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBathrooms</span> <span class="o">&gt;=</span> <span class="mf">3.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10277"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10278"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">6</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10279"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-10280"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10281"></a><span class="k">            If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10282"></a>            <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">8.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!38 kBtu/hr</span>
<a name="ln-10283"></a>          <span class="n">ENDIF</span>
<a name="ln-10284"></a>        <span class="n">ENDIF</span>
<a name="ln-10285"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">==</span> <span class="mi">5</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10286"></a><span class="k">        If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10287"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">6</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10288"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-10289"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10290"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10291"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">4</span><span class="mf">7.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!47 kBtu/hr</span>
<a name="ln-10292"></a>        <span class="n">endif</span>
<a name="ln-10293"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Sizing</span><span class="p">%</span><span class="n">NumberOfBedrooms</span> <span class="o">&gt;=</span> <span class="mi">6</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10294"></a><span class="k">        If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelType</span> <span class="p">,</span> <span class="s1">&#39;Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10295"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">6</span><span class="mf">6.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10296"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">5.5D0</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0D0</span>  <span class="c">!5.5 kW</span>
<a name="ln-10297"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FuelTypeIsLikeGas</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10298"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span>      <span class="n">tmpTankVolume</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">GalTocubicMeters</span>
<a name="ln-10299"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0D0</span> <span class="o">*</span> <span class="n">kBtuPerHrToWatts</span> <span class="c">!50 kBtu/hr</span>
<a name="ln-10300"></a>        <span class="n">ENDIF</span>
<a name="ln-10301"></a>      <span class="n">ENDIF</span>
<a name="ln-10302"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10303"></a><span class="k">         </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-10304"></a>         <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10305"></a>                                 <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10306"></a>                                <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-10307"></a>      <span class="n">ENDIF</span>
<a name="ln-10308"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10309"></a><span class="k">         </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-10310"></a>         <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10311"></a>         <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10312"></a>                             <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-10313"></a>      <span class="n">ENDIF</span>
<a name="ln-10314"></a>
<a name="ln-10315"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerPerson</span><span class="p">)</span>
<a name="ln-10316"></a>      <span class="c">! how to get number of people?</span>
<a name="ln-10317"></a>
<a name="ln-10318"></a>      <span class="n">SumPeopleAllZones</span> <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">TotOccupants</span><span class="p">)</span>
<a name="ln-10319"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10320"></a><span class="k">        </span><span class="n">tmpTankVolume</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10321"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TankCapacityPerPerson</span> <span class="p">&amp;</span>
<a name="ln-10322"></a>                                                           <span class="o">*</span> <span class="n">SumPeopleAllZones</span>
<a name="ln-10323"></a>      <span class="n">ENDIF</span>
<a name="ln-10324"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10325"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeStandAloneWaterHeater&#39;</span><span class="p">)</span>
<a name="ln-10326"></a>        <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeStandAloneWaterHeater&#39;</span><span class="p">)</span>
<a name="ln-10327"></a>        <span class="n">tmpMaxCapacity</span>  <span class="o">=</span> <span class="n">SumPeopleAllZones</span>   <span class="p">&amp;</span>
<a name="ln-10328"></a>                            <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerPerson</span> <span class="p">&amp;</span> <span class="c">!m3/hr/person</span>
<a name="ln-10329"></a>                                 <span class="o">*</span> <span class="p">(</span><span class="n">Tfinish</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! delta T  in K</span>
<a name="ln-10330"></a>                                 <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">/</span> <span class="n">SecInHour</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">!  1 hr/ 3600 s</span>
<a name="ln-10331"></a>                                 <span class="o">*</span> <span class="n">rho</span> <span class="p">&amp;</span>  <span class="c">! kg/m3</span>
<a name="ln-10332"></a>                                 <span class="o">*</span> <span class="n">Cp</span>  <span class="c">! J/Kg/k</span>
<a name="ln-10333"></a>      <span class="n">ENDIF</span>
<a name="ln-10334"></a>
<a name="ln-10335"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10336"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-10337"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10338"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10339"></a>                                <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-10340"></a>      <span class="n">ENDIF</span>
<a name="ln-10341"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10342"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-10343"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10344"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10345"></a>                              <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-10346"></a>      <span class="n">ENDIF</span>
<a name="ln-10347"></a>
<a name="ln-10348"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerFloorArea</span><span class="p">)</span>
<a name="ln-10349"></a>
<a name="ln-10350"></a>      <span class="n">SumFloorAreaAllZones</span> <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">Zone</span><span class="p">%</span><span class="n">FloorArea</span><span class="p">)</span>
<a name="ln-10351"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10352"></a><span class="k">        </span><span class="n">tmpTankVolume</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10353"></a>             <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TankCapacityPerArea</span> <span class="p">&amp;</span>
<a name="ln-10354"></a>                                                           <span class="o">*</span> <span class="n">SumFloorAreaAllZones</span>
<a name="ln-10355"></a>      <span class="n">ENDIF</span>
<a name="ln-10356"></a>
<a name="ln-10357"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10358"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeStandAloneWaterHeater&#39;</span><span class="p">)</span>
<a name="ln-10359"></a>        <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeStandAloneWaterHeater&#39;</span><span class="p">)</span>
<a name="ln-10360"></a>        <span class="n">tmpMaxCapacity</span>     <span class="o">=</span> <span class="n">SumFloorAreaAllZones</span>   <span class="p">&amp;</span> <span class="c">! m2</span>
<a name="ln-10361"></a>                                              <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerArea</span> <span class="p">&amp;</span> <span class="c">!m3/hr/m2</span>
<a name="ln-10362"></a>                                              <span class="o">*</span> <span class="p">(</span><span class="n">Tfinish</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! delta T  in K</span>
<a name="ln-10363"></a>                                              <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">/</span> <span class="n">SecInHour</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">!  1 hr/ 3600 s</span>
<a name="ln-10364"></a>                                              <span class="o">*</span> <span class="n">rho</span> <span class="p">&amp;</span>  <span class="c">! kg/m3</span>
<a name="ln-10365"></a>                                              <span class="o">*</span> <span class="n">Cp</span>  <span class="c">! J/Kg/k</span>
<a name="ln-10366"></a>      <span class="n">ENDIF</span>
<a name="ln-10367"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10368"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-10369"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10370"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10371"></a>                               <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-10372"></a>      <span class="n">ENDIF</span>
<a name="ln-10373"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10374"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-10375"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10376"></a>                                                 <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10377"></a>                               <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-10378"></a>      <span class="n">ENDIF</span>
<a name="ln-10379"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerUnit</span><span class="p">)</span>
<a name="ln-10380"></a>
<a name="ln-10381"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="n">tmpTankVolume</span>  <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10382"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TankCapacityPerUnit</span> <span class="p">&amp;</span>
<a name="ln-10383"></a>                                         <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">NumberOfUnits</span>
<a name="ln-10384"></a>
<a name="ln-10385"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10386"></a><span class="k">        </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeStandAloneWaterHeater&#39;</span><span class="p">)</span>
<a name="ln-10387"></a>        <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">,</span> <span class="p">((</span><span class="n">Tfinish</span> <span class="o">+</span> <span class="n">Tstart</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0D0</span><span class="p">),</span> <span class="n">DummyWaterIndex</span><span class="p">,</span> <span class="s1">&#39;SizeStandAloneWaterHeater&#39;</span><span class="p">)</span>
<a name="ln-10388"></a>        <span class="n">tmpMaxCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10389"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">NumberOfUnits</span>   <span class="p">&amp;</span>
<a name="ln-10390"></a>                                            <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">RecoveryCapacityPerUnit</span> <span class="p">&amp;</span> <span class="c">!m3/hr/ea</span>
<a name="ln-10391"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="n">Tfinish</span> <span class="o">-</span> <span class="n">Tstart</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! delta T  in K</span>
<a name="ln-10392"></a>                                            <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">/</span> <span class="n">SecInHour</span><span class="p">)</span>  <span class="p">&amp;</span> <span class="c">!  1 hr/ 3600 s</span>
<a name="ln-10393"></a>                                            <span class="o">*</span> <span class="n">rho</span> <span class="p">&amp;</span>  <span class="c">! kg/m3</span>
<a name="ln-10394"></a>                                            <span class="o">*</span> <span class="n">Cp</span> <span class="c">! J/Kg/k</span>
<a name="ln-10395"></a>      <span class="n">ENDIF</span>
<a name="ln-10396"></a>
<a name="ln-10397"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">SizeVolume</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10398"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-10399"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10400"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10401"></a>                             <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-10402"></a>      <span class="n">ENDIF</span>
<a name="ln-10403"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">SizeMaxCapacity</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10404"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-10405"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10406"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10407"></a>                             <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-10408"></a>      <span class="n">ENDIF</span>
<a name="ln-10409"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">SizePerSolarColArea</span><span class="p">)</span>
<a name="ln-10410"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TotalSolarCollectorArea</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10411"></a>      <span class="k">DO </span><span class="n">CollectorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfCollectors</span>
<a name="ln-10412"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TotalSolarCollectorArea</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10413"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TotalSolarCollectorArea</span> <span class="p">&amp;</span>
<a name="ln-10414"></a>                                           <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span> <span class="n">Collector</span><span class="p">(</span><span class="n">CollectorNum</span><span class="p">)%</span><span class="n">Surface</span> <span class="p">)%</span><span class="n">Area</span> <span class="c">!</span>
<a name="ln-10415"></a>      <span class="n">ENDDO</span>
<a name="ln-10416"></a>
<a name="ln-10417"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span><span class="p">)</span> <span class="n">tmpTankVolume</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10418"></a>         <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TotalSolarCollectorArea</span> <span class="p">&amp;</span>
<a name="ln-10419"></a>                                           <span class="o">*</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">sizing</span><span class="p">%</span><span class="n">TankCapacityPerCollectorArea</span>
<a name="ln-10420"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span><span class="p">)</span> <span class="n">tmpMaxCapacity</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-10421"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeVolume</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10422"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="o">=</span> <span class="n">tmpTankVolume</span>
<a name="ln-10423"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10424"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10425"></a>                             <span class="s1">&#39;Tank Volume [m3]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span> <span class="p">)</span>
<a name="ln-10426"></a>      <span class="n">ENDIF</span>
<a name="ln-10427"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SizeMaxCapacity</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10428"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">tmpMaxCapacity</span>
<a name="ln-10429"></a>        <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10430"></a>                                <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10431"></a>                             <span class="s1">&#39;Maximum Heater Capacity [W]&#39;</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="p">)</span>
<a name="ln-10432"></a>      <span class="n">ENDIF</span>
<a name="ln-10433"></a>
<a name="ln-10434"></a>    <span class="k">END SELECT</span>
<a name="ln-10435"></a>
<a name="ln-10436"></a>
<a name="ln-10437"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-10438"></a>
<a name="ln-10439"></a>  <span class="k">RETURN</span>
<a name="ln-10440"></a>
<a name="ln-10441"></a><span class="k">END SUBROUTINE </span><span class="n">SizeStandAloneWaterHeater</span>
<a name="ln-10442"></a>
<a name="ln-10443"></a><span class="k">SUBROUTINE </span><span class="n">UpdateWaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-10444"></a>
<a name="ln-10445"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10446"></a>          <span class="c">!       AUTHOR         Brandon Anderson</span>
<a name="ln-10447"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-10448"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10449"></a>          <span class="c">!                      Nov 2011, BAN; removed the use and source heat rate re-calculation for stratified tank</span>
<a name="ln-10450"></a>          <span class="c">!                                     for energy conservation verification.</span>
<a name="ln-10451"></a>          <span class="c">!       RE-ENGINEERED  Feb 2004, PGE</span>
<a name="ln-10452"></a>
<a name="ln-10453"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10454"></a>          <span class="c">! Updates the node variables with local variables.</span>
<a name="ln-10455"></a>
<a name="ln-10456"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10457"></a>          <span class="c">! Standard EnergyPlus methodology.</span>
<a name="ln-10458"></a>
<a name="ln-10459"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10460"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-10461"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CPHW</span>
<a name="ln-10462"></a>
<a name="ln-10463"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10464"></a>
<a name="ln-10465"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10466"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-10467"></a>
<a name="ln-10468"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10469"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UseInletNode</span>
<a name="ln-10470"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">UseOutletNode</span>
<a name="ln-10471"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SourceInletNode</span>
<a name="ln-10472"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SourceOutletNode</span>
<a name="ln-10473"></a>
<a name="ln-10474"></a>          <span class="c">! FLOW:</span>
<a name="ln-10475"></a>  <span class="n">UseInletNode</span>  <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletNode</span>
<a name="ln-10476"></a>  <span class="n">UseOutletNode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletNode</span>
<a name="ln-10477"></a>  <span class="n">SourceInletNode</span>  <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletNode</span>
<a name="ln-10478"></a>  <span class="n">SourceOutletNode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletNode</span>
<a name="ln-10479"></a>
<a name="ln-10480"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UseInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UseOutletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10481"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">UseOutletNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">UseInletNode</span><span class="p">)</span> <span class="c">! this could wipe out setpoints on outlet node</span>
<a name="ln-10482"></a>
<a name="ln-10483"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">UseOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletTemp</span>
<a name="ln-10484"></a>
<a name="ln-10485"></a>  <span class="k">END IF</span>
<a name="ln-10486"></a>
<a name="ln-10487"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SourceInletNode</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SourceOutletNode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10488"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">SourceOutletNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">SourceInletNode</span><span class="p">)</span>
<a name="ln-10489"></a>
<a name="ln-10490"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">SourceOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletTemp</span>
<a name="ln-10491"></a>
<a name="ln-10492"></a>  <span class="k">END IF</span>
<a name="ln-10493"></a>
<a name="ln-10494"></a><span class="k">  RETURN</span>
<a name="ln-10495"></a>
<a name="ln-10496"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateWaterThermalTank</span>
<a name="ln-10497"></a>
<a name="ln-10498"></a>
<a name="ln-10499"></a><span class="k">SUBROUTINE </span><span class="n">ReportWaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-10500"></a>
<a name="ln-10501"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10502"></a>          <span class="c">!       AUTHOR         Brandon Anderson</span>
<a name="ln-10503"></a>          <span class="c">!       DATE WRITTEN   May 2000</span>
<a name="ln-10504"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10505"></a>          <span class="c">!       RE-ENGINEERED  Feb 2004, PGE</span>
<a name="ln-10506"></a>
<a name="ln-10507"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10508"></a>          <span class="c">! Calculates report variables.</span>
<a name="ln-10509"></a>
<a name="ln-10510"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10511"></a>          <span class="c">! Standard EnergyPlus methodology.</span>
<a name="ln-10512"></a>
<a name="ln-10513"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10514"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SecInHour</span>
<a name="ln-10515"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-10516"></a>
<a name="ln-10517"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10518"></a>
<a name="ln-10519"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10520"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-10521"></a>
<a name="ln-10522"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10523"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SecInTimeStep</span>
<a name="ln-10524"></a>
<a name="ln-10525"></a>          <span class="c">! FLOW:</span>
<a name="ln-10526"></a>  <span class="n">SecInTimeStep</span> <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-10527"></a>
<a name="ln-10528"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UnmetEnergy</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UnmetRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10529"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">LossEnergy</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">LossRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10530"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlueLossEnergy</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FlueLossRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10531"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseEnergy</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10532"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TotalDemandEnergy</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TotalDemandRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10533"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceEnergy</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10534"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterEnergy</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10535"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterEnergy1</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate1</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10536"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterEnergy2</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterRate2</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10537"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelEnergy</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10538"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VentEnergy</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VentRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10539"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelEnergy</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10540"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10541"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaEnergyToTank</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10542"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaRateToTank</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10543"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelEnergy</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10544"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10545"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaEnergyToTank</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10546"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaRateToTank</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10547"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">NetHeatTransferEnergy</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10548"></a>     <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">NetHeatTransferRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10549"></a>  <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolumeConsumed</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">VolFlowRate</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10550"></a>
<a name="ln-10551"></a>  <span class="k">RETURN</span>
<a name="ln-10552"></a>
<a name="ln-10553"></a><span class="k">END SUBROUTINE </span><span class="n">ReportWaterThermalTank</span>
<a name="ln-10554"></a>
<a name="ln-10555"></a>
<a name="ln-10556"></a><span class="k">SUBROUTINE </span><span class="n">CalcStandardRatings</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-10557"></a>
<a name="ln-10558"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10559"></a>          <span class="c">!       AUTHOR         Peter Graham Ellis</span>
<a name="ln-10560"></a>          <span class="c">!       DATE WRITTEN   January 2005</span>
<a name="ln-10561"></a>          <span class="c">!       MODIFIED       R. Raustad, July 2005 - added HPWH to ratings procedure</span>
<a name="ln-10562"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10563"></a>
<a name="ln-10564"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10565"></a>          <span class="c">! Calculates the water heater standard ratings, such as Energy Factor and Recovery Efficiency.  Results are written</span>
<a name="ln-10566"></a>          <span class="c">! to the EIO file.  Standard ratings are not calculated for storage-only tanks, i.e., MaxCapacity = 0.</span>
<a name="ln-10567"></a>
<a name="ln-10568"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10569"></a>          <span class="c">! Water heater inputs are set to the specified test conditions. For HPWHs, the heating capacity and COP are assumed</span>
<a name="ln-10570"></a>          <span class="c">! to be the primary element in the water heater and are used during the rating procedure.  CalcWaterThermalTankMixed</span>
<a name="ln-10571"></a>          <span class="c">! is iteratively called in a self-contained, 24 hour simulation of the standard test procedure.</span>
<a name="ln-10572"></a>
<a name="ln-10573"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10574"></a>          <span class="c">! Title 10, Code of Federal Regulations, Part 430- Energy Conservation Program for Consumer Products, Appendix E to</span>
<a name="ln-10575"></a>          <span class="c">! Subpart B- Uniform Test Procedure for Measuring the Energy Consumption of Water Heaters, January 1, 2004.</span>
<a name="ln-10576"></a>
<a name="ln-10577"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10578"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">RhoH2O</span><span class="p">,</span> <span class="n">CPHW</span><span class="p">,</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyTwbFnTdbWPb</span> <span class="p">,</span> <span class="n">PsyHFnTdbW</span>
<a name="ln-10579"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitConvTemp</span>
<a name="ln-10580"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowContinueError</span>
<a name="ln-10581"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-10582"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">HPWHHeatingCapacity</span><span class="p">,</span> <span class="n">HPWHHeatingCOP</span><span class="p">,</span> <span class="n">SimDXCoil</span>
<a name="ln-10583"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-10584"></a>  <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-10585"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span>
<a name="ln-10586"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span><span class="p">,</span> <span class="n">HPWHInletDBTemp</span><span class="p">,</span> <span class="n">HPWHInletWBTemp</span><span class="p">,</span> <span class="n">HPWHCrankcaseDBTemp</span><span class="p">,</span> <span class="n">DXCoilTotalCapacity</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10587"></a>                             <span class="n">BlowThru</span><span class="p">,</span> <span class="n">CycFanCycCoil</span>
<a name="ln-10588"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-10589"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-10590"></a>
<a name="ln-10591"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10592"></a>
<a name="ln-10593"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10594"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-10595"></a>
<a name="ln-10596"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10597"></a>
<a name="ln-10598"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10599"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotalDrawMass</span>            <span class="c">! Total mass of hot water drawn during the test (kg), equivalent to 64.3 gallons</span>
<a name="ln-10600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DrawMass</span>                 <span class="c">! Mass of a single draw of hot water (kg)</span>
<a name="ln-10601"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SecInTimeStep</span>            <span class="c">! Seconds per timestep, depends on user-specified system timestep (s)</span>
<a name="ln-10602"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DrawMassFlowRate</span>         <span class="c">! Mass flow rate of all test draw (m3/s)</span>
<a name="ln-10603"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TimeStepPerHour</span>          <span class="c">! Number of timesteps per hour</span>
<a name="ln-10604"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Step</span>                     <span class="c">! Current timestep in the self-contained water heater simulation</span>
<a name="ln-10605"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FuelEnergy</span>               <span class="c">! Cumulative fuel energy used to heat the tank (J)</span>
<a name="ln-10606"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxCapacity</span>              <span class="c">! Maximum heating capacity (W)</span>
<a name="ln-10607"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RecoveryEfficiency</span>       <span class="c">! Standard water heater rating</span>
<a name="ln-10608"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnergyFactor</span>             <span class="c">! Standard water heater rating</span>
<a name="ln-10609"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HPNum</span>                    <span class="c">! index to heat pump water heater</span>
<a name="ln-10610"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotAir</span>                  <span class="c">! air mass flow rate through HP water heater evaporator (kg/s)</span>
<a name="ln-10611"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotWater</span>                <span class="c">! water mass flow rate through HP water heater condenser (kg/s)</span>
<a name="ln-10612"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AmbientHumRat</span>            <span class="c">! used during HPWH rating procedure</span>
<a name="ln-10613"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatedDXCoilTotalCapacity</span> <span class="c">! used during HPWH rating procedure</span>
<a name="ln-10614"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FirstTimeFlag</span>            <span class="c">! used during HPWH rating procedure</span>
<a name="ln-10615"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">equipName</span>
<a name="ln-10616"></a>  <span class="kt">Logical</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyOneTimeSetupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! one time setup flag</span>
<a name="ln-10617"></a>
<a name="ln-10618"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">AlreadyRated</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">))</span> <span class="k">Then</span> <span class="c">! bail we already did this one</span>
<a name="ln-10619"></a>    <span class="k">RETURN</span>
<a name="ln-10620"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-10621"></a>
<a name="ln-10622"></a>          <span class="c">! FLOW:</span>
<a name="ln-10623"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10624"></a>    <span class="c">! Set test conditions</span>
<a name="ln-10625"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span>   <span class="o">=</span> <span class="mi">1</span><span class="mf">9.7222d0</span>  <span class="c">! 67.5 F</span>
<a name="ln-10626"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletTemp</span>  <span class="o">=</span> <span class="mi">1</span><span class="mf">4.4444d0</span>  <span class="c">! 58 F</span>
<a name="ln-10627"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetpointTemp</span>  <span class="o">=</span> <span class="mi">5</span><span class="mf">7.2222d0</span>  <span class="c">! 135 F</span>
<a name="ln-10628"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SetPointTemp2</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">7.2222d0</span>  <span class="c">! 135 F</span>
<a name="ln-10629"></a>    <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>      <span class="o">=</span> <span class="mi">5</span><span class="mf">7.2222d0</span>  <span class="c">! Initialize tank temperature</span>
<a name="ln-10630"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">7.2222d0</span>
<a name="ln-10631"></a>
<a name="ln-10632"></a>    <span class="n">TotalDrawMass</span> <span class="o">=</span> <span class="mf">0.243402d0</span> <span class="o">*</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">InitConvTemp</span><span class="p">)</span>  <span class="c">! 64.3 gal * rho</span>
<a name="ln-10633"></a>    <span class="n">DrawMass</span> <span class="o">=</span> <span class="n">TotalDrawMass</span> <span class="o">/</span> <span class="mf">6.0d0</span>  <span class="c">! 6 equal draws</span>
<a name="ln-10634"></a>    <span class="n">SecInTimeStep</span> <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-10635"></a>    <span class="n">DrawMassFlowRate</span> <span class="o">=</span> <span class="n">DrawMass</span> <span class="o">/</span> <span class="n">SecInTimeStep</span>
<a name="ln-10636"></a>    <span class="n">FuelEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10637"></a>    <span class="n">FirstTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10638"></a>
<a name="ln-10639"></a>    <span class="n">TimeStepPerHour</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">/</span> <span class="n">TimeStepSys</span><span class="p">)</span>
<a name="ln-10640"></a>
<a name="ln-10641"></a>    <span class="c">! Simulate 24 hour test</span>
<a name="ln-10642"></a>    <span class="k">DO </span><span class="n">Step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TimeStepPerHour</span> <span class="o">*</span> <span class="mi">24</span>
<a name="ln-10643"></a>
<a name="ln-10644"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Step</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>                          <span class="c">! Hour 1</span>
<a name="ln-10645"></a>          <span class="n">Step</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">TimeStepPerHour</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>      <span class="c">! Hour 2</span>
<a name="ln-10646"></a>          <span class="n">Step</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">TimeStepPerHour</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>  <span class="c">! Hour 3</span>
<a name="ln-10647"></a>          <span class="n">Step</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">TimeStepPerHour</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>  <span class="c">! Hour 4</span>
<a name="ln-10648"></a>          <span class="n">Step</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">TimeStepPerHour</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>  <span class="c">! Hour 5</span>
<a name="ln-10649"></a>          <span class="n">Step</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">TimeStepPerHour</span> <span class="o">*</span> <span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>   <span class="c">! Hour 6</span>
<a name="ln-10650"></a>
<a name="ln-10651"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="n">DrawMassFlowRate</span>
<a name="ln-10652"></a>      <span class="k">ELSE</span>
<a name="ln-10653"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10654"></a>      <span class="k">END IF</span>
<a name="ln-10655"></a>
<a name="ln-10656"></a><span class="k">      </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedTankTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-10657"></a>      <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedMode</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Mode</span>
<a name="ln-10658"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Nodes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10659"></a><span class="k">        </span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">SavedTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">%</span><span class="n">Temp</span>
<a name="ln-10660"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn1</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn1</span>
<a name="ln-10661"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SavedHeaterOn2</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterOn2</span>
<a name="ln-10662"></a>      <span class="k">END IF</span>
<a name="ln-10663"></a>
<a name="ln-10664"></a><span class="k">      IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10665"></a>
<a name="ln-10666"></a><span class="k">        SELECT CASE</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">)</span>
<a name="ln-10667"></a>
<a name="ln-10668"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-10669"></a>            <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-10670"></a>
<a name="ln-10671"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-10672"></a>            <span class="k">CALL </span><span class="n">CalcWaterThermalTankStratified</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-10673"></a>
<a name="ln-10674"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-10675"></a><span class="c">!         Unhandled water heater type</span>
<a name="ln-10676"></a>
<a name="ln-10677"></a>        <span class="k">END SELECT</span>
<a name="ln-10678"></a>
<a name="ln-10679"></a><span class="k">      ELSE</span>
<a name="ln-10680"></a>
<a name="ln-10681"></a><span class="k">        </span><span class="n">HPNum</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span>
<a name="ln-10682"></a>        <span class="n">AmbientHumRat</span> <span class="o">=</span> <span class="mf">0.00717d0</span>     <span class="c">! Humidity ratio at 67.5 F / 50% RH</span>
<a name="ln-10683"></a>
<a name="ln-10684"></a><span class="c">!       set the heat pump air- and water-side mass flow rate</span>
<a name="ln-10685"></a>        <span class="n">MdotWater</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OperatingWaterFlowRate</span> <span class="o">*</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span><span class="p">)</span>
<a name="ln-10686"></a>        <span class="n">MdotAir</span>   <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OperatingAirFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10687"></a>                    <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">AmbientHumRat</span><span class="p">)</span>
<a name="ln-10688"></a>
<a name="ln-10689"></a><span class="c">!       set the condenser inlet node mass flow rate and temperature</span>
<a name="ln-10690"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CondWaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">MdotWater</span>
<a name="ln-10691"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">CondWaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TankTemp</span>
<a name="ln-10692"></a>
<a name="ln-10693"></a><span class="c">!       initialize temperatures for HPWH DX Coil heating capacity and COP curves</span>
<a name="ln-10694"></a>        <span class="n">HPWHInletDBTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span>
<a name="ln-10695"></a>        <span class="n">HPWHInletWBTemp</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">HPWHInletDBTemp</span><span class="p">,</span><span class="n">AmbientHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-10696"></a>
<a name="ln-10697"></a><span class="c">!       set up full air flow on DX coil inlet node</span>
<a name="ln-10698"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10699"></a><span class="k">          </span><span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>         <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-10700"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-10701"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">Temp</span>                 <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span>
<a name="ln-10702"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">HumRat</span>               <span class="o">=</span> <span class="n">AmbientHumRat</span>
<a name="ln-10703"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">InletAirMixerNode</span><span class="p">)%</span><span class="n">Enthalpy</span>             <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10704"></a>               <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span><span class="p">,</span><span class="n">AmbientHumRat</span><span class="p">)</span>
<a name="ln-10705"></a>        <span class="k">ELSE</span>
<a name="ln-10706"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10707"></a><span class="k">            </span><span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>            <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-10708"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>    <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-10709"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span><span class="p">)%</span><span class="n">Temp</span>                    <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-10710"></a>               <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span>
<a name="ln-10711"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span><span class="p">)%</span><span class="n">HumRat</span>                  <span class="o">=</span> <span class="n">AmbientHumRat</span>
<a name="ln-10712"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">HeatPumpAirInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>                <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10713"></a>                 <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span><span class="p">,</span><span class="n">AmbientHumRat</span><span class="p">)</span>
<a name="ln-10714"></a>          <span class="k">ELSE</span>
<a name="ln-10715"></a><span class="k">            </span><span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>            <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-10716"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>    <span class="o">=</span> <span class="n">MdotAir</span>
<a name="ln-10717"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span><span class="p">)%</span><span class="n">Temp</span>                    <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span>
<a name="ln-10718"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span><span class="p">)%</span><span class="n">HumRat</span>                  <span class="o">=</span> <span class="n">AmbientHumRat</span>
<a name="ln-10719"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OutsideAirNode</span><span class="p">)%</span><span class="n">Enthalpy</span>                <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-10720"></a>                 <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span><span class="p">,</span><span class="n">AmbientHumRat</span><span class="p">)</span>
<a name="ln-10721"></a>          <span class="k">END IF</span>
<a name="ln-10722"></a><span class="k">        END IF</span>
<a name="ln-10723"></a>
<a name="ln-10724"></a><span class="k">        </span><span class="n">HPWHCrankcaseDBTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">AmbientTemp</span>
<a name="ln-10725"></a>
<a name="ln-10726"></a><span class="c">!       simulate the HPWH coil/fan to find heating capacity</span>
<a name="ln-10727"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanPlacement</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10728"></a><span class="k">          CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-10729"></a><span class="c">!         CALL SimDXCoil(HPWaterHeater(HPNum)%DXCoilName, CompOp,  .TRUE.,PartLoadRatio, HPWaterHeater(HPNum)%DXCoilNum,FanOpMode)</span>
<a name="ln-10730"></a>          <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>   <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span>     <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-10731"></a>          <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-10732"></a>          <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>   <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span>     <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-10733"></a>        <span class="k">ELSE</span>
<a name="ln-10734"></a><span class="k">          CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>   <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span>     <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-10735"></a>          <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-10736"></a>          <span class="k">CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilName</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>   <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span>     <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilNum</span><span class="p">,</span><span class="n">CycFanCycCoil</span><span class="p">)</span>
<a name="ln-10737"></a>          <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanName</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">FanNum</span><span class="p">)</span>
<a name="ln-10738"></a>        <span class="k">END IF</span>
<a name="ln-10739"></a>
<a name="ln-10740"></a><span class="k">        IF</span><span class="p">(</span><span class="n">FirstTimeFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10741"></a><span class="k">          </span><span class="n">RatedDXCoilTotalCapacity</span> <span class="o">=</span> <span class="n">DXCoilTotalCapacity</span>
<a name="ln-10742"></a>          <span class="n">FirstTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10743"></a>        <span class="k">END IF</span>
<a name="ln-10744"></a>
<a name="ln-10745"></a><span class="c">!       Switch the HPWH info with the tank info and call CalcWaterThermalTankMixed to get Standard Rating</span>
<a name="ln-10746"></a><span class="c">!       (backup element is assumed to be disabled during the rating procedure)</span>
<a name="ln-10747"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10748"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>          <span class="o">=</span> <span class="n">HPWHHeatingCapacity</span>
<a name="ln-10749"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span>          <span class="o">=</span> <span class="n">HPWHHeatingCapacity</span>
<a name="ln-10750"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span>           <span class="o">=</span> <span class="n">HPWHHeatingCOP</span> <span class="c">!* WaterHeater(WaterHeaterNum)%Efficiency</span>
<a name="ln-10751"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>        <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>
<a name="ln-10752"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span>       <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span>
<a name="ln-10753"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10754"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10755"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PLFCurve</span>             <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">DXCoilPLFFPLR</span>
<a name="ln-10756"></a>
<a name="ln-10757"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span><span class="p">)</span>
<a name="ln-10758"></a>
<a name="ln-10759"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">MixedWaterHeater</span><span class="p">)</span>
<a name="ln-10760"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-10761"></a>               <span class="k">CALL </span><span class="n">CalcWaterThermalTankMixed</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-10762"></a>
<a name="ln-10763"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">StratifiedWaterHeater</span><span class="p">)</span>
<a name="ln-10764"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-10765"></a>               <span class="k">CALL </span><span class="n">CalcWaterThermalTankStratified</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-10766"></a>
<a name="ln-10767"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-10768"></a><span class="c">!         Unhandled water heater type</span>
<a name="ln-10769"></a>
<a name="ln-10770"></a>        <span class="k">END SELECT</span>
<a name="ln-10771"></a>
<a name="ln-10772"></a><span class="c">!       reset the water heater data to original values</span>
<a name="ln-10773"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>          <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-10774"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MinCapacity</span>          <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BackupElementCapacity</span>
<a name="ln-10775"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span>           <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">BackupElementEfficiency</span>
<a name="ln-10776"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaLoad</span>        <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WHOnCycParaLoad</span>
<a name="ln-10777"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaLoad</span>       <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WHOffCycParaLoad</span>
<a name="ln-10778"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFracToTank</span>  <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WHOnCycParaFracToTank</span>
<a name="ln-10779"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFracToTank</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WHOffCycParaFracToTank</span>
<a name="ln-10780"></a>        <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">PLFCurve</span>             <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">HPNum</span><span class="p">)%</span><span class="n">WHPLFCurve</span>
<a name="ln-10781"></a>
<a name="ln-10782"></a>      <span class="k">END IF</span>
<a name="ln-10783"></a>
<a name="ln-10784"></a><span class="k">      </span><span class="n">FuelEnergy</span> <span class="o">=</span> <span class="n">FuelEnergy</span> <span class="o">+</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FuelRate</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-10785"></a>         <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OffCycParaFuelRate</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-10786"></a>                   <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">OnCycParaFuelRate</span><span class="p">)</span> <span class="o">*</span> <span class="n">SecInTimeStep</span>
<a name="ln-10787"></a>
<a name="ln-10788"></a>    <span class="k">END DO</span>  <span class="c">! Step</span>
<a name="ln-10789"></a>
<a name="ln-10790"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryDone</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-10791"></a>       <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryFuel</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10792"></a>        <span class="c">! Calculate Recovery Efficiency based on energy used to recover from the first draw</span>
<a name="ln-10793"></a>        <span class="c">! FirstRecoveryFuel is recorded inside the CalcWaterThermalTank subroutine</span>
<a name="ln-10794"></a>        <span class="n">RecoveryEfficiency</span> <span class="o">=</span> <span class="n">DrawMass</span> <span class="o">*</span> <span class="n">CPHW</span><span class="p">(</span><span class="mi">5</span><span class="mf">7.2222d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span><span class="mf">7.2222d0</span> <span class="o">-</span> <span class="mi">1</span><span class="mf">4.4444d0</span><span class="p">)</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-10795"></a>           <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">FirstRecoveryFuel</span>
<a name="ln-10796"></a>
<a name="ln-10797"></a>        <span class="c">! Calculate Energy Factor based on total energy (including parasitics) used over entire test</span>
<a name="ln-10798"></a>        <span class="n">EnergyFactor</span> <span class="o">=</span> <span class="n">TotalDrawMass</span> <span class="o">*</span> <span class="n">CPHW</span><span class="p">(</span><span class="mi">5</span><span class="mf">7.2222d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span><span class="mf">7.2222d0</span> <span class="o">-</span> <span class="mi">1</span><span class="mf">4.4444d0</span><span class="p">)</span> <span class="o">/</span> <span class="n">FuelEnergy</span>
<a name="ln-10799"></a>
<a name="ln-10800"></a>    <span class="k">ELSE</span>
<a name="ln-10801"></a><span class="k">        </span><span class="n">RecoveryEfficiency</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10802"></a>        <span class="n">EnergyFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10803"></a>
<a name="ln-10804"></a>        <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Water heater = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-10805"></a>          <span class="s1">&#39;:  Recovery Efficiency and Energy Factor could not be calculated during the test for standard ratings&#39;</span><span class="p">)</span>
<a name="ln-10806"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Setpoint was never recovered and/or heater never turned on&#39;</span><span class="p">)</span>
<a name="ln-10807"></a>    <span class="k">END IF</span>
<a name="ln-10808"></a>
<a name="ln-10809"></a><span class="k">  ELSE</span>
<a name="ln-10810"></a>
<a name="ln-10811"></a>    <span class="c">! Storage-only tank</span>
<a name="ln-10812"></a>    <span class="n">RecoveryEfficiency</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10813"></a>    <span class="n">EnergyFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10814"></a>
<a name="ln-10815"></a>  <span class="k">END IF</span>  <span class="c">! WaterThermalTank(WaterThermalTankNum)%MaxCapacity &gt; 0.0</span>
<a name="ln-10816"></a>
<a name="ln-10817"></a>  <span class="c">!create predefined report</span>
<a name="ln-10818"></a>  <span class="c">! Store values for the input verification and summary report</span>
<a name="ln-10819"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10820"></a><span class="k">    </span><span class="n">equipName</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-10821"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHType</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span>
<a name="ln-10822"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHVol</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">)</span>
<a name="ln-10823"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHHeatIn</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span><span class="p">)</span>
<a name="ln-10824"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHThEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span><span class="p">)</span>
<a name="ln-10825"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHRecEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">RecoveryEfficiency</span><span class="p">)</span>
<a name="ln-10826"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHEnFac</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">EnergyFactor</span><span class="p">)</span>
<a name="ln-10827"></a>  <span class="k">ELSE</span>
<a name="ln-10828"></a><span class="k">    </span><span class="n">equipName</span> <span class="o">=</span> <span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-10829"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHType</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">)</span>
<a name="ln-10830"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHVol</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">)</span>
<a name="ln-10831"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHHeatIn</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">HPWHHeatingCapacity</span><span class="p">)</span>
<a name="ln-10832"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHThEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Efficiency</span><span class="p">)</span>
<a name="ln-10833"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHRecEff</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">RecoveryEfficiency</span><span class="p">)</span>
<a name="ln-10834"></a>    <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchSWHEnFac</span><span class="p">,</span><span class="n">equipName</span><span class="p">,</span><span class="n">EnergyFactor</span><span class="p">)</span>
<a name="ln-10835"></a>  <span class="k">END IF</span>
<a name="ln-10836"></a>
<a name="ln-10837"></a>  <span class="c">! Write test results</span>
<a name="ln-10838"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10839"></a>
<a name="ln-10840"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">TypeNum</span> <span class="o">==</span> <span class="n">StratifiedWaterHeater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10841"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">ControlType</span> <span class="o">==</span> <span class="n">PriorityMasterSlave</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10842"></a><span class="k">        </span><span class="n">MaxCapacity</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span><span class="p">,</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity2</span><span class="p">)</span>
<a name="ln-10843"></a>      <span class="k">ELSE</span>  <span class="c">! PrioritySimultaneous</span>
<a name="ln-10844"></a>        <span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span> <span class="o">+</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity2</span>
<a name="ln-10845"></a>      <span class="k">END IF</span>
<a name="ln-10846"></a><span class="k">    ELSE</span>  <span class="c">! WaterHeaterMixed</span>
<a name="ln-10847"></a>      <span class="n">MaxCapacity</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">MaxCapacity</span>
<a name="ln-10848"></a>    <span class="k">END IF</span>
<a name="ln-10849"></a>
<a name="ln-10850"></a><span class="k">    WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">720</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-10851"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-10852"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxCapacity</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>                         <span class="p">&amp;</span>
<a name="ln-10853"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RecoveryEfficiency</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>                  <span class="p">&amp;</span>
<a name="ln-10854"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">EnergyFactor</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-10855"></a>  <span class="k">ELSE</span>
<a name="ln-10856"></a><span class="k">    WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">721</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-10857"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">HPWaterHeater</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeatPumpNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-10858"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>         <span class="p">&amp;</span>
<a name="ln-10859"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HPWHHeatingCapacity</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>                        <span class="p">&amp;</span>
<a name="ln-10860"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RecoveryEfficiency</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>                         <span class="p">&amp;</span>
<a name="ln-10861"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">EnergyFactor</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>                               <span class="p">&amp;</span>
<a name="ln-10862"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">RatedDXCoilTotalCapacity</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-10863"></a>  <span class="k">END IF</span>
<a name="ln-10864"></a>
<a name="ln-10865"></a><span class="k">  </span><span class="mi">720</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;Water Heater Information&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-10866"></a>  <span class="mi">721</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;Heat Pump Water Heater Information&#39;</span><span class="p">,</span><span class="mi">7</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-10867"></a>
<a name="ln-10868"></a>  <span class="n">AlreadyRated</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10869"></a>  <span class="k">RETURN</span>
<a name="ln-10870"></a>
<a name="ln-10871"></a><span class="k">END SUBROUTINE </span><span class="n">CalcStandardRatings</span>
<a name="ln-10872"></a>
<a name="ln-10873"></a><span class="k">SUBROUTINE </span><span class="n">ReportCWTankInits</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span>
<a name="ln-10874"></a>
<a name="ln-10875"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10876"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-10877"></a>          <span class="c">!       DATE WRITTEN   March 2009</span>
<a name="ln-10878"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10879"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10880"></a>
<a name="ln-10881"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10882"></a>          <span class="c">! send chilled water tank info to EIO</span>
<a name="ln-10883"></a>
<a name="ln-10884"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10885"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-10886"></a>
<a name="ln-10887"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10888"></a>          <span class="c">! na</span>
<a name="ln-10889"></a>
<a name="ln-10890"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10891"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-10892"></a>
<a name="ln-10893"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10894"></a>
<a name="ln-10895"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10896"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-10897"></a>
<a name="ln-10898"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10899"></a>          <span class="c">! na</span>
<a name="ln-10900"></a>
<a name="ln-10901"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10902"></a>          <span class="c">! na</span>
<a name="ln-10903"></a>
<a name="ln-10904"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10905"></a>          <span class="c">! na</span>
<a name="ln-10906"></a>
<a name="ln-10907"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10908"></a>  <span class="kt">Logical</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyOneTimeSetupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! one time setup flag</span>
<a name="ln-10909"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">AlreadyReported</span> <span class="c">! control so we don&#39;t repeat again</span>
<a name="ln-10910"></a>
<a name="ln-10911"></a>
<a name="ln-10912"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">MyOneTimeSetupFlag</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10913"></a><span class="k">    Allocate</span><span class="p">(</span><span class="n">AlreadyReported</span><span class="p">(</span><span class="n">NumWaterThermalTank</span><span class="p">))</span>
<a name="ln-10914"></a>    <span class="n">AlreadyReported</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10915"></a>    <span class="n">MyOneTimeSetupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10916"></a>  <span class="n">ENDIF</span>
<a name="ln-10917"></a>
<a name="ln-10918"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">AlreadyReported</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">))</span> <span class="k">Then</span> <span class="c">! bail we already did this one</span>
<a name="ln-10919"></a>    <span class="k">RETURN</span>
<a name="ln-10920"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-10921"></a>
<a name="ln-10922"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">728</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="k">Type</span><span class="p">),</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-10923"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Volume</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-10924"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseDesignVolFlowRate</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>  <span class="p">&amp;</span>
<a name="ln-10925"></a>      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceDesignVolFlowRate</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-10926"></a>
<a name="ln-10927"></a>
<a name="ln-10928"></a> <span class="mi">728</span> <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;Chilled Water Tank Information&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">))</span>
<a name="ln-10929"></a>
<a name="ln-10930"></a>  <span class="n">AlreadyReported</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10931"></a>
<a name="ln-10932"></a>  <span class="k">RETURN</span>
<a name="ln-10933"></a>
<a name="ln-10934"></a><span class="k">END SUBROUTINE </span><span class="n">ReportCWTankInits</span>
<a name="ln-10935"></a>
<a name="ln-10936"></a>
<a name="ln-10937"></a><span class="k">FUNCTION </span><span class="n">FindStratifiedTankSensedTemp</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">,</span><span class="n">ControlLocationType</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="n">SensedTemp</span><span class="p">)</span>
<a name="ln-10938"></a>
<a name="ln-10939"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10940"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-10941"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-10942"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10943"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10944"></a>
<a name="ln-10945"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10946"></a>          <span class="c">! find tank temperature depending on how sensed</span>
<a name="ln-10947"></a>
<a name="ln-10948"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10949"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-10950"></a>
<a name="ln-10951"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10952"></a>          <span class="c">! na</span>
<a name="ln-10953"></a>
<a name="ln-10954"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10955"></a>          <span class="c">! na</span>
<a name="ln-10956"></a>
<a name="ln-10957"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10958"></a>
<a name="ln-10959"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-10960"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">WaterThermalTankNum</span>
<a name="ln-10961"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ControlLocationType</span>
<a name="ln-10962"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">SensedTemp</span>
<a name="ln-10963"></a>
<a name="ln-10964"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10965"></a>          <span class="c">! na</span>
<a name="ln-10966"></a>
<a name="ln-10967"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10968"></a>          <span class="c">! na</span>
<a name="ln-10969"></a>
<a name="ln-10970"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10971"></a>          <span class="c">! na</span>
<a name="ln-10972"></a>
<a name="ln-10973"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10974"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">StratNodeToUse</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10975"></a>
<a name="ln-10976"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ControlLocationType</span><span class="p">)</span>
<a name="ln-10977"></a>
<a name="ln-10978"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">Heater1HPWHControl</span><span class="p">)</span>
<a name="ln-10979"></a>     <span class="n">StratNodeToUse</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode1</span>
<a name="ln-10980"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">Heater2HPWHControl</span><span class="p">)</span>
<a name="ln-10981"></a>     <span class="n">StratNodeToUse</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">HeaterNode2</span>
<a name="ln-10982"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SourceInletHPWHControl</span><span class="p">)</span>
<a name="ln-10983"></a>     <span class="n">StratNodeToUse</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceInletStratNode</span>
<a name="ln-10984"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">SourceOutletHPWHControl</span><span class="p">)</span>
<a name="ln-10985"></a>     <span class="n">StratNodeToUse</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">SourceOutletStratNode</span>
<a name="ln-10986"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">UseInletHPWHControl</span><span class="p">)</span>
<a name="ln-10987"></a>     <span class="n">StratNodeToUse</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseInletStratNode</span>
<a name="ln-10988"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">UseOutletHPWHControl</span><span class="p">)</span>
<a name="ln-10989"></a>     <span class="n">StratNodeToUse</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">UseOutletStratNode</span>
<a name="ln-10990"></a>  <span class="k">END SELECT</span>
<a name="ln-10991"></a>
<a name="ln-10992"></a><span class="k">  </span><span class="n">SensedTemp</span> <span class="o">=</span> <span class="n">WaterThermalTank</span><span class="p">(</span><span class="n">WaterThermalTankNum</span><span class="p">)%</span><span class="n">Node</span><span class="p">(</span><span class="n">StratNodeToUse</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-10993"></a>
<a name="ln-10994"></a>  <span class="k">RETURN</span>
<a name="ln-10995"></a>
<a name="ln-10996"></a><span class="k">END FUNCTION </span><span class="n">FindStratifiedTankSensedTemp</span>
<a name="ln-10997"></a>
<a name="ln-10998"></a><span class="c">!     NOTICE</span>
<a name="ln-10999"></a><span class="c">!</span>
<a name="ln-11000"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-11001"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-11002"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-11003"></a><span class="c">!</span>
<a name="ln-11004"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-11005"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-11006"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-11007"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-11008"></a><span class="c">!</span>
<a name="ln-11009"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-11010"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-11011"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-11012"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-11013"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-11014"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-11015"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-11016"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-11017"></a><span class="c">!     permit others to do so.</span>
<a name="ln-11018"></a><span class="c">!</span>
<a name="ln-11019"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-11020"></a><span class="c">!</span>
<a name="ln-11021"></a>
<a name="ln-11022"></a><span class="k">END MODULE </span><span class="n">WaterThermalTanks</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
