<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>ElectricPowerManager.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>ElectricPowerManager.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.7% of total for source files.">2570 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/ElectricPowerManager.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">ElectricPowerManager.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/manageelectricpower.html">ManageElectricPower</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html#src">ElectricPowerManager.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~electricpowermanager.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileelectricpowermanagerf90EfferentGraph" width="641pt" height="1290pt"
 viewBox="0.00 0.00 641.00 1289.85" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph" class="graph" transform="scale(.218 .218) rotate(0) translate(4 5914.0191)">
<title>sourcefile~~electricpowermanager.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-5914.0191 2936.9973,-5914.0191 2936.9973,4 -4,4"/>
<!-- sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~electricpowermanager.f90</title>
<polygon fill="none" stroke="#000000" points="2932.7805,-2155.9414 2798.6492,-2155.9414 2798.6492,-2133.9305 2932.7805,-2133.9305 2932.7805,-2155.9414"/>
<text text-anchor="middle" x="2865.7148" y="-2141.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">ElectricPowerManager.f90</text>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1163.3691,-2344.9414 1049.0393,-2344.9414 1049.0393,-2322.9305 1163.3691,-2322.9305 1163.3691,-2344.9414"/>
<text text-anchor="middle" x="1106.2042" y="-2330.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge373" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1279.407,-2220.936C1341.5183,-2192.187 1827.4991,-2197.0717 1895.2266,-2206.936 1990.8225,-2220.8591 2018.8548,-2222.4814 2103.5566,-2268.936 2176.1507,-2308.75 2202.9862,-2319.2074 2244.3391,-2390.936 2286.83,-2464.6384 2224.1529,-2515.0561 2280.3391,-2578.936 2325.5135,-2630.2961 2364.0688,-2599.1314 2426.5627,-2626.936 2460.4746,-2642.0239 2708.0028,-2829.0789 2716.4498,-2792.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2716.4498,-2792.936C2773.2036,-2546.3358 2842.197,-2246.9712 2860.8643,-2165.9799"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2864.3224,-2166.5598 2863.1579,-2156.0292 2857.5012,-2164.9875 2864.3224,-2166.5598"/>
</g>
<!-- sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~electricpowergenerators.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/electricpowergenerators.f90.html" xlink:title="ElectricPowerGenerators.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2426.6747,-4481.9414 2280.2271,-4481.9414 2280.2271,-4459.9305 2426.6747,-4459.9305 2426.6747,-4481.9414"/>
<text text-anchor="middle" x="2353.4509" y="-4467.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ElectricPowerGenerators.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1651.214,-2296.936C1676.7543,-2299.5951 2086.7046,-2372.561 2103.5566,-2391.936 2142.2201,-2436.3878 2128.1402,-2863.139 2139.5566,-2920.936 2168.0659,-3065.268 2215.3646,-3090.6966 2244.3391,-3234.936 2286.7336,-3445.9821 2261.9365,-3503.4619 2280.3391,-3717.936 2305.2415,-4008.1626 2341.8685,-4360.6678 2351.2158,-4449.7249"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2347.758,-4450.3106 2352.2844,-4459.8899 2354.7196,-4449.5787 2347.758,-4450.3106"/>
</g>
<!-- sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~photovoltaics.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/photovoltaics.f90.html" xlink:title="Photovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2762.4149,-2155.9414 2670.4847,-2155.9414 2670.4847,-2133.9305 2762.4149,-2133.9305 2762.4149,-2155.9414"/>
<text text-anchor="middle" x="2716.4498" y="-2141.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Photovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1651.214,-2144.936C1813.0545,-2127.796 1854.646,-2144.936 2017.3916,-2144.936 2017.3916,-2144.936 2017.3916,-2144.936 2353.4509,-2144.936 2462.0212,-2144.936 2588.8573,-2144.936 2660.2064,-2144.936"/>
<polygon fill="#0054ff" stroke="#0054ff" points="2660.322,-2148.4361 2670.322,-2144.936 2660.3219,-2141.4361 2660.322,-2148.4361"/>
</g>
<!-- sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~windturbine.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/windturbine.f90.html" xlink:title="WindTurbine.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1323.5607,-3638.9414 1235.2532,-3638.9414 1235.2532,-3616.9305 1323.5607,-3616.9305 1323.5607,-3638.9414"/>
<text text-anchor="middle" x="1279.407" y="-3624.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindTurbine.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1113.4006,-2345.2563C1127.5621,-2368.2388 1158.7243,-2422.4762 1170.8643,-2472.936 1272.6069,-2895.8302 1114.9678,-3025.7935 1206.8643,-3450.936 1219.7723,-3510.6526 1251.5911,-3575.9486 1268.4751,-3607.9657"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1265.3935,-3609.6254 1273.198,-3616.7907 1271.5653,-3606.3224 1265.3935,-3609.6254"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1710.5496,-3421.9414 1591.8784,-3421.9414 1591.8784,-3399.9305 1710.5496,-3399.9305 1710.5496,-3421.9414"/>
<text text-anchor="middle" x="1651.214" y="-3407.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1111.3087,-2345.2293C1125.5332,-2376.4923 1167.185,-2466.6383 1206.8643,-2538.936 1266.4682,-2647.5375 1308.9096,-2660.7703 1351.9497,-2776.936 1386.372,-2869.8424 1349.6588,-2905.556 1387.9497,-2996.936 1430.5081,-3098.5001 1489.865,-3096.1365 1534.2041,-3196.936 1567.0534,-3271.6148 1518.5621,-3313.7766 1570.2041,-3376.936 1576.6487,-3384.8178 1585.2401,-3390.901 1594.4206,-3395.5875"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1593.1879,-3398.8718 1603.7399,-3399.8235 1596.0845,-3392.4992 1593.1879,-3398.8718"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1514.8026,-1926.9414 1407.3512,-1926.9414 1407.3512,-1904.9305 1514.8026,-1904.9305 1514.8026,-1926.9414"/>
<text text-anchor="middle" x="1461.0769" y="-1912.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1152.3803,-2322.778C1159.3734,-2319.3303 1165.8978,-2314.8238 1170.8643,-2308.936 1222.9047,-2247.2402 1160.1225,-2196.737 1206.8643,-2130.936 1250.2742,-2069.8254 1304.5549,-2103.0105 1351.9497,-2044.936 1382.8761,-2007.0407 1353.2967,-1975.4565 1387.9497,-1940.936 1391.5989,-1937.3007 1395.7982,-1934.1935 1400.3005,-1931.5378"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1401.9475,-1934.6268 1409.2672,-1926.967 1398.7684,-1928.3903 1401.9475,-1934.6268"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1347.8047,-2002.9414 1211.0092,-2002.9414 1211.0092,-1980.9305 1347.8047,-1980.9305 1347.8047,-2002.9414"/>
<text text-anchor="middle" x="1279.407" y="-1988.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1153.0937,-2322.9287C1159.9182,-2319.466 1166.2018,-2314.9155 1170.8643,-2308.936 1251.2694,-2205.8182 1124.5624,-2118.5464 1206.8643,-2016.936 1209.4778,-2013.7092 1212.5305,-2010.8976 1215.8766,-2008.4479"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1217.9893,-2011.2596 1224.7154,-2003.0736 1214.3525,-2005.2784 1217.9893,-2011.2596"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~photovoltaicthermalcollectors.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/photovoltaicthermalcollectors.f90.html" xlink:title="PhotovoltaicThermalCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2634.4196,-2842.9414 2462.6104,-2842.9414 2462.6104,-2820.9305 2634.4196,-2820.9305 2634.4196,-2842.9414"/>
<text text-anchor="middle" x="2548.515" y="-2828.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PhotovoltaicThermalCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-2296.936C1853.2213,-2306.1492 1940.4611,-2226.3882 2103.5566,-2345.936 2132.7332,-2367.3222 2122.2765,-2387.1549 2139.5566,-2418.936 2197.8974,-2526.2348 2201.0319,-2562.0541 2280.3391,-2654.936 2348.8224,-2735.1413 2369.4645,-2757.3822 2462.5627,-2806.936 2470.5215,-2811.1722 2479.2874,-2814.7724 2488.0858,-2817.8072"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2487.0173,-2821.14 2497.609,-2820.8817 2489.168,-2814.4786 2487.0173,-2821.14"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1279.407,-2296.936C1444.6542,-2296.5839 1486.05,-2291.6802 1651.214,-2296.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1138.3274,-2322.9032C1172.7737,-2312.0618 1229.2874,-2297.1089 1279.407,-2296.936"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~hvactranspiredcollector.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/hvactranspiredcollector.f90.html" xlink:title="HVACTranspiredCollector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2622.5874,-2097.9414 2474.4426,-2097.9414 2474.4426,-2075.9305 2622.5874,-2075.9305 2622.5874,-2097.9414"/>
<text text-anchor="middle" x="2548.515" y="-2083.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACTranspiredCollector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1651.214,-2144.936C1703.3077,-2139.5122 1716.0505,-2135.5302 1768.2239,-2130.936 1956.1204,-2114.3903 2006.4823,-2141.3072 2191.9479,-2106.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1279.407,-2220.936C1317.1896,-2202.2156 1609.0582,-2145.8697 1651.214,-2144.936"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2400.0851,-2078.9414 2306.8168,-2078.9414 2306.8168,-2056.9305 2400.0851,-2056.9305 2400.0851,-2078.9414"/>
<text text-anchor="middle" x="2353.4509" y="-2064.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1117.3916,-2322.5873C1142.4679,-2297.1976 1201.4127,-2237.8009 1206.8643,-2234.936 1235.9309,-2219.6605 1250.3906,-2236.3067 1279.407,-2220.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1279.407,-2220.936C1309.4164,-2205.0392 1325.8771,-2218.6958 1351.9497,-2196.936 1377.6027,-2175.5264 1362.4396,-2152.5156 1387.9497,-2130.936 1511.5509,-2026.3785 1610.2092,-2118.3406 1732.2239,-2011.936 1758.8889,-1988.6824 1744.8305,-1967.4785 1768.2239,-1940.936 1813.2974,-1889.7948 1838.9164,-1893.3575 1895.2266,-1854.936 1961.3245,-1809.836 2137.6108,-1592.1957 2191.9479,-1650.936"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~heatbalanceconvectioncoeffs.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/heatbalanceconvectioncoeffs.f90.html" xlink:title="HeatBalanceConvectionCoeffs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2103.722,-2422.9414 1931.0612,-2422.9414 1931.0612,-2400.9305 2103.722,-2400.9305 2103.722,-2422.9414"/>
<text text-anchor="middle" x="2017.3916" y="-2408.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceConvectionCoeffs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1461.0769,-2372.936C1542.1053,-2396.9268 1566.8315,-2368.3797 1651.214,-2372.936"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1651.214,-2372.936C1703.5131,-2375.7599 1716.1625,-2381.2102 1768.2239,-2386.936 1818.6505,-2392.4819 1874.8753,-2398.1662 1921.1356,-2402.7104"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1920.8578,-2406.1999 1931.1515,-2403.6918 1921.5405,-2399.2332 1920.8578,-2406.1999"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1279.407,-2296.936C1366.9296,-2296.7495 1377.1553,-2348.0885 1461.0769,-2372.936"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1894.5488,-2536.9414 1768.9016,-2536.9414 1768.9016,-2514.9305 1894.5488,-2514.9305 1894.5488,-2536.9414"/>
<text text-anchor="middle" x="1831.7252" y="-2522.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1461.0769,-2372.936C1593.0408,-2406.3379 1739.6567,-2477.9778 1801.5501,-2509.954"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1800.2541,-2513.2249 1810.741,-2514.7334 1803.4837,-2507.0144 1800.2541,-2513.2249"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1329.5599,-4592.9414 1229.254,-4592.9414 1229.254,-4570.9305 1329.5599,-4570.9305 1329.5599,-4592.9414"/>
<text text-anchor="middle" x="1279.407" y="-4578.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge374" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.8023,-4592.9558C1292.9819,-4683.9821 1389.9796,-5314.2399 1768.2239,-5555.936 1988.4366,-5696.6507 2160.8364,-5789.554 2353.4509,-5612.936"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1510.4668,-4706.9414 1411.687,-4706.9414 1411.687,-4684.9305 1510.4668,-4684.9305 1510.4668,-4706.9414"/>
<text text-anchor="middle" x="1461.0769" y="-4692.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1291.7889,-4593.0446C1315.6126,-4614.2546 1367.2979,-4659.4356 1387.9497,-4670.936 1395.0333,-4674.8806 1402.8475,-4678.356 1410.6525,-4681.3639"/>
<polygon fill="#aaff00" stroke="#aaff00" points="1409.5247,-4684.6779 1420.1188,-4684.8011 1411.9138,-4678.0982 1409.5247,-4684.6779"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2055.018,-4748.9414 1979.7652,-4748.9414 1979.7652,-4726.9305 2055.018,-4726.9305 2055.018,-4748.9414"/>
<text text-anchor="middle" x="2017.3916" y="-4734.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M1831.7252,-4698.936C1878.8643,-4706.353 1932.1136,-4717.8659 1969.4593,-4726.4631"/>
<polygon fill="#54ff00" stroke="#54ff00" points="1969.0205,-4729.9542 1979.5528,-4728.8048 1970.6025,-4723.1353 1969.0205,-4729.9542"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1461.0769,-4618.936C1477.8785,-4619.1374 1717.2451,-4492.55 1732.2239,-4484.936 1821.1856,-4439.715 1834.3101,-4404.7336 1931.2266,-4380.936 2066.3731,-4347.751 2113.3711,-4333.8914 2244.3391,-4380.936 2283.6837,-4395.0688 2318.9546,-4430.2088 2338.1689,-4452.1642"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2335.5745,-4454.516 2344.7218,-4459.8619 2340.9047,-4449.9785 2335.5745,-4454.516"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1314.8296,-4592.9701C1351.1376,-4603.3713 1409.4342,-4617.5673 1461.0769,-4618.936"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1895.2279,-4748.9414 1768.2225,-4748.9414 1768.2225,-4726.9305 1895.2279,-4726.9305 1895.2279,-4748.9414"/>
<text text-anchor="middle" x="1831.7252" y="-4734.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-4660.936C1685.9122,-4675.2931 1698.8218,-4667.778 1732.2239,-4684.936 1750.254,-4694.1977 1750.6138,-4702.8986 1768.2239,-4712.936 1774.6638,-4716.6065 1781.7486,-4719.9762 1788.7785,-4722.9727"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1787.6827,-4726.3051 1798.2649,-4726.8208 1790.314,-4719.8185 1787.6827,-4726.3051"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1329.6902,-4571.3307C1337.8936,-4567.8195 1345.7286,-4563.1486 1351.9497,-4556.936 1386.5601,-4522.3728 1359.9083,-4493.0131 1387.9497,-4452.936 1435.9916,-4384.274 1495.7573,-4408.3963 1534.2041,-4333.936 1590.2968,-4225.3007 1553.2166,-3906.0121 1570.2041,-3784.936 1589.2861,-3648.9318 1630.3732,-3488.707 1645.485,-3432.0589"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1648.9331,-3432.7138 1648.1468,-3422.1482 1642.1727,-3430.898 1648.9331,-3432.7138"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1534.3315,-3353.9414 1387.8223,-3353.9414 1387.8223,-3331.9305 1534.3315,-3331.9305 1534.3315,-3353.9414"/>
<text text-anchor="middle" x="1461.0769" y="-3339.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1291.7642,-4570.6736C1308.9837,-4554.0784 1339.4832,-4521.1898 1351.9497,-4485.936 1392.7563,-4370.5398 1324.9077,-3489.8509 1387.9497,-3384.936 1394.7923,-3373.5484 1405.972,-3364.9568 1417.5543,-3358.6097"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1419.4554,-3361.5735 1426.8543,-3353.9901 1416.3413,-3355.3043 1419.4554,-3361.5735"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2235.7325,-4767.9414 2148.1632,-4767.9414 2148.1632,-4745.9305 2235.7325,-4745.9305 2235.7325,-4767.9414"/>
<text text-anchor="middle" x="2191.9479" y="-4753.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-4660.936C1723.043,-4690.6567 1712.5591,-4736.6759 1768.2239,-4790.936 1872.5498,-4892.6292 1888.0176,-5070.9268 2017.3916,-5003.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2017.3916,-5003.936C2113.1648,-4955.9676 2167.1411,-4827.6128 2185.12,-4777.4387"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2188.4319,-4778.5707 2188.4122,-4767.9759 2181.8206,-4776.2705 2188.4319,-4778.5707"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1894.4645,-3752.9414 1768.986,-3752.9414 1768.986,-3730.9305 1894.4645,-3730.9305 1894.4645,-3752.9414"/>
<text text-anchor="middle" x="1831.7252" y="-3738.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1651.214,-4084.936C1701.2172,-3955.8665 1787.4064,-3812.7652 1819.3473,-3761.5113"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1822.3153,-3763.3663 1824.6591,-3753.034 1816.3835,-3759.6495 1822.3153,-3763.3663"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1831.7252,-4698.936C1995.2859,-4724.6711 2039.02,-4540.4737 2191.9479,-4603.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-4660.936C1689.1953,-4676.3577 1790.8576,-4695.7344 1831.7252,-4698.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-4618.936C1504.333,-4620.0823 1611.1216,-4644.6571 1651.214,-4660.936"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1461.0769,-4618.936C1762.7928,-4626.932 1837.8036,-4596.3819 2139.5566,-4589.936 2186.116,-4588.9414 2198.2703,-4583.1218 2244.3391,-4589.936 2294.4574,-4597.3491 2336.2926,-4670.6055 2353.4509,-4622.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2353.4509,-4622.936C2371.2533,-4558.2775 2409.1002,-4555.6871 2426.5627,-4490.936 2476.1045,-4307.2349 2448.8186,-2968.7032 2462.5627,-2778.936 2481.8124,-2513.1537 2531.5047,-2192.8239 2545.0569,-2108.2462"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2548.5232,-2108.7354 2546.6577,-2098.306 2541.6122,-2107.6223 2548.5232,-2108.7354"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1329.6084,-4572.0964C1384.8958,-4559.1447 1473.9329,-4531.8082 1534.2041,-4480.936 1763.6464,-4287.2739 1775.5008,-4185.2804 1895.2266,-3909.936 2139.0924,-3349.0952 2143.751,-3182.1731 2244.3391,-2578.936 2253.2452,-2525.5255 2247.2416,-2135.791 2280.3391,-2092.936 2284.8489,-2087.0967 2290.7955,-2082.6125 2297.3535,-2079.1707"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2298.8601,-2082.3316 2306.5976,-2075.0941 2296.0355,-2075.9268 2298.8601,-2082.3316"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1651.214,-4084.936C1679.3738,-4012.2491 1862.9063,-3903.8708 1895.2266,-3832.936 1910.4525,-3799.5189 2002.4127,-2607.1708 2015.7733,-2433.0619"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2019.2631,-2433.3277 2016.5381,-2423.0893 2012.2836,-2432.7924 2019.2631,-2433.3277"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1651.214,-4084.936C1682.3215,-4004.6405 1712.4112,-3992.7363 1732.2239,-3908.936 1788.0879,-3672.6516 1738.2175,-3057.8732 1768.2239,-2816.936 1781.0003,-2714.3469 1812.5507,-2594.5123 1825.759,-2546.938"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1829.1657,-2547.7518 1828.4942,-2537.1783 1822.4254,-2545.8628 1829.1657,-2547.7518"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1319.6647,-4570.9065C1330.4858,-4567.1884 1341.9528,-4562.5311 1351.9497,-4556.936 1357.6713,-4553.7337 1530.4192,-4412.29 1534.2041,-4406.936 1622.1007,-4282.6 1596.2075,-4226.9202 1651.214,-4084.936"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-1395.9414 528.0262,-1395.9414 528.0262,-1373.9305 643.4123,-1373.9305 643.4123,-1395.9414"/>
<text text-anchor="middle" x="585.7192" y="-1381.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge375" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2017.3916,-204.936C2324.2976,-253.2947 2549.7366,57.2406 2716.4498,-204.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.1294,-1373.8944C643.8288,-1370.4356 649.9299,-1365.8952 654.4731,-1359.936 714.6241,-1281.0381 627.5547,-991.6451 690.4731,-914.936 739.8377,-854.7515 796.0212,-912.8102 858.9067,-866.936 977.1418,-780.685 940.2281,-698.5475 1041.5442,-592.936 1242.7644,-383.1847 1297.9221,-309.6596 1570.2041,-207.936 1756.3895,-138.3778 1820.4026,-178.5038 2017.3916,-204.936"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="808.0587,-2859.9414 741.3212,-2859.9414 741.3212,-2837.9305 808.0587,-2837.9305 808.0587,-2859.9414"/>
<text text-anchor="middle" x="774.6899" y="-2845.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M604.1693,-1396.0055C620.7043,-1407.0832 643.9287,-1425.7844 654.4731,-1448.936 703.8712,-1557.3947 673.5536,-2402.9649 690.4731,-2520.936 707.4603,-2639.3785 750.6663,-2776.8055 767.6659,-2828.1699"/>
<polygon fill="#ffff00" stroke="#ffff00" points="764.3898,-2829.4097 770.8767,-2837.7864 771.0295,-2827.1927 764.3898,-2829.4097"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M643.5617,-1380.274C681.1572,-1378.3874 731.1066,-1378.0371 774.6899,-1384.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M774.6899,-1384.936C920.2177,-1407.9719 959.1994,-1375.0087 1106.2042,-1384.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1106.2042,-1384.936C1385.7029,-1400.2141 1531.881,-1258.4478 1732.2239,-1453.936 1806.2777,-1526.1953 1729.8364,-1587.8538 1768.2239,-1683.936 1865.4519,-1927.2935 2016.3015,-1921.8273 2103.5566,-2168.936 2175.6723,-2373.1695 2091.3189,-2443.7841 2139.5566,-2654.936 2167.8554,-2778.8086 2217.827,-2796.6687 2244.3391,-2920.936 2281.3313,-3094.3255 2267.7682,-3541.0905 2280.3391,-3717.936 2300.9933,-4008.4958 2340.7327,-4360.7569 2350.9881,-4449.7428"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2347.5369,-4450.3677 2352.1626,-4459.8994 2354.4906,-4449.5635 2347.5369,-4450.3677"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1831.7252,-392.936C1913.6155,-382.7742 1942.1006,-359.1639 2017.3916,-392.936"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M633.386,-1373.9206C641.1599,-1370.4511 648.5829,-1365.9004 654.4731,-1359.936 688.548,-1325.4322 658.4108,-1293.3175 690.4731,-1256.936 742.1943,-1198.2473 961.0655,-1164.2873 1005.5442,-1099.936 1095.7146,-969.4786 949.2598,-873.9066 1041.5442,-744.936 1265.2685,-432.2735 1450.1904,-440.2807 1831.7252,-392.936"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge333" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M604.2129,-1395.9858C620.7788,-1407.0495 644.0239,-1425.7413 654.4731,-1448.936 719.3002,-1592.8362 649.4581,-2716.53 690.4731,-2868.936 731.0185,-3019.5964 806.9199,-3029.831 858.9067,-3176.936 888.8551,-3261.6798 859.6971,-3293.2395 894.9067,-3375.936 927.78,-3453.1451 956.7608,-3460.6565 1005.5442,-3528.936 1021.6733,-3551.511 1022.2601,-3559.9885 1041.5442,-3579.936 1066.6058,-3605.8598 1072.046,-3617.3884 1106.2042,-3628.936"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1106.2042,-3628.936C1144.3951,-3642.0168 1190.162,-3641.1033 1225.0566,-3637.2757"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1225.5466,-3640.742 1235.0546,-3636.0676 1224.7069,-3633.7925 1225.5466,-3640.742"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-1498.936C971.6924,-1512.4401 981.1555,-1505.9802 1005.5442,-1512.936 1015.7285,-1515.8406 1725.92,-1735.4261 1732.2239,-1743.936 1830.4133,-1876.486 1674.5478,-4577.1587 1768.2239,-4712.936 1770.4043,-4716.0963 1773.0502,-4718.8572 1776.0089,-4721.269"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1774.1968,-4724.2669 1784.4662,-4726.8728 1778.0633,-4718.4316 1774.1968,-4724.2669"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-1384.936C812.5885,-1390.935 825.4854,-1385.0865 858.9067,-1403.936 909.9186,-1432.7064 900.9069,-1467.3508 950.2255,-1498.936"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-1308.936C877.3379,-1275.2986 934.607,-1314.3976 1005.5442,-1232.936 1057.6913,-1173.0522 991.0515,-1119.2211 1041.5442,-1057.936 1253.3245,-800.8893 1437.3253,-912.7523 1768.2239,-874.936 1861.8344,-864.2378 2111.2047,-811.3775 2191.9479,-859.936"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1831.7252,-736.936C2101.6415,-781.3097 2255.0253,-681.8661 2426.5627,-894.936 2503.0855,-989.9863 2541.7822,-1912.1592 2547.7077,-2065.4051"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2544.2251,-2065.9292 2548.1042,-2075.7883 2551.22,-2065.662 2544.2251,-2065.9292"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M617.3392,-1373.831C629.0548,-1369.6135 642.4183,-1364.6809 654.4731,-1359.936 708.479,-1338.6786 719.2055,-1325.9649 774.6899,-1308.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M774.6899,-1308.936C811.8969,-1297.5167 824.1933,-1302.5353 858.9067,-1284.936 932.5349,-1247.6074 962.4599,-1241.351 1005.5442,-1170.936 1050.1734,-1097.9961 1009.7622,-1061.3205 1041.5442,-981.936 1091.8839,-856.1983 1087.9198,-790.7144 1206.8643,-725.936 1265.5808,-693.9583 1384.7387,-647.3076 1831.7252,-736.936"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1732.2338,-1774.9414 1570.1942,-1774.9414 1570.1942,-1752.9305 1732.2338,-1752.9305 1732.2338,-1774.9414"/>
<text text-anchor="middle" x="1651.214" y="-1760.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-1498.936C971.6924,-1512.4401 986.7018,-1495.9608 1005.5442,-1512.936 1040.0186,-1543.994 1012.2081,-1574.9849 1041.5442,-1610.936 1062.9084,-1637.1176 1074.1421,-1640.2622 1106.2042,-1650.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-1800.936C1464.2722,-1800.5776 1531.5452,-1787.4351 1585.1728,-1776.9153"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1585.87,-1780.3454 1595.0089,-1774.9853 1584.5221,-1773.4764 1585.87,-1780.3454"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-1650.936C1187.437,-1677.9792 1375.9943,-1810.4784 1461.0769,-1800.936"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1461.0769,-1610.936C1491.1414,-1624.762 1502.5854,-1615.1746 1534.2041,-1624.936 1625.8849,-1653.2399 1677.1737,-1632.3487 1732.2239,-1710.936 1769.8418,-1764.6377 1757.294,-2235.2868 1768.2239,-2299.936 1781.2928,-2377.2377 1810.5761,-2465.974 1824.327,-2505.3136"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1821.0618,-2506.5785 1827.6931,-2514.8415 1827.662,-2504.2467 1821.0618,-2506.5785"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1106.2042,-1384.936C1293.1906,-1383.8564 1288.7402,-1538.3748 1461.0769,-1610.936"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge376" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-2868.936C1651.1451,-2903.8596 1702.4144,-2857.9371 1895.2266,-2844.936 2185.8354,-2825.3405 2257.4421,-2782.2563 2548.515,-2792.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M791.1717,-2860.0942C821.1986,-2879.4734 887.5162,-2917.9569 950.2255,-2924.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-2848.936C1210.7414,-2813.8736 1244.5865,-2789.8255 1351.9497,-2814.936 1404.6419,-2827.2598 1409.9982,-2851.0666 1461.0769,-2868.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-2924.936C996.6439,-2930.102 999.2189,-2892.6825 1041.5442,-2872.936 1069.3232,-2859.9759 1076.4481,-2856.2988 1106.2042,-2848.936"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-2638.936C968.8109,-2592.5017 987.0187,-2587.3942 1005.5442,-2540.936 1029.979,-2479.6584 1008.6685,-2454.1303 1041.5442,-2396.936 1051.7639,-2379.1566 1068.4281,-2363.094 1082.2794,-2351.6378"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1084.8148,-2354.093 1090.4576,-2345.1258 1080.4544,-2348.617 1084.8148,-2354.093"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M779.16,-2837.6843C792.2723,-2805.9889 833.6094,-2714.8996 894.9067,-2662.936 915.3498,-2645.6058 940.2667,-2663.8172 950.2255,-2638.936"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M776.6333,-2860.1287C784.5911,-2903.4258 817.9821,-3062.6936 894.9067,-3166.936 931.887,-3217.0489 973.692,-3199.417 1005.5442,-3252.936 1055.7675,-3337.3225 981.6131,-3393.1432 1041.5442,-3470.936 1079.9873,-3520.8365 1116.5962,-3496.953 1170.8643,-3528.936 1188.0945,-3539.0907 1189.2537,-3546.456 1206.8643,-3555.936 1267.1794,-3588.4042 1311.58,-3552.5971 1351.9497,-3607.936 1421.5982,-3703.4102 1317.5998,-4575.9774 1387.9497,-4670.936 1391.8284,-4676.1714 1396.867,-4680.3202 1402.4859,-4683.6062"/>
<polygon fill="#aaff00" stroke="#aaff00" points="1401.1863,-4686.866 1411.7099,-4688.0919 1404.2476,-4680.5709 1401.1863,-4686.866"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M950.2255,-2924.936C1130.3022,-2940.2456 1175.9552,-2946.8515 1351.9497,-2987.936 1372.6119,-2992.7594 1517.8033,-3031.4746 1534.2041,-3044.936 1560.0317,-3066.1346 1548.4636,-3085.5629 1570.2041,-3110.936 1629.2043,-3179.7943 1675.5543,-3164.1471 1732.2239,-3234.936 2094.22,-3687.1241 1810.5776,-3956.4035 1931.2266,-4522.936 1947.1511,-4597.713 1986.9479,-4680.0068 2006.3748,-4717.4078"/>
<polygon fill="#54ff00" stroke="#54ff00" points="2003.5227,-4719.5036 2011.2773,-4726.7228 2009.7171,-4716.2434 2003.5227,-4719.5036"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1461.0769,-2982.936C1506.5962,-3000.3268 1848.9915,-3029.5488 1895.2266,-3044.936 1995.3734,-3078.2652 2042.6839,-3072.711 2103.5566,-3158.936 2161.7105,-3241.3097 2116.853,-3284.6921 2139.5566,-3382.936 2175.6385,-3539.0705 2209.3152,-3571.5608 2244.3391,-3727.936 2307.5348,-4010.0931 2343.1249,-4361.0052 2351.5107,-4449.7806"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2348.0424,-4450.2842 2352.4567,-4459.9157 2355.0121,-4449.6336 2348.0424,-4450.2842"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1106.2042,-2848.936C1265.2877,-2793.1211 1305.898,-2917.0394 1461.0769,-2982.936"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1461.0769,-2678.936C1885.8815,-2603.7876 2093.4417,-2853.0465 2426.5627,-2578.936 2576.659,-2455.4284 2678.7621,-2234.1542 2707.9071,-2165.6955"/>
<polygon fill="#0054ff" stroke="#0054ff" points="2711.3091,-2166.6339 2711.9545,-2156.0588 2704.8552,-2163.9233 2711.3091,-2166.6339"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge332" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M778.0396,-2859.9601C789.6674,-2898.3321 829.1972,-3029.6598 858.9067,-3138.936 875.9879,-3201.7631 868.1363,-3221.5866 894.9067,-3280.936 930.7564,-3360.4137 963.9109,-3366.3294 1005.5442,-3442.936 1025.3302,-3479.3428 1012.6046,-3499.2807 1041.5442,-3528.936 1091.4366,-3580.0623 1171.6529,-3605.9281 1224.9397,-3618.1531"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1224.3723,-3621.612 1234.8917,-3620.3499 1225.8812,-3614.7766 1224.3723,-3621.612"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1162.021,-1088.9414 1050.3874,-1088.9414 1050.3874,-1066.9305 1162.021,-1066.9305 1162.021,-1088.9414"/>
<text text-anchor="middle" x="1106.2042" y="-1074.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge350" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M778.4732,-2837.7821C792.3002,-2796.4323 840.259,-2647.7376 858.9067,-2520.936 873.2096,-2423.6784 849.9162,-1724.34 894.9067,-1636.936 923.4105,-1581.5611 974.84,-1605.1217 1005.5442,-1550.936 1070.879,-1435.6354 1010.6044,-1383.7987 1041.5442,-1254.936 1055.5349,-1196.6653 1082.6089,-1131.1624 1096.8803,-1098.6106"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1100.1766,-1099.811 1101.0311,-1089.2507 1093.7776,-1096.9732 1100.1766,-1099.811"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1005.3635,-2498.9414 895.0874,-2498.9414 895.0874,-2476.9305 1005.3635,-2476.9305 1005.3635,-2498.9414"/>
<text text-anchor="middle" x="950.2255" y="-2484.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge369" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M775.5825,-2837.7701C779.833,-2791.6658 801.8722,-2613.8146 894.9067,-2512.936 898.0048,-2509.5767 901.6403,-2506.6383 905.5424,-2504.0744"/>
<polygon fill="#ff0055" stroke="#ff0055" points="907.4374,-2507.0232 914.4052,-2499.042 903.9811,-2500.936 907.4374,-2507.0232"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-3362.936C1672.673,-3394.4113 1709.7002,-3360.2136 1732.2239,-3390.936 1819.1055,-3509.4431 1683.8664,-4592.619 1768.2239,-4712.936 1770.4281,-4716.0798 1773.0918,-4718.8283 1776.0634,-4721.2311"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1774.268,-4724.2396 1784.5442,-4726.8186 1778.1192,-4718.3942 1774.268,-4724.2396"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-3000.936C1215.6693,-3005.9813 1257.1403,-2965.9884 1351.9497,-3020.936 1500.2609,-3106.891 1431.5577,-3238.1308 1570.2041,-3338.936 1600.5761,-3361.0184 1630.061,-3331.9095 1651.214,-3362.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M808.3154,-2848.4651C825.0059,-2849.8239 844.6025,-2853.9966 858.9067,-2864.936 887.959,-2887.1541 866.9736,-2915.3262 894.9067,-2938.936 969.653,-3002.1134 1009.2277,-2987.7469 1106.2042,-3000.936"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M808.1177,-2847.1544C825.3732,-2848.0505 845.5495,-2852.2024 858.9067,-2864.936 908.5304,-2912.2428 863.124,-2954.1881 894.9067,-3014.936 912.0264,-3047.6576 926.0959,-3048.9797 950.2255,-3076.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1461.0769,-3398.936C1500.5867,-3404.4141 1545.0661,-3407.3939 1581.0653,-3409.0136"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1581.3259,-3412.5277 1591.4652,-3409.4546 1581.6225,-3405.534 1581.3259,-3412.5277"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M950.2255,-3076.936C966.7964,-3096.1349 982.2325,-3080.9481 1005.5442,-3090.936 1172.7515,-3162.5756 1221.6409,-3182.0103 1351.9497,-3308.936 1372.6122,-3329.0621 1366.2668,-3343.9136 1387.9497,-3362.936 1415.1815,-3386.8263 1425.1943,-3393.9608 1461.0769,-3398.936"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1106.2042,-3000.936C1235.3992,-3007.6312 1264.1429,-3061.9301 1351.9497,-3156.936 1375.1599,-3182.0491 1370.9331,-3195.2742 1387.9497,-3224.936 1408.0826,-3260.0298 1433.2563,-3299.8387 1448.2026,-3323.0885"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1445.3958,-3325.194 1453.758,-3331.6997 1451.2779,-3321.3992 1445.3958,-3325.194"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M777.0969,-2837.7766C789.8403,-2779.2663 850.5232,-2507.8054 894.9067,-2434.936 930.171,-2377.0386 972.1868,-2388.9527 1005.5442,-2329.936 1042.0501,-2265.3487 992.8266,-2222.8895 1041.5442,-2166.936 1061.673,-2143.8174 1083.3882,-2163.4071 1106.2042,-2142.936"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1000.3527,-4040.9414 900.0982,-4040.9414 900.0982,-4018.9305 1000.3527,-4018.9305 1000.3527,-4040.9414"/>
<text text-anchor="middle" x="950.2255" y="-4026.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M778.4434,-2860.0943C792.1659,-2901.4597 839.8068,-3050.2016 858.9067,-3176.936 883.8391,-3342.3703 849.5633,-3767.8953 894.9067,-3928.936 903.5137,-3959.5043 922.7374,-3991.0233 936.0891,-4010.5444"/>
<polygon fill="#7fff00" stroke="#7fff00" points="933.3175,-4012.688 941.9254,-4018.865 939.0483,-4008.6683 933.3175,-4012.688"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1155.7531,-3410.9414 1056.6553,-3410.9414 1056.6553,-3388.9305 1155.7531,-3388.9305 1155.7531,-3410.9414"/>
<text text-anchor="middle" x="1106.2042" y="-3396.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M950.2255,-3076.936C974.355,-3104.8922 986.2951,-3107.42 1005.5442,-3138.936 1055.8242,-3221.2582 1088.6775,-3332.9533 1100.8785,-3378.8862"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1097.5668,-3380.0579 1103.4735,-3388.8534 1104.341,-3378.2941 1097.5668,-3380.0579"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M777.5135,-2837.8956C794.726,-2770.6492 885.1206,-2418.2985 894.9067,-2396.936 931.2191,-2317.6686 966.5796,-2312.9339 1005.5442,-2234.936 1027.7791,-2190.4268 1006.859,-2164.6066 1041.5442,-2128.936 1062.9138,-2106.9592 1082.3408,-2124.1759 1106.2042,-2104.936"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-2982.936C1491.159,-2996.7235 1503.185,-2985.4102 1534.2041,-2996.936 1726.088,-3068.2341 1812.2706,-3095.7966 1895.2266,-3282.936 1937.9463,-3379.307 1916.1854,-3651.5995 1931.2266,-3755.936 1983.5568,-4118.9367 2027.0558,-4204.25 2103.5566,-4562.936 2119.5755,-4638.0431 2092.0042,-4671.6331 2139.5566,-4731.936 2142.0821,-4735.1386 2145.1183,-4737.9533 2148.4407,-4740.4229"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2146.8262,-4743.5413 2157.1609,-4745.8748 2150.5371,-4737.6058 2146.8262,-4743.5413"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-2868.936C1753.007,-2923.7197 1839.2152,-2917.481 2103.5566,-3052.936 2220.4989,-3112.8601 2231.8295,-3260.6816 2353.4509,-3210.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2353.4509,-3210.936C2488.7955,-3129.9018 2533.9919,-2921.0333 2545.327,-2853.4091"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2548.8456,-2853.5695 2546.9651,-2843.1429 2541.933,-2852.4664 2548.8456,-2853.5695"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2353.4509,-2564.936C2459.6086,-2404.62 2524.8266,-2177.3295 2543.1729,-2107.8876"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2546.5802,-2108.6917 2545.714,-2098.1323 2539.8062,-2106.9271 2546.5802,-2108.6917"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2191.9479,-2640.936C2269.6527,-2624.9628 2309.6526,-2631.0789 2353.4509,-2564.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1651.214,-2602.936C1771.0089,-2590.3 2073.9556,-2665.1907 2191.9479,-2640.936"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.9479,-2068.936C2224.6195,-2045.0882 2271.7544,-2047.8001 2306.6771,-2054.7108"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2306.1233,-2058.1718 2316.6364,-2056.8586 2307.599,-2051.3291 2306.1233,-2058.1718"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-2678.936C1551.6886,-2670.4734 1560.5473,-2610.7879 1651.214,-2602.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M805.2466,-2837.8608C900.5724,-2804.0774 1201.6374,-2703.1662 1461.0769,-2678.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-2602.936C1759.919,-2593.5218 1793.0552,-2614.2297 1895.2266,-2575.936 1913.4671,-2569.0994 1915.2119,-2562.0259 1931.2266,-2550.936 2007.7478,-2497.946 2056.0119,-2511.9543 2103.5566,-2431.936 2180.9511,-2301.6803 2051.0888,-2215.9395 2139.5566,-2092.936 2154.5112,-2072.1435 2171.2607,-2084.036 2191.9479,-2068.936"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1526.572,-4324.9414 1395.5818,-4324.9414 1395.5818,-4302.9305 1526.572,-4302.9305 1526.572,-4324.9414"/>
<text text-anchor="middle" x="1461.0769" y="-4310.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M778.9867,-2860.1202C792.8745,-2895.6018 838.9169,-3008.1725 894.9067,-3090.936 936.292,-3152.1111 973.3401,-3148.4677 1005.5442,-3214.936 1045.8785,-3298.1848 987.2142,-3345.0662 1041.5442,-3419.936 1090.4305,-3487.3041 1132.3126,-3470.9171 1206.8643,-3507.936 1270.4793,-3539.5243 1311.491,-3516.5597 1351.9497,-3574.936 1413.6384,-3663.9444 1368.8114,-3954.3446 1387.9497,-4060.936 1403.7411,-4148.8867 1438.0415,-4250.0033 1453.3867,-4292.9238"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1450.1698,-4294.3206 1456.8568,-4302.5385 1456.754,-4291.9442 1450.1698,-4294.3206"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1106.2042,-2676.936C1307.2745,-2616.703 1362.9696,-2622.2692 1570.2041,-2588.936 1642.1361,-2577.3659 1835.7838,-2588.0624 1895.2266,-2545.936 1924.0928,-2525.4788 1908.3161,-2501.8964 1931.2266,-2474.936 1947.2699,-2456.0566 1970.0569,-2439.7138 1988.1681,-2428.4075"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1990.4113,-2431.1409 1997.1525,-2422.9673 1986.7855,-2425.153 1990.4113,-2431.1409"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785.524,-2837.7986C812.6619,-2810.0168 885.9872,-2735.6663 950.2255,-2676.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-2676.936C970.0051,-2658.8523 988.7044,-2673.7848 1005.5442,-2652.936 1056.8073,-2589.4687 1001.5625,-2544.0519 1041.5442,-2472.936 1079.8216,-2404.8514 1131.1395,-2421.1864 1170.8643,-2353.936 1205.0744,-2296.0213 1161.225,-2256.3476 1206.8643,-2206.936 1252.9484,-2157.0427 1307.2016,-2210.031 1351.9497,-2158.936 1408.5748,-2094.2794 1327.234,-2029.7674 1387.9497,-1968.936 1411.3264,-1945.5147 1438.5365,-1979.1632 1461.0769,-1954.936"/>
</g>
<!-- sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~vectorutilities.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/vectorutilities.f90.html" xlink:title="VectorUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="996.8493,-1090.9414 903.6016,-1090.9414 903.6016,-1068.9305 996.8493,-1068.9305 996.8493,-1090.9414"/>
<text text-anchor="middle" x="950.2255" y="-1076.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VectorUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M778.4983,-2837.7857C792.4125,-2796.4486 840.6374,-2647.7927 858.9067,-2520.936 924.5804,-2064.9184 855.6813,-1943.9855 894.9067,-1484.936 907.5077,-1337.469 936.2925,-1161.4782 946.5285,-1101.3141"/>
<polygon fill="#ff0000" stroke="#ff0000" points="950.0285,-1101.6108 948.2671,-1091.1635 943.129,-1100.429 950.0285,-1101.6108"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1106.2042,-2676.936C1204.315,-2647.5457 1178.7924,-2544.073 1279.407,-2524.936"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M950.2255,-2676.936C1001.5199,-2630.3024 1039.796,-2696.8294 1106.2042,-2676.936"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge377" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1466.9994,-4707.2062C1511.3874,-4791.3468 1794.0353,-5321.3406 1931.2266,-5436.936 1970.0951,-5469.686 2313.9506,-5644.9211 2353.4509,-5612.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2353.4509,-5612.936C2394.03,-5575.7269 2402.6167,-5562.5118 2426.5627,-5512.936 2515.3829,-5329.0502 2356.1798,-5138.5665 2548.515,-5069.936"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1466.1756,-4707.1779C1479.0544,-4734.008 1515.7905,-4801.4441 1570.2041,-4826.936 1701.815,-4888.5935 1780.8582,-4880.6185 1895.2266,-4790.936 1923.6933,-4768.6136 1906.8608,-4744.6745 1931.2266,-4717.936 2004.4221,-4637.6124 2045.7572,-4644.8098 2139.5566,-4589.936 2204.7211,-4551.8139 2282.4546,-4509.2916 2323.9271,-4486.8368"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2325.8034,-4489.8012 2332.9354,-4481.9664 2322.4742,-4483.6436 2325.8034,-4489.8012"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1510.349,-4695.8453C1548.7501,-4695.9846 1603.3986,-4696.6425 1651.214,-4698.936"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1831.7252,-4776.936C1851.2858,-4754.9083 1877.2935,-4781.3078 1895.2266,-4757.936 1937.3827,-4702.9944 1927.5214,-3581.0879 1931.2266,-3511.936 1954.586,-3075.9596 2004.6513,-2544.3616 2015.3524,-2432.9967"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2018.8374,-2433.3202 2016.313,-2423.0305 2011.8697,-2432.6486 2018.8374,-2433.3202"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1486.3204,-4707.0335C1562.1293,-4739.5446 1785.4204,-4829.0811 1831.7252,-4776.936"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.7948,-4684.8282C1499.3516,-4674.1313 1523.3527,-4656.1651 1534.2041,-4632.936 1593.041,-4506.9867 1554.1395,-2269.019 1570.2041,-2130.936 1585.7558,-1997.2614 1628.8317,-1840.7627 1644.9867,-1784.9845"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1648.3981,-1785.7887 1647.8427,-1775.2084 1641.6789,-1783.8257 1648.3981,-1785.7887"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge378" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.9479,-4717.936C2215.2863,-4726.2316 2229.6042,-4717.0267 2244.3391,-4736.936 2290.67,-4799.5365 2223.8727,-5383.299 2280.3391,-5436.936 2521.008,-5665.5457 2397.9,-5123.5561 2548.515,-5069.936"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2055.3682,-4729.6634C2098.9634,-4720.8527 2167.5894,-4709.2778 2191.9479,-4717.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2191.9479,-4717.936C2217.5568,-4727.0386 2311.6668,-4551.3615 2343.1291,-4490.9633"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2346.281,-4492.4882 2347.7786,-4481.9997 2340.0672,-4489.265 2346.281,-4492.4882"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2055.2677,-4742.0587C2079.5406,-4744.7007 2111.4146,-4748.1701 2138.2761,-4751.0939"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2137.9793,-4754.5822 2148.2993,-4752.1849 2138.7368,-4747.6233 2137.9793,-4754.5822"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.9479,-4717.936C2225.7647,-4729.9561 2329.796,-4744.9268 2353.4509,-4717.936"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2244.2306,-4290.9414 2139.6652,-4290.9414 2139.6652,-4268.9305 2244.2306,-4268.9305 2244.2306,-4290.9414"/>
<text text-anchor="middle" x="2191.9479" y="-4276.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M2021.7065,-4726.6146C2044.7687,-4666.1039 2153.5728,-4380.6244 2184.0158,-4300.7481"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2187.3366,-4301.8625 2187.6275,-4291.2716 2180.7956,-4299.3695 2187.3366,-4301.8625"/>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge379" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2354.0204,-4482.3834C2357.8929,-4555.6869 2382.6536,-4958.9496 2462.5627,-5045.936 2489.3948,-5075.1445 2511.15,-5083.2382 2548.515,-5069.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-1585.9414 -.2403,-1585.9414 -.2403,-1563.9305 130.719,-1563.9305 130.719,-1585.9414"/>
<text text-anchor="middle" x="65.2394" y="-1571.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge380" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-14.936C1021.4879,-18.4993 1036.0859,-66.144 1106.2042,-52.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-242.936C722.3483,-109.3477 759.3792,-5.3933 950.2255,-14.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2716.4498,-204.936C2808.3485,-384.9722 2858.8854,-1924.2544 2865.0692,-2123.6778"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2861.5734,-2123.8697 2865.3792,-2133.7573 2868.5701,-2123.6544 2861.5734,-2123.8697"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-548.936C553.6107,-510.232 469.3575,-351.7316 585.7192,-242.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-52.936C1580.7076,36.4449 1709.0997,-14.936 2191.9479,-14.936 2191.9479,-14.936 2191.9479,-14.936 2353.4509,-14.936 2481.0701,-14.936 2529.8116,-.9028 2634.4673,-73.936 2690.7922,-113.2419 2685.2234,-143.7611 2716.4498,-204.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.049,-1563.8721C72.1963,-1481.1943 112.731,-959.032 166.4788,-810.936 209.1928,-693.242 217.2027,-648.2781 317.2024,-572.936 347.4908,-550.116 362.2974,-558.1498 399.0839,-548.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2012.936C505.0077,-2025.6613 784.2145,-2074.7596 858.9067,-2150.936 955.8894,-2249.8457 811.7806,-2444.2686 950.2255,-2448.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-2448.936C1007.1984,-2450.0829 994.2149,-2390.6719 1041.5442,-2358.936 1047.1858,-2355.153 1053.4826,-2351.823 1059.8714,-2348.9301"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1061.3651,-2352.099 1069.2321,-2345.0024 1058.6567,-2345.6442 1061.3651,-2352.099"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M67.2572,-1586.1566C77.0094,-1639.35 120.6657,-1865.7558 166.4788,-1918.936 239.2541,-2003.4141 289.0335,-1994.9988 399.0839,-2012.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M399.0839,-4926.936C433.6281,-4941.1615 445.0346,-4935.706 480.9653,-4945.936 575.5237,-4972.8581 593.4661,-5000.9453 690.4731,-5016.936 759.5566,-5028.3237 952.6118,-5062.7658 1005.5442,-5016.936 1090.0788,-4943.7443 985.4644,-4864.6736 1041.5442,-4767.936 1090.2804,-4683.866 1193.1537,-4624.0223 1246.2091,-4597.4002"/>
<polygon fill="#ff5400" stroke="#ff5400" points="1247.7823,-4600.5268 1255.2043,-4592.9661 1244.6873,-4594.2482 1247.7823,-4600.5268"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M223.8406,-1118.936C278.3147,-1091.9242 271.3768,-1178.9724 317.2024,-1218.936 399.1049,-1290.3615 420.6588,-1309.5904 516.9653,-1359.936 524.2473,-1363.7427 532.2398,-1367.2221 540.1185,-1370.2964"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="539.0244,-1373.6238 549.617,-1373.8402 541.4713,-1367.0654 539.0244,-1373.6238"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-3380.936C601.2949,-3342.8512 633.2247,-3354.1718 654.4731,-3318.936 688.0951,-3263.1814 674.3772,-3240.0227 690.4731,-3176.936 720.1219,-3060.7297 755.9936,-2921.455 769.3454,-2869.6605"/>
<polygon fill="#ffff00" stroke="#ffff00" points="772.7349,-2870.5329 771.8424,-2859.9757 765.9566,-2868.7852 772.7349,-2870.5329"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.8406,-4696.936C324.3895,-4741.6567 275.5862,-3812.8091 317.2024,-3710.936 360.9095,-3603.9445 424.823,-3609.9584 480.9653,-3508.936 504.7257,-3466.1816 482.4236,-3439.5678 516.9653,-3404.936 539.8214,-3382.0203 573.4676,-3410.893 585.7192,-3380.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M399.0839,-5230.936C453.7584,-5272.8124 949.007,-5142.2613 1005.5442,-5102.936 1030.1419,-5085.8266 1024.3163,-5070.4508 1041.5442,-5045.936 1068.4309,-5007.6769 1066.3941,-4987.4677 1106.2042,-4962.936"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M223.8406,-4696.936C347.5332,-4750.9719 275.062,-4857.7021 317.2024,-4985.936 353.0454,-5095.0067 312.1482,-5155.947 399.0839,-5230.936"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1106.2042,-4962.936C1142.2796,-4942.8964 1352.1273,-4741.4244 1387.9497,-4720.936 1394.8285,-4717.0017 1402.4258,-4713.552 1410.0437,-4710.5729"/>
<polygon fill="#aaff00" stroke="#aaff00" points="1411.468,-4713.7786 1419.6517,-4707.0498 1409.058,-4707.2065 1411.468,-4713.7786"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M950.2255,-5686.936C1049.0459,-5649.3161 1077.8734,-5648.2692 1170.8643,-5597.936 1343.4336,-5504.5293 1776.9882,-5249.5395 1895.2266,-5092.936 1896.5631,-5091.1658 1984.0432,-4835.4742 2010.1283,-4759.1838"/>
<polygon fill="#54ff00" stroke="#54ff00" points="2013.5906,-4759.8757 2013.5139,-4749.2811 2006.967,-4757.6111 2013.5906,-4759.8757"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1106.2042,-5876.936C1141.9267,-5877.3467 1703.7369,-5751.4942 1732.2239,-5729.936 1758.557,-5710.0078 1745.9629,-5689.3289 1768.2239,-5664.936 1889.7106,-5531.8143 1966.9302,-5554.4673 2103.5566,-5436.936 2173.3622,-5376.8865 2208.4684,-5369.7419 2244.3391,-5284.936 2302.9426,-5146.3851 2240.1841,-4753.9128 2280.3391,-4608.936 2292.908,-4563.5568 2322.0719,-4516.2363 2339.5298,-4490.4935"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2342.5734,-4492.2456 2345.3796,-4482.0292 2336.8148,-4488.2658 2342.5734,-4492.2456"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M774.6899,-5762.936C930.3896,-5768.7407 950.7841,-5865.9505 1106.2042,-5876.936"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-2080.9414 180.0456,-2080.9414 180.0456,-2058.9305 267.6355,-2058.9305 267.6355,-2080.9414"/>
<text text-anchor="middle" x="223.8406" y="-2066.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M66.6587,-1585.9723C74.7416,-1647.6274 116.377,-1949.4438 166.4788,-2026.936 173.2732,-2037.445 183.5792,-2046.3322 193.5902,-2053.2504"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="191.9155,-2056.335 202.2161,-2058.8144 195.7099,-2050.4526 191.9155,-2056.335"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-4976.9414 344.7839,-4976.9414 344.7839,-4954.9305 453.3838,-4954.9305 453.3838,-4976.9414"/>
<text text-anchor="middle" x="399.0839" y="-4962.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4696.936C329.458,-4745.1742 232.3113,-4861.7182 317.2024,-4940.936 322.5068,-4945.8859 328.7652,-4949.857 335.4211,-4953.0427"/>
<polygon fill="#00ffff" stroke="#00ffff" points="334.1152,-4956.2903 344.6914,-4956.9182 336.8152,-4949.8319 334.1152,-4956.2903"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1831.7252,-5764.936C1947.4668,-5722.5398 1990.6739,-5759.4439 2103.5566,-5709.936 2189.6252,-5672.1882 2385.2032,-5521.3284 2426.5627,-5436.936 2463.9886,-5360.5701 2408.0133,-5121.1802 2462.5627,-5055.936 2488.0032,-5025.5077 2511.7217,-5046.7463 2548.515,-5031.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge335" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M774.6899,-4926.936C877.4969,-4932.3385 931.5567,-5017.5202 1005.5442,-4945.936 1092.6321,-4861.6769 981.1109,-3960.9679 1041.5442,-3855.936 1075.3669,-3797.1528 1130.3789,-3829.3453 1170.8643,-3774.936 1206.9091,-3726.4943 1163.0917,-3685.5268 1206.8643,-3643.936 1212.0153,-3639.0417 1218.309,-3635.513 1225.0151,-3632.9887"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1226.484,-3636.2017 1235.0502,-3629.9671 1224.4657,-3629.499 1226.484,-3636.2017"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-3888.9414 350.2841,-3888.9414 350.2841,-3866.9305 447.8836,-3866.9305 447.8836,-3888.9414"/>
<text text-anchor="middle" x="399.0839" y="-3874.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge342" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#5400ff" stroke-dasharray="5,2" d="M223.8406,-4696.936C300.5498,-4731.9711 382.1416,-4030.939 396.7725,-3899.1244"/>
<polygon fill="#5400ff" stroke="#5400ff" points="400.2627,-3899.4051 397.8794,-3889.0818 393.3048,-3898.6382 400.2627,-3899.4051"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1351.2445,-4476.9414 1207.5694,-4476.9414 1207.5694,-4454.9305 1351.2445,-4454.9305 1351.2445,-4476.9414"/>
<text text-anchor="middle" x="1279.407" y="-4462.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge344" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M585.7192,-4696.936C644.5926,-4669.5141 1041.3285,-4433.964 1106.2042,-4430.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge352" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-548.936C418.9246,-544.1546 764.747,-611.4629 858.9067,-686.936 884.3717,-707.3473 870.672,-729.0782 894.9067,-750.936 914.8082,-768.8855 931.8671,-755.411 950.2255,-774.936"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M950.2255,-774.936C977.9475,-802.8001 989.3739,-808.1108 1005.5442,-843.936 1043.9612,-929.0485 983.2845,-977.9578 1041.5442,-1050.936 1045.007,-1055.2736 1049.2893,-1058.9227 1053.989,-1061.9909"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1052.3738,-1065.0976 1062.8125,-1066.9097 1055.7822,-1058.9834 1052.3738,-1065.0976"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-3087.9414 536.1602,-3087.9414 536.1602,-3065.9305 635.2783,-3065.9305 635.2783,-3087.9414"/>
<text text-anchor="middle" x="585.7192" y="-3073.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge362" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M65.2485,-1585.9826C65.4781,-1785.6982 71.4227,-4627.3227 223.8406,-4696.936"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M223.8406,-4696.936C347.1017,-4753.2326 260.2551,-3603.8979 317.2024,-3480.936 360.2269,-3388.0364 423.1864,-3403.4524 480.9653,-3318.936 531.8183,-3244.5506 566.3966,-3141.4987 579.6661,-3097.8287"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="583.0757,-3098.6423 582.5775,-3088.0591 576.3672,-3096.643 583.0757,-3098.6423"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge372" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M399.0839,-2012.936C434.6248,-2022.9319 447.8652,-2010.5819 480.9653,-2026.936 583.7271,-2077.7083 793.1053,-2284.0851 858.9067,-2377.936 882.4592,-2411.5283 866.2444,-2433.5824 894.9067,-2462.936 898.273,-2466.3834 902.2012,-2469.3969 906.3834,-2472.0214"/>
<polygon fill="#ff0055" stroke="#ff0055" points="904.7755,-2475.1314 915.2256,-2476.8767 908.1448,-2468.9956 904.7755,-2475.1314"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-1698.9414 334.3841,-1698.9414 334.3841,-1676.9305 463.7837,-1676.9305 463.7837,-1698.9414"/>
<text text-anchor="middle" x="399.0839" y="-1684.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1118.936C356.1881,-1053.3095 273.4596,-1296.8358 317.2024,-1437.936 343.6329,-1523.1922 377.4301,-1623.98 391.9419,-1666.8957"/>
<polygon fill="#00ffff" stroke="#00ffff" points="388.6768,-1668.166 395.1996,-1676.5149 395.3069,-1665.9206 388.6768,-1668.166"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-938.9414 539.0902,-938.9414 539.0902,-916.9305 632.3482,-916.9305 632.3482,-938.9414"/>
<text text-anchor="middle" x="585.7192" y="-924.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-966.936C401.5755,-964.7114 475.1573,-949.7808 529.1695,-939.0556"/>
<polygon fill="#ff0000" stroke="#ff0000" points="529.8769,-942.4835 539.0054,-937.1059 528.5157,-935.6171 529.8769,-942.4835"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-1870.9414 517.2105,-1870.9414 517.2105,-1848.9305 654.2279,-1848.9305 654.2279,-1870.9414"/>
<text text-anchor="middle" x="585.7192" y="-1856.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1118.936C315.7562,-1073.4656 231.263,-963.8864 317.2024,-907.936 378.1981,-868.225 428.3191,-857.6785 480.9653,-907.936 543.3189,-967.4604 499.1251,-1598.5983 516.9653,-1682.936 529.4624,-1742.0145 559.2763,-1807.1692 575.2273,-1839.4574"/>
<polygon fill="#00ffff" stroke="#00ffff" points="572.2687,-1841.3658 579.8795,-1848.7364 578.5263,-1838.2283 572.2687,-1841.3658"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-841.9414 168.8556,-841.9414 168.8556,-819.9305 278.8255,-819.9305 278.8255,-841.9414"/>
<text text-anchor="middle" x="223.8406" y="-827.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M67.6045,-1563.8413C85.1887,-1481.3536 195.5354,-963.7159 219.3244,-852.1214"/>
<polygon fill="#ff0000" stroke="#ff0000" points="222.8,-852.6046 221.4618,-842.0947 215.9538,-851.1452 222.8,-852.6046"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-860.9414 340.6161,-860.9414 340.6161,-838.9305 457.5516,-838.9305 457.5516,-860.9414"/>
<text text-anchor="middle" x="399.0839" y="-846.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1118.936C327.8657,-1067.3536 232.3113,-954.1538 317.2024,-874.936 321.3454,-871.0699 326.0704,-867.8008 331.1122,-865.0367"/>
<polygon fill="#00ffff" stroke="#00ffff" points="332.9438,-868.0415 340.4723,-860.5869 329.9382,-861.7195 332.9438,-868.0415"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M67.0707,-1563.5414C78.0207,-1497.1661 137.2955,-1161.8506 223.8406,-1118.936"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1351.9925,-5012.9414 1206.8215,-5012.9414 1206.8215,-4990.9305 1351.9925,-4990.9305 1351.9925,-5012.9414"/>
<text text-anchor="middle" x="1279.407" y="-4998.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-5230.936C534.2819,-5328.86 607.7539,-5230.936 774.6899,-5230.936 774.6899,-5230.936 774.6899,-5230.936 950.2255,-5230.936 1031.8797,-5230.936 1037.5134,-5126.3234 1206.8643,-5026.936 1213.6498,-5022.9537 1221.1657,-5019.4783 1228.7137,-5016.4877"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1230.0787,-5019.7145 1238.2391,-5012.9574 1227.646,-5013.1508 1230.0787,-5019.7145"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-5686.936C974.5749,-5675.7395 983.9251,-5678.7748 1005.5442,-5662.936 1402.6729,-5371.9873 1448.5988,-5229.3278 1732.2239,-4826.936 1751.0259,-4800.2607 1743.618,-4784.3751 1768.2239,-4762.936 1772.4112,-4759.2875 1777.1942,-4756.137 1782.2142,-4753.4244"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1783.928,-4756.4841 1791.4289,-4749.0016 1780.899,-4750.1734 1783.928,-4756.4841"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-5667.936C526.3727,-5783.9011 604.3411,-5737.8037 774.6899,-5762.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-5762.936C859.6185,-5766.7484 870.7738,-5717.1823 950.2255,-5686.936"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-5337.9414 358.7923,-5337.9414 358.7923,-5315.9305 439.3754,-5315.9305 439.3754,-5337.9414"/>
<text text-anchor="middle" x="399.0839" y="-5323.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4696.936C336.2079,-4748.2571 260.5183,-5135.1763 317.2024,-5244.936 330.8917,-5271.4431 356.196,-5294.7554 375.0659,-5309.6801"/>
<polygon fill="#00ffff" stroke="#00ffff" points="373.1522,-5312.6231 383.2183,-5315.9284 377.4105,-5307.0672 373.1522,-5312.6231"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1518.48,-4898.9414 1403.6738,-4898.9414 1403.6738,-4876.9305 1518.48,-4876.9305 1518.48,-4898.9414"/>
<text text-anchor="middle" x="1461.0769" y="-4884.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-5230.936C501.1606,-5318.9854 877.9524,-5288.4411 1005.5442,-5244.936 1092.1962,-5215.3901 1295.0542,-5093.6606 1351.9497,-5021.936 1381.5657,-4984.6009 1355.6534,-4955.9782 1387.9497,-4920.936 1394.7461,-4913.5617 1403.5041,-4907.7251 1412.5825,-4903.1445"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1414.0682,-4906.3138 1421.707,-4898.9722 1411.1572,-4899.9478 1414.0682,-4906.3138"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1106.2042,-4962.936C1208.992,-4892.1034 1266.9638,-4918.3689 1351.9497,-4826.936 1377.9437,-4798.9701 1358.265,-4772.9484 1387.9497,-4748.936 1439.7577,-4707.0277 1491.5946,-4767.1688 1534.2041,-4715.936 1567.3018,-4676.1399 1563.7006,-3836.2867 1570.2041,-3784.936 1587.4598,-3648.6881 1629.6701,-3488.6131 1645.282,-3432.0318"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1648.7274,-3432.7053 1648.0344,-3422.1332 1641.9833,-3430.83 1648.7274,-3432.7053"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-548.936C598.5399,-496.5722 693.486,-487.8074 858.9067,-610.936 885.0863,-630.4223 873.6036,-650.2122 894.9067,-674.936 935.5606,-722.1176 964.9958,-713.6636 1005.5442,-760.936 1057.6804,-821.7177 1329.0256,-1316.2086 1351.9497,-1392.936 1405.8363,-1573.2948 1322.3638,-1638.4946 1387.9497,-1814.936 1399.9615,-1847.2506 1425.3271,-1878.4454 1442.7842,-1897.4087"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1440.3097,-1899.8861 1449.7197,-1904.7547 1445.3996,-1895.0806 1440.3097,-1899.8861"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-4696.936C724.2845,-4639.3198 904.3476,-4157.6075 942.8009,-4050.8387"/>
<polygon fill="#7fff00" stroke="#7fff00" points="946.1772,-4051.7919 946.2543,-4041.1973 939.5871,-4049.4314 946.1772,-4051.7919"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-4696.936C371.6291,-4760.3901 433.8497,-4749.8844 585.7192,-4696.936"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="849.3617,-3544.9414 700.0182,-3544.9414 700.0182,-3522.9305 849.3617,-3522.9305 849.3617,-3544.9414"/>
<text text-anchor="middle" x="774.6899" y="-3530.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-3762.936C425.6922,-3735.915 445.3285,-3751.9034 480.9653,-3738.936 560.0784,-3710.1485 592.4252,-3719.8363 654.4731,-3662.936 679.0993,-3640.3529 668.5936,-3622.1893 690.4731,-3596.936 706.5602,-3578.3683 729.0004,-3561.9156 746.672,-3550.4837"/>
<polygon fill="#00ffff" stroke="#00ffff" points="748.8203,-3553.2672 755.4195,-3544.9786 745.0918,-3547.3428 748.8203,-3553.2672"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4696.936C402.9174,-4773.824 221.2682,-3994.5735 317.2024,-3824.936 339.6727,-3785.2024 366.7214,-3795.1282 399.0839,-3762.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.0839,-3762.936C419.6468,-3742.4812 626.757,-3717.4828 654.4731,-3708.936 748.3418,-3679.9898 775.8921,-3677.4505 858.9067,-3624.936 956.8606,-3562.971 1052.4678,-3460.7747 1089.7896,-3418.8127"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1092.4681,-3421.0671 1096.4603,-3411.2532 1087.2194,-3416.4355 1092.4681,-3421.0671"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-1118.936C461.4891,-1001.5795 145.5341,-1505.997 317.2024,-1707.936 413.152,-1820.8046 822.9697,-1841.0965 950.2255,-1916.936"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="820.6499,-1434.9414 728.73,-1434.9414 728.73,-1412.9305 820.6499,-1412.9305 820.6499,-1434.9414"/>
<text text-anchor="middle" x="774.6899" y="-1420.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1118.936C434.2721,-1131.4841 455.8189,-1110.3077 480.9653,-1137.936 561.5638,-1226.4891 429.7766,-1322.8634 516.9653,-1404.936 571.8217,-1456.5734 665.5986,-1448.6444 723.6362,-1437.0751"/>
<polygon fill="#ff0000" stroke="#ff0000" points="724.6205,-1440.4448 733.6875,-1434.9639 723.1815,-1433.5943 724.6205,-1440.4448"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-5724.936C1358.0073,-5664.8253 1959.8021,-5338.2328 2103.5566,-5122.936 2142.4973,-5064.6157 2178.2532,-4846.9652 2188.8098,-4778.022"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2192.2993,-4778.3546 2190.3348,-4767.9435 2185.378,-4777.3073 2192.2993,-4778.3546"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-5762.936C922.8452,-5769.5866 961.2707,-5756.3763 1106.2042,-5724.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-4696.936C357.5641,-4755.3539 288.7539,-5203.809 317.2024,-5346.936 345.9059,-5491.346 286.1052,-5573.5222 399.0839,-5667.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-5667.936C479.9074,-5735.4784 765.8865,-5602.3492 858.9067,-5552.936 1116.9802,-5415.845 1213.0205,-5375.0245 1351.9497,-5117.936 1405.3187,-5019.1765 1319.44,-4956.8635 1387.9497,-4867.936 1431.0372,-4812.0072 1472.0002,-4839.3311 1534.2041,-4805.936 1627.1771,-4756.022 1679.132,-4766.1315 1732.2239,-4674.936 1791.3942,-4573.2995 1755.1027,-4263.8075 1768.2239,-4146.936 1784.7846,-3999.4283 1816.5081,-3823.4631 1827.6973,-3763.3099"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1831.1972,-3763.6342 1829.5952,-3753.1612 1824.3165,-3762.3473 1831.1972,-3763.6342"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1893.87,-5546.9414 1769.5804,-5546.9414 1769.5804,-5524.9305 1893.87,-5524.9305 1893.87,-5546.9414"/>
<text text-anchor="middle" x="1831.7252" y="-5532.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1106.2042,-5724.936C1241.8356,-5693.5404 1613.4184,-5773.5089 1732.2239,-5700.936 1760.0745,-5683.9233 1751.5335,-5664.9809 1768.2239,-5636.936 1785.2326,-5608.3562 1805.887,-5575.8936 1818.9223,-5555.6627"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1822.0096,-5557.3337 1824.4974,-5547.0351 1816.1303,-5553.5345 1822.0096,-5557.3337"/>
</g>
<!-- sourcefile~datagenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~datagenerators.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/datagenerators.f90.html" xlink:title="DataGenerators.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1002.4442,-4936.9414 898.0067,-4936.9414 898.0067,-4914.9305 1002.4442,-4914.9305 1002.4442,-4936.9414"/>
<text text-anchor="middle" x="950.2255" y="-4922.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGenerators.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7192,-4926.936C669.2931,-4935.2556 690.8187,-4922.5285 774.6899,-4926.936"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M774.6899,-4926.936C812.1991,-4928.9071 854.2784,-4928.7485 887.833,-4928.0539"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="888.0408,-4931.5502 897.9583,-4927.8229 887.881,-4924.552 888.0408,-4931.5502"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.0839,-4926.936C475.7839,-4958.5216 503.1782,-4918.7192 585.7192,-4926.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-5876.936C1382.7984,-5910.4506 1471.6495,-5942.5694 1732.2239,-5843.936 1785.0335,-5823.9463 1779.2577,-5785.8073 1831.7252,-5764.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1831.7252,-5764.936C2025.2411,-5692.0516 2101.2654,-5699.2358 2244.3391,-5549.936 2267.188,-5526.0928 2259.4044,-5510.4762 2280.3391,-5484.936 2307.3476,-5451.9857 2336.2058,-5461.8947 2353.4509,-5422.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1279.407,-90.936C1483.9501,-73.6097 1561.5047,-67.9488 1732.2239,-181.936 1843.2514,-256.0677 1817.2644,-337.3999 1931.2266,-406.936 2125.1395,-525.2555 2280.2202,-359.1959 2426.5627,-532.936 2530.093,-655.8486 2546.4919,-1888.5718 2548.319,-2065.7655"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2544.8203,-2065.9226 2548.419,-2075.8875 2551.82,-2065.8534 2544.8203,-2065.9226"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M950.2255,-14.936C996.8206,-18.1367 997.0527,-52.7283 1041.5442,-66.936 1142.7622,-99.2584 1173.3731,-84.1064 1279.407,-90.936"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1894.4593,-442.9414 1768.9911,-442.9414 1768.9911,-420.9305 1894.4593,-420.9305 1894.4593,-442.9414"/>
<text text-anchor="middle" x="1831.7252" y="-428.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1279.407,-90.936C1332.7643,-82.7618 1696.3921,-226.564 1732.2239,-266.936 1774.8707,-314.9865 1725.6816,-358.7928 1768.2239,-406.936 1771.2628,-410.375 1774.8359,-413.3456 1778.7119,-415.9109"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1777.1593,-419.0533 1787.5913,-420.9038 1780.5902,-412.9517 1777.1593,-419.0533"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~dataphotovoltaics.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/dataphotovoltaics.f90.html" xlink:title="DataPhotovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2074.536,-556.9414 1960.2472,-556.9414 1960.2472,-534.9305 2074.536,-534.9305 2074.536,-556.9414"/>
<text text-anchor="middle" x="2017.3916" y="-542.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPhotovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M950.2255,-242.936C990.993,-238.0416 1000.6026,-232.0561 1041.5442,-228.936 1098.8536,-224.5685 1113.6768,-223.1879 1170.8643,-228.936 1424.1737,-254.397 1547.9419,-167.2826 1732.2239,-342.936 1779.3521,-387.8575 1721.9975,-439.087 1768.2239,-484.936 1793.6237,-510.1285 1885.2738,-527.7251 1950.0188,-537.338"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1949.7653,-540.8378 1960.1647,-538.8122 1950.7719,-533.9105 1949.7653,-540.8378"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7192,-242.936C704.8638,-133.1659 788.2694,-246.8274 950.2255,-242.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-242.936C1357.8141,-266.5379 1398.2313,-488.3352 1768.2239,-660.936 1979.983,-759.7212 2118.1866,-687.2484 2244.3391,-883.936 2309.6445,-985.7553 2346.8336,-1893.6976 2352.646,-2046.2333"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2349.162,-2046.7281 2353.0363,-2056.5892 2356.1571,-2046.4644 2349.162,-2046.7281"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M585.7192,-4926.936C679.1348,-4936.2353 935.6459,-5036.6031 1005.5442,-4973.936 1060.3056,-4924.8399 999.8221,-4705.5042 1041.5442,-4644.936 1129.4748,-4517.2865 1256.6568,-4608.1875 1351.9497,-4485.936 1393.7295,-4432.3366 1342.3852,-4384.4546 1388.3917,-4331.4436"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1391.1871,-4333.5834 1395.5494,-4323.9283 1386.1182,-4328.7557 1391.1871,-4333.5834"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-4696.936C341.6065,-4748.3828 279.4177,-4880.0786 399.0839,-4926.936"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M399.0839,-4926.936C450.0983,-4946.9115 809.4209,-4772.4444 858.9067,-4748.936 943.2801,-4708.8542 959.1901,-4689.0179 1041.5442,-4644.936 1114.0292,-4606.1367 1130.603,-4592.6552 1206.8643,-4561.936 1449.1497,-4464.3397 1516.9328,-4459.2106 1768.2239,-4387.936 1898.846,-4350.8872 2053.7696,-4312.8917 2135.2835,-4293.3555"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2136.4207,-4296.6823 2145.332,-4290.9517 2134.792,-4289.8744 2136.4207,-4296.6823"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1695.0981,-824.9414 1607.3299,-824.9414 1607.3299,-802.9305 1695.0981,-802.9305 1695.0981,-824.9414"/>
<text text-anchor="middle" x="1651.214" y="-810.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-966.936C426.9518,-942.0553 452.6594,-972.3172 480.9653,-947.936 513.9201,-919.5504 484.3067,-885.6617 516.9653,-856.936 683.1318,-710.7799 784.3471,-754.2475 1005.5442,-760.936 1240.8267,-768.0503 1300.4793,-764.9862 1534.2041,-792.936 1554.8834,-795.4089 1577.4407,-799.1952 1597.1824,-802.8752"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1596.7471,-806.355 1607.2245,-804.7825 1598.0532,-799.478 1596.7471,-806.355"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-1118.936C286.4436,-1086.703 259.6038,-1031.4392 317.2024,-990.936 348.2233,-969.1222 367.6736,-988.1853 399.0839,-966.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M774.6899,-396.936C877.3121,-406.4985 906.6555,-389.8881 1005.5442,-418.936 1179.8964,-470.1507 1634.3475,-640.8286 1732.2239,-793.936 1782.1222,-871.9916 1711.3044,-1553.8422 1768.2239,-1626.936 1804.4233,-1673.4219 1856.3287,-1620.6832 1895.2266,-1664.936 1993.9963,-1777.303 2013.7114,-2280.7175 2016.8638,-2390.6762"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2013.3694,-2390.9357 2017.139,-2400.8373 2020.3668,-2390.7461 2013.3694,-2390.9357"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-548.936C572.54,-500.5173 595.759,-376.5619 774.6899,-396.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-396.936C1028.703,-422.715 1055.728,-585.0526 1170.8643,-812.936 1212.3824,-895.1107 1153.9018,-941.6271 1206.8643,-1016.936 1249.5991,-1077.702 1302.0063,-1044.9412 1351.9497,-1099.936 1400.3852,-1153.2703 1599.773,-1637.9207 1642.9452,-1743.6342"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1639.7089,-1744.9673 1646.727,-1752.9044 1646.1903,-1742.3231 1639.7089,-1744.9673"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.3078,-938.9414 341.8599,-938.9414 341.8599,-916.9305 456.3078,-916.9305 456.3078,-938.9414"/>
<text text-anchor="middle" x="399.0839" y="-924.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1118.936C299.6752,-1081.3323 251.2458,-1005.9893 317.2024,-952.936 322.0667,-949.0233 327.5388,-945.7216 333.2885,-942.9356"/>
<polygon fill="#00ffff" stroke="#00ffff" points="334.7031,-946.1372 342.5045,-938.9686 331.9355,-939.7076 334.7031,-946.1372"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1118.936C557.0338,-1175.5461 609.0989,-1053.8716 774.6899,-1080.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1118.936C293.6755,-1084.4498 325.5755,-1093.1922 399.0839,-1118.936"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1118.936C266.0681,-1097.1939 271.3044,-1079.1531 317.2024,-1066.936 612.8534,-988.2394 724.4949,-939.0477 1005.5442,-1059.936 1026.9155,-1069.1285 1024.7494,-1081.8372 1041.5442,-1097.936 1266.3855,-1313.4588 1307.9387,-1389.9462 1570.2041,-1557.936 1636.7109,-1600.5358 1687.5879,-1565.7782 1732.2239,-1630.936 1774.2943,-1692.3487 1756.0821,-2226.492 1768.2239,-2299.936 1781.0112,-2377.2848 1810.436,-2465.9974 1824.2748,-2505.3223"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1821.0137,-2506.5982 1827.6633,-2514.8465 1827.6088,-2504.2518 1821.0137,-2506.5982"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node58"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-1168.9414 323.0941,-1168.9414 323.0941,-1146.9305 475.0737,-1146.9305 475.0737,-1168.9414"/>
<text text-anchor="middle" x="399.0839" y="-1154.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge346" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1118.936C235.2461,-1113.2804 303.4698,-1130.7282 351.3437,-1144.0938"/>
<polygon fill="#ff0000" stroke="#ff0000" points="350.6486,-1147.5341 361.2228,-1146.8741 352.545,-1140.7958 350.6486,-1147.5341"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node59"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-1209.9414 317.3208,-1209.9414 317.3208,-1187.9305 480.847,-1187.9305 480.847,-1209.9414"/>
<text text-anchor="middle" x="399.0839" y="-1195.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge348" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1118.936C267.8163,-1097.13 272.1329,-1158.4909 317.2024,-1177.936 323.2682,-1180.5531 329.7326,-1182.8991 336.2678,-1184.9885"/>
<polygon fill="#00ffff" stroke="#00ffff" points="335.271,-1188.3435 345.8552,-1187.8677 337.2845,-1181.6393 335.271,-1188.3435"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge381" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.6573,-2058.5787C241.938,-2033.9331 270.2777,-1973.376 281.2024,-1918.936 305.0224,-1800.2363 274.0557,-943.0526 317.2024,-829.936 363.3237,-709.0208 597.8361,-473.3021 690.4731,-382.936 859.3396,-218.2091 871.4401,-76.1017 1106.2042,-52.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2088.936C640.11,-2101.9639 661.1989,-2239.4624 858.9067,-2377.936 901.0156,-2407.4288 899.0011,-2444.5716 950.2255,-2448.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff5400" stroke-dasharray="5,2" d="M585.7192,-4544.936C819.6461,-4530.4465 1098.1653,-4559.2776 1218.7695,-4574.0078"/>
<polygon fill="#ff5400" stroke="#ff5400" points="1218.554,-4577.5077 1228.9073,-4575.2584 1219.4111,-4570.5603 1218.554,-4577.5077"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M399.0839,-1423.936C431.2339,-1395.6153 478.5837,-1385.9628 517.5446,-1383.341"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="517.9713,-1386.8234 527.7717,-1382.7982 517.6002,-1379.8332 517.9713,-1386.8234"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M399.0839,-3304.936C474.1056,-3340.3237 510.6485,-3340.2195 585.7192,-3304.936"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-3304.936C671.3493,-3264.6895 749.8566,-2954.5896 769.8163,-2870.1225"/>
<polygon fill="#ffff00" stroke="#ffff00" points="773.2308,-2870.8917 772.0991,-2860.3575 766.4145,-2869.2981 773.2308,-2870.8917"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M774.6899,-4734.936C854.4662,-4737.6655 870.4869,-4769.2664 950.2255,-4772.936"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M950.2255,-4772.936C976.9974,-4774.168 985.7602,-4767.0149 1005.5442,-4748.936 1030.2099,-4726.3961 1016.2797,-4704.8026 1041.5442,-4682.936 1064.722,-4662.8754 1075.6673,-4656.2644 1106.2042,-4658.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M399.0839,-4544.936C424.0498,-4572.1348 454.0471,-4533.6678 480.9653,-4558.936 531.5827,-4606.4506 469.1041,-4660.6462 516.9653,-4710.936 530.4406,-4725.095 1816.2048,-5087.1793 1831.7252,-5078.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-4544.936C441.9661,-4587.9064 460.8336,-4499.0568 516.9653,-4475.936 739.5642,-4384.247 806.0368,-4390.8699 1041.5442,-4340.936 1178.3826,-4311.9226 1215.339,-4319.0036 1351.9497,-4288.936 1539.2888,-4247.7032 1581.9973,-4220.9334 1768.2239,-4174.936 1796.2813,-4168.0059 1804.0022,-4169.1017 1831.7252,-4160.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.2345,-2081.0491C230.4927,-2256.2958 310.4192,-4446.7091 399.0839,-4544.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.019,-2080.9594C227.1305,-2271.8938 270.4686,-4879.9035 317.2024,-4940.936 322.0312,-4947.2422 328.4118,-4952.0049 335.486,-4955.5939"/>
<polygon fill="#00ffff" stroke="#00ffff" points="334.1812,-4958.8423 344.753,-4959.5399 336.9237,-4952.4019 334.1812,-4958.8423"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1171.0247,-3886.9414 1041.3838,-3886.9414 1041.3838,-3864.9305 1171.0247,-3864.9305 1171.0247,-3886.9414"/>
<text text-anchor="middle" x="1106.2042" y="-3872.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M223.8817,-2081.031C224.4686,-2219.8608 232.4706,-3617.5714 317.2024,-3776.936 338.6317,-3817.2405 368.8881,-3804.7031 399.0839,-3838.936"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M399.0839,-3838.936C409.4416,-3850.6786 851.4295,-3867.1732 1031.2683,-3873.4124"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1031.3253,-3876.9164 1041.4403,-3873.764 1031.5672,-3869.9205 1031.3253,-3876.9164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M2191.9479,-432.936C2353.1297,-416.3391 2418.5192,-412.2089 2548.515,-508.936"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M229.6188,-2058.5709C241.8248,-2033.9102 270.0279,-1973.3252 281.2024,-1918.936 300.2712,-1826.1235 266.4927,-1146.9754 317.2024,-1066.936 361.1999,-997.491 430.8009,-1046.0659 480.9653,-980.936 524.649,-924.2202 490.4596,-890.437 516.9653,-823.936 573.1416,-682.9939 583.8432,-637.8734 690.4731,-529.936 754.6036,-465.0191 958.1024,-353.8734 1041.5442,-316.936 1111.6202,-285.9152 1131.0232,-278.9389 1206.8643,-267.936 1567.581,-215.6039 1684.8228,-243.7608 2017.3916,-392.936"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M2017.3916,-392.936C2036.8374,-397.1534 2172.1611,-435.0353 2191.9479,-432.936"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M2548.515,-508.936C2684.7349,-610.4689 2712.8227,-1937.4238 2716.0967,-2123.3537"/>
<polygon fill="#0054ff" stroke="#0054ff" points="2712.5999,-2123.5713 2716.2705,-2133.5099 2719.5988,-2123.4515 2712.5999,-2123.5713"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge337" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1106.2042,-3760.936C1146.5304,-3705.4448 1147.9829,-3679.1277 1206.8643,-3643.936 1212.4583,-3640.5926 1218.6703,-3637.9457 1225.0384,-3635.8506"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1226.4437,-3639.09 1235.1075,-3632.9918 1224.5318,-3632.3562 1226.4437,-3639.09"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-3648.936C599.6564,-3643.9895 1097.5102,-3772.8994 1106.2042,-3760.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge343" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1106.2042,-4430.936C1151.4282,-4430.0409 1202.0141,-4441.7874 1236.7834,-4451.9103"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="1236.0135,-4455.3332 1246.5972,-4454.8469 1238.0203,-4448.627 1236.0135,-4455.3332"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M585.7192,-4544.936C819.9936,-4510.3725 869.4403,-4435.6219 1106.2042,-4430.936"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M399.0839,-4544.936C427.6554,-4574.9993 544.324,-4547.5 585.7192,-4544.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge353" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M774.6899,-1270.936C876.3228,-1239.9971 917.2079,-1267.9542 1005.5442,-1208.936 1048.4246,-1180.2872 1080.7258,-1127.2601 1096.1559,-1098.2309"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1099.4219,-1099.5343 1100.8998,-1089.043 1093.202,-1096.3228 1099.4219,-1099.5343"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge363" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M224.3424,-2081.2082C229.8404,-2201.7295 280.955,-3249.2146 399.0839,-3304.936"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M399.0839,-3304.936C497.7065,-3351.4563 561.4925,-3162.4149 580.0762,-3097.8546"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="583.518,-3098.5429 582.8456,-3087.9694 576.7775,-3096.6545 583.518,-3098.5429"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge370" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M230.5149,-2081.1171C244.2811,-2103.3953 277.8554,-2153.8469 317.2024,-2184.936 419.7198,-2265.9377 794.7631,-2423.8831 913.7472,-2472.9964"/>
<polygon fill="#ff0055" stroke="#ff0055" points="912.5838,-2476.3025 923.1631,-2476.8763 915.2508,-2469.8304 912.5838,-2476.3025"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1080.936C420.4602,-1040.6033 445.5193,-1047.6979 480.9653,-1018.936 511.1868,-994.4135 544.9829,-964.6009 565.8062,-945.9413"/>
<polygon fill="#ff0000" stroke="#ff0000" points="568.2769,-948.4266 573.3741,-939.1385 563.5973,-943.2206 568.2769,-948.4266"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M230.6503,-2058.7333C244.4111,-2036.9673 277.6143,-1988.6725 317.2024,-1960.936 381.1761,-1916.1143 467.5441,-1888.3039 524.8571,-1873.4839"/>
<polygon fill="#00ffff" stroke="#00ffff" points="526.0193,-1876.8002 534.8552,-1870.9541 524.3022,-1870.0141 526.0193,-1876.8002"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M229.6466,-2058.5765C241.9066,-2033.9268 270.2084,-1973.362 281.2024,-1918.936 303.4585,-1808.7568 263.8024,-1006.8461 317.2024,-907.936 327.1879,-889.4404 345.9496,-875.4953 362.9968,-865.9199"/>
<polygon fill="#00ffff" stroke="#00ffff" points="365.0149,-868.8123 372.2244,-861.0486 361.747,-862.6219 365.0149,-868.8123"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8515,-2081.1506C224.0696,-2251.5024 228.5371,-4308.9292 317.2024,-4558.936 401.0016,-4795.2218 524.2937,-4876.4852 774.6899,-4888.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-4888.936C876.5077,-4903.68 919.9155,-4848.91 1005.5442,-4905.936 1034.9917,-4925.5471 1012.4063,-4956.8677 1041.5442,-4976.936 1086.2408,-5007.72 1147.3007,-5013.5867 1196.364,-5011.9551"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1196.8062,-5015.439 1206.6413,-5011.4994 1196.496,-5008.4459 1196.8062,-5015.439"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4544.936C443.6575,-4593.4961 458.9289,-4603.6842 516.9653,-4634.936 573.9586,-4665.626 597.6182,-4651.9906 654.4731,-4682.936 672.2766,-4692.6262 672.3951,-4701.7682 690.4731,-4710.936 725.1847,-4728.5391 735.7928,-4733.6051 774.6899,-4734.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-4734.936C852.6897,-4737.6048 823.2792,-4637.929 894.9067,-4606.936 940.0354,-4587.4089 956.5154,-4603.1833 1005.5442,-4606.936 1095.8103,-4613.845 1116.9186,-4627.6655 1206.8643,-4637.936 1319.4313,-4650.7895 1348.3339,-4645.7299 1461.0769,-4656.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.0537,-2081.1427C227.92,-2283.7573 283.5001,-5166.7607 317.2024,-5244.936 328.9275,-5272.1334 354.2449,-5295.1674 373.6445,-5309.8323"/>
<polygon fill="#00ffff" stroke="#00ffff" points="371.6618,-5312.7183 381.8049,-5315.7794 375.7846,-5307.0611 371.6618,-5312.7183"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-3418.936C711.381,-3384.4017 1040.6132,-3375.6768 1170.8643,-3379.936 1300.0547,-3384.1605 1332.1744,-3389.3351 1461.0769,-3398.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-3304.936C656.1178,-3271.8484 1172.8628,-3315.8954 1377.7388,-3334.938"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1377.5627,-3338.4366 1387.8446,-3335.8805 1378.2129,-3331.4669 1377.5627,-3338.4366"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2088.936C452.6407,-2088.7803 464.4304,-2074.3493 516.9653,-2063.936 748.7859,-2017.9852 807.8634,-2012.2281 1041.5442,-1976.936 1167.4709,-1957.9177 1314.8327,-1936.7406 1397.123,-1925.0116"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1397.6675,-1928.4694 1407.0739,-1923.5941 1396.6802,-1921.5394 1397.6675,-1928.4694"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6809,-2075.7541C303.0735,-2080.1938 354.1924,-2086.0268 399.0839,-2088.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-3838.936C424.0821,-3866.6985 448.0452,-3840.2743 480.9653,-3857.936 500.3585,-3868.3404 498.0057,-3880.761 516.9653,-3891.936 639.1333,-3963.9428 803.1838,-4002.8445 890.1832,-4019.6456"/>
<polygon fill="#7fff00" stroke="#7fff00" points="889.67,-4023.1106 900.1474,-4021.538 890.9761,-4016.2335 889.67,-4023.1106"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.1061,-2081.1417C226.9681,-2199.0791 253.2637,-3214.1159 317.2024,-3508.936 338.9621,-3609.2698 316.2613,-3664.2666 399.0839,-3724.936"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-3724.936C429.6768,-3747.346 447.2077,-3718.2148 480.9653,-3700.936 499.0089,-3691.7004 499.1618,-3682.6262 516.9653,-3672.936 545.3928,-3657.4633 555.2178,-3659.7613 585.7192,-3648.936"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-3648.936C651.5029,-3625.5886 719.1327,-3577.424 752.8265,-3551.4513"/>
<polygon fill="#00ffff" stroke="#00ffff" points="755.2925,-3553.9664 761.0207,-3545.0536 750.9846,-3548.4489 755.2925,-3553.9664"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.0839,-3494.936C509.0423,-3574.0665 873.0303,-3461.0885 1005.5442,-3432.936 1026.74,-3428.4329 1049.7479,-3421.0845 1068.41,-3414.4638"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1069.8045,-3417.6813 1078.0152,-3410.9854 1067.4209,-3411.0996 1069.8045,-3417.6813"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-2442.9414 334.8633,-2442.9414 334.8633,-2420.9305 463.3044,-2420.9305 463.3044,-2442.9414"/>
<text text-anchor="middle" x="399.0839" y="-2428.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.4664,-2081.0589C233.3797,-2133.7705 269.4351,-2357.9068 317.2024,-2406.936 320.6511,-2410.4758 324.5853,-2413.5178 328.8206,-2416.1317"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.4014,-2419.3403 337.8781,-2420.9179 330.6718,-2413.1512 327.4014,-2419.3403"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-2175.9414 354.6193,-2175.9414 354.6193,-2153.9305 443.5485,-2153.9305 443.5485,-2175.9414"/>
<text text-anchor="middle" x="399.0839" y="-2161.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M244.2862,-2081.0196C275.2837,-2097.8235 334.3129,-2129.8234 369.8431,-2149.0845"/>
<polygon fill="#00ff00" stroke="#00ff00" points="368.3091,-2152.2341 378.7685,-2153.9229 371.6452,-2146.0801 368.3091,-2152.2341"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-2088.936C645.381,-2090.8315 703.9787,-2036.2672 950.2255,-2030.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1423.936C462.6717,-1367.9219 501.0912,-1458.5665 585.7192,-1462.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1462.936C611.9777,-1464.2918 677.09,-1449.3198 723.5313,-1437.5349"/>
<polygon fill="#ff0000" stroke="#ff0000" points="724.6109,-1440.8715 733.43,-1435 722.8743,-1434.0903 724.6109,-1440.8715"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="859.1241,-3372.9414 690.2558,-3372.9414 690.2558,-3350.9305 859.1241,-3350.9305 859.1241,-3372.9414"/>
<text text-anchor="middle" x="774.6899" y="-3358.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3494.936C429.8648,-3517.0872 448.6109,-3490.7179 480.9653,-3470.936 500.8138,-3458.8004 496.6235,-3444.225 516.9653,-3432.936 544.2322,-3417.8038 555.6497,-3427.1997 585.7192,-3418.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3418.936C635.4634,-3405.2653 692.053,-3387.961 730.2337,-3376.0245"/>
<polygon fill="#ff0000" stroke="#ff0000" points="731.5153,-3379.2908 740.0103,-3372.9595 729.4212,-3372.6113 731.5153,-3379.2908"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1177,-2081.0039C226.9177,-2189.6203 251.3751,-3066.4415 317.2024,-3318.936 338.967,-3402.4188 329.0582,-3444.5427 399.0839,-3494.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1831.7252,-5116.936C1926.2394,-5096.9704 1931.0195,-5047.1958 2017.3916,-5003.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-4772.936C1138.5243,-4781.6016 1188.9831,-4814.2078 1351.9497,-4908.936 1370.4574,-4919.694 1369.7382,-4929.6838 1387.9497,-4940.936 1542.7903,-5036.6061 1598.582,-5026.9812 1768.2239,-5092.936 1796.3446,-5103.869 1802.2054,-5123.1719 1831.7252,-5116.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-3724.936C468.4076,-3775.7171 1084.9983,-3778.3332 1170.8643,-3774.936 1300.1509,-3769.8209 1336.0846,-3718.4974 1461.0769,-3751.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M774.6899,-4888.936C819.422,-4891.1602 869.2887,-4902.5609 904.4063,-4912.1266"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="903.7834,-4915.5862 914.3557,-4914.8952 905.66,-4908.8424 903.7834,-4915.5862"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-1268.936C1293.8597,-1221.3346 1350.8155,-1249.9771 1534.2041,-1187.936 1688.9214,-1135.5944 2052.7884,-774.4274 2191.9479,-859.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-1080.936C420.4602,-1040.6033 454.5109,-1056.1359 480.9653,-1018.936 511.0221,-976.6705 484.4047,-948.304 516.9653,-907.936 561.3553,-852.9022 597.9296,-870.3862 654.4731,-827.936 772.4885,-739.3356 766.8405,-672.2618 894.9067,-598.936 953.7386,-565.2511 974.4098,-566.3608 1041.5442,-556.936 1195.2796,-535.3534 2326.3394,-622.3793 2426.5627,-740.936 2515.9676,-846.6952 2544.1889,-1902.1086 2548.0389,-2065.6844"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2544.5447,-2065.9787 2548.2745,-2075.8953 2551.5428,-2065.8172 2544.5447,-2065.9787"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M229.6106,-2058.5692C241.8005,-2033.9052 269.9743,-1973.3142 281.2024,-1918.936 299.5095,-1830.2734 261.3428,-1176.1813 317.2024,-1104.936 340.6011,-1075.0924 381.3938,-1114.48 399.0839,-1080.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M774.6899,-1118.936C875.5497,-1098.3021 930.5659,-1170.4818 1005.5442,-1099.936 1087.3019,-1023.0116 973.8095,-939.4552 1041.5442,-849.936 1143.2071,-715.5769 1228.3445,-749.9163 1387.9497,-695.936 1588.0343,-628.2651 1833.7478,-579.0832 1950.1357,-557.7348"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1950.7689,-561.1771 1959.9785,-555.9393 1949.5127,-554.2908 1950.7689,-561.1771"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1345.936C702.3158,-1310.5561 738.4194,-1341.0829 858.9067,-1322.936 970.1519,-1306.181 1008.7376,-1325.1184 1106.2042,-1268.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-1268.936C1282.0582,-1187.9679 1352.3633,-1121.4949 1534.2041,-1187.936 1802.8352,-1286.0885 1756.8366,-1495.0051 2017.3916,-1612.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2017.3916,-1612.936C2095.5768,-1626.7581 2127.7577,-1604.207 2191.9479,-1650.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-4544.936C422.1535,-4569.2101 657.7153,-4474.8905 690.4731,-4467.936 780.5022,-4448.8229 803.7858,-4447.8783 894.9067,-4434.936 959.9156,-4425.7025 976.3523,-4424.7742 1041.5442,-4416.936 1147.2298,-4404.2291 1174.1967,-4405.1134 1279.407,-4388.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M227.0578,-2058.5744C236.3737,-2027.3597 266.0148,-1938.9617 317.2024,-1883.936 436.0554,-1756.1711 508.6515,-1778.7792 654.4731,-1682.936 670.9662,-1672.0957 671.694,-1663.0083 690.4731,-1656.936 761.7013,-1633.904 784.4944,-1648.7676 858.9067,-1656.936 875.1992,-1658.7244 878.7164,-1662.3835 894.9067,-1664.936 1264.1398,-1723.1481 1417.9817,-1541.5169 1732.2239,-1743.936 1749.6647,-1755.1705 2097.9556,-2371.9604 2103.5566,-2391.936 2144.4883,-2537.9144 2130.0087,-3604.6286 2139.5566,-3755.936 2151.9103,-3951.7058 2180.3575,-4187.3939 2189.2444,-4258.5749"/>
<polygon fill="#00ff66" stroke="#00ff66" points="2185.822,-4259.4121 2190.5406,-4268.8981 2192.7674,-4258.54 2185.822,-4259.4121"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M774.6899,-1270.936C802.7647,-1260.6957 987.8651,-1157.0297 1005.5442,-1132.936 1046.359,-1077.3118 1005.9302,-1041.0253 1041.5442,-981.936 1091.9945,-898.231 1116.3171,-873.7186 1206.8643,-836.936 1338.7346,-783.3667 1510.9741,-794.9966 1597.1532,-805.7217"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1596.8622,-809.213 1607.2278,-807.0207 1597.7575,-802.2705 1596.8622,-809.213"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M585.7192,-1345.936C635.2701,-1330.9004 642.1089,-1313.4363 690.4731,-1294.936 726.8243,-1281.0309 738.5622,-1285.4115 774.6899,-1270.936"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M229.03,-2058.8479C240.3264,-2034.2412 267.2473,-1972.9687 281.2024,-1918.936 337.7554,-1699.9687 229.3834,-1573.4239 399.0839,-1423.936"/>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M399.0839,-1423.936C466.5444,-1364.5105 499.6908,-1372.0403 585.7192,-1345.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M950.2255,-1650.936C1045.4032,-1668.5643 1012.1611,-1521.8587 1106.2042,-1498.936"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M585.7192,-1462.936C713.2469,-1469.5205 751.4214,-1482.9899 858.9067,-1551.936 909.2921,-1584.2555 891.3664,-1640.0344 950.2255,-1650.936"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1106.2042,-1498.936C1260.2255,-1461.3938 1302.908,-1524.2319 1461.0769,-1534.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-1650.936C1018.39,-1663.5611 1041.4946,-1626.0669 1106.2042,-1650.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M229.6397,-2058.5751C241.8861,-2033.9227 270.1633,-1973.3529 281.2024,-1918.936 302.5564,-1813.6723 251.7008,-1038.0594 317.2024,-952.936 321.4045,-947.475 326.77,-943.1721 332.7395,-939.7869"/>
<polygon fill="#00ffff" stroke="#00ffff" points="334.3233,-942.9094 341.8528,-935.4557 331.3186,-936.5871 334.3233,-942.9094"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-1118.936C814.1619,-1108.7181 859.0478,-1098.775 893.5493,-1091.4858"/>
<polygon fill="#ff0000" stroke="#ff0000" points="894.3806,-1094.8877 903.4477,-1089.4071 892.9419,-1088.0371 894.3806,-1094.8877"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.3199,-2058.9172C241.1945,-2034.4489 269.1969,-1973.4351 281.2024,-1918.936 305.5968,-1808.1974 261.8221,-1508.8862 317.2024,-1409.936 434.8924,-1199.6543 541.4038,-1179.3254 774.6899,-1118.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1106.2042,-1498.936C1136.1891,-1493.3446 1143.9894,-1507.5105 1170.8643,-1521.936 1188.4861,-1531.3948 1188.7808,-1540.3926 1206.8643,-1548.936 1312.015,-1598.6138 1351.4506,-1572.1206 1461.0769,-1610.936"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge345" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.5921,-2058.5653C241.7462,-2033.8939 269.8544,-1973.2893 281.2024,-1918.936 298.0265,-1838.3541 265.1737,-1242.7287 317.2024,-1178.936 318.2169,-1177.6921 319.2942,-1176.5161 320.427,-1175.4046"/>
<polygon fill="#ff0000" stroke="#ff0000" points="322.9263,-1177.8925 328.6337,-1168.9664 318.6056,-1172.3851 322.9263,-1177.8925"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge347" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M229.579,-2058.5626C241.7075,-2033.8858 269.769,-1973.2714 281.2024,-1918.936 297.1248,-1843.2673 269.603,-1284.875 317.2024,-1223.936 319.7042,-1220.7331 322.6057,-1217.9291 325.793,-1215.4755"/>
<polygon fill="#00ffff" stroke="#00ffff" points="327.7031,-1218.4085 334.2396,-1210.0703 323.93,-1212.5124 327.7031,-1218.4085"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge382" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.9546,-4977.4073C414.9041,-5012.9023 452.1431,-5124.1355 480.9653,-5216.936 497.7336,-5270.9256 487.5636,-5290.6495 516.9653,-5338.936 637.9323,-5537.6002 691.7644,-5587.6501 894.9067,-5700.936 970.4956,-5743.0894 1192.8588,-5762.936 1279.407,-5762.936 1279.407,-5762.936 1279.407,-5762.936 1461.0769,-5762.936 1786.0425,-5762.936 1889.4559,-5902.6846 2191.9479,-5783.936"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.3462,-4958.9997C463.8923,-4955.2299 473.8616,-4949.5269 480.9653,-4940.936 576.1087,-4825.873 424.1139,-4723.8563 516.9653,-4606.936 557.2212,-4556.2451 606.4527,-4602.3426 654.4731,-4558.936 813.8416,-4414.8796 809.2585,-4329.947 858.9067,-4120.936 889.9917,-3990.0733 834.0046,-3030.8619 894.9067,-2910.936 923.1067,-2855.4058 975.3591,-2879.4126 1005.5442,-2824.936 1081.7629,-2687.3803 999.8007,-2624.5551 1041.5442,-2472.936 1053.8225,-2428.339 1079.2311,-2380.2306 1094.2828,-2353.9331"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1097.4911,-2355.3786 1099.4954,-2344.9751 1091.4408,-2351.858 1097.4911,-2355.3786"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M453.4476,-4959.5651C464.1224,-4955.7756 474.12,-4949.9217 480.9653,-4940.936 524.9501,-4883.1982 494.6424,-3704.0011 516.9653,-3634.936 550.3668,-3531.5949 615.3323,-3534.2426 654.4731,-3432.936 695.8817,-3325.7599 668.1514,-3289.6441 690.4731,-3176.936 713.7191,-3059.5612 753.2323,-2921.5043 768.4548,-2869.8367"/>
<polygon fill="#ffff00" stroke="#ffff00" points="771.8365,-2870.7434 771.3199,-2860.1611 765.1246,-2868.7558 771.8365,-2870.7434"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M416.521,-4977.0588C468.4443,-5009.2466 627.5869,-5101.1958 774.6899,-5116.936"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M774.6899,-5116.936C877.5437,-5143.5358 928.0206,-5127.5758 1005.5442,-5054.936 1041.8506,-5020.9168 1014.1623,-4990.4774 1041.5442,-4948.936 1119.8061,-4830.2042 1137.9965,-4749.9437 1279.407,-4734.936"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M950.2255,-5192.936C1154.3795,-5222.1454 1184.6599,-5312.2183 1387.9497,-5346.936 1452.024,-5357.8785 1469.2024,-5347.1001 1534.2041,-5346.936 1622.2137,-5346.7138 1644.9694,-5357.4423 1732.2239,-5345.936 1862.1503,-5328.8024 1886.5681,-5278.6597 2017.3916,-5270.936"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M402.2897,-4977.0866C416.5521,-5026.1241 475.3646,-5222.2813 516.9653,-5269.936 650.6781,-5423.1074 1034.0383,-5610.936 1279.407,-5610.936 1279.407,-5610.936 1279.407,-5610.936 1461.0769,-5610.936 1751.0837,-5610.936 1827.8102,-5586.757 2103.5566,-5496.936 2166.9785,-5476.2771 2188.1688,-5480.9085 2244.3391,-5444.936 2263.3939,-5432.7329 2261.064,-5420.7879 2280.3391,-5408.936 2309.4725,-5391.0224 2327.5942,-5407.3207 2353.4509,-5384.936"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge364" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M453.4859,-4959.5942C464.1587,-4955.8032 474.1458,-4949.9414 480.9653,-4940.936 536.3181,-4867.8412 501.7842,-3381.3589 516.9653,-3290.936 529.2497,-3217.7672 561.2099,-3135.2444 576.8447,-3097.6191"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="580.1378,-3098.8171 580.7917,-3088.2425 573.6861,-3096.1013 580.1378,-3098.8171"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M434.9193,-4977.0224C520.0942,-5000.938 736.6517,-5047.0669 858.9067,-4940.936 921.1734,-4886.8816 858.1605,-4832.7515 894.9067,-4758.936 927.8217,-4692.8168 975.0788,-4702.2189 1005.5442,-4634.936 1059.8443,-4515.014 987.9299,-4461.1661 1041.5442,-4340.936 1127.0388,-4149.2139 1276.5584,-4180.8513 1351.9497,-3984.936 1392.7386,-3878.9401 1321.0849,-2032.7399 1387.9497,-1940.936 1390.8576,-1936.9435 1394.4413,-1933.5823 1398.4463,-1930.7534"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1400.3016,-1933.7232 1407.1774,-1925.6626 1396.7757,-1927.6761 1400.3016,-1933.7232"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.1663,-4976.9724C412.7928,-5013.4339 450.9218,-5131.9698 516.9653,-5206.936 577.9597,-5276.1708 604.6556,-5287.0373 690.4731,-5320.936 1125.6549,-5492.8367 1267.3858,-5526.4018 1732.2239,-5472.936 1850.0318,-5459.3857 2166.2003,-5412.136 2244.3391,-5322.936 2424.3762,-5117.4133 2194.456,-4940.1376 2353.4509,-4717.936"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M408.383,-4976.9468C426.9864,-4998.357 470.9638,-5045.9478 516.9653,-5073.936 795.972,-5243.6885 892.4461,-5238.6077 1206.8643,-5326.936 1285.8636,-5349.129 1306.287,-5354.8973 1387.9497,-5362.936 1452.639,-5369.3038 1469.2024,-5363.1001 1534.2041,-5362.936 1622.2137,-5362.7138 1644.4757,-5368.7187 1732.2239,-5361.936 1789.594,-5357.5014 2205.4667,-5327.3616 2244.3391,-5284.936 2288.0337,-5237.2474 2255.2668,-4763.5581 2280.3391,-4703.936 2299.1382,-4659.2318 2340.5776,-4669.6922 2353.4509,-4622.936"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M950.2255,-5192.936C1064.2829,-5196.258 1835.1639,-4887.9546 1895.2266,-4790.936 1932.6434,-4730.497 1927.4498,-3582.9193 1931.2266,-3511.936 1954.4236,-3075.9509 2004.6157,-2544.3597 2015.3466,-2432.9963"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2018.8314,-2433.3208 2016.3099,-2423.0304 2011.8639,-2432.6472 2018.8314,-2433.3208"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M774.6899,-5116.936C857.7573,-5135.0252 866.0684,-5180.8951 950.2255,-5192.936"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge383" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-3894.936C1760.4968,-3867.8796 1812.6139,-3903.4209 1895.2266,-3826.936 1929.5821,-3795.1287 1893.6567,-3755.8735 1931.2266,-3727.936 2006.6403,-3671.8571 2297.6944,-3628.2836 2353.4509,-3703.936"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1279.407,-3970.936C1364.1906,-3992.6608 1373.6729,-4051.4941 1461.0769,-4046.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1831.7252,-4160.936C1859.6947,-4149.6217 1871.0975,-4155.0494 1895.2266,-4136.936 1983.0257,-4071.0263 2139.5184,-3645.4791 2191.9479,-3741.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1461.0769,-4046.936C1581.8936,-4040.6353 1621.3564,-4022.5131 1732.2239,-4070.936 1786.8685,-4094.8028 1774.3577,-4177.2033 1831.7252,-4160.936"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1651.214,-3894.936C1773.2857,-3876.1206 1809.4485,-3850.8048 1895.2266,-3761.936 1920.0732,-3736.1941 1900.7928,-3708.7451 1931.2266,-3689.936 2118.4968,-3574.1966 2264.0021,-3541.4779 2426.5627,-3689.936 2647.6806,-3891.8712 2279.0135,-5162.4727 2548.515,-5031.936"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1120.4196,-3887.0475C1148.7211,-3908.3799 1214.9549,-3954.4209 1279.407,-3970.936"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1279.407,-3970.936C1407.4193,-4003.7377 1440.449,-3933.9705 1570.2041,-3908.936 1606.0806,-3902.0141 1614.9035,-3899.0078 1651.214,-3894.936"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M2548.515,-5031.936C2661.7659,-4978.2067 2662.5456,-2904.0353 2670.4673,-2778.936 2685.6897,-2538.5427 2708.3808,-2247.1964 2714.7394,-2166.5305"/>
<polygon fill="#0054ff" stroke="#0054ff" points="2718.2579,-2166.4334 2715.5562,-2156.1889 2711.2796,-2165.8822 2718.2579,-2166.4334"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge338" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1152.4786,-3864.8601C1159.4607,-3861.4032 1165.9561,-3856.8725 1170.8643,-3850.936 1227.857,-3782.0025 1148.6041,-3720.8017 1206.8643,-3652.936 1211.9891,-3646.9662 1218.6105,-3642.4203 1225.7652,-3638.9591"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1227.1331,-3642.1809 1235.0405,-3635.1294 1224.4616,-3635.7108 1227.1331,-3642.1809"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1150.9618,-3864.8749C1158.3681,-3861.4057 1165.4008,-3856.8669 1170.8643,-3850.936 1209.1675,-3809.3558 1171.5686,-3773.0978 1206.8643,-3728.936 1252.9717,-3671.2464 1313.8949,-3711.2275 1351.9497,-3647.936 1400.8274,-3566.6443 1331.9721,-2017.5119 1387.9497,-1940.936 1390.8645,-1936.9486 1394.4532,-1933.591 1398.4616,-1930.7646"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1400.3174,-1933.7341 1407.1976,-1925.6772 1396.7947,-1927.6851 1400.3174,-1933.7341"/>
</g>
<!-- sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge384" class="edge">
<title>sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2762.4522,-2144.936C2770.7297,-2144.936 2779.561,-2144.936 2788.4423,-2144.936"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2788.4639,-2148.4361 2798.4638,-2144.936 2788.4638,-2141.4361 2788.4639,-2148.4361"/>
</g>
<!-- sourcefile~windturbine.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge385" class="edge">
<title>sourcefile~windturbine.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2353.4509,-3703.936C2531.1016,-3986.2835 2400.2379,-4118.3899 2426.5627,-4450.936 2431.7894,-4516.9614 2420.9439,-4994.4137 2462.5627,-5045.936 2487.4857,-5076.7895 2511.1597,-5083.2654 2548.515,-5069.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2548.515,-5069.936C2585.8704,-5056.6066 2609.9173,-5077.0871 2634.4673,-5045.936 2789.5204,-4849.1918 2659.4411,-3036.8617 2716.4498,-2792.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1321.6376,-3616.909C1468.412,-3579.3712 1955.4608,-3461.6124 2103.5566,-3511.936 2236.1703,-3556.9987 2278.8619,-3585.3885 2353.4509,-3703.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge386" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.9479,-5783.936C2247.0632,-5763.6444 2338.5063,-5628.9541 2353.4509,-5612.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.3209,-3889.1029C410.7006,-3982.4039 483.7187,-4630.8394 516.9653,-4710.936 566.0545,-4829.1997 595.8577,-4854.6576 690.4731,-4940.936 898.5922,-5130.7164 1523.7742,-5468.0271 1768.2239,-5607.936 1856.7156,-5658.5835 2096.266,-5819.1628 2191.9479,-5783.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-3610.936C795.9263,-3571.0389 836.9181,-3593.4234 858.9067,-3553.936 907.1103,-3467.3715 838.8865,-2744.6595 894.9067,-2662.936 910.0596,-2640.8307 940.2667,-2663.8172 950.2255,-2638.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M446.6904,-3866.8446C458.266,-3863.225 470.3582,-3858.6311 480.9653,-3852.936 629.989,-3772.9237 695.215,-3760.2469 774.6899,-3610.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M448.0001,-3872.9359C460.531,-3869.2676 472.7681,-3863.1284 480.9653,-3852.936 543.559,-3775.1071 455.9215,-3483.9864 516.9653,-3404.936 536.7469,-3379.3193 573.4676,-3410.893 585.7192,-3380.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M399.9895,-3889.1231C405.9917,-3960.7739 442.1203,-4355.1625 516.9653,-4444.936 583.5115,-4524.7553 859.768,-4569.7797 950.2255,-4620.936"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1106.2042,-4658.936C1189.9481,-4666.2623 1196.6418,-4749.6543 1279.407,-4734.936"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M950.2255,-4620.936C1016.0425,-4648.4887 1035.1242,-4652.7175 1106.2042,-4658.936"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1279.407,-4734.936C1321.5017,-4727.4502 1368.7047,-4717.2619 1404.4432,-4709.1759"/>
<polygon fill="#aaff00" stroke="#aaff00" points="1405.2311,-4712.5862 1414.2056,-4706.955 1403.6783,-4705.7606 1405.2311,-4712.5862"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M1831.7252,-5078.936C1958.4707,-5013.2415 2002.5769,-4822.8639 2014.0318,-4759.0604"/>
<polygon fill="#54ff00" stroke="#54ff00" points="2017.5179,-4759.4378 2015.7528,-4748.9911 2010.618,-4758.2585 2017.5179,-4759.4378"/>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M950.2255,-4620.936C993.3077,-4638.9713 999.9943,-4651.6062 1041.5442,-4672.936 1113.4862,-4709.8676 1131.6222,-4719.301 1206.8643,-4748.936 1270.059,-4773.826 1304.0647,-4748.7684 1351.9497,-4796.936 1388.5144,-4833.7164 1347.9742,-4874.8946 1387.9497,-4907.936 1506.8052,-5006.1749 1598.1877,-4874.7007 1732.2239,-4950.936 1794.8573,-4986.5598 1767.7523,-5112.0943 1831.7252,-5078.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2191.9479,-5270.936C2299.8396,-5169.02 2235.0679,-4750.2796 2280.3391,-4608.936 2294.7022,-4564.0924 2323.2258,-4516.5807 2340.0865,-4490.6597"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2343.1289,-4492.404 2345.7227,-4482.1316 2337.2891,-4488.5444 2343.1289,-4492.404"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-4620.936C608.6872,-4655.0759 628.9804,-4650.6377 654.4731,-4682.936 675.1745,-4709.1638 665.7179,-4726.4945 690.4731,-4748.936 816.0549,-4862.78 884.6735,-4833.7267 1041.5442,-4897.936 1098.7234,-4921.3402 1125.412,-4907.0873 1170.8643,-4948.936 1197.4772,-4973.4389 1185.8895,-4992.4623 1206.8643,-5021.936 1260.0885,-5096.7264 1298.3108,-5094.4424 1351.9497,-5168.936 1372.6234,-5197.6475 1358.0235,-5221.0634 1387.9497,-5239.936 1421.5867,-5261.1487 2063.9519,-5253.3453 2103.5566,-5256.936 2143.1689,-5260.5274 2163.0336,-5298.2488 2191.9479,-5270.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1279.407,-4274.936C1477.4235,-4234.8381 1549.7294,-4228.2516 1732.2239,-4314.936 1936.0316,-4411.7441 1943.5883,-4506.1064 2139.5566,-4617.936 2183.4256,-4642.9699 2207.2677,-4627.6301 2244.3391,-4661.936 2270.016,-4685.6973 2260.5212,-4703.1063 2280.3391,-4731.936 2381.6486,-4879.3139 2386.9367,-5108.593 2548.515,-5031.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge339" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-3877.936C748.3907,-3870.6337 791.6516,-3951.9446 950.2255,-3914.936"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M950.2255,-3914.936C1006.6466,-3903.2833 1000.4559,-3863.3202 1041.5442,-3822.936 1069.9393,-3795.0274 1082.7984,-3793.1437 1106.2042,-3760.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge356" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M447.9261,-3873.3364C460.6134,-3869.6892 472.9517,-3863.4608 480.9653,-3852.936 525.7432,-3794.1269 488.5704,-2591.1804 516.9653,-2522.936 599.7774,-2323.9052 747.8176,-2363.6799 858.9067,-2178.936 981.3265,-1975.3489 962.3733,-1898.5394 1005.5442,-1664.936 1038.7863,-1485.0585 1001.8187,-1433.4936 1041.5442,-1254.936 1054.5585,-1196.4395 1082.0534,-1131.0339 1096.6432,-1098.5558"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1099.9359,-1099.7701 1100.892,-1089.2185 1093.5645,-1096.8709 1099.9359,-1099.7701"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge368" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M448.1072,-3873.0213C460.6398,-3869.3544 472.851,-3863.1945 480.9653,-3852.936 519.7836,-3803.86 505.3068,-3352.4127 516.9653,-3290.936 530.789,-3218.0424 562.0021,-3135.386 577.1505,-3097.6737"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="580.4479,-3098.8562 580.9693,-3088.2742 573.9626,-3096.2214 580.4479,-3098.8562"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge371" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#ff0055" stroke-dasharray="5,2" d="M448.2321,-3873.1191C460.7667,-3869.4538 472.9477,-3863.2702 480.9653,-3852.936 535.2357,-3782.985 501.8278,-3144.1671 516.9653,-3056.936 561.8061,-2798.5376 481.0268,-2650.7734 690.4731,-2492.936 752.699,-2446.043 849.2237,-2460.1597 905.4231,-2474.3006"/>
<polygon fill="#ff0055" stroke="#ff0055" points="904.8692,-2477.7737 915.4302,-2476.9266 906.646,-2471.003 904.8692,-2477.7737"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M447.9748,-3873.3734C460.6632,-3869.7269 472.9898,-3863.4897 480.9653,-3852.936 541.8042,-3772.4301 497.3966,-2135.9291 516.9653,-2036.936 528.6756,-1977.6965 558.8287,-1912.6112 575.0363,-1880.3754"/>
<polygon fill="#00ffff" stroke="#00ffff" points="578.3357,-1881.6103 579.7674,-1871.1126 572.1017,-1878.4262 578.3357,-1881.6103"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-4656.936C1547.159,-4665.851 1564.7782,-4694.6401 1651.214,-4698.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M403.5856,-3889.1731C417.0545,-3921.8336 459.6801,-4018.5039 516.9653,-4082.936 757.5608,-4353.5479 891.7227,-4338.2912 1170.8643,-4568.936 1187.5966,-4582.7613 1187.587,-4591.961 1206.8643,-4601.936 1309.5313,-4655.0609 1346.0944,-4645.0278 1461.0769,-4656.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-4698.936C1698.3393,-4701.2781 1750.9362,-4713.8155 1787.1406,-4724.0525"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1786.3208,-4727.4587 1796.8992,-4726.8685 1788.2616,-4720.7331 1786.3208,-4727.4587"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1106.2042,-4084.936C1135.6909,-4076.5588 1149.4305,-4082.8502 1170.8643,-4060.936 1205.0656,-4025.968 1174.038,-3993.1979 1206.8643,-3956.936 1254.5308,-3904.2805 1306.9933,-3944.9234 1351.9497,-3889.936 1395.8924,-3836.1885 1368.6066,-3804.6113 1387.9497,-3737.936 1415.7199,-3642.2127 1386.297,-3591.8306 1461.0769,-3525.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1461.0769,-3525.936C1486.8358,-3503.4289 1504.0074,-3518.0061 1534.2041,-3501.936 1572.2421,-3481.6928 1610.5775,-3449.0014 1632.5491,-3428.8051"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1634.9461,-3431.3556 1639.8727,-3421.9759 1630.1721,-3426.2361 1634.9461,-3431.3556"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M774.6899,-4106.936C921.6413,-4121.4238 964.4565,-4126.3143 1106.2042,-4084.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-4068.936C601.8452,-4075.6999 877.6765,-4012.9215 894.9067,-4009.936 1017.2122,-3988.7441 1078.4881,-4049.8478 1170.8643,-3966.936 1216.7572,-3925.745 1163.1217,-3876.4038 1206.8643,-3832.936 1254.1464,-3785.9507 1308.9513,-3845.8708 1351.9497,-3794.936 1410.9484,-3725.0476 1338.7082,-3462.0107 1387.9497,-3384.936 1395.2359,-3373.5313 1406.7947,-3364.8867 1418.5906,-3358.4959"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1420.1817,-3361.6137 1427.5903,-3354.0397 1417.0756,-3355.3405 1420.1817,-3361.6137"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-3914.936C1046.6158,-3895.0285 1095.0975,-3958.7595 1170.8643,-3895.936 1216.6856,-3857.9423 1167.8955,-3811.931 1206.8643,-3766.936 1253.0039,-3713.6612 1312.8624,-3761.5811 1351.9497,-3702.936 1406.2509,-3621.4644 1330.1953,-2019.9971 1387.9497,-1940.936 1390.8632,-1936.9476 1394.4509,-1933.5894 1398.4587,-1930.7625"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1400.3144,-1933.7321 1407.1938,-1925.6744 1396.7911,-1927.6834 1400.3144,-1933.7321"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M774.6899,-4106.936C834.6273,-4112.8452 897.5507,-4071.914 929.2809,-4047.4185"/>
<polygon fill="#7fff00" stroke="#7fff00" points="931.7156,-4049.9547 937.3749,-4040.9979 927.3653,-4044.4706 931.7156,-4049.9547"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-4068.936C664.7195,-4102.0721 689.435,-4098.5307 774.6899,-4106.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M448.2033,-3878.0069C485.8403,-3878.044 539.0606,-3878.0594 585.7192,-3877.936"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M585.7192,-3877.936C860.6577,-3877.2085 1053.09,-3511.462 1096.7797,-3420.3199"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1099.9524,-3421.7978 1101.0626,-3411.2612 1093.6241,-3418.8057 1099.9524,-3421.7978"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M774.6899,-3610.936C796.2456,-3571.2105 836.7414,-3593.3245 858.9067,-3553.936 938.4511,-3412.5829 836.2891,-2976.1708 894.9067,-2824.936 922.8181,-2752.924 975.9891,-2762.2891 1005.5442,-2690.936 1069.956,-2535.4304 966.6588,-2464.6776 1041.5442,-2313.936 1076.2943,-2243.9852 1132.5133,-2262.9792 1170.8643,-2194.936 1210.4948,-2124.6225 1153.6897,-2077.657 1206.8643,-2016.936 1209.8577,-2013.5177 1213.3413,-2010.5665 1217.1313,-2008.0185"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1218.8855,-2011.0474 1225.8464,-2003.0602 1215.4239,-2004.9632 1218.8855,-2011.0474"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4620.936C602.5408,-4647.1943 624.4203,-4626.612 654.4731,-4634.936 813.9474,-4679.1066 855.6053,-4688.9258 1005.5442,-4758.936 1137.6418,-4820.6156 1431.4918,-5048.069 1570.2041,-5092.936 1681.2592,-5128.8572 1718.5629,-5145.5343 1831.7252,-5116.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.0433,-3889.4363C406.8173,-3968.8274 449.1437,-4436.0204 516.9653,-4558.936 536.8438,-4594.9624 562.7513,-4586.7961 585.7192,-4620.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1106.2042,-4084.936C1135.4062,-4075.6149 1142.3565,-4072.2031 1170.8643,-4060.936 1252.0375,-4028.8538 1274.3986,-4024.9882 1351.9497,-3984.936 1491.0914,-3913.0745 1500.0936,-3840.0101 1651.214,-3798.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-4354.936C1152.3207,-4373.0978 1159.3649,-4388.7799 1206.8643,-4402.936 1432.6656,-4470.2307 1498.8239,-4441.6982 1732.2239,-4473.936 1804.6991,-4483.9464 1822.7955,-4486.6108 1895.2266,-4496.936 1987.8366,-4510.1377 2018.5195,-4487.9541 2103.5566,-4526.936 2150.9181,-4548.6469 2144.9422,-4581.4652 2191.9479,-4603.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.9479,-4603.936C2215.4564,-4614.1006 2222.6343,-4614.3392 2244.3391,-4627.936 2297.6118,-4661.3081 2316.8703,-4769.0588 2353.4509,-4717.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-4068.936C755.4953,-4147.2436 769.0831,-4232.6385 950.2255,-4278.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1279.407,-4274.936C1341.8576,-4269.7269 1332.0358,-4213.2352 1387.9497,-4184.936 1458.3078,-4149.3263 1668.3233,-4145.1422 1732.2239,-4098.936 1842.1346,-4019.4599 1837.9526,-3963.8852 1895.2266,-3840.936 1917.4839,-3793.1565 1912.7708,-3777.3086 1931.2266,-3727.936 2125.9403,-3207.0399 2248.9951,-3105.9236 2426.5627,-2578.936 2486.5861,-2400.7979 2531.3491,-2177.3911 2544.5281,-2108.287"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2548.0136,-2108.6911 2546.4326,-2098.2149 2541.1355,-2107.3905 2548.0136,-2108.6911"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M950.2255,-4278.936C990.0734,-4288.8398 1000.6026,-4268.0561 1041.5442,-4264.936 1098.8536,-4260.5685 1113.4493,-4262.2968 1170.8643,-4264.936 1219.2587,-4267.1605 1230.9953,-4276.7474 1279.407,-4274.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-4106.936C828.7028,-4112.6756 840.812,-4124.027 894.9067,-4128.936 943.8777,-4133.38 956.5468,-4133.0788 1005.5442,-4128.936 1335.5563,-4101.033 1446.0987,-4130.7262 1732.2239,-3963.936 1816.504,-3914.8068 1850.4178,-3903.5904 1895.2266,-3816.936 1957.9224,-3695.6902 1907.55,-3646.3634 1931.2266,-3511.936 2001.3186,-3113.977 2041.7464,-3019.0041 2139.5566,-2626.936 2198.967,-2388.7921 2113.1176,-2272.5997 2280.3391,-2092.936 2285.0673,-2087.8559 2290.8704,-2083.8081 2297.1207,-2080.5829"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2298.7967,-2083.6687 2306.5251,-2076.4215 2295.9641,-2077.2673 2298.7967,-2083.6687"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1279.407,-4388.936C1312.9724,-4383.7749 1322.9169,-4382.5533 1351.9497,-4364.936 1371.0274,-4353.3595 1368.2955,-4340.5042 1387.9497,-4329.936 1388.4862,-4329.6475 1389.0277,-4329.3642 1389.5736,-4329.086"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1391.035,-4332.2667 1398.7557,-4325.0112 1388.1956,-4325.8684 1391.035,-4332.2667"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1106.2042,-4354.936C1142.7001,-4369.309 1240.6385,-4394.8971 1279.407,-4388.936"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M950.2255,-4278.936C1024.9389,-4298.0317 1034.4529,-4326.6785 1106.2042,-4354.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1106.2042,-4084.936C1211.7415,-4051.8999 1244.8545,-4073.506 1351.9497,-4045.936 1368.4238,-4041.695 1371.9473,-4038.7071 1387.9497,-4032.936 1540.9377,-3977.7617 1608.7389,-4014.7706 1732.2239,-3908.936 1757.5941,-3887.1921 1745.4187,-3867.3567 1768.2239,-3842.936 1813.9175,-3794.0054 1861.7768,-3819.9293 1895.2266,-3761.936 1941.4027,-3681.8784 1921.6407,-3022.8574 1931.2266,-2930.936 1951.5496,-2736.0524 1998.3183,-2503.3376 2012.9395,-2433.0454"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2016.3795,-2433.6939 2015.0011,-2423.1892 2009.5278,-2432.2607 2016.3795,-2433.6939"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4068.936C634.1431,-4089.4357 640.7832,-4031.1413 690.4731,-4013.936 741.7702,-3996.1742 1130.8466,-3961.6165 1170.8643,-3924.936 1215.0596,-3884.4262 1165.2604,-3838.103 1206.8643,-3794.936 1253.8071,-3746.2294 1311.0931,-3802.8498 1351.9497,-3748.936 1424.7356,-3652.8887 1357.1141,-2781.435 1387.9497,-2664.936 1423.6725,-2529.9726 1491.3478,-2519.8065 1534.2041,-2386.936 1569.474,-2277.586 1549.8059,-2244.0081 1570.2041,-2130.936 1594.1503,-1998.1966 1632.246,-1840.5283 1646.0258,-1784.7435"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1649.4364,-1785.531 1648.4461,-1774.9826 1642.6422,-1783.8462 1649.4364,-1785.531"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M405.8191,-3889.2751C427.0462,-3923.7989 496.4677,-4027.7696 585.7192,-4068.936"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M447.9519,-3873.356C460.6398,-3869.7092 472.9719,-3863.4761 480.9653,-3852.936 533.0134,-3784.3056 502.498,-2387.8466 516.9653,-2302.936 550.1687,-2108.0603 608.0252,-2072.0859 654.4731,-1879.936 678.0619,-1782.3522 650.0347,-1748.8258 690.4731,-1656.936 739.086,-1546.4711 805.6039,-1552.2157 858.9067,-1443.936 918.5253,-1322.8265 941.4567,-1159.3279 948.034,-1101.3813"/>
<polygon fill="#ff0000" stroke="#ff0000" points="951.5348,-1101.5631 949.1375,-1091.2431 944.5759,-1100.8057 951.5348,-1101.5631"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1461.0769,-3525.936C1486.8358,-3503.4289 1501.8509,-3513.0429 1534.2041,-3501.936 1622.6332,-3471.5781 1676.1985,-3505.7855 1732.2239,-3430.936 1773.1752,-3376.2253 1758.9105,-2884.6378 1768.2239,-2816.936 1782.3129,-2714.519 1813.1257,-2594.5877 1825.9479,-2546.9628"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1829.3581,-2547.7599 1828.6004,-2537.1922 1822.6026,-2545.9259 1829.3581,-2547.7599"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge387" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1331.0975,-4476.9662C1526.8599,-4518.9587 2213.2501,-4668.2688 2244.3391,-4703.936 2294.5523,-4761.5436 2225.8817,-4992.3227 2280.3391,-5045.936 2365.6138,-5129.8889 2435.8096,-5110.1524 2548.515,-5069.936"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1285.707,-4454.8098C1300.7304,-4427.5795 1338.4143,-4354.9793 1351.9497,-4288.936 1365.0462,-4225.0343 1349.6065,-1993.7066 1387.9497,-1940.936 1390.853,-1936.9402 1394.4335,-1933.5767 1398.4363,-1930.7461"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1400.2913,-1933.7161 1407.1642,-1925.6529 1396.7632,-1927.6702 1400.2913,-1933.7161"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1351.2173,-4466.6538C1508.6916,-4470.3765 1894.0804,-4491.2947 2191.9479,-4603.936"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1295.2448,-4454.7287C1310.9636,-4443.0589 1335.0842,-4423.6207 1351.9497,-4402.936 1372.5731,-4377.6424 1362.861,-4359.8081 1387.9497,-4338.936 1392.509,-4335.143 1397.674,-4331.9144 1403.0997,-4329.1686"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1404.7249,-4332.2756 1412.4159,-4324.9887 1401.8593,-4325.889 1404.7249,-4332.2756"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge388" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1107.2125,-1066.7087C1111.7478,-1020.9966 1133.3591,-845.6381 1206.8643,-725.936 1430.9533,-361.0101 1593.8954,-141.3924 2017.3916,-204.936"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1461.0769,-1049.936C1583.092,-1062.7014 1646.8375,-1197.8415 1732.2239,-1415.936 1766.9061,-1504.5216 1716.7047,-1546.9607 1768.2239,-1626.936 1805.1409,-1684.2437 1847.9035,-1663.8689 1895.2266,-1712.936 2016.4177,-1838.5936 2041.7515,-1882.6655 2103.5566,-2045.936 2368.1053,-2744.7932 2227.9253,-2972.5232 2280.3391,-3717.936 2300.771,-4008.5115 2340.6733,-4360.7611 2350.9761,-4449.7436"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2347.5254,-4450.3707 2352.1562,-4459.8999 2354.4786,-4449.5627 2347.5254,-4450.3707"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1110.9292,-1066.6998C1123.612,-1037.3196 1160.5983,-956.5754 1206.8643,-899.936 1416.0001,-643.909 1478.6098,-571.3453 1768.2239,-411.936 1794.0318,-397.7308 1804.0842,-403.1247 1831.7252,-392.936"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1110.6885,-1088.9843C1121.811,-1116.6315 1151.188,-1191.163 1170.8643,-1254.936 1190.0595,-1317.1498 1185.8559,-1335.3108 1206.8643,-1396.936 1239.5286,-1492.7522 1337.8485,-1726.9725 1387.9497,-1814.936 1405.1225,-1845.0865 1429.4574,-1877.0746 1445.2543,-1896.7802"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1442.639,-1899.1121 1451.6555,-1904.6758 1448.0766,-1894.7037 1442.639,-1899.1121"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1111.4314,-1089.2379C1123.9602,-1116.8583 1155.78,-1190.2594 1170.8643,-1254.936 1204.5751,-1399.4774 1185.7675,-1440.0225 1206.8643,-1586.936 1228.0401,-1734.3999 1262.8599,-1910.3927 1275.0381,-1970.5576"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1271.6795,-1971.6057 1277.1009,-1980.7083 1278.5393,-1970.2116 1271.6795,-1971.6057"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1279.407,-1002.936C1641.3744,-922.7228 1737.3201,-931.602 2103.5566,-873.936 2142.8473,-867.7494 2157.2104,-840.5623 2191.9479,-859.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1124.5452,-1066.7508C1155.238,-1048.7963 1219.546,-1014.3981 1279.407,-1002.936"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1116.9655,-1066.8865C1134.6525,-1049.0939 1171.4501,-1013.5971 1206.8643,-988.936 1329.7332,-903.3745 1684.9626,-707.3003 1831.7252,-736.936"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.9479,-1650.936C2209.5599,-1669.5312 2227.7217,-1655.4467 2244.3391,-1674.936 2294.047,-1733.2347 2337.6809,-1973.7736 2349.9931,-2046.8105"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2346.5426,-2047.3979 2351.6382,-2056.687 2353.4475,-2046.2478 2346.5426,-2047.3979"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1279.407,-1002.936C1360.8321,-984.8919 1377.709,-1047.6051 1461.0769,-1049.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-1049.936C1509.9563,-1051.3026 1521.4051,-1039.0534 1570.2041,-1035.936 1642.0664,-1031.3452 1661.7667,-1021.0681 1732.2239,-1035.936 1809.7156,-1052.2883 1836.9183,-1054.3401 1895.2266,-1107.936 2097.7011,-1294.0466 2002.8335,-1451.2641 2191.9479,-1650.936"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1162.1081,-1084.6148C1213.7634,-1092.5142 1291.4322,-1108.8695 1351.9497,-1140.936 1526.0307,-1233.1764 1558.6195,-1294.0431 1651.214,-1467.936"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1651.214,-1467.936C1669.8044,-1509.2884 1710.9184,-1489.9147 1732.2239,-1529.936 1794.0538,-1646.0803 1718.8732,-1998.9649 1768.2239,-2120.936 1818.3208,-2244.7515 1943.1502,-2353.384 1994.6356,-2394.4621"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1992.5074,-2397.2412 2002.5267,-2400.6855 1996.8421,-2391.7448 1992.5074,-2397.2412"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1118.2371,-1088.9717C1158.9609,-1127.1017 1292.3803,-1258.5573 1351.9497,-1396.936 1392.5133,-1491.1646 1328.2747,-1541.4893 1387.9497,-1624.936 1437.575,-1694.3296 1532.6528,-1732.0236 1593.9397,-1750.047"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1593.2707,-1753.4958 1603.8475,-1752.8763 1595.1929,-1746.7649 1593.2707,-1753.4958"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1651.214,-1467.936C1678.0972,-1518.4228 1711.7566,-1514.5252 1732.2239,-1567.936 1788.3571,-1714.4198 1745.0193,-2117.7909 1768.2239,-2272.936 1781.3158,-2360.4682 1811.4282,-2461.8053 1824.943,-2504.8535"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1821.6423,-2506.0237 1828.0009,-2514.4983 1828.3149,-2503.9081 1821.6423,-2506.0237"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge389" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M630.3406,-3065.914C711.5652,-3046.3473 889.2483,-3005.8293 1041.5442,-2986.936 1194.5371,-2967.9562 1233.8884,-2974.6077 1387.9497,-2968.936 1613.3064,-2960.6395 1671.8234,-2988.6849 1895.2266,-2957.936 1969.3944,-2947.7276 2473.6894,-2790.4454 2548.515,-2792.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-2506.936C834.0139,-2450.0886 868.3579,-2441.9607 950.2255,-2448.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M594.9145,-3065.5913C613.079,-3043.2049 654.8889,-2991.7977 690.4731,-2948.936 714.0693,-2920.514 741.7011,-2887.8133 758.7004,-2867.7615"/>
<polygon fill="#ffff00" stroke="#ffff00" points="761.4918,-2869.8814 765.2921,-2859.9916 756.1539,-2865.3529 761.4918,-2869.8814"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M774.6899,-4068.936C801.865,-4096.7977 824.7813,-4074.222 858.9067,-4092.936 954.0436,-4145.1078 955.577,-4188.7351 1041.5442,-4254.936 1096.2324,-4297.0498 1134.1701,-4282.473 1170.8643,-4340.936 1233.115,-4440.1169 1133.9731,-4510.2906 1206.8643,-4601.936 1254.0735,-4661.2918 1342.6042,-4683.168 1401.7118,-4691.2305"/>
<polygon fill="#aaff00" stroke="#aaff00" points="1401.2994,-4694.7062 1411.661,-4692.4957 1402.1825,-4687.7621 1401.2994,-4694.7062"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M774.6899,-3190.936C804.0671,-3195.8837 1011.7884,-3166.3821 1041.5442,-3164.936 1196.3831,-3157.4107 1626.373,-3149.6782 1732.2239,-3262.936 1794.1925,-3329.2408 1739.9055,-3377.7123 1768.2239,-3463.936 1808.1036,-3585.3615 1863.4613,-3598.1397 1895.2266,-3721.936 1983.7967,-4067.1132 1855.8805,-4174.633 1931.2266,-4522.936 1947.3914,-4597.6614 1987.0716,-4679.9803 2006.4226,-4717.3975"/>
<polygon fill="#54ff00" stroke="#54ff00" points="2003.5639,-4719.4831 2011.305,-4726.7168 2009.7645,-4716.2346 2003.5639,-4719.4831"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2191.9479,-3741.936C2268.5182,-3867.5573 2336.2702,-4343.5045 2350.6471,-4449.7983"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2347.2051,-4450.4646 2352.0039,-4459.9103 2354.1429,-4449.5336 2347.2051,-4450.4646"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M774.6899,-3190.936C851.0358,-3207.1342 823.2792,-3093.929 894.9067,-3062.936 993.8107,-3020.1405 1316.4604,-2990.2234 1732.2239,-3187.936 1930.0252,-3281.9986 1978.0583,-3332.4275 2103.5566,-3511.936 2166.3043,-3601.688 2134.9507,-3648.4265 2191.9479,-3741.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M597.7257,-3088.1597C625.8832,-3113.5176 699.4913,-3174.3174 774.6899,-3190.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M590.1672,-3088.3371C602.3399,-3119.9812 636.4867,-3211.7857 654.4731,-3290.936 667.5449,-3348.4589 651.2035,-3509.9172 690.4731,-3553.936 741.9058,-3611.5888 792.95,-3556.7007 858.9067,-3596.936 917.2578,-3632.5316 1047.6478,-3799.2906 1091.4962,-3856.5647"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1088.9169,-3858.9541 1097.7663,-3864.7799 1094.4814,-3854.7071 1088.9169,-3858.9541"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M774.6899,-2164.936C859.0355,-1915.8965 879.1101,-1843.6968 1041.5442,-1636.936 1103.8961,-1557.5689 1657.0212,-1114.252 1732.2239,-1046.936 1981.0583,-824.1972 1975.5749,-669.5007 2280.3391,-532.936 2389.5423,-484.0021 2452.2172,-437.8965 2548.515,-508.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge340" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M589.2867,-3088.0144C606.4935,-3141.3558 680.4939,-3369.6651 690.4731,-3381.936 758.2744,-3465.3069 1004.0236,-3595.6667 1106.2042,-3628.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge358" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M586.0361,-3065.8609C588.2464,-2997.5405 603.9352,-2626.9161 690.4731,-2340.936 715.5889,-2257.9366 746.762,-2247.0318 774.6899,-2164.936"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M774.6899,-2164.936C785.8844,-2132.0292 872.075,-1577.1444 894.9067,-1550.936 929.0582,-1511.7337 972.4777,-1553.0576 1005.5442,-1512.936 1042.3612,-1468.2636 1027.5341,-1311.1038 1041.5442,-1254.936 1056.0475,-1196.7908 1082.9006,-1131.2338 1097.0047,-1098.6411"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1100.3034,-1099.8331 1101.1042,-1089.2685 1093.8901,-1097.0279 1100.3034,-1099.8331"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-4068.936C792.2866,-4088.2286 982.0699,-4101.499 1005.5442,-4112.936 1032.2544,-4125.9495 1179.1293,-4278.2795 1206.8643,-4288.936 1342.6851,-4341.1217 1409.2141,-4219.4502 1534.2041,-4293.936 1688.7332,-4386.0252 1645.1481,-4489.5273 1732.2239,-4646.936 1748.3977,-4676.1738 1743.1754,-4690.8222 1768.2239,-4712.936 1772.3318,-4716.5626 1777.0281,-4719.6949 1781.9661,-4722.3929"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1780.5155,-4725.5793 1791.0405,-4726.7936 1783.57,-4719.2809 1780.5155,-4725.5793"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M590.431,-3088.2815C603.278,-3119.7835 638.9882,-3211.2585 654.4731,-3290.936 696.3009,-3506.1604 651.2842,-3567.2155 690.4731,-3782.936 714.1575,-3913.3095 689.8621,-3967.1399 774.6899,-4068.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M950.2255,-3266.936C1181.4457,-3306.0316 1227.6448,-3376.5601 1461.0769,-3398.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M774.6899,-3190.936C858.552,-3204.8842 866.0495,-3255.0279 950.2255,-3266.936"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M950.2255,-3266.936C993.1064,-3273.0022 998.9221,-3240.6131 1041.5442,-3232.936 1178.3309,-3208.2978 1226.8463,-3210.382 1351.9497,-3270.936 1370.6964,-3280.01 1370.8553,-3289.0382 1387.9497,-3300.936 1401.521,-3310.3816 1417.3503,-3319.6674 1430.804,-3327.0959"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1429.2242,-3330.2208 1439.6817,-3331.9212 1432.5671,-3324.0705 1429.2242,-3330.2208"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.8236,-3065.4764C609.753,-2988.5453 730.7488,-2549.0426 774.6899,-2506.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-2506.936C808.2485,-2474.7784 832.3044,-2483.049 858.9067,-2444.936 891.7522,-2397.8784 862.6793,-2368.4189 894.9067,-2320.936 929.8824,-2269.404 965.495,-2282.6319 1005.5442,-2234.936 1027.534,-2208.7476 1015.8275,-2189.4756 1041.5442,-2166.936 1064.5967,-2146.7315 1083.0103,-2162.9779 1106.2042,-2142.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-2142.936C1129.139,-2122.598 1147.5561,-2138.845 1170.8643,-2118.936 1195.6795,-2097.7396 1181.6725,-2075.6835 1206.8643,-2054.936 1233.0782,-2033.3466 1250.3235,-2048.4696 1279.407,-2030.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M590.287,-3088.3108C602.766,-3119.8876 637.623,-3211.5361 654.4731,-3290.936 685.4681,-3436.9876 640.8475,-3484.1203 690.4731,-3624.936 748.7037,-3790.1687 885.8681,-3956.4987 933.5453,-4011.223"/>
<polygon fill="#7fff00" stroke="#7fff00" points="930.9293,-4013.5483 940.1575,-4018.7532 936.1893,-4008.9296 930.9293,-4013.5483"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1106.2042,-2104.936C1129.0529,-2085.9432 1181.156,-2031.8314 1206.8643,-2016.936 1213.6719,-2012.9916 1221.1997,-2009.5366 1228.7529,-2006.555"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1230.117,-2009.7823 1238.2817,-2003.0304 1227.6885,-2003.217 1230.117,-2009.7823"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M586.6055,-3065.6458C592.4497,-2993.3018 627.1871,-2594.5918 690.4731,-2492.936 739.6017,-2414.0212 805.7021,-2445.1621 858.9067,-2368.936 891.7522,-2321.8784 856.9804,-2288.0037 894.9067,-2244.936 930.3308,-2204.7097 966.202,-2233.3394 1005.5442,-2196.936 1030.6438,-2173.7112 1015.8275,-2151.4756 1041.5442,-2128.936 1064.5967,-2108.7315 1082.6313,-2124.5308 1106.2042,-2104.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M774.6899,-3190.936C1028.0498,-3233.0755 1123.1217,-3101.2967 1351.9497,-3217.936 1374.7688,-3229.5674 1365.6883,-3250.2698 1387.9497,-3262.936 1522.2271,-3339.3362 1624.1377,-3200.5513 1732.2239,-3310.936 1779.9723,-3359.6998 1748.5671,-3550.5797 1768.2239,-3615.936 1780.1826,-3655.6973 1804.1437,-3698.0429 1818.9707,-3722.1198"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1816.0674,-3724.0779 1824.3431,-3730.6934 1821.9991,-3720.3611 1816.0674,-3724.0779"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-2506.936C845.897,-2440.0637 811.544,-2640.0145 894.9067,-2690.936 1069.2082,-2797.4067 1150.8931,-2702.9747 1351.9497,-2738.936 1539.882,-2772.5499 1578.7909,-2821.1962 1768.2239,-2844.936 1824.2314,-2851.9549 1838.7875,-2845.798 1895.2266,-2844.936 2098.9531,-2841.8245 2149.7104,-2828.942 2353.4509,-2830.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M774.6899,-2506.936C808.5536,-2475.0998 823.9826,-2475.6051 858.9067,-2444.936 929.6796,-2382.786 948.0928,-2366.5734 1005.5442,-2291.936 1024.2812,-2267.594 1017.1714,-2251.6328 1041.5442,-2232.936 1089.0753,-2196.4741 1123.9873,-2232.2352 1170.8643,-2194.936 1196.4021,-2174.6159 1180.6977,-2150.4398 1206.8643,-2130.936 1411.1996,-1978.6302 2101.2436,-2070.31 2353.4509,-2106.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2353.4509,-2106.936C2389.8512,-2106.2579 2429.8804,-2102.6561 2464.1543,-2098.6917"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2464.6084,-2102.1625 2474.1268,-2097.5095 2463.7843,-2095.2111 2464.6084,-2102.1625"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-2506.936C803.3086,-2480.0595 910.9783,-2527.9512 950.2255,-2526.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-2526.936C976.2126,-2526.2638 983.3967,-2521.5476 1005.5442,-2507.936 1024.556,-2496.2515 1023.1405,-2485.5566 1041.5442,-2472.936 1319.6382,-2282.2286 1458.3132,-2355.6045 1732.2239,-2158.936 1928.7388,-2017.8378 1945.1619,-1943.7964 2103.5566,-1760.936 2144.6195,-1713.5305 2139.0703,-1617.2107 2191.9479,-1650.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M950.2255,-2526.936C1048.9569,-2525.6192 1074.6578,-2523.1607 1170.8643,-2500.936 1270.4654,-2477.9271 1289.2394,-2451.5079 1387.9497,-2424.936 1419.9034,-2416.3343 1428.3609,-2415.905 1461.0769,-2410.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.7822,-3065.757C595.0026,-2980.1018 649.2249,-2429.5411 690.4731,-2368.936 739.0783,-2297.5215 800.1554,-2335.2667 858.9067,-2271.936 884.0532,-2244.8294 871.1947,-2225.3059 894.9067,-2196.936 993.3712,-2079.1297 1308.694,-1819.7242 1461.0769,-1800.936"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M950.2255,-2526.936C991.1087,-2528.9947 1000.6965,-2536.2636 1041.5442,-2538.936 1147.218,-2545.8494 1175.3723,-2544.7235 1279.407,-2524.936"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1279.407,-2524.936C1327.6822,-2518.9836 1339.4089,-2535.8185 1387.9497,-2538.936 1518.356,-2547.3113 1670.6698,-2538.8918 1758.6805,-2532.2492"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1759.1243,-2535.7255 1768.8268,-2531.4697 1758.588,-2528.7461 1759.1243,-2535.7255"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge390" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M977.5587,-2476.8764C1024.047,-2458.3773 1121.7559,-2420.8388 1206.8643,-2396.936 1590.5552,-2289.1756 1708.8677,-2336.6939 2103.5566,-2391.936 2166.6519,-2400.767 2199.5066,-2373.6696 2244.3391,-2418.936 2307.2794,-2482.4854 2219.4895,-2551.382 2280.3391,-2616.936 2326.0205,-2666.149 2373.6348,-2613.616 2426.5627,-2654.936 2452.9004,-2675.4974 2441.3863,-2695.0903 2462.5627,-2720.936 2494.1456,-2759.4826 2498.7083,-2791.3206 2548.515,-2792.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2548.515,-2792.936C2585.8088,-2794.3043 2708.0799,-2829.3041 2716.4498,-2792.936"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M986.0909,-2476.8715C993.2612,-2473.3374 1000.2156,-2468.7742 1005.5442,-2462.936 1038.5182,-2426.8083 1007.5801,-2394.1344 1041.5442,-2358.936 1044.9184,-2355.4391 1048.8367,-2352.4234 1053.0434,-2349.8241"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1054.8209,-2352.843 1062.0016,-2345.0527 1051.5301,-2346.6647 1054.8209,-2352.843"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1106.2042,-2486.936C1193.3572,-2477.2051 1829.8448,-2447.4932 1895.2266,-2505.936 1939.2069,-2545.2486 1912.342,-2713.051 1931.2266,-2768.936 1980.9467,-2916.0724 2046.7963,-2928.3695 2103.5566,-3072.936 2128.9288,-3137.558 2119.6176,-3158.4365 2139.5566,-3224.936 2178.5565,-3355.0059 2213.1605,-3379.7729 2244.3391,-3511.936 2288.6447,-3699.7428 2341.5429,-4325.8129 2351.7136,-4449.5756"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2348.2356,-4449.9882 2352.5396,-4459.6694 2355.2122,-4449.4172 2348.2356,-4449.9882"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1279.407,-2144.936C1310.2371,-2123.6232 1321.5111,-2123.8042 1351.9497,-2101.936 1369.0977,-2089.6163 1371.1528,-2083.7301 1387.9497,-2070.936 1534.5328,-1959.2841 1604.6184,-1972.8629 1732.2239,-1839.936 1852.3664,-1714.7832 2416.0303,-396.9305 2548.515,-508.936"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge341" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M989.4285,-2498.966C995.7586,-2502.4432 1001.5391,-2506.9929 1005.5442,-2512.936 1061.9088,-2596.5732 998.0409,-3328.9435 1041.5442,-3419.936 1047.7039,-3432.8198 1201.2578,-3562.3946 1258.317,-3610.276"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1256.095,-3612.9804 1266.0064,-3616.7241 1260.5928,-3607.6167 1256.095,-3612.9804"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge357" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M952.5995,-2476.9289C961.4259,-2435.4882 992.5078,-2284.8176 1005.5442,-2158.936 1046.9641,-1758.9788 963.6213,-1649.4096 1041.5442,-1254.936 1053.1575,-1196.1453 1081.2563,-1130.8665 1096.3031,-1098.4844"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1099.5928,-1099.7142 1100.6923,-1089.1766 1093.2614,-1096.7285 1099.5928,-1099.7142"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M983.8968,-2499.0637C991.592,-2502.6653 999.3261,-2507.2419 1005.5442,-2512.936 1029.6131,-2534.9763 1019.3424,-2553.016 1041.5442,-2576.936 1088.5011,-2627.5268 1125.034,-2611.3223 1170.8643,-2662.936 1289.2557,-2796.2673 1278.5268,-2858.4465 1351.9497,-3020.936 1369.6895,-3060.1953 1367.5908,-3072.9687 1387.9497,-3110.936 1442.0441,-3211.8165 1469.9532,-3228.2 1534.2041,-3322.936 1550.3944,-3346.808 1547.9595,-3358.5736 1570.2041,-3376.936 1579.7614,-3384.8253 1591.4123,-3391.1316 1602.8651,-3396.0651"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1601.8047,-3399.4109 1612.3887,-3399.8909 1604.4141,-3392.9154 1601.8047,-3399.4109"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-2180.936C1124.3414,-2156.224 1149.6756,-2179.0872 1170.8643,-2156.936 1207.006,-2119.1524 1167.7359,-2079.6174 1206.8643,-2044.936 1231.4373,-2023.1557 1251.2859,-2047.8894 1279.407,-2030.936"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M989.2758,-2499.0706C995.62,-2502.5382 1001.4447,-2507.0576 1005.5442,-2512.936 1037.5321,-2558.8046 1034.9057,-2959.4104 1041.5442,-3014.936 1058.2143,-3154.3672 1090.2542,-3320.2862 1101.8665,-3378.4897"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1098.507,-3379.5384 1103.9059,-3388.6545 1105.3703,-3378.1613 1098.507,-3379.5384"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1106.2042,-2180.936C1129.7616,-2148.8389 1149.284,-2152.3943 1170.8643,-2118.936 1196.9216,-2078.5364 1172.745,-2050.8032 1206.8643,-2016.936 1210.4008,-2013.4256 1214.4526,-2010.4073 1218.7937,-2007.8123"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1220.7459,-2010.744 1228.038,-2003.0579 1217.5444,-2004.519 1220.7459,-2010.744"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M963.3851,-2476.8151C976.2135,-2465.2125 995.2484,-2445.8255 1005.5442,-2424.936 1041.9971,-2350.9752 1001.9519,-2315.2648 1041.5442,-2242.936 1060.6614,-2208.0118 1082.6469,-2213.033 1106.2042,-2180.936"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M985.9684,-2499.0272C1030.7645,-2513.6647 1109.1501,-2541.7432 1170.8643,-2576.936 1347.4935,-2677.6597 1406.3437,-2696.8383 1534.2041,-2854.936 1663.4728,-3014.775 1668.6612,-3077.4399 1732.2239,-3272.936 1758.9339,-3355.0864 1750.6024,-3379.3688 1768.2239,-3463.936 1788.3252,-3560.4042 1815.5566,-3674.9198 1826.6789,-3721.1014"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1823.2824,-3721.9468 1829.0313,-3730.8463 1830.0869,-3720.3041 1823.2824,-3721.9468"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1279.407,-2410.936C1327.4674,-2403.4439 1339.6205,-2419.4387 1387.9497,-2424.936 1613.0471,-2450.5402 1694.5672,-2369.7684 1895.2266,-2474.936 2043.9014,-2552.858 1999.847,-2669.8916 2139.5566,-2762.936 2222.5819,-2818.2295 2253.7445,-2833.9692 2353.4509,-2830.936"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1279.407,-2144.936C1446.887,-2030.2875 1992.9203,-2146.7086 2191.9479,-2106.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2191.9479,-2106.936C2260.9223,-2087.067 2282.4169,-2096.6203 2353.4509,-2106.936"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1005.6142,-2490.3921C1035.4971,-2491.0102 1072.9667,-2490.647 1106.2042,-2486.936"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1461.0769,-2410.936C1546.2763,-2397.9956 1565.0403,-2372.2372 1651.214,-2372.936"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1279.407,-2410.936C1359.1856,-2398.4994 1381.2502,-2423.0603 1461.0769,-2410.936"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1106.2042,-2486.936C1136.6684,-2483.5346 1144.0851,-2477.8529 1170.8643,-2462.936 1188.5721,-2453.0721 1188.9822,-2444.4804 1206.8643,-2434.936 1236.8238,-2418.9454 1245.8524,-2416.1668 1279.407,-2410.936"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1279.407,-2144.936C1311.0176,-2124.7989 1327.2877,-2130.1586 1351.9497,-2101.936 1378.9455,-2071.0428 1363.6438,-2049.9872 1387.9497,-2016.936 1413.1939,-1982.6088 1432.0526,-1986.1324 1461.0769,-1954.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M962.8716,-2476.5429C975.3005,-2464.7284 994.0312,-2445.1801 1005.5442,-2424.936 1031.1831,-2379.8535 1009.6469,-2354.8302 1041.5442,-2313.936 1083.255,-2260.4602 1124.0534,-2282.0093 1170.8643,-2232.936 1193.3904,-2209.3211 1181.6725,-2189.6835 1206.8643,-2168.936 1233.0782,-2147.3466 1250.7651,-2163.1819 1279.407,-2144.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-1954.936C1483.9503,-1930.3508 1506.7538,-1955.2777 1534.2041,-1935.936 1590.0952,-1896.5547 1627.3116,-1821.358 1642.9084,-1784.8532"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1646.295,-1785.8235 1646.8924,-1775.2455 1639.8288,-1783.1422 1646.295,-1785.8235"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-1909.9414 166.6166,-1909.9414 166.6166,-1887.9305 281.0645,-1887.9305 281.0645,-1909.9414"/>
<text text-anchor="middle" x="223.8406" y="-1895.786" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1974.936C500.0159,-2027.9472 543.3356,-1973.5212 654.4731,-1998.936 748.9687,-2020.545 780.6572,-2017.7226 858.9067,-2074.936 879.8635,-2090.2588 877.7355,-2101.4649 894.9067,-2120.936 961.8085,-2196.7983 1048.7928,-2280.1288 1086.898,-2315.9472"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1084.5727,-2318.5648 1094.2625,-2322.8495 1089.3596,-2313.4573 1084.5727,-2318.5648"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M255.7205,-1909.9597C291.7719,-1923.0533 351.6271,-1946.713 399.0839,-1974.936"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M399.0839,-1974.936C434.6709,-1988.0395 453.5194,-1972.7661 480.9653,-1998.936 546.2291,-2061.1653 732.9125,-2703.3313 768.7132,-2828.025"/>
<polygon fill="#ffff00" stroke="#ffff00" points="765.4153,-2829.2222 771.5349,-2837.8709 772.1445,-2827.2936 765.4153,-2829.2222"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge366" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M228.8288,-1910.0888C240.5318,-1934.9671 272.2035,-1995.2928 317.2024,-2026.936 379.2442,-2070.5636 432.3995,-2016.6787 480.9653,-2074.936 546.1218,-2153.0947 579.3809,-2917.1205 584.8937,-3055.5023"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="581.4028,-3055.8057 585.2929,-3065.6605 588.3974,-3055.5307 581.4028,-3055.8057"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M227.506,-1887.7095C237.5389,-1858.48 268.0257,-1778.9625 317.2024,-1730.936 329.0755,-1719.3406 344.7088,-1710.0989 359.1305,-1703.2005"/>
<polygon fill="#00ffff" stroke="#00ffff" points="360.7199,-1706.3228 368.381,-1699.0044 357.8282,-1699.948 360.7199,-1706.3228"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.7263,-1887.9298C335.3717,-1875.8092 432.8179,-1855.9197 516.9653,-1839.936 593.925,-1825.3175 612.4433,-1815.8519 690.4731,-1808.936 966.316,-1784.4876 1294.5945,-1867.8297 1414.3932,-1901.9897"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1413.7524,-1905.4473 1424.3303,-1904.8474 1415.6871,-1898.7199 1413.7524,-1905.4473"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M281.0672,-1904.8468C393.2518,-1917.2107 649.4007,-1949.279 858.9067,-2003.936 899.859,-2014.6198 907.909,-2031.6792 950.2255,-2030.936"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M950.2255,-2030.936C1021.5298,-2024.8085 1034.754,-1986.8469 1106.2042,-1990.936"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M419.8123,-1699.1203C464.002,-1723.2105 570.3072,-1782.4851 654.4731,-1839.936 749.542,-1904.8291 778.5439,-1916.5283 858.9067,-1998.936 963.653,-2106.3475 1061.096,-2259.7754 1094.2345,-2314.0142"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1091.3141,-2315.9484 1099.4957,-2322.6798 1097.2977,-2312.3155 1091.3141,-2315.9484"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M774.6899,-1670.936C811.6416,-1683.1562 825.492,-1674.9807 858.9067,-1694.936 878.6052,-1706.6999 876.5216,-1718.2098 894.9067,-1731.936 986.8302,-1800.5653 1291.9596,-1874.1551 1351.9497,-1971.936 1430.3689,-2099.7553 1299.9231,-4549.5331 1387.9497,-4670.936 1391.7745,-4676.2109 1396.7796,-4680.3842 1402.3797,-4683.684"/>
<polygon fill="#aaff00" stroke="#aaff00" points="1401.0641,-4686.9367 1411.5854,-4688.1832 1404.1379,-4680.6476 1401.0641,-4686.9367"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge367" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M403.3368,-1699.1767C417.1002,-1736.0621 460.7077,-1857.0007 480.9653,-1960.936 565.9075,-2396.7463 582.6493,-2942.2109 585.2859,-3055.6795"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="581.7898,-3055.8994 585.5098,-3065.8197 588.7881,-3055.7448 581.7898,-3055.8994"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-1670.936C836.8062,-1694.3516 1293.0035,-1794.4061 1351.9497,-1824.936 1388.6601,-1843.9493 1424.0737,-1877.0678 1444.1556,-1897.6753"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1441.6304,-1900.0988 1451.0723,-1904.9052 1446.6885,-1895.2598 1441.6304,-1900.0988"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1668.936C669.4887,-1662.83 694.9459,-1644.5638 774.6899,-1670.936"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M950.2255,-1916.936C1015.8841,-1956.6402 1029.5996,-1986.5519 1106.2042,-1990.936"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1106.2042,-1990.936C1136.9532,-1992.6957 1170.8226,-1993.2074 1200.3934,-1993.188"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1200.6711,-1996.6874 1210.6615,-1993.1602 1200.652,-1989.6874 1200.6711,-1996.6874"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-1668.936C653.7228,-1663.558 812.3554,-1759.0724 858.9067,-1808.936 886.6246,-1838.626 866.2498,-1864.1513 894.9067,-1892.936 913.8152,-1911.9287 927.2922,-1903.0681 950.2255,-1916.936"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1668.936C646.3635,-1664.5156 633.3409,-1601.7487 690.4731,-1580.936 760.8107,-1555.3127 796.4111,-1539.7266 858.9067,-1580.936 892.8159,-1603.2955 860.9976,-1642.5764 894.9067,-1664.936 935.9577,-1692.0048 956.4893,-1668.331 1005.5442,-1664.936 1050.6048,-1661.8174 1063.773,-1635.4514 1106.2042,-1650.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M464.1925,-1680.0413C500,-1676.0188 545.2487,-1671.4561 585.7192,-1668.936"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M588.2058,-939.1048C598.605,-986.3747 638.7962,-1174.7688 654.4731,-1331.936 706.9476,-1858.012 616.2804,-1997.4811 690.4731,-2520.936 707.2648,-2639.4064 750.5862,-2776.8169 767.6412,-2828.1734"/>
<polygon fill="#ffff00" stroke="#ffff00" points="764.3671,-2829.4185 770.8629,-2837.7884 771.0044,-2827.1945 764.3671,-2829.4185"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M588.2226,-916.9262C597.0352,-879.9605 629.4357,-758.0592 690.4731,-676.936 767.0028,-575.2224 1523.9251,-52.936 1651.214,-52.936 1651.214,-52.936 1651.214,-52.936 2353.4509,-52.936 2586.2372,-52.936 2563.9016,-273.1028 2634.4673,-494.936 2686.176,-657.4896 2712.5784,-1942.828 2716.0537,-2123.7907"/>
<polygon fill="#0054ff" stroke="#0054ff" points="2712.5561,-2123.9563 2716.2457,-2133.8879 2719.5548,-2123.8231 2712.5561,-2123.9563"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge351" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M774.6899,-928.936C852.6097,-932.907 875.0849,-905.9325 950.2255,-926.936"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M950.2255,-926.936C976.0363,-934.1507 987.2075,-931.3907 1005.5442,-950.936 1037.8635,-985.3855 1008.9882,-1016.71 1041.5442,-1050.936 1045.7337,-1055.3404 1050.7512,-1059.0541 1056.1139,-1062.1789"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1054.8804,-1065.4785 1065.3794,-1066.8998 1058.0582,-1059.2414 1054.8804,-1065.4785"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M632.3478,-927.0002C670.6148,-926.5166 726.1972,-926.4647 774.6899,-928.936"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M588.2587,-939.0997C598.8704,-986.3491 639.7952,-1174.6724 654.4731,-1331.936 675.6436,-1558.7631 631.5203,-3161.8831 690.4731,-3381.936 704.3509,-3433.7375 739.5622,-3486.8882 759.7884,-3514.5374"/>
<polygon fill="#00ffff" stroke="#00ffff" points="757.002,-3516.6558 765.7828,-3522.5844 762.6157,-3512.474 757.002,-3516.6558"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M774.6899,-928.936C892.5073,-934.9403 942.1843,-960.4247 1005.5442,-1059.936 1059.7811,-1145.1189 1005.2466,-1418.7008 1041.5442,-1512.936 1075.4127,-1600.8648 1126.0283,-1598.0608 1170.8643,-1680.936 1226.1302,-1783.09 1262.0229,-1918.901 1274.4973,-1970.6692"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1271.1532,-1971.7365 1276.8634,-1980.6608 1277.9648,-1970.1234 1271.1532,-1971.7365"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-852.936C821.2278,-829.888 827.1224,-813.0059 858.9067,-771.936 878.8808,-746.1266 874.7461,-733.5999 894.9067,-707.936 901.7939,-699.1689 1031.1731,-575.0269 1041.5442,-570.936 1095.0106,-549.8459 1113.4949,-567.4429 1170.8643,-570.936 1222.9696,-574.1085 2053.8163,-669.0951 2103.5566,-684.936 2266.7135,-736.8969 2347.8294,-742.8796 2426.5627,-894.936 2475.4132,-989.28 2397.9895,-2722.571 2462.5627,-2806.936 2464.9212,-2810.0173 2467.6372,-2812.7354 2470.6187,-2815.1317"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2468.8028,-2818.1274 2479.0673,-2820.7522 2472.68,-2812.2993 2468.8028,-2818.1274"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M605.7238,-916.8856C626.4658,-905.743 660.0566,-888.571 690.4731,-876.936 726.8243,-863.0309 739.4145,-869.3798 774.6899,-852.936"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M599.1549,-916.6602C648.0684,-875.4502 816.0131,-732.5129 858.9067,-676.936 879.8,-649.8647 872.9179,-635.1251 894.9067,-608.936 947.9881,-545.715 970.9903,-537.7924 1041.5442,-494.936 1185.2392,-407.6515 1223.1298,-376.1207 1387.9497,-342.936 1451.6729,-330.106 1470.2903,-331.0921 1534.2041,-342.936 1626.8942,-360.1124 1666.4779,-351.3789 1732.2239,-418.936 1765.7524,-453.3881 1733.0628,-488.1517 1768.2239,-520.936 1823.1923,-572.1887 1856.7515,-555.8446 1931.2266,-565.936 2007.1241,-576.2201 2027.0206,-568.8414 2103.5566,-565.936 2214.8612,-561.7107 2269.8879,-473.2898 2353.4509,-546.936"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1831.7252,-888.936C1908.997,-909.9359 2137.5533,-839.1725 2191.9479,-897.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-852.936C834.1959,-821.5405 834.9009,-791.365 894.9067,-760.936 982.1943,-716.6723 1008.3349,-698.936 1106.2042,-698.936 1106.2042,-698.936 1106.2042,-698.936 1279.407,-698.936 1485.0403,-698.936 1550.2601,-698.1537 1732.2239,-793.936 1786.3283,-822.4155 1772.0875,-875.4558 1831.7252,-888.936"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M774.6899,-852.936C803.9011,-837.6954 1326.2749,-968.2871 1351.9497,-988.936 1380.7621,-1012.1083 1363.671,-1036.0495 1387.9497,-1063.936 1439.1665,-1122.7633 1478.811,-1106.023 1534.2041,-1160.936 1645.8249,-1271.5893 1677.987,-1306.4174 1732.2239,-1453.936 1782.3733,-1590.337 1733.3035,-1637.8659 1768.2239,-1778.936 1784.2922,-1843.8483 1966.954,-2289.3565 2008.8598,-2391.2221"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2005.7237,-2392.7985 2012.7664,-2400.7137 2012.1969,-2390.1342 2005.7237,-2392.7985"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-1080.936C813.9932,-1086.0325 858.6633,-1085.693 893.105,-1084.1251"/>
<polygon fill="#ff0000" stroke="#ff0000" points="893.6371,-1087.6028 903.4482,-1083.6038 893.2846,-1080.6117 893.6371,-1087.6028"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M592.9957,-939.3949C615.2621,-972.9708 686.3612,-1069.4822 774.6899,-1080.936"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M589.6112,-1871.3699C601.4924,-1906.777 637.5132,-2017.9429 654.4731,-2112.936 686.468,-2292.1401 659.735,-2341.512 690.4731,-2520.936 710.6775,-2638.8724 751.9853,-2776.5979 768.0714,-2828.1061"/>
<polygon fill="#ffff00" stroke="#ffff00" points="764.7656,-2829.2612 771.1045,-2837.7506 771.4432,-2827.1612 764.7656,-2829.2612"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1831.7252,-1612.936C1914.0919,-1607.9352 1942.215,-1578.91 2017.3916,-1612.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M618.9656,-1848.7751C677.7422,-1827.1984 799.4036,-1773.8863 858.9067,-1684.936 909.1243,-1609.8665 825.6164,-1542.8676 894.9067,-1484.936 985.2452,-1409.4066 1525.6502,-1445.5997 1732.2239,-1529.936 1785.5403,-1551.7031 1774.2425,-1616.426 1831.7252,-1612.936"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M654.489,-1856.651C802.3147,-1849.293 1161.2605,-1829.8365 1461.0769,-1800.936"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge354" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-586.936C451.7046,-564.351 463.3693,-618.7744 516.9653,-638.936 540.5779,-647.8185 931.7179,-757.7918 950.2255,-774.936"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-586.936C467.0521,-557.7639 555.4522,-828.5339 579.4686,-907.0037"/>
<polygon fill="#ff0000" stroke="#ff0000" points="576.1718,-908.1932 582.4213,-916.7486 582.8711,-906.1634 576.1718,-908.1932"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-836.8956C295.254,-838.6787 313.4912,-840.656 330.689,-842.5206"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.3543,-846.0047 340.6733,-843.6031 331.1089,-839.0455 330.3543,-846.0047"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-586.936C434.4969,-573.3692 447.6388,-581.0323 480.9653,-562.936 588.848,-504.3557 577.0619,-429.9277 690.4731,-382.936 904.4761,-294.2642 1549.5111,-203.5422 1732.2239,-345.936 1771.4677,-376.5199 1730.6767,-419.2914 1768.2239,-451.936 1804.2833,-483.2871 2146.0454,-500.8007 2191.9479,-508.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M225.1992,-819.881C230.1989,-784.0403 250.8769,-669.9688 317.2024,-610.936 345.5299,-585.7231 362.756,-597.8182 399.0839,-586.936"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.0839,-586.936C522.6842,-529.7691 878.6591,-625.4862 1005.5442,-674.936 1097.9923,-710.9649 1685.8075,-1106.2418 1732.2239,-1193.936 1830.4377,-1379.4905 1675.4354,-1476.6098 1768.2239,-1664.936 1801.7472,-1732.9758 1857.8695,-1712.9233 1895.2266,-1778.936 1957.1325,-1888.3284 2004.4497,-2293.0358 2015.1237,-2390.6487"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2011.6624,-2391.1962 2016.2178,-2400.7616 2018.6218,-2390.4432 2011.6624,-2391.1962"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M255.6095,-819.8008C308.1705,-803.5675 414.0559,-780.395 480.9653,-829.936 525.0318,-862.5636 481.8419,-905.8318 516.9653,-947.936 599.5342,-1046.9153 646.8629,-1064.3603 774.6899,-1080.936"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge349" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M457.423,-839.1567C545.7095,-824.932 717.9123,-805.3755 858.9067,-838.936 929.9233,-855.8398 959.681,-856.141 1005.5442,-912.936 1045.3668,-962.2506 999.9772,-1003.0824 1041.5442,-1050.936 1045.2837,-1055.241 1049.8216,-1058.8748 1054.7402,-1061.9387"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1053.448,-1065.2172 1063.9146,-1066.8603 1056.7571,-1059.0488 1053.448,-1065.2172"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M440.3806,-861.0367C453.5197,-864.9676 468.0027,-869.723 480.9653,-874.936 507.5307,-885.6193 536.4858,-900.5381 557.2078,-911.8264"/>
<polygon fill="#ff0000" stroke="#ff0000" points="555.6632,-914.9714 566.1112,-916.7293 559.0398,-908.8396 555.6632,-914.9714"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1289.6727,-4990.7193C1305.3733,-4972.975 1335.28,-4936.7547 1351.9497,-4900.936 1379.4209,-4841.9076 1353.6985,-4814.3062 1387.9497,-4758.936 1399.5532,-4740.1779 1418.5565,-4724.0544 1434.2828,-4712.8152"/>
<polygon fill="#aaff00" stroke="#aaff00" points="1436.3564,-4715.637 1442.6147,-4707.088 1432.3911,-4709.8684 1436.3564,-4715.637"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1330.8788,-4990.9166C1338.6664,-4987.4552 1346.0538,-4982.9083 1351.9497,-4976.936 1387.792,-4940.629 1358.7702,-4909.7859 1387.9497,-4867.936 1395.35,-4857.3224 1558.7277,-4728.9112 1570.2041,-4722.936 1603.5112,-4705.5945 1613.7059,-4697.1369 1651.214,-4698.936"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1285.253,-5013.1628C1307.4773,-5055.8194 1385.5831,-5205.5112 1387.9497,-5206.936 1519.8329,-5286.3359 1591.9988,-5232.4534 1732.2239,-5168.936 1750.6878,-5160.5724 1750.5454,-5150.8524 1768.2239,-5140.936 1794.538,-5126.1756 1802.9774,-5126.0938 1831.7252,-5116.936"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M1895.3613,-4737.936C1919.6669,-4737.936 1946.9454,-4737.936 1969.5372,-4737.936"/>
<polygon fill="#54ff00" stroke="#54ff00" points="1969.56,-4741.4361 1979.56,-4737.936 1969.56,-4734.4361 1969.56,-4741.4361"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M401.3646,-5338.1203C409.6785,-5376.0771 441.8928,-5501.3095 516.9653,-5567.936 541.1724,-5589.4196 556.1238,-5578.835 585.7192,-5591.936"/>
<path fill="none" stroke="#54ff00" stroke-dasharray="5,2" d="M585.7192,-5591.936C648.4946,-5619.7245 1672.7382,-5165.2055 1732.2239,-5130.936 1749.7876,-5120.8176 1750.5454,-5112.8524 1768.2239,-5102.936 1794.538,-5088.1756 1805.7868,-5094.3471 1831.7252,-5078.936"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2017.3916,-5422.936C2102.787,-5365.5763 2121.2973,-5345.7089 2191.9479,-5270.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M950.2255,-5648.936C1298.3929,-5630.6852 1444.5854,-5783.9583 1732.2239,-5586.936 1761.4131,-5566.9424 1741.8449,-5539.5136 1768.2239,-5515.936 1812.2894,-5476.5501 1968.3301,-5455.8903 2017.3916,-5422.936"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge365" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M416.4223,-5315.8048C436.2487,-5301.9433 467.6766,-5276.2315 480.9653,-5244.936 523.4008,-5144.9983 499.1701,-3398.0417 516.9653,-3290.936 529.1255,-3217.7465 561.146,-3135.2337 576.82,-3097.6149"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="580.1129,-3098.814 580.7774,-3088.2401 573.6639,-3096.0918 580.1129,-3098.814"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412.1271,-5337.9528C432.7727,-5354.5895 474.962,-5385.4048 516.9653,-5396.936 658.0349,-5435.664 1044.2177,-5394.1557 1170.8643,-5320.936 1305.3681,-5243.1737 1519.7781,-4895.7785 1651.214,-4812.936"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-5591.936C732.7361,-5664.5495 786.6063,-5659.6805 950.2255,-5648.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-5648.936C1137.5703,-5628.6062 1570.6689,-5417.9481 1732.2239,-5320.936 1914.8369,-5211.2787 1982.1497,-5192.9577 2103.5566,-5017.936 2157.9568,-4939.5121 2181.2502,-4824.8072 2188.8817,-4778.0003"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2192.342,-4778.5253 2190.4231,-4768.1057 2185.4255,-4777.4478 2192.342,-4778.5253"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.5433,-5338.0752C406.569,-5379.6276 433.2671,-5527.2246 516.9653,-5605.936 606.2839,-5689.9329 920.5524,-5757.0799 1041.5442,-5776.936 1193.2316,-5801.8295 1599.5343,-5892.5391 1732.2239,-5814.936 1760.3953,-5798.46 1744.4389,-5773.2823 1768.2239,-5750.936 1888.8535,-5637.6026 1959.7693,-5670.9186 2103.5566,-5588.936 2132.5143,-5572.4253 2340.3926,-5453.6057 2353.4509,-5422.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2353.4509,-5422.936C2463.7114,-5173.8439 2539.5614,-3088.1076 2547.7743,-2853.3965"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2551.2823,-2853.2255 2548.1323,-2843.1098 2544.2865,-2852.982 2551.2823,-2853.2255"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M439.5672,-5332.075C539.7377,-5343.1107 805.5418,-5362.0699 1005.5442,-5282.936 1184.7904,-5212.0145 1249.9406,-5185.5001 1351.9497,-5021.936 1396.7383,-4950.1207 1339.1375,-4904.0795 1387.9497,-4834.936 1431.4385,-4773.3331 1487.5269,-4808.1596 1534.2041,-4748.936 1545.8877,-4734.1119 1729.1815,-4117.564 1732.2239,-4098.936 1824.1011,-3536.387 1699.1605,-3382.7389 1768.2239,-2816.936 1780.7499,-2714.3161 1812.441,-2594.4988 1825.723,-2546.9336"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1829.1291,-2547.7503 1828.4739,-2537.1758 1822.3917,-2545.8509 1829.1291,-2547.7503"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1500.2941,-4876.9051C1511.5283,-4873.1166 1523.5983,-4868.4232 1534.2041,-4862.936 1551.7335,-4853.8667 1552.4908,-4845.6405 1570.2041,-4836.936 1603.9059,-4820.3745 1619.4463,-4832.9587 1651.214,-4812.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-4812.936C1693.9079,-4786.0265 1747.9129,-4765.072 1785.6807,-4752.2345"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1787.0211,-4755.477 1795.3971,-4748.989 1784.8033,-4748.8376 1787.0211,-4755.477"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1469.2187,-4876.7714C1485.2402,-4854.0688 1520.4926,-4800.3098 1534.2041,-4748.936 1589.4839,-4541.8145 1543.4098,-3997.6264 1570.2041,-3784.936 1587.3698,-3648.6767 1629.6354,-3488.6087 1645.272,-3432.0305"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1648.7173,-3432.7049 1648.0289,-3422.1325 1641.974,-3430.8266 1648.7173,-3432.7049"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1518.789,-4887.958C1600.8617,-4884.681 1750.3452,-4865.9048 1831.7252,-4776.936"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1672.727,-3422.1117C1695.8405,-3433.7763 1733.8891,-3451.9991 1768.2239,-3463.936 1876.0134,-3501.4104 1929.6425,-3452.977 2017.3916,-3525.936"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1653.6903,-3422.1379C1665.0397,-3473.9998 1712.3787,-3696.1114 1732.2239,-3880.936 1742.1024,-3972.9381 1714.4985,-4637.5997 1768.2239,-4712.936 1770.4897,-4716.1133 1773.2237,-4718.8868 1776.2679,-4721.3079"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1774.6465,-4724.4278 1784.9419,-4726.9288 1778.4532,-4718.5534 1774.6465,-4724.4278"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1657.2199,-3421.9489C1683.2925,-3469.7578 1786.8772,-3659.6991 1820.8624,-3722.0171"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1817.8361,-3723.7781 1825.6967,-3730.8817 1823.9816,-3720.4265 1817.8361,-3723.7781"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1831.7252,-3449.936C1886.8911,-3426.5236 1882.7516,-3394.1722 1931.2266,-3358.936 2039.0052,-3280.5921 2059.4683,-3196.6828 2191.9479,-3210.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1692.0855,-3421.9886C1741.1531,-3434.9096 1818.5236,-3454.0463 1831.7252,-3449.936"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1665.0353,-3399.8666C1681.6898,-3386.2604 1710.1805,-3362.1157 1732.2239,-3338.936 2036.1939,-3019.2957 2124.4082,-2941.907 2353.4509,-2564.936"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1670.8846,-3399.7831C1690.2707,-3387.5949 1718.8689,-3366.1276 1732.2239,-3338.936 1783.4829,-3234.5688 1751.7851,-2932.0436 1768.2239,-2816.936 1782.8397,-2714.5928 1813.3564,-2594.62 1826.0237,-2546.9734"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1829.4355,-2547.7633 1828.643,-2537.1982 1822.674,-2545.9515 1829.4355,-2547.7633"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1651.214,-3324.936C1754.4132,-3294.2052 1842.2351,-3364.2206 2017.3916,-3525.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2017.3916,-3525.936C2111.9723,-3605.2407 2133.0025,-3633.4916 2191.9479,-3741.936"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1534.2426,-3339.7107C1582.0901,-3339.5273 1638.079,-3343.6701 1651.214,-3362.936"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1492.0489,-3354.0127C1524.3675,-3365.571 1575.1847,-3383.7451 1610.6786,-3396.439"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1609.6607,-3399.792 1620.2553,-3399.864 1612.018,-3393.2009 1609.6607,-3399.792"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.9479,-3210.936C2263.7263,-3210.6276 2287.2195,-3238.6061 2353.4509,-3210.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1651.214,-3324.936C1781.1406,-3294.0532 1800.2162,-3241.8388 1931.2266,-3215.936 2044.923,-3193.4564 2076.0515,-3211.4339 2191.9479,-3210.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1534.623,-3335.4895C1569.8743,-3332.0441 1612.7102,-3328.0377 1651.214,-3324.936"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1466.0303,-3331.6695C1493.2436,-3271.0458 1630.7061,-2980.8201 1831.7252,-2830.936"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1463.9322,-3331.6416C1475.0073,-3288.4998 1517.1545,-3130.335 1570.2041,-3006.936 1650.3682,-2820.4655 1778.7579,-2610.4082 1819.1436,-2545.8552"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1822.2956,-2547.4171 1824.649,-2537.087 1816.3673,-2543.6948 1822.2956,-2547.4171"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1463.4769,-1927.1606C1474.0728,-1977.2598 1516.9025,-2185.5778 1534.2041,-2358.936 1539.8241,-2415.2471 1538.046,-3330.3701 1570.2041,-3376.936 1575.5508,-3384.6782 1583.0246,-3390.6634 1591.2899,-3395.2888"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1589.9848,-3398.5465 1600.5061,-3399.7929 1593.0585,-3392.2574 1589.9848,-3398.5465"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1487.7096,-1904.9129C1537.2843,-1883.9757 1646.4684,-1835.8821 1732.2239,-1783.936 1858.6238,-1707.3697 1878.8195,-1561.5831 2017.3916,-1612.936"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1467.7018,-1904.5675C1482.7162,-1879.7982 1521.8193,-1820.6458 1570.2041,-1788.936 1576.3824,-1784.8869 1583.2518,-1781.4646 1590.3038,-1778.5789"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1591.8391,-1781.7419 1599.9857,-1774.968 1589.393,-1775.1831 1591.8391,-1781.7419"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1106.2042,-4046.936C1151.0501,-4052.3244 1161.8036,-4057.8174 1206.8643,-4060.936 1271.1928,-4065.388 1287.5985,-4065.047 1351.9497,-4060.936 1400.7487,-4057.8185 1412.202,-4048.4554 1461.0769,-4046.936"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1106.2042,-4046.936C1140.1568,-4051.5761 1148.9039,-4031.2428 1170.8643,-4004.936 1197.418,-3973.1266 1179.6643,-3950.1946 1206.8643,-3918.936 1256.0702,-3862.3878 1311.2658,-3895.8942 1351.9497,-3832.936 1429.8668,-3712.3594 1297.3807,-3623.3228 1387.9497,-3511.936 1431.1099,-3458.8552 1470.4507,-3488.7526 1534.2041,-3463.936 1563.6114,-3452.4889 1596.2593,-3437.5033 1619.5803,-3426.3886"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1621.1538,-3429.5157 1628.6557,-3422.0343 1618.1257,-3423.2045 1621.1538,-3429.5157"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1000.5848,-4034.3794C1031.2043,-4037.3404 1071.0505,-4041.6549 1106.2042,-4046.936"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-4046.936C1136.5176,-4051.4899 1149.4305,-4049.0218 1170.8643,-4070.936 1205.0656,-4105.904 1169.1893,-4143.7416 1206.8643,-4174.936 1320.1208,-4268.7111 1399.3229,-4164.3879 1534.2041,-4222.936 1637.4847,-4267.7671 1645.5576,-4309.0635 1732.2239,-4380.936 1916.1758,-4533.4876 1939.4302,-4601.3231 2139.5566,-4731.936 2144.693,-4735.2882 2150.3482,-4738.4595 2155.9852,-4741.3465"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2154.8377,-4744.6808 2165.36,-4745.9182 2157.9059,-4738.389 2154.8377,-4744.6808"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.2042,-4046.936C1248.4871,-4053.946 1605.5651,-3974.1366 1732.2239,-3908.936 1818.9604,-3864.2863 1849.3155,-3848.0114 1895.2266,-3761.936 1948.0572,-3662.8875 1872.8151,-3607.7993 1931.2266,-3511.936 2051.1422,-3315.1334 2140.8043,-3299.7753 2353.4509,-3210.936"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M849.4208,-3526.9521C894.6814,-3522.4468 953.5274,-3516.101 1005.5442,-3508.936 1160.1851,-3487.6349 1203.0666,-3497.8547 1351.9497,-3450.936 1403.1913,-3434.7878 1407.8371,-3391.7256 1461.0769,-3398.936"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M844.7198,-3544.9784C849.5867,-3546.4339 854.3603,-3548.0784 858.9067,-3549.936 876.7079,-3557.209 878.1589,-3564.4868 894.9067,-3573.936 942.2272,-3600.6344 956.393,-3602.7802 1005.5442,-3625.936 1021.551,-3633.477 1024.9087,-3636.9071 1041.5442,-3642.936 1222.6662,-3708.5761 1275.1841,-3701.3624 1461.0769,-3751.936"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1461.0769,-3449.936C1733.2261,-3512.4669 1739.5362,-3714.1565 2017.3916,-3741.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2017.3916,-3741.936C2056.032,-3745.3432 2171.7587,-3708.8137 2191.9479,-3741.936"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge334" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1119.6965,-3411.0383C1133.6068,-3422.9248 1155.3895,-3442.8063 1170.8643,-3462.936 1190.7548,-3488.8098 1189.3182,-3499.4183 1206.8643,-3526.936 1225.5691,-3556.271 1249.4711,-3588.6966 1264.6149,-3608.6971"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1261.8739,-3610.8748 1270.7173,-3616.7097 1267.4428,-3606.6336 1261.8739,-3610.8748"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1143.2751,-3411.0002C1178.0549,-3420.6257 1231.7133,-3433.5497 1279.407,-3436.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1279.407,-3436.936C1361.6895,-3442.778 1379.3336,-3387.8653 1461.0769,-3398.936"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1651.214,-3798.936C1699.0444,-3785.9358 1753.1703,-3768.4695 1789.5725,-3756.3116"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1790.9824,-3759.5304 1799.3498,-3753.0314 1788.7559,-3752.8939 1790.9824,-3759.5304"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1139.4991,-3410.9419C1149.8031,-3414.838 1161.0265,-3419.5972 1170.8643,-3424.936 1188.211,-3434.3498 1190.3584,-3440.1153 1206.8643,-3450.936 1269.5536,-3492.0331 1300.7064,-3482.2273 1351.9497,-3536.936 1425.2056,-3615.1459 1357.2343,-3725.4798 1461.0769,-3751.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1461.0769,-3751.936C1545.0728,-3774.7877 1567.2126,-3821.7673 1651.214,-3798.936"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1461.0769,-3449.936C1623.6898,-3476.2776 1674.4398,-3498.9067 1831.7252,-3449.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1279.407,-3436.936C1360.1524,-3442.6689 1381.5994,-3434.5732 1461.0769,-3449.936"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1831.7252,-2830.936C1976.4814,-2722.2705 2012.0928,-2661.2996 2191.9479,-2640.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1121.8157,-3388.7632C1182.1006,-3344.9636 1402.8731,-3178.4267 1534.2041,-2996.936 1556.3508,-2966.3307 1542.0717,-2945.1497 1570.2041,-2919.936 1661.6345,-2837.9914 1726.6448,-2894.4383 1831.7252,-2830.936"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1112.5791,-3388.8567C1128.1704,-3361.8733 1169.6744,-3290.724 1206.8643,-3232.936 1283.8641,-3113.2884 1283.8978,-3065.981 1387.9497,-2968.936 1443.0948,-2917.5044 1481.7491,-2937.1086 1534.2041,-2882.936 1557.4472,-2858.9318 1548.1959,-2842.0772 1570.2041,-2816.936 1688.1333,-2682.2188 1782.5348,-2718.0639 1895.2266,-2578.936 1919.7673,-2548.6383 1909.1562,-2531.0778 1931.2266,-2498.936 1949.6753,-2472.0686 1976.9304,-2446.1789 1995.8273,-2429.7319"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1998.2843,-2432.2361 2003.6118,-2423.0781 1993.7361,-2426.915 1998.2843,-2432.2361"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1108.5962,-3388.6651C1118.2708,-3342.5784 1154.7534,-3163.8528 1170.8643,-3014.936 1179.623,-2933.9768 1157.5689,-2347.7517 1206.8643,-2282.936 1247.9801,-2228.875 1297.6669,-2275.7584 1351.9497,-2234.936 1466.4861,-2148.8011 1458.1187,-2090.3807 1534.2041,-1968.936 1575.7458,-1902.6287 1620.4114,-1821.1921 1640.4317,-1784.0808"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1643.5343,-1785.7011 1645.1886,-1775.2361 1637.3694,-1782.3854 1643.5343,-1785.7011"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge360" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M402.3233,-2443.1312C424.1803,-2518.6676 550.1294,-2953.9396 579.5669,-3055.6739"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="576.249,-3056.7995 582.3907,-3065.4326 582.9731,-3054.8538 576.249,-3056.7995"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M416.0075,-2420.7251C438.6757,-2405.8453 480.2979,-2378.9993 516.9653,-2357.936 665.7083,-2272.4918 733.2519,-2295.7094 858.9067,-2178.936 881.1311,-2158.2824 870.4199,-2138.8493 894.9067,-2120.936 915.3756,-2105.962 926.5168,-2115.941 950.2255,-2106.936"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge361" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M403.5065,-2176.0694C417.0444,-2210.5524 458.3695,-2318.8648 480.9653,-2411.936 541.5364,-2661.4255 575.2881,-2972.3902 583.6484,-3055.6304"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="580.1904,-3056.2285 584.6597,-3065.8345 587.1563,-3055.5381 580.1904,-3056.2285"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.2255,-2106.936C985.1445,-2093.1608 1247.2593,-2050.3169 1279.407,-2030.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1279.407,-2030.936C1307.8753,-2013.605 1326.01,-2032.8629 1351.9497,-2011.936 1379.486,-1989.721 1361.2454,-1964.1444 1387.9497,-1940.936 1392.1904,-1937.2504 1397.0004,-1934.1017 1402.0799,-1931.4128"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1403.8598,-1934.445 1411.4496,-1927.0527 1400.9065,-1928.0985 1403.8598,-1934.445"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M443.6721,-2161.5337C566.3945,-2151.9883 903.1898,-2124.5084 950.2255,-2106.936"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1301.1296,-1980.8646C1322.8214,-1970.0158 1357.2598,-1953.3483 1387.9497,-1940.936 1397.089,-1937.2397 1407.0061,-1933.6057 1416.5017,-1930.3028"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1417.8626,-1933.5366 1426.1943,-1926.9919 1415.5998,-1926.9124 1417.8626,-1933.5366"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1287.5652,-2003.0906C1303.6052,-2025.7753 1338.8263,-2079.5035 1351.9497,-2130.936 1404.9777,-2338.7591 1355.8956,-3848.863 1387.9497,-4060.936 1401.3041,-4149.2896 1436.8884,-4250.1939 1452.9775,-4292.9915"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1449.7968,-4294.4742 1456.6225,-4302.5772 1456.3397,-4291.9862 1449.7968,-4294.4742"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M821.0277,-1430.9167C834.2809,-1434.6182 848.0582,-1440.2795 858.9067,-1448.936 884.4165,-1469.2913 875.9323,-1486.383 894.9067,-1512.936 937.8484,-1573.0289 958.3711,-1580.1043 1005.5442,-1636.936 1108.9377,-1761.4989 1225.0799,-1917.9626 1265.0219,-1972.2897"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1262.4326,-1974.6771 1271.1717,-1980.667 1268.0754,-1970.5347 1262.4326,-1974.6771"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M820.8321,-1427.2832C867.5417,-1430.9647 941.7774,-1437.6201 1005.5442,-1446.936 1209.5805,-1476.7441 1256.5289,-1508.8701 1461.0769,-1534.936"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1461.0769,-1534.936C1503.2804,-1537.7921 1623.2038,-1512.2387 1651.214,-1543.936"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M859.0748,-3356.1841C911.5528,-3352.8576 980.4425,-3348.9434 1041.5442,-3346.936 1158.1955,-3343.1034 1293.1818,-3342.5015 1377.8488,-3342.5875"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1377.9152,-3346.0875 1387.92,-3342.6012 1377.9248,-3339.0875 1377.9152,-3346.0875"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2225.8652,-4745.8887C2232.7404,-4742.3417 2239.3747,-4737.7687 2244.3391,-4731.936 2281.2577,-4688.5601 2258.8963,-4661.7058 2280.3391,-4608.936 2298.1563,-4565.0886 2325.6695,-4516.8735 2341.3712,-4490.6348"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2344.406,-4492.3801 2346.5818,-4482.0111 2338.4147,-4488.76 2344.406,-4492.3801"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2235.9464,-4759.1815C2273.0354,-4758.4755 2324.5533,-4750.9088 2353.4509,-4717.936"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1894.6167,-3738.8337C1930.6454,-3737.8317 1976.6578,-3737.8635 2017.3916,-3741.936"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1832.0043,-3730.762C1834.0314,-3658.5078 1848.8536,-3250.2951 1931.2266,-2930.936 1982.4425,-2732.3721 2055.7733,-2702.3537 2103.5566,-2502.936 2124.8689,-2413.992 2086.8314,-2167.6707 2139.5566,-2092.936 2154.3212,-2072.0081 2171.0006,-2083.673 2191.9479,-2068.936"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1864.415,-5524.865C1874.5339,-5520.9658 1885.5581,-5516.2213 1895.2266,-5510.936 1912.5444,-5501.4691 1915.2164,-5496.4775 1931.2266,-5484.936 1969.4979,-5457.3468 1978.2274,-5449.2424 2017.3916,-5422.936"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M2353.4509,-5384.936C2476.228,-5291.8854 2351.0505,-5162.2263 2462.5627,-5055.936 2491.2724,-5028.5708 2512.8196,-5049.2256 2548.515,-5031.936"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1870.063,-5524.8522C1990.471,-5490.0399 2353.1376,-5385.1735 2353.4509,-5384.936"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1833.0543,-5524.924C1840.6679,-5461.3518 1878.9756,-5134.7796 1895.2266,-4866.936 1931.7112,-4265.6071 1899.6932,-4113.5449 1931.2266,-3511.936 1954.0797,-3075.9328 2004.5402,-2544.3558 2015.3342,-2432.9957"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2018.8189,-2433.3218 2016.3032,-2423.03 2011.8517,-2432.6443 2018.8189,-2433.3218"/>
</g>
<!-- sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2017.3916,-5270.936C2094.971,-5271.3538 2135.5505,-5324.2097 2191.9479,-5270.936"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M960.2195,-4937.0239C993.1387,-4973.1718 1102.0611,-5089.8264 1206.8643,-5168.936 1266.6926,-5214.0967 1299.9006,-5200.9933 1351.9497,-5254.936 1375.1506,-5278.981 1359.2177,-5303.8797 1387.9497,-5320.936 1453.7366,-5359.9892 1659.8595,-5345.7648 1732.2239,-5320.936 1751.3965,-5314.3577 1749.3594,-5300.3518 1768.2239,-5292.936 1871.6884,-5252.2628 1906.2212,-5270.3372 2017.3916,-5270.936"/>
</g>
<!-- sourcefile~datagenerators.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge336" class="edge">
<title>sourcefile~datagenerators.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M956.1845,-4914.8169C968.1887,-4891.7632 995.0296,-4836.745 1005.5442,-4786.936 1027.683,-4682.0615 997.6559,-3920.7246 1041.5442,-3822.936 1057.8465,-3786.6124 1082.7984,-3793.1437 1106.2042,-3760.936"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M2561.9287,-2820.7981C2581.4978,-2803.7014 2617.3963,-2768.9541 2634.4673,-2730.936 2681.4259,-2626.3564 2708.819,-2258.709 2715.0692,-2166.191"/>
<polygon fill="#0054ff" stroke="#0054ff" points="2718.5696,-2166.2996 2715.7408,-2156.0894 2711.585,-2165.8352 2718.5696,-2166.2996"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M2580.4976,-2097.9819C2607.2591,-2107.2246 2645.6357,-2120.4787 2674.7953,-2130.5497"/>
<polygon fill="#0054ff" stroke="#0054ff" points="2673.706,-2133.8763 2684.3008,-2133.8326 2675.9912,-2127.2598 2673.706,-2133.8763"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M1875.2665,-442.9899C1912.6725,-451.9124 1968.1936,-463.7968 2017.3916,-468.936"/>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M2017.3916,-468.936C2096.1762,-477.1657 2113.1512,-441.0497 2191.9479,-432.936"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2353.4509,-546.936C2380.1969,-570.5079 2406.0293,-550.7922 2426.5627,-579.936 2516.2031,-707.1652 2544.4217,-1892.1282 2548.0877,-2065.7441"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2544.5914,-2065.9655 2548.298,-2075.8908 2551.5899,-2065.8203 2544.5914,-2065.9655"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2191.9479,-508.936C2264.5556,-521.8042 2298.1302,-498.1805 2353.4509,-546.936"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2017.3916,-468.936C2096.5523,-477.205 2113.5778,-495.0465 2191.9479,-508.936"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1832.5461,-443.1499C1839.1018,-532.393 1883.9352,-1136.8591 1931.2266,-1626.936 1960.5255,-1930.5589 2003.9786,-2299.3468 2014.8542,-2390.7064"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2011.4078,-2391.3642 2016.0672,-2400.8795 2018.3585,-2390.5354 2011.4078,-2391.3642"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#0054ff" stroke-dasharray="5,2" d="M2032.6504,-534.9059C2071.6946,-506.8498 2173.4538,-434.8403 2191.9479,-432.936"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2074.7365,-546.1725C2166.5562,-550.0225 2344.5563,-572.4951 2426.5627,-684.936 2496.0397,-780.1974 2390.9869,-2713.2413 2462.5627,-2806.936 2464.9183,-2810.0195 2467.6321,-2812.7393 2470.6117,-2815.1371"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2468.7931,-2818.1311 2479.0565,-2820.7605 2472.673,-2812.3047 2468.7931,-2818.1311"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2354.7475,-2079.0654C2365.2978,-2169.2623 2437.3108,-2777.9796 2462.5627,-2806.936 2465.4355,-2810.2301 2468.7144,-2813.1022 2472.2757,-2815.6052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2470.6524,-2818.7117 2481.0392,-2820.8007 2474.2221,-2812.6903 2470.6524,-2818.7117"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2400.1736,-2072.487C2419.4287,-2074.3625 2442.3494,-2076.595 2464.3459,-2078.7376"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2464.0786,-2082.228 2474.3709,-2079.714 2464.7573,-2075.261 2464.0786,-2082.228"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2353.4509,-4717.936C2385.4149,-4681.4644 2407.6391,-4681.5876 2426.5627,-4636.936 2499.6764,-4464.4195 2542.4474,-3045.2153 2547.9164,-2853.3668"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2551.4206,-2853.2619 2548.2048,-2843.1669 2544.4234,-2853.064 2551.4206,-2853.2619"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1526.4667,-4314.6588C1648.8347,-4318.8427 1916.9024,-4341.6244 2103.5566,-4456.936 2176.7858,-4502.1756 2186.6989,-4526.0085 2244.3391,-4589.936 2261.959,-4609.4778 2263.5103,-4616.7089 2280.3391,-4636.936 2311.356,-4674.2162 2321.487,-4754.4075 2353.4509,-4717.936"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2204.209,-4291.292C2216.2013,-4303.0776 2234.1091,-4322.604 2244.3391,-4342.936 2274.7658,-4403.4085 2227.1139,-4449.1055 2280.3391,-4490.936 2331.4356,-4531.0935 2378.9544,-4535.1731 2426.5627,-4490.936 2489.6684,-4432.2989 2541.0889,-3041.5277 2547.7781,-2853.0142"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2551.2769,-2853.105 2548.1317,-2842.9878 2544.2813,-2852.8582 2551.2769,-2853.105"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2192.3103,-4268.8141C2197.7531,-4102.0792 2262.9268,-2116.2807 2280.3391,-2092.936 2284.8054,-2086.948 2290.7882,-2082.3821 2297.4164,-2078.903"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2299.0198,-2082.0217 2306.773,-2074.801 2296.2092,-2075.6107 2299.0198,-2082.0217"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.9479,-859.936C2458.6759,-824.2932 2399.3383,-1780.2177 2426.5627,-2047.936 2435.1042,-2131.9309 2410.295,-2740.6322 2462.5627,-2806.936 2465.0882,-2810.1397 2467.9995,-2812.9492 2471.1909,-2815.4117"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2469.3365,-2818.3804 2479.6407,-2820.845 2473.1225,-2812.4926 2469.3365,-2818.3804"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1695.1878,-805.869C1792.3159,-790.4294 2029.4052,-766.0155 2191.9479,-859.936"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1672.8026,-825.053C1706.0317,-841.6642 1772.1233,-872.7381 1831.7252,-888.936"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2020.2217,-2423.3686C2037.7797,-2491.3143 2138.1878,-2838.812 2353.4509,-2830.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2353.4509,-2830.936C2385.6753,-2829.9557 2420.9075,-2829.8427 2452.4545,-2830.0876"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2452.5278,-2833.5883 2462.5591,-2830.1791 2452.5912,-2826.5886 2452.5278,-2833.5883"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2018.5129,-2400.7023C2024.4182,-2348.5993 2056.9733,-2131.95 2191.9479,-2106.936"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1657.7161,-1752.5525C1678.2119,-1718.2948 1745.2659,-1618.1852 1831.7252,-1612.936"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M421.8572,-916.8764C440.1759,-906.9182 465.3526,-890.6721 480.9653,-869.936 510.1337,-831.1957 479.1821,-797.3339 516.9653,-766.936 577.487,-718.2441 613.3453,-755.1589 690.4731,-745.936 1150.3414,-690.9451 1308.5349,-532.8785 1732.2239,-719.936 1751.5397,-728.4639 1749.9257,-740.4002 1768.2239,-750.936 1789.8169,-763.3688 2175.422,-879.2884 2191.9479,-897.936"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.9479,-897.936C2202.1473,-909.0456 2330.1032,-1888.6712 2350.6696,-2046.5629"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2347.2465,-2047.3803 2352.0084,-2056.8447 2354.1879,-2046.4765 2347.2465,-2047.3803"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1651.214,-1543.936C1672.9994,-1574.5217 1708.9405,-1538.4745 1732.2239,-1567.936 1822.7485,-1682.4805 1699.563,-2095.0917 1768.2239,-2223.936 1815.202,-2312.0919 1923.7167,-2370.7684 1980.7899,-2396.7115"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1979.598,-2400.0121 1990.1568,-2400.8848 1982.4468,-2393.618 1979.598,-2400.0121"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M967.9217,-1091.1497C1074.4363,-1158.7075 1626.4943,-1509.7497 1651.214,-1543.936"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1849.8657,-2514.7976C1882.8109,-2494.5691 1952.5994,-2451.7187 1990.8854,-2428.2109"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1992.7603,-2431.1669 1999.4508,-2422.9517 1989.0976,-2425.2016 1992.7603,-2431.1669"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge355" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M456.1532,-1146.8209C465.0625,-1143.3706 473.7072,-1138.8522 480.9653,-1132.936 506.8646,-1111.8251 491.238,-1088.2561 516.9653,-1066.936 536.4422,-1050.7956 925.8639,-920.1263 950.2255,-926.936"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~EfferentGraph_edge359" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M449.9049,-1187.8936C460.3223,-1185.0775 471.1107,-1181.7484 480.9653,-1177.936 579.2432,-1139.9154 588.6584,-1094.0994 690.4731,-1066.936 811.5171,-1034.6423 959.4612,-1051.1783 1042.2338,-1065.1874"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1041.793,-1068.6631 1052.2441,-1066.9234 1042.9892,-1061.7661 1041.793,-1068.6631"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileelectricpowermanagerf90EfferentGraph = svgPanZoom('#sourcefileelectricpowermanagerf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~electricpowermanager.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileelectricpowermanagerf90AfferentGraph" width="641pt" height="214pt"
 viewBox="0.00 0.00 641.00 214.05" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph" class="graph" transform="scale(.2497 .2497) rotate(0) translate(4 853.0935)">
<title>sourcefile~~electricpowermanager.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-853.0935 2562.6177,-853.0935 2562.6177,4 -4,4"/>
<!-- sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~electricpowermanager.f90</title>
<polygon fill="none" stroke="#000000" points="134.3481,-519.4175 .2168,-519.4175 .2168,-497.4066 134.3481,-497.4066 134.3481,-519.4175"/>
<text text-anchor="middle" x="67.2825" y="-505.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">ElectricPowerManager.f90</text>
</g>
<!-- sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~outputreporttabular.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/outputreporttabular.f90.html" xlink:title="OutputReportTabular.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="297.1852,-500.4175 170.3577,-500.4175 170.3577,-478.4066 297.1852,-478.4066 297.1852,-500.4175"/>
<text text-anchor="middle" x="233.7715" y="-486.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportTabular.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M134.52,-500.7388C143.0174,-499.7691 151.746,-498.773 160.3335,-497.7929"/>
<polygon fill="#ff0000" stroke="#ff0000" points="160.7886,-501.2638 170.3273,-496.6524 159.9949,-494.3089 160.7886,-501.2638"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2426.2003,-573.4175 2306.3898,-573.4175 2306.3898,-551.4066 2426.2003,-551.4066 2426.2003,-573.4175"/>
<text text-anchor="middle" x="2366.295" y="-559.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M233.7715,-528.4121C396.5432,-531.8948 388.5553,-673.6428 543.2461,-724.4121 1056.5237,-892.8689 1220.0404,-860.7029 1756.5344,-797.4121 1989.8361,-769.8892 2070.2299,-797.0574 2270.5928,-674.4121 2308.5048,-651.2055 2339.0492,-607.8881 2354.7561,-582.4619"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2357.8867,-584.0473 2360.0339,-573.6723 2351.8854,-580.4438 2357.8867,-584.0473"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~heatbalanceinternalheatgains.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/heatbalanceinternalheatgains.f90.html" xlink:title="HeatBalanceInternalHeatGains.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="507.3803,-539.4175 332.8438,-539.4175 332.8438,-517.4066 507.3803,-517.4066 507.3803,-539.4175"/>
<text text-anchor="middle" x="420.1121" y="-525.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceInternalHeatGains.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M233.7715,-528.4121C262.7006,-529.1598 294.1645,-529.385 322.8595,-529.3615"/>
<polygon fill="#ff0000" stroke="#ff0000" points="322.8915,-532.8616 332.8851,-529.3433 322.8787,-525.8616 322.8915,-532.8616"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1531.7467,-402.4175 1433.1886,-402.4175 1433.1886,-380.4066 1531.7467,-380.4066 1531.7467,-402.4175"/>
<text text-anchor="middle" x="1482.4677" y="-388.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M233.7715,-528.4121C326.4752,-530.8082 464.4671,-428.4639 507.2461,-388.4121 528.3023,-368.6982 518.2449,-348.7975 543.2461,-334.4121 662.4131,-265.8447 715.9342,-295.7356 852.0044,-315.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M133.9042,-519.447C164.2682,-523.6938 200.7368,-527.7053 233.7715,-528.4121"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.0405,-277.4121C700.3664,-260.2583 963.4171,-211.2011 1059.3347,-200.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2221.1034,-7.4121C2242.9982,-16.1136 2255.5873,-8.2479 2270.5928,-26.4121 2337.4962,-107.3986 2360.366,-451.7773 2365.2324,-541.1524"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2361.7504,-541.5891 2365.7707,-551.3915 2368.7408,-541.2215 2361.7504,-541.5891"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M420.1121,-374.4121C482.4551,-352.7535 481.7675,-315.415 543.2461,-291.4121 581.6893,-276.4028 594.7456,-286.327 635.0405,-277.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2065.4194,-46.4121C2135.7959,-34.7826 2154.8156,18.9323 2221.1034,-7.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1672.897,-124.4121C1764.6563,-120.0147 1784.9947,-98.7922 1875.8796,-85.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.3347,-200.4121C1328.9964,-147.6322 1398.4336,-137.5653 1672.897,-124.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M240.9552,-478.3601C255.4858,-457.0148 290.6143,-410.2969 332.978,-388.4121 367.8257,-370.41 383.0614,-387.2839 420.1121,-374.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1875.8796,-85.4121C1960.9672,-72.8854 1980.5655,-60.4339 2065.4194,-46.4121"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286.6708,-500.4836C308.697,-505.0935 334.4414,-510.4817 357.4099,-515.2889"/>
<polygon fill="#ff0000" stroke="#ff0000" points="356.8983,-518.7576 367.4032,-517.3804 358.3323,-511.906 356.8983,-518.7576"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.0405,-277.4121C729.7267,-252.5486 755.1159,-301.4015 852.0044,-315.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.3347,-357.4121C1155.7677,-362.2833 1180.8024,-345.2215 1276.5857,-357.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M852.0044,-315.4121C945.0551,-328.8677 965.4359,-352.6688 1059.3347,-357.4121"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2270.5822,-57.4175 2171.6246,-57.4175 2171.6246,-35.4066 2270.5822,-35.4066 2270.5822,-57.4175"/>
<text text-anchor="middle" x="2221.1034" y="-43.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2065.4194,-46.4121C2096.7879,-41.2285 2132.1995,-40.8086 2161.3156,-41.869"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2161.1935,-45.3669 2171.3349,-42.3005 2161.4948,-38.3734 2161.1935,-45.3669"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2130.4248,-556.4175 2000.4141,-556.4175 2000.4141,-534.4066 2130.4248,-534.4066 2130.4248,-556.4175"/>
<text text-anchor="middle" x="2065.4194" y="-542.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.3347,-200.4121C1370.8932,-173.3696 1511.8504,-100.6566 1756.5344,-295.4121 1784.8384,-317.9405 1768.4975,-341.3775 1792.5344,-368.4121 1861.8772,-446.4026 1973.3163,-504.0329 2029.9341,-530.0546"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2028.6382,-533.3099 2039.1912,-534.2512 2031.5285,-526.9345 2028.6382,-533.3099"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~economiclifecyclecost.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/economiclifecyclecost.f90.html" xlink:title="EconomicLifeCycleCost.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2135.8091,-96.4175 1995.0297,-96.4175 1995.0297,-74.4066 2135.8091,-74.4066 2135.8091,-96.4175"/>
<text text-anchor="middle" x="2065.4194" y="-82.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicLifeCycleCost.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1875.8796,-85.4121C1911.2835,-80.1999 1950.8121,-79.416 1984.5721,-80.2387"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1984.7541,-83.7455 1994.8531,-80.5425 1984.9609,-76.7486 1984.7541,-83.7455"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~roomairmodelusertemppattern.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/roomairmodelusertemppattern.f90.html" xlink:title="RoomAirModelUserTempPattern.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="725.192,-481.4175 544.8891,-481.4175 544.8891,-459.4066 725.192,-459.4066 725.192,-481.4175"/>
<text text-anchor="middle" x="635.0405" y="-467.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUserTempPattern.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M297.3538,-486.4015C360.9892,-483.3883 459.8593,-478.7069 534.2026,-475.1867"/>
<polygon fill="#ff0000" stroke="#ff0000" points="534.7005,-478.6672 544.5238,-474.698 534.3694,-471.675 534.7005,-478.6672"/>
</g>
<!-- sourcefile~economictariff.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~economictariff.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/economictariff.f90.html" xlink:title="EconomicTariff.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1925.0639,-135.4175 1826.6954,-135.4175 1826.6954,-113.4066 1925.0639,-113.4066 1925.0639,-135.4175"/>
<text text-anchor="middle" x="1875.8796" y="-121.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicTariff.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1672.897,-124.4121C1721.1446,-122.0999 1775.9171,-122.2637 1816.3958,-122.9149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1816.568,-126.4184 1826.628,-123.0948 1816.6911,-119.4195 1816.568,-126.4184"/>
</g>
<!-- sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~thermalcomfort.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/thermalcomfort.f90.html" xlink:title="ThermalComfort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687.903,-365.4175 582.1781,-365.4175 582.1781,-343.4066 687.903,-343.4066 687.903,-365.4175"/>
<text text-anchor="middle" x="635.0405" y="-351.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ThermalComfort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M420.1121,-374.4121C468.964,-356.4753 528.0596,-352.1131 571.9107,-351.8764"/>
<polygon fill="#ff0000" stroke="#ff0000" points="572.1441,-355.3767 582.1501,-351.8941 572.1562,-348.3767 572.1441,-355.3767"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1959.0704,-632.4175 1792.6889,-632.4175 1792.6889,-610.4066 1959.0704,-610.4066 1959.0704,-632.4175"/>
<text text-anchor="middle" x="1875.8796" y="-618.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1276.5857,-660.4121C1489.3244,-678.1587 1544.1839,-663.3195 1756.5344,-641.4121 1773.6542,-639.6459 1792.0386,-636.962 1809.125,-634.1286"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1809.7431,-637.5738 1819.0159,-632.4489 1808.5711,-630.6727 1809.7431,-637.5738"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M420.1121,-374.4121C486.0311,-350.2089 666.3943,-414.6625 726.835,-450.4121 747.1383,-462.4212 742.9819,-476.6723 762.835,-489.4121 847.1764,-543.5343 881.6015,-529.2688 977.1738,-559.4121 1049.9766,-582.3739 1069.2318,-584.8067 1141.4956,-609.4121 1202.2467,-630.0975 1212.7161,-654.146 1276.5857,-660.4121"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2558.4286,-643.4175 2462.1864,-643.4175 2462.1864,-621.4066 2558.4286,-621.4066 2558.4286,-643.4175"/>
<text text-anchor="middle" x="2510.3075" y="-629.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2389.1142,-573.5038C2413.2362,-585.2287 2451.4649,-603.8105 2478.5292,-616.9656"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2477.0711,-620.1484 2487.5951,-621.3723 2480.1313,-613.8527 2477.0711,-620.1484"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2552.016,-573.4175 2468.599,-573.4175 2468.599,-551.4066 2552.016,-551.4066 2552.016,-573.4175"/>
<text text-anchor="middle" x="2510.3075" y="-559.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2426.1182,-562.4121C2436.7828,-562.4121 2447.8146,-562.4121 2458.2409,-562.4121"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2458.4295,-565.9122 2468.4294,-562.4121 2458.4294,-558.9122 2458.4295,-565.9122"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M852.0044,-663.4121C874.9918,-658.7193 1037.6948,-632.4761 1059.3347,-623.4121"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1059.3347,-623.4121C1131.6546,-593.1204 1116.5007,-541.6805 1177.4956,-492.4121 1217.0191,-460.4872 1228.7278,-452.4685 1276.5857,-435.4121"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M507.3835,-527.3231C568.7698,-526.8236 652.8372,-526.6742 726.835,-528.4121 854.6123,-531.4129 1748.3962,-591.5786 1875.8796,-582.4121"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1875.8796,-582.4121C1920.2358,-576.539 1969.8545,-566.7343 2007.195,-558.6931"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2008.359,-562.0218 2017.3868,-556.4766 2006.8713,-555.1817 2008.359,-562.0218"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M461.0444,-517.3662C496.0393,-507.9226 546.5527,-494.2911 584.1466,-484.1462"/>
<polygon fill="#00ffff" stroke="#00ffff" points="585.1524,-487.5 593.8951,-481.5155 583.3286,-480.7418 585.1524,-487.5"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1059.3347,-738.4121C1194.5527,-755.9236 1541.1524,-773.5393 1672.897,-738.4121"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~zonetemppredictorcorrector.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/zonetemppredictorcorrector.f90.html" xlink:title="ZoneTempPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1141.6568,-481.4175 977.0126,-481.4175 977.0126,-459.4066 1141.6568,-459.4066 1141.6568,-481.4175"/>
<text text-anchor="middle" x="1059.3347" y="-467.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneTempPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M852.0044,-663.4121C891.7061,-655.3072 907.5509,-667.0265 941.1738,-644.4121 971.0478,-624.3191 1025.0076,-531.9412 1048.2224,-490.5592"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1051.3747,-492.0924 1053.1847,-481.6533 1045.2599,-488.6853 1051.3747,-492.0924"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M487.0317,-539.5801C494.5408,-543.047 501.5299,-547.5557 507.2461,-553.4121 551.5205,-598.7723 493.0866,-652.659 543.2461,-691.4121 652.2834,-775.6539 716.9998,-690.9725 852.0044,-663.4121"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~zonecontaminantpredictorcorrector.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/zonecontaminantpredictorcorrector.f90.html" xlink:title="ZoneContaminantPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1375.766,-523.4175 1177.4054,-523.4175 1177.4054,-501.4066 1375.766,-501.4066 1375.766,-523.4175"/>
<text text-anchor="middle" x="1276.5857" y="-509.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneContaminantPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1059.3347,-623.4121C1129.2844,-594.1132 1207.6631,-551.4984 1248.4608,-528.5275"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1250.3088,-531.5033 1257.2888,-523.5327 1246.8618,-525.4109 1250.3088,-531.5033"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1348.4335,-407.4175 1204.7379,-407.4175 1204.7379,-385.4066 1348.4335,-385.4066 1348.4335,-407.4175"/>
<text text-anchor="middle" x="1276.5857" y="-393.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M433.0149,-517.1297C454.2844,-499.2921 498.7938,-465.0977 543.2461,-450.4121 769.857,-375.5469 1056.5735,-381.2268 1194.763,-389.738"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1194.6529,-393.238 1204.8552,-390.3811 1195.0981,-386.2522 1194.6529,-393.238"/>
</g>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/daylightingmanager.f90.html" xlink:title="DaylightingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1337.913,-710.4175 1215.2584,-710.4175 1215.2584,-688.4066 1337.913,-688.4066 1337.913,-710.4175"/>
<text text-anchor="middle" x="1276.5857" y="-696.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1059.3347,-738.4121C1090.1275,-742.3999 1168.9931,-725.7106 1222.7289,-712.9245"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1223.8806,-716.2475 1232.7859,-710.5076 1222.2448,-709.4413 1223.8806,-716.2475"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M852.0044,-663.4121C948.0147,-643.8121 962.1557,-725.8268 1059.3347,-738.4121"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~roomairmodelcrossvent.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/roomairmodelcrossvent.f90.html" xlink:title="RoomAirModelCrossVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="708.9388,-600.4175 561.1423,-600.4175 561.1423,-578.4066 708.9388,-578.4066 708.9388,-600.4175"/>
<text text-anchor="middle" x="635.0405" y="-586.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelCrossVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M462.5245,-539.5211C476.8408,-543.5509 492.8396,-548.3629 507.2461,-553.4121 523.6039,-559.1451 526.7382,-563.1269 543.2461,-568.4121 551.8216,-571.1576 560.9562,-573.6938 570.0123,-575.9837"/>
<polygon fill="#00ffff" stroke="#00ffff" points="569.2332,-579.3962 579.7782,-578.37 570.8948,-572.5962 569.2332,-579.3962"/>
</g>
<!-- sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~delightmanagerf.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/delightmanagerf.f90.html" xlink:title="DElightManagerF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1114.3877,-673.4175 1004.2817,-673.4175 1004.2817,-651.4066 1114.3877,-651.4066 1114.3877,-673.4175"/>
<text text-anchor="middle" x="1059.3347" y="-659.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DElightManagerF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M852.0044,-663.4121C898.8225,-653.8544 952.836,-653.9402 993.9932,-656.2382"/>
<polygon fill="#00ffff" stroke="#00ffff" points="993.9712,-659.7434 1004.1677,-656.8655 994.4021,-652.7566 993.9712,-659.7434"/>
</g>
<!-- sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~roomairmodelufad.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/roomairmodelufad.f90.html" xlink:title="RoomAirModelUFAD.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="698.5022,-559.4175 571.5789,-559.4175 571.5789,-537.4066 698.5022,-537.4066 698.5022,-559.4175"/>
<text text-anchor="middle" x="635.0405" y="-545.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUFAD.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M507.5317,-536.5468C525.4076,-538.2103 544.0507,-539.9451 561.3868,-541.5583"/>
<polygon fill="#00ffff" stroke="#00ffff" points="561.146,-545.0509 571.4273,-542.4926 561.7946,-538.081 561.146,-545.0509"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~roomairmodeldisplacementvent.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/roomairmodeldisplacementvent.f90.html" xlink:title="RoomAirModelDisplacementVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="726.6299,-682.4175 543.4512,-682.4175 543.4512,-660.4066 726.6299,-660.4066 726.6299,-682.4175"/>
<text text-anchor="middle" x="635.0405" y="-668.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelDisplacementVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M485.1674,-539.5647C493.2549,-543.0189 500.8975,-547.5284 507.2461,-553.4121 540.9733,-584.6697 508.6796,-620.0851 543.2461,-650.4121 545.2354,-652.1574 547.3401,-653.7659 549.5377,-655.248"/>
<polygon fill="#00ffff" stroke="#00ffff" points="548.0133,-658.4088 558.427,-660.3596 551.5028,-652.3405 548.0133,-658.4088"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~roomairmodelmundt.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node30"><a xlink:href="../sourcefile/roomairmodelmundt.f90.html" xlink:title="RoomAirModelMundt.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="699.1763,-641.4175 570.9047,-641.4175 570.9047,-619.4066 699.1763,-619.4066 699.1763,-641.4175"/>
<text text-anchor="middle" x="635.0405" y="-627.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelMundt.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M480.4464,-539.5266C489.973,-542.9769 499.2901,-547.4955 507.2461,-553.4121 530.9886,-571.0685 519.0313,-592.4092 543.2461,-609.4121 548.7295,-613.2624 554.81,-616.4181 561.1557,-619.0029"/>
<polygon fill="#00ffff" stroke="#00ffff" points="560.0096,-622.3102 570.6041,-622.396 562.3755,-615.7221 560.0096,-622.3102"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1531.8452,-380.7765C1606.3855,-366.0778 1752.098,-342.6285 1875.8796,-354.4121"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1744.7345,-326.4175 1601.0594,-326.4175 1601.0594,-304.4066 1744.7345,-304.4066 1744.7345,-326.4175"/>
<text text-anchor="middle" x="1672.897" y="-312.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1503.3172,-380.2645C1524.5394,-369.2036 1558.5868,-352.2383 1589.2595,-340.4121 1599.5446,-336.4466 1610.7368,-332.7163 1621.4904,-329.4078"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1622.632,-332.7195 1631.2043,-326.4932 1620.6202,-326.0148 1622.632,-332.7195"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2224.271,-57.6693C2242.6842,-123.1086 2335.9701,-454.6395 2360.4209,-541.5358"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2357.0913,-542.6248 2363.1692,-551.303 2363.8297,-540.7288 2357.0913,-542.6248"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M2095.8119,-534.4003C2133.9998,-521.1595 2197.4054,-501.3082 2221.1034,-506.4121"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M2072.1822,-534.2862C2085.9412,-511.22 2117.4251,-456.18 2135.614,-406.4121 2181.1024,-281.9485 2208.7917,-124.3133 2217.8302,-67.7851"/>
<polygon fill="#ffda00" stroke="#ffda00" points="2221.3382,-68.0075 2219.4325,-57.5854 2214.423,-66.9211 2221.3382,-68.0075"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M2105.3513,-74.4061C2115.604,-70.7296 2126.3471,-66.0872 2135.614,-60.4121 2173.7377,-37.065 2179.5498,9.0745 2221.1034,-7.4121"/>
</g>
<!-- sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~roomairmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/roomairmanager.f90.html" xlink:title="RoomAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="907.7265,-635.4175 796.2822,-635.4175 796.2822,-613.4066 907.7265,-613.4066 907.7265,-635.4175"/>
<text text-anchor="middle" x="852.0044" y="-621.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M659.8367,-481.4514C679.9362,-491.3975 707.9312,-507.6372 726.835,-528.4121 750.6463,-554.5802 735.4906,-576.9613 762.835,-599.4121 769.8615,-605.1811 778.1346,-609.6214 786.7606,-613.0383"/>
<polygon fill="#00ff91" stroke="#00ff91" points="785.6222,-616.348 796.2171,-616.3589 787.9415,-609.7434 785.6222,-616.348"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1925.0047,-134.6435C1981.1713,-143.4459 2073.366,-148.7443 2135.614,-105.4121 2167.2815,-83.3676 2143.5109,-52.8508 2171.614,-26.4121 2188.7743,-10.2681 2199.2035,1.2768 2221.1034,-7.4121"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1880.9494,-135.6728C1906.645,-192.7472 2022.5896,-450.2797 2056.2383,-525.0191"/>
<polygon fill="#0091ff" stroke="#0091ff" points="2053.1253,-526.6305 2060.4221,-534.3121 2059.5082,-523.7568 2053.1253,-526.6305"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1925.1842,-114.2671C1948.5141,-109.4667 1976.6616,-103.675 2001.5978,-98.5441"/>
<polygon fill="#0091ff" stroke="#0091ff" points="2002.6115,-101.9089 2011.7009,-96.4653 2001.2007,-95.0526 2002.6115,-101.9089"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M688.1802,-362.4706C701.5808,-366.1699 715.396,-371.5605 726.835,-379.4121 749.1151,-394.7048 740.9695,-412.5321 762.835,-428.4121 919.8798,-542.467 986.9186,-528.6425 1177.4956,-565.4121 1430.6739,-614.2598 1500.3625,-572.0644 1756.5344,-601.4121 1773.0413,-603.3031 1790.7392,-605.9345 1807.317,-608.6684"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1807.0312,-612.1694 1817.4735,-610.3781 1808.1933,-605.2666 1807.0312,-612.1694"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M675.7129,-365.4774C691.6558,-369.8179 710.1044,-374.8444 726.835,-379.4121 826.9885,-406.7556 944.0825,-438.8262 1009.1719,-456.6624"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1008.5918,-460.1324 1019.1612,-459.3999 1010.4419,-453.3813 1008.5918,-460.1324"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="941.3436,-368.4175 762.6652,-368.4175 762.6652,-346.4066 941.3436,-346.4066 941.3436,-368.4175"/>
<text text-anchor="middle" x="852.0044" y="-354.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M687.8384,-355.1421C707.309,-355.4113 730.0631,-355.726 752.3199,-356.0337"/>
<polygon fill="#4800ff" stroke="#4800ff" points="752.4501,-359.5358 762.4975,-356.1744 752.5469,-352.5364 752.4501,-359.5358"/>
</g>
<!-- sourcefile~weathermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~weathermanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/weathermanager.f90.html" xlink:title="WeatherManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2120.2982,-174.4175 2010.5407,-174.4175 2010.5407,-152.4066 2120.2982,-152.4066 2120.2982,-174.4175"/>
<text text-anchor="middle" x="2065.4194" y="-160.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WeatherManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M657.0743,-343.3206C682.088,-331.1958 724.4164,-312.077 762.835,-301.4121 1120.1615,-202.2191 1219.8601,-219.0548 1589.2595,-186.4121 1735.7201,-173.4698 1908.2138,-167.414 2000.0766,-164.9196"/>
<polygon fill="#4800ff" stroke="#4800ff" points="2000.4289,-168.4115 2010.3323,-164.6469 2000.2427,-161.414 2000.4289,-168.4115"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1959.1436,-611.9189C2011.3978,-603.9308 2079.3038,-589.767 2135.614,-565.4121 2177.986,-547.0856 2175.9728,-496.6923 2221.1034,-506.4121"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1922.7831,-610.3259C1934.9606,-606.6501 1947.8457,-602.028 1959.2249,-596.4121 1976.9234,-587.6775 1977.7535,-579.5927 1995.2249,-570.4121 2002.5521,-566.5618 2010.6017,-563.0745 2018.5547,-560.0092"/>
<polygon fill="#ff00da" stroke="#ff00da" points="2019.9729,-563.217 2028.1528,-556.4835 2017.5592,-556.6463 2019.9729,-563.217"/>
</g>
<!-- sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M866.9151,-613.3368C902.6166,-586.8185 993.2184,-519.5217 1036.1252,-487.6515"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1038.3398,-490.3665 1044.2806,-481.5939 1034.1658,-484.7471 1038.3398,-490.3665"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1482.4677,-512.4121C1530.6497,-509.212 1541.178,-496.8756 1589.2595,-492.4121 1734.6441,-478.9156 2125.1299,-489.8176 2221.1034,-506.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1141.521,-473.5183C1205.5237,-476.5666 1296.4947,-482.2788 1375.6758,-492.4121 1423.5734,-498.5418 1434.1834,-513.0341 1482.4677,-512.4121"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1276.5857,-435.4121C1318.8256,-420.3579 1331.8158,-425.7468 1375.6758,-416.4121 1392.4101,-412.8505 1410.553,-408.7093 1427.0543,-404.8341"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1428.1621,-408.1688 1437.0893,-402.4632 1426.5525,-401.3564 1428.1621,-408.1688"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1141.5679,-464.3044C1182.9673,-459.4549 1233.4021,-450.8026 1276.5857,-435.4121"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1116.4149,-481.4471C1144.9912,-486.9716 1179.7633,-493.6939 1209.5976,-499.4616"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1209.0274,-502.9161 1219.51,-501.3779 1210.3561,-496.0434 1209.0274,-502.9161"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1104.1464,-459.3611C1116.5237,-455.6204 1129.769,-450.957 1141.4956,-445.4121 1158.8797,-437.192 1159.9183,-429.2105 1177.4956,-421.4121 1187.429,-417.005 1198.2814,-413.2757 1209.0445,-410.1521"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1210.1593,-413.4756 1218.8749,-407.4517 1208.305,-406.7256 1210.1593,-413.4756"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1375.8952,-515.0696C1409.7403,-515.2691 1447.7836,-514.7157 1482.4677,-512.4121"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1295.5855,-501.2456C1332.1257,-479.7703 1412.327,-432.6348 1454.8047,-407.67"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1456.6658,-410.636 1463.5137,-402.5516 1453.119,-404.601 1456.6658,-410.636"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1348.3042,-394.6703C1372.6669,-394.0787 1399.6067,-393.4244 1422.9143,-392.8584"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1423.0908,-396.3552 1433.0029,-392.6134 1422.9208,-389.3573 1423.0908,-396.3552"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1348.3239,-405.8698C1368.7548,-408.1576 1391.0597,-410.271 1411.6758,-411.4121 1565.5436,-419.9284 1608.2649,-417.412 1756.5344,-375.4121 1930.8654,-326.0297 2003.1642,-349.0524 2135.614,-225.4121 2183.0682,-181.1141 2206.9893,-105.0018 2216.3047,-67.9441"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2219.8145,-68.3156 2218.7367,-57.7758 2213.0065,-66.6873 2219.8145,-68.3156"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M941.3493,-355.4414C977.9408,-355.1473 1020.6895,-355.4599 1059.3347,-357.4121"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1136.641,-329.4175 982.0284,-329.4175 982.0284,-307.4066 1136.641,-307.4066 1136.641,-329.4175"/>
<text text-anchor="middle" x="1059.3347" y="-315.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M910.5856,-346.3926C935.4282,-341.7196 964.5608,-336.2396 990.4281,-331.3738"/>
<polygon fill="#ff0000" stroke="#ff0000" points="991.3583,-334.7603 1000.5389,-329.4719 990.0642,-327.8809 991.3583,-334.7603"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2114.922,-152.3502C2122.5832,-148.8918 2129.8516,-144.3569 2135.614,-138.4121 2172.0056,-100.869 2135.6836,-64.3967 2171.614,-26.4121 2187.8046,-9.2958 2199.2035,1.2768 2221.1034,-7.4121"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2107.0756,-152.2783C2116.8726,-148.6769 2126.9693,-144.1018 2135.614,-138.4121 2165.4401,-118.7811 2192.0908,-86.6174 2207.4231,-65.9891"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2210.4211,-67.8168 2213.4598,-57.6671 2204.7549,-63.7065 2210.4211,-67.8168"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1112.2255,-329.4669C1156.0736,-338.2551 1220.1357,-350.2275 1276.5857,-357.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1276.5857,-357.4121C1326.115,-363.7158 1381.9863,-373.0865 1423.0158,-380.3948"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1422.6536,-383.8856 1433.1144,-382.2053 1423.889,-376.9955 1422.6536,-383.8856"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1081.0811,-329.5519C1104.44,-341.1866 1142.878,-359.3846 1177.4956,-371.4121 1189.6619,-375.6391 1202.8963,-379.4791 1215.6146,-382.8117"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1215.119,-386.2971 1225.6735,-385.3733 1216.8466,-379.5136 1215.119,-386.2971"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1339.2993,-288.4175 1213.8721,-288.4175 1213.8721,-266.4066 1339.2993,-266.4066 1339.2993,-288.4175"/>
<text text-anchor="middle" x="1276.5857" y="-274.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1117.8398,-307.3709C1145.608,-302.1304 1178.9728,-295.8338 1207.9328,-290.3684"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1208.7987,-293.7668 1217.9762,-288.473 1207.5005,-286.8882 1208.7987,-293.7668"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1323.8994,-329.4175 1229.2719,-329.4175 1229.2719,-307.4066 1323.8994,-307.4066 1323.8994,-329.4175"/>
<text text-anchor="middle" x="1276.5857" y="-315.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1136.8472,-318.4121C1163.944,-318.4121 1193.8617,-318.4121 1219.0391,-318.4121"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1219.1561,-321.9122 1229.156,-318.4121 1219.156,-314.9122 1219.1561,-321.9122"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.803,-307.3257C1096.5022,-292.5254 1137.7873,-267.057 1177.4956,-257.4121 1343.2266,-217.157 1547.1722,-273.1715 1632.4378,-301.1533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1631.4042,-304.4981 1641.9979,-304.3375 1633.6163,-297.8568 1631.4042,-304.4981"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1339.2718,-285.6681C1351.728,-288.6849 1364.4242,-292.8002 1375.6758,-298.4121 1380.7032,-300.9196 1433.0094,-347.2716 1462.506,-373.5697"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1460.3709,-376.3554 1470.1624,-380.4023 1465.0317,-371.1326 1460.3709,-376.3554"/>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1339.2034,-267.4192C1417.1614,-255.8641 1554.5009,-238.4121 1672.897,-238.4121 1672.897,-238.4121 1672.897,-238.4121 1875.8796,-238.4121 1993.8769,-238.4121 2038.9513,-251.0853 2135.614,-183.4121 2177.1136,-154.3583 2202.6208,-98.0643 2214.0362,-67.4594"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2217.4214,-68.3869 2217.4893,-57.7923 2210.8293,-66.0321 2217.4214,-68.3869"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1324.0322,-307.6342C1411.0793,-289.7235 1601.5852,-259.2029 1756.5344,-295.4121 1814.1522,-308.8764 1816.9457,-349.1319 1875.8796,-354.4121"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1875.8796,-354.4121C1996.408,-364.1457 2029.3622,-377.6854 2135.614,-435.4121 2179.0127,-458.9906 2172.812,-496.052 2221.1034,-506.4121"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2221.1034,-506.4121C2262.7208,-513.608 2307.6525,-532.8979 2336.3315,-546.8279"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2334.8914,-550.0204 2345.4061,-551.3213 2337.9977,-543.7473 2334.8914,-550.0204"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1323.9844,-327.109C1340.706,-331.0211 1359.3887,-336.3752 1375.6758,-343.4121 1393.1052,-350.9426 1394.6125,-358.0852 1411.6758,-366.4121 1419.5908,-370.2746 1428.2595,-373.8398 1436.7325,-376.9956"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1435.5705,-380.2971 1446.1651,-380.3786 1437.9338,-373.708 1435.5705,-380.2971"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1323.7886,-326.4276C1379.0284,-336.0449 1473.1466,-353.1691 1553.2595,-371.4121 1814.2982,-430.8545 1888.4059,-422.6368 2135.614,-525.4121 2245.3033,-571.0148 2249.3324,-681.1751 2366.295,-660.4121"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2366.295,-660.4121C2394.4711,-655.1181 2425.7106,-649.0664 2451.8728,-643.9469"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2452.8637,-647.3193 2462.0039,-641.9613 2451.5174,-640.45 2452.8637,-647.3193"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1717.2922,-326.4651C1758.1814,-336.0407 1820.6874,-349.158 1875.8796,-354.4121"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1677.0003,-326.5583C1695.4048,-376.322 1770.4054,-576.6144 1792.5344,-596.4121 1796.686,-600.1263 1801.3709,-603.2892 1806.3492,-605.9826"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1805.0386,-609.2343 1815.5754,-610.3412 1808.0287,-602.905 1805.0386,-609.2343"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1482.4677,-738.4121C1565.5053,-754.7791 1591.1187,-760.2167 1672.897,-738.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1336.0929,-710.4435C1377.2334,-718.1292 1433.2122,-728.7037 1482.4677,-738.4121"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1482.4677,-738.4121C1535.669,-748.8982 1537.229,-782.142 1589.2595,-797.4121 1711.7592,-833.3637 1748.2133,-816.4121 1875.8796,-816.4121 1875.8796,-816.4121 1875.8796,-816.4121 2065.4194,-816.4121 2157.2293,-816.4121 2191.3767,-838.8219 2270.5928,-792.4121 2333.1162,-755.7818 2295.0778,-673.7931 2366.295,-660.4121"/>
</g>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node31" class="node">
<title>sourcefile~solarshading.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node31"><a xlink:href="../sourcefile/solarshading.f90.html" xlink:title="SolarShading.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1718.9578,-788.4175 1626.8361,-788.4175 1626.8361,-766.4066 1718.9578,-766.4066 1718.9578,-788.4175"/>
<text text-anchor="middle" x="1672.897" y="-774.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarShading.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1482.4677,-738.4121C1527.7544,-747.3382 1579.0093,-757.8592 1616.9273,-765.7227"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1616.2565,-769.158 1626.7593,-767.764 1617.6796,-762.3041 1616.2565,-769.158"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node32" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node32"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1553.052,-710.4175 1411.8833,-710.4175 1411.8833,-688.4066 1553.052,-688.4066 1553.052,-710.4175"/>
<text text-anchor="middle" x="1482.4677" y="-696.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1337.7996,-699.4121C1357.7649,-699.4121 1380.2509,-699.4121 1401.4383,-699.4121"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1401.7183,-702.9122 1411.7183,-699.4121 1401.7183,-695.9122 1401.7183,-702.9122"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M703.3915,-600.4383C729.8185,-604.7014 759.9442,-609.5612 786.1314,-613.7856"/>
<polygon fill="#ffff00" stroke="#ffff00" points="785.9041,-617.2941 796.3339,-615.4315 787.019,-610.3835 785.9041,-617.2941"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1114.801,-659.0859C1158.762,-657.1284 1221.7069,-655.8341 1276.5857,-660.4121"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1114.4372,-671.7966C1142.1078,-676.5092 1175.9559,-682.2738 1205.5556,-687.3149"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1204.9701,-690.7656 1215.4158,-688.9942 1206.1454,-683.8649 1204.9701,-690.7656"/>
</g>
<!-- sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M698.6135,-558.837C708.3327,-561.5929 718.0448,-565.059 726.835,-569.4121 745.499,-578.655 744.4003,-589.7198 762.835,-599.4121 770.882,-603.6429 779.7247,-607.2244 788.619,-610.2371"/>
<polygon fill="#00ffff" stroke="#00ffff" points="787.6652,-613.6062 798.2552,-613.2866 789.7773,-606.9325 787.6652,-613.6062"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M685.9089,-660.3927C717.3506,-653.5816 757.8885,-644.8 791.0446,-637.6175"/>
<polygon fill="#0000ff" stroke="#0000ff" points="792.047,-640.9817 801.0793,-635.4438 790.5649,-634.1403 792.047,-640.9817"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M699.2562,-628.6362C726.5132,-627.8825 758.2704,-627.0042 785.7459,-626.2444"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="786.1488,-629.7347 796.0482,-625.9595 785.9552,-622.7374 786.1488,-629.7347"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1875.8796,-660.4121C1946.2771,-629.9226 2145.4007,-672.842 2221.1034,-660.4121"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2221.1034,-660.4121C2275.3336,-652.2217 2325.2119,-606.9361 2349.9568,-580.8847"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2352.5853,-583.1974 2356.8063,-573.4797 2347.4465,-578.4441 2352.5853,-583.1974"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1875.8796,-660.4121C1910.7429,-645.3126 1925.5182,-658.9421 1959.2249,-641.4121 1996.5687,-621.9904 2030.9804,-586.2491 2049.995,-564.282"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2052.7094,-566.4926 2056.5026,-556.6 2047.3682,-561.9679 2052.7094,-566.4926"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1719.215,-766.8446C1731.6907,-763.1283 1744.9355,-758.3564 1756.5344,-752.4121 1816.1362,-721.8667 1814.423,-687.0292 1875.8796,-660.4121"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1719.0974,-771.8081C1732.5729,-768.1661 1746.3858,-762.1925 1756.5344,-752.4121 1792.3596,-717.8866 1756.7258,-680.9548 1792.5344,-646.4121 1796.2446,-642.833 1800.4467,-639.7639 1804.9435,-637.1324"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1806.5648,-640.2346 1813.9027,-632.5922 1803.4005,-633.9906 1806.5648,-640.2346"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2221.1034,-660.4121C2284.9094,-650.7754 2302.8752,-672.3281 2366.295,-660.4121"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1490.3277,-688.3313C1506.1919,-666.9942 1544.3785,-620.6177 1589.2595,-601.4121 1706.6309,-551.1862 1748.4917,-590.8383 1875.8796,-582.4121"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1517.4346,-710.46C1564.053,-724.5173 1644.0392,-746.1065 1672.897,-738.4121"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1672.897,-738.4121C1709.7295,-728.5914 1726.6087,-743.0242 1756.5344,-719.4121 1784.9339,-697.0042 1764.9135,-669.7729 1792.5344,-646.4121 1797.0418,-642.5999 1802.1152,-639.369 1807.4768,-636.6307"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1809.0387,-639.766 1816.7229,-632.472 1806.1672,-633.3821 1809.0387,-639.766"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1520.9121,-710.4726C1531.6849,-714.2371 1543.1951,-718.9104 1553.2595,-724.4121 1571.0454,-734.1345 1571.2407,-743.1284 1589.2595,-752.4121 1597.8586,-756.8425 1607.369,-760.6178 1616.8017,-763.7892"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1615.9719,-767.1976 1626.5619,-766.8777 1618.0838,-760.5238 1615.9719,-767.1976"/>
</g>
<!-- sourcefile~windowmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node33" class="node">
<title>sourcefile~windowmanager.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node33"><a xlink:href="../sourcefile/windowmanager.f90.html" xlink:title="WindowManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1726.6227,-632.4175 1619.1713,-632.4175 1619.1713,-610.4066 1726.6227,-610.4066 1726.6227,-632.4175"/>
<text text-anchor="middle" x="1672.897" y="-618.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1509.3476,-688.402C1542.5696,-674.7943 1599.2504,-651.5778 1636.3887,-636.3659"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1637.9189,-639.5214 1645.8461,-632.4921 1635.2656,-633.0437 1637.9189,-639.5214"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_node34" class="node">
<title>sourcefile~heatbalanceintradexchange.f90</title>
<g id="a_sourcefile~~electricpowermanager.f90~~AfferentGraph_node34"><a xlink:href="../sourcefile/heatbalanceintradexchange.f90.html" xlink:title="HeatBalanceIntRadExchange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1756.6721,-710.4175 1589.1218,-710.4175 1589.1218,-688.4066 1756.6721,-688.4066 1756.6721,-710.4175"/>
<text text-anchor="middle" x="1672.897" y="-696.2621" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceIntRadExchange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1553.1059,-699.4121C1561.5506,-699.4121 1570.2721,-699.4121 1578.9792,-699.4121"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1579.1766,-702.9122 1589.1765,-699.4121 1579.1765,-695.9122 1579.1766,-702.9122"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1714.1029,-610.3835C1754.8394,-600.2216 1819.1266,-586.1661 1875.8796,-582.4121"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1726.7597,-621.4121C1743.8836,-621.4121 1763.3469,-621.4121 1782.4288,-621.4121"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1782.6645,-624.9122 1792.6645,-621.4121 1782.6644,-617.9122 1782.6645,-624.9122"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~electricpowermanager.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1720.9775,-688.3522C1732.9359,-684.7143 1745.4872,-680.1038 1756.5344,-674.4121 1774.5532,-665.1284 1774.5201,-655.7044 1792.5344,-646.4121 1800.6192,-642.2417 1809.5121,-638.65 1818.3857,-635.5955"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1819.534,-638.9027 1827.9677,-632.4899 1817.3757,-632.2437 1819.534,-638.9027"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileelectricpowermanagerf90AfferentGraph = svgPanZoom('#sourcefileelectricpowermanagerf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/manageelectricpower.html">ManageElectricPower</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html#src">ElectricPowerManager.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">ManageElectricPower</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-4"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-5"></a>          <span class="c">!       DATE WRITTEN   Sept. 2000</span>
<a name="ln-6"></a>          <span class="c">!       MODIFIED       B. Griffith  Feb. 2008 add thermal following operating scheme</span>
<a name="ln-7"></a>          <span class="c">!                      B. Griffith May 2009 add EMS</span>
<a name="ln-8"></a>          <span class="c">!       RE-ENGINEERED  B. Griffith  June 2008 add support for DC centers and different inverter models</span>
<a name="ln-9"></a>          <span class="c">!       MODIFIED       B. Brannon July 2009 Charge and Draw objects removed from line 1825</span>
<a name="ln-10"></a>          <span class="c">!                      B. Brannon Nullified Charge during Drawing 2298. Nullified Draw during Charging 2305.</span>
<a name="ln-11"></a>          <span class="c">!                                 to prevent simultaneous Drawing and Charging</span>
<a name="ln-12"></a>          <span class="c">!                      B. Nigusse  Feb. 2010 Modifed the load center requested power calculation procedure</span>
<a name="ln-13"></a>          <span class="c">!                                            used to manage the electric load center electrical storage units.</span>
<a name="ln-14"></a>          <span class="c">!                      W. Wang     June-July, 2010 Add a transformer model</span>
<a name="ln-15"></a>          <span class="c">!                      Y. KyungTae and W. Wang July-August, 2011 Added a battery model</span>
<a name="ln-16"></a>
<a name="ln-17"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-18"></a>          <span class="c">! This module manages electric power generation and distribution</span>
<a name="ln-19"></a>          <span class="c">! equipment.</span>
<a name="ln-20"></a>
<a name="ln-21"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-22"></a>
<a name="ln-23"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-24"></a>
<a name="ln-25"></a>          <span class="c">! OTHER NOTES: na</span>
<a name="ln-26"></a>
<a name="ln-27"></a>
<a name="ln-28"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-29"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-30"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-31"></a><span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>         <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MaxNameLength</span><span class="p">,</span> <span class="n">NumOfTimeStepInHour</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-32"></a><span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>      <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ShowWarningError</span><span class="p">,</span> <span class="n">ShowSevereError</span><span class="p">,</span> <span class="n">ShowFatalError</span><span class="p">,</span> <span class="n">ShowContinueError</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-33"></a>                                <span class="n">ShowRecurringSevereErrorAtEnd</span>
<a name="ln-34"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>     <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-35"></a><span class="k">USE </span><span class="n">DataGlobalConstants</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">iGeneratorICEngine</span><span class="p">,</span><span class="n">iGeneratorCombTurbine</span><span class="p">,</span><span class="n">iGeneratorPV</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-36"></a>                               <span class="n">iGeneratorFuelCell</span><span class="p">,</span> <span class="n">iGeneratorMicroCHP</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-37"></a>                               <span class="n">iGeneratorMicroturbine</span><span class="p">,</span> <span class="n">iGeneratorWindTurbine</span>
<a name="ln-38"></a>
<a name="ln-39"></a>
<a name="ln-40"></a><span class="k">IMPLICIT NONE</span>
<a name="ln-41"></a><span class="k">PRIVATE</span>
<a name="ln-42"></a>
<a name="ln-43"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-44"></a>
<a name="ln-45"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iOpSchemeBaseLoad</span>        <span class="o">=</span><span class="mi">1</span> <span class="c">! Electric load center dispatch mode</span>
<a name="ln-46"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iOpSchemeDemandLimit</span>     <span class="o">=</span><span class="mi">2</span> <span class="c">! Electric load center dispatch mode</span>
<a name="ln-47"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iOpSchemeTrackElectrical</span> <span class="o">=</span><span class="mi">3</span> <span class="c">! Electric load center dispatch mode</span>
<a name="ln-48"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iOpSchemeTrackSchedule</span>   <span class="o">=</span><span class="mi">4</span> <span class="c">! Electric load center dispatch mode</span>
<a name="ln-49"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iOpSchemeTrackMeter</span>      <span class="o">=</span><span class="mi">5</span> <span class="c">! Electric load center dispatch mode</span>
<a name="ln-50"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iOpSchemeThermalFollow</span>   <span class="o">=</span><span class="mi">6</span> <span class="c">! Electric load center dispatch mode</span>
<a name="ln-51"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iOpSchemeThermalFollowLimitElectrical</span> <span class="o">=</span> <span class="mi">7</span> <span class="c">! Electric load center dispatch mode</span>
<a name="ln-52"></a>
<a name="ln-53"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ACBuss</span>                <span class="o">=</span> <span class="mi">100</span> <span class="c">!Electic load center buss and power conditioning mode</span>
<a name="ln-54"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ACBussStorage</span>         <span class="o">=</span> <span class="mi">101</span> <span class="c">!Electic load center buss and power conditioning mode</span>
<a name="ln-55"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DCBussInverter</span>        <span class="o">=</span> <span class="mi">102</span> <span class="c">!Electic load center buss and power conditioning mode</span>
<a name="ln-56"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DCBussInverterDCStorage</span> <span class="o">=</span> <span class="mi">103</span> <span class="c">!Electic load center buss and power conditioning mode</span>
<a name="ln-57"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DCBussInverterACStorage</span> <span class="o">=</span> <span class="mi">104</span> <span class="c">!Electic load center buss and power conditioning mode</span>
<a name="ln-58"></a>
<a name="ln-59"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CECLookUpTableModel</span>   <span class="o">=</span> <span class="mi">201</span> <span class="c">! inverter model mode</span>
<a name="ln-60"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CurveFuncOfPower</span>      <span class="o">=</span> <span class="mi">202</span> <span class="c">! inverter model mode</span>
<a name="ln-61"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SimpleConstantEff</span>     <span class="o">=</span> <span class="mi">203</span> <span class="c">! inverter model mode</span>
<a name="ln-62"></a>
<a name="ln-63"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ZoneGains</span>             <span class="o">=</span> <span class="mi">301</span> <span class="c">! power conditioning equipment thermal loss destination</span>
<a name="ln-64"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">LostToOutside</span>         <span class="o">=</span> <span class="mi">302</span> <span class="c">! power conditioning equipment thermal loss destination</span>
<a name="ln-65"></a>
<a name="ln-66"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SimpleBucketStorage</span>   <span class="o">=</span> <span class="mi">401</span> <span class="c">! storage model mode (1 of 2)</span>
<a name="ln-67"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">KiBaMBattery</span>          <span class="o">=</span> <span class="mi">402</span> <span class="c">! storage model mode (2 of 2)</span>
<a name="ln-68"></a>
<a name="ln-69"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PowerInFromGrid</span>       <span class="o">=</span> <span class="mi">501</span> <span class="c">! Transformer usage: power in from grid</span>
<a name="ln-70"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PowerOutFromBldg</span>      <span class="o">=</span> <span class="mi">502</span> <span class="c">! Transformer usage: power out from onsite generation</span>
<a name="ln-71"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">LossesMethod</span>          <span class="o">=</span> <span class="mi">521</span> <span class="c">! Transformer performance input methos: RatedLosses</span>
<a name="ln-72"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EfficiencyMethod</span>      <span class="o">=</span> <span class="mi">522</span> <span class="c">! Transformer performance input methos: NominalEfficiency</span>
<a name="ln-73"></a>
<a name="ln-74"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Battery_LifeCalculation_Yes</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-75"></a> <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Battery_LifeCalculation_No</span>  <span class="o">=</span> <span class="mi">2</span>
<a name="ln-76"></a>
<a name="ln-77"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-78"></a><span class="k">TYPE </span><span class="n">GenData</span>
<a name="ln-79"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>               <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! user identifier</span>
<a name="ln-80"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TypeOf</span>             <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! equipment type</span>
<a name="ln-81"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CompType_Num</span>       <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Numeric designator for CompType (TypeOf)</span>
<a name="ln-82"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">GeneratorIndex</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-83"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxPowerOut</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum Power Output (W)</span>
<a name="ln-84"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AvailSched</span>         <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Operation Schedule.</span>
<a name="ln-85"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AvailSchedPtr</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! pointer to operation schedule</span>
<a name="ln-86"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PowerRequestThisTimestep</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current Demand on Equipment (W)</span>
<a name="ln-87"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">ONThisTimestep</span>     <span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!Indicator whether Generator on</span>
<a name="ln-88"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">EMSPowerRequest</span>    <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! EMS actuator for current demand on equipment (W)</span>
<a name="ln-89"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">EMSRequestOn</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! EMS actuating On if true.</span>
<a name="ln-90"></a>
<a name="ln-91"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">PlantInfoFound</span>     <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-92"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PlantLoopNum</span>       <span class="o">=</span> <span class="mi">0</span> <span class="c">! Cogen: pointer to plant loop data structure</span>
<a name="ln-93"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">LoopSideNum</span>        <span class="o">=</span> <span class="mi">0</span> <span class="c">! Cogen: pointer to plant loop data structure</span>
<a name="ln-94"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">BranchNum</span>          <span class="o">=</span> <span class="mi">0</span> <span class="c">! Cogen: pointer to plant loop data structure</span>
<a name="ln-95"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CompNum</span>            <span class="o">=</span> <span class="mi">0</span> <span class="c">! Cogen: pointer to plant loop data structure</span>
<a name="ln-96"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">NominalThermElectRatio</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Cogen: nominal ratio of thermal to elect production</span>
<a name="ln-97"></a>  <span class="c">!results of component models for load center reporting</span>
<a name="ln-98"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DCElectricityProd</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current DC Electric Produced from Equipment (J)</span>
<a name="ln-99"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DCElectProdRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current DC Electric Production Rate from Equipment (W)</span>
<a name="ln-100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectricityProd</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current AC Electric Produced from Equipment (J)</span>
<a name="ln-101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectProdRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current AC Electric Production Rate from Equipment (W)</span>
<a name="ln-102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermalProd</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current Thermal energy Produced from Equipment (J)</span>
<a name="ln-103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermalProdRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current Thermal energy Production Rate from Equipment (W)</span>
<a name="ln-104"></a>
<a name="ln-105"></a><span class="k">END TYPE </span><span class="n">GenData</span>
<a name="ln-106"></a>
<a name="ln-107"></a><span class="k">TYPE </span><span class="n">ElectricPowerLoadCenter</span>
<a name="ln-108"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>               <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! user identifier</span>
<a name="ln-109"></a>
<a name="ln-110"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GeneratorList</span>      <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! List name of available generators</span>
<a name="ln-111"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">OperationScheme</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Name of Operation Scheme</span>
<a name="ln-112"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DemandMeterName</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Name of Demand Energy Meter for &quot;on demand&quot; operation</span>
<a name="ln-113"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DemandMeterPtr</span>     <span class="o">=</span> <span class="mi">0</span>   <span class="c">! &quot;pointer&quot; to Meter for electrical Demand to meet</span>
<a name="ln-114"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GenerationMeterName</span><span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Name of Generated Energy Meter for &quot;on demand&quot; operation</span>
<a name="ln-115"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NumGenerators</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Number of Generators</span>
<a name="ln-116"></a>  <span class="k">TYPE</span><span class="p">(</span><span class="n">GenData</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ElecGen</span>          <span class="c">! pointer to generator</span>
<a name="ln-117"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DemandLimit</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Demand Limit in Watts(W) which the generator will operate above</span>
<a name="ln-118"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TrackSchedPtr</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! &quot;pointer&quot; to schedule for electrical demand to meet.</span>
<a name="ln-119"></a>
<a name="ln-120"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">BussType</span>           <span class="o">=</span> <span class="mi">0</span>   <span class="c">! is this load center powered by AC or DC generators</span>
<a name="ln-121"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">InverterPresent</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-122"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InverterName</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! hold name for verificaton and error messages</span>
<a name="ln-123"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">InverterModelNum</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! simulation model parameter type</span>
<a name="ln-124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DCElectricityProd</span>  <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current DC Elect produced (J) (if buss type DCbussInverter)</span>
<a name="ln-125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DCElectProdRate</span>    <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current DC Elect power produced (W) (if buss type DCbussInverter)</span>
<a name="ln-126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DCpowerConditionLosses</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! current DC to AC inverter losses (W) (if DCbussInverter)</span>
<a name="ln-127"></a>
<a name="ln-128"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">StoragePresent</span>     <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-129"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StorageName</span>        <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! hold name for verificaton and error messages</span>
<a name="ln-130"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">StorageModelNum</span>    <span class="o">=</span> <span class="mi">0</span>   <span class="c">! simulation model parameter type</span>
<a name="ln-131"></a>
<a name="ln-132"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">TransformerPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-133"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TransformerName</span>    <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! hold name for verificaton and error messages</span>
<a name="ln-134"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">TransformerModelNum</span><span class="o">=</span> <span class="mi">0</span>   <span class="c">! simulation model parameter type</span>
<a name="ln-135"></a>
<a name="ln-136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectricityProd</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current AC Electric Produced from Equipment (J)</span>
<a name="ln-137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectProdRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current Electric Production Rate from Equipment (W)</span>
<a name="ln-138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermalProd</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current Thermal energy Produced from Equipment (J)</span>
<a name="ln-139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermalProdRate</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current Thermal energy Production Rate from Equipment (W)</span>
<a name="ln-140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TotalPowerRequest</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Total electric power request from the load center (W)</span>
<a name="ln-141"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TotalThermalPowerRequest</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Total thermal power request from the load center (W)</span>
<a name="ln-142"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectDemand</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Current electric power demand on the load center (W)</span>
<a name="ln-143"></a><span class="k">END TYPE </span><span class="n">ElectricPowerLoadCenter</span>
<a name="ln-144"></a>
<a name="ln-145"></a><span class="k">TYPE </span><span class="n">CECInverterLookUpTableData</span>
<a name="ln-146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NightTareLossPower</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NominalVoltage</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NomVoltEfficiencyARR</span> <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! eff at 10, 20, 30, 50, 75, &amp; 100% power and Nominal voltage</span>
<a name="ln-149"></a><span class="k">END TYPE </span><span class="n">CECInverterLookUpTableData</span>
<a name="ln-150"></a>
<a name="ln-151"></a><span class="k">TYPE </span><span class="n">DCtoACInverterStruct</span>
<a name="ln-152"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! user identifier</span>
<a name="ln-153"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ModelType</span>  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! type of inverter model used</span>
<a name="ln-154"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! number for availability schedule.</span>
<a name="ln-155"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-156"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! destination zone for heat losses from inverter.</span>
<a name="ln-157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ZoneRadFract</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! radiative fraction for thermal losses to zone</span>
<a name="ln-158"></a>  <span class="k">Type</span> <span class="p">(</span><span class="n">CECInverterLookUpTableData</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LUTable</span>
<a name="ln-159"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CurveNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for eff as func of power</span>
<a name="ln-160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedPower</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! rated, max continuous power output level for inverter</span>
<a name="ln-161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MinPower</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxPower</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MinEfficiency</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxEfficiency</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">StandbyPower</span>     <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-166"></a>  <span class="c">!results and reporting</span>
<a name="ln-167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Efficiency</span>       <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-168"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DCPowerIn</span>        <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-169"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ACPowerOut</span>       <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-170"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DCEnergyIn</span>       <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ACEnergyOut</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermLossRate</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermLossEnergy</span>  <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">QdotconvZone</span>     <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">QdotRadZone</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">AncillACuseRate</span>  <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-177"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">AncillACuseEnergy</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-178"></a><span class="k">END TYPE </span><span class="n">DCtoACInverterStruct</span>
<a name="ln-179"></a>
<a name="ln-180"></a><span class="k">TYPE</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">ElecStorageDataStruct</span>
<a name="ln-181"></a>  <span class="c">!user defined variables</span>
<a name="ln-182"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">!name of this electrical storage module</span>
<a name="ln-183"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">StorageModelMode</span>          <span class="o">=</span> <span class="mi">0</span> <span class="c">! type of model parameter, SimpleBucketStorage</span>
<a name="ln-184"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AvailSchedPtr</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">! availability schedule index.</span>
<a name="ln-185"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HeatLossesDestination</span>     <span class="o">=</span> <span class="mi">0</span> <span class="c">! mode for where thermal losses go</span>
<a name="ln-186"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ZoneNum</span>                   <span class="o">=</span> <span class="mi">0</span> <span class="c">! destination zone for heat losses from inverter.</span>
<a name="ln-187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ZoneRadFract</span>              <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! radiative fraction for thermal losses to zone</span>
<a name="ln-188"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">StartingEnergyStored</span>      <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">![J] joules inside at beginning of environment period</span>
<a name="ln-189"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">EnergeticEfficCharge</span>      <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [ ] efficiency of charging</span>
<a name="ln-190"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">EnergeticEfficDischarge</span>   <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [ ] efficiency of discharging</span>
<a name="ln-191"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxPowerDraw</span>              <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W] max rate of discharge</span>
<a name="ln-192"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxPowerStore</span>             <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W] max rate of charge</span>
<a name="ln-193"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxEnergyCapacity</span>         <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [J] max storage capacity</span>
<a name="ln-194"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ParallelNum</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! [ ] number of battery modules in parallel</span>
<a name="ln-195"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">SeriesNum</span>                 <span class="o">=</span> <span class="mi">0</span>     <span class="c">! [ ] number of battery modules in series</span>
<a name="ln-196"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ChargeCurveNum</span>            <span class="o">=</span> <span class="mi">0</span>     <span class="c">! [ ] voltage change curve index number for charging</span>
<a name="ln-197"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">DischargeCurveNum</span>         <span class="o">=</span> <span class="mi">0</span>     <span class="c">! [ ] voltage change curve index number for discharging</span>
<a name="ln-198"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">CycleBinNum</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! [ ] number of cycle bins</span>
<a name="ln-199"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">StartingSOC</span>               <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [ ] initial fractional state of charge</span>
<a name="ln-200"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxAhCapacity</span>             <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [Ah]maximum capacity</span>
<a name="ln-201"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">AvailableFrac</span>             <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [ ] fraction of available charge capacity</span>
<a name="ln-202"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ChargeConversionRate</span>      <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [1/h]change rate from bound charge energy to available charge</span>
<a name="ln-203"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ChargedOCV</span>                <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [V] fully charged oppen circuit voltage</span>
<a name="ln-204"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DischargedOCV</span>             <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [V] fully discharged open circuit voltage</span>
<a name="ln-205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">InternalR</span>                 <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [ohm]internal electric resistance</span>
<a name="ln-206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxDischargeI</span>             <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [A] maximum discharging current</span>
<a name="ln-207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">CutoffV</span>                   <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [V] cut-off voltage</span>
<a name="ln-208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxChargeRate</span>             <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [1/h]charge rate limit</span>
<a name="ln-209"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">LifeCalculation</span>           <span class="o">=</span> <span class="mi">0</span>     <span class="c">! [ ]battery life calculation: Yes or No</span>
<a name="ln-210"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">LifeCurveNum</span>              <span class="o">=</span> <span class="mi">0</span>     <span class="c">! [ ]battery life curve name index number</span>
<a name="ln-211"></a>  <span class="c">!calculated and from elsewhere vars</span>
<a name="ln-212"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [J]</span>
<a name="ln-213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LastTimeStepStateOfCharge</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [J]</span>
<a name="ln-214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PelNeedFromStorage</span>        <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W]</span>
<a name="ln-215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PelFromStorage</span>            <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W]</span>
<a name="ln-216"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">EMSOverridePelFromStorage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>  <span class="c">! if true, EMS calling for override</span>
<a name="ln-217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">EMSValuePelFromStorage</span>    <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! value EMS is directing to use, power from storage [W]</span>
<a name="ln-218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PelIntoStorage</span>            <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W]</span>
<a name="ln-219"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">EMSOverridePelIntoStorage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! if true, EMS calling for override</span>
<a name="ln-220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">EMSValuePelIntoStorage</span>    <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! value EMS is directing to use, power into storage [W]</span>
<a name="ln-221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">QdotConvZone</span>              <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W]</span>
<a name="ln-222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">QdotRadZone</span>               <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W]</span>
<a name="ln-223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TimeElapsed</span>               <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [h]</span>
<a name="ln-224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThisTimeStepAvailable</span>     <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [Ah] available charge at the current timestep</span>
<a name="ln-225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThisTimeStepBound</span>         <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [Ah] bound charge at the current timestep</span>
<a name="ln-226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LastTimeStepAvailable</span>     <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [Ah] available charge at the previous timestep</span>
<a name="ln-227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LastTimeStepBound</span>         <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [Ah] bound charge at the previous timestep</span>
<a name="ln-228"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LastTwoTimeStepAvailable</span>  <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [Ah] available charge at the previous two timesteps</span>
<a name="ln-229"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LastTwoTimeStepBound</span>      <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [Ah] bound charge at the previous two timesteps</span>
<a name="ln-230"></a>  <span class="c">!battery life calculation variables</span>
<a name="ln-231"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">count0</span>                    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">B10</span>
<a name="ln-233"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">X0</span>
<a name="ln-234"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">Nmb0</span>
<a name="ln-235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> <span class="kd">::</span> <span class="n">OneNmb0</span>
<a name="ln-236"></a>  <span class="c">!report</span>
<a name="ln-237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectEnergyinStorage</span>      <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [J] state of charge</span>
<a name="ln-238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">StoredPower</span>               <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W]</span>
<a name="ln-239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">StoredEnergy</span>              <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [J]</span>
<a name="ln-240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DecrementedEnergyStored</span>   <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [J] this is the negative of StoredEnergy</span>
<a name="ln-241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DrawnPower</span>                <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W]</span>
<a name="ln-242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">DrawnEnergy</span>               <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [J]</span>
<a name="ln-243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermLossRate</span>             <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [W]</span>
<a name="ln-244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermLossEnergy</span>           <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [J]</span>
<a name="ln-245"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">StorageMode</span>               <span class="o">=</span> <span class="mi">0</span>     <span class="c">! [ ] mode of operation 0 for idle, 1 for discharging, 2 for charging</span>
<a name="ln-246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">AbsoluteSOC</span>               <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [Ah] total state of charge</span>
<a name="ln-247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FractionSOC</span>               <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [ ] fractional state of charge</span>
<a name="ln-248"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">BatteryCurrent</span>            <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [A] total current</span>
<a name="ln-249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">BatteryVoltage</span>            <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [V] total voltage</span>
<a name="ln-250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">BatteryDamage</span>             <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! [ ] fractional battery damage</span>
<a name="ln-251"></a>
<a name="ln-252"></a>
<a name="ln-253"></a><span class="k">END TYPE </span><span class="n">ElecStorageDataStruct</span>
<a name="ln-254"></a>
<a name="ln-255"></a><span class="k">TYPE </span><span class="n">ElectricTransformer</span>
<a name="ln-256"></a>  <span class="c">! user defined variables</span>
<a name="ln-257"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>               <span class="o">=</span> <span class="s1">&#39; &#39;</span>  <span class="c">! user identifier</span>
<a name="ln-258"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="mi">0</span>         <span class="c">! availability schedule index.</span>
<a name="ln-259"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">UsageMode</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c">! mode for transformer usage</span>
<a name="ln-260"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! mode for where thermal losses go</span>
<a name="ln-261"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">0</span>               <span class="c">! destination zone for heat losses from inverter.</span>
<a name="ln-262"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ZoneRadFrac</span> <span class="o">=</span> <span class="mf">0.0D0</span>       <span class="c">! radiative fraction for thermal losses to zone</span>
<a name="ln-263"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedCapacity</span> <span class="o">=</span> <span class="mf">0.0D0</span>     <span class="c">! rated capacity [VA]</span>
<a name="ln-264"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">Phase</span> <span class="o">=</span> <span class="mi">0</span>                 <span class="c">! phase</span>
<a name="ln-265"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">FactorTempCoeff</span> <span class="o">=</span> <span class="mf">0.0D0</span>   <span class="c">! thermal coefficient of resistance for winding material</span>
<a name="ln-266"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TempRise</span> <span class="o">=</span> <span class="mf">0.0D0</span>          <span class="c">! full load temperature rise [C]</span>
<a name="ln-267"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">EddyFrac</span> <span class="o">=</span> <span class="mf">0.0D0</span>          <span class="c">! fraction of eddy current losses []</span>
<a name="ln-268"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">PerformanceInputMode</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! performance input method</span>
<a name="ln-269"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedEfficiency</span> <span class="o">=</span> <span class="mf">0.0D0</span>   <span class="c">! nameplate efficiency []</span>
<a name="ln-270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedPUL</span> <span class="o">=</span> <span class="mf">0.0D0</span>          <span class="c">! per unit load for nameplate efficiency []</span>
<a name="ln-271"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedTemp</span> <span class="o">=</span> <span class="mf">0.0D0</span>         <span class="c">! reference temperature for nameplate efficiency [C]</span>
<a name="ln-272"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxPUL</span> <span class="o">=</span> <span class="mf">0.0D0</span>            <span class="c">! per unit load for maximum efficiency []</span>
<a name="ln-273"></a>  <span class="kt">LOGICAL</span>                      <span class="kd">::</span> <span class="n">ConsiderLosses</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! if true, consider transformer lossses in metering</span>
<a name="ln-274"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">WiredMeterNames</span> <span class="c">! names of the meters wired to transformer</span>
<a name="ln-275"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WiredMeterPtrs</span>      <span class="c">! array of &quot;pointers&quot; to meters wired to transformer</span>
<a name="ln-276"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SpecialMeter</span>        <span class="c">! indicates whether a meter needs special consideration</span>
<a name="ln-277"></a>                                                            <span class="c">! Electricity:Facility and Electricity:HVAC are two special</span>
<a name="ln-278"></a>                                                            <span class="c">! meters because tranformer loss is part of them</span>
<a name="ln-279"></a>  <span class="c">!calculated and from elsewhere vars</span>
<a name="ln-280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedNL</span> <span class="o">=</span> <span class="mf">0.0D0</span>           <span class="c">! rated no load losses, user input or calculated [W]</span>
<a name="ln-281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">RatedLL</span> <span class="o">=</span> <span class="mf">0.0D0</span>           <span class="c">! rated load losses, user input or calculated [W]</span>
<a name="ln-282"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">LoadCenterNum</span> <span class="o">=</span> <span class="mi">0</span>         <span class="c">! number of load centers served by the transformer</span>
<a name="ln-283"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">LoadCenterIndexes</span>   <span class="c">! index array of load centers served by the transformer</span>
<a name="ln-284"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">OverloadErrorIndex</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! used for warning message when transformer is overloaded</span>
<a name="ln-285"></a>  <span class="c">!results and reporting</span>
<a name="ln-286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Efficiency</span>       <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! transformer efficiency</span>
<a name="ln-287"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PowerIn</span>          <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [W]</span>
<a name="ln-288"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">EnergyIn</span>         <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [J]</span>
<a name="ln-289"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">PowerOut</span>         <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [W]</span>
<a name="ln-290"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">EnergyOut</span>        <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [J]</span>
<a name="ln-291"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">NoLoadLossRate</span>   <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [W]</span>
<a name="ln-292"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">NoLoadLossEnergy</span> <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [J]</span>
<a name="ln-293"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LoadLossRate</span>     <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [W]</span>
<a name="ln-294"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">LoadLossEnergy</span>   <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [J]</span>
<a name="ln-295"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermalLossRate</span>  <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [W]</span>
<a name="ln-296"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ThermalLossEnergy</span><span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [J]</span>
<a name="ln-297"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElecUseUtility</span>   <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [J] Energy consumption for a utility transformer (power in)</span>
<a name="ln-298"></a>                                                            <span class="c">! Positive values</span>
<a name="ln-299"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElecProducedCoGen</span><span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [J] Energy consumption for a cogeneration transformer (power out)</span>
<a name="ln-300"></a>                                                            <span class="c">! Negative values</span>
<a name="ln-301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">QdotconvZone</span>     <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [W]</span>
<a name="ln-302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">QdotRadZone</span>      <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! [W]</span>
<a name="ln-303"></a><span class="k">END TYPE </span><span class="n">ElectricTransformer</span>
<a name="ln-304"></a>
<a name="ln-305"></a>
<a name="ln-306"></a><span class="k">Type </span><span class="n">WholeBuildingElectricPowerSummary</span>
<a name="ln-307"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span> <span class="o">=</span> <span class="s1">&#39;Whole Building&#39;</span>
<a name="ln-308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectricityProd</span>    <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current Electric Produced from Equipment (J)</span>
<a name="ln-309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectProdRate</span>      <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current Electric Production Rate from Equipment (W)</span>
<a name="ln-310"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectricityPurch</span>   <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current Purchased Electric (J)</span>
<a name="ln-311"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectPurchRate</span>      <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current Electric Purhcased Rate (W)</span>
<a name="ln-312"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectSurplusRate</span>    <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current excess power (W)</span>
<a name="ln-313"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectricitySurplus</span>  <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current excess energy (J)</span>
<a name="ln-314"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectricityNetRate</span>  <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Net elect rate, + is Purchased, - is Surplus (W)</span>
<a name="ln-315"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElectricityNet</span>      <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Net energy, + is Purchased, - is Surplus (J)</span>
<a name="ln-316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TotalBldgElecDemand</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current Total Building Electric Demand (W)</span>
<a name="ln-317"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TotalHVACElecDemand</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current Total HVAC Electric Demand (W)</span>
<a name="ln-318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">TotalElectricDemand</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current Total Electric Demand (W)</span>
<a name="ln-319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElecProducedPVRate</span>  <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current Rate of PV Produced from the Arrays (W)</span>
<a name="ln-320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">ElecProducedWTRate</span>  <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Current Rate of Wind Turbine Produced (W)</span>
<a name="ln-321"></a><span class="k">end type </span><span class="n">WholeBuildingElectricPowerSummary</span>
<a name="ln-322"></a>
<a name="ln-323"></a>
<a name="ln-324"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-325"></a><span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>    <span class="kd">::</span> <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>   <span class="c">! When TRUE, calls subroutine to read input file.</span>
<a name="ln-326"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumLoadCenters</span>         <span class="o">=</span><span class="mi">0</span>
<a name="ln-327"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumInverters</span>           <span class="o">=</span><span class="mi">0</span>
<a name="ln-328"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">NumElecStorageDevices</span>  <span class="o">=</span><span class="mi">0</span>
<a name="ln-329"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumTransformers</span>        <span class="o">=</span><span class="mi">0</span>
<a name="ln-330"></a>
<a name="ln-331"></a>
<a name="ln-332"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ElecProducedCoGenIndex</span> <span class="o">=</span><span class="mi">0</span>
<a name="ln-333"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ElecProducedPVIndex</span>    <span class="o">=</span><span class="mi">0</span>
<a name="ln-334"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ElecProducedWTIndex</span>    <span class="o">=</span><span class="mi">0</span>
<a name="ln-335"></a>
<a name="ln-336"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MAXRainflowArrayBounds</span> <span class="o">=</span><span class="mi">100</span>
<a name="ln-337"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MAXRainFlowArrayInc</span>    <span class="o">=</span><span class="mi">100</span>
<a name="ln-338"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">ElecStorageDataStruct</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>    <span class="kd">::</span> <span class="n">ElecStorage</span>
<a name="ln-339"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">DCtoACInverterStruct</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>     <span class="kd">::</span> <span class="n">Inverter</span>
<a name="ln-340"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">ElectricPowerLoadCenter</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">ElecLoadCenter</span>  <span class="c">!dimension to number of machines</span>
<a name="ln-341"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">ElectricTransformer</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>      <span class="kd">::</span> <span class="n">Transformer</span>
<a name="ln-342"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">WholeBuildingElectricPowerSummary</span><span class="p">),</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">WholeBldgElectSummary</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-343"></a>           <span class="n">WholeBuildingElectricPowerSummary</span><span class="p">(</span><span class="s1">&#39;Whole Building&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-344"></a>                          <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-345"></a>
<a name="ln-346"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE PrimaryPlantLoops</span>
<a name="ln-347"></a><span class="k">PUBLIC    </span><span class="n">ManageElectricLoadCenters</span>
<a name="ln-348"></a><span class="k">PRIVATE   </span><span class="n">GetPowerManagerInput</span>
<a name="ln-349"></a><span class="k">PRIVATE   </span><span class="n">UpdateWholeBuildingRecords</span>
<a name="ln-350"></a><span class="k">PRIVATE   </span><span class="n">UpdateLoadCenterRecords</span>
<a name="ln-351"></a><span class="k">PUBLIC    </span><span class="n">VerifyCustomMetersElecPowerMgr</span>
<a name="ln-352"></a><span class="k">PRIVATE   </span><span class="n">CalcLoadCenterThermalLoad</span>
<a name="ln-353"></a><span class="k">PUBLIC    </span><span class="n">FigureInverterZoneGains</span>
<a name="ln-354"></a><span class="k">PUBLIC    </span><span class="n">FigureElectricalStorageZoneGains</span>
<a name="ln-355"></a><span class="k">PRIVATE   </span><span class="n">ManageElectCenterStorageInteractions</span>
<a name="ln-356"></a><span class="k">PRIVATE   </span><span class="n">ManageInverter</span>
<a name="ln-357"></a><span class="k">PRIVATE   </span><span class="n">GeneratorPowerOutput</span>
<a name="ln-358"></a><span class="k">PRIVATE   </span><span class="n">ManageTransformers</span>
<a name="ln-359"></a><span class="k">PUBLIC    </span><span class="n">FigureTransformerZoneGains</span>
<a name="ln-360"></a>
<a name="ln-361"></a><span class="k">CONTAINS</span>
<a name="ln-362"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-363"></a>
<a name="ln-364"></a><span class="c">! Beginning of Electric Power Manager Subroutines</span>
<a name="ln-365"></a><span class="c">!*************************************************************************</span>
<a name="ln-366"></a>
<a name="ln-367"></a><span class="k">SUBROUTINE </span><span class="n">ManageElectricLoadCenters</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">SimElecCircuits</span><span class="p">,</span> <span class="n">UpdateMetersOnly</span><span class="p">)</span>
<a name="ln-368"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-369"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-370"></a>          <span class="c">!       DATE WRITTEN   Sept. 2000</span>
<a name="ln-371"></a>          <span class="c">!       RE-ENGINEERED  Richard Liesen, Feb 2003</span>
<a name="ln-372"></a>          <span class="c">!       RE-ENGINEERED  Bereket Nigusse, Jan/Feb 2010   Generator dispatch is based on actual</span>
<a name="ln-373"></a>          <span class="c">!                                                      power produced by the previous generator(s)</span>
<a name="ln-374"></a>          <span class="c">!       MODIFIED       Weimin Wang, July 2010          Consider transformer</span>
<a name="ln-375"></a>
<a name="ln-376"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-377"></a>          <span class="c">! This subroutine manages the electric load centers by matching demand and</span>
<a name="ln-378"></a>          <span class="c">! generator power output.</span>
<a name="ln-379"></a>
<a name="ln-380"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-381"></a>          <span class="c">! Generators are dispatched in the sequence sepecified in the idf. The generators</span>
<a name="ln-382"></a>          <span class="c">! in the first electric load center are dispatched first. Generators are called</span>
<a name="ln-383"></a>          <span class="c">! right after dispatch and the remaining building load due for dispatch is updated</span>
<a name="ln-384"></a>          <span class="c">! using the actual generated power output not the requested value from the</span>
<a name="ln-385"></a>          <span class="c">! ElectricLoadCenter:Generators object(s).</span>
<a name="ln-386"></a>          <span class="c">!</span>
<a name="ln-387"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-388"></a>
<a name="ln-389"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-390"></a>
<a name="ln-391"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-392"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-393"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">dooutputreporting</span><span class="p">,</span> <span class="n">MetersHaveBeenInitialized</span><span class="p">,</span> <span class="n">warmupflag</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-394"></a>                             <span class="n">doingsizing</span><span class="p">,</span> <span class="n">currenttime</span><span class="p">,</span> <span class="n">BeginEnvrnFlag</span>
<a name="ln-395"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Month</span><span class="p">,</span> <span class="n">DayOfMonth</span>
<a name="ln-396"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">SysTimeElapsed</span>
<a name="ln-397"></a>
<a name="ln-398"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-399"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-400"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-401"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SimElecCircuits</span> <span class="c">! simulation convergence flag</span>
<a name="ln-402"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">UpdateMetersOnly</span> <span class="c">! if true then don&#39;t resimulate generators, just update meters.</span>
<a name="ln-403"></a>
<a name="ln-404"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-405"></a>          <span class="c">! na</span>
<a name="ln-406"></a>
<a name="ln-407"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-408"></a>          <span class="c">! na</span>
<a name="ln-409"></a>
<a name="ln-410"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-411"></a>          <span class="c">! na</span>
<a name="ln-412"></a>
<a name="ln-413"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-414"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">GenNum</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c">! Generator number counter</span>
<a name="ln-415"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">LoadCenterNum</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Load center number counter</span>
<a name="ln-416"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">TransfNum</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! Transformer number counter</span>
<a name="ln-417"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">MeterNum</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c">! A transformer&#39;s meter number counter</span>
<a name="ln-418"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">MeterIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Meter index number from GetMeterIndex</span>
<a name="ln-419"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">ElecFacilityIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-420"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecFacilityBldg</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-421"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecFacilityHVAC</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-422"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecProducedPV</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-423"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElecProducedWT</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-424"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span>          <span class="c">! Remaining electric power load to be met by a load center</span>
<a name="ln-425"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Remaining electric power load for the building</span>
<a name="ln-426"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RemainingThermalLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span>   <span class="c">! Remaining thermal load to be met</span>
<a name="ln-427"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>      <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-428"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CustomMeterDemand</span>  <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! local variable for Custom metered elec demand</span>
<a name="ln-429"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">external</span>      <span class="kd">::</span> <span class="n">GetMeterIndex</span>
<a name="ln-430"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">external</span>    <span class="kd">::</span> <span class="n">GetInstantMeterValue</span>
<a name="ln-431"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">external</span>    <span class="kd">::</span> <span class="n">GetCurrentMeterValue</span>
<a name="ln-432"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">external</span> <span class="kd">::</span> <span class="n">GetMeterResourceType</span>
<a name="ln-433"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-434"></a>
<a name="ln-435"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ElectricProdRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! Electric Power Production Rate of Generators</span>
<a name="ln-436"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ThermalProdRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! Thermal Power Production Rate of Generators</span>
<a name="ln-437"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ExcessThermalPowerRequest</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! Excess Thermal Power Request</span>
<a name="ln-438"></a>
<a name="ln-439"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">LoadCenterElectricLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Load center electric load to be dispatched</span>
<a name="ln-440"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">LoadCenterThermalLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! Load center thermal load to be dispatched</span>
<a name="ln-441"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">StorageDrawnPower</span> <span class="o">=</span> <span class="mf">0.0D0</span>      <span class="c">! Electric Power Draw Rate from storage units</span>
<a name="ln-442"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">StorageStoredPower</span> <span class="o">=</span> <span class="mf">0.0D0</span>     <span class="c">! Electric Power Store Rate from storage units</span>
<a name="ln-443"></a>
<a name="ln-444"></a>
<a name="ln-445"></a>  <span class="c">! Get Generator data from input file</span>
<a name="ln-446"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-447"></a><span class="k">    CALL </span><span class="n">GetPowerManagerInput</span>
<a name="ln-448"></a>    <span class="n">GetInput</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-449"></a>  <span class="k">END IF</span>
<a name="ln-450"></a>
<a name="ln-451"></a>  <span class="c">! Setting up the Internal Meters and getting their indexes is done only once</span>
<a name="ln-452"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MetersHaveBeenInitialized</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-453"></a><span class="k">    </span><span class="n">ElecFacilityIndex</span>      <span class="o">=</span> <span class="n">GetMeterIndex</span><span class="p">(</span><span class="s1">&#39;Electricity:Facility&#39;</span><span class="p">)</span>
<a name="ln-454"></a>    <span class="n">ElecProducedCoGenIndex</span> <span class="o">=</span> <span class="n">GetMeterIndex</span><span class="p">(</span><span class="s1">&#39;Cogeneration:ElectricityProduced&#39;</span><span class="p">)</span>
<a name="ln-455"></a>    <span class="n">ElecProducedPVIndex</span>    <span class="o">=</span> <span class="n">GetMeterIndex</span><span class="p">(</span><span class="s1">&#39;Photovoltaic:ElectricityProduced&#39;</span><span class="p">)</span>
<a name="ln-456"></a>    <span class="n">ElecProducedWTIndex</span>    <span class="o">=</span> <span class="n">GetMeterIndex</span><span class="p">(</span><span class="s1">&#39;WindTurbine:ElectricityProduced&#39;</span><span class="p">)</span>
<a name="ln-457"></a>
<a name="ln-458"></a>    <span class="k">DO </span><span class="n">LoadCenterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumLoadCenters</span>
<a name="ln-459"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DemandMeterPtr</span> <span class="o">=</span>  <span class="n">GetMeterIndex</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DemandMeterName</span><span class="p">)</span>
<a name="ln-460"></a>    <span class="n">ENDDO</span>
<a name="ln-461"></a>
<a name="ln-462"></a>    <span class="k">DO </span><span class="n">TransfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTransformers</span>    <span class="c">!NumTransformers is a module variable</span>
<a name="ln-463"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">UsageMode</span> <span class="o">==</span> <span class="n">PowerInFromGrid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-464"></a><span class="k">        DO </span><span class="n">MeterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterNames</span><span class="p">)</span>
<a name="ln-465"></a>          <span class="n">MeterIndex</span> <span class="o">=</span> <span class="n">GetMeterIndex</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterNames</span><span class="p">(</span><span class="n">MeterNum</span><span class="p">))</span>
<a name="ln-466"></a>          <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterPtrs</span><span class="p">(</span><span class="n">MeterNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">MeterIndex</span>
<a name="ln-467"></a>
<a name="ln-468"></a>          <span class="c">!Check whether the meter is an electricity meter</span>
<a name="ln-469"></a>          <span class="c">!Index function is used here because some resource types are not Electricity but strings containing</span>
<a name="ln-470"></a>          <span class="c">! Electricity such as ElectricityPurchased and ElectricityProduced.</span>
<a name="ln-471"></a>          <span class="c">!It is not proper to have this check in GetInput routine because the meter index may have not been defined</span>
<a name="ln-472"></a>          <span class="k">IF</span><span class="p">(</span> <span class="nb">INDEX</span><span class="p">(</span><span class="n">GetMeterResourceType</span><span class="p">(</span><span class="n">MeterIndex</span><span class="p">),</span><span class="s1">&#39;Electricity&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-473"></a><span class="k">            CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Non-electricity meter used for &#39;</span><span class="o">//</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-474"></a>          <span class="k">END IF</span>
<a name="ln-475"></a><span class="k">        END DO</span>
<a name="ln-476"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-477"></a>    <span class="k">END DO</span>
<a name="ln-478"></a>
<a name="ln-479"></a><span class="k">    </span><span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-480"></a>
<a name="ln-481"></a>  <span class="k">END IF</span>
<a name="ln-482"></a>
<a name="ln-483"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-484"></a><span class="k">    </span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityProd</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-485"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectProdRate</span>        <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-486"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityPurch</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-487"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectPurchRate</span>       <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-488"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectSurplusRate</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-489"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricitySurplus</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-490"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityNetRate</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-491"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityNet</span>       <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-492"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalBldgElecDemand</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-493"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalHVACElecDemand</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-494"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalElectricDemand</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-495"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElecProducedPVRate</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-496"></a>    <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElecProducedWTRate</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-497"></a>
<a name="ln-498"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumLoadCenters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-499"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">DCElectricityProd</span>           <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-500"></a>      <span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">DCElectProdRate</span>             <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-501"></a>      <span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">DCpowerConditionLosses</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-502"></a>      <span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">ElectricityProd</span>             <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-503"></a>      <span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">ElectProdRate</span>               <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-504"></a>      <span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">ThermalProd</span>                 <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-505"></a>      <span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">ThermalProdRate</span>             <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-506"></a>      <span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">TotalPowerRequest</span>           <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-507"></a>      <span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">TotalThermalPowerRequest</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-508"></a>      <span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">ElectDemand</span>                 <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-509"></a>    <span class="n">ENDIF</span>
<a name="ln-510"></a>
<a name="ln-511"></a>    <span class="k">DO </span><span class="n">LoadCenterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumLoadCenters</span>
<a name="ln-512"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-513"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ONThisTimestep</span>      <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-514"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">DCElectricityProd</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-515"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">DCElectProdRate</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-516"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ElectricityProd</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-517"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ElectProdRate</span>       <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-518"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ThermalProd</span>         <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-519"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ThermalProdRate</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-520"></a>    <span class="n">ENDDO</span>
<a name="ln-521"></a>
<a name="ln-522"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumInverters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-523"></a><span class="k">      </span><span class="n">Inverter</span><span class="p">%</span><span class="n">AncillACuseRate</span>                   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-524"></a>      <span class="n">Inverter</span><span class="p">%</span><span class="n">AncillACuseEnergy</span>                 <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-525"></a>      <span class="n">Inverter</span><span class="p">%</span><span class="n">QdotconvZone</span>                      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-526"></a>      <span class="n">Inverter</span><span class="p">%</span><span class="n">QdotRadZone</span>                       <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-527"></a>    <span class="n">ENDIF</span>
<a name="ln-528"></a>
<a name="ln-529"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumElecStorageDevices</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-530"></a><span class="k">      </span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelNeedFromStorage</span>             <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-531"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelFromStorage</span>                 <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-532"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">PelIntoStorage</span>                 <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-533"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">QdotConvZone</span>                   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-534"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">QdotRadZone</span>                    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-535"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">TimeElapsed</span>                    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-536"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">ElectEnergyinStorage</span>           <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-537"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">StoredPower</span>                    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-538"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">StoredEnergy</span>                   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-539"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">DecrementedEnergyStored</span>        <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-540"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">DrawnPower</span>                     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-541"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">DrawnEnergy</span>                    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-542"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThermLossRate</span>                  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-543"></a>      <span class="n">ElecStorage</span><span class="p">%</span><span class="n">ThermLossEnergy</span>                <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-544"></a>    <span class="n">ENDIF</span>
<a name="ln-545"></a>    <span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-546"></a>  <span class="n">ENDIF</span>
<a name="ln-547"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-548"></a>
<a name="ln-549"></a> <span class="c">! Determine the demand from the simulation for Demand Limit and Track Electrical and Reporting</span>
<a name="ln-550"></a>  <span class="n">ElecFacilityBldg</span><span class="o">=</span><span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">ElecFacilityIndex</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-551"></a>  <span class="n">ElecFacilityHVAC</span><span class="o">=</span><span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">ElecFacilityIndex</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-552"></a>  <span class="c">! deprecate this PV stuff?</span>
<a name="ln-553"></a>  <span class="n">ElecProducedPV</span> <span class="o">=</span> <span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">ElecProducedPVIndex</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-554"></a>  <span class="n">ElecProducedWT</span> <span class="o">=</span> <span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">ElecProducedWTIndex</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-555"></a>
<a name="ln-556"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalBldgElecDemand</span> <span class="o">=</span> <span class="n">ElecFacilityBldg</span><span class="o">/</span><span class="p">(</span><span class="n">TimeStepZone</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-557"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalHVACElecDemand</span> <span class="o">=</span> <span class="n">ElecFacilityHVAC</span><span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-558"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalElectricDemand</span> <span class="o">=</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalBldgElecDemand</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-559"></a>                                               <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalHVACElecDemand</span>
<a name="ln-560"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElecProducedPVRate</span>  <span class="o">=</span> <span class="n">ElecProducedPV</span><span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-561"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElecProducedWTRate</span>  <span class="o">=</span> <span class="n">ElecProducedWT</span><span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-562"></a>
<a name="ln-563"></a>  <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalElectricDemand</span> <span class="c">!- WholeBldgElectSummary%ElecProducedPVRate</span>
<a name="ln-564"></a>
<a name="ln-565"></a>
<a name="ln-566"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">UpdateMetersOnly</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! just update record keeping, don&#39;t resimulate load centers</span>
<a name="ln-567"></a>    <span class="k">CALL </span><span class="n">ManageTransformers</span><span class="p">()</span>
<a name="ln-568"></a>
<a name="ln-569"></a>    <span class="k">CALL </span><span class="n">UpdateWholeBuildingRecords</span>
<a name="ln-570"></a>    <span class="k">RETURN</span>
<a name="ln-571"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-572"></a>
<a name="ln-573"></a>
<a name="ln-574"></a>  <span class="c">! dispatch across load centers and generators keeping track of remaining whole building load.</span>
<a name="ln-575"></a>
<a name="ln-576"></a>  <span class="k">DO </span><span class="n">LoadCenterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumLoadCenters</span>
<a name="ln-577"></a>
<a name="ln-578"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DemandMeterPtr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-579"></a>      <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">OperationScheme</span> <span class="o">==</span> <span class="n">iOpSchemeTrackMeter</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! keep trying to setup</span>
<a name="ln-580"></a>        <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DemandMeterPtr</span> <span class="o">=</span>  <span class="n">GetMeterIndex</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DemandMeterName</span><span class="p">)</span>
<a name="ln-581"></a>    <span class="n">ENDIF</span>
<a name="ln-582"></a>
<a name="ln-583"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-584"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-585"></a>
<a name="ln-586"></a>   <span class="c">! Check Operation Scheme and assign power generation load</span>
<a name="ln-587"></a>   <span class="c">! Both the Demand Limit and Track Electrical schemes will sequentially load the available generators.  All demand</span>
<a name="ln-588"></a>   <span class="c">! not met by available generator capacity will be met by purchased electrical.</span>
<a name="ln-589"></a>   <span class="c">! If a generator is needed in the simulation for a small load and it is less than the minimum part load ratio</span>
<a name="ln-590"></a>   <span class="c">! the generator will operate at the minimum part load ratio and the excess will either reduce demand or</span>
<a name="ln-591"></a>   <span class="c">! be available for storage or sell back to the power company.</span>
<a name="ln-592"></a>    <span class="n">TypeOfEquip</span><span class="p">:</span> <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">OperationScheme</span><span class="p">)</span>
<a name="ln-593"></a>
<a name="ln-594"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">iOpSchemeBaseLoad</span><span class="p">)</span>  <span class="c">! &#39;BASELOAD&#39;</span>
<a name="ln-595"></a>
<a name="ln-596"></a>    <span class="n">LoadCenterElectricLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span>
<a name="ln-597"></a>
<a name="ln-598"></a>      <span class="k">DO </span><span class="n">GenNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-599"></a>
<a name="ln-600"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-601"></a>          <span class="c">! Set the Operation Flag</span>
<a name="ln-602"></a>          <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-603"></a>          <span class="c">! Set the electric generator load request</span>
<a name="ln-604"></a>          <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-605"></a>             <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>
<a name="ln-606"></a>        <span class="k">ELSE</span>
<a name="ln-607"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-608"></a>          <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-609"></a>        <span class="k">END IF</span>
<a name="ln-610"></a>
<a name="ln-611"></a>        <span class="c">! now handle EMS override</span>
<a name="ln-612"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-613"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-614"></a>             <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-615"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-616"></a><span class="k">            </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-617"></a>          <span class="k">ELSE</span>
<a name="ln-618"></a><span class="k">            </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-619"></a>          <span class="n">ENDIF</span>
<a name="ln-620"></a>        <span class="n">ENDIF</span>
<a name="ln-621"></a>
<a name="ln-622"></a>        <span class="c">! Get generator&#39;s actual electrical and thermal power outputs</span>
<a name="ln-623"></a>        <span class="k">CALL </span><span class="n">GeneratorPowerOutput</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">GenNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ElectricProdRate</span><span class="p">,</span><span class="n">ThermalProdRate</span><span class="p">)</span>
<a name="ln-624"></a>
<a name="ln-625"></a>        <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>    <span class="p">&amp;</span>
<a name="ln-626"></a>                                <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span>
<a name="ln-627"></a>
<a name="ln-628"></a>        <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span>  <span class="c">! Update whole building remaining load</span>
<a name="ln-629"></a>      <span class="k">END DO</span>
<a name="ln-630"></a>
<a name="ln-631"></a><span class="k">    CASE</span> <span class="p">(</span><span class="n">iOpSchemeDemandLimit</span><span class="p">)</span>  <span class="c">! &#39;DEMAND LIMIT&#39;</span>
<a name="ln-632"></a>     <span class="c">! The Demand Limit scheme tries to have the generators meet all of the demand above the purchased Electric</span>
<a name="ln-633"></a>     <span class="c">!  limit set by the user.</span>
<a name="ln-634"></a>     <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DemandLimit</span>
<a name="ln-635"></a>     <span class="n">LoadCenterElectricLoad</span> <span class="o">=</span> <span class="n">RemainingLoad</span>
<a name="ln-636"></a>
<a name="ln-637"></a>     <span class="k">DO </span><span class="n">GenNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-638"></a>
<a name="ln-639"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0D0</span> <span class="p">&amp;</span>
<a name="ln-640"></a>          <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">RemainingLoad</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-641"></a>         <span class="c">! Set the Operation Flag</span>
<a name="ln-642"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-643"></a>
<a name="ln-644"></a>         <span class="c">! Set the electric generator load</span>
<a name="ln-645"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-646"></a>                 <span class="nb">MIN</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span><span class="p">,</span><span class="n">RemainingLoad</span><span class="p">)</span>
<a name="ln-647"></a>
<a name="ln-648"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-649"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-650"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-651"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-652"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-653"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-654"></a>           <span class="k">ELSE</span>
<a name="ln-655"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-656"></a>           <span class="n">ENDIF</span>
<a name="ln-657"></a>         <span class="n">ENDIF</span>
<a name="ln-658"></a>
<a name="ln-659"></a>       <span class="k">ELSE</span>
<a name="ln-660"></a><span class="k">         </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-661"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-662"></a>
<a name="ln-663"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-664"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-665"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-666"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-667"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-668"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-669"></a>           <span class="k">ELSE</span>
<a name="ln-670"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-671"></a>           <span class="n">ENDIF</span>
<a name="ln-672"></a>         <span class="n">ENDIF</span>
<a name="ln-673"></a>       <span class="k">END IF</span>
<a name="ln-674"></a>
<a name="ln-675"></a>       <span class="c">! Get generator&#39;s actual electrical and thermal power outputs</span>
<a name="ln-676"></a>       <span class="k">CALL </span><span class="n">GeneratorPowerOutput</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">GenNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ElectricProdRate</span><span class="p">,</span><span class="n">ThermalProdRate</span><span class="p">)</span>
<a name="ln-677"></a>
<a name="ln-678"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-679"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="p">&amp;</span>
<a name="ln-680"></a>                                 <span class="o">+</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-681"></a>       <span class="k">ELSE</span>
<a name="ln-682"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-683"></a><span class="k">              </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>  <span class="p">&amp;</span>
<a name="ln-684"></a>                                                    <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>
<a name="ln-685"></a>              <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-686"></a>                                 <span class="nb">MIN</span><span class="p">(</span><span class="n">LoadCenterElectricLoad</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span><span class="p">)</span>
<a name="ln-687"></a>          <span class="n">ENDIF</span>
<a name="ln-688"></a>       <span class="n">ENDIF</span>
<a name="ln-689"></a>       <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">RemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update remaining load to be met by this load center</span>
<a name="ln-690"></a>       <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update whole building remaining load</span>
<a name="ln-691"></a>
<a name="ln-692"></a>     <span class="k">END DO</span>
<a name="ln-693"></a>
<a name="ln-694"></a><span class="k">   CASE</span> <span class="p">(</span><span class="n">iOpSchemeTrackElectrical</span><span class="p">)</span>  <span class="c">! &#39;TRACK ELECTRICAL&#39;</span>
<a name="ln-695"></a>     <span class="c">!The Track Electrical scheme tries to have the generators meet all of the electrical demand for the building.</span>
<a name="ln-696"></a>     <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span>
<a name="ln-697"></a>     <span class="n">LoadCenterElectricLoad</span> <span class="o">=</span> <span class="n">RemainingLoad</span>
<a name="ln-698"></a>
<a name="ln-699"></a>     <span class="k">DO </span><span class="n">GenNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-700"></a>
<a name="ln-701"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0D0</span> <span class="p">&amp;</span>
<a name="ln-702"></a>          <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">RemainingLoad</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-703"></a>         <span class="c">! Set the Operation Flag</span>
<a name="ln-704"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-705"></a>
<a name="ln-706"></a>         <span class="c">! Set the electric generator load</span>
<a name="ln-707"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-708"></a>                 <span class="nb">MIN</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span><span class="p">,</span><span class="n">RemainingLoad</span><span class="p">)</span>
<a name="ln-709"></a>
<a name="ln-710"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-711"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-712"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-713"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-714"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-715"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-716"></a>           <span class="k">ELSE</span>
<a name="ln-717"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-718"></a>           <span class="n">ENDIF</span>
<a name="ln-719"></a>         <span class="n">ENDIF</span>
<a name="ln-720"></a>
<a name="ln-721"></a>       <span class="k">ELSE</span>
<a name="ln-722"></a><span class="k">         </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-723"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-724"></a>
<a name="ln-725"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-726"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-727"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-728"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-729"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-730"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-731"></a>           <span class="k">ELSE</span>
<a name="ln-732"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-733"></a>           <span class="n">ENDIF</span>
<a name="ln-734"></a>         <span class="n">ENDIF</span>
<a name="ln-735"></a>       <span class="k">END IF</span>
<a name="ln-736"></a>
<a name="ln-737"></a>       <span class="c">! Get generator&#39;s actual electrical and thermal power outputs</span>
<a name="ln-738"></a>       <span class="k">CALL </span><span class="n">GeneratorPowerOutput</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">GenNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ElectricProdRate</span><span class="p">,</span><span class="n">ThermalProdRate</span><span class="p">)</span>
<a name="ln-739"></a>
<a name="ln-740"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-741"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="p">&amp;</span>
<a name="ln-742"></a>                                 <span class="o">+</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-743"></a>       <span class="k">ELSE</span>
<a name="ln-744"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-745"></a><span class="k">              </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>  <span class="p">&amp;</span>
<a name="ln-746"></a>                                                    <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>
<a name="ln-747"></a>              <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-748"></a>                                 <span class="nb">MIN</span><span class="p">(</span><span class="n">LoadCenterElectricLoad</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span><span class="p">)</span>
<a name="ln-749"></a>          <span class="n">ENDIF</span>
<a name="ln-750"></a>       <span class="n">ENDIF</span>
<a name="ln-751"></a>       <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">RemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update remaining load to be met by this load center</span>
<a name="ln-752"></a>       <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update whole building remaining load</span>
<a name="ln-753"></a>
<a name="ln-754"></a>     <span class="k">END DO</span>
<a name="ln-755"></a>
<a name="ln-756"></a><span class="k">   CASE</span> <span class="p">(</span><span class="n">iOpSchemeTrackSchedule</span><span class="p">)</span> <span class="c">! &#39;TRACK SCHEDULE&#39;</span>
<a name="ln-757"></a>     <span class="c">! The Track Schedule scheme tries to have the generators meet the electrical demand determined from a schedule.</span>
<a name="ln-758"></a>     <span class="c">!  Code is very similar to &#39;Track Electrical&#39; except for initial RemainingLoad is replaced by SchedElecDemand</span>
<a name="ln-759"></a>     <span class="c">!  and PV production is ignored.</span>
<a name="ln-760"></a>     <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TrackSchedPtr</span><span class="p">)</span>
<a name="ln-761"></a>     <span class="n">LoadCenterElectricLoad</span> <span class="o">=</span> <span class="n">RemainingLoad</span>
<a name="ln-762"></a>
<a name="ln-763"></a>     <span class="k">DO </span><span class="n">GenNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-764"></a>
<a name="ln-765"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0D0</span> <span class="p">&amp;</span>
<a name="ln-766"></a>          <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">RemainingLoad</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-767"></a>         <span class="c">! Set the Operation Flag</span>
<a name="ln-768"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-769"></a>
<a name="ln-770"></a>         <span class="c">! Set the electric generator load</span>
<a name="ln-771"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-772"></a>                 <span class="nb">MIN</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span><span class="p">,</span><span class="n">RemainingLoad</span><span class="p">)</span>
<a name="ln-773"></a>
<a name="ln-774"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-775"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-776"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-777"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-778"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-779"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-780"></a>           <span class="k">ELSE</span>
<a name="ln-781"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-782"></a>           <span class="n">ENDIF</span>
<a name="ln-783"></a>         <span class="n">ENDIF</span>
<a name="ln-784"></a>       <span class="k">ELSE</span>
<a name="ln-785"></a><span class="k">         </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-786"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-787"></a>
<a name="ln-788"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-789"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-790"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-791"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-792"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-793"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-794"></a>           <span class="k">ELSE</span>
<a name="ln-795"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-796"></a>           <span class="n">ENDIF</span>
<a name="ln-797"></a>         <span class="n">ENDIF</span>
<a name="ln-798"></a>       <span class="k">END IF</span>
<a name="ln-799"></a>
<a name="ln-800"></a>       <span class="c">! Get generator&#39;s actual electrical and thermal power outputs</span>
<a name="ln-801"></a>       <span class="k">CALL </span><span class="n">GeneratorPowerOutput</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">GenNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ElectricProdRate</span><span class="p">,</span><span class="n">ThermalProdRate</span><span class="p">)</span>
<a name="ln-802"></a>
<a name="ln-803"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-804"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="p">&amp;</span>
<a name="ln-805"></a>                                 <span class="o">+</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-806"></a>       <span class="k">ELSE</span>
<a name="ln-807"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-808"></a><span class="k">              </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>  <span class="p">&amp;</span>
<a name="ln-809"></a>                                                    <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>
<a name="ln-810"></a>              <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-811"></a>                                 <span class="nb">MIN</span><span class="p">(</span><span class="n">LoadCenterElectricLoad</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span><span class="p">)</span>
<a name="ln-812"></a>          <span class="n">ENDIF</span>
<a name="ln-813"></a>       <span class="n">ENDIF</span>
<a name="ln-814"></a>       <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">RemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update remaining load to be met by this load center</span>
<a name="ln-815"></a>       <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update whole building remaining load</span>
<a name="ln-816"></a>
<a name="ln-817"></a>     <span class="k">END DO</span>
<a name="ln-818"></a>
<a name="ln-819"></a><span class="k">   CASE</span> <span class="p">(</span><span class="n">iOpSchemeTrackMeter</span><span class="p">)</span>  <span class="c">! &#39;TRACK METER&#39;</span>
<a name="ln-820"></a>     <span class="c">! The TRACK CUSTOM METER scheme tries to have the generators meet all of the</span>
<a name="ln-821"></a>     <span class="c">!   electrical demand from a meter, it can also be a user-defined Custom Meter</span>
<a name="ln-822"></a>     <span class="c">!   and PV is ignored.</span>
<a name="ln-823"></a>     <span class="n">CustomMeterDemand</span> <span class="o">=</span>  <span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DemandMeterPtr</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-824"></a>                          <span class="o">+</span> <span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DemandMeterPtr</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-825"></a>
<a name="ln-826"></a>     <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">CustomMeterDemand</span>
<a name="ln-827"></a>     <span class="n">LoadCenterElectricLoad</span> <span class="o">=</span> <span class="n">RemainingLoad</span>
<a name="ln-828"></a>
<a name="ln-829"></a>     <span class="k">DO </span><span class="n">GenNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-830"></a>
<a name="ln-831"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0D0</span> <span class="p">&amp;</span>
<a name="ln-832"></a>          <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">RemainingLoad</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-833"></a>         <span class="c">! Set the Operation Flag</span>
<a name="ln-834"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-835"></a>         <span class="c">! Set the electric generator load</span>
<a name="ln-836"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-837"></a>                 <span class="nb">MIN</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span><span class="p">,</span><span class="n">RemainingLoad</span><span class="p">)</span>
<a name="ln-838"></a>
<a name="ln-839"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-840"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-841"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-842"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-843"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-844"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-845"></a>           <span class="k">ELSE</span>
<a name="ln-846"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-847"></a>           <span class="n">ENDIF</span>
<a name="ln-848"></a>         <span class="n">ENDIF</span>
<a name="ln-849"></a>
<a name="ln-850"></a>       <span class="k">ELSE</span>
<a name="ln-851"></a><span class="k">         </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-852"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-853"></a>
<a name="ln-854"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-855"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-856"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-857"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-858"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-859"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-860"></a>           <span class="k">ELSE</span>
<a name="ln-861"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-862"></a>           <span class="n">ENDIF</span>
<a name="ln-863"></a>         <span class="n">ENDIF</span>
<a name="ln-864"></a>       <span class="k">END IF</span>
<a name="ln-865"></a>
<a name="ln-866"></a>       <span class="c">! Get generator&#39;s actual electrical and thermal power outputs</span>
<a name="ln-867"></a>       <span class="k">CALL </span><span class="n">GeneratorPowerOutput</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">GenNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ElectricProdRate</span><span class="p">,</span><span class="n">ThermalProdRate</span><span class="p">)</span>
<a name="ln-868"></a>
<a name="ln-869"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-870"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="p">&amp;</span>
<a name="ln-871"></a>                                 <span class="o">+</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-872"></a>       <span class="k">ELSE</span>
<a name="ln-873"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-874"></a><span class="k">              </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>  <span class="p">&amp;</span>
<a name="ln-875"></a>                                                    <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>
<a name="ln-876"></a>              <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-877"></a>                                 <span class="nb">MIN</span><span class="p">(</span><span class="n">LoadCenterElectricLoad</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span><span class="p">)</span>
<a name="ln-878"></a>          <span class="n">ENDIF</span>
<a name="ln-879"></a>       <span class="n">ENDIF</span>
<a name="ln-880"></a>       <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">RemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update remaining load to be met by this load center</span>
<a name="ln-881"></a>       <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update whole building remaining load</span>
<a name="ln-882"></a>
<a name="ln-883"></a>     <span class="k">END DO</span>
<a name="ln-884"></a>
<a name="ln-885"></a><span class="k">   CASE</span> <span class="p">(</span><span class="n">iOpSchemeThermalFollow</span><span class="p">)</span>
<a name="ln-886"></a>     <span class="c">! Turn thermal load into an electrical load for cogenerators controlled to follow heat loads</span>
<a name="ln-887"></a>     <span class="n">RemainingThermalLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-888"></a>
<a name="ln-889"></a>     <span class="k">CALL </span><span class="n">CalcLoadCenterThermalLoad</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">LoadCenterNum</span><span class="p">,</span> <span class="n">RemainingThermalLoad</span><span class="p">)</span>
<a name="ln-890"></a>     <span class="n">LoadCenterThermalLoad</span> <span class="o">=</span> <span class="n">RemainingThermalLoad</span>
<a name="ln-891"></a>
<a name="ln-892"></a>     <span class="k">DO </span><span class="n">GenNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-893"></a>
<a name="ln-894"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0D0</span> <span class="p">&amp;</span>
<a name="ln-895"></a>          <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">RemainingThermalLoad</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-896"></a>
<a name="ln-897"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-898"></a>
<a name="ln-899"></a><span class="k">           </span><span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">RemainingThermalLoad</span> <span class="o">/</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span>
<a name="ln-900"></a>
<a name="ln-901"></a>           <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-902"></a>                                         <span class="nb">MIN</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span><span class="p">,</span><span class="n">RemainingLoad</span><span class="p">)</span>
<a name="ln-903"></a>
<a name="ln-904"></a>           <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-905"></a>           <span class="c">! now handle EMS override</span>
<a name="ln-906"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-907"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-908"></a>                      <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-909"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-910"></a><span class="k">               </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-911"></a>             <span class="k">ELSE</span>
<a name="ln-912"></a><span class="k">               </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-913"></a>             <span class="n">ENDIF</span>
<a name="ln-914"></a>           <span class="n">ENDIF</span>
<a name="ln-915"></a>
<a name="ln-916"></a>         <span class="n">ENDIF</span>
<a name="ln-917"></a>       <span class="k">ELSE</span>
<a name="ln-918"></a><span class="k">         </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-919"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-920"></a>
<a name="ln-921"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-922"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-923"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-924"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-925"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-926"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-927"></a>           <span class="k">ELSE</span>
<a name="ln-928"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-929"></a>           <span class="n">ENDIF</span>
<a name="ln-930"></a>         <span class="n">ENDIF</span>
<a name="ln-931"></a>       <span class="n">ENDIF</span>
<a name="ln-932"></a>
<a name="ln-933"></a>       <span class="c">! Get generator&#39;s actual electrical and thermal power outputs</span>
<a name="ln-934"></a>       <span class="k">CALL </span><span class="n">GeneratorPowerOutput</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">GenNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ElectricProdRate</span><span class="p">,</span><span class="n">ThermalProdRate</span><span class="p">)</span>
<a name="ln-935"></a>
<a name="ln-936"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-937"></a>
<a name="ln-938"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span> <span class="o">=</span>                                       <span class="p">&amp;</span>
<a name="ln-939"></a>                             <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span>                      <span class="p">&amp;</span>
<a name="ln-940"></a>                          <span class="o">+</span> <span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">))</span>  <span class="p">&amp;</span>
<a name="ln-941"></a>                          <span class="o">*</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span>
<a name="ln-942"></a>          <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>                                              <span class="p">&amp;</span>
<a name="ln-943"></a>                               <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>                           <span class="p">&amp;</span>
<a name="ln-944"></a>                               <span class="o">+</span> <span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">))</span>
<a name="ln-945"></a>       <span class="k">ELSE</span>
<a name="ln-946"></a>
<a name="ln-947"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span> <span class="o">&lt;</span>  <span class="n">LoadCenterThermalLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-948"></a>              <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-949"></a>
<a name="ln-950"></a><span class="k">             </span><span class="n">ExcessThermalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span>         <span class="p">&amp;</span>
<a name="ln-951"></a>                                     <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>        <span class="p">&amp;</span>
<a name="ln-952"></a>                                <span class="o">*</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span>  <span class="p">&amp;</span>
<a name="ln-953"></a>                                <span class="o">-</span> <span class="n">LoadCenterThermalLoad</span>
<a name="ln-954"></a>
<a name="ln-955"></a>             <span class="k">IF</span> <span class="p">(</span> <span class="n">ExcessThermalPowerRequest</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-956"></a><span class="k">                </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span> <span class="o">=</span>                                  <span class="p">&amp;</span>
<a name="ln-957"></a>                                <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span>                    <span class="p">&amp;</span>
<a name="ln-958"></a>                                <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>               <span class="p">&amp;</span>
<a name="ln-959"></a>                                <span class="o">*</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span>
<a name="ln-960"></a>                <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>                                         <span class="p">&amp;</span>
<a name="ln-961"></a>                                  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>                         <span class="p">&amp;</span>
<a name="ln-962"></a>                                <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>
<a name="ln-963"></a>             <span class="k">ELSE</span>
<a name="ln-964"></a><span class="k">               </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span> <span class="o">=</span> <span class="n">LoadCenterThermalLoad</span>
<a name="ln-965"></a>               <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-966"></a><span class="k">                   </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>                                      <span class="p">&amp;</span>
<a name="ln-967"></a>                                  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>                         <span class="p">&amp;</span>
<a name="ln-968"></a>                                <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>               <span class="p">&amp;</span>
<a name="ln-969"></a>                                <span class="o">-</span> <span class="p">(</span><span class="n">ExcessThermalPowerRequest</span>                                              <span class="p">&amp;</span>
<a name="ln-970"></a>                                <span class="o">/</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span><span class="p">)</span>
<a name="ln-971"></a>               <span class="n">ENDIF</span>
<a name="ln-972"></a>             <span class="n">ENDIF</span>
<a name="ln-973"></a>
<a name="ln-974"></a>          <span class="n">ENDIF</span>
<a name="ln-975"></a>
<a name="ln-976"></a>       <span class="n">ENDIF</span>
<a name="ln-977"></a>
<a name="ln-978"></a>       <span class="n">RemainingThermalLoad</span> <span class="o">=</span> <span class="n">RemainingThermalLoad</span> <span class="o">-</span> <span class="n">ThermalProdRate</span>  <span class="c">! Update remaining load to be met</span>
<a name="ln-979"></a>                                                                      <span class="c">! by this load center</span>
<a name="ln-980"></a>       <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update whole building remaining load</span>
<a name="ln-981"></a>
<a name="ln-982"></a>     <span class="n">ENDDO</span>
<a name="ln-983"></a>
<a name="ln-984"></a>   <span class="k">CASE</span> <span class="p">(</span><span class="n">iOpSchemeThermalFollowLimitElectrical</span><span class="p">)</span>
<a name="ln-985"></a>     <span class="c">!  Turn a thermal load into an electrical load for cogenerators controlled to follow heat loads.</span>
<a name="ln-986"></a>     <span class="c">!  Add intitialization of RemainingThermalLoad as in the ThermalFollow operating scheme above.</span>
<a name="ln-987"></a>     <span class="k">CALL </span><span class="n">CalcLoadCenterThermalLoad</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">LoadCenterNum</span><span class="p">,</span> <span class="n">RemainingThermalLoad</span><span class="p">)</span>
<a name="ln-988"></a>     <span class="c">! Total current electrical demand for the building is a secondary limit.</span>
<a name="ln-989"></a>     <span class="n">RemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span>
<a name="ln-990"></a>     <span class="n">LoadCenterElectricLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span>
<a name="ln-991"></a>     <span class="n">LoadCenterThermalLoad</span> <span class="o">=</span> <span class="n">RemainingThermalLoad</span>
<a name="ln-992"></a>
<a name="ln-993"></a>     <span class="k">DO </span><span class="n">GenNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-994"></a>
<a name="ln-995"></a>       <span class="k">IF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-996"></a>          <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">RemainingThermalLoad</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">RemainingLoad</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-997"></a>
<a name="ln-998"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-999"></a>
<a name="ln-1000"></a><span class="k">           </span><span class="n">RemainingLoad</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">WholeBldgRemainingLoad</span><span class="p">,</span> <span class="n">RemainingThermalLoad</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-1001"></a>                                      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span><span class="p">)</span>
<a name="ln-1002"></a>
<a name="ln-1003"></a>           <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1004"></a>                                         <span class="nb">MIN</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span><span class="p">,</span><span class="n">RemainingLoad</span><span class="p">)</span>
<a name="ln-1005"></a>
<a name="ln-1006"></a>           <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1007"></a>           <span class="c">! now handle EMS override</span>
<a name="ln-1008"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1009"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1010"></a>                      <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-1011"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1012"></a><span class="k">               </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1013"></a>             <span class="k">ELSE</span>
<a name="ln-1014"></a><span class="k">               </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1015"></a>             <span class="n">ENDIF</span>
<a name="ln-1016"></a>           <span class="n">ENDIF</span>
<a name="ln-1017"></a>
<a name="ln-1018"></a>         <span class="n">ENDIF</span>
<a name="ln-1019"></a>
<a name="ln-1020"></a>       <span class="k">ELSE</span>
<a name="ln-1021"></a>
<a name="ln-1022"></a><span class="k">         </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1023"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1024"></a>         <span class="c">! now handle EMS override</span>
<a name="ln-1025"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1026"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1027"></a>                    <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-1028"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1029"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1030"></a>           <span class="k">ELSE</span>
<a name="ln-1031"></a><span class="k">             </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1032"></a>           <span class="n">ENDIF</span>
<a name="ln-1033"></a>         <span class="n">ENDIF</span>
<a name="ln-1034"></a>
<a name="ln-1035"></a>       <span class="n">ENDIF</span>
<a name="ln-1036"></a>
<a name="ln-1037"></a>       <span class="c">! Get generator&#39;s actual electrical and thermal power outputs</span>
<a name="ln-1038"></a>       <span class="k">CALL </span><span class="n">GeneratorPowerOutput</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">GenNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ElectricProdRate</span><span class="p">,</span><span class="n">ThermalProdRate</span><span class="p">)</span>
<a name="ln-1039"></a>
<a name="ln-1040"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSRequestOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1041"></a>
<a name="ln-1042"></a><span class="k">           </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span> <span class="o">=</span>                                       <span class="p">&amp;</span>
<a name="ln-1043"></a>                              <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span>                      <span class="p">&amp;</span>
<a name="ln-1044"></a>                           <span class="o">+</span> <span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">))</span>  <span class="p">&amp;</span>
<a name="ln-1045"></a>                           <span class="o">*</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span>
<a name="ln-1046"></a>           <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>                                              <span class="p">&amp;</span>
<a name="ln-1047"></a>                                <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>                           <span class="p">&amp;</span>
<a name="ln-1048"></a>                                <span class="o">+</span> <span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">EMSPowerRequest</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">))</span>
<a name="ln-1049"></a>       <span class="k">ELSE</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span> <span class="o">&lt;</span>  <span class="n">LoadCenterThermalLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1052"></a>              <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1053"></a>
<a name="ln-1054"></a><span class="k">             </span><span class="n">ExcessThermalPowerRequest</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span>         <span class="p">&amp;</span>
<a name="ln-1055"></a>                                     <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>        <span class="p">&amp;</span>
<a name="ln-1056"></a>                                <span class="o">*</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span>  <span class="p">&amp;</span>
<a name="ln-1057"></a>                                <span class="o">-</span> <span class="n">LoadCenterThermalLoad</span>
<a name="ln-1058"></a>
<a name="ln-1059"></a>             <span class="k">IF</span> <span class="p">(</span> <span class="n">ExcessThermalPowerRequest</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1060"></a><span class="k">                </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span> <span class="o">=</span>                                  <span class="p">&amp;</span>
<a name="ln-1061"></a>                                <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span>                    <span class="p">&amp;</span>
<a name="ln-1062"></a>                                <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>               <span class="p">&amp;</span>
<a name="ln-1063"></a>                                <span class="o">*</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span>
<a name="ln-1064"></a>                <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>                                         <span class="p">&amp;</span>
<a name="ln-1065"></a>                                  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>                         <span class="p">&amp;</span>
<a name="ln-1066"></a>                                <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>
<a name="ln-1067"></a>             <span class="k">ELSE</span>
<a name="ln-1068"></a><span class="k">               </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalThermalPowerRequest</span> <span class="o">=</span> <span class="n">LoadCenterThermalLoad</span>
<a name="ln-1069"></a>               <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1070"></a><span class="k">                   </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>                                      <span class="p">&amp;</span>
<a name="ln-1071"></a>                                  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span>                         <span class="p">&amp;</span>
<a name="ln-1072"></a>                                <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">MaxPowerOut</span>               <span class="p">&amp;</span>
<a name="ln-1073"></a>                                <span class="o">-</span> <span class="p">(</span><span class="n">ExcessThermalPowerRequest</span>                                              <span class="p">&amp;</span>
<a name="ln-1074"></a>                                <span class="o">/</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span><span class="p">)</span>
<a name="ln-1075"></a>               <span class="n">ENDIF</span>
<a name="ln-1076"></a>             <span class="n">ENDIF</span>
<a name="ln-1077"></a>
<a name="ln-1078"></a>             <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1079"></a>                              <span class="nb">MIN</span><span class="p">(</span><span class="n">LoadCenterElectricLoad</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span><span class="p">)</span>
<a name="ln-1080"></a>
<a name="ln-1081"></a>          <span class="n">ENDIF</span>
<a name="ln-1082"></a>
<a name="ln-1083"></a>       <span class="n">ENDIF</span>
<a name="ln-1084"></a>
<a name="ln-1085"></a>       <span class="n">RemainingThermalLoad</span> <span class="o">=</span> <span class="n">RemainingThermalLoad</span> <span class="o">-</span> <span class="n">ThermalProdRate</span>  <span class="c">! Update remaining thermal load to</span>
<a name="ln-1086"></a>                                                                      <span class="c">! be met by this load center</span>
<a name="ln-1087"></a>
<a name="ln-1088"></a>       <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">ElectricProdRate</span> <span class="c">! Update whole building remaining</span>
<a name="ln-1089"></a>                                                                          <span class="c">! electric load</span>
<a name="ln-1090"></a>     <span class="n">ENDDO</span>
<a name="ln-1091"></a>
<a name="ln-1092"></a>   <span class="k">CASE</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c">! This case allows for the reporting to be done without generators specified.</span>
<a name="ln-1093"></a>
<a name="ln-1094"></a>   <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1095"></a>     <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Invalid operation scheme type for Electric Load Center=&#39;</span>  <span class="p">&amp;</span>
<a name="ln-1096"></a>                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1097"></a>
<a name="ln-1098"></a>
<a name="ln-1099"></a>   <span class="k">END SELECT </span><span class="n">TypeOfEquip</span>
<a name="ln-1100"></a>
<a name="ln-1101"></a>   <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElectDemand</span> <span class="o">=</span> <span class="n">LoadCenterElectricLoad</span> <span class="c">!To obtain the load for transformer</span>
<a name="ln-1102"></a>
<a name="ln-1103"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">StoragePresent</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1104"></a>         <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">BussType</span>  <span class="o">==</span> <span class="n">DCBussInverterDCStorage</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1105"></a><span class="k">      CALL </span><span class="n">ManageElectCenterStorageInteractions</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">StorageDrawnPower</span><span class="p">,</span><span class="n">StorageStoredPower</span><span class="p">)</span>
<a name="ln-1106"></a><span class="c">!     Adjust whole building electric demand based on storage inputs and outputs</span>
<a name="ln-1107"></a>      <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">StorageDrawnPower</span> <span class="o">+</span> <span class="n">StorageStoredPower</span>
<a name="ln-1108"></a>    <span class="n">ENDIF</span>
<a name="ln-1109"></a>
<a name="ln-1110"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">InverterPresent</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ManageInverter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)</span>
<a name="ln-1111"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">StoragePresent</span><span class="p">)</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1112"></a>         <span class="p">(</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">BussType</span>  <span class="o">==</span> <span class="n">DCBussInverterACStorage</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1113"></a>           <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">BussType</span>  <span class="o">==</span> <span class="n">ACBussStorage</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1114"></a><span class="k">      CALL </span><span class="n">ManageElectCenterStorageInteractions</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">StorageDrawnPower</span><span class="p">,</span><span class="n">StorageStoredPower</span><span class="p">)</span>
<a name="ln-1115"></a>      <span class="n">WholeBldgRemainingLoad</span> <span class="o">=</span> <span class="n">WholeBldgRemainingLoad</span> <span class="o">-</span> <span class="n">StorageDrawnPower</span> <span class="o">+</span> <span class="n">StorageStoredPower</span>
<a name="ln-1116"></a>    <span class="n">ENDIF</span>
<a name="ln-1117"></a>
<a name="ln-1118"></a>    <span class="k">CALL </span><span class="n">UpdateLoadCenterRecords</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)</span>
<a name="ln-1119"></a>
<a name="ln-1120"></a>  <span class="n">ENDDO</span>  <span class="c">!End of Load Center Do Loop</span>
<a name="ln-1121"></a>
<a name="ln-1122"></a><span class="c">! The transformer call should be put outside of the &quot;Load Center&quot; loop because</span>
<a name="ln-1123"></a><span class="c">! 1) A transformer may be for utility, not for load center</span>
<a name="ln-1124"></a><span class="c">! 2) A tansformer may be shared by multiple load centers</span>
<a name="ln-1125"></a>  <span class="k">CALL </span><span class="n">ManageTransformers</span><span class="p">()</span>
<a name="ln-1126"></a>
<a name="ln-1127"></a>  <span class="k">CALL </span><span class="n">UpdateWholeBuildingRecords</span>
<a name="ln-1128"></a>
<a name="ln-1129"></a>  <span class="c">! Need to simulate through the Elec Manager at least twice to ensure that Heat Recovery information is included.</span>
<a name="ln-1130"></a>  <span class="c">! recheck this, may not be needed now that load centers are called more often.</span>
<a name="ln-1131"></a>  <span class="c">!  Does the IF condition also need to check if any thermal following strategies have been specified?</span>
<a name="ln-1132"></a>  <span class="c">!  That is, if only electrical following schemes, don&#39;t need to resimulate?</span>
<a name="ln-1133"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1134"></a><span class="k">     </span><span class="n">SimElecCircuits</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1135"></a>  <span class="k">ELSE</span>
<a name="ln-1136"></a><span class="k">     </span><span class="n">SimElecCircuits</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1137"></a>  <span class="k">END IF</span>
<a name="ln-1138"></a>
<a name="ln-1139"></a><span class="k">RETURN</span>
<a name="ln-1140"></a>
<a name="ln-1141"></a><span class="k">END SUBROUTINE </span><span class="n">ManageElectricLoadCenters</span>
<a name="ln-1142"></a>
<a name="ln-1143"></a>
<a name="ln-1144"></a><span class="k">SUBROUTINE </span><span class="n">GetPowerManagerInput</span>
<a name="ln-1145"></a>
<a name="ln-1146"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1147"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-1148"></a>          <span class="c">!       DATE WRITTEN   September 2000</span>
<a name="ln-1149"></a>          <span class="c">!       MODIFIED       B. Griffith, 2008 multiple load centers, inverter, storage</span>
<a name="ln-1150"></a>          <span class="c">!                      W. Wang, 2010 transformer</span>
<a name="ln-1151"></a>          <span class="c">!                      Y. KyungTae &amp; W. Wang July-August, 2011 Add a battery model</span>
<a name="ln-1152"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1153"></a>
<a name="ln-1154"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1155"></a>          <span class="c">! This subroutine reads the load center data</span>
<a name="ln-1156"></a>          <span class="c">! attributes from the input file</span>
<a name="ln-1157"></a>
<a name="ln-1158"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1159"></a>          <span class="c">! calls the Input Processor to retrieve data from input file.</span>
<a name="ln-1160"></a>          <span class="c">! The format of the Energy+.idd (the EnergyPlus input data dictionary) for the</span>
<a name="ln-1161"></a>          <span class="c">! following keywords is reflected exactly in this subroutine:</span>
<a name="ln-1162"></a>
<a name="ln-1163"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1164"></a>          <span class="c">! na</span>
<a name="ln-1165"></a>
<a name="ln-1166"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1167"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1168"></a>                             <span class="n">SameString</span><span class="p">,</span> <span class="n">MakeUPPERCase</span><span class="p">,</span> <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-1169"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-1170"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-1171"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurveIndex</span><span class="p">,</span> <span class="n">GetCurveType</span>
<a name="ln-1172"></a>  <span class="k">Use </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span><span class="p">,</span> <span class="n">IntGainTypeOf_ElectricLoadCenterInverterSimple</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1173"></a>                             <span class="n">IntGainTypeOf_ElectricLoadCenterInverterFunctionOfPower</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1174"></a>                             <span class="n">IntGainTypeOf_ElectricLoadCenterInverterLookUpTable</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1175"></a>                             <span class="n">IntGainTypeOf_ElectricLoadCenterStorageSimple</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1176"></a>                             <span class="n">IntGainTypeOf_ElectricLoadCenterStorageBattery</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1177"></a>                             <span class="n">IntGainTypeOf_ElectricLoadCenterTransformer</span>
<a name="ln-1178"></a>  <span class="k">USE </span><span class="n">DataGlobals</span>    <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">NumOfZones</span><span class="p">,</span> <span class="n">AnyEnergyManagementSystemInModel</span><span class="p">,</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1179"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-1180"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-1181"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-1182"></a>
<a name="ln-1183"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1184"></a>
<a name="ln-1185"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1186"></a>          <span class="c">! na</span>
<a name="ln-1187"></a>
<a name="ln-1188"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1189"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1190"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetPowerManagerInput: &#39;</span>
<a name="ln-1191"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1192"></a>          <span class="c">! na</span>
<a name="ln-1193"></a>
<a name="ln-1194"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1195"></a>          <span class="c">! na</span>
<a name="ln-1196"></a>
<a name="ln-1197"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1198"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">external</span> <span class="kd">::</span> <span class="n">GetMeterIndex</span>
<a name="ln-1199"></a>
<a name="ln-1200"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumGenLists</span>    <span class="c">! Number of generator lists</span>
<a name="ln-1201"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AlphaCount</span>     <span class="c">! alpha input index</span>
<a name="ln-1202"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GenCount</span>       <span class="c">! generator counter index</span>
<a name="ln-1203"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">Count</span>          <span class="c">! loop index</span>
<a name="ln-1204"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ListNum</span>        <span class="c">! List number index</span>
<a name="ln-1205"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>      <span class="c">! Number of elements in the alpha array</span>
<a name="ln-1206"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNums</span>        <span class="c">! Number of elements in the numeric array</span>
<a name="ln-1207"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStat</span>         <span class="c">! IO Status when calling get input subroutine</span>
<a name="ln-1208"></a>  <span class="c">!CHARACTER(len=MaxNameLength),DIMENSION(:), ALLOCATABLE :: Alpha !dimension to num of alpha fields in input</span>
<a name="ln-1209"></a>  <span class="c">!REAL(r64), DIMENSION(:), ALLOCATABLE   :: Num                   !dimension to num of numeric data fields in input</span>
<a name="ln-1210"></a>  <span class="kt">LOGICAL</span>               <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! error in input</span>
<a name="ln-1211"></a>  <span class="kt">LOGICAL</span>               <span class="kd">::</span> <span class="n">IsNotOK</span>              <span class="c">! Flag to verify name</span>
<a name="ln-1212"></a>  <span class="kt">LOGICAL</span>               <span class="kd">::</span> <span class="n">IsBlank</span>              <span class="c">! Flag for blank name</span>
<a name="ln-1213"></a>
<a name="ln-1214"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">ListName</span>
<a name="ln-1215"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">InverterNames</span>
<a name="ln-1216"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">StorageNames</span>
<a name="ln-1217"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">TransformerNames</span>
<a name="ln-1218"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">AnyElectricityPresent</span> <span class="c">! local test for presence of Electricty in Facility</span>
<a name="ln-1219"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumGenerators</span> <span class="c">! local number of generators per electric load center</span>
<a name="ln-1220"></a>  <span class="kt">LOGICAL</span>  <span class="kd">::</span> <span class="n">SetupWholeBldgReports</span>
<a name="ln-1221"></a>  <span class="c">!unused1208  INTEGER  :: MaxNumAlphas</span>
<a name="ln-1222"></a>  <span class="c">!unused1208  INTEGER  :: MaxNumArgs</span>
<a name="ln-1223"></a>  <span class="c">!unused1208  INTEGER  :: MaxNumNumbers</span>
<a name="ln-1224"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumofCECinverters</span>
<a name="ln-1225"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumofCurveInverters</span>
<a name="ln-1226"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumofSimpleInverters</span>
<a name="ln-1227"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumofSimpleElecStorage</span>
<a name="ln-1228"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumofKiBaMElecStorage</span>
<a name="ln-1229"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">InvertNum</span>
<a name="ln-1230"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">StorNum</span>
<a name="ln-1231"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">TransfNum</span>
<a name="ln-1232"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">Found</span>
<a name="ln-1233"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumAlphaBeforeMeter</span> <span class="c">!Number of Alpha fields before the extensible meters</span>
<a name="ln-1234"></a>                                  <span class="c">!Used to derive the number of meters wired to a transformer</span>
<a name="ln-1235"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumWiredMeters</span>      <span class="c">!Number of electric meters wired to a transformer</span>
<a name="ln-1236"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">LCofTransformer</span>     <span class="c">!Index of load center served by a transformer</span>
<a name="ln-1237"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">LoopCount</span>           <span class="c">!loop counter</span>
<a name="ln-1238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pvTotalCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! for LEED report</span>
<a name="ln-1239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">windTotalCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! for LEED report</span>
<a name="ln-1240"></a>
<a name="ln-1241"></a>  <span class="n">NumAlphaBeforeMeter</span>   <span class="o">=</span> <span class="mi">7</span>       <span class="c">!Hard coded. Changes might be needed if the transformer input structure gets changed</span>
<a name="ln-1242"></a>  <span class="n">LCofTransformer</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1243"></a>
<a name="ln-1244"></a>  <span class="c">!FLOW:</span>
<a name="ln-1245"></a>  <span class="n">SetupWholeBldgReports</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1246"></a>
<a name="ln-1247"></a>  <span class="c">!first read in any inverters that might be associated with a load center</span>
<a name="ln-1248"></a>  <span class="n">NumofCECinverters</span>    <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;ElectricLoadCenter:Inverter:LookUpTable&#39;</span><span class="p">)</span>
<a name="ln-1249"></a>  <span class="n">NumofCurveInverters</span>  <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;ElectricLoadCenter:Inverter:FunctionOfPower&#39;</span><span class="p">)</span>
<a name="ln-1250"></a>  <span class="n">NumofSimpleInverters</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;ElectricLoadCenter:Inverter:Simple&#39;</span><span class="p">)</span>
<a name="ln-1251"></a>  <span class="n">NumInverters</span>         <span class="o">=</span> <span class="n">NumofCECinverters</span> <span class="o">+</span> <span class="n">NumofCurveInverters</span> <span class="o">+</span> <span class="n">NumofSimpleInverters</span>
<a name="ln-1252"></a>
<a name="ln-1253"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">NumInverters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1254"></a><span class="k">    Allocate</span><span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">NumInverters</span><span class="p">))</span>
<a name="ln-1255"></a>    <span class="k">Allocate</span><span class="p">(</span><span class="n">InverterNames</span><span class="p">(</span><span class="n">NumInverters</span><span class="p">))</span>
<a name="ln-1256"></a>
<a name="ln-1257"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">NumofCECinverters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1258"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;ElectricLoadCenter:Inverter:LookUpTable&#39;</span>
<a name="ln-1259"></a>      <span class="k">Do </span><span class="n">InvertNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumofCECinverters</span>
<a name="ln-1260"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">InvertNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1261"></a>                         <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1262"></a>                         <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1263"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1264"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1265"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">InverterNames</span><span class="p">,</span><span class="n">InvertNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1266"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1267"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1268"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1269"></a>        <span class="n">ENDIF</span>
<a name="ln-1270"></a>        <span class="n">InverterNames</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)</span> <span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1271"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1272"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ModelType</span> <span class="o">=</span> <span class="n">CECLookUpTableModel</span>
<a name="ln-1273"></a>
<a name="ln-1274"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1275"></a><span class="k">          </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1276"></a>        <span class="k">ELSE</span>
<a name="ln-1277"></a><span class="k">          </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1278"></a>          <span class="k">If</span> <span class="p">(</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1279"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1280"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1281"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1282"></a>          <span class="n">ENDIF</span>
<a name="ln-1283"></a>        <span class="n">ENDIF</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1286"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span>  <span class="o">=</span> <span class="n">ZoneGains</span>
<a name="ln-1287"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1288"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1289"></a><span class="k">            </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1290"></a>          <span class="k">ELSE</span>
<a name="ln-1291"></a><span class="k">            </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1292"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1293"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1294"></a>            <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone name not found. Inverter heat losses will not be added to a zone&#39;</span> <span class="p">)</span>
<a name="ln-1295"></a>            <span class="c">! continue with simulation but inverter losses not sent to a zone.</span>
<a name="ln-1296"></a>          <span class="n">ENDIF</span>
<a name="ln-1297"></a>        <span class="n">ENDIF</span>
<a name="ln-1298"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1299"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">RatedPower</span>                 <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1300"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">StandbyPower</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1301"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUtable</span><span class="p">%</span><span class="n">NightTareLossPower</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1302"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUtable</span><span class="p">%</span><span class="n">NominalVoltage</span>     <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1303"></a>
<a name="ln-1304"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUtable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1305"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUtable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1306"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUtable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1307"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUtable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1308"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUtable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1309"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUtable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1310"></a>
<a name="ln-1311"></a>      <span class="n">ENDDO</span>
<a name="ln-1312"></a>    <span class="n">ENDIF</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumofCurveInverters</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1315"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;ElectricLoadCenter:Inverter:FunctionOfPower&#39;</span>
<a name="ln-1316"></a>      <span class="k">Do </span><span class="n">InvertNum</span> <span class="o">=</span> <span class="n">NumofCECinverters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumofCECinverters</span> <span class="o">+</span> <span class="n">NumofCurveInverters</span>
<a name="ln-1317"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">InvertNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1318"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1319"></a>                         <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1320"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1321"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1322"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">InverterNames</span><span class="p">,</span><span class="n">InvertNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1323"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1324"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1325"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1326"></a>        <span class="n">ENDIF</span>
<a name="ln-1327"></a>        <span class="n">InverterNames</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)</span> <span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1328"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ModelType</span> <span class="o">=</span> <span class="n">CurveFuncOfPower</span>
<a name="ln-1329"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1330"></a>
<a name="ln-1331"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1332"></a><span class="k">          </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1333"></a>        <span class="k">ELSE</span>
<a name="ln-1334"></a><span class="k">          </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1335"></a>          <span class="k">If</span> <span class="p">(</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1336"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1337"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1338"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1339"></a>          <span class="n">ENDIF</span>
<a name="ln-1340"></a>        <span class="n">ENDIF</span>
<a name="ln-1341"></a>
<a name="ln-1342"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1343"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span>  <span class="o">=</span> <span class="n">ZoneGains</span>
<a name="ln-1344"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1345"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1346"></a><span class="k">            </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1347"></a>          <span class="k">ELSE</span>
<a name="ln-1348"></a><span class="k">            </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1349"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1350"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1351"></a>                        <span class="c">! continue with simulation but inverter losses not sent to a zone.</span>
<a name="ln-1352"></a>            <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone name not found. Inverter heat losses will not be added to a zone&#39;</span> <span class="p">)</span>
<a name="ln-1353"></a>          <span class="n">ENDIF</span>
<a name="ln-1354"></a>        <span class="n">ENDIF</span>
<a name="ln-1355"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">CurveNum</span> <span class="o">=</span>  <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-1356"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">CurveNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1357"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1358"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1359"></a>          <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve was not found&#39;</span><span class="p">)</span>
<a name="ln-1360"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1361"></a>        <span class="n">ENDIF</span>
<a name="ln-1362"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1363"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">RatedPower</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1364"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">MinEfficiency</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1365"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">MaxEfficiency</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1366"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">MinPower</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1367"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">MaxPower</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1368"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">StandbyPower</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1369"></a>
<a name="ln-1370"></a>      <span class="n">ENDDO</span>
<a name="ln-1371"></a>    <span class="n">ENDIF</span>
<a name="ln-1372"></a>
<a name="ln-1373"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumofSimpleInverters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1374"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;ElectricLoadCenter:Inverter:Simple&#39;</span>
<a name="ln-1375"></a>      <span class="k">DO </span><span class="n">InvertNum</span> <span class="o">=</span> <span class="n">NumofCECinverters</span> <span class="o">+</span> <span class="n">NumofCurveInverters</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumInverters</span>
<a name="ln-1376"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">InvertNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1377"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1378"></a>                       <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1379"></a>        <span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1380"></a>        <span class="n">IsBlank</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1381"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">InverterNames</span><span class="p">,</span><span class="n">InvertNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1382"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1383"></a><span class="k">          </span><span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1384"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxx&#39;</span>
<a name="ln-1385"></a>        <span class="n">ENDIF</span>
<a name="ln-1386"></a>        <span class="n">InverterNames</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)</span> <span class="o">=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1387"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1388"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ModelType</span> <span class="o">=</span> <span class="n">SimpleConstantEff</span>
<a name="ln-1389"></a>
<a name="ln-1390"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1391"></a><span class="k">          </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1392"></a>        <span class="k">ELSE</span>
<a name="ln-1393"></a><span class="k">          </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1394"></a>          <span class="k">If</span> <span class="p">(</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1395"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1396"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1397"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1398"></a>          <span class="n">ENDIF</span>
<a name="ln-1399"></a>        <span class="n">ENDIF</span>
<a name="ln-1400"></a>
<a name="ln-1401"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1402"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span>  <span class="o">=</span> <span class="n">ZoneGains</span>
<a name="ln-1403"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1404"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1405"></a><span class="k">            </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1406"></a>          <span class="k">ELSE</span>
<a name="ln-1407"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1408"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1409"></a>            <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone name not found. Inverter heat losses will not be added to a zone&#39;</span> <span class="p">)</span>
<a name="ln-1410"></a>            <span class="c">! continue with simulation but inverter losses not sent to a zone.</span>
<a name="ln-1411"></a>          <span class="n">ENDIF</span>
<a name="ln-1412"></a>        <span class="n">ENDIF</span>
<a name="ln-1413"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1414"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1415"></a>      <span class="n">ENDDO</span>
<a name="ln-1416"></a>    <span class="n">ENDIF</span>
<a name="ln-1417"></a>
<a name="ln-1418"></a>    <span class="c">!setup reports for all inverters</span>
<a name="ln-1419"></a>    <span class="k">Do </span><span class="n">InvertNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumInverters</span>
<a name="ln-1420"></a>      <span class="k">Call </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Inverter DC to AC Efficiency []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1421"></a>           <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1422"></a>      <span class="k">Call </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Inverter DC Input Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1423"></a>           <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1424"></a>      <span class="k">Call </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Inverter DC Input Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1425"></a>           <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCEnergyIn</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1426"></a>      <span class="k">Call </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Inverter AC Output Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1427"></a>           <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACPowerOut</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1428"></a>      <span class="k">Call </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Inverter AC Output Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1429"></a>           <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACEnergyOut</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1430"></a>           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityProduced&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Photovoltaics&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span> <span class="c">! right now PV is the only DC source</span>
<a name="ln-1431"></a>      <span class="k">Call </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Inverter Thermal Loss Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1432"></a>           <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ThermLossRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1433"></a>      <span class="k">Call </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Inverter Thermal Loss Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1434"></a>           <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ThermLossEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1435"></a>      <span class="k">Call </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Inverter Ancillary AC Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1436"></a>           <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseRate</span> <span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1437"></a>      <span class="k">Call </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Inverter Ancillary AC Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1438"></a>           <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseEnergy</span> <span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1439"></a>           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cogeneration&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span> <span class="c">! called cogeneration for end use table</span>
<a name="ln-1440"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1441"></a><span class="k">        SELECT CASE</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ModelType</span><span class="p">)</span>
<a name="ln-1442"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SimpleConstantEff</span><span class="p">)</span>
<a name="ln-1443"></a>          <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1444"></a>                     <span class="s1">&#39;ElectricLoadCenter:Inverter:Simple&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1445"></a>                     <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1446"></a>                     <span class="n">IntGainTypeOf_ElectricLoadCenterInverterSimple</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1447"></a>                     <span class="n">ConvectionGainRate</span>    <span class="o">=</span>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">QdotconvZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1448"></a>                     <span class="n">ThermalRadiationGainRate</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">QdotRadZone</span> <span class="p">)</span>
<a name="ln-1449"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveFuncOfPower</span><span class="p">)</span>
<a name="ln-1450"></a>          <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1451"></a>                     <span class="s1">&#39;ElectricLoadCenter:Inverter:FunctionOfPower&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1452"></a>                     <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1453"></a>                     <span class="n">IntGainTypeOf_ElectricLoadCenterInverterFunctionOfPower</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1454"></a>                     <span class="n">ConvectionGainRate</span>    <span class="o">=</span>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">QdotconvZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1455"></a>                     <span class="n">ThermalRadiationGainRate</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">QdotRadZone</span> <span class="p">)</span>
<a name="ln-1456"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CECLookUpTableModel</span><span class="p">)</span>
<a name="ln-1457"></a>          <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1458"></a>                     <span class="s1">&#39;ElectricLoadCenter:Inverter:LookUpTable&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1459"></a>                     <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1460"></a>                     <span class="n">IntGainTypeOf_ElectricLoadCenterInverterLookUpTable</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-1461"></a>                     <span class="n">ConvectionGainRate</span>    <span class="o">=</span>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">QdotconvZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1462"></a>                     <span class="n">ThermalRadiationGainRate</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">QdotRadZone</span><span class="p">)</span>
<a name="ln-1463"></a>        <span class="k">END SELECT</span>
<a name="ln-1464"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a>    <span class="n">ENDDO</span>
<a name="ln-1467"></a>
<a name="ln-1468"></a>  <span class="n">ENDIF</span> <span class="c">!any inverters</span>
<a name="ln-1469"></a>
<a name="ln-1470"></a>  <span class="c">!read in any electrical storage devices that may be associated with load centers.</span>
<a name="ln-1471"></a>  <span class="n">NumofSimpleElecStorage</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;ElectricLoadCenter:Storage:Simple&#39;</span><span class="p">)</span>
<a name="ln-1472"></a>  <span class="n">NumofKiBaMElecStorage</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;ElectricLoadCenter:Storage:Battery&#39;</span><span class="p">)</span>
<a name="ln-1473"></a>  <span class="n">NumElecStorageDevices</span>  <span class="o">=</span> <span class="n">NumofSimpleElecStorage</span> <span class="o">+</span> <span class="n">NumofKiBaMElecStorage</span>
<a name="ln-1474"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumElecStorageDevices</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1475"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">NumElecStorageDevices</span><span class="p">))</span>
<a name="ln-1476"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">StorageNames</span><span class="p">(</span><span class="n">NumElecStorageDevices</span><span class="p">))</span>
<a name="ln-1477"></a>
<a name="ln-1478"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumofSimpleElecStorage</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1479"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;ElectricLoadCenter:Storage:Simple&#39;</span>
<a name="ln-1480"></a>      <span class="k">DO </span><span class="n">StorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumofSimpleElecStorage</span>
<a name="ln-1481"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span> <span class="n">StorNum</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1482"></a>                         <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1483"></a>                         <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1484"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1485"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1486"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">StorageNames</span><span class="p">,</span> <span class="n">StorNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1487"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1488"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1489"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxx&#39;</span>
<a name="ln-1490"></a>        <span class="n">endif</span>
<a name="ln-1491"></a>        <span class="n">StorageNames</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1492"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span>  <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1493"></a>
<a name="ln-1494"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1495"></a><span class="k">          </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1496"></a>        <span class="k">ELSE</span>
<a name="ln-1497"></a><span class="k">          </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1498"></a>          <span class="k">If</span> <span class="p">(</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1499"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1500"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1501"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1502"></a>          <span class="n">ENDIF</span>
<a name="ln-1503"></a>        <span class="n">ENDIF</span>
<a name="ln-1504"></a>
<a name="ln-1505"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1506"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span>  <span class="o">=</span> <span class="n">ZoneGains</span>
<a name="ln-1507"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1508"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1509"></a><span class="k">            </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1510"></a>          <span class="k">ELSE</span>
<a name="ln-1511"></a><span class="k">            </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1512"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1513"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1514"></a>            <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone name not found. Electrical storage heat losses will not be added to a zone&#39;</span> <span class="p">)</span>
<a name="ln-1515"></a>            <span class="c">!continue with simulation but storage losses not sent to a zone.</span>
<a name="ln-1516"></a>          <span class="n">ENDIF</span>
<a name="ln-1517"></a>        <span class="n">ENDIF</span>
<a name="ln-1518"></a>
<a name="ln-1519"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span>        <span class="o">=</span> <span class="n">SimpleBucketStorage</span>
<a name="ln-1520"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span>            <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1521"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">EnergeticEfficCharge</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1522"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">EnergeticEfficDischarge</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1523"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">MaxEnergyCapacity</span>       <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1524"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">MaxPowerDraw</span>            <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1525"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">MaxPowerStore</span>           <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1526"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StartingEnergyStored</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1527"></a>
<a name="ln-1528"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Charge State [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1529"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ElectEnergyinStorage</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span> <span class="c">!? &#39;Sum&#39;</span>
<a name="ln-1530"></a>
<a name="ln-1531"></a>      <span class="n">ENDDO</span>
<a name="ln-1532"></a>
<a name="ln-1533"></a>    <span class="n">ENDIF</span> <span class="c">!any simple storage</span>
<a name="ln-1534"></a>
<a name="ln-1535"></a>
<a name="ln-1536"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumofKiBaMElecStorage</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1537"></a><span class="k">      </span><span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;ElectricLoadCenter:Storage:Battery&#39;</span>
<a name="ln-1538"></a>      <span class="k">DO </span><span class="n">StorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">NumofSimpleElecStorage</span><span class="p">,</span> <span class="n">NumofKiBaMElecStorage</span>
<a name="ln-1539"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span> <span class="n">StorNum</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1540"></a>                         <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1541"></a>                         <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1542"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1543"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1544"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">StorageNames</span><span class="p">,</span> <span class="n">StorNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1545"></a>        <span class="k">If</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-1546"></a><span class="k">          </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1547"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxx&#39;</span>
<a name="ln-1548"></a>        <span class="n">endif</span>
<a name="ln-1549"></a>        <span class="n">StorageNames</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1550"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span>  <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1551"></a>
<a name="ln-1552"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1553"></a><span class="k">          </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1554"></a>        <span class="k">ELSE</span>
<a name="ln-1555"></a><span class="k">          </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1556"></a>          <span class="k">If</span> <span class="p">(</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1557"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1558"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1559"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1560"></a>          <span class="n">ENDIF</span>
<a name="ln-1561"></a>        <span class="n">ENDIF</span>
<a name="ln-1562"></a>
<a name="ln-1563"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1564"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span>  <span class="o">=</span> <span class="n">ZoneGains</span>
<a name="ln-1565"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1566"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1567"></a><span class="k">            </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1568"></a>          <span class="k">ELSE</span>
<a name="ln-1569"></a><span class="k">            </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1570"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1571"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1572"></a>            <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone name not found. Electrical storage heat losses will not be added to a zone&#39;</span><span class="p">)</span>
<a name="ln-1573"></a>            <span class="c">!continue with simulation but storage losses not sent to a zone.</span>
<a name="ln-1574"></a>          <span class="n">ENDIF</span>
<a name="ln-1575"></a>        <span class="n">ENDIF</span>
<a name="ln-1576"></a>
<a name="ln-1577"></a>
<a name="ln-1578"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c">!voltage calculation for charging</span>
<a name="ln-1579"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1580"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1581"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1582"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1583"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1584"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1585"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be blank. But no entry found.&#39;</span><span class="p">)</span>
<a name="ln-1586"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1587"></a>          <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span><span class="p">),</span><span class="s1">&#39;RectangularHyperbola2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1588"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1589"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1590"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve Type must be RectangularHyperbola2 but was &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1591"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span><span class="p">)))</span>
<a name="ln-1592"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1593"></a>          <span class="n">ENDIF</span>
<a name="ln-1594"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c">! voltage calculation for discharging</span>
<a name="ln-1595"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1596"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1597"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1598"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1599"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1600"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1601"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be blank. But no entry found.&#39;</span><span class="p">)</span>
<a name="ln-1602"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1603"></a>          <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span><span class="p">),</span><span class="s1">&#39;RectangularHyperbola2&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1604"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1605"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1606"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve Type must be RectangularHyperbola2 but was &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1607"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span><span class="p">)))</span>
<a name="ln-1608"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1609"></a>          <span class="n">ENDIF</span>
<a name="ln-1610"></a>
<a name="ln-1611"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Yes&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1612"></a><span class="k">            </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">LifeCalculation</span> <span class="o">=</span> <span class="n">Battery_LifeCalculation_Yes</span>
<a name="ln-1613"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;No&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1614"></a><span class="k">            </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">LifeCalculation</span> <span class="o">=</span> <span class="n">Battery_LifeCalculation_No</span>
<a name="ln-1615"></a>        <span class="k">ELSE</span>
<a name="ln-1616"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1617"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1618"></a>            <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Yes or No should be selected. Default value No is used to continue simulation&#39;</span><span class="p">)</span>
<a name="ln-1619"></a>            <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">LifeCalculation</span> <span class="o">=</span> <span class="n">Battery_LifeCalculation_No</span>
<a name="ln-1620"></a>        <span class="n">ENDIF</span>
<a name="ln-1621"></a>
<a name="ln-1622"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">LifeCalculation</span> <span class="o">==</span> <span class="n">Battery_LifeCalculation_Yes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1623"></a><span class="k">            </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">LifeCurveNum</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="c">!Battery life calculation</span>
<a name="ln-1624"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">LifeCurveNum</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1625"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1626"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1627"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1628"></a>            <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1629"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1630"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be blank when &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1631"></a>                  <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Yes. But no entry found.&#39;</span><span class="p">)</span>
<a name="ln-1632"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1633"></a>            <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">LifeCurveNum</span><span class="p">),</span><span class="s1">&#39;DoubleExponentialDecay&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1634"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1635"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1636"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Curve Type must be DoubleExponentialDecay but was &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1637"></a>                 <span class="nb">trim</span><span class="p">(</span><span class="n">GetCurveType</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">LifeCurveNum</span><span class="p">)))</span>
<a name="ln-1638"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1639"></a>            <span class="n">ENDIF</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a>            <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">CycleBinNum</span><span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-1642"></a>
<a name="ln-1643"></a>            <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! life cycle calculation for this battery, allocate arrays for degradation calculation</span>
<a name="ln-1644"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">B10</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MAXRainflowArrayBounds</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1645"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">X0</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MAXRainflowArrayBounds</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1646"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Nmb0</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">CycleBinNum</span><span class="p">))</span>
<a name="ln-1647"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">OneNmb0</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">CycleBinNum</span><span class="p">))</span>
<a name="ln-1648"></a>              <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">B10</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1649"></a>              <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">X0</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1650"></a>              <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Nmb0</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1651"></a>              <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">OneNmb0</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1652"></a>            <span class="n">ENDIF</span>
<a name="ln-1653"></a>        <span class="n">ENDIF</span>
<a name="ln-1654"></a>
<a name="ln-1655"></a>
<a name="ln-1656"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span>            <span class="o">=</span> <span class="n">KiBaMBattery</span>
<a name="ln-1657"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span>                <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1658"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ParallelNum</span>                 <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1659"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">SeriesNum</span>                   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1660"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">MaxAhCapacity</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1661"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StartingSOC</span>                 <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1662"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1663"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ChargeConversionRate</span>        <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1664"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ChargedOCV</span>                  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1665"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DischargedOCV</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1666"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">InternalR</span>                   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1667"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">MaxDischargeI</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1668"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">CutoffV</span>                     <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-1669"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">MaxChargeRate</span>               <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-1670"></a>
<a name="ln-1671"></a>
<a name="ln-1672"></a>
<a name="ln-1673"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Operating Mode Index []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1674"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StorageMode</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1675"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Charge State [Ah]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1676"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">AbsoluteSOC</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1677"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Charge Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1678"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">FractionSOC</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1679"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Total Current [A]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1680"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">BatteryCurrent</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1681"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Total Voltage [V]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1682"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">BatteryVoltage</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1683"></a>
<a name="ln-1684"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">LifeCalculation</span> <span class="o">==</span> <span class="n">Battery_LifeCalculation_Yes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1685"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Degradation Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1686"></a>                 <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">BatteryDamage</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1687"></a>        <span class="n">ENDIF</span>
<a name="ln-1688"></a>
<a name="ln-1689"></a>      <span class="n">ENDDO</span>
<a name="ln-1690"></a>
<a name="ln-1691"></a>    <span class="n">ENDIF</span> <span class="c">!any kibam storage</span>
<a name="ln-1692"></a>
<a name="ln-1693"></a>    <span class="c">!For any battery</span>
<a name="ln-1694"></a>    <span class="k">DO </span><span class="n">StorNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumofSimpleElecStorage</span><span class="o">+</span><span class="n">NumofKiBaMElecStorage</span>
<a name="ln-1695"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Charge Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1696"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StoredPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1697"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Charge Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1698"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1699"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Production Decrement Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1700"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DecrementedEnergyStored</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,&amp;</span>
<a name="ln-1701"></a>             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityProduced&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-1702"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Discharge Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1703"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DrawnPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1704"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Discharge Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1705"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DrawnEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,&amp;</span>
<a name="ln-1706"></a>              <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityProduced&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-1707"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Thermal Loss Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1708"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1709"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Storage Thermal Loss Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1710"></a>             <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ThermLossEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1711"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1712"></a><span class="k">          IF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">SimpleBucketStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1713"></a><span class="k">              CALL </span><span class="n">SetupEMSInternalVariable</span><span class="p">(</span><span class="s1">&#39;Electrical Storage Maximum Capacity&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;[J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1714"></a>                     <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">MaxEnergyCapacity</span>  <span class="p">)</span>
<a name="ln-1715"></a>          <span class="n">ELSEIF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">KiBaMBattery</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1716"></a><span class="k">              CALL </span><span class="n">SetupEMSInternalVariable</span><span class="p">(</span><span class="s1">&#39;Electrical Storage Maximum Capacity&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;[Ah]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1717"></a>                     <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">MaxAhCapacity</span>  <span class="p">)</span>
<a name="ln-1718"></a>          <span class="n">ENDIF</span>
<a name="ln-1719"></a>
<a name="ln-1720"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Electrical Storage&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;Power Draw Rate&#39;</span> <span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1721"></a>                     <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">EMSOverridePelFromStorage</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">EMSValuePelFromStorage</span> <span class="p">)</span>
<a name="ln-1722"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Electrical Storage&#39;</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;Power Charge Rate&#39;</span> <span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1723"></a>                     <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">EMSOverridePelIntoStorage</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">EMSValuePelIntoStorage</span> <span class="p">)</span>
<a name="ln-1724"></a>        <span class="n">ENDIF</span>
<a name="ln-1725"></a>
<a name="ln-1726"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1727"></a><span class="k">          SELECT CASE</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span><span class="p">)</span>
<a name="ln-1728"></a>
<a name="ln-1729"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">SimpleBucketStorage</span><span class="p">)</span>
<a name="ln-1730"></a>            <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1731"></a>                     <span class="s1">&#39;ElectricLoadCenter:Storage:Simple&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1732"></a>                     <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1733"></a>                     <span class="n">IntGainTypeOf_ElectricLoadCenterStorageSimple</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-1734"></a>                     <span class="n">ConvectionGainRate</span>    <span class="o">=</span>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">QdotconvZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1735"></a>                     <span class="n">ThermalRadiationGainRate</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">QdotRadZone</span><span class="p">)</span>
<a name="ln-1736"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">KiBaMBattery</span><span class="p">)</span>
<a name="ln-1737"></a>            <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1738"></a>                     <span class="s1">&#39;ElectricLoadCenter:Storage:Battery&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1739"></a>                     <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1740"></a>                     <span class="n">IntGainTypeOf_ElectricLoadCenterStorageBattery</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-1741"></a>                     <span class="n">ConvectionGainRate</span>    <span class="o">=</span>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">QdotconvZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1742"></a>                     <span class="n">ThermalRadiationGainRate</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">QdotRadZone</span><span class="p">)</span>
<a name="ln-1743"></a>          <span class="k">END SELECT</span>
<a name="ln-1744"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-1745"></a>
<a name="ln-1746"></a>     <span class="n">ENDDO</span>
<a name="ln-1747"></a>
<a name="ln-1748"></a>  <span class="n">ENDIF</span> <span class="c">!any storage at all</span>
<a name="ln-1749"></a>
<a name="ln-1750"></a>
<a name="ln-1751"></a>  <span class="c">!read in any electrical transformers that may be associated with load centers.</span>
<a name="ln-1752"></a>  <span class="n">NumTransformers</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;ElectricLoadCenter:Transformer&#39;</span><span class="p">)</span>
<a name="ln-1753"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumTransformers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1754"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">NumTransformers</span><span class="p">))</span>
<a name="ln-1755"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TransformerNames</span><span class="p">(</span><span class="n">NumTransformers</span><span class="p">))</span>
<a name="ln-1756"></a>
<a name="ln-1757"></a>    <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;ElectricLoadCenter:Transformer&#39;</span>
<a name="ln-1758"></a>    <span class="k">DO </span><span class="n">TransfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTransformers</span>
<a name="ln-1759"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span> <span class="n">TransfNum</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1760"></a>                         <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1761"></a>                         <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1762"></a>                         <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1763"></a>      <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1764"></a>      <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1765"></a>      <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">TransformerNames</span><span class="p">,</span> <span class="n">TransfNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1766"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1767"></a><span class="k">        </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1768"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;xxxx&#39;</span>  <span class="c">!Actually, this line is not necessary because name is a required field</span>
<a name="ln-1769"></a>      <span class="n">ENDIF</span>
<a name="ln-1770"></a>      <span class="n">TransformerNames</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1771"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span>  <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1772"></a>
<a name="ln-1773"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1774"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1775"></a>      <span class="k">ELSE</span>
<a name="ln-1776"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1777"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1778"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1779"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1780"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1781"></a>        <span class="n">ENDIF</span>
<a name="ln-1782"></a>      <span class="n">ENDIF</span>
<a name="ln-1783"></a>
<a name="ln-1784"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">,</span>    <span class="s1">&#39;PowerInFromGrid&#39;</span><span class="p">)</span> <span class="p">)</span>    <span class="k">THEN</span>
<a name="ln-1785"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">UsageMode</span>     <span class="o">=</span> <span class="n">PowerInFromGrid</span>
<a name="ln-1786"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;PowerOutFromOnsiteGeneration&#39;</span> <span class="p">)</span> <span class="p">)</span>   <span class="k">THEN</span>
<a name="ln-1787"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">UsageMode</span>     <span class="o">=</span> <span class="n">PowerOutFromBldg</span>
<a name="ln-1788"></a>      <span class="k">ELSE</span>
<a name="ln-1789"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1790"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1791"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1792"></a>      <span class="n">ENDIF</span>
<a name="ln-1793"></a>
<a name="ln-1794"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1795"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span>  <span class="o">=</span> <span class="n">ZoneGains</span>
<a name="ln-1796"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1797"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1798"></a><span class="k">          </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1799"></a>        <span class="k">ELSE</span>
<a name="ln-1800"></a><span class="k">          </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">=</span> <span class="n">LostToOutside</span>
<a name="ln-1801"></a>          <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1802"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1803"></a>          <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Zone name not found. Transformer heat losses will not be added to a zone&#39;</span> <span class="p">)</span>
<a name="ln-1804"></a>          <span class="c">!continue with simulation but storage losses not sent to a zone.</span>
<a name="ln-1805"></a>        <span class="n">ENDIF</span>
<a name="ln-1806"></a>      <span class="n">ENDIF</span>
<a name="ln-1807"></a>
<a name="ln-1808"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneRadFrac</span>           <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1809"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedCapacity</span>         <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1810"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Phase</span>                 <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1811"></a>
<a name="ln-1812"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">,</span>    <span class="s1">&#39;Copper&#39;</span><span class="p">)</span> <span class="p">)</span>    <span class="k">THEN</span>
<a name="ln-1813"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">FactorTempCoeff</span>     <span class="o">=</span> <span class="mi">23</span><span class="mf">4.5d0</span>
<a name="ln-1814"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;Aluminum&#39;</span> <span class="p">)</span> <span class="p">)</span>   <span class="k">THEN</span>
<a name="ln-1815"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">FactorTempCoeff</span>     <span class="o">=</span> <span class="mi">22</span><span class="mf">5.0d0</span>
<a name="ln-1816"></a>      <span class="k">ELSE</span>
<a name="ln-1817"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1818"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1819"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1820"></a>      <span class="n">ENDIF</span>
<a name="ln-1821"></a>
<a name="ln-1822"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">TempRise</span>              <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1823"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">EddyFrac</span>              <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-1824"></a>
<a name="ln-1825"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">,</span>    <span class="s1">&#39;RatedLosses&#39;</span><span class="p">)</span> <span class="p">)</span>    <span class="k">THEN</span>
<a name="ln-1826"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PerformanceInputMode</span>     <span class="o">=</span> <span class="n">LossesMethod</span>
<a name="ln-1827"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;NominalEfficiency&#39;</span> <span class="p">)</span> <span class="p">)</span>   <span class="k">THEN</span>
<a name="ln-1828"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PerformanceInputMode</span>     <span class="o">=</span> <span class="n">EfficiencyMethod</span>
<a name="ln-1829"></a>      <span class="k">ELSE</span>
<a name="ln-1830"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1831"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1832"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1833"></a>      <span class="n">ENDIF</span>
<a name="ln-1834"></a>
<a name="ln-1835"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedNL</span>           <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1836"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedLL</span>           <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1837"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedEfficiency</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1838"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedPUL</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-1839"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedTemp</span>         <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1840"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">MaxPUL</span>            <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1841"></a>
<a name="ln-1842"></a>      <span class="c">!Check the input for MaxPUL if the performance input method is EfficiencyMethod</span>
<a name="ln-1843"></a>      <span class="c">!Other inputs do not need to be checked because they are handled by the IDD procedure.</span>
<a name="ln-1844"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PerformanceInputMode</span> <span class="o">==</span> <span class="n">EfficiencyMethod</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1845"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1846"></a><span class="k">          </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">MaxPUL</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedPUL</span>
<a name="ln-1847"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">MaxPUL</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">MaxPUL</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1848"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1849"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-1850"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered value must be &gt; 0 and &lt;= 1.&#39;</span><span class="p">)</span>
<a name="ln-1851"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1852"></a>        <span class="n">ENDIF</span>
<a name="ln-1853"></a>      <span class="n">ENDIF</span>
<a name="ln-1854"></a>
<a name="ln-1855"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">,</span>    <span class="s1">&#39;Yes&#39;</span><span class="p">)</span> <span class="p">)</span>    <span class="k">THEN</span>
<a name="ln-1856"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ConsiderLosses</span>     <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1857"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="s1">&#39;No&#39;</span> <span class="p">)</span> <span class="p">)</span>   <span class="k">THEN</span>
<a name="ln-1858"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ConsiderLosses</span>     <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1859"></a>      <span class="k">ELSE</span>
<a name="ln-1860"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">UsageMode</span> <span class="o">==</span> <span class="n">PowerInFromGrid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1861"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-1862"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-1863"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1864"></a>        <span class="n">ENDIF</span>
<a name="ln-1865"></a>      <span class="n">ENDIF</span>
<a name="ln-1866"></a>
<a name="ln-1867"></a>      <span class="n">NumWiredMeters</span> <span class="o">=</span> <span class="n">NumAlphas</span> <span class="o">-</span> <span class="n">NumAlphaBeforeMeter</span>
<a name="ln-1868"></a>
<a name="ln-1869"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">UsageMode</span> <span class="o">==</span> <span class="n">PowerInFromGrid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a>        <span class="c">!Provide warning if no meter is wired to a transformer used to get power from the grid</span>
<a name="ln-1872"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">NumWiredMeters</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1873"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;ElectricLoadCenter:Transformer=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="p">)</span>
<a name="ln-1874"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ISOLATED Transformer: No meter wired to a transformer used to input power from grid&#39;</span> <span class="p">)</span>
<a name="ln-1875"></a>        <span class="k">END IF</span>
<a name="ln-1876"></a>
<a name="ln-1877"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterNames</span><span class="p">(</span><span class="n">NumWiredMeters</span><span class="p">))</span>
<a name="ln-1878"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterPtrs</span><span class="p">(</span><span class="n">NumWiredMeters</span><span class="p">))</span>
<a name="ln-1879"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">SpecialMeter</span><span class="p">(</span><span class="n">NumWiredMeters</span><span class="p">))</span>
<a name="ln-1880"></a>
<a name="ln-1881"></a>        <span class="c">!Meter check deferred because they may have not been &quot;loaded&quot; yet,</span>
<a name="ln-1882"></a>        <span class="k">DO </span><span class="n">LoopCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWiredMeters</span>
<a name="ln-1883"></a>          <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterNames</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">)</span> <span class="o">=</span> <span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">LoopCount</span><span class="o">+</span><span class="n">NumAlphaBeforeMeter</span><span class="p">))</span>
<a name="ln-1884"></a>          <span class="c">!Assign SpecialMeter as TRUE if the meter name is Electricity:Facility or Electricity:HVAC</span>
<a name="ln-1885"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterNames</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">),</span> <span class="s1">&#39;Electricity:Facility&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1886"></a>             <span class="n">SameString</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterNames</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">),</span> <span class="s1">&#39;Electricity:HVAC&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1887"></a><span class="k">            </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">SpecialMeter</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1888"></a>          <span class="k">ELSE</span>
<a name="ln-1889"></a><span class="k">            </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">SpecialMeter</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1890"></a>          <span class="n">ENDIF</span>
<a name="ln-1891"></a>        <span class="k">END DO</span>
<a name="ln-1892"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1893"></a>
<a name="ln-1894"></a>
<a name="ln-1895"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Efficiency []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1896"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Efficiency</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1897"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Input Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1898"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerIn</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1899"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Input Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1900"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">EnergyIn</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1901"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Output Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1902"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerOut</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1903"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Output Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1904"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">EnergyOut</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1905"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer No Load Loss Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1906"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">NoLoadLossRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1907"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer No Load Loss Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1908"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">NoLoadLossEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1909"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Load Loss Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1910"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadLossRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1911"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Load Loss Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1912"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadLossEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1913"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Thermal Loss Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1914"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ThermalLossRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1915"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Thermal Loss Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1916"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ThermalLossEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-1917"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Distribution Electric Loss Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1918"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ElecUseUtility</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1919"></a>           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1920"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Transformer Cogeneration Electric Loss Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1921"></a>           <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ElecProducedCoGen</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,&amp;</span>
<a name="ln-1922"></a>           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityProduced&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1923"></a>
<a name="ln-1924"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1925"></a><span class="k">        CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1926"></a>                     <span class="s1">&#39;ElectricLoadCenter:Transformer&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1927"></a>                     <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1928"></a>                     <span class="n">IntGainTypeOf_ElectricLoadCenterTransformer</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-1929"></a>                     <span class="n">ConvectionGainRate</span>    <span class="o">=</span>    <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">QdotconvZone</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1930"></a>                     <span class="n">ThermalRadiationGainRate</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">QdotRadZone</span><span class="p">)</span>
<a name="ln-1931"></a>      <span class="n">ENDIF</span>
<a name="ln-1932"></a>
<a name="ln-1933"></a>
<a name="ln-1934"></a>    <span class="n">ENDDO</span> <span class="c">! End loop for get transformer inputs</span>
<a name="ln-1935"></a>  <span class="n">ENDIF</span>
<a name="ln-1936"></a>
<a name="ln-1937"></a>
<a name="ln-1938"></a>  <span class="c">!Get the number of electric load centers  (now allowing more than 1 per simulation)</span>
<a name="ln-1939"></a>  <span class="n">NumLoadCenters</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;ElectricLoadCenter:Distribution&#39;</span><span class="p">)</span>
<a name="ln-1940"></a>
<a name="ln-1941"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumLoadCenters</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-1942"></a><span class="k">    IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1943"></a>             <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">NumLoadCenters</span><span class="p">))</span>
<a name="ln-1944"></a>    <span class="k">DO </span><span class="n">LoopCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTransformers</span>
<a name="ln-1945"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">)%</span><span class="n">LoadCenterIndexes</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1946"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">)%</span><span class="n">LoadCenterIndexes</span><span class="p">(</span><span class="n">NumLoadCenters</span><span class="p">))</span>
<a name="ln-1947"></a>      <span class="n">ENDIF</span>
<a name="ln-1948"></a>    <span class="k">END DO</span>
<a name="ln-1949"></a><span class="k">  ELSE</span>
<a name="ln-1950"></a>    <span class="c">! set up one load center anyway for consistent access to report variables.</span>
<a name="ln-1951"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1952"></a>             <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1953"></a>  <span class="n">ENDIF</span>
<a name="ln-1954"></a>
<a name="ln-1955"></a><span class="c">!First get the number of electric load center generator and make a list of names</span>
<a name="ln-1956"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;ElectricLoadCenter:Generators&#39;</span>
<a name="ln-1957"></a>  <span class="n">NumGenLists</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-1958"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ListName</span><span class="p">(</span><span class="n">NumGenLists</span><span class="p">))</span>
<a name="ln-1959"></a>  <span class="k">DO </span><span class="nb">Count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumGenLists</span>
<a name="ln-1960"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="nb">Count</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1961"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">)</span>
<a name="ln-1962"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1963"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1964"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ListName</span><span class="p">,</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1965"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1966"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1967"></a>    <span class="n">ENDIF</span>
<a name="ln-1968"></a>    <span class="n">ListName</span><span class="p">(</span><span class="nb">Count</span><span class="p">)</span> <span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1969"></a>  <span class="k">END DO</span>
<a name="ln-1970"></a>
<a name="ln-1971"></a>
<a name="ln-1972"></a><span class="k">  DO </span><span class="nb">Count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumLoadCenters</span>
<a name="ln-1973"></a>
<a name="ln-1974"></a>    <span class="c">!Get the data for electric load centers</span>
<a name="ln-1975"></a>    <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;ElectricLoadCenter:Distribution&#39;</span>
<a name="ln-1976"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="nb">Count</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1977"></a>                       <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1978"></a>                         <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-1979"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1980"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1981"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1982"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1983"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1984"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1985"></a>    <span class="n">ENDIF</span>
<a name="ln-1986"></a><span class="c">!Load the Power Center Name.</span>
<a name="ln-1987"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Name</span>                <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1988"></a>
<a name="ln-1989"></a><span class="c">!Load the Power Center Generator List .</span>
<a name="ln-1990"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">GeneratorList</span>       <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1991"></a>
<a name="ln-1992"></a><span class="c">!Load the Power Center Operation Scheme</span>
<a name="ln-1993"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">,</span>    <span class="s1">&#39;Baseload&#39;</span><span class="p">)</span> <span class="p">)</span>         <span class="k">THEN</span>
<a name="ln-1994"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">OperationScheme</span>     <span class="o">=</span> <span class="n">iOpSchemeBaseload</span>
<a name="ln-1995"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;DemandLimit&#39;</span> <span class="p">)</span> <span class="p">)</span>     <span class="k">THEN</span>
<a name="ln-1996"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">OperationScheme</span>     <span class="o">=</span> <span class="n">iOpSchemeDemandLimit</span>
<a name="ln-1997"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;TrackElectrical&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1998"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">OperationScheme</span>     <span class="o">=</span> <span class="n">iOpSchemeTrackElectrical</span>
<a name="ln-1999"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;TrackSchedule&#39;</span> <span class="p">)</span> <span class="p">)</span>   <span class="k">THEN</span>
<a name="ln-2000"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">OperationScheme</span>     <span class="o">=</span> <span class="n">iOpSchemeTrackSchedule</span>
<a name="ln-2001"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;TrackMeter&#39;</span> <span class="p">)</span> <span class="p">)</span>      <span class="k">THEN</span>
<a name="ln-2002"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">OperationScheme</span>     <span class="o">=</span> <span class="n">iOpSchemeTrackMeter</span>
<a name="ln-2003"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;FollowThermal&#39;</span> <span class="p">)</span> <span class="p">)</span>   <span class="k">THEN</span>
<a name="ln-2004"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">OperationScheme</span>     <span class="o">=</span> <span class="n">iOpSchemeThermalFollow</span>
<a name="ln-2005"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;FollowThermalLimitElectrical&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2006"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">OperationScheme</span>     <span class="o">=</span> <span class="n">iOpSchemeThermalFollowLimitElectrical</span>
<a name="ln-2007"></a>    <span class="k">ELSE</span>
<a name="ln-2008"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2009"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2010"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2011"></a>    <span class="n">ENDIF</span>
<a name="ln-2012"></a>
<a name="ln-2013"></a>    <span class="c">!Load the Purchaed Electric Demand Limit for the Demand Limit scheme only. Is not used for other schemes.</span>
<a name="ln-2014"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DemandLimit</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2015"></a>
<a name="ln-2016"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TrackSchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-2017"></a>    <span class="c">! test if schedule valid and &#39;TRACK SCHEDULE&#39;</span>
<a name="ln-2018"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TrackSchedPtr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2019"></a>       <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">OperationScheme</span> <span class="o">==</span> <span class="n">iOpSchemeTrackSchedule</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! throw error</span>
<a name="ln-2020"></a>       <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2021"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2022"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2023"></a>       <span class="k">ELSE</span>
<a name="ln-2024"></a><span class="k">         CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2025"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = blank field.&#39;</span><span class="p">)</span>
<a name="ln-2026"></a>       <span class="n">ENDIF</span>
<a name="ln-2027"></a>       <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule not found; Must be entered and valid when Operation Scheme=TrackSchedule&#39;</span><span class="p">)</span>
<a name="ln-2028"></a>       <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2029"></a>    <span class="n">ENDIF</span>
<a name="ln-2030"></a>
<a name="ln-2031"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">DemandMeterName</span> <span class="o">=</span> <span class="n">MakeUPPERCase</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-2032"></a>
<a name="ln-2033"></a>    <span class="c">! meters may not be &quot;loaded&quot; yet, defered check to later subroutine</span>
<a name="ln-2034"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;AlternatingCurrent&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2035"></a><span class="k">       </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">BussType</span> <span class="o">=</span> <span class="n">ACBuss</span>
<a name="ln-2036"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;AlternatingCurrent&#39;</span>
<a name="ln-2037"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;DirectCurrentWithInverter&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2038"></a><span class="k">       </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">BussType</span> <span class="o">=</span> <span class="n">DCBussInverter</span>
<a name="ln-2039"></a>       <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">InverterPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2040"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;DirectCurrentWithInverter&#39;</span>
<a name="ln-2041"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;AlternatingCurrentWithStorage&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2042"></a><span class="k">       </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">BussType</span> <span class="o">=</span> <span class="n">ACBussStorage</span>
<a name="ln-2043"></a>       <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StoragePresent</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2044"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;AlternatingCurrentWithStorage&#39;</span>
<a name="ln-2045"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;DirectCurrentWithInverterDCStorage&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2046"></a><span class="k">       </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">BussType</span> <span class="o">=</span> <span class="n">DCBussInverterDCStorage</span>
<a name="ln-2047"></a>       <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">InverterPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2048"></a>       <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StoragePresent</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2049"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;DirectCurrentWithInverterDCStorage&#39;</span>
<a name="ln-2050"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;DirectCurrentWithInverterACStorage&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2051"></a><span class="k">       </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">BussType</span> <span class="o">=</span> <span class="n">DCBussInverterACStorage</span>
<a name="ln-2052"></a>       <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">InverterPresent</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2053"></a>       <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StoragePresent</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2054"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;DirectCurrentWithInverterACStorage&#39;</span>
<a name="ln-2055"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">Blank</span> <span class="p">))</span> <span class="k">Then</span>
<a name="ln-2056"></a><span class="k">       </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">BussType</span> <span class="o">=</span> <span class="n">ACBuss</span>
<a name="ln-2057"></a>       <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;AlternatingCurrent (field was blank)&#39;</span>
<a name="ln-2058"></a>    <span class="k">ELSE</span>
<a name="ln-2059"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2060"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2061"></a>       <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2062"></a>    <span class="n">ENDIF</span>
<a name="ln-2063"></a>
<a name="ln-2064"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">InverterPresent</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2065"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">InverterModelNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">InverterNames</span><span class="p">,</span> <span class="n">NumInverters</span><span class="p">)</span>
<a name="ln-2066"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">InverterModelNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2067"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2068"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2069"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2070"></a>        <span class="k">ELSE</span>
<a name="ln-2071"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2072"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = blank field.&#39;</span><span class="p">)</span>
<a name="ln-2073"></a>        <span class="n">ENDIF</span>
<a name="ln-2074"></a>        <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Inverter object was not found; Must have and be valid when Buss Type=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2075"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2076"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2077"></a>      <span class="k">ELSE</span>
<a name="ln-2078"></a>        <span class="c">! check if previous elec load center already uses this inverter.</span>
<a name="ln-2079"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span>  <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2080"></a><span class="k">          </span><span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">InverterName</span><span class="p">,</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2081"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2082"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2083"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2084"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Inverter object has already been used by another &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">))</span>
<a name="ln-2085"></a>            <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2086"></a>          <span class="n">ENDIF</span>
<a name="ln-2087"></a>        <span class="n">ENDIF</span>
<a name="ln-2088"></a>      <span class="n">ENDIF</span>
<a name="ln-2089"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">InverterName</span> <span class="o">=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-2090"></a>    <span class="n">ENDIF</span>
<a name="ln-2091"></a>
<a name="ln-2092"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StoragePresent</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2093"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StorageModelNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">StorageNames</span><span class="p">,</span> <span class="n">NumElecStorageDevices</span><span class="p">)</span>
<a name="ln-2094"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StorageModelNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2095"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2096"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2097"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2098"></a>        <span class="k">ELSE</span>
<a name="ln-2099"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2100"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = blank field.&#39;</span><span class="p">)</span>
<a name="ln-2101"></a>        <span class="n">ENDIF</span>
<a name="ln-2102"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Electrical storage object was not found; Must have and be valid when Buss Type=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2103"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2104"></a>        <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2105"></a>      <span class="k">ELSE</span>
<a name="ln-2106"></a>        <span class="c">! check if previous elec load center already uses this storage.</span>
<a name="ln-2107"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span>  <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2108"></a><span class="k">          </span><span class="n">Found</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ElecLoadCenter</span><span class="p">%</span><span class="n">StorageName</span><span class="p">,</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2109"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Found</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2110"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2111"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2112"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Storage object has already been used by another &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">))</span>
<a name="ln-2113"></a>            <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2114"></a>          <span class="n">ENDIF</span>
<a name="ln-2115"></a>        <span class="n">ENDIF</span>
<a name="ln-2116"></a>      <span class="n">ENDIF</span>
<a name="ln-2117"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">StorageName</span> <span class="o">=</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-2118"></a>    <span class="n">ENDIF</span>
<a name="ln-2119"></a>
<a name="ln-2120"></a><span class="c">!    If a transformer is used in an electric load center, the program needs to 1) update the number of</span>
<a name="ln-2121"></a><span class="c">!    electric load centers connected to that transformer; 2) bookkeep the load center index in the transformer</span>
<a name="ln-2122"></a><span class="c">!    data structure so that the transformer knows which load center is connected.</span>
<a name="ln-2123"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">9</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2124"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TransformerModelNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">TransformerNames</span><span class="p">,</span> <span class="n">NumTransformers</span><span class="p">)</span>
<a name="ln-2125"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TransformerModelNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2126"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2127"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2128"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2129"></a>        <span class="k">ELSE</span>
<a name="ln-2130"></a>        <span class="c">! It is allowed that a transformer can serve multiple load centers.</span>
<a name="ln-2131"></a>        <span class="c">! This differs from inverters and batteries (electrical storage) implemented previously</span>
<a name="ln-2132"></a>          <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TransformerName</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-2133"></a>          <span class="n">LCofTransformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TransformerModelNum</span><span class="p">)%</span><span class="n">LoadCenterNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2134"></a>          <span class="n">Transformer</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TransformerModelNum</span><span class="p">)%</span><span class="n">LoadCenterNum</span> <span class="o">=</span> <span class="n">LCofTransformer</span>
<a name="ln-2135"></a>          <span class="n">Transformer</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TransformerModelNum</span><span class="p">)%</span><span class="n">LoadCenterIndexes</span><span class="p">(</span><span class="n">LCofTransformer</span><span class="p">)</span> <span class="o">=</span> <span class="nb">Count</span>
<a name="ln-2136"></a><span class="nb">        </span><span class="n">ENDIF</span>
<a name="ln-2137"></a>    <span class="n">ENDIF</span>
<a name="ln-2138"></a>
<a name="ln-2139"></a>
<a name="ln-2140"></a>    <span class="c">!Setup general output variables for reporting in the electric load center</span>
<a name="ln-2141"></a>    <span class="n">SetupWholeBldgReports</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2142"></a>
<a name="ln-2143"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Load Center Produced Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2144"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElectProdRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2145"></a>
<a name="ln-2146"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Load Center Produced Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2147"></a>           <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElectricityProd</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2148"></a>
<a name="ln-2149"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Load Center Produced Thermal Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2150"></a>         <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ThermalProdRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2151"></a>
<a name="ln-2152"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Load Center Produced Thermal Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2153"></a>           <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ThermalProd</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2154"></a>
<a name="ln-2155"></a>    <span class="k">If</span><span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">GeneratorList</span><span class="p">)</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="k">Then</span>
<a name="ln-2156"></a><span class="k">      </span><span class="n">ListNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">GeneratorList</span><span class="p">,</span><span class="n">ListName</span><span class="p">,</span><span class="n">NumGenLists</span><span class="p">)</span>
<a name="ln-2157"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ListNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2158"></a>
<a name="ln-2159"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Requested Generator List=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">GeneratorList</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2160"></a>                             <span class="s1">&#39;, not found.  Load Center=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2161"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2162"></a>        <span class="k">CYCLE</span>
<a name="ln-2163"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-2164"></a>
<a name="ln-2165"></a>      <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;ElectricLoadCenter:Generators&#39;</span>
<a name="ln-2166"></a>      <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="n">ListNum</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2167"></a>                         <span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2168"></a>                         <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-2169"></a>
<a name="ln-2170"></a>  <span class="c">!Calculate the number of generators in list</span>
<a name="ln-2171"></a>      <span class="n">NumGenerators</span> <span class="o">=</span> <span class="n">NumNums</span> <span class="o">/</span> <span class="mi">2</span> <span class="c">! note IDD needs Min Fields = 6  can this be more robust?</span>
<a name="ln-2172"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">MOD</span><span class="p">((</span><span class="n">NumAlphas</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">NumNums</span><span class="p">),</span><span class="mi">5</span><span class="p">)</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">NumGenerators</span><span class="o">=</span><span class="n">NumGenerators</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2173"></a>      <span class="n">alphacount</span> <span class="o">=</span><span class="mi">2</span>
<a name="ln-2174"></a>  <span class="c">!Allocate the pointer array</span>
<a name="ln-2175"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">NumGenerators</span><span class="p">))</span>
<a name="ln-2176"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">NumGenerators</span> <span class="o">=</span> <span class="n">NumGenerators</span>
<a name="ln-2177"></a>      <span class="n">pvTotalCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! for LEED report</span>
<a name="ln-2178"></a>      <span class="n">windTotalCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! for LEED report</span>
<a name="ln-2179"></a>      <span class="k">DO </span><span class="n">GenCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-2180"></a>  <span class="c">!Load the Power Center Generator List Name</span>
<a name="ln-2181"></a>        <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">Name</span>            <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span>
<a name="ln-2182"></a>        <span class="n">alphacount</span> <span class="o">=</span><span class="n">alphacount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2183"></a>  <span class="c">!Load the Type of Generator</span>
<a name="ln-2184"></a>        <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">TypeOf</span>          <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span>
<a name="ln-2185"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;Generator:InternalCombustionEngine&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2186"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">CompType_Num</span>  <span class="o">=</span> <span class="n">iGeneratorICEngine</span>
<a name="ln-2187"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;Generator:CombustionTurbine&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2188"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">CompType_Num</span>  <span class="o">=</span> <span class="n">iGeneratorCombTurbine</span>
<a name="ln-2189"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;Generator:MicroTurbine&#39;</span><span class="p">)</span> <span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-2190"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">CompType_Num</span>  <span class="o">=</span> <span class="n">iGeneratorMicroturbine</span>
<a name="ln-2191"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;Generator:Photovoltaic&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2192"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">CompType_Num</span>  <span class="o">=</span> <span class="n">iGeneratorPV</span>
<a name="ln-2193"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;Generator:FuelCell&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2194"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">CompType_Num</span>  <span class="o">=</span> <span class="n">iGeneratorFuelCell</span>
<a name="ln-2195"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;Generator:MicroCHP&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2196"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">CompType_Num</span>  <span class="o">=</span> <span class="n">iGeneratorMicroCHP</span>
<a name="ln-2197"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span> <span class="p">,</span> <span class="s1">&#39;Generator:WindTurbine&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2198"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">CompType_Num</span>  <span class="o">=</span> <span class="n">iGeneratorWindTurbine</span>
<a name="ln-2199"></a>        <span class="k">ELSE</span>
<a name="ln-2200"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2201"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">alphacount</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2202"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2203"></a>        <span class="n">ENDIF</span>
<a name="ln-2204"></a>        <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2205"></a>                               <span class="n">IsNotOK</span><span class="p">,</span><span class="s1">&#39;Generator&#39;</span><span class="p">)</span>
<a name="ln-2206"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2207"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;In &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2208"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2209"></a>        <span class="n">ENDIF</span>
<a name="ln-2210"></a>
<a name="ln-2211"></a>        <span class="n">alphacount</span> <span class="o">=</span><span class="n">alphacount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2212"></a>
<a name="ln-2213"></a>        <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">MaxPowerOut</span>     <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">GenCount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2214"></a>        <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">GenCount</span><span class="p">)</span>
<a name="ln-2215"></a>
<a name="ln-2216"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2217"></a><span class="k">          CALL </span><span class="n">SetupEMSInternalVariable</span><span class="p">(</span><span class="s1">&#39;Generator Nominal Maximum Power&#39;</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2218"></a>                                     <span class="s1">&#39;[W]&#39;</span><span class="p">,</span>  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">MaxPowerOut</span> <span class="p">)</span>
<a name="ln-2219"></a>          <span class="k">CALL </span><span class="n">SetupEMSInternalVariable</span><span class="p">(</span><span class="s1">&#39;Generator Nominal Thermal To Electric Ratio&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2220"></a>             <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2221"></a>                                     <span class="s1">&#39;[ratio]&#39;</span><span class="p">,</span>  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">NominalThermElectRatio</span> <span class="p">)</span>
<a name="ln-2222"></a>        <span class="n">ENDIF</span>
<a name="ln-2223"></a>
<a name="ln-2224"></a>  <span class="c">!Load the Power CenterElectric Generation Meter Name</span>
<a name="ln-2225"></a>        <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">AvailSched</span>      <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">)</span>
<a name="ln-2226"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="n">alphacount</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2227"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">AvailSchedPtr</span>   <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-2228"></a>        <span class="k">ELSE</span>
<a name="ln-2229"></a><span class="k">          </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">AvailSchedPtr</span>   <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">))</span>
<a name="ln-2230"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">AvailSchedPtr</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2231"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2232"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="n">alphacount</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="n">alphacount</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2233"></a>            <span class="k">CAll </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Schedule was not found &#39;</span><span class="p">)</span>
<a name="ln-2234"></a>            <span class="n">errorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2235"></a>          <span class="n">ENDIF</span>
<a name="ln-2236"></a>        <span class="n">ENDIF</span>
<a name="ln-2237"></a>        <span class="n">alphacount</span> <span class="o">=</span><span class="n">alphacount</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a>
<a name="ln-2240"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Generator Requested Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2241"></a>               <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2242"></a>                <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2243"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2244"></a><span class="k">          CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;On-Site Generator Control&#39;</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2245"></a>                                <span class="s1">&#39;Requested Power&#39;</span><span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-2246"></a>                                <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">EMSRequestOn</span>  <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2247"></a>                                <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">EMSPowerRequest</span> <span class="p">)</span>
<a name="ln-2248"></a>
<a name="ln-2249"></a>
<a name="ln-2250"></a>        <span class="n">ENDIF</span>
<a name="ln-2251"></a>
<a name="ln-2252"></a>
<a name="ln-2253"></a>      <span class="n">ENDDO</span> <span class="c">!End of the NumGenerators Loop</span>
<a name="ln-2254"></a>
<a name="ln-2255"></a>
<a name="ln-2256"></a>    <span class="k">End If</span>
<a name="ln-2257"></a>
<a name="ln-2258"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Electric Load Center Requested Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2259"></a>                  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">TotalPowerRequest</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2260"></a>                  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2261"></a>
<a name="ln-2262"></a>  <span class="n">ENDDO</span>  <span class="c">! loop over number of load centers</span>
<a name="ln-2263"></a>
<a name="ln-2264"></a>  <span class="c">! LEED report</span>
<a name="ln-2265"></a>  <span class="n">pvTotalCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2266"></a>  <span class="n">windTotalCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2267"></a>  <span class="k">DO </span><span class="nb">Count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumLoadCenters</span>
<a name="ln-2268"></a>    <span class="k">IF</span><span class="p">(</span><span class="nb">Trim</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">GeneratorList</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="k">Then</span>
<a name="ln-2269"></a><span class="k">      DO </span><span class="n">GenCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-2270"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">CompType_Num</span>  <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">iGeneratorPV</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2271"></a><span class="k">          </span><span class="n">pvTotalCapacity</span> <span class="o">=</span> <span class="n">pvTotalCapacity</span> <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">MaxPowerOut</span>
<a name="ln-2272"></a>        <span class="n">ENDIF</span>
<a name="ln-2273"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">CompType_Num</span>  <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">iGeneratorWindTurbine</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2274"></a><span class="k">          </span><span class="n">windTotalCapacity</span> <span class="o">=</span> <span class="n">windTotalCapacity</span> <span class="o">+</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="nb">Count</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenCount</span><span class="p">)%</span><span class="n">MaxPowerOut</span>
<a name="ln-2275"></a>        <span class="n">ENDIF</span>
<a name="ln-2276"></a>      <span class="k">END DO</span>
<a name="ln-2277"></a><span class="k">    END IF</span>
<a name="ln-2278"></a><span class="k">  END DO</span>
<a name="ln-2279"></a>  <span class="c">!put in total capacity for PV and Wind for LEED report</span>
<a name="ln-2280"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchLeedRenRatCap</span><span class="p">,</span><span class="s1">&#39;Photovoltaic&#39;</span><span class="p">,</span><span class="n">pvTotalCapacity</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2281"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchLeedRenRatCap</span><span class="p">,</span><span class="s1">&#39;Wind&#39;</span><span class="p">,</span><span class="n">windTotalCapacity</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2282"></a>
<a name="ln-2283"></a>
<a name="ln-2284"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumLoadCenters</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2285"></a>  <span class="c">! if user input did not include an Electric Load center, create a simple default one here for reporting purposes</span>
<a name="ln-2286"></a>  <span class="c">!   but only if there are any other electricity components set up (yet) for metering</span>
<a name="ln-2287"></a>    <span class="n">AnyElectricityPresent</span> <span class="o">=</span> <span class="n">GetMeterIndex</span><span class="p">(</span><span class="s1">&#39;ELECTRICITY:FACILITY&#39;</span><span class="p">)</span>
<a name="ln-2288"></a>
<a name="ln-2289"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">AnyElectricityPresent</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2290"></a>
<a name="ln-2291"></a><span class="k">      </span><span class="n">NumLoadCenters</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2292"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">Name</span>  <span class="o">=</span> <span class="s1">&#39;Electrical Service&#39;</span>
<a name="ln-2293"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">OperationScheme</span> <span class="o">=</span> <span class="n">iOpSchemeTrackElectrical</span>
<a name="ln-2294"></a>
<a name="ln-2295"></a>      <span class="n">SetupWholeBldgReports</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2296"></a>
<a name="ln-2297"></a>    <span class="n">ENDIF</span> <span class="c">! any electricity metered</span>
<a name="ln-2298"></a>  <span class="n">ENDIF</span> <span class="c">! no user electric load center</span>
<a name="ln-2299"></a>
<a name="ln-2300"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">SetupWholeBldgReports</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2301"></a>
<a name="ln-2302"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Total Purchased Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2303"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectPurchRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2304"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Total Purchased Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2305"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityPurch</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2306"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityPurchased&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2307"></a>
<a name="ln-2308"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Total Surplus Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2309"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricitySurplus</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2310"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricitySurplusSold&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2311"></a>
<a name="ln-2312"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Net Purchased Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2313"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityNetRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2314"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Net Purchased Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2315"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityNet</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2316"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ElectricityNet&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COGENERATION&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;Plant&#39;</span><span class="p">)</span>
<a name="ln-2317"></a>
<a name="ln-2318"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Total Building Electric Demand Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2319"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalBldgElecDemand</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2320"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Total HVAC Electric Demand Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2321"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalHVACElecDemand</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2322"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Total Electric Demand Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2323"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalElectricDemand</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2324"></a>
<a name="ln-2325"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Total Produced Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2326"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectProdRate</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2327"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Facility Total Produced Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2328"></a>         <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityProd</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2329"></a>  <span class="n">ENDIF</span>
<a name="ln-2330"></a>
<a name="ln-2331"></a>
<a name="ln-2332"></a>  <span class="c">!Check whether a transformer connects to a load center if it is used to output power to the grid</span>
<a name="ln-2333"></a>  <span class="c">!Issue warning if no load center is connected to that transformer</span>
<a name="ln-2334"></a>  <span class="c">!This has to be done after reading in all load centers</span>
<a name="ln-2335"></a>  <span class="k">DO </span><span class="n">TransfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTransformers</span>
<a name="ln-2336"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">UsageMode</span> <span class="o">==</span> <span class="n">PowerOutFromBldg</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadCenterNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2337"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;ElectricLoadCenter:Transformer=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid entry.&#39;</span><span class="p">)</span>
<a name="ln-2338"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;ISOLATED Transformer: No load center connects to a transformer used to output power&#39;</span> <span class="p">)</span>
<a name="ln-2339"></a>    <span class="k">END IF</span>
<a name="ln-2340"></a><span class="k">  END DO</span>
<a name="ln-2341"></a>
<a name="ln-2342"></a>
<a name="ln-2343"></a><span class="k">  DEALLOCATE</span><span class="p">(</span><span class="n">ListName</span><span class="p">)</span>
<a name="ln-2344"></a>
<a name="ln-2345"></a>
<a name="ln-2346"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2347"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Preceding errors terminate program.&#39;</span><span class="p">)</span>
<a name="ln-2348"></a>  <span class="n">ENDIF</span>
<a name="ln-2349"></a>
<a name="ln-2350"></a><span class="k">RETURN</span>
<a name="ln-2351"></a>
<a name="ln-2352"></a><span class="k">END SUBROUTINE </span><span class="n">GetPowerManagerInput</span>
<a name="ln-2353"></a>
<a name="ln-2354"></a>
<a name="ln-2355"></a><span class="k">SUBROUTINE </span><span class="n">GeneratorPowerOutput</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">GenNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ElectricPowerOutput</span><span class="p">,</span><span class="n">ThermalPowerOutput</span><span class="p">)</span>
<a name="ln-2356"></a>
<a name="ln-2357"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-2358"></a>          <span class="c">!       AUTHOR         B. Nigusse</span>
<a name="ln-2359"></a>          <span class="c">!       DATE WRITTEN   December 2009</span>
<a name="ln-2360"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2361"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2362"></a>
<a name="ln-2363"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-2364"></a>          <span class="c">! Simulates generator to get the actual electric power output based on load request</span>
<a name="ln-2365"></a>
<a name="ln-2366"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2367"></a>          <span class="c">! na</span>
<a name="ln-2368"></a>
<a name="ln-2369"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2370"></a>          <span class="c">! na</span>
<a name="ln-2371"></a>
<a name="ln-2372"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2373"></a>  <span class="k">USE </span><span class="n">ICEngineElectricGenerator</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimICEngineGenerator</span><span class="p">,</span> <span class="n">GetICEGeneratorResults</span>
<a name="ln-2374"></a>  <span class="k">USE </span><span class="n">CTElectricGenerator</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimCTGenerator</span><span class="p">,</span> <span class="n">GetCTGeneratorResults</span>
<a name="ln-2375"></a>  <span class="k">USE </span><span class="n">MicroturbineElectricGenerator</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimMTGenerator</span><span class="p">,</span> <span class="n">GetMTGeneratorResults</span>
<a name="ln-2376"></a>  <span class="k">USE </span><span class="n">Photovoltaics</span><span class="p">,</span>                 <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimPVGenerator</span><span class="p">,</span> <span class="n">GetPVGeneratorResults</span>
<a name="ln-2377"></a>  <span class="k">USE </span><span class="n">FuelCellElectricGenerator</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimFuelCellGenerator</span><span class="p">,</span> <span class="n">GetFuelCellGeneratorResults</span>
<a name="ln-2378"></a>  <span class="k">USE </span><span class="n">MicroCHPElectricGenerator</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimMicroCHPGenerator</span><span class="p">,</span> <span class="n">GetMicroCHPGeneratorResults</span>
<a name="ln-2379"></a>  <span class="k">USE </span><span class="n">WindTurbine</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWindTurbine</span><span class="p">,</span> <span class="n">GetWTGeneratorResults</span>
<a name="ln-2380"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2381"></a>
<a name="ln-2382"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-2383"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GenNum</span>           <span class="c">! Generator number counter</span>
<a name="ln-2384"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LoadCenterNum</span>    <span class="c">! Load Center number counter</span>
<a name="ln-2385"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! Unused 2010 JANUARY</span>
<a name="ln-2386"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElectricPowerOutput</span> <span class="c">! Actual generator electric power output</span>
<a name="ln-2387"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThermalPowerOutput</span>  <span class="c">! Actual generator thermal power output</span>
<a name="ln-2388"></a>
<a name="ln-2389"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-2390"></a>          <span class="c">! na</span>
<a name="ln-2391"></a>
<a name="ln-2392"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2393"></a>          <span class="c">! na</span>
<a name="ln-2394"></a>
<a name="ln-2395"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2396"></a>          <span class="c">! na</span>
<a name="ln-2397"></a>
<a name="ln-2398"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2399"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">GeneratorName</span>    <span class="c">! User-specified name of generator</span>
<a name="ln-2400"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">GeneratorType</span>    <span class="c">! Type of generator</span>
<a name="ln-2401"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">RunFlag</span>          <span class="c">! Simulate generator when TRUE</span>
<a name="ln-2402"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MyLoad</span>           <span class="c">! Generator load request (W)</span>
<a name="ln-2403"></a>
<a name="ln-2404"></a>
<a name="ln-2405"></a>  <span class="n">GeneratorType</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">CompType_Num</span>
<a name="ln-2406"></a>  <span class="n">GeneratorName</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-2407"></a>  <span class="n">Runflag</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ONThisTimeStep</span>
<a name="ln-2408"></a>  <span class="n">Myload</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">PowerRequestThisTimestep</span>
<a name="ln-2409"></a>
<a name="ln-2410"></a>      <span class="c">! Select and call models and also collect results for load center power conditioning and reporting</span>
<a name="ln-2411"></a>      <span class="n">TypeOfEquip</span><span class="p">:</span> <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">GeneratorType</span><span class="p">)</span>
<a name="ln-2412"></a>
<a name="ln-2413"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorICEngine</span><span class="p">)</span>    <span class="c">! &#39;Generator:InternalCombustionEngine&#39;</span>
<a name="ln-2414"></a>          <span class="k">CALL </span><span class="n">SimICEngineGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2415"></a>                                          <span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2416"></a>          <span class="k">CALL </span><span class="n">GetICEGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2417"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2418"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectricityProd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2419"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2420"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProd</span><span class="p">)</span>
<a name="ln-2421"></a>          <span class="n">ElectricPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>
<a name="ln-2422"></a>          <span class="n">ThermalPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span>
<a name="ln-2423"></a>
<a name="ln-2424"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorCombTurbine</span><span class="p">)</span> <span class="c">! &#39;Generator:CombustionTurbine&#39;</span>
<a name="ln-2425"></a>          <span class="k">CALL </span><span class="n">SimCTGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2426"></a>                                          <span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2427"></a>          <span class="k">CALL </span><span class="n">GetCTGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2428"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2429"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectricityProd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2430"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2431"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProd</span><span class="p">)</span>
<a name="ln-2432"></a>          <span class="n">ElectricPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>
<a name="ln-2433"></a>          <span class="n">ThermalPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span>
<a name="ln-2434"></a>
<a name="ln-2435"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorMicroturbine</span><span class="p">)</span><span class="c">! &#39;Generator:MicroTurbine&#39;</span>
<a name="ln-2436"></a>          <span class="k">CALL </span><span class="n">SimMTGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2437"></a>                                          <span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2438"></a>          <span class="k">CALL </span><span class="n">GetMTGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2439"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2440"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectricityProd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2441"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2442"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProd</span><span class="p">)</span>
<a name="ln-2443"></a>          <span class="n">ElectricPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>
<a name="ln-2444"></a>          <span class="n">ThermalPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span>
<a name="ln-2445"></a>
<a name="ln-2446"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorPV</span><span class="p">)</span>          <span class="c">! &#39;Generator:Photovoltaic&#39;</span>
<a name="ln-2447"></a>          <span class="k">CALL </span><span class="n">SimPVGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2448"></a>                                          <span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-2449"></a>          <span class="k">CALL </span><span class="n">GetPVGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2450"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DCElectProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2451"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DCElectricityProd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2452"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2453"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProd</span><span class="p">)</span>
<a name="ln-2454"></a>          <span class="n">ElectricPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">DCElectProdRate</span>
<a name="ln-2455"></a>          <span class="n">ThermalPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span>
<a name="ln-2456"></a>
<a name="ln-2457"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorFuelCell</span><span class="p">)</span>    <span class="c">! &#39;Generator:FuelCell&#39;</span>
<a name="ln-2458"></a>          <span class="k">CALL </span><span class="n">SimFuelCellGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2459"></a>                                          <span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2460"></a>          <span class="k">CALL </span><span class="n">GetFuelCellGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2461"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2462"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectricityProd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2463"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2464"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProd</span><span class="p">)</span>
<a name="ln-2465"></a>          <span class="n">ElectricPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>
<a name="ln-2466"></a>          <span class="n">ThermalPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span>
<a name="ln-2467"></a>
<a name="ln-2468"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">iGeneratorMicroCHP</span><span class="p">)</span>     <span class="c">! &#39;Generator:MicroCHP&#39;</span>
<a name="ln-2469"></a>           <span class="k">CALL </span><span class="n">SimMicroCHPGenerator</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2470"></a>                                          <span class="n">Runflag</span><span class="p">,</span> <span class="p">.</span><span class="n">false</span><span class="p">.,</span> <span class="n">MyLoad</span><span class="p">,</span> <span class="n">constant_zero</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-2471"></a>           <span class="k">CALL </span><span class="n">GetMicroCHPGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2472"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2473"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectricityProd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2474"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2475"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProd</span><span class="p">)</span>
<a name="ln-2476"></a>          <span class="n">ElectricPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>
<a name="ln-2477"></a>          <span class="n">ThermalPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span>
<a name="ln-2478"></a>
<a name="ln-2479"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">iGeneratorWindTurbine</span><span class="p">)</span> <span class="c">! &#39;Generator:WindTurbine&#39;</span>
<a name="ln-2480"></a>          <span class="k">CALL </span><span class="n">SimWindTurbine</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">GeneratorName</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2481"></a>                                          <span class="n">Runflag</span><span class="p">,</span><span class="n">MyLoad</span><span class="p">)</span>
<a name="ln-2482"></a>          <span class="k">CALL </span><span class="n">GetWTGeneratorResults</span><span class="p">(</span><span class="n">GeneratorType</span><span class="p">,</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">GeneratorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2483"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2484"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectricityProd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2485"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2486"></a>                                     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProd</span><span class="p">)</span>
<a name="ln-2487"></a>          <span class="n">ElectricPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>
<a name="ln-2488"></a>          <span class="n">ThermalPowerOutput</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span>
<a name="ln-2489"></a>
<a name="ln-2490"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2491"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;ManageElectricPower: Invalid Generator Type found= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2492"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">GenNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">))</span>
<a name="ln-2493"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;.. Generator Name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">GeneratorName</span><span class="p">))</span>
<a name="ln-2494"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;.. preceding error causes termination.&#39;</span><span class="p">)</span>
<a name="ln-2495"></a>
<a name="ln-2496"></a>      <span class="k">END SELECT </span><span class="n">TypeOfEquip</span>
<a name="ln-2497"></a>
<a name="ln-2498"></a><span class="k">RETURN</span>
<a name="ln-2499"></a><span class="k">END SUBROUTINE </span><span class="n">GeneratorPowerOutput</span>
<a name="ln-2500"></a>
<a name="ln-2501"></a>
<a name="ln-2502"></a><span class="k">SUBROUTINE </span><span class="n">CalcLoadCenterThermalLoad</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">LoadCenterNum</span><span class="p">,</span> <span class="n">ThermalLoad</span><span class="p">)</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2505"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-2506"></a>          <span class="c">!       DATE WRITTEN   Dec 2008</span>
<a name="ln-2507"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2508"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2509"></a>
<a name="ln-2510"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2511"></a>
<a name="ln-2512"></a>
<a name="ln-2513"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2514"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2515"></a>
<a name="ln-2516"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2517"></a>          <span class="c">! na</span>
<a name="ln-2518"></a>
<a name="ln-2519"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2520"></a>  <span class="k">USE </span><span class="n">DataPlant</span>
<a name="ln-2521"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">NumPlantLoops</span><span class="p">,</span> <span class="n">SysTimeElapsed</span>
<a name="ln-2522"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-2523"></a>
<a name="ln-2524"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">dooutputreporting</span><span class="p">,</span> <span class="n">MetersHaveBeenInitialized</span><span class="p">,</span> <span class="n">warmupflag</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2525"></a>                             <span class="n">doingsizing</span><span class="p">,</span> <span class="n">currenttime</span>
<a name="ln-2526"></a>
<a name="ln-2527"></a> <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2528"></a> <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Month</span><span class="p">,</span> <span class="n">DayOfMonth</span>
<a name="ln-2529"></a>
<a name="ln-2530"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2531"></a>
<a name="ln-2532"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2533"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">!unused1208</span>
<a name="ln-2534"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoadCenterNum</span>    <span class="c">! Load Center number counter</span>
<a name="ln-2535"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ThermalLoad</span> <span class="c">! heat rate called for from cogenerator(watts)</span>
<a name="ln-2536"></a>
<a name="ln-2537"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2538"></a>          <span class="c">! na</span>
<a name="ln-2539"></a>
<a name="ln-2540"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2541"></a>          <span class="c">! na</span>
<a name="ln-2542"></a>
<a name="ln-2543"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2544"></a>          <span class="c">! na</span>
<a name="ln-2545"></a>
<a name="ln-2546"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2547"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>  <span class="kd">::</span> <span class="n">MyOneTimeSetupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2548"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyCoGenSetupFlag</span>
<a name="ln-2549"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FoundCount</span>
<a name="ln-2550"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-2551"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">j</span>
<a name="ln-2552"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">k</span>
<a name="ln-2553"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">m</span>
<a name="ln-2554"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopID</span>
<a name="ln-2555"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SideID</span>
<a name="ln-2556"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BranchID</span>
<a name="ln-2557"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompID</span>
<a name="ln-2558"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thisName</span>
<a name="ln-2559"></a><span class="c">!unused  INTEGER :: ThisTypeNum</span>
<a name="ln-2560"></a>
<a name="ln-2561"></a>  <span class="c">!debugstuff</span>
<a name="ln-2562"></a><span class="c">!unused    REAL(r64) :: ActualTime</span>
<a name="ln-2563"></a><span class="c">!unused    CHARACTER*300 :: OutputString</span>
<a name="ln-2564"></a><span class="c">!unused    CHARACTER*5 :: strFirstHVACIteration</span>
<a name="ln-2565"></a>
<a name="ln-2566"></a>
<a name="ln-2567"></a> <span class="c">! need to do initial setups</span>
<a name="ln-2568"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeSetupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2569"></a><span class="k">   ALLOCATE</span><span class="p">(</span><span class="n">MyCoGenSetupFlag</span><span class="p">(</span><span class="n">NumLoadCenters</span><span class="p">))</span>
<a name="ln-2570"></a>   <span class="n">MyCoGenSetupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2571"></a>   <span class="n">ThermalLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2572"></a>   <span class="n">MyOneTimeSetupFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2573"></a>   <span class="k">return</span>
<a name="ln-2574"></a><span class="k"> </span><span class="n">ENDIF</span>
<a name="ln-2575"></a>
<a name="ln-2576"></a> <span class="n">FoundCount</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2577"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">MyCoGenSetupFlag</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2578"></a><span class="k">   If</span> <span class="p">(</span><span class="nb">Allocated</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2579"></a>     <span class="c">! loop across generators and find match</span>
<a name="ln-2580"></a>     <span class="k">Do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-2581"></a>       <span class="n">thisName</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-2582"></a>
<a name="ln-2583"></a>       <span class="k">Do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumPlantLoops</span>
<a name="ln-2584"></a>
<a name="ln-2585"></a>         <span class="k">Do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">plantLoop</span><span class="p">(</span><span class="n">j</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SupplySide</span><span class="p">)%</span><span class="n">TotalBranches</span>
<a name="ln-2586"></a>
<a name="ln-2587"></a>           <span class="k">Do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">plantLoop</span><span class="p">(</span><span class="n">j</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SupplySide</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">k</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-2588"></a>             <span class="k">If</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">plantLoop</span><span class="p">(</span><span class="n">j</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SupplySide</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">k</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="n">thisName</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-2589"></a><span class="k">               </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">PlantLoopNum</span> <span class="o">=</span> <span class="n">j</span>
<a name="ln-2590"></a>               <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">LoopSideNum</span> <span class="o">=</span> <span class="n">SupplySide</span>
<a name="ln-2591"></a>               <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">BranchNum</span> <span class="o">=</span> <span class="n">k</span>
<a name="ln-2592"></a>               <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">CompNum</span>  <span class="o">=</span> <span class="n">m</span>
<a name="ln-2593"></a>
<a name="ln-2594"></a>               <span class="n">MyCoGenSetupFlag</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2595"></a>               <span class="n">FoundCount</span> <span class="o">=</span> <span class="n">FoundCount</span> <span class="o">+</span><span class="mi">1</span>
<a name="ln-2596"></a>               <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">PlantInfoFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2597"></a>             <span class="n">ENDIF</span>
<a name="ln-2598"></a>
<a name="ln-2599"></a>           <span class="n">ENDDO</span> <span class="c">! components</span>
<a name="ln-2600"></a>
<a name="ln-2601"></a>         <span class="n">ENDDO</span> <span class="c">! branches</span>
<a name="ln-2602"></a>
<a name="ln-2603"></a>       <span class="n">ENDDO</span> <span class="c">! plant loops</span>
<a name="ln-2604"></a>
<a name="ln-2605"></a>     <span class="n">ENDDO</span> <span class="c">! generators in load center</span>
<a name="ln-2606"></a>   <span class="n">ENDIF</span>
<a name="ln-2607"></a>
<a name="ln-2608"></a> <span class="n">ENDIF</span>
<a name="ln-2609"></a>
<a name="ln-2610"></a> <span class="c">! sum up &quot;MyLoad&quot; for all generators on this load center from plant structure</span>
<a name="ln-2611"></a> <span class="n">ThermalLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2612"></a> <span class="k">Do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span>
<a name="ln-2613"></a>   <span class="k">If</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">PlantInfoFound</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2614"></a><span class="k">     </span><span class="n">LoopID</span>   <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">PlantLoopNum</span>
<a name="ln-2615"></a>     <span class="n">SideID</span>   <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">LoopSideNum</span>
<a name="ln-2616"></a>     <span class="n">BranchID</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">BranchNum</span>
<a name="ln-2617"></a>     <span class="n">CompID</span>   <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">CompNum</span>
<a name="ln-2618"></a>     <span class="n">ThermalLoad</span> <span class="o">=</span> <span class="n">ThermalLoad</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2619"></a>                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopID</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">SideID</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchID</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompID</span><span class="p">)%</span><span class="n">MyLoad</span>
<a name="ln-2620"></a>
<a name="ln-2621"></a>   <span class="n">ENDIF</span>
<a name="ln-2622"></a> <span class="n">ENDDO</span>
<a name="ln-2623"></a>
<a name="ln-2624"></a> <span class="n">ThermalLoad</span> <span class="o">=</span> <span class="n">ThermalLoad</span>
<a name="ln-2625"></a>
<a name="ln-2626"></a><span class="k">END SUBROUTINE </span><span class="n">CalcLoadCenterThermalLoad</span>
<a name="ln-2627"></a>
<a name="ln-2628"></a><span class="k">SUBROUTINE </span><span class="n">VerifyCustomMetersElecPowerMgr</span>
<a name="ln-2629"></a>
<a name="ln-2630"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2631"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-2632"></a>          <span class="c">!       DATE WRITTEN   Feb 2006</span>
<a name="ln-2633"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2634"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2635"></a>
<a name="ln-2636"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2637"></a>          <span class="c">! check user input for custom meters</span>
<a name="ln-2638"></a>          <span class="c">!  need special call to use once CUSTOM METERs are &quot;Made&quot;</span>
<a name="ln-2639"></a>
<a name="ln-2640"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2641"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2642"></a>
<a name="ln-2643"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2644"></a>          <span class="c">! na</span>
<a name="ln-2645"></a>
<a name="ln-2646"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2647"></a>          <span class="c">! na</span>
<a name="ln-2648"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-2649"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2650"></a>
<a name="ln-2651"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2652"></a>          <span class="c">! na</span>
<a name="ln-2653"></a>
<a name="ln-2654"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2655"></a>          <span class="c">! na</span>
<a name="ln-2656"></a>
<a name="ln-2657"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2658"></a>          <span class="c">! na</span>
<a name="ln-2659"></a>
<a name="ln-2660"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2661"></a>          <span class="c">! na</span>
<a name="ln-2662"></a>
<a name="ln-2663"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2664"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">loop</span> <span class="c">!</span>
<a name="ln-2665"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">external</span> <span class="kd">::</span> <span class="n">GetMeterIndex</span>
<a name="ln-2666"></a>
<a name="ln-2667"></a>
<a name="ln-2668"></a>   <span class="k">do </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumLoadCenters</span>
<a name="ln-2669"></a>     <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">DemandMeterPtr</span> <span class="o">=</span>  <span class="n">GetMeterIndex</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">DemandMeterName</span><span class="p">)</span>
<a name="ln-2670"></a>     <span class="k">If</span> <span class="p">((</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">DemandMeterPtr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-2671"></a>       <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">OperationScheme</span> <span class="o">==</span> <span class="n">iOpSchemeTrackMeter</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span> <span class="c">! throw error</span>
<a name="ln-2672"></a>        <span class="k">CAll </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Did not find Meter named: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">DemandMeterName</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2673"></a>                   <span class="o">//</span><span class="s1">&#39; in &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2674"></a>     <span class="n">ENDIF</span>
<a name="ln-2675"></a>   <span class="n">ENDDO</span>
<a name="ln-2676"></a>
<a name="ln-2677"></a>  <span class="k">RETURN</span>
<a name="ln-2678"></a>
<a name="ln-2679"></a><span class="k">END SUBROUTINE </span><span class="n">VerifyCustomMetersElecPowerMgr</span>
<a name="ln-2680"></a>
<a name="ln-2681"></a><span class="k">SUBROUTINE </span><span class="n">ManageInverter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)</span>
<a name="ln-2682"></a>
<a name="ln-2683"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2684"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-2685"></a>          <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-2686"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2687"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2688"></a>
<a name="ln-2689"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2690"></a>          <span class="c">! manage inveter models and fill AC variables</span>
<a name="ln-2691"></a>
<a name="ln-2692"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2693"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2694"></a>
<a name="ln-2695"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2696"></a>          <span class="c">! na</span>
<a name="ln-2697"></a>
<a name="ln-2698"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2699"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-2700"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-2701"></a>
<a name="ln-2702"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2703"></a>
<a name="ln-2704"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2705"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoadCenterNum</span>    <span class="c">! Load Center number counter</span>
<a name="ln-2706"></a>
<a name="ln-2707"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2708"></a>          <span class="c">! na</span>
<a name="ln-2709"></a>
<a name="ln-2710"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2711"></a>          <span class="c">! na</span>
<a name="ln-2712"></a>
<a name="ln-2713"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2714"></a>          <span class="c">! na</span>
<a name="ln-2715"></a>
<a name="ln-2716"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2717"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">NormalizedPower</span>
<a name="ln-2718"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">InvertNum</span>
<a name="ln-2719"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">StorNum</span>
<a name="ln-2720"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">tmpEffic</span>
<a name="ln-2721"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">tempACpower</span>
<a name="ln-2722"></a>
<a name="ln-2723"></a>  <span class="c">!model inverters</span>
<a name="ln-2724"></a>  <span class="n">InvertNum</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">InverterModelNum</span>
<a name="ln-2725"></a>
<a name="ln-2726"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">InvertNum</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Return</span>
<a name="ln-2727"></a>
<a name="ln-2728"></a>    <span class="c">!first figure DC into inverter</span>
<a name="ln-2729"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">BussType</span><span class="p">)</span>
<a name="ln-2730"></a>
<a name="ln-2731"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">DCBussInverter</span><span class="p">,</span> <span class="n">DCBussInverterACStorage</span><span class="p">)</span>
<a name="ln-2732"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DCElectProdRate</span> <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">DCElectProdRate</span><span class="p">)</span>
<a name="ln-2733"></a>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DCElectProdRate</span>
<a name="ln-2734"></a>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCEnergyIn</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-2735"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">DCBussInverterDCStorage</span><span class="p">)</span>
<a name="ln-2736"></a>    <span class="n">StorNum</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">StorageModelNum</span>
<a name="ln-2737"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">StorNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2738"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DCElectProdRate</span> <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">DCElectProdRate</span><span class="p">)</span>
<a name="ln-2739"></a>
<a name="ln-2740"></a>      <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span>  <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DCElectProdRate</span>
<a name="ln-2741"></a>      <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCEnergyIn</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-2742"></a>    <span class="k">ELSE</span> <span class="c">! throw error</span>
<a name="ln-2743"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Electric load center is not set up properly, check electrical storage object for &#39;</span> <span class="p">&amp;</span>
<a name="ln-2744"></a>                                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2745"></a>    <span class="n">ENDIF</span>
<a name="ln-2746"></a>
<a name="ln-2747"></a>
<a name="ln-2748"></a>  <span class="k">END SELECT</span>
<a name="ln-2749"></a>
<a name="ln-2750"></a>  <span class="c">! check availability schedule</span>
<a name="ln-2751"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2752"></a>
<a name="ln-2753"></a>    <span class="c">! now calculate Inverter based on model type</span>
<a name="ln-2754"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ModelType</span><span class="p">)</span>
<a name="ln-2755"></a>
<a name="ln-2756"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">CECLookUpTableModel</span><span class="p">)</span> <span class="c">!interpolation model from test data</span>
<a name="ln-2757"></a>
<a name="ln-2758"></a>      <span class="c">! we don&#39;t model voltage, so use nominal voltage</span>
<a name="ln-2759"></a>      <span class="n">NormalizedPower</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span> <span class="o">/</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">RatedPower</span>
<a name="ln-2760"></a>
<a name="ln-2761"></a>      <span class="c">! get efficiency</span>
<a name="ln-2762"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">&lt;=</span> <span class="mf">0.1D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2763"></a>        <span class="c">! extrapolate or fix at 10% value? fix it for now</span>
<a name="ln-2764"></a>        <span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2765"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">&gt;</span> <span class="mf">0.1D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">&lt;</span><span class="mf">0.20D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2766"></a><span class="k">       </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2767"></a>                  <span class="o">+</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">-</span> <span class="mf">0.1D0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.2D0</span> <span class="o">-</span> <span class="mf">0.1D0</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2768"></a>                    <span class="o">*</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2769"></a>                        <span class="o">-</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2770"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">==</span> <span class="mf">0.2D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2771"></a><span class="k">        </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2772"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">&gt;</span> <span class="mf">0.2D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">&lt;</span><span class="mf">0.30D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2773"></a><span class="k">       </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2774"></a>                  <span class="o">+</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">-</span> <span class="mf">0.2D0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.3D0</span> <span class="o">-</span> <span class="mf">0.2D0</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2775"></a>                    <span class="o">*</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2776"></a>                        <span class="o">-</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2777"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">==</span> <span class="mf">0.3D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2778"></a><span class="k">        </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2779"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">&gt;</span> <span class="mf">0.3D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">&lt;</span><span class="mf">0.50D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2780"></a><span class="k">       </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2781"></a>                  <span class="o">+</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">-</span> <span class="mf">0.3D0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.5D0</span> <span class="o">-</span> <span class="mf">0.3D0</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2782"></a>                    <span class="o">*</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2783"></a>                        <span class="o">-</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2784"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">==</span> <span class="mf">0.5D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2785"></a><span class="k">        </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2786"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">&gt;</span> <span class="mf">0.5D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">&lt;</span><span class="mf">0.75D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2787"></a><span class="k">       </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2788"></a>                  <span class="o">+</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">-</span> <span class="mf">0.5D0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.75D0</span> <span class="o">-</span> <span class="mf">0.5D0</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2789"></a>                    <span class="o">*</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2790"></a>                        <span class="o">-</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2791"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">==</span> <span class="mf">0.75D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2792"></a><span class="k">        </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-2793"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">&gt;</span> <span class="mf">0.75D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">&lt;</span><span class="mf">1.0D0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2794"></a><span class="k">       </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2795"></a>                  <span class="o">+</span> <span class="p">((</span><span class="n">NormalizedPower</span> <span class="o">-</span> <span class="mf">0.75D0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0D0</span> <span class="o">-</span> <span class="mf">0.75D0</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-2796"></a>                    <span class="o">*</span> <span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2797"></a>                        <span class="o">-</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2798"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NormalizedPower</span> <span class="o">&gt;=</span> <span class="mf">1.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2799"></a><span class="k">        </span><span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">LUTable</span><span class="p">%</span><span class="n">NomVoltEfficiencyARR</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2800"></a>      <span class="n">ENDIF</span>
<a name="ln-2801"></a>
<a name="ln-2802"></a>      <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">tmpEffic</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-2803"></a>      <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="o">=</span> <span class="nb">Min</span><span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span><span class="p">,</span> <span class="mf">1.0D0</span><span class="p">)</span>
<a name="ln-2804"></a>
<a name="ln-2805"></a>      <span class="n">tempACpower</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="o">*</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span>
<a name="ln-2806"></a>
<a name="ln-2807"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">CurveFuncOfPower</span><span class="p">)</span>
<a name="ln-2808"></a>      <span class="n">NormalizedPower</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span> <span class="o">/</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">RatedPower</span>
<a name="ln-2809"></a>
<a name="ln-2810"></a>      <span class="n">tmpEffic</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">CurveNum</span><span class="p">,</span> <span class="n">NormalizedPower</span><span class="p">)</span>
<a name="ln-2811"></a>
<a name="ln-2812"></a>      <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">tmpEffic</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">MinEfficiency</span><span class="p">)</span>
<a name="ln-2813"></a>      <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="o">=</span> <span class="nb">Min</span><span class="p">(</span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span><span class="p">,</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">MaxEfficiency</span><span class="p">)</span>
<a name="ln-2814"></a>
<a name="ln-2815"></a>      <span class="n">tempACpower</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span> <span class="o">*</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span>
<a name="ln-2816"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">tempACpower</span> <span class="o">&lt;</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">MinPower</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! not enough to produce any AC power.  all lost. also standby mode</span>
<a name="ln-2817"></a>        <span class="n">tempACpower</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2818"></a>
<a name="ln-2819"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">tempACpower</span> <span class="o">&gt;</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">MaxPower</span><span class="p">)</span> <span class="k">then</span> <span class="c">! too much DC for inverter to handle, excess is lost</span>
<a name="ln-2820"></a>        <span class="n">tempACpower</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">MaxPower</span>
<a name="ln-2821"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseRate</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2822"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseEnergy</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2823"></a>      <span class="k">ELSE</span>
<a name="ln-2824"></a><span class="k">        </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseRate</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2825"></a>        <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseEnergy</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2826"></a>      <span class="n">ENDIF</span>
<a name="ln-2827"></a>
<a name="ln-2828"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">SimpleConstantEff</span><span class="p">)</span>
<a name="ln-2829"></a>
<a name="ln-2830"></a>      <span class="n">tempACpower</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">Efficiency</span><span class="o">*</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span>
<a name="ln-2831"></a>
<a name="ln-2832"></a>    <span class="k">END SELECT</span>
<a name="ln-2833"></a>
<a name="ln-2834"></a><span class="k">    </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACPowerOut</span> <span class="o">=</span> <span class="n">tempACpower</span>
<a name="ln-2835"></a>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACEnergyOut</span> <span class="o">=</span> <span class="n">tempACpower</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-2836"></a>
<a name="ln-2837"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">tempACpower</span> <span class="o">==</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2838"></a><span class="k">      </span><span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseEnergy</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">StandbyPower</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-2839"></a>      <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseRate</span>   <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">StandbyPower</span>
<a name="ln-2840"></a>    <span class="n">ENDIF</span>
<a name="ln-2841"></a>  <span class="k">ELSE</span> <span class="c">! not available per schedule, inverter is dead.</span>
<a name="ln-2842"></a>  <span class="c">!  assume thermal shunt for DC in, but no standby electricity</span>
<a name="ln-2843"></a>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACPowerOut</span>        <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2844"></a>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACEnergyOut</span>       <span class="o">=</span>  <span class="mf">0.0D0</span>
<a name="ln-2845"></a>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseRate</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2846"></a>    <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">AncillACuseEnergy</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2847"></a>
<a name="ln-2848"></a>  <span class="n">ENDIF</span>
<a name="ln-2849"></a>
<a name="ln-2850"></a>  <span class="c">!update report variables</span>
<a name="ln-2851"></a>  <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ThermLossRate</span>   <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">DCPowerIn</span> <span class="o">-</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACPowerOut</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-2852"></a>     <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">StandbyPower</span>
<a name="ln-2853"></a>  <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ThermLossEnergy</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ThermLossRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-2854"></a>  <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">QdotconvZone</span>    <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ThermLossRate</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0D0</span> <span class="o">-</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span><span class="p">)</span>
<a name="ln-2855"></a>  <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">QdotRadZone</span>     <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ThermLossRate</span> <span class="o">*</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span>
<a name="ln-2856"></a>
<a name="ln-2857"></a>
<a name="ln-2858"></a>  <span class="k">RETURN</span>
<a name="ln-2859"></a>
<a name="ln-2860"></a><span class="k">END SUBROUTINE </span><span class="n">ManageInverter</span>
<a name="ln-2861"></a>
<a name="ln-2862"></a>
<a name="ln-2863"></a><span class="k">SUBROUTINE </span><span class="n">UpdateLoadCenterRecords</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)</span>
<a name="ln-2864"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2865"></a>            <span class="c">!       AUTHOR:          B. Griffith</span>
<a name="ln-2866"></a>            <span class="c">!       DATE WRITTEN:    February 2008</span>
<a name="ln-2867"></a>            <span class="c">!       MODIFIED</span>
<a name="ln-2868"></a>            <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2869"></a>
<a name="ln-2870"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2871"></a>            <span class="c">! reporting</span>
<a name="ln-2872"></a>
<a name="ln-2873"></a>
<a name="ln-2874"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-2875"></a>
<a name="ln-2876"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-2877"></a>
<a name="ln-2878"></a>            <span class="c">! USE STATEMENTS: na</span>
<a name="ln-2879"></a>
<a name="ln-2880"></a>
<a name="ln-2881"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-2882"></a>
<a name="ln-2883"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2884"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LoadCenterNum</span>    <span class="c">! Load Center index</span>
<a name="ln-2885"></a>
<a name="ln-2886"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2887"></a>          <span class="c">! na</span>
<a name="ln-2888"></a>
<a name="ln-2889"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2890"></a>          <span class="c">! na</span>
<a name="ln-2891"></a>
<a name="ln-2892"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2893"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">InvertNum</span>      <span class="c">! inverter index</span>
<a name="ln-2894"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">StorNum</span>        <span class="c">! electrical storage index</span>
<a name="ln-2895"></a>        <span class="c">! Flow</span>
<a name="ln-2896"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">NumGenerators</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-2897"></a>
<a name="ln-2898"></a><span class="k">  SELECT CASE</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">BussType</span><span class="p">)</span>
<a name="ln-2899"></a>
<a name="ln-2900"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">ACBuss</span><span class="p">)</span>
<a name="ln-2901"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>   <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ElectProdRate</span><span class="p">)</span>
<a name="ln-2902"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElectricityProd</span> <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ElectricityProd</span><span class="p">)</span>
<a name="ln-2903"></a>
<a name="ln-2904"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">ACBussStorage</span><span class="p">)</span>
<a name="ln-2905"></a>    <span class="n">StorNum</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">StorageModelNum</span>
<a name="ln-2906"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">StorNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-2907"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>  <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ElectProdRate</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-2908"></a>                                                    <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DrawnPower</span>  <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StoredPower</span>
<a name="ln-2909"></a>
<a name="ln-2910"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElectricityProd</span> <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ElectricityProd</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2911"></a>                                                    <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DrawnEnergy</span>  <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span>
<a name="ln-2912"></a>    <span class="n">ENDIF</span>
<a name="ln-2913"></a>
<a name="ln-2914"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DCBussInverter</span><span class="p">,</span> <span class="n">DCBussInverterDCStorage</span><span class="p">)</span>
<a name="ln-2915"></a>    <span class="n">InvertNum</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">InverterModelNum</span>
<a name="ln-2916"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">InvertNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2917"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>   <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACPowerOut</span>
<a name="ln-2918"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElectricityProd</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACEnergyOut</span>
<a name="ln-2919"></a>    <span class="n">ENDIF</span>
<a name="ln-2920"></a>
<a name="ln-2921"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DCBussInverterACStorage</span><span class="p">)</span>
<a name="ln-2922"></a>    <span class="n">StorNum</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">StorageModelNum</span>
<a name="ln-2923"></a>    <span class="n">InvertNum</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">InverterModelNum</span>
<a name="ln-2924"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">InvertNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">StorNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2925"></a><span class="k">      </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElectProdRate</span>   <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACPowerOut</span> <span class="p">&amp;</span>
<a name="ln-2926"></a>                                                   <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DrawnPower</span>  <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StoredPower</span>
<a name="ln-2927"></a>      <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElectricityProd</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">InvertNum</span><span class="p">)%</span><span class="n">ACEnergyOut</span> <span class="p">&amp;</span>
<a name="ln-2928"></a>                                                 <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">DrawnEnergy</span>  <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">StorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span>
<a name="ln-2929"></a>    <span class="n">ENDIF</span>
<a name="ln-2930"></a>  <span class="k">END SELECT</span>
<a name="ln-2931"></a>
<a name="ln-2932"></a><span class="k">  </span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ThermalProdRate</span> <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ThermalProdRate</span><span class="p">)</span>
<a name="ln-2933"></a>  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ThermalProd</span> <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ThermalProd</span><span class="p">)</span>
<a name="ln-2934"></a>
<a name="ln-2935"></a>
<a name="ln-2936"></a><span class="k">RETURN</span>
<a name="ln-2937"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateLoadCenterRecords</span>
<a name="ln-2938"></a>
<a name="ln-2939"></a><span class="k">SUBROUTINE </span><span class="n">UpdateWholeBuildingRecords</span>
<a name="ln-2940"></a>
<a name="ln-2941"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2942"></a>            <span class="c">!       AUTHOR:          Richard Liesen</span>
<a name="ln-2943"></a>            <span class="c">!       DATE WRITTEN:    February 2003</span>
<a name="ln-2944"></a>            <span class="c">!       MODIFIED       B. Griffith  Mar. 2008 multiple load centers.</span>
<a name="ln-2945"></a>            <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2946"></a>
<a name="ln-2947"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2948"></a>            <span class="c">! reporting</span>
<a name="ln-2949"></a>
<a name="ln-2950"></a>
<a name="ln-2951"></a>            <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-2952"></a>
<a name="ln-2953"></a>            <span class="c">! REFERENCES: formerly called UpdateRecords when there was only one load center</span>
<a name="ln-2954"></a>            <span class="c">!  now this reporting is for the entire model.</span>
<a name="ln-2955"></a>
<a name="ln-2956"></a>            <span class="c">! USE STATEMENTS: na</span>
<a name="ln-2957"></a>
<a name="ln-2958"></a><span class="k">IMPLICIT NONE</span>
<a name="ln-2959"></a>
<a name="ln-2960"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2961"></a>
<a name="ln-2962"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2963"></a>          <span class="c">! na</span>
<a name="ln-2964"></a>
<a name="ln-2965"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2966"></a>          <span class="c">! na</span>
<a name="ln-2967"></a>
<a name="ln-2968"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2969"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">external</span>    <span class="kd">::</span> <span class="n">GetInstantMeterValue</span>
<a name="ln-2970"></a>
<a name="ln-2971"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecProducedCoGen</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2972"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecProducedFacility</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2973"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalPurchased</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotalSurplus</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2975"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NetPurchased</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2976"></a>
<a name="ln-2977"></a>        <span class="c">! Flow</span>
<a name="ln-2978"></a>
<a name="ln-2979"></a>
<a name="ln-2980"></a>  <span class="n">ElecProducedCoGen</span><span class="o">=</span><span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">ElecProducedCoGenIndex</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="c">!whole building</span>
<a name="ln-2981"></a>  <span class="n">ElecProducedFacility</span> <span class="o">=</span> <span class="n">ElecProducedCoGen</span> <span class="o">+</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElecProducedPVRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span> <span class="p">&amp;</span> <span class="c">!whole building</span>
<a name="ln-2982"></a>                                            <span class="o">+</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElecProducedWTRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-2983"></a>
<a name="ln-2984"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityProd</span> <span class="o">=</span> <span class="n">ElecProducedFacility</span>   <span class="c">!whole building</span>
<a name="ln-2985"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectProdRate</span> <span class="o">=</span> <span class="n">ElecProducedFacility</span><span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>   <span class="c">!whole building</span>
<a name="ln-2986"></a>
<a name="ln-2987"></a>
<a name="ln-2988"></a>
<a name="ln-2989"></a>  <span class="c">!Report the Total Electric Power Purchased [W], If negative then there is extra power to be sold or stored.</span>
<a name="ln-2990"></a>  <span class="n">TotalPurchased</span> <span class="o">=</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalElectricDemand</span> <span class="o">-</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectProdRate</span>
<a name="ln-2991"></a>  <span class="c">!Check this value against a tolerance to aid in reporting.</span>
<a name="ln-2992"></a>  <span class="k">If</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TotalPurchased</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0001d0</span><span class="p">)</span> <span class="n">TotalPurchased</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2993"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">TotalPurchased</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">totalPurchased</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! don&#39;t want negative purchased...</span>
<a name="ln-2994"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectPurchRate</span> <span class="o">=</span> <span class="n">TotalPurchased</span>
<a name="ln-2995"></a>  <span class="c">!Report the Total Electric Energy Purchased [J]</span>
<a name="ln-2996"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityPurch</span> <span class="o">=</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectPurchRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-2997"></a>
<a name="ln-2998"></a>  <span class="c">!report the total electric surplus....</span>
<a name="ln-2999"></a>  <span class="n">TotalSurplus</span> <span class="o">=</span><span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectProdRate</span> <span class="o">-</span>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalElectricDemand</span>
<a name="ln-3000"></a>  <span class="k">If</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TotalSurplus</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mf">0.0001d0</span><span class="p">)</span> <span class="n">TotalSurplus</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3001"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">TotalSurplus</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">TotalSurplus</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! don&#39;t want negative surplus</span>
<a name="ln-3002"></a>
<a name="ln-3003"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectSurplusRate</span> <span class="o">=</span> <span class="n">TotalSurplus</span>
<a name="ln-3004"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricitySurplus</span> <span class="o">=</span><span class="n">TotalSurplus</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3005"></a>
<a name="ln-3006"></a>  <span class="c">!report the net electricity , + is purchased, - is surplus</span>
<a name="ln-3007"></a>  <span class="n">NetPurchased</span> <span class="o">=</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">TotalElectricDemand</span> <span class="o">-</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectProdRate</span>
<a name="ln-3008"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityNetRate</span> <span class="o">=</span> <span class="n">NetPurchased</span>
<a name="ln-3009"></a>
<a name="ln-3010"></a>  <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityNet</span> <span class="o">=</span> <span class="n">WholeBldgElectSummary</span><span class="p">%</span><span class="n">ElectricityNetRate</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3011"></a>
<a name="ln-3012"></a><span class="k">RETURN</span>
<a name="ln-3013"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateWholeBuildingRecords</span>
<a name="ln-3014"></a>
<a name="ln-3015"></a><span class="k">SUBROUTINE </span><span class="n">FigureInverterZoneGains</span>
<a name="ln-3016"></a>
<a name="ln-3017"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3018"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-3019"></a>          <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-3020"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3021"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3022"></a>
<a name="ln-3023"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3024"></a>          <span class="c">! Couple inverter skin losses to zone heat gains</span>
<a name="ln-3025"></a>
<a name="ln-3026"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3027"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3028"></a>
<a name="ln-3029"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3030"></a>          <span class="c">! na</span>
<a name="ln-3031"></a>
<a name="ln-3032"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3033"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span>
<a name="ln-3034"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneIntGain</span>
<a name="ln-3035"></a>
<a name="ln-3036"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3037"></a>
<a name="ln-3038"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3039"></a>          <span class="c">! na</span>
<a name="ln-3040"></a>
<a name="ln-3041"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3042"></a>          <span class="c">! na</span>
<a name="ln-3043"></a>
<a name="ln-3044"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3045"></a>          <span class="c">! na</span>
<a name="ln-3046"></a>
<a name="ln-3047"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3048"></a>          <span class="c">! na</span>
<a name="ln-3049"></a>
<a name="ln-3050"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3051"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3052"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">InvertNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3053"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3054"></a>
<a name="ln-3055"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumInverters</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3056"></a>
<a name="ln-3057"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3058"></a><span class="k">    </span><span class="n">Inverter</span><span class="p">%</span><span class="n">QdotconvZone</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3059"></a>    <span class="n">Inverter</span><span class="p">%</span><span class="n">QdotRadZone</span>  <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3060"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3061"></a>  <span class="n">ENDIF</span>
<a name="ln-3062"></a>  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3063"></a>
<a name="ln-3064"></a><span class="c">!  IF(DoingSizing)THEN</span>
<a name="ln-3065"></a>
<a name="ln-3066"></a><span class="c">!  ENDIF</span>
<a name="ln-3067"></a>
<a name="ln-3068"></a>  <span class="k">RETURN</span>
<a name="ln-3069"></a>
<a name="ln-3070"></a><span class="k">END SUBROUTINE </span><span class="n">FigureInverterZoneGains</span>
<a name="ln-3071"></a>
<a name="ln-3072"></a><span class="c">!***********************************************************************************************************************************</span>
<a name="ln-3073"></a>
<a name="ln-3074"></a><span class="k">SUBROUTINE </span><span class="n">ManageElectCenterStorageInteractions</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">,</span><span class="n">StorageDrawnPower</span><span class="p">,</span><span class="n">StorageStoredPower</span><span class="p">)</span>
<a name="ln-3075"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3076"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-3077"></a>          <span class="c">!       DATE WRITTEN   June-August 2008</span>
<a name="ln-3078"></a>          <span class="c">!       MODIFIED       BG May 2009, added EMS</span>
<a name="ln-3079"></a>          <span class="c">!                      BN (FSEC) Feb 2010 (pass out two storage values)</span>
<a name="ln-3080"></a>          <span class="c">!                      Y. KyungTae &amp; W. Wang July-August, 2011 Added a battery model</span>
<a name="ln-3081"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3082"></a>
<a name="ln-3083"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3084"></a>          <span class="c">! manage controls and calculations related to electrical storage in Electric load center</span>
<a name="ln-3085"></a>
<a name="ln-3086"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3087"></a>          <span class="c">! started from fuel cell storage routine and modified for general use in load center</span>
<a name="ln-3088"></a>          <span class="c">! needs lots of work</span>
<a name="ln-3089"></a>
<a name="ln-3090"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3091"></a>          <span class="c">! na</span>
<a name="ln-3092"></a>
<a name="ln-3093"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3094"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReallocateRealArray</span>
<a name="ln-3095"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-3096"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span><span class="p">,</span><span class="n">SysTimeElapsed</span>
<a name="ln-3097"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-3098"></a>  <span class="k">USE </span><span class="n">DataGlobals</span>    <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStep</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">BeginEnvrnFlag</span><span class="p">,</span> <span class="n">WarmupFlag</span><span class="p">,</span> <span class="n">HourOfDay</span>
<a name="ln-3099"></a>
<a name="ln-3100"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3101"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3102"></a>  <span class="kt">INTEGER</span><span class="p">,</span>      <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LoadCenterNum</span> <span class="c">! load center number, index for structure</span>
<a name="ln-3103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">StorageDrawnPower</span>       <span class="c">! Electric Power Draw Rate from storage units</span>
<a name="ln-3104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">StorageStoredPower</span>      <span class="c">! Electric Power Store Rate from storage units</span>
<a name="ln-3105"></a>
<a name="ln-3106"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3107"></a>          <span class="c">! na</span>
<a name="ln-3108"></a>
<a name="ln-3109"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3110"></a>          <span class="c">! na</span>
<a name="ln-3111"></a>
<a name="ln-3112"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3113"></a>          <span class="c">! na</span>
<a name="ln-3114"></a>
<a name="ln-3115"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">tmpPdraw</span>    <span class="o">=</span> <span class="mf">0.0D0</span>    <span class="c">! power draw from storage, working var</span>
<a name="ln-3117"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">tmpPcharge</span>  <span class="o">=</span> <span class="mf">0.0D0</span>    <span class="c">! power charge to storage, working var</span>
<a name="ln-3118"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">drawing</span>     <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! true if drawing power</span>
<a name="ln-3119"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">charging</span>    <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! true if charging</span>
<a name="ln-3120"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ElecStorNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Pgensupply</span>  <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Pdemand</span>     <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">!</span>
<a name="ln-3123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PpcuLosses</span>  <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">!</span>
<a name="ln-3124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">Pstorage</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3125"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">Save</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>
<a name="ln-3126"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3127"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyWarmupFlag</span> <span class="c">! flag for init after warmup complete</span>
<a name="ln-3128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TimeElapsed</span>         <span class="c">! Fraction of the current hour that has elapsed (h)</span>
<a name="ln-3129"></a>  <span class="kt">INTEGER</span>         <span class="kd">::</span> <span class="n">BinNum</span>                     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">Input0</span>                     <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3131"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">I0</span>     <span class="c">! initial guess of current</span>
<a name="ln-3132"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">T0</span>     <span class="c">! initial guess of T(I)</span>
<a name="ln-3133"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">q0</span>     <span class="c">! initial charge</span>
<a name="ln-3134"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">qmax</span>   <span class="c">! maximum capacity</span>
<a name="ln-3135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">qmaxf</span>  <span class="c">! maximum capacity, a function of current(I)</span>
<a name="ln-3136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">k</span>      <span class="c">! change rate from chemically bound charge to available charge</span>
<a name="ln-3137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">c</span>      <span class="c">! fraction available charge capacity to total capacity</span>
<a name="ln-3138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">TotalSOC</span> <span class="c">! total charge (ThisTimeStepAvailable+ThisTimeStepBound)</span>
<a name="ln-3139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">Ef</span>     <span class="c">! effective internal voltage source, V</span>
<a name="ln-3140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">E0c</span>    <span class="c">! fully charged internal battery voltage</span>
<a name="ln-3141"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">Volt</span>   <span class="c">! terminal voltage</span>
<a name="ln-3142"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">Pw</span>     <span class="c">! power required</span>
<a name="ln-3143"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">E0d</span>    <span class="c">! fully discharged internal battery voltage</span>
<a name="ln-3144"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">InternalR</span>  <span class="c">! internal resistance</span>
<a name="ln-3145"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">XF</span>     <span class="c">! normalized maximum capacity at the given current</span>
<a name="ln-3146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">X</span>      <span class="c">! normalized maximum capacity at the given current</span>
<a name="ln-3147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">Inew</span>   <span class="c">! converged current</span>
<a name="ln-3148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">Tnew</span>   <span class="c">! charge of discharge time, defined by T=qmaxf/I</span>
<a name="ln-3149"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">Imax</span>   <span class="c">! maximum current</span>
<a name="ln-3150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">Numpar</span>          <span class="c">! number of battery in parallel</span>
<a name="ln-3151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">Numser</span>          <span class="c">! number of battery in series</span>
<a name="ln-3152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">Numbattery</span>      <span class="c">! number of battery (Numpar*Numser)</span>
<a name="ln-3153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">initialCharge</span>   <span class="c">! initial charge in Ah</span>
<a name="ln-3154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">dividend</span>        <span class="c">!</span>
<a name="ln-3155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">divisor</span>         <span class="c">!</span>
<a name="ln-3156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">newAvailable</span>    <span class="c">! new available charge in Ah</span>
<a name="ln-3157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">newBound</span>        <span class="c">! new bound charge in Ah</span>
<a name="ln-3158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span><span class="n">error</span><span class="o">=</span><span class="mf">0.0D0</span>   <span class="c">! error in iterative process</span>
<a name="ln-3159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span><span class="n">Pactual</span><span class="o">=</span><span class="mf">0.0D0</span> <span class="c">! actual Power output</span>
<a name="ln-3160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span><span class="n">RHS</span><span class="o">=</span><span class="mf">0.0D0</span>     <span class="c">! right hand side of a equation</span>
<a name="ln-3161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span><span class="n">I</span><span class="o">=</span><span class="mf">0.0D0</span>       <span class="c">! current</span>
<a name="ln-3162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span><span class="n">DeltaSOC1</span>     <span class="c">! difference of fractional SOC between this time step and last time step</span>
<a name="ln-3163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span><span class="n">DeltaSOC2</span>     <span class="c">! difference of fractional SOC between last time step and last two time step</span>
<a name="ln-3164"></a>  <span class="kt">Integer</span>      <span class="kd">::</span><span class="n">SaveArrayBounds</span> <span class="c">!Maximum size for the arrays used for rainflow counting</span>
<a name="ln-3165"></a>
<a name="ln-3166"></a>  <span class="k">If</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">StoragePresent</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-3167"></a>
<a name="ln-3168"></a><span class="k">  </span><span class="n">ElecStorNum</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">StorageModelNum</span>
<a name="ln-3169"></a>
<a name="ln-3170"></a>   <span class="c">!_____________________________________</span>
<a name="ln-3171"></a>   <span class="c">! begin initalizations</span>
<a name="ln-3172"></a>  <span class="c">! perform the one time initializations</span>
<a name="ln-3173"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3174"></a>  <span class="c">! initialize the environment and sizing flags</span>
<a name="ln-3175"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumElecStorageDevices</span><span class="p">))</span>
<a name="ln-3176"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">NumElecStorageDevices</span><span class="p">))</span>
<a name="ln-3177"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3178"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3179"></a>    <span class="n">MyWarmupFlag</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3180"></a>  <span class="k">END IF</span>
<a name="ln-3181"></a>
<a name="ln-3182"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3183"></a><span class="k">    IF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">SimpleBucketStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3184"></a><span class="k">       </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StartingEnergyStored</span>
<a name="ln-3185"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StartingEnergyStored</span>
<a name="ln-3186"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelNeedFromStorage</span>        <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3187"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelFromStorage</span>            <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3188"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelIntoStorage</span>            <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3189"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">QdotConvZone</span>              <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3190"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">QdotRadZone</span>               <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3191"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">TimeElapsed</span>               <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3192"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ElectEnergyinStorage</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3193"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredPower</span>               <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3194"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span>              <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3195"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DecrementedEnergyStored</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3196"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnPower</span>                <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3197"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnEnergy</span>               <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3198"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span>             <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3199"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossEnergy</span>           <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3200"></a>
<a name="ln-3201"></a>
<a name="ln-3202"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">KiBaMBattery</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3203"></a><span class="k">       </span><span class="n">initialCharge</span> <span class="o">=</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxAhCapacity</span> <span class="o">*</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StartingSOC</span>
<a name="ln-3204"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTwoTimeStepAvailable</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span>
<a name="ln-3205"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTwoTimeStepBound</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span><span class="p">)</span>
<a name="ln-3206"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span>
<a name="ln-3207"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span><span class="p">)</span>
<a name="ln-3208"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepAvailable</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span>
<a name="ln-3209"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepBound</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span><span class="p">)</span>
<a name="ln-3210"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LifeCalculation</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">Battery_LifeCalculation_Yes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3211"></a><span class="k">          </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">count0</span>  <span class="o">=</span> <span class="mi">2</span>                                     <span class="c">! Index 1 is for initial SOC, so new input starts from index 2.</span>
<a name="ln-3212"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">B10</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StartingSOC</span>  <span class="c">! the initial fractional SOC is stored as the reference</span>
<a name="ln-3213"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">X0</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3214"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">OneNmb0</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3215"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">Nmb0</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3216"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">BatteryDamage</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3217"></a>       <span class="n">ENDIF</span>
<a name="ln-3218"></a>    <span class="n">ENDIF</span>
<a name="ln-3219"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3220"></a>    <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3221"></a>  <span class="n">ENDIF</span>
<a name="ln-3222"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3223"></a>
<a name="ln-3224"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3225"></a>    <span class="c">! need to reset initial state of charge at beginning of environment but after warm up is complete</span>
<a name="ln-3226"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">SimpleBucketStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3227"></a><span class="k">       </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StartingEnergyStored</span>
<a name="ln-3228"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StartingEnergyStored</span>
<a name="ln-3229"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">KiBaMBattery</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3230"></a><span class="k">       </span><span class="n">initialCharge</span> <span class="o">=</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxAhCapacity</span> <span class="o">*</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StartingSOC</span>
<a name="ln-3231"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTwoTimeStepAvailable</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span>
<a name="ln-3232"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTwoTimeStepBound</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span><span class="p">)</span>
<a name="ln-3233"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span>
<a name="ln-3234"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span><span class="p">)</span>
<a name="ln-3235"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepAvailable</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span>
<a name="ln-3236"></a>       <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepBound</span> <span class="o">=</span> <span class="n">initialCharge</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span><span class="p">)</span>
<a name="ln-3237"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LifeCalculation</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">Battery_LifeCalculation_Yes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3238"></a><span class="k">          </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">count0</span>  <span class="o">=</span> <span class="mi">2</span>                                     <span class="c">! Index 1 is for initial SOC, so new input starts from index 2.</span>
<a name="ln-3239"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">B10</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StartingSOC</span>  <span class="c">! the initial fractional SOC is stored as the reference</span>
<a name="ln-3240"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">X0</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3241"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">OneNmb0</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3242"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">Nmb0</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3243"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">BatteryDamage</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3244"></a>       <span class="n">ENDIF</span>
<a name="ln-3245"></a>    <span class="n">ENDIF</span>
<a name="ln-3246"></a>    <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3247"></a>  <span class="n">ENDIF</span>
<a name="ln-3248"></a>
<a name="ln-3249"></a>  <span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">HourOfDay</span> <span class="o">+</span> <span class="n">TimeStep</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-3250"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">/=</span> <span class="n">TimeElapsed</span><span class="p">)</span> <span class="k">Then</span> <span class="c">!time changed, update last with &quot;current&quot; result from previous time</span>
<a name="ln-3251"></a><span class="c">!   When program comes here, this means the first iteration of a new system time step. Battery life calculation needs to be considered</span>
<a name="ln-3252"></a><span class="c">!   for the Kinetic battery model.</span>
<a name="ln-3253"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">KiBaMBattery</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3254"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LifeCalculation</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">Battery_LifeCalculation_Yes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3255"></a><span class="c">!    At this point, the current values, last time step values and last two time step values have not been updated, hence:</span>
<a name="ln-3256"></a><span class="c">!    &quot;ThisTimeStep*&quot; actually points to the previous one time step</span>
<a name="ln-3257"></a><span class="c">!    &quot;LastTimeStep*&quot; actually points to the previous two time steps</span>
<a name="ln-3258"></a><span class="c">!    &quot;LastTwoTimeStep&quot; actually points to the previous three time steps</span>
<a name="ln-3259"></a>
<a name="ln-3260"></a><span class="c">!      Calculate the fractional SOC change between the &quot;current&quot; time step and the &quot;previous one&quot; time step</span>
<a name="ln-3261"></a>       <span class="n">DeltaSOC1</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepAvailable</span> <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepBound</span> <span class="p">&amp;</span>
<a name="ln-3262"></a>                   <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span> <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span>
<a name="ln-3263"></a>       <span class="n">DeltaSOC1</span> <span class="o">=</span> <span class="n">DeltaSOC1</span><span class="o">/</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxAhCapacity</span>
<a name="ln-3264"></a>
<a name="ln-3265"></a><span class="c">!      Calculate the fractional SOC change between the &quot;previous one&quot; time step and the &quot;previous two&quot; time steps</span>
<a name="ln-3266"></a>       <span class="n">DeltaSOC2</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span> <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span> <span class="p">&amp;</span>
<a name="ln-3267"></a>                   <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTwoTimeStepAvailable</span> <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTwoTimeStepBound</span>
<a name="ln-3268"></a>       <span class="n">DeltaSOC2</span> <span class="o">=</span> <span class="n">DeltaSOC2</span><span class="o">/</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxAhCapacity</span>
<a name="ln-3269"></a>
<a name="ln-3270"></a><span class="c">!     DeltaSOC2 = 0 may occur at the begining of each simulation environment.</span>
<a name="ln-3271"></a><span class="c">!     DeltaSOC1 * DeltaSOC2 means that the SOC from &quot;LastTimeStep&quot; is a peak or valley. Only peak or valley needs</span>
<a name="ln-3272"></a><span class="c">!     to call the rain flow algorithm</span>
<a name="ln-3273"></a>       <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">DeltaSOC2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">((</span><span class="n">DeltaSOC1</span> <span class="o">*</span> <span class="n">DeltaSOC2</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3274"></a><span class="c">!     Because we cannot determine whehter &quot;ThisTimeStep&quot; is a peak or valley (next time step is unknown yet), we</span>
<a name="ln-3275"></a><span class="c">!     use the &quot;LastTimeStep&quot; value for battery life calculation.</span>
<a name="ln-3276"></a>         <span class="n">Input0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span> <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-3277"></a>                  <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxAhCapacity</span>
<a name="ln-3278"></a>         <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">B10</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">count0</span><span class="p">)</span>   <span class="o">=</span> <span class="n">input0</span>
<a name="ln-3279"></a>
<a name="ln-3280"></a><span class="c">!        The arrary size needs to be increased when count = MAXRainflowArrayBounds. Please note that (MAXRainflowArrayBounds +1)</span>
<a name="ln-3281"></a><span class="c">!        is the index used in the subroutine RainFlow. So we cannot reallocate array size until count = MAXRainflowArrayBounds +1.</span>
<a name="ln-3282"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">count0</span> <span class="o">==</span> <span class="n">MAXRainflowArrayBounds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3283"></a><span class="k">            </span><span class="n">SaveArrayBounds</span><span class="o">=</span><span class="n">MAXRainflowArrayBounds</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3284"></a>            <span class="k">CALL </span><span class="n">ReallocateRealArray</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">B10</span><span class="p">,</span><span class="n">SaveArrayBounds</span><span class="p">,</span><span class="n">MAXRainFlowArrayInc</span><span class="p">)</span>
<a name="ln-3285"></a>            <span class="n">SaveArrayBounds</span><span class="o">=</span><span class="n">MAXRainflowArrayBounds</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3286"></a>            <span class="k">CALL </span><span class="n">ReallocateRealArray</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">X0</span><span class="p">,</span><span class="n">SaveArrayBounds</span><span class="p">,</span><span class="n">MAXRainFlowArrayInc</span><span class="p">)</span>
<a name="ln-3287"></a><span class="c">!           Decrement by 1 is needed because the last input parameter of RainFlow is MAXRainflowArrayBounds+1</span>
<a name="ln-3288"></a>            <span class="n">MAXRainflowArrayBounds</span><span class="o">=</span><span class="n">SaveArrayBounds</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3289"></a>         <span class="n">ENDIF</span>
<a name="ln-3290"></a>
<a name="ln-3291"></a>         <span class="k">Call </span><span class="n">Rainflow</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">CycleBinNum</span><span class="p">,</span><span class="n">input0</span><span class="p">,</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">B10</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3292"></a>            <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">X0</span><span class="p">,</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">count0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3293"></a>            <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">Nmb0</span><span class="p">,</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">OneNmb0</span><span class="p">,</span><span class="n">MAXRainflowArrayBounds</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3294"></a>
<a name="ln-3295"></a>         <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">BatteryDamage</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3296"></a>
<a name="ln-3297"></a>         <span class="k">DO </span><span class="n">BinNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">CycleBinNum</span>
<a name="ln-3298"></a><span class="c">!       Battery damage is calculated by accumulating the impact from each cycle.</span>
<a name="ln-3299"></a>          <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">BatteryDamage</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">OneNmb0</span><span class="p">(</span><span class="n">BinNum</span><span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-3300"></a>              <span class="n">Curvevalue</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LifeCurveNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3301"></a>               <span class="p">(</span><span class="kt">Real</span><span class="p">(</span><span class="n">BinNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="kt">Real</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">CycleBinNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)))</span> <span class="p">&amp;</span>
<a name="ln-3302"></a>               <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">BatteryDamage</span>
<a name="ln-3303"></a>         <span class="n">ENDDO</span>
<a name="ln-3304"></a>       <span class="n">ENDIF</span>
<a name="ln-3305"></a>    <span class="n">ENDIF</span>
<a name="ln-3306"></a>
<a name="ln-3307"></a><span class="c">!   Updating &quot;LastTimeStep&quot; and &quot;LastTwoTimeStep&quot; should be done after calling the rain flow algorithm.</span>
<a name="ln-3308"></a><span class="c">!   Otherwise, it is not possible to determine whehter &quot;LastTimeStep&quot; is a peak or valley value.</span>
<a name="ln-3309"></a>
<a name="ln-3310"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span>
<a name="ln-3311"></a>    <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTwoTimeStepAvailable</span> <span class="o">=</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span>
<a name="ln-3312"></a>    <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTwoTimeStepBound</span> <span class="o">=</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span>
<a name="ln-3313"></a>    <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span><span class="o">=</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepAvailable</span>
<a name="ln-3314"></a>    <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span><span class="o">=</span><span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepBound</span>
<a name="ln-3315"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">TimeElapsed</span>
<a name="ln-3316"></a>  <span class="n">ENDIF</span>
<a name="ln-3317"></a>
<a name="ln-3318"></a>  <span class="c">! end Inits</span>
<a name="ln-3319"></a>
<a name="ln-3320"></a>  <span class="c">!Begin determine Power demand request</span>
<a name="ln-3321"></a>
<a name="ln-3322"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">InverterPresent</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-3323"></a>   <span class="c">! this will be lagged from last calc.</span>
<a name="ln-3324"></a>    <span class="n">PpcuLosses</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">InverterModelNum</span><span class="p">)%</span><span class="n">ThermLossRate</span>
<a name="ln-3325"></a>  <span class="k">ELSE</span>
<a name="ln-3326"></a><span class="k">    </span><span class="n">PpcuLosses</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3327"></a>  <span class="n">ENDIF</span>
<a name="ln-3328"></a>
<a name="ln-3329"></a>  <span class="c">!  Pdemand = Sum (ElecLoadCenter(LoadCenterNum)%ElecGen%PowerRequestThisTimestep) + PpcuLosses</span>
<a name="ln-3330"></a>  <span class="c">!  Modified when improved electric load center disptach procedure was implemented</span>
<a name="ln-3331"></a>    <span class="n">Pdemand</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">TotalPowerRequest</span> <span class="o">+</span> <span class="n">PpcuLosses</span>
<a name="ln-3332"></a>  <span class="c">! END determine Power demand request.</span>
<a name="ln-3333"></a>
<a name="ln-3334"></a>  <span class="c">! BEGIN determine available generation supply</span>
<a name="ln-3335"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">BussType</span><span class="p">)</span>
<a name="ln-3336"></a>
<a name="ln-3337"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">ACBussStorage</span><span class="p">)</span>
<a name="ln-3338"></a>    <span class="n">Pgensupply</span> <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">ElectProdRate</span><span class="p">)</span>
<a name="ln-3339"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DCBussInverterDCStorage</span><span class="p">)</span>
<a name="ln-3340"></a>    <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DCElectProdRate</span> <span class="o">=</span> <span class="nb">Sum</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">ElecGen</span><span class="p">%</span><span class="n">DCElectProdRate</span><span class="p">)</span>
<a name="ln-3341"></a>    <span class="n">Pgensupply</span> <span class="o">=</span>  <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">DCElectProdRate</span>
<a name="ln-3342"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DCBussInverterACStorage</span><span class="p">)</span>
<a name="ln-3343"></a>
<a name="ln-3344"></a>    <span class="n">Pgensupply</span> <span class="o">=</span> <span class="n">Inverter</span><span class="p">(</span><span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LoadCenterNum</span><span class="p">)%</span><span class="n">InverterModelNum</span><span class="p">)%</span><span class="n">ACPowerOut</span>
<a name="ln-3345"></a>  <span class="k">END SELECT</span>
<a name="ln-3346"></a>  <span class="c">! End determine available generation</span>
<a name="ln-3347"></a>
<a name="ln-3348"></a>   <span class="c">!initialize locals</span>
<a name="ln-3349"></a>  <span class="n">tmpPdraw</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3350"></a>  <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3351"></a>  <span class="n">drawing</span>  <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3352"></a>  <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3353"></a>  <span class="n">Pstorage</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3354"></a>
<a name="ln-3355"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">KiBaMBattery</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3356"></a><span class="k">      </span><span class="n">Numpar</span>     <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ParallelNum</span>
<a name="ln-3357"></a>      <span class="n">Numser</span>     <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">SeriesNum</span>
<a name="ln-3358"></a>      <span class="n">Numbattery</span> <span class="o">=</span> <span class="n">Numpar</span><span class="o">*</span><span class="n">Numser</span>
<a name="ln-3359"></a>      <span class="n">InternalR</span>  <span class="o">=</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">InternalR</span>
<a name="ln-3360"></a>      <span class="n">qmax</span>       <span class="o">=</span> <span class="n">Elecstorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxAhCapacity</span>
<a name="ln-3361"></a>      <span class="n">E0c</span>        <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ChargedOCV</span>
<a name="ln-3362"></a>      <span class="n">E0d</span>        <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DischargedOCV</span>
<a name="ln-3363"></a>      <span class="n">k</span>          <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ChargeConversionRate</span>
<a name="ln-3364"></a>      <span class="n">c</span>          <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailableFrac</span>
<a name="ln-3365"></a>  <span class="n">ENDIF</span>
<a name="ln-3366"></a>
<a name="ln-3367"></a>
<a name="ln-3368"></a>
<a name="ln-3369"></a><span class="c">!*****************************************************************************************************************</span>
<a name="ln-3370"></a>
<a name="ln-3371"></a>  <span class="c">! step 1 figure out what is desired of electrical storage system</span>
<a name="ln-3372"></a>
<a name="ln-3373"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">Pgensupply</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">Pdemand</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3374"></a>    <span class="c">!draw from storage</span>
<a name="ln-3375"></a>    <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="n">Pdemand</span>  <span class="o">-</span> <span class="n">Pgensupply</span>
<a name="ln-3376"></a>    <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3377"></a>    <span class="n">drawing</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3378"></a>    <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3379"></a>
<a name="ln-3380"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Pgensupply</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">Pdemand</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3381"></a>    <span class="c">!add to storage</span>
<a name="ln-3382"></a>    <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="n">Pgensupply</span> <span class="o">-</span> <span class="n">Pdemand</span>
<a name="ln-3383"></a>    <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3384"></a>    <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3385"></a>    <span class="n">drawing</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3386"></a>
<a name="ln-3387"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Pgensupply</span> <span class="o">==</span> <span class="p">(</span><span class="n">Pdemand</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3388"></a>    <span class="c">!do nothing</span>
<a name="ln-3389"></a>    <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3390"></a>    <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3391"></a>    <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3392"></a>    <span class="n">drawing</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3393"></a>  <span class="n">ENDIF</span>
<a name="ln-3394"></a>
<a name="ln-3395"></a>  <span class="c">! EMS override -- intent to draw, charge or hold?</span>
<a name="ln-3396"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSOverridePelFromStorage</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3397"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSOverridePelIntoStorage</span><span class="p">)</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3398"></a>    <span class="c">! EMS is calling for specific discharge rate</span>
<a name="ln-3399"></a>    <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelFromStorage</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-3400"></a>    <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3401"></a>    <span class="n">drawing</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3402"></a>    <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3403"></a>  <span class="n">ELSEIF</span><span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSOverridePelFromStorage</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3404"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSOverridePelIntoStorage</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3405"></a>    <span class="c">! EMS is calling for specific charge rate</span>
<a name="ln-3406"></a>    <span class="n">tmpPcharge</span><span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelIntoStorage</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-3407"></a>    <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3408"></a>    <span class="n">drawing</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3409"></a>    <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3410"></a>  <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSOverridePelFromStorage</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3411"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSOverridePelIntoStorage</span><span class="p">)</span>  <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3412"></a>    <span class="c">! EMS is asking to override both</span>
<a name="ln-3413"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelIntoStorage</span> <span class="o">&gt;</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelFromStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3414"></a><span class="k">      </span><span class="n">tmpPcharge</span><span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelIntoStorage</span> <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelFromStorage</span>
<a name="ln-3415"></a>      <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3416"></a>      <span class="n">drawing</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3417"></a>      <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3418"></a>    <span class="n">ELSEIF</span> <span class="p">(</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelIntoStorage</span> <span class="o">&lt;</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelFromStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3419"></a><span class="k">      </span><span class="n">tmpPdraw</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelFromStorage</span> <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSValuePelIntoStorage</span>
<a name="ln-3420"></a>      <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3421"></a>      <span class="n">drawing</span>  <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3422"></a>      <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3423"></a>    <span class="k">ELSE</span> <span class="c">!they equal just hold</span>
<a name="ln-3424"></a>      <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3425"></a>      <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3426"></a>      <span class="n">drawing</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3427"></a>      <span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3428"></a>    <span class="n">ENDIF</span>
<a name="ln-3429"></a>  <span class="n">ENDIF</span>
<a name="ln-3430"></a>
<a name="ln-3431"></a><span class="c">!*****************************************************************************************************************</span>
<a name="ln-3432"></a>
<a name="ln-3433"></a>
<a name="ln-3434"></a>  <span class="c">!  step 2, figure out what is possible for electrical storage draws/charges</span>
<a name="ln-3435"></a>
<a name="ln-3436"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">charging</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3437"></a>
<a name="ln-3438"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">SimpleBucketStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3439"></a>
<a name="ln-3440"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">&gt;=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxEnergyCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3441"></a>          <span class="c">! storage full!  no more allowed!</span>
<a name="ln-3442"></a>          <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3443"></a>   <span class="c">!       Constrained = .true.</span>
<a name="ln-3444"></a>          <span class="n">charging</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3445"></a>      <span class="n">ENDIF</span>
<a name="ln-3446"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">tmpPcharge</span> <span class="o">&gt;</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxPowerStore</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3447"></a><span class="k">          </span><span class="n">tmpPcharge</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxPowerStore</span>
<a name="ln-3448"></a>  <span class="c">!        Constrained = .true.</span>
<a name="ln-3449"></a>      <span class="n">ENDIF</span>
<a name="ln-3450"></a>
<a name="ln-3451"></a>
<a name="ln-3452"></a>      <span class="c">!now add energy to storage from charging</span>
<a name="ln-3453"></a>     <span class="k">IF</span> <span class="p">((</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-3454"></a>         <span class="o">+</span> <span class="n">tmpPcharge</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">*</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficCharge</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3455"></a>          <span class="o">&lt;</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxEnergyCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3456"></a>
<a name="ln-3457"></a><span class="k">         </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-3458"></a>                               <span class="o">+</span> <span class="n">tmpPcharge</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">*</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficCharge</span>
<a name="ln-3459"></a>     <span class="k">ELSE</span> <span class="c">! would over charge this time step</span>
<a name="ln-3460"></a>
<a name="ln-3461"></a>        <span class="n">tmpPcharge</span> <span class="o">=</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxEnergyCapacity</span> <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3462"></a>                     <span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">*</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficCharge</span><span class="p">)</span>
<a name="ln-3463"></a>   <span class="c">!     Constrained = .true.</span>
<a name="ln-3464"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-3465"></a>                               <span class="o">+</span> <span class="n">tmpPcharge</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">*</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficCharge</span>
<a name="ln-3466"></a>     <span class="n">ENDIF</span>
<a name="ln-3467"></a>    <span class="n">Pstorage</span> <span class="o">=</span> <span class="n">tmpPcharge</span>
<a name="ln-3468"></a>
<a name="ln-3469"></a>   <span class="n">ENDIF</span>
<a name="ln-3470"></a>
<a name="ln-3471"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">KiBaMBattery</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3472"></a>    <span class="c">!*************************************************</span>
<a name="ln-3473"></a>    <span class="c">!The sign of power and current is negative in charging</span>
<a name="ln-3474"></a>    <span class="c">!*************************************************</span>
<a name="ln-3475"></a>      <span class="n">Pw</span> <span class="o">=</span> <span class="o">-</span><span class="n">tmpPcharge</span><span class="o">/</span><span class="n">Numbattery</span>
<a name="ln-3476"></a>      <span class="n">q0</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span> <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span>
<a name="ln-3477"></a>
<a name="ln-3478"></a>      <span class="n">I0</span>    <span class="o">=</span> <span class="mf">1.0d0</span>         <span class="c">! Initial assumption</span>
<a name="ln-3479"></a>      <span class="n">T0</span>    <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">qmax</span><span class="o">/</span><span class="n">I0</span><span class="p">)</span> <span class="c">! Initial Assumption</span>
<a name="ln-3480"></a>      <span class="n">qmaxf</span> <span class="o">=</span> <span class="n">qmax</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">T0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="p">)</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="p">)))</span> <span class="c">!Initial calculation of a function qmax(I)</span>
<a name="ln-3481"></a>      <span class="n">Xf</span>    <span class="o">=</span> <span class="n">q0</span><span class="o">/</span><span class="n">qmaxf</span>
<a name="ln-3482"></a>      <span class="n">Ef</span>    <span class="o">=</span> <span class="n">E0d</span> <span class="o">+</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span><span class="p">,</span><span class="n">Xf</span><span class="p">)</span> <span class="c">!E0d+Ac*Xf+Cc*Xf/(Dc-Xf) (use curve)</span>
<a name="ln-3483"></a>      <span class="n">Volt</span>  <span class="o">=</span> <span class="n">Ef</span><span class="o">-</span><span class="n">I0</span><span class="o">*</span><span class="n">InternalR</span>
<a name="ln-3484"></a>      <span class="n">Inew</span>  <span class="o">=</span> <span class="n">Pw</span><span class="o">/</span><span class="n">Volt</span>
<a name="ln-3485"></a>      <span class="n">Tnew</span>  <span class="o">=</span> <span class="n">qmaxf</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">Inew</span><span class="p">)</span>
<a name="ln-3486"></a>      <span class="n">error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3487"></a>
<a name="ln-3488"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0001d0</span><span class="p">)</span>    <span class="c">!Iteration process to get converged current(I)</span>
<a name="ln-3489"></a>        <span class="n">I0</span>    <span class="o">=</span> <span class="n">Inew</span>
<a name="ln-3490"></a>        <span class="n">T0</span>    <span class="o">=</span> <span class="n">Tnew</span>
<a name="ln-3491"></a>        <span class="n">qmaxf</span> <span class="o">=</span> <span class="n">qmax</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">T0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="p">)</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="p">)))</span>
<a name="ln-3492"></a>        <span class="n">Xf</span>    <span class="o">=</span> <span class="n">q0</span><span class="o">/</span><span class="n">qmaxf</span>
<a name="ln-3493"></a>        <span class="n">Ef</span>    <span class="o">=</span> <span class="n">E0d</span><span class="o">+</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ChargeCurveNum</span><span class="p">,</span><span class="n">Xf</span><span class="p">)</span> <span class="c">!E0d+Ac*Xf+Cc*Xf/(Dc-Xf) (use curve)</span>
<a name="ln-3494"></a>        <span class="n">Volt</span>  <span class="o">=</span> <span class="n">Ef</span><span class="o">-</span><span class="n">I0</span><span class="o">*</span><span class="n">InternalR</span>
<a name="ln-3495"></a>        <span class="n">Inew</span>  <span class="o">=</span> <span class="n">Pw</span><span class="o">/</span><span class="n">Volt</span>
<a name="ln-3496"></a>        <span class="n">Tnew</span>  <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">qmaxf</span><span class="o">/</span><span class="n">Inew</span><span class="p">)</span> <span class="c">! ***Always positive here</span>
<a name="ln-3497"></a>        <span class="n">error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Inew</span><span class="o">-</span><span class="n">I0</span><span class="p">)</span>
<a name="ln-3498"></a>      <span class="n">ENDDO</span>
<a name="ln-3499"></a>
<a name="ln-3500"></a>      <span class="n">dividend</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">qmax</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-3501"></a>                      <span class="n">q0</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">))</span>
<a name="ln-3502"></a>      <span class="n">divisor</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">))</span>
<a name="ln-3503"></a>      <span class="n">Imax</span>  <span class="o">=</span> <span class="n">dividend</span><span class="o">/</span><span class="n">divisor</span>
<a name="ln-3504"></a>      <span class="c">! Below: This is the limit of charging current from Charge Rate Limit (input)</span>
<a name="ln-3505"></a>      <span class="n">Imax</span>  <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="n">Imax</span><span class="p">,</span><span class="o">-</span><span class="p">(</span><span class="n">qmax</span><span class="o">-</span><span class="n">q0</span><span class="p">)</span><span class="o">*</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxChargeRate</span><span class="p">)</span>
<a name="ln-3506"></a>
<a name="ln-3507"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">I0</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">Imax</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3508"></a><span class="k">         </span><span class="n">I0</span> <span class="o">=</span> <span class="n">Pw</span><span class="o">/</span><span class="n">Volt</span>
<a name="ln-3509"></a>         <span class="n">Pactual</span> <span class="o">=</span> <span class="n">I0</span><span class="o">*</span><span class="n">Volt</span>
<a name="ln-3510"></a>      <span class="k">ELSE</span>
<a name="ln-3511"></a><span class="k">         </span><span class="n">I0</span>    <span class="o">=</span> <span class="n">Imax</span>
<a name="ln-3512"></a>         <span class="n">qmaxf</span> <span class="o">=</span> <span class="mi">8</span><span class="mf">0.0d0</span> <span class="c">!Initial assumption to solve the equation using iterative method</span>
<a name="ln-3513"></a>         <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span> <span class="c">!Initial assumption ...</span>
<a name="ln-3514"></a>         <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-3515"></a>            <span class="c">! *** I0(current) should be positive for this calculation</span>
<a name="ln-3516"></a>            <span class="n">RHS</span><span class="o">=</span><span class="p">(</span><span class="n">qmax</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">qmaxf</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">I0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">qmaxf</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">I0</span><span class="p">))</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">qmaxf</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">I0</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">qmaxf</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">I0</span><span class="p">))))</span>
<a name="ln-3517"></a>            <span class="n">error</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">qmaxf</span><span class="o">-</span><span class="n">RHS</span><span class="p">)</span>
<a name="ln-3518"></a>            <span class="n">qmaxf</span><span class="o">=</span><span class="n">RHS</span>
<a name="ln-3519"></a>         <span class="n">ENDDO</span>
<a name="ln-3520"></a>      <span class="n">ENDIF</span>
<a name="ln-3521"></a>
<a name="ln-3522"></a>    <span class="n">ENDIF</span>  <span class="c">! end KiBaM charging</span>
<a name="ln-3523"></a>
<a name="ln-3524"></a>  <span class="n">ENDIF</span>  <span class="c">!charging</span>
<a name="ln-3525"></a>
<a name="ln-3526"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">drawing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3527"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">SimpleBucketStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3528"></a>
<a name="ln-3529"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3530"></a>          <span class="c">! storage empty  no more allowed!</span>
<a name="ln-3531"></a>          <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3532"></a>          <span class="n">drawing</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3533"></a>      <span class="n">ENDIF</span>
<a name="ln-3534"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">tmpPdraw</span> <span class="o">&gt;</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxPowerDraw</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3535"></a><span class="k">          </span><span class="n">tmpPdraw</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxPowerDraw</span>
<a name="ln-3536"></a>      <span class="n">ENDIF</span>
<a name="ln-3537"></a>
<a name="ln-3538"></a>      <span class="c">!now take energy from storage by drawing  (amplified by energetic effic)</span>
<a name="ln-3539"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span>  <span class="p">&amp;</span>
<a name="ln-3540"></a>          <span class="o">-</span> <span class="n">tmpPdraw</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">/</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficDischarge</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-3541"></a>
<a name="ln-3542"></a><span class="k">        </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-3543"></a>                                <span class="o">-</span> <span class="n">tmpPdraw</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">/</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficDischarge</span>
<a name="ln-3544"></a>      <span class="k">ELSE</span> <span class="c">!would over drain storage this timestep so reduce tmpPdraw</span>
<a name="ln-3545"></a>        <span class="n">tmpPdraw</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="o">*</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficDischarge</span> <span class="p">&amp;</span>
<a name="ln-3546"></a>                   <span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-3547"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span> <span class="p">&amp;</span>
<a name="ln-3548"></a>                                <span class="o">-</span> <span class="n">tmpPdraw</span> <span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">/</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficDischarge</span>
<a name="ln-3549"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span><span class="p">,</span> <span class="mf">0.0D0</span><span class="p">)</span>
<a name="ln-3550"></a>      <span class="n">ENDIF</span>
<a name="ln-3551"></a>
<a name="ln-3552"></a>      <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span>  <span class="o">=</span> <span class="n">tmpPdraw</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficDischarge</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3553"></a>      <span class="n">Pstorage</span> <span class="o">=</span> <span class="o">-</span> <span class="n">tmpPdraw</span>
<a name="ln-3554"></a>    <span class="n">ENDIF</span> <span class="c">! simple discharging</span>
<a name="ln-3555"></a>
<a name="ln-3556"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">KiBaMBattery</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3557"></a>
<a name="ln-3558"></a>    <span class="c">!**********************************************</span>
<a name="ln-3559"></a>    <span class="c">!The sign of power and current is positive in discharging</span>
<a name="ln-3560"></a>    <span class="c">!**********************************************</span>
<a name="ln-3561"></a>
<a name="ln-3562"></a>      <span class="n">Pw</span>    <span class="o">=</span> <span class="n">tmpPdraw</span><span class="o">/</span><span class="n">Numbattery</span>
<a name="ln-3563"></a>      <span class="n">q0</span>    <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span><span class="o">+</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span>
<a name="ln-3564"></a>      <span class="n">I0</span>    <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span>    <span class="c">! Initial assumption</span>
<a name="ln-3565"></a>      <span class="n">T0</span>    <span class="o">=</span> <span class="n">qmax</span><span class="o">/</span><span class="n">I0</span>   <span class="c">! Initial Assumption</span>
<a name="ln-3566"></a>      <span class="n">qmaxf</span> <span class="o">=</span> <span class="n">qmax</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">T0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="p">)</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="p">)))</span> <span class="c">!Initial calculation of a function qmax(I)</span>
<a name="ln-3567"></a>      <span class="n">Xf</span>    <span class="o">=</span> <span class="p">(</span><span class="n">qmax</span><span class="o">-</span><span class="n">q0</span><span class="p">)</span><span class="o">/</span><span class="n">qmaxf</span>
<a name="ln-3568"></a>      <span class="n">Ef</span>    <span class="o">=</span> <span class="n">E0c</span> <span class="o">+</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span><span class="p">,</span><span class="n">Xf</span><span class="p">)</span> <span class="c">!E0d+Ac*Xf+Cc*X/(Dc-Xf)</span>
<a name="ln-3569"></a>      <span class="n">Volt</span>  <span class="o">=</span> <span class="n">Ef</span><span class="o">-</span><span class="n">I0</span><span class="o">*</span><span class="n">InternalR</span>
<a name="ln-3570"></a>      <span class="n">Inew</span>  <span class="o">=</span> <span class="n">Pw</span><span class="o">/</span><span class="n">Volt</span>
<a name="ln-3571"></a>      <span class="n">Tnew</span>  <span class="o">=</span> <span class="n">qmaxf</span><span class="o">/</span><span class="n">Inew</span>
<a name="ln-3572"></a>      <span class="n">error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3573"></a>
<a name="ln-3574"></a>      <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0001d0</span><span class="p">)</span> <span class="c">!Iteration process to get converged current(I)</span>
<a name="ln-3575"></a>        <span class="n">I0</span>   <span class="o">=</span> <span class="n">Inew</span>
<a name="ln-3576"></a>        <span class="n">T0</span>   <span class="o">=</span> <span class="n">Tnew</span>
<a name="ln-3577"></a>        <span class="n">qmaxf</span><span class="o">=</span> <span class="n">qmax</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">T0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="p">)</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">T0</span><span class="p">)))</span>
<a name="ln-3578"></a>        <span class="n">Xf</span>   <span class="o">=</span> <span class="p">(</span><span class="n">qmax</span><span class="o">-</span><span class="n">q0</span><span class="p">)</span><span class="o">/</span><span class="n">qmaxf</span>
<a name="ln-3579"></a>        <span class="n">Ef</span>   <span class="o">=</span> <span class="n">E0c</span> <span class="o">+</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span><span class="p">,</span><span class="n">Xf</span><span class="p">)</span> <span class="c">!E0c+Ad*Xf+Cd*X/(Dd-Xf)</span>
<a name="ln-3580"></a>        <span class="n">Volt</span> <span class="o">=</span> <span class="n">Ef</span> <span class="o">-</span> <span class="n">I0</span><span class="o">*</span><span class="n">InternalR</span>
<a name="ln-3581"></a>        <span class="n">Inew</span> <span class="o">=</span> <span class="n">Pw</span><span class="o">/</span><span class="n">Volt</span>
<a name="ln-3582"></a>        <span class="n">Tnew</span> <span class="o">=</span> <span class="n">qmaxf</span><span class="o">/</span><span class="n">Inew</span>
<a name="ln-3583"></a>        <span class="n">error</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Inew</span><span class="o">-</span><span class="n">I0</span><span class="p">)</span>
<a name="ln-3584"></a>      <span class="n">ENDDO</span>
<a name="ln-3585"></a>
<a name="ln-3586"></a>      <span class="n">dividend</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-3587"></a>                <span class="n">q0</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">))</span>
<a name="ln-3588"></a>      <span class="n">divisor</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">))</span>
<a name="ln-3589"></a>      <span class="n">Imax</span>     <span class="o">=</span> <span class="n">dividend</span><span class="o">/</span><span class="n">divisor</span>
<a name="ln-3590"></a>      <span class="n">Imax</span>     <span class="o">=</span> <span class="nb">Min</span><span class="p">(</span><span class="n">Imax</span><span class="p">,</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">MaxDischargeI</span><span class="p">)</span>
<a name="ln-3591"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">I0</span><span class="p">).</span><span class="n">le</span><span class="p">.</span><span class="n">Imax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3592"></a><span class="k">         </span><span class="n">I0</span> <span class="o">=</span> <span class="n">Pw</span><span class="o">/</span><span class="n">Volt</span>
<a name="ln-3593"></a>         <span class="n">Pactual</span> <span class="o">=</span> <span class="n">I0</span><span class="o">*</span><span class="n">Volt</span>
<a name="ln-3594"></a>      <span class="k">ELSE</span>
<a name="ln-3595"></a><span class="k">         </span><span class="n">I0</span>    <span class="o">=</span> <span class="n">Imax</span>
<a name="ln-3596"></a>         <span class="n">qmaxf</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span>     <span class="c">!Initial assumption to solve the equation using iterative method</span>
<a name="ln-3597"></a>         <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span>     <span class="c">!Initial assumption ...</span>
<a name="ln-3598"></a>         <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.001d0</span><span class="p">)</span>
<a name="ln-3599"></a>            <span class="n">RHS</span> <span class="o">=</span> <span class="p">(</span><span class="n">qmax</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">qmaxf</span><span class="o">/</span><span class="n">I0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">qmaxf</span><span class="o">/</span><span class="n">I0</span><span class="p">)</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">qmaxf</span><span class="o">/</span><span class="n">I0</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">qmaxf</span><span class="o">/</span><span class="n">I0</span><span class="p">)))</span>
<a name="ln-3600"></a>            <span class="n">error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">qmaxf</span><span class="o">-</span><span class="n">RHS</span><span class="p">)</span>
<a name="ln-3601"></a>            <span class="n">qmaxf</span> <span class="o">=</span> <span class="n">RHS</span>
<a name="ln-3602"></a>         <span class="n">ENDDO</span>
<a name="ln-3603"></a>         <span class="n">Xf</span>   <span class="o">=</span> <span class="p">(</span><span class="n">qmax</span><span class="o">-</span><span class="n">q0</span><span class="p">)</span><span class="o">/</span><span class="n">qmaxf</span>
<a name="ln-3604"></a>         <span class="n">Ef</span>   <span class="o">=</span> <span class="n">E0c</span><span class="o">+</span><span class="n">CurveValue</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DischargeCurveNum</span><span class="p">,</span><span class="n">Xf</span><span class="p">)</span>
<a name="ln-3605"></a>         <span class="n">Volt</span> <span class="o">=</span> <span class="n">Ef</span><span class="o">-</span><span class="n">I0</span><span class="o">*</span><span class="n">InternalR</span>
<a name="ln-3606"></a>      <span class="n">ENDIF</span>
<a name="ln-3607"></a>
<a name="ln-3608"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Volt</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">CutoffV</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3609"></a><span class="k">         </span><span class="n">I0</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3610"></a>      <span class="n">ENDIF</span>
<a name="ln-3611"></a>    <span class="n">ENDIF</span>  <span class="c">! end KiBaM discharging</span>
<a name="ln-3612"></a>
<a name="ln-3613"></a>  <span class="n">ENDIF</span> <span class="c">!drawing</span>
<a name="ln-3614"></a>
<a name="ln-3615"></a>  <span class="c">! correct if not available.</span>
<a name="ln-3616"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3617"></a><span class="k">    IF</span> <span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSOverridePelFromStorage</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3618"></a>        <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EMSOverridePelIntoStorage</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3619"></a><span class="k">      </span><span class="n">charging</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3620"></a>      <span class="n">drawing</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3621"></a>    <span class="n">ENDIF</span>
<a name="ln-3622"></a>  <span class="n">ENDIF</span>
<a name="ln-3623"></a>
<a name="ln-3624"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">SimpleBucketStorage</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3625"></a><span class="k">  IF</span> <span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">charging</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">drawing</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3626"></a>
<a name="ln-3627"></a><span class="k">     </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepStateOfCharge</span>
<a name="ln-3628"></a>     <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelIntoStorage</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3629"></a>     <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelFromStorage</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3630"></a>     <span class="n">Pstorage</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3631"></a>  <span class="n">ENDIF</span>
<a name="ln-3632"></a>
<a name="ln-3633"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Pstorage</span> <span class="o">&gt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3634"></a>
<a name="ln-3635"></a><span class="k">    </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelIntoStorage</span> <span class="o">=</span> <span class="n">Pstorage</span>
<a name="ln-3636"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelFromStorage</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3637"></a>  <span class="n">ENDIF</span>
<a name="ln-3638"></a>
<a name="ln-3639"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Pstorage</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3640"></a>
<a name="ln-3641"></a><span class="k">    </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelIntoStorage</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3642"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelFromStorage</span> <span class="o">=</span> <span class="o">-</span> <span class="n">Pstorage</span>
<a name="ln-3643"></a>
<a name="ln-3644"></a>  <span class="n">ENDIF</span>
<a name="ln-3645"></a>
<a name="ln-3646"></a>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ElectEnergyinStorage</span>  <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepStateOfCharge</span>
<a name="ln-3647"></a>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredPower</span>           <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelIntoStorage</span>
<a name="ln-3648"></a>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span>          <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelIntoStorage</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-3649"></a>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DecrementedEnergyStored</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0D0</span> <span class="o">*</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span>
<a name="ln-3650"></a>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnPower</span>            <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelFromStorage</span>
<a name="ln-3651"></a>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnEnergy</span>           <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">PelFromStorage</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-3652"></a>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span>         <span class="o">=</span>  <span class="nb">MAX</span><span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredPower</span> <span class="p">&amp;</span>
<a name="ln-3653"></a>                                                       <span class="o">*</span>  <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficCharge</span> <span class="p">)</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3654"></a>                                                        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnPower</span> <span class="p">&amp;</span>
<a name="ln-3655"></a>                                                       <span class="o">*</span>  <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">EnergeticEfficDischarge</span>  <span class="p">)</span> <span class="p">)</span>
<a name="ln-3656"></a>  <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossEnergy</span>       <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-3657"></a>
<a name="ln-3658"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! set values for zone heat gains</span>
<a name="ln-3659"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">QdotconvZone</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span><span class="p">)</span><span class="o">*</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span>
<a name="ln-3660"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">QdotRadZone</span>  <span class="o">=</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span><span class="p">)</span> <span class="o">*</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span>
<a name="ln-3661"></a>  <span class="n">ENDIF</span>
<a name="ln-3662"></a>
<a name="ln-3663"></a>  <span class="n">StorageStoredPower</span><span class="o">=</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredPower</span>
<a name="ln-3664"></a>  <span class="n">StorageDrawnPower</span><span class="o">=</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnPower</span>
<a name="ln-3665"></a> <span class="n">ENDIF</span> <span class="c">! Outputs for simple battery model</span>
<a name="ln-3666"></a>
<a name="ln-3667"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageModelMode</span> <span class="o">==</span> <span class="n">KiBaMBattery</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3668"></a>
<a name="ln-3669"></a><span class="k">    IF</span> <span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">charging</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">drawing</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3670"></a><span class="k">        </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepAvailable</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span>
<a name="ln-3671"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepBound</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span>
<a name="ln-3672"></a>        <span class="n">I0</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3673"></a>        <span class="n">Volt</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3674"></a>        <span class="n">q0</span>   <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span><span class="o">+</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span>
<a name="ln-3675"></a>    <span class="k">ELSE</span>
<a name="ln-3676"></a><span class="k">        </span><span class="n">newAvailable</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepAvailable</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">)</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-3677"></a>           <span class="p">(</span><span class="n">q0</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">c</span><span class="o">-</span><span class="n">I0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">))</span><span class="o">/</span><span class="n">k</span> <span class="o">-</span> <span class="n">I0</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">))</span><span class="o">/</span><span class="n">k</span>
<a name="ln-3678"></a>        <span class="n">newBound</span>     <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">LastTimeStepBound</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">)</span><span class="o">+</span><span class="n">q0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-3679"></a>           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">))</span><span class="o">-</span><span class="n">I0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">-</span><span class="mf">1.0d0</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="p">))</span><span class="o">/</span><span class="n">k</span>
<a name="ln-3680"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepAvailable</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="mf">0.0d0</span> <span class="p">,</span> <span class="n">newAvailable</span><span class="p">)</span>
<a name="ln-3681"></a>        <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepBound</span> <span class="o">=</span> <span class="nb">Max</span><span class="p">(</span><span class="mf">0.0d0</span> <span class="p">,</span> <span class="n">newBound</span><span class="p">)</span>
<a name="ln-3682"></a>    <span class="n">ENDIF</span>
<a name="ln-3683"></a>
<a name="ln-3684"></a>    <span class="n">Pactual</span>  <span class="o">=</span> <span class="n">I0</span><span class="o">*</span><span class="n">Volt</span>
<a name="ln-3685"></a>    <span class="n">TotalSOC</span> <span class="o">=</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepAvailable</span> <span class="o">+</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThisTimeStepBound</span>
<a name="ln-3686"></a>
<a name="ln-3687"></a>  <span class="c">!output1</span>
<a name="ln-3688"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TotalSOC</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">q0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3689"></a><span class="k">       </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageMode</span>  <span class="o">=</span> <span class="mi">2</span>
<a name="ln-3690"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredPower</span>  <span class="o">=</span> <span class="n">Volt</span><span class="o">*</span><span class="n">I0</span><span class="o">*</span><span class="n">Numbattery</span>
<a name="ln-3691"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span> <span class="o">=</span> <span class="n">Volt</span><span class="o">*</span><span class="n">I0</span><span class="o">*</span><span class="n">Numbattery</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3692"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DecrementedEnergyStored</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0D0</span> <span class="o">*</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span>
<a name="ln-3693"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnPower</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3694"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3695"></a>
<a name="ln-3696"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TotalSOC</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">q0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3697"></a><span class="k">       </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageMode</span>  <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3698"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredPower</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3699"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3700"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DecrementedEnergyStored</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3701"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">Drawnpower</span>   <span class="o">=</span> <span class="n">Volt</span><span class="o">*</span><span class="n">I0</span><span class="o">*</span><span class="n">Numbattery</span>
<a name="ln-3702"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">Drawnenergy</span>  <span class="o">=</span> <span class="n">Volt</span><span class="o">*</span><span class="n">I0</span><span class="o">*</span><span class="n">Numbattery</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3703"></a>
<a name="ln-3704"></a>    <span class="k">ELSE</span>
<a name="ln-3705"></a><span class="k">       </span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StorageMode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3706"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredPower</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3707"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3708"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DecrementedEnergyStored</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3709"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnPower</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3710"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnEnergy</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3711"></a>    <span class="n">ENDIF</span>
<a name="ln-3712"></a>
<a name="ln-3713"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">AbsoluteSOC</span>          <span class="o">=</span> <span class="n">TotalSOC</span><span class="o">*</span><span class="n">Numbattery</span>
<a name="ln-3714"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">FractionSOC</span>          <span class="o">=</span> <span class="n">TotalSOC</span><span class="o">/</span><span class="n">qmax</span>
<a name="ln-3715"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">BatteryCurrent</span>       <span class="o">=</span> <span class="n">I0</span><span class="o">*</span><span class="n">Numpar</span>
<a name="ln-3716"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">BatteryVoltage</span>       <span class="o">=</span> <span class="n">Volt</span><span class="o">*</span><span class="n">Numser</span>
<a name="ln-3717"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span>        <span class="o">=</span> <span class="n">InternalR</span><span class="o">*</span><span class="n">I0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Numbattery</span>
<a name="ln-3718"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossEnergy</span>      <span class="o">=</span> <span class="n">InternalR</span><span class="o">*</span><span class="n">I0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="o">*</span><span class="n">Numbattery</span>
<a name="ln-3719"></a>
<a name="ln-3720"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! set values for zone heat gains</span>
<a name="ln-3721"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">QdotconvZone</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">-</span> <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-3722"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span><span class="p">)</span> <span class="o">*</span> <span class="n">Numbattery</span>
<a name="ln-3723"></a>    <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">QdotRadZone</span>  <span class="o">=</span> <span class="p">((</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ZoneRadFract</span><span class="p">)</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-3724"></a>       <span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">ThermLossRate</span><span class="p">)</span><span class="o">*</span><span class="n">Numbattery</span>
<a name="ln-3725"></a>  <span class="n">ENDIF</span>
<a name="ln-3726"></a>
<a name="ln-3727"></a>  <span class="n">StorageStoredPower</span><span class="o">=</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">StoredPower</span>
<a name="ln-3728"></a>  <span class="n">StorageDrawnPower</span><span class="o">=</span><span class="n">ElecStorage</span><span class="p">(</span><span class="n">ElecStorNum</span><span class="p">)%</span><span class="n">DrawnPower</span>
<a name="ln-3729"></a>
<a name="ln-3730"></a> <span class="n">ENDIF</span> <span class="c">! Outputs for kibam model</span>
<a name="ln-3731"></a>
<a name="ln-3732"></a> <span class="k">RETURN</span>
<a name="ln-3733"></a>
<a name="ln-3734"></a><span class="k">END SUBROUTINE </span><span class="n">ManageElectCenterStorageInteractions</span>
<a name="ln-3735"></a>
<a name="ln-3736"></a><span class="c">!*****************************************************************************************************************</span>
<a name="ln-3737"></a>
<a name="ln-3738"></a><span class="k">SUBROUTINE </span><span class="n">FigureElectricalStorageZoneGains</span>
<a name="ln-3739"></a>
<a name="ln-3740"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3741"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-3742"></a>          <span class="c">!       DATE WRITTEN   June 2008</span>
<a name="ln-3743"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3744"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3745"></a>
<a name="ln-3746"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3747"></a>          <span class="c">! Couple electrical storage skin losses to zone heat gains</span>
<a name="ln-3748"></a>
<a name="ln-3749"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3750"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3751"></a>
<a name="ln-3752"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3753"></a>          <span class="c">! na</span>
<a name="ln-3754"></a>
<a name="ln-3755"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3756"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span>
<a name="ln-3757"></a>
<a name="ln-3758"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3759"></a>
<a name="ln-3760"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3761"></a>          <span class="c">! na</span>
<a name="ln-3762"></a>
<a name="ln-3763"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3764"></a>          <span class="c">! na</span>
<a name="ln-3765"></a>
<a name="ln-3766"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3767"></a>          <span class="c">! na</span>
<a name="ln-3768"></a>
<a name="ln-3769"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3770"></a>          <span class="c">! na</span>
<a name="ln-3771"></a>
<a name="ln-3772"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3773"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3774"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">StorNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3775"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3776"></a>
<a name="ln-3777"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumElecStorageDevices</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3778"></a>
<a name="ln-3779"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3780"></a><span class="k">    </span><span class="n">ElecStorage</span><span class="p">%</span><span class="n">QdotconvZone</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3781"></a>    <span class="n">ElecStorage</span><span class="p">%</span><span class="n">QdotRadZone</span>  <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3782"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3783"></a>  <span class="n">ENDIF</span>
<a name="ln-3784"></a>  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3785"></a>
<a name="ln-3786"></a><span class="c">!  IF(DoingSizing)THEN</span>
<a name="ln-3787"></a>
<a name="ln-3788"></a><span class="c">!  ENDIF</span>
<a name="ln-3789"></a>
<a name="ln-3790"></a>  <span class="k">RETURN</span>
<a name="ln-3791"></a>
<a name="ln-3792"></a><span class="k">END SUBROUTINE </span><span class="n">FigureElectricalStorageZoneGains</span>
<a name="ln-3793"></a>
<a name="ln-3794"></a>
<a name="ln-3795"></a><span class="k">SUBROUTINE </span><span class="n">ManageTransformers</span><span class="p">()</span>
<a name="ln-3796"></a>
<a name="ln-3797"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3798"></a>          <span class="c">!       AUTHOR         Weimin Wang</span>
<a name="ln-3799"></a>          <span class="c">!       DATE WRITTEN   June 2010</span>
<a name="ln-3800"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3801"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3802"></a>
<a name="ln-3803"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3804"></a>          <span class="c">! manage transformer models</span>
<a name="ln-3805"></a>
<a name="ln-3806"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3807"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3808"></a>
<a name="ln-3809"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3810"></a>          <span class="c">! na</span>
<a name="ln-3811"></a>
<a name="ln-3812"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3813"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-3814"></a>  <span class="k">USE </span><span class="n">DataGlobals</span>    <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">MetersHaveBeenInitialized</span>
<a name="ln-3815"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-3816"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZnAirRpt</span>
<a name="ln-3817"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SameString</span>
<a name="ln-3818"></a>
<a name="ln-3819"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3820"></a>
<a name="ln-3821"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3822"></a>          <span class="c">! na</span>
<a name="ln-3823"></a>
<a name="ln-3824"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3825"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span>   <span class="kd">::</span> <span class="n">AmbTempRef</span><span class="o">=</span><span class="mi">2</span><span class="mf">0.0d0</span>       <span class="c">!reference ambient temperature (C)</span>
<a name="ln-3826"></a>
<a name="ln-3827"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3828"></a>          <span class="c">! na</span>
<a name="ln-3829"></a>
<a name="ln-3830"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3831"></a>          <span class="c">! na</span>
<a name="ln-3832"></a>
<a name="ln-3833"></a>
<a name="ln-3834"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3835"></a>
<a name="ln-3836"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">TransfNum</span>        <span class="c">!transformer number counter</span>
<a name="ln-3837"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">MeterNum</span>         <span class="c">!counter for the meters wired to a transformer</span>
<a name="ln-3838"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">MeterPtr</span>         <span class="c">!pointer to the meters wired to a transformer</span>
<a name="ln-3839"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">LCNum</span>            <span class="c">!counter for the load centers served by a transformer</span>
<a name="ln-3840"></a>  <span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">ZoneNum</span>          <span class="c">!pointer to the zone where transformer is located</span>
<a name="ln-3841"></a>
<a name="ln-3842"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">external</span>  <span class="kd">::</span> <span class="n">GetInstantMeterValue</span>
<a name="ln-3843"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">external</span>  <span class="kd">::</span> <span class="n">GetCurrentMeterValue</span>
<a name="ln-3844"></a>
<a name="ln-3845"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FactorTempCorr</span>   <span class="c">!temperature correction factor</span>
<a name="ln-3846"></a>
<a name="ln-3847"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ResRef</span>           <span class="c">!winding resistance at reference temperature (full load)</span>
<a name="ln-3848"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ResSpecified</span>     <span class="c">!winding resistance at specified temperature (specified load)</span>
<a name="ln-3849"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ResRatio</span>         <span class="c">!ratio of winding resistance = ResSpecified/ResRef</span>
<a name="ln-3850"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TempChange</span>       <span class="c">!winding temperature rise (C)</span>
<a name="ln-3851"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AmbTemp</span>          <span class="c">!ambient temperature (C)</span>
<a name="ln-3852"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Capacity</span>         <span class="c">!transformer nameplate capacity(VA)</span>
<a name="ln-3853"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">PUL</span>              <span class="c">!per unit load</span>
<a name="ln-3854"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SurplusPower</span>     <span class="c">!surplus power for an electric load center</span>
<a name="ln-3855"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ElecLoad</span>         <span class="c">!transformer load which may be power in or out depending on the usage mode</span>
<a name="ln-3856"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">PastElecLoad</span>     <span class="c">!transformer load at the previous timestep</span>
<a name="ln-3857"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TotalLossRate</span>    <span class="c">!the sum of no load loss rate and load loss rate</span>
<a name="ln-3858"></a>
<a name="ln-3859"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Numerator</span>        <span class="c">!intermediate variable for numerator</span>
<a name="ln-3860"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Denominator</span>      <span class="c">!intermediate variable for denominator</span>
<a name="ln-3861"></a>
<a name="ln-3862"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3863"></a>
<a name="ln-3864"></a>
<a name="ln-3865"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">NumTransformers</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3866"></a>
<a name="ln-3867"></a><span class="k">  IF</span><span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3868"></a>  <span class="c">! calculate rated no load losses and rated load losses if the performance input method is based on</span>
<a name="ln-3869"></a>  <span class="c">! nominal efficiency. This calculation is done only once</span>
<a name="ln-3870"></a>    <span class="k">DO </span><span class="n">TransfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTransformers</span>
<a name="ln-3871"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PerformanceInputMode</span> <span class="o">==</span> <span class="n">EfficiencyMethod</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3872"></a><span class="k">        </span><span class="n">ResRef</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">FactorTempCoeff</span> <span class="o">+</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">TempRise</span> <span class="o">+</span> <span class="n">AmbTempRef</span>
<a name="ln-3873"></a>        <span class="n">ResSpecified</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">FactorTempCoeff</span> <span class="o">+</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedTemp</span>
<a name="ln-3874"></a>        <span class="n">ResRatio</span> <span class="o">=</span> <span class="n">ResSpecified</span><span class="o">/</span><span class="n">ResRef</span>
<a name="ln-3875"></a>        <span class="n">FactorTempCorr</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0D0</span><span class="o">-</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">EddyFrac</span><span class="p">)</span> <span class="o">*</span> <span class="n">ResRatio</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-3876"></a>                          <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">EddyFrac</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span><span class="o">/</span><span class="n">ResRatio</span><span class="p">)</span>
<a name="ln-3877"></a>
<a name="ln-3878"></a>        <span class="n">Capacity</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedCapacity</span>
<a name="ln-3879"></a>        <span class="n">Numerator</span> <span class="o">=</span> <span class="n">Capacity</span> <span class="o">*</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedPUL</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span><span class="o">-</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedEfficiency</span><span class="p">)</span>
<a name="ln-3880"></a>        <span class="n">Denominator</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedEfficiency</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3881"></a>                       <span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedPUL</span> <span class="o">/</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">MaxPUL</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3882"></a>
<a name="ln-3883"></a>        <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedNL</span> <span class="o">=</span> <span class="n">Numerator</span> <span class="o">/</span> <span class="n">Denominator</span>
<a name="ln-3884"></a>        <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedLL</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedNL</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-3885"></a>                                        <span class="p">(</span><span class="n">FactorTempCorr</span> <span class="o">*</span> <span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">MaxPUL</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
<a name="ln-3886"></a>
<a name="ln-3887"></a>      <span class="n">ENDIF</span>
<a name="ln-3888"></a>    <span class="k">END DO</span>
<a name="ln-3889"></a>
<a name="ln-3890"></a><span class="k">    </span><span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3891"></a>
<a name="ln-3892"></a>  <span class="n">ENDIF</span>
<a name="ln-3893"></a>
<a name="ln-3894"></a>
<a name="ln-3895"></a>  <span class="k">DO </span><span class="n">TransfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTransformers</span>
<a name="ln-3896"></a>    <span class="n">ElecLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3897"></a>    <span class="n">PastElecLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3898"></a>
<a name="ln-3899"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">UsageMode</span> <span class="o">==</span> <span class="n">PowerInFromGrid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3900"></a>
<a name="ln-3901"></a><span class="k">      DO </span><span class="n">MeterNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterNames</span><span class="p">)</span>
<a name="ln-3902"></a>
<a name="ln-3903"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MetersHaveBeenInitialized</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3904"></a><span class="k">          </span><span class="n">MeterPtr</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">WiredMeterPtrs</span><span class="p">(</span><span class="n">MeterNum</span><span class="p">)</span>
<a name="ln-3905"></a>          <span class="n">ElecLoad</span> <span class="o">=</span> <span class="n">ElecLoad</span> <span class="o">+</span> <span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">MeterPtr</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3906"></a>                          <span class="o">+</span> <span class="n">GetInstantMeterValue</span><span class="p">(</span><span class="n">MeterPtr</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-3907"></a>          <span class="c">! PastElecLoad store the metered value in the previous time step. This value will be used to check whether</span>
<a name="ln-3908"></a>          <span class="c">! a transformer is overloaded or not.</span>
<a name="ln-3909"></a>          <span class="n">PastElecLoad</span> <span class="o">=</span> <span class="n">PastElecLoad</span> <span class="o">+</span> <span class="n">GetCurrentMeterValue</span><span class="p">(</span><span class="n">MeterPtr</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-3910"></a>        <span class="k">ELSE</span>
<a name="ln-3911"></a><span class="k">          </span><span class="n">ElecLoad</span> <span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-3912"></a>          <span class="n">PastElecLoad</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3913"></a>        <span class="n">ENDIF</span>
<a name="ln-3914"></a>
<a name="ln-3915"></a>        <span class="c">! Because transformer loss has been accounted for by Electricity:Facility and Electricity:HVAC, the transformer</span>
<a name="ln-3916"></a>        <span class="c">! loss needs to be deducted from the metered value. Otherwise, double counting (circular relationship) occurs.</span>
<a name="ln-3917"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">SpecialMeter</span><span class="p">(</span><span class="n">MeterNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3918"></a><span class="k">          </span><span class="n">ElecLoad</span> <span class="o">=</span> <span class="n">ElecLoad</span> <span class="o">-</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadLossRate</span> <span class="o">-</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">NoLoadLossRate</span>
<a name="ln-3919"></a>
<a name="ln-3920"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ElecLoad</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">ElecLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>      <span class="c">!Essential check.</span>
<a name="ln-3921"></a>        <span class="k">END IF</span>
<a name="ln-3922"></a>
<a name="ln-3923"></a><span class="k">      END DO</span>
<a name="ln-3924"></a>
<a name="ln-3925"></a><span class="k">      </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerOut</span> <span class="o">=</span> <span class="n">ElecLoad</span>   <span class="c">!the metered value is transformer&#39;s output in PowerInFromGrid mode</span>
<a name="ln-3926"></a>    <span class="k">ELSE</span>   <span class="c">!Usage mode is PowerOutFromBldg</span>
<a name="ln-3927"></a>      <span class="k">DO </span><span class="n">LCNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadCenterNum</span>
<a name="ln-3928"></a>        <span class="n">SurplusPower</span> <span class="o">=</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LCNum</span><span class="p">)%</span><span class="n">ElectProdRate</span> <span class="o">-</span> <span class="n">ElecLoadCenter</span><span class="p">(</span><span class="n">LCNum</span><span class="p">)%</span><span class="n">ElectDemand</span>
<a name="ln-3929"></a>
<a name="ln-3930"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurplusPower</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SurplusPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3931"></a>
<a name="ln-3932"></a>        <span class="n">ElecLoad</span> <span class="o">=</span> <span class="n">ElecLoad</span> <span class="o">+</span> <span class="n">SurplusPower</span>
<a name="ln-3933"></a>        <span class="n">PastElecLoad</span> <span class="o">=</span> <span class="n">ElecLoad</span>
<a name="ln-3934"></a>      <span class="k">END DO</span>
<a name="ln-3935"></a>
<a name="ln-3936"></a><span class="k">      </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerIn</span> <span class="o">=</span> <span class="n">ElecLoad</span>    <span class="c">!surplus power is transformer&#39;s input in PowerOutFromBldg mode</span>
<a name="ln-3937"></a>    <span class="k">END IF</span>
<a name="ln-3938"></a>
<a name="ln-3939"></a>
<a name="ln-3940"></a>    <span class="c">! check availability schedule</span>
<a name="ln-3941"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">AvailSchedPtr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3942"></a><span class="k">      </span><span class="n">Capacity</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedCapacity</span>
<a name="ln-3943"></a>      <span class="n">PUL</span> <span class="o">=</span> <span class="n">ElecLoad</span> <span class="o">/</span> <span class="n">Capacity</span>
<a name="ln-3944"></a>
<a name="ln-3945"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">PUL</span> <span class="o">&gt;</span> <span class="mf">1.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3946"></a><span class="k">          </span><span class="n">PUL</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-3947"></a>      <span class="k">END IF</span>
<a name="ln-3948"></a>
<a name="ln-3949"></a>      <span class="c">!Originally, PUL was used to check whether a transformer is overloaded (PUL &gt; 1.0 or not). However, it was</span>
<a name="ln-3950"></a>      <span class="c">!found that ElecLoad obtained from GetInstantMeterVlaue() might refer to intermideiate values before</span>
<a name="ln-3951"></a>      <span class="c">!convergence. The intermediate values may issue false warning. This the reason why PastElecLoad obtained</span>
<a name="ln-3952"></a>      <span class="c">!by GetCurrentMeterValue() is used here to check overload issue.</span>
<a name="ln-3953"></a>      <span class="k">IF</span><span class="p">(</span> <span class="p">(</span><span class="n">PastElecLoad</span><span class="o">/</span><span class="n">Capacity</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3954"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">OverloadErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3955"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Transformer Overloaded&#39;</span> <span class="p">)</span>
<a name="ln-3956"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Entered in ElectricLoadCenter:Transformer =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-3957"></a>        <span class="k">END IF</span>
<a name="ln-3958"></a><span class="k">        CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;Transformer Overloaded: &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3959"></a>                                <span class="s1">&#39;Entered in ElectricLoadCenter:Transformer =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3960"></a>                                 <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">OverloadErrorIndex</span><span class="p">)</span>
<a name="ln-3961"></a>      <span class="k">END IF</span>
<a name="ln-3962"></a>
<a name="ln-3963"></a><span class="k">      </span><span class="n">TempChange</span> <span class="o">=</span> <span class="p">(</span><span class="n">PUL</span> <span class="o">**</span> <span class="mf">1.6d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">TempRise</span>
<a name="ln-3964"></a>
<a name="ln-3965"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">HeatLossesDestination</span> <span class="o">==</span> <span class="n">ZoneGains</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3966"></a><span class="k">        </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneNum</span>
<a name="ln-3967"></a>        <span class="n">AmbTemp</span> <span class="o">=</span> <span class="n">ZnAirRpt</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">MeanAirTemp</span>
<a name="ln-3968"></a>      <span class="k">ELSE</span>
<a name="ln-3969"></a><span class="k">         </span><span class="n">AmbTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.0D0</span>
<a name="ln-3970"></a>      <span class="n">ENDIF</span>
<a name="ln-3971"></a>
<a name="ln-3972"></a>      <span class="n">ResRef</span>         <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">FactorTempCoeff</span> <span class="o">+</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">TempRise</span> <span class="o">+</span> <span class="n">AmbTempRef</span>
<a name="ln-3973"></a>      <span class="n">ResSpecified</span>   <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">FactorTempCoeff</span> <span class="o">+</span> <span class="n">TempChange</span> <span class="o">+</span> <span class="n">AmbTemp</span>
<a name="ln-3974"></a>      <span class="n">ResRatio</span>       <span class="o">=</span> <span class="n">ResSpecified</span><span class="o">/</span><span class="n">ResRef</span>
<a name="ln-3975"></a>      <span class="n">FactorTempCorr</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0D0</span><span class="o">-</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">EddyFrac</span><span class="p">)</span> <span class="o">*</span> <span class="n">ResRatio</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-3976"></a>                          <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">EddyFrac</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0D0</span><span class="o">/</span><span class="n">ResRatio</span><span class="p">)</span>
<a name="ln-3977"></a>
<a name="ln-3978"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadLossRate</span>   <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedLL</span> <span class="o">*</span> <span class="p">(</span><span class="n">PUL</span> <span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">FactorTempCorr</span>
<a name="ln-3979"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">NoLoadLossRate</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">RatedNL</span>
<a name="ln-3980"></a>    <span class="k">ELSE</span> <span class="c">!Transformer is not available.</span>
<a name="ln-3981"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadLossRate</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3982"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">NoLoadLossRate</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3983"></a>    <span class="n">ENDIF</span>
<a name="ln-3984"></a>
<a name="ln-3985"></a>    <span class="n">TotalLossRate</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadLossRate</span> <span class="o">+</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">NoLoadLossRate</span>
<a name="ln-3986"></a>
<a name="ln-3987"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">UsageMode</span> <span class="o">==</span> <span class="n">PowerInFromGrid</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3988"></a><span class="k">      </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerIn</span>    <span class="o">=</span> <span class="n">ElecLoad</span> <span class="o">+</span> <span class="n">TotalLossRate</span>
<a name="ln-3989"></a>
<a name="ln-3990"></a>      <span class="c">!Transformer losses are wired to the meter via the variable &quot;%ElecUseUtility&quot; only if transformer losses</span>
<a name="ln-3991"></a>      <span class="c">!are considered in utility cost. If transformer losses are not considered in utility cost, 0 is assigned</span>
<a name="ln-3992"></a>      <span class="c">!to the variable &quot;%ElecUseUtility&quot;.</span>
<a name="ln-3993"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ConsiderLosses</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3994"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ElecUseUtility</span> <span class="o">=</span> <span class="n">TotalLossRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-3995"></a>      <span class="k">ELSE</span>
<a name="ln-3996"></a><span class="k">        </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ElecUseUtility</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-3997"></a>      <span class="n">ENDIF</span>
<a name="ln-3998"></a>
<a name="ln-3999"></a>      <span class="c">!Transformer has two modes.If it works in one mode, the variable for meter output in the other mode</span>
<a name="ln-4000"></a>      <span class="c">!is assigned 0</span>
<a name="ln-4001"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ElecProducedCoGen</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-4002"></a>    <span class="k">ELSE</span>   <span class="c">!Usage mode is PowerOutFromBldg</span>
<a name="ln-4003"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerOut</span>   <span class="o">=</span> <span class="n">ElecLoad</span> <span class="o">-</span> <span class="n">TotalLossRate</span>
<a name="ln-4004"></a>
<a name="ln-4005"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerOut</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerOut</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-4006"></a>
<a name="ln-4007"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ElecProducedCoGen</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">1.0D0</span> <span class="o">*</span> <span class="n">TotalLossRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4008"></a>
<a name="ln-4009"></a>      <span class="c">!Transformer has two modes.If it works in one mode, the variable for meter output in the other mode</span>
<a name="ln-4010"></a>      <span class="c">!is assigned 0</span>
<a name="ln-4011"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ElecUseUtility</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-4012"></a>    <span class="n">ENDIF</span>
<a name="ln-4013"></a>
<a name="ln-4014"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerIn</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4015"></a><span class="k">      </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Efficiency</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-4016"></a>    <span class="k">ELSE</span>
<a name="ln-4017"></a><span class="k">      </span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">Efficiency</span>      <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerOut</span> <span class="o">/</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerIn</span>
<a name="ln-4018"></a>    <span class="n">ENDIF</span>
<a name="ln-4019"></a>
<a name="ln-4020"></a>    <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">NoLoadLossEnergy</span>  <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">NoLoadLossRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4021"></a>    <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadLossEnergy</span>  <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">LoadLossRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4022"></a>
<a name="ln-4023"></a>    <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">EnergyIn</span>          <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerIn</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4024"></a>    <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">EnergyOut</span>         <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerOut</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4025"></a>
<a name="ln-4026"></a><span class="c">!   Thermal loss rate may not be equal to Total loss rate. This is the case when surplus power is less than the</span>
<a name="ln-4027"></a><span class="c">!    calculated total loss rate for a cogeneration transformer. That is why &quot;PowerIn - PowerOut&quot; is used below.</span>
<a name="ln-4028"></a>    <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ThermalLossRate</span>   <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerIn</span> <span class="o">-</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">PowerOut</span>
<a name="ln-4029"></a>    <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ThermalLossEnergy</span> <span class="o">=</span> <span class="n">TotalLossRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4030"></a>
<a name="ln-4031"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! set values for zone heat gains</span>
<a name="ln-4032"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">QdotconvZone</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0D0</span> <span class="o">-</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneRadFrac</span><span class="p">)</span><span class="o">*</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ThermalLossRate</span>
<a name="ln-4033"></a>      <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">QdotRadZone</span>  <span class="o">=</span> <span class="p">(</span><span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ZoneRadFrac</span><span class="p">)</span> <span class="o">*</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">TransfNum</span><span class="p">)%</span><span class="n">ThermalLossRate</span>
<a name="ln-4034"></a>    <span class="n">ENDIF</span>
<a name="ln-4035"></a>  <span class="k">END DO</span>   <span class="c">! End TransfNum Loop</span>
<a name="ln-4036"></a>
<a name="ln-4037"></a><span class="k">END SUBROUTINE </span><span class="n">ManageTransformers</span>
<a name="ln-4038"></a>
<a name="ln-4039"></a>
<a name="ln-4040"></a>
<a name="ln-4041"></a><span class="k">SUBROUTINE </span><span class="n">FigureTransformerZoneGains</span>
<a name="ln-4042"></a>
<a name="ln-4043"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4044"></a>          <span class="c">!       AUTHOR         Weimin Wang</span>
<a name="ln-4045"></a>          <span class="c">!       DATE WRITTEN   July 2010</span>
<a name="ln-4046"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4047"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4048"></a>
<a name="ln-4049"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4050"></a>          <span class="c">! Couple transformer losses to zone heat gains</span>
<a name="ln-4051"></a>
<a name="ln-4052"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4053"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4054"></a>
<a name="ln-4055"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4056"></a>          <span class="c">! na</span>
<a name="ln-4057"></a>
<a name="ln-4058"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4059"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">BeginEnvrnFlag</span>
<a name="ln-4060"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneIntGain</span>
<a name="ln-4061"></a>
<a name="ln-4062"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4063"></a>
<a name="ln-4064"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4065"></a>          <span class="c">! na</span>
<a name="ln-4066"></a>
<a name="ln-4067"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4068"></a>          <span class="c">! na</span>
<a name="ln-4069"></a>
<a name="ln-4070"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4071"></a>          <span class="c">! na</span>
<a name="ln-4072"></a>
<a name="ln-4073"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4074"></a>          <span class="c">! na</span>
<a name="ln-4075"></a>
<a name="ln-4076"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4077"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4078"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">TransfNum</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4079"></a>  <span class="kt">INTEGER</span>       <span class="kd">::</span> <span class="n">ZoneNum</span>     <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4080"></a>
<a name="ln-4081"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumTransformers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-4082"></a>
<a name="ln-4083"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4084"></a><span class="k">    </span><span class="n">Transformer</span><span class="p">%</span><span class="n">QdotconvZone</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-4085"></a>    <span class="n">Transformer</span><span class="p">%</span><span class="n">QdotRadZone</span>  <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-4086"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4087"></a>  <span class="n">ENDIF</span>
<a name="ln-4088"></a>
<a name="ln-4089"></a>  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4090"></a>
<a name="ln-4091"></a><span class="c">!  IF(DoingSizing)THEN</span>
<a name="ln-4092"></a>
<a name="ln-4093"></a><span class="c">!  ENDIF</span>
<a name="ln-4094"></a>
<a name="ln-4095"></a>  <span class="k">RETURN</span>
<a name="ln-4096"></a>
<a name="ln-4097"></a><span class="k">END SUBROUTINE </span><span class="n">FigureTransformerZoneGains</span>
<a name="ln-4098"></a>
<a name="ln-4099"></a><span class="k">SUBROUTINE </span><span class="n">Rainflow</span><span class="p">(</span><span class="n">numbin</span><span class="p">,</span><span class="n">input</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">Nmb</span><span class="p">,</span><span class="n">OneNmb</span><span class="p">,</span><span class="nb">dim</span><span class="p">)</span>
<a name="ln-4100"></a>
<a name="ln-4101"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4102"></a>          <span class="c">!       AUTHOR         Y. KyungTae &amp; W. Wang</span>
<a name="ln-4103"></a>          <span class="c">!       DATE WRITTEN   July-August, 2011</span>
<a name="ln-4104"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4105"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4106"></a>
<a name="ln-4107"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4108"></a>          <span class="c">! Rainflow cycle counting for battery life calculation</span>
<a name="ln-4109"></a>
<a name="ln-4110"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4111"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4112"></a>
<a name="ln-4113"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4114"></a>          <span class="c">! Ariduru S. 2004. Fatigue life calculation by rainflow cycle counting method.</span>
<a name="ln-4115"></a>          <span class="c">!                  Master Thesis, Middle East Technical University.</span>
<a name="ln-4116"></a>
<a name="ln-4117"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4118"></a>
<a name="ln-4119"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4120"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">dim</span>               <span class="c">! end dimension of array</span>
<a name="ln-4121"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">numbin</span>  <span class="c">! numbin = constant value</span>
<a name="ln-4122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">input</span>  <span class="c">! input = input value from other object (battery model)</span>
<a name="ln-4123"></a> <span class="c">!Array B1 stores the value of points</span>
<a name="ln-4124"></a> <span class="c">!Array X stores the value of two data points&#39; difference.</span>
<a name="ln-4125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">dim</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B1</span>  <span class="c">! stores values of points, calculated here - stored for next timestep</span>
<a name="ln-4126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">dim</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>   <span class="c">! stores values of two data point difference, calculated here - stored for next timestep</span>
<a name="ln-4127"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="nb">count</span>   <span class="c">! calculated here - stored for next timestep in main loop</span>
<a name="ln-4128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">numbin</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Nmb</span>  <span class="c">! calculated here - stored for next timestep in main loop</span>
<a name="ln-4129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">numbin</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OneNmb</span>  <span class="c">! calculated here - stored for next timestep in main loop</span>
<a name="ln-4130"></a>
<a name="ln-4131"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4132"></a>          <span class="c">! na</span>
<a name="ln-4133"></a>
<a name="ln-4134"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4135"></a>          <span class="c">! na</span>
<a name="ln-4136"></a>
<a name="ln-4137"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4138"></a>          <span class="c">! na</span>
<a name="ln-4139"></a>
<a name="ln-4140"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4141"></a> <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">var1</span><span class="p">,</span><span class="n">var2</span>
<a name="ln-4142"></a> <span class="kt">INTEGER </span><span class="n">num</span>
<a name="ln-4143"></a> <span class="kt">INTEGER </span><span class="n">i</span><span class="p">,</span><span class="n">k</span>
<a name="ln-4144"></a>
<a name="ln-4145"></a> <span class="n">X</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span><span class="o">=</span><span class="n">input</span><span class="o">-</span><span class="n">B1</span><span class="p">(</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">! calculate the difference between two data (current and previous)</span>
<a name="ln-4146"></a>
<a name="ln-4147"></a><span class="c">! Get rid of the data if it is not peak nor valley</span>
<a name="ln-4148"></a><span class="c">! The value of count means the number of peak or valley points added to the arrary B10/B1, not including the</span>
<a name="ln-4149"></a><span class="c">! first point B10(0)/B1(0). Therefore, even if count =2, B1(count-2) is still valid.</span>
<a name="ln-4150"></a> <span class="k">IF</span><span class="p">(</span><span class="nb">count</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4151"></a><span class="c">!  The following check on peak or valley may be not necessary in most times because the same check is made in the</span>
<a name="ln-4152"></a><span class="c">!  upper-level subroutine. However, it does not hurt to leave it here.</span>
<a name="ln-4153"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4154"></a><span class="k">     </span><span class="n">X</span><span class="p">(</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">B1</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span><span class="o">-</span><span class="n">B1</span><span class="p">(</span><span class="nb">count</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4155"></a>     <span class="k">CALL </span><span class="n">shift</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">MAXRainflowArrayBounds</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Get rid of (count-1) row in B1</span>
<a name="ln-4156"></a>     <span class="k">CALL </span><span class="n">shift</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">MAXRainflowArrayBounds</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4157"></a>     <span class="nb">count</span><span class="o">=</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span>  <span class="c">! If the value keep increasing or decreasing, get rid of the middle point.</span>
<a name="ln-4158"></a>   <span class="n">ENDIF</span>            <span class="c">! Only valley and peak will be stored in the matrix, B1</span>
<a name="ln-4159"></a>
<a name="ln-4160"></a>   <span class="k">IF</span> <span class="p">((</span><span class="nb">count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">)).</span><span class="n">le</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4161"></a><span class="c">!  This means the starting point is included in X(2), a half cycle is counted according to the rain flow</span>
<a name="ln-4162"></a><span class="c">!  algorithm specified in the reference (Ariduru S. 2004)</span>
<a name="ln-4163"></a>     <span class="n">num</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">numbin</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span> <span class="c">! Count half cycle</span>
<a name="ln-4164"></a>     <span class="n">Nmb</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">=</span> <span class="n">Nmb</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5d0</span>
<a name="ln-4165"></a>     <span class="n">B1</span> <span class="o">=</span> <span class="nb">EOSHIft</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span><span class="n">shift</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>              <span class="c">! Once counting a half cycle, get rid of the value.</span>
<a name="ln-4166"></a>     <span class="n">X</span> <span class="o">=</span> <span class="nb">EOSHIft</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">shift</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4167"></a>     <span class="nb">count</span><span class="o">=</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span>                      <span class="c">! The number of matrix, B1 and X1 decrease.</span>
<a name="ln-4168"></a>   <span class="n">ENDIF</span>
<a name="ln-4169"></a> <span class="n">ENDIF</span> <span class="c">! Counting cyle end</span>
<a name="ln-4170"></a> <span class="c">!*** Note: The value of &quot;count&quot; changes in the upper &quot;IF LOOP&quot;</span>
<a name="ln-4171"></a>
<a name="ln-4172"></a> <span class="k">IF</span> <span class="p">(</span><span class="nb">count</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!count 1 cycle</span>
<a name="ln-4173"></a>   <span class="k">DO WHILE</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="nb">count</span><span class="p">))</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4174"></a><span class="c">!  This means that the starting point is not included in X(count-1). a cycle is counted according to the rain flow</span>
<a name="ln-4175"></a><span class="c">!  algorithm specified in the reference (Ariduru S. 2004)</span>
<a name="ln-4176"></a>     <span class="n">num</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">numbin</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-4177"></a>     <span class="n">Nmb</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">=</span><span class="n">Nmb</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">+</span><span class="mf">1.0d0</span>
<a name="ln-4178"></a>
<a name="ln-4179"></a><span class="c">!     X(count-2) = abs(X(count))-abs(X(count-1))+abs(X(count-2))</span>
<a name="ln-4180"></a>     <span class="n">X</span><span class="p">(</span><span class="nb">count</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">B1</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span><span class="o">-</span><span class="n">B1</span><span class="p">(</span><span class="nb">count</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="c">! Updating X needs to be done before shift operation below</span>
<a name="ln-4181"></a>
<a name="ln-4182"></a>     <span class="k">CALL </span><span class="n">shift</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">MAXRainflowArrayBounds</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="c">! Get rid of two data points one by one</span>
<a name="ln-4183"></a>     <span class="k">CALL </span><span class="n">shift</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span><span class="nb">count</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">B1</span><span class="p">,</span><span class="n">MAXRainflowArrayBounds</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="c">! Delete one point</span>
<a name="ln-4184"></a>
<a name="ln-4185"></a>     <span class="k">CALL </span><span class="n">shift</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">MAXRainflowArrayBounds</span><span class="p">)</span>       <span class="c">! Get rid of two data points one by one</span>
<a name="ln-4186"></a>     <span class="k">CALL </span><span class="n">shift</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="nb">count</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">MAXRainflowArrayBounds</span><span class="p">)</span>     <span class="c">! Delete one point</span>
<a name="ln-4187"></a>
<a name="ln-4188"></a>     <span class="nb">count</span> <span class="o">=</span> <span class="nb">count</span><span class="o">-</span><span class="mi">2</span>       <span class="c">! If one cycle is counted, two data points are deleted.</span>
<a name="ln-4189"></a>     <span class="k">IF</span> <span class="p">(</span><span class="nb">count</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="k">Exit</span>  <span class="c">! When only three data points exists, one cycle cannot be counted.</span>
<a name="ln-4190"></a>   <span class="n">ENDDO</span>
<a name="ln-4191"></a> <span class="n">ENDIF</span>
<a name="ln-4192"></a>
<a name="ln-4193"></a> <span class="nb">count</span><span class="o">=</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4194"></a>
<a name="ln-4195"></a><span class="c">! Check the rest of the half cycles every time step</span>
<a name="ln-4196"></a> <span class="n">OneNmb</span> <span class="o">=</span> <span class="n">Nmb</span>     <span class="c">! Array Nmb (Bins) will be used for the next time step later.</span>
<a name="ln-4197"></a>                     <span class="c">! OneNmb is used to show the current output only.</span>
<a name="ln-4198"></a><span class="c">! Ideally, the following clean-up counting is needed at the last system time step in each simulation environemnt.</span>
<a name="ln-4199"></a><span class="c">! Because of the difficulty in knowing the above information, the clean-up counting is skipped. Skipping this has</span>
<a name="ln-4200"></a><span class="c">! little impact on the simulation results.</span>
<a name="ln-4201"></a><span class="c">!   DO k = 1, count-1</span>
<a name="ln-4202"></a><span class="c">!     num = NINT((abs(X(k))*numbin*10+5)/10) !Bin number</span>
<a name="ln-4203"></a><span class="c">!     OneNmb(num) = OneNmb(num)+0.5d0</span>
<a name="ln-4204"></a><span class="c">!   ENDDO</span>
<a name="ln-4205"></a><span class="k">END SUBROUTINE</span>
<a name="ln-4206"></a>
<a name="ln-4207"></a><span class="k">SUBROUTINE </span><span class="n">shift</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="nb">dim</span><span class="p">)</span>
<a name="ln-4208"></a>
<a name="ln-4209"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4210"></a>          <span class="c">!       AUTHOR         Y. KyungTae &amp; W. Wang</span>
<a name="ln-4211"></a>          <span class="c">!       DATE WRITTEN   July-August, 2011</span>
<a name="ln-4212"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4213"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4214"></a>
<a name="ln-4215"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4216"></a>          <span class="c">! Utility subroutine for rainflow cycle counting</span>
<a name="ln-4217"></a>
<a name="ln-4218"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4219"></a>          <span class="c">! na</span>
<a name="ln-4220"></a>
<a name="ln-4221"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4222"></a>          <span class="c">! na</span>
<a name="ln-4223"></a>
<a name="ln-4224"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4225"></a>          <span class="c">! na</span>
<a name="ln-4226"></a>
<a name="ln-4227"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4228"></a>
<a name="ln-4229"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4230"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">dim</span> <span class="c">! end dimension of arrays</span>
<a name="ln-4231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="nb">dim</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span>
<a name="ln-4232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="nb">dim</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B</span>
<a name="ln-4233"></a>  <span class="kt">INTEGER </span><span class="n">m</span><span class="p">,</span><span class="n">n</span>
<a name="ln-4234"></a>
<a name="ln-4235"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4236"></a>          <span class="c">! na</span>
<a name="ln-4237"></a>
<a name="ln-4238"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4239"></a>          <span class="c">! na</span>
<a name="ln-4240"></a>
<a name="ln-4241"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4242"></a>          <span class="c">! na</span>
<a name="ln-4243"></a>
<a name="ln-4244"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4245"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ShiftNum</span>  <span class="c">! Loop variable</span>
<a name="ln-4246"></a>
<a name="ln-4247"></a>  <span class="k">DO </span><span class="n">ShiftNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-4248"></a>    <span class="n">B</span><span class="p">(</span><span class="n">ShiftNum</span><span class="p">)</span><span class="o">=</span><span class="n">A</span><span class="p">(</span><span class="n">ShiftNum</span><span class="p">)</span>
<a name="ln-4249"></a>  <span class="n">ENDDO</span>
<a name="ln-4250"></a>
<a name="ln-4251"></a>  <span class="k">DO </span><span class="n">ShiftNum</span><span class="o">=</span><span class="n">m</span><span class="p">,</span><span class="n">n</span>
<a name="ln-4252"></a>    <span class="n">B</span><span class="p">(</span><span class="n">ShiftNum</span><span class="p">)</span><span class="o">=</span><span class="n">A</span><span class="p">(</span><span class="n">ShiftNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4253"></a>  <span class="n">ENDDO</span>
<a name="ln-4254"></a><span class="k">END SUBROUTINE</span>
<a name="ln-4255"></a>
<a name="ln-4256"></a><span class="c">!******************************************************************************************************</span>
<a name="ln-4257"></a><span class="c">!+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
<a name="ln-4258"></a>
<a name="ln-4259"></a><span class="c">!     NOTICE</span>
<a name="ln-4260"></a><span class="c">!</span>
<a name="ln-4261"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-4262"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-4263"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-4264"></a><span class="c">!</span>
<a name="ln-4265"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-4266"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-4267"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-4268"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-4269"></a><span class="c">!</span>
<a name="ln-4270"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-4271"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-4272"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-4273"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-4274"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-4275"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-4276"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-4277"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-4278"></a><span class="c">!     permit others to do so.</span>
<a name="ln-4279"></a><span class="c">!</span>
<a name="ln-4280"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-4281"></a><span class="c">!</span>
<a name="ln-4282"></a>
<a name="ln-4283"></a>
<a name="ln-4284"></a><span class="k">END MODULE </span><span class="n">ManageElectricPower</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
