<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>SolarReflectionManager.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>SolarReflectionManager.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.2% of total for source files.">867 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/SolarReflectionManager.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">SolarReflectionManager.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/solarreflectionmanager.html">SolarReflectionManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html#src">SolarReflectionManager.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~solarreflectionmanager.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilesolarreflectionmanagerf90EfferentGraph" width="641pt" height="523pt"
 viewBox="0.00 0.00 641.00 523.43" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph" class="graph" transform="scale(.517 .517) rotate(0) translate(4 1008.3457)">
<title>sourcefile~~solarreflectionmanager.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1008.3457 1235.7278,-1008.3457 1235.7278,4 -4,4"/>
<!-- sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~solarreflectionmanager.f90</title>
<polygon fill="none" stroke="#000000" points="1231.5203,-553.9213 1090.3516,-553.9213 1090.3516,-531.9104 1231.5203,-531.9104 1231.5203,-553.9213"/>
<text text-anchor="middle" x="1160.9359" y="-539.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">SolarReflectionManager.f90</text>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1054.2266,-667.9213 939.8967,-667.9213 939.8967,-645.9104 1054.2266,-645.9104 1054.2266,-667.9213"/>
<text text-anchor="middle" x="997.0616" y="-653.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1013.073,-645.7775C1041.9059,-625.7197 1102.7113,-583.4201 1136.6794,-559.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1138.8905,-562.5155 1145.1009,-553.9316 1134.8931,-556.7691 1138.8905,-562.5155"/>
</g>
<!-- sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~vectorutilities.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/vectorutilities.f90.html" xlink:title="VectorUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="895.2844,-208.9213 802.0367,-208.9213 802.0367,-186.9104 895.2844,-186.9104 895.2844,-208.9213"/>
<text text-anchor="middle" x="848.6605" y="-194.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VectorUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M851.425,-186.6529C863.0651,-141.8368 911.4847,19.8882 997.0616,-11.9159"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="757.2763,-552.9213 690.5387,-552.9213 690.5387,-530.9104 757.2763,-530.9104 757.2763,-552.9213"/>
<text text-anchor="middle" x="723.9075" y="-538.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M757.5618,-541.3724C809.1326,-540.6903 910.8032,-539.9405 997.0616,-542.9159"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M750.0986,-552.9425C799.2264,-573.6257 905.2694,-618.2706 961.0649,-641.761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="959.9738,-645.0991 970.5484,-645.7536 962.69,-638.6475 959.9738,-645.0991"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M726.7412,-530.7789C732.6964,-507.2394 746.8277,-450.6679 757.3418,-402.9159 774.8849,-323.24 742.5597,-286.7686 793.3418,-222.9159 795.889,-219.7131 798.936,-216.9068 802.2728,-214.4503"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="804.3715,-217.268 811.044,-209.0382 800.6957,-211.3107 804.3715,-217.268"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="903.7986,-514.9213 793.5225,-514.9213 793.5225,-492.9104 903.7986,-492.9104 903.7986,-514.9213"/>
<text text-anchor="middle" x="848.6605" y="-500.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M757.339,-531.7326C771.3115,-527.4765 787.7739,-522.462 802.8455,-517.8712"/>
<polygon fill="#002eff" stroke="#002eff" points="803.9625,-521.1898 812.5087,-514.9278 801.9228,-514.4936 803.9625,-521.1898"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1052.8784,-494.9213 941.2448,-494.9213 941.2448,-472.9104 1052.8784,-472.9104 1052.8784,-494.9213"/>
<text text-anchor="middle" x="997.0616" y="-480.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M734.2713,-530.6716C754.1435,-510.3271 799.9736,-469.1132 848.6605,-464.9159"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-156.9213 539.0902,-156.9213 539.0902,-134.9104 632.3482,-134.9104 632.3482,-156.9213"/>
<text text-anchor="middle" x="585.7192" y="-142.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M598.2563,-134.8418C634.198,-104.198 741.8837,-20.0004 848.6605,-11.9159"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M609.6516,-156.946C636.7953,-169.0157 682.6516,-188.0854 723.9075,-198.9159"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M723.9075,-198.9159C745.7001,-204.6368 770.3811,-205.5433 792.0047,-204.6033"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="792.2411,-208.0956 802.0247,-204.0295 791.8409,-201.107 792.2411,-208.0956"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M589.7059,-157.3403C608.8578,-212.2229 691.519,-449.1016 716.6393,-521.0877"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="713.4372,-522.5348 720.0366,-530.8233 720.0464,-520.2285 713.4372,-522.5348"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M723.9075,-198.9159C737.9228,-202.5952 835.7043,-230.4272 848.6605,-236.9159"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M848.6605,-236.9159C939.7156,-282.5172 979.7955,-411.7738 992.3944,-462.8119"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="989.0292,-463.791 994.7331,-472.7194 995.842,-462.1827 989.0292,-463.791"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-331.9213 -.2403,-331.9213 -.2403,-309.9104 130.719,-309.9104 130.719,-331.9213"/>
<text text-anchor="middle" x="65.2394" y="-317.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M848.6605,-907.9159C905.647,-874.7083 939.5224,-940.1561 997.0616,-907.9159"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M848.6605,-907.9159C873.8268,-898.7012 885.2209,-903.0569 903.9792,-883.9159 962.6702,-824.0274 986.1397,-722.0091 993.8508,-678.0718"/>
<polygon fill="#ff0000" stroke="#ff0000" points="997.3405,-678.4213 995.5192,-667.9842 990.4343,-677.2791 997.3405,-678.4213"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-908.9159C453.3073,-1065.3168 587.893,-1003.3963 848.6605,-907.9159"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M67.0068,-309.6981C73.267,-273.9029 97.8203,-161.5603 166.4788,-106.9159 276.4417,-19.3977 340.7361,-64.5868 480.9653,-73.9159 527.833,-77.0339 538.8084,-85.5342 585.7192,-87.9159"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M585.7192,-87.9159C680.3453,-90.8284 780.3931,-150.8247 824.9084,-180.9559"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="823.0763,-183.9438 833.2982,-186.7298 827.0447,-178.1774 823.0763,-183.9438"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M223.8406,-635.9159C290.9454,-668.9356 255.7025,-538.4732 317.2024,-495.9159 347.9229,-474.6575 363.5792,-488.5388 399.0839,-476.9159"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M399.0839,-476.9159C477.9163,-451.109 505.8172,-454.6401 585.7192,-476.9159"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M223.8406,-203.9159C271.4867,-192.1171 270.053,-158.5653 317.2024,-144.9159 387.1153,-124.6765 408.1826,-144.5685 480.9653,-144.9159 496.5558,-144.9903 513.4509,-145.127 529.0289,-145.2759"/>
<polygon fill="#5cff00" stroke="#5cff00" points="529.0146,-148.7758 539.0487,-145.375 529.0839,-141.7762 529.0146,-148.7758"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M74.4622,-309.6498C96.7403,-283.5743 156.6357,-220.0626 223.8406,-203.9159"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-448.9213 180.0456,-448.9213 180.0456,-426.9104 267.6355,-426.9104 267.6355,-448.9213"/>
<text text-anchor="middle" x="223.8406" y="-434.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M80.1602,-331.9229C107.9086,-352.3929 167.6245,-396.4453 200.6666,-420.8205"/>
<polygon fill="#00ffb9" stroke="#00ffb9" points="198.7188,-423.7329 208.8439,-426.8528 202.8744,-418.0998 198.7188,-423.7329"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-137.9213 168.8556,-137.9213 168.8556,-115.9104 278.8255,-115.9104 278.8255,-137.9213"/>
<text text-anchor="middle" x="223.8406" y="-123.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M73.3477,-309.812C90.1567,-286.9329 130.2604,-233.0674 166.4788,-189.9159 179.2722,-174.6734 194.4607,-158.0529 205.9938,-145.712"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="208.6834,-147.961 212.983,-138.2779 203.5833,-143.1663 208.6834,-147.961"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M223.8406,-203.9159C294.0633,-187.0441 257.8822,-295.7212 317.2024,-336.9159 349.0133,-359.0068 617.5262,-413.3027 654.4731,-424.9159 700.9695,-439.5305 712.2243,-444.4792 757.3418,-462.9159 760.3018,-464.1254 790.0482,-477.4988 814.7991,-488.6481"/>
<polygon fill="#002eff" stroke="#002eff" points="813.4192,-491.8652 823.9742,-492.7824 816.2949,-485.4832 813.4192,-491.8652"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M223.8406,-203.9159C380.4464,-166.2129 424.8382,-215.904 585.7192,-223.9159"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-880.9213 334.3841,-880.9213 334.3841,-858.9104 463.7837,-858.9104 463.7837,-880.9213"/>
<text text-anchor="middle" x="399.0839" y="-866.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M223.8406,-908.9159C234.5026,-916.183 304.6942,-897.7309 352.9416,-883.7916"/>
<polygon fill="#e700ff" stroke="#e700ff" points="353.9528,-887.1426 362.5744,-880.9847 351.9945,-880.4221 353.9528,-887.1426"/>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M66.3357,-332.1328C73.9633,-407.5122 121.8386,-839.3929 223.8406,-908.9159"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-526.9213 350.2841,-526.9213 350.2841,-504.9104 447.8836,-504.9104 447.8836,-526.9213"/>
<text text-anchor="middle" x="399.0839" y="-512.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M223.8406,-635.9159C278.1062,-662.6179 265.1085,-567.6403 317.2024,-536.9159 324.302,-532.7286 332.2276,-529.3678 340.275,-526.6725"/>
<polygon fill="#ff008b" stroke="#ff008b" points="341.5431,-529.9457 350.1041,-523.7039 339.5192,-523.2446 341.5431,-529.9457"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-802.9213 344.7839,-802.9213 344.7839,-780.9104 453.3838,-780.9104 453.3838,-802.9213"/>
<text text-anchor="middle" x="399.0839" y="-788.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-635.9159C287.9904,-667.4816 259.1791,-725.1439 317.2024,-766.9159 322.7135,-770.8834 328.8655,-774.231 335.254,-777.0537"/>
<polygon fill="#00ff00" stroke="#00ff00" points="334.1506,-780.3815 344.7362,-780.8246 336.7374,-773.8769 334.1506,-780.3815"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-705.9213 536.1602,-705.9213 536.1602,-683.9104 635.2783,-683.9104 635.2783,-705.9213"/>
<text text-anchor="middle" x="585.7192" y="-691.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-714.9159C441.6792,-715.0024 489.4332,-709.7866 525.9733,-704.6604"/>
<polygon fill="#0000ff" stroke="#0000ff" points="526.5693,-708.1108 535.9685,-703.2215 525.5718,-701.1822 526.5693,-708.1108"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-635.9159C268.0971,-657.6928 271.7642,-676.7262 317.2024,-695.9159 351.6178,-710.4504 361.7253,-714.8399 399.0839,-714.9159"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-686.9213 358.7923,-686.9213 358.7923,-664.9104 439.3754,-664.9104 439.3754,-686.9213"/>
<text text-anchor="middle" x="399.0839" y="-672.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-635.9159C263.2145,-655.2903 312.2078,-665.4492 348.3726,-670.6709"/>
<polygon fill="#0000ff" stroke="#0000ff" points="348.3046,-674.1939 358.6858,-672.077 349.2503,-667.258 348.3046,-674.1939"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.7769,-448.9213 341.3908,-448.9213 341.3908,-426.9104 456.7769,-426.9104 456.7769,-448.9213"/>
<text text-anchor="middle" x="399.0839" y="-434.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.3221,-331.9362C71.7771,-380.4789 101.0553,-575.4978 223.8406,-635.9159"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-635.9159C302.2348,-674.4907 249.6031,-518.2692 317.2024,-462.9159 321.8437,-459.1154 327.0567,-455.8918 332.5457,-453.1578"/>
<polygon fill="#ff0000" stroke="#ff0000" points="334.2472,-456.2331 341.9919,-449.0033 331.429,-449.8254 334.2472,-456.2331"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-526.9213 517.2105,-526.9213 517.2105,-504.9104 654.2279,-504.9104 654.2279,-526.9213"/>
<text text-anchor="middle" x="585.7192" y="-512.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-476.9159C425.2417,-468.3527 496.1719,-487.3721 542.668,-501.7522"/>
<polygon fill="#00ffff" stroke="#00ffff" points="541.8918,-505.1769 552.481,-504.83 543.9867,-498.4977 541.8918,-505.1769"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-175.9213 340.6161,-175.9213 340.6161,-153.9104 457.5516,-153.9104 457.5516,-175.9213"/>
<text text-anchor="middle" x="399.0839" y="-161.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-203.9159C260.9923,-194.7158 302.824,-185.3684 336.2977,-178.1318"/>
<polygon fill="#ff0000" stroke="#ff0000" points="337.3639,-181.4825 346.4033,-175.9562 335.8906,-174.6393 337.3639,-181.4825"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-253.9213 323.0941,-253.9213 323.0941,-231.9104 475.0737,-231.9104 475.0737,-253.9213"/>
<text text-anchor="middle" x="399.0839" y="-239.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-203.9159C235.9155,-200.9257 301.0809,-216.8317 348.4253,-229.229"/>
<polygon fill="#ff0000" stroke="#ff0000" points="347.6703,-232.6494 358.232,-231.8131 349.454,-225.8805 347.6703,-232.6494"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-294.9213 317.3208,-294.9213 317.3208,-272.9104 480.847,-272.9104 480.847,-294.9213"/>
<text text-anchor="middle" x="399.0839" y="-280.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-203.9159C271.4867,-192.1171 272.1329,-243.4707 317.2024,-262.9159 323.2682,-265.533 329.7326,-267.879 336.2678,-269.9684"/>
<polygon fill="#00ffff" stroke="#00ffff" points="335.271,-273.3234 345.8552,-272.8476 337.2845,-266.6192 335.271,-273.3234"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M997.0616,-542.9159C1024.0353,-545.7251 1053.6421,-546.4423 1080.1814,-546.2359"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1080.2341,-549.7356 1090.1907,-546.114 1080.1488,-542.7361 1080.2341,-549.7356"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-438.9159C723.9844,-474.8397 769.9611,-434.4495 903.9792,-483.9159 949.9295,-500.8762 948.3448,-537.8421 997.0616,-542.9159"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-398.9159C409.6879,-398.8742 575.5413,-435.9399 585.7192,-438.9159"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-791.9159C616.5811,-782.1654 627.2795,-785.4667 654.4731,-767.9159 692.0948,-743.6347 679.1362,-694.2143 723.9075,-694.9159"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.3835,-449.2154C244.1071,-502.5208 314.455,-726.3799 317.2024,-728.9159 322.8321,-734.1123 578.4138,-794.2239 585.7192,-791.9159"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M399.0839,-322.9159C431.6562,-304.6207 444.8085,-313.3155 480.9653,-303.9159 597.7121,-273.5652 733.8199,-232.9444 803.0955,-211.8897"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="804.2742,-215.1895 812.8213,-208.9287 802.2355,-208.4929 804.2742,-215.1895"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M585.7192,-438.9159C616.7841,-447.9989 628.8912,-443.0894 654.4731,-462.9159 677.272,-480.5854 670.6356,-495.9761 690.4731,-516.9159 692.9405,-519.5204 695.7038,-522.0523 698.5562,-524.4425"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="696.6174,-527.3685 706.6597,-530.7453 700.9151,-521.8431 696.6174,-527.3685"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M239.3307,-426.6988C269.341,-405.2073 337.849,-357.3101 399.0839,-322.9159"/>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M399.0839,-322.9159C431.6562,-304.6207 452.7935,-328.4519 480.9653,-303.9159 514.7009,-274.534 491.9467,-247.0029 516.9653,-209.9159 529.1631,-191.8342 547.3826,-175.1766 562.002,-163.3908"/>
<polygon fill="#5cff00" stroke="#5cff00" points="564.4005,-165.9583 570.121,-157.0405 560.0879,-160.4446 564.4005,-165.9583"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M585.7192,-438.9159C654.6212,-459.0621 734.8514,-478.2954 788.3967,-490.5404"/>
<polygon fill="#002eff" stroke="#002eff" points="787.8793,-494.0121 798.4068,-492.8192 789.4332,-487.1867 787.8793,-494.0121"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M399.0839,-398.9159C483.6466,-398.5839 501.8866,-373.0091 585.7192,-361.9159"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M254.7186,-426.816C289.3712,-415.3588 347.5004,-399.1184 399.0839,-398.9159"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M227.563,-449.0489C237.056,-477.6056 262.7225,-555.8575 281.2024,-621.9159 299.0913,-685.8617 271.5098,-718.7363 317.2024,-766.9159 322.3355,-772.3284 328.603,-776.5796 335.3628,-779.9167"/>
<polygon fill="#00ff00" stroke="#00ff00" points="334.2524,-783.2473 344.8256,-783.9241 336.9821,-776.8015 334.2524,-783.2473"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M226.2491,-449.3272C233.6353,-481.375 259.0859,-572.7962 317.2024,-617.9159 376.221,-663.736 409.4152,-634.3925 480.9653,-655.9159 504.1219,-662.8817 529.5548,-672.3066 549.5614,-680.1461"/>
<polygon fill="#0000ff" stroke="#0000ff" points="548.327,-683.4216 558.9132,-683.8495 550.9043,-676.9134 548.327,-683.4216"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-608.9213 334.8633,-608.9213 334.8633,-586.9104 463.3044,-586.9104 463.3044,-608.9213"/>
<text text-anchor="middle" x="399.0839" y="-594.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.9917,-448.9431C238.5416,-475.4109 269.0095,-542.8586 317.2024,-576.9159 320.2586,-579.0756 323.5183,-581.0135 326.9108,-582.7522"/>
<polygon fill="#ff0000" stroke="#ff0000" points="325.5961,-585.9985 336.152,-586.9053 328.4655,-579.6136 325.5961,-585.9985"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-567.9213 354.6193,-567.9213 354.6193,-545.9104 443.5485,-545.9104 443.5485,-567.9213"/>
<text text-anchor="middle" x="399.0839" y="-553.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M231.1309,-448.9493C245.2264,-469.3799 278.2824,-513.094 317.2024,-535.9159 325.6587,-540.8744 335.2767,-544.6751 344.8744,-547.5845"/>
<polygon fill="#00ff00" stroke="#00ff00" points="344.2503,-551.0423 354.8195,-550.305 346.0974,-544.2904 344.2503,-551.0423"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M225.4192,-449.0875C230.9843,-484.2592 252.9466,-593.7568 317.2024,-650.9159 326.0494,-658.7857 337.3194,-664.1785 348.6478,-667.8738"/>
<polygon fill="#0000ff" stroke="#0000ff" points="347.9818,-671.3235 358.5585,-670.7038 349.9039,-664.5925 347.9818,-671.3235"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M267.6098,-437.9159C286.8638,-437.9159 309.9241,-437.9159 331.3175,-437.9159"/>
<polygon fill="#ff0000" stroke="#ff0000" points="331.3347,-441.416 341.3347,-437.9159 331.3347,-434.416 331.3347,-441.416"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-398.9159C436.4422,-398.7692 451.6904,-394.7071 480.9653,-417.9159 509.3129,-440.3894 490.0254,-466.7729 516.9653,-490.9159 521.1035,-494.6244 525.8352,-497.7954 530.8369,-500.5045"/>
<polygon fill="#00ffff" stroke="#00ffff" points="529.5281,-503.7578 540.0614,-504.8981 532.5382,-497.4381 529.5281,-503.7578"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.4631,-426.5C234.7484,-392.4058 263.0729,-289.5686 317.2024,-222.9159 331.1016,-205.801 351.2709,-191.4326 368.1134,-181.2783"/>
<polygon fill="#ff0000" stroke="#ff0000" points="370.1763,-184.1277 377.0671,-176.0798 366.6616,-178.074 370.1763,-184.1277"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M226.5369,-426.4971C234.5217,-395.2768 261.0764,-307.8991 317.2024,-263.9159 319.6643,-261.9866 322.2837,-260.2331 325.0175,-258.6393"/>
<polygon fill="#ff0000" stroke="#ff0000" points="326.7269,-261.6973 334.0842,-254.0736 323.5785,-255.4452 326.7269,-261.6973"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M228.83,-426.7119C240.5356,-401.7129 272.2121,-341.0569 317.2024,-308.9159 322.7279,-304.9684 328.8892,-301.6337 335.2832,-298.8187"/>
<polygon fill="#00ffff" stroke="#00ffff" points="336.7659,-301.996 344.7709,-295.0555 334.1849,-295.4892 336.7659,-301.996"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M848.6605,-11.9159C914.4084,-6.6791 935.2371,11.0608 997.0616,-11.9159"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M723.9075,-11.9159C778.7781,-19.8813 793.3898,-16.3182 848.6605,-11.9159"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M997.0616,-11.9159C1098.3022,-49.5412 1147.8046,-427.5304 1158.6275,-521.7359"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1155.1609,-522.2294 1159.7565,-531.7757 1162.117,-521.4471 1155.1609,-522.2294"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M239.1839,-115.8501C257.0244,-103.5609 287.7945,-84.1138 317.2024,-73.9159 489.9562,-14.0091 542.9581,14.3522 723.9075,-11.9159"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M256.3153,-115.8665C291.145,-104.9232 348.3059,-89.5624 399.0839,-87.9159"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M399.0839,-87.9159C481.9893,-85.2276 502.8769,-83.7099 585.7192,-87.9159"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M399.0839,-87.9159C456.9872,-86.0383 520.6744,-112.4659 556.6726,-130.2769"/>
<polygon fill="#5cff00" stroke="#5cff00" points="555.1338,-133.4208 565.636,-134.819 558.298,-127.1767 555.1338,-133.4208"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M723.9075,-11.9159C933.9485,-27.8189 985.218,-372.5812 995.0423,-462.5815"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="991.5768,-463.0976 996.0845,-472.6856 998.5399,-462.3793 991.5768,-463.0976"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M274.9993,-138.0092C294.7941,-142.3015 317.6108,-147.2491 338.2375,-151.7218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="337.6499,-155.1757 348.1645,-153.8744 339.1334,-148.3347 337.6499,-155.1757"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M875.7349,-514.9235C905.0722,-525.9226 953.5329,-541.4144 997.0616,-542.9159"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M859.8147,-515.4157C885.2925,-541.683 947.9492,-606.2814 979.0077,-638.3025"/>
<polygon fill="#ff0000" stroke="#ff0000" points="976.7066,-640.957 986.1813,-645.6984 981.7313,-636.0834 976.7066,-640.957"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M903.9196,-496.4686C912.6612,-495.2905 921.7787,-494.0617 930.7411,-492.8539"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="931.3229,-496.3072 940.7658,-491.5028 930.3879,-489.3699 931.3229,-496.3072"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1027.8851,-495.0133C1054.0932,-504.4491 1091.9175,-518.067 1120.5431,-528.3732"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1119.6562,-531.7737 1130.2506,-531.8682 1122.0275,-525.1876 1119.6562,-531.7737"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M997.0616,-907.9159C1126.2363,-835.537 1153.912,-630.6167 1159.5569,-564.0713"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1163.057,-564.2019 1160.3308,-553.9638 1156.0775,-563.6674 1163.057,-564.2019"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M848.6605,-869.9159C912.713,-846.8351 937.666,-941.1963 997.0616,-907.9159"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M464.1519,-880.4587C552.8741,-892.4778 715.9465,-906.1282 848.6605,-869.9159"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M848.6605,-869.9159C934.0207,-839.1571 976.9013,-725.0512 991.3254,-677.7086"/>
<polygon fill="#ff0000" stroke="#ff0000" points="994.737,-678.512 994.1847,-667.9315 988.0184,-676.5471 994.737,-678.512"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M459.5523,-858.756C467.4355,-855.3094 474.8738,-850.8039 480.9653,-844.9159 516.4367,-810.6294 486.6879,-778.8653 516.9653,-739.9159 526.1947,-728.043 539.481,-718.3179 551.9183,-710.9849"/>
<polygon fill="#0000ff" stroke="#0000ff" points="553.7155,-713.9903 560.7543,-706.0717 550.3136,-707.8725 553.7155,-713.9903"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M723.9075,-599.9159C847.5289,-609.8117 873.1296,-538.329 997.0616,-542.9159"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-554.9159C672.9839,-560.2567 636.5962,-690.3999 723.9075,-694.9159"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M723.9075,-694.9159C801.1059,-698.9088 889.5763,-682.7511 944.3957,-670.2713"/>
<polygon fill="#ff0000" stroke="#ff0000" points="945.2796,-673.6592 954.2297,-667.9895 943.6974,-666.8404 945.2796,-673.6592"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M443.5639,-526.9593C489.6322,-538.0812 558.6002,-553.7623 585.7192,-554.9159"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M585.7192,-554.9159C617.3932,-556.2631 630.6367,-556.8176 654.4731,-535.9159 685.3198,-508.8669 674.0358,-488.5054 690.4731,-450.9159 701.6083,-425.4516 773.6957,-242.5742 793.3418,-222.9159 796.7921,-219.4634 800.8044,-216.442 805.0626,-213.8085"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="806.9263,-216.7794 814.047,-208.9342 803.5881,-210.6266 806.9263,-216.7794"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M585.7192,-554.9159C617.5276,-556.2688 653.3109,-552.7626 680.4939,-549.0525"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="681.0592,-552.5074 690.4647,-547.6303 680.0707,-545.5775 681.0592,-552.5074"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M723.9075,-599.9159C749.0572,-601.9291 802.8255,-551.0985 830.8469,-522.6043"/>
<polygon fill="#002eff" stroke="#002eff" points="833.5621,-524.8325 838.0225,-515.2223 828.5426,-519.9534 833.5621,-524.8325"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M585.7192,-554.9159C650.2523,-557.6608 659.522,-594.7618 723.9075,-599.9159"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M848.6605,-464.9159C879.1991,-462.2831 913.117,-466.1149 940.8096,-471.0108"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="940.2412,-474.465 950.7126,-472.8527 941.5213,-467.5831 940.2412,-474.465"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M585.7192,-554.9159C617.4079,-555.8578 624.3824,-545.8961 654.4731,-535.9159 670.7676,-530.5114 674.4207,-528.0016 690.4731,-521.9159 736.047,-504.6381 747.4311,-500.2775 793.3418,-483.9159 817.8291,-475.1891 822.7607,-467.1487 848.6605,-464.9159"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M447.9801,-522.2808C459.5237,-525.3943 471.2781,-530.0264 480.9653,-536.9159 531.036,-572.5257 563.7872,-640.2235 577.8516,-674.2718"/>
<polygon fill="#0000ff" stroke="#0000ff" points="574.6528,-675.6992 581.615,-683.6854 581.1527,-673.1006 574.6528,-675.6992"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M448.1201,-515.9159C466.1366,-515.9159 487.0197,-515.9159 506.9891,-515.9159"/>
<polygon fill="#00ffff" stroke="#00ffff" points="507.0141,-519.416 517.0141,-515.9159 507.0141,-512.416 507.0141,-519.416"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-765.9213 166.6166,-765.9213 166.6166,-743.9104 281.0645,-743.9104 281.0645,-765.9213"/>
<text text-anchor="middle" x="223.8406" y="-751.7659" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-830.9159C483.7013,-835.4853 504.9154,-817.4449 585.7192,-791.9159"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M238.5666,-765.983C256.3227,-778.8205 287.4945,-799.7714 317.2024,-811.9159 351.7832,-826.0523 361.7796,-828.9014 399.0839,-830.9159"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M399.0839,-830.9159C436.3882,-832.9303 448.0452,-829.5776 480.9653,-811.9159 500.3585,-801.5114 498.1611,-789.3504 516.9653,-777.9159 544.6194,-761.0999 559.8754,-773.3997 585.7192,-753.9159"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M232.3807,-766.0505C247.4705,-784.9782 280.72,-823.4569 317.2024,-844.9159 324.2157,-849.0411 331.9736,-852.5452 339.8372,-855.5052"/>
<polygon fill="#e700ff" stroke="#e700ff" points="338.8435,-858.8653 349.4384,-858.8511 341.1471,-852.2552 338.8435,-858.8653"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M253.4496,-743.8417C287.9209,-731.9666 346.8128,-714.8096 399.0839,-714.9159"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.4904,-800.4182C491.4407,-804.3182 542.7729,-805.4842 585.7192,-791.9159"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M585.7192,-753.9159C613.7714,-732.7671 632.8373,-742.594 654.4731,-714.9159 691.1317,-668.0196 663.996,-639.2269 690.4731,-585.9159 694.8287,-577.146 701.0256,-568.3752 706.9033,-560.9982"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="709.8064,-562.9821 713.5272,-553.0621 704.4323,-558.4966 709.8064,-562.9821"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M453.2995,-786.1005C500.7396,-780.0882 565.1903,-769.3928 585.7192,-753.9159"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M420.4933,-780.7887C453.5938,-763.5854 517.3213,-730.4643 555.2266,-710.7638"/>
<polygon fill="#0000ff" stroke="#0000ff" points="557.0137,-713.7795 564.2728,-706.0622 553.7856,-707.5683 557.0137,-713.7795"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.3193,-693.6774C661.6546,-693.3326 694.5577,-693.3978 723.9075,-694.9159"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M596.1058,-683.416C619.7297,-657.26 677.6811,-593.0971 706.7268,-560.9381"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="709.6706,-562.9005 713.7759,-553.1334 704.4758,-558.2086 709.6706,-562.9005"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M610.3697,-683.8071C643.8936,-668.5804 705.6143,-640.1228 757.3418,-613.9159 834.6215,-574.7633 923.9011,-525.163 968.5427,-500.0543"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="970.3763,-503.0386 977.3708,-495.0807 966.9403,-496.9399 970.3763,-503.0386"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M444.2195,-609.0034C456.4325,-612.7217 469.4512,-617.3646 480.9653,-622.9159 511.9257,-637.8428 543.9881,-661.2574 564.3517,-677.3067"/>
<polygon fill="#0000ff" stroke="#0000ff" points="562.3308,-680.1722 572.3253,-683.6878 566.7046,-674.7068 562.3308,-680.1722"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M443.4803,-563.3055C456.2047,-566.4284 469.6763,-571.0594 480.9653,-577.9159 521.8512,-602.7482 555.899,-648.4998 573.2769,-674.8317"/>
<polygon fill="#0000ff" stroke="#0000ff" points="570.5518,-677.0647 578.9068,-683.5796 576.4381,-673.2764 570.5518,-677.0647"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M439.581,-680.0386C464.7885,-682.6048 497.6632,-685.9515 525.8471,-688.8207"/>
<polygon fill="#0000ff" stroke="#0000ff" points="525.6924,-692.323 535.9955,-689.8538 526.4014,-685.359 525.6924,-692.323"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M457.1496,-448.0077C494.2259,-454.9525 543.1516,-465.0485 585.7192,-476.9159"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M585.7192,-476.9159C616.2573,-485.4295 625.6218,-482.776 654.4731,-495.9159 663.6889,-500.113 683.6048,-513.4871 699.7538,-524.74"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="698.0504,-527.8205 708.246,-530.7016 702.0724,-522.0913 698.0504,-527.8205"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M644.3235,-526.9422C656.376,-529.2099 668.8645,-531.5596 680.2757,-533.7066"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="679.9344,-537.2037 690.4091,-535.6132 681.2287,-530.3244 679.9344,-537.2037"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M457.3688,-158.9823C480.1853,-156.6595 506.2705,-154.004 528.9395,-151.6962"/>
<polygon fill="#5cff00" stroke="#5cff00" points="529.4965,-155.1577 539.0906,-150.6628 528.7875,-148.1937 529.4965,-155.1577"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M435.8107,-175.9796C449.9431,-180.2761 466.2213,-185.2727 480.9653,-189.9159 527.6532,-204.6187 537.0169,-219.0158 585.7192,-223.9159"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M585.7192,-223.9159C643.9281,-229.7725 796.5256,-210.373 848.6605,-236.9159"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M451.7733,-231.8669C489.1551,-225.418 540.5131,-219.3675 585.7192,-223.9159"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M585.7192,-361.9159C668.0554,-352.3487 683.7085,-326.9804 757.3418,-288.9159 798.831,-267.4682 806.8999,-216.0017 848.6605,-236.9159"/>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M440.3806,-295.0166C453.5197,-298.9475 468.0027,-303.7029 480.9653,-308.9159 529.3745,-328.3838 533.9931,-368.7606 585.7192,-361.9159"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilesolarreflectionmanagerf90EfferentGraph = svgPanZoom('#sourcefilesolarreflectionmanagerf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~solarreflectionmanager.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilesolarreflectionmanagerf90AfferentGraph" width="641pt" height="94pt"
 viewBox="0.00 0.00 641.00 94.45" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph" class="graph" transform="scale(.4328 .4328) rotate(0) translate(4 214.2178)">
<title>sourcefile~~solarreflectionmanager.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-214.2178 1476.9678,-214.2178 1476.9678,4 -4,4"/>
<!-- sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~solarreflectionmanager.f90</title>
<polygon fill="none" stroke="#000000" points="141.3762,-162.2232 .2075,-162.2232 .2075,-140.2124 141.3762,-140.2124 141.3762,-162.2232"/>
<text text-anchor="middle" x="70.7919" y="-148.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">SolarReflectionManager.f90</text>
</g>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/daylightingmanager.f90.html" xlink:title="DaylightingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="300.0745,-143.2232 177.4199,-143.2232 177.4199,-121.2124 300.0745,-121.2124 300.0745,-143.2232"/>
<text text-anchor="middle" x="238.7472" y="-129.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M141.5333,-143.2152C150.1033,-142.2457 158.862,-141.2548 167.4401,-140.2844"/>
<polygon fill="#ff0000" stroke="#ff0000" points="167.8619,-143.7591 177.405,-139.1571 167.075,-136.8035 167.8619,-143.7591"/>
</g>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~solarshading.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/solarshading.f90.html" xlink:title="SolarShading.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.1927,-182.2232 551.071,-182.2232 551.071,-160.2124 643.1927,-160.2124 643.1927,-182.2232"/>
<text text-anchor="middle" x="597.1318" y="-168.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarShading.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M141.5031,-153.9047C247.136,-157.9186 444.0352,-165.4004 540.6758,-169.0726"/>
<polygon fill="#ff0000" stroke="#ff0000" points="540.7054,-172.5761 550.8311,-169.4585 540.9713,-165.5812 540.7054,-172.5761"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.7025,-132.2178C456.3584,-134.7536 511.9334,-147.2884 550.167,-157.473"/>
<polygon fill="#ff0000" stroke="#ff0000" points="549.4171,-160.896 559.9848,-160.1382 551.251,-154.1405 549.4171,-160.896"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="883.3052,-124.2232 716.9238,-124.2232 716.9238,-102.2124 883.3052,-102.2124 883.3052,-124.2232"/>
<text text-anchor="middle" x="800.1145" y="-110.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.7025,-132.2178C491.2276,-136.5342 512.4974,-131.8491 597.1318,-132.2178"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M300.21,-130.7166C332.0173,-130.32 371.4661,-130.4184 406.7025,-132.2178"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1472.7787,-183.2232 1376.5365,-183.2232 1376.5365,-161.2124 1472.7787,-161.2124 1472.7787,-183.2232"/>
<text text-anchor="middle" x="1424.6576" y="-169.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M268.4767,-143.2279C329.2843,-164.7286 472.645,-210.2178 597.1318,-210.2178 597.1318,-210.2178 597.1318,-210.2178 984.7119,-210.2178 1074.3404,-210.2178 1096.0973,-198.0388 1184.9429,-186.2178 1227.5544,-180.5483 1237.749,-175.0126 1280.6451,-172.2178"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="477.2869,-104.2232 336.1182,-104.2232 336.1182,-82.2124 477.2869,-82.2124 477.2869,-104.2232"/>
<text text-anchor="middle" x="406.7025" y="-90.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286.4272,-121.1463C306.0131,-116.5983 328.8608,-111.293 349.35,-106.5353"/>
<polygon fill="#ff0000" stroke="#ff0000" points="350.245,-109.9207 359.1942,-104.2494 348.6617,-103.1021 350.245,-109.9207"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M635.7891,-160.1719C668.6984,-150.7685 716.1391,-137.2128 751.5954,-127.0816"/>
<polygon fill="#00ffff" stroke="#00ffff" points="752.6024,-130.434 761.256,-124.3212 750.6792,-123.7034 752.6024,-130.434"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1135.4535,-172.2178C1199.8533,-168.127 1216.252,-176.4132 1280.6451,-172.2178"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1280.6451,-172.2178C1308.7277,-170.3881 1339.956,-170.1674 1366.1348,-170.4945"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1366.221,-173.9961 1376.2739,-170.6512 1366.3293,-166.997 1366.221,-173.9961"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1049.7172,-105.2232 919.7066,-105.2232 919.7066,-83.2124 1049.7172,-83.2124 1049.7172,-105.2232"/>
<text text-anchor="middle" x="984.7119" y="-91.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M800.1145,-172.2178C860.5424,-166.0546 924.4042,-132.0206 958.9118,-110.9966"/>
<polygon fill="#00ffff" stroke="#00ffff" points="961.1949,-113.6985 967.839,-105.4458 957.4986,-107.7539 961.1949,-113.6985"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M643.2178,-174.23C684.4474,-176.2629 746.4748,-177.6886 800.1145,-172.2178"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1340.5504,-144.2232 1220.7399,-144.2232 1220.7399,-122.2124 1340.5504,-122.2124 1340.5504,-144.2232"/>
<text text-anchor="middle" x="1280.6451" y="-130.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1135.4535,-172.2178C1172.843,-169.7182 1213.9613,-157.7557 1242.8658,-147.7306"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1244.3057,-150.9333 1252.5542,-144.284 1241.9595,-144.3382 1244.3057,-150.9333"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M800.1145,-172.2178C948.3849,-157.0953 986.7459,-182.1593 1135.4535,-172.2178"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M883.5022,-104.635C892.2237,-103.7373 901.0525,-102.8286 909.6729,-101.9413"/>
<polygon fill="#ff0000" stroke="#ff0000" points="910.0889,-105.4171 919.678,-100.9115 909.3721,-98.4539 910.0889,-105.4171"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M883.5031,-117.9705C951.3608,-121.8911 1049.6064,-127.6882 1135.4535,-133.2178"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M445.147,-104.2784C455.9197,-108.0428 467.4299,-112.7162 477.4944,-118.2178 495.2803,-127.9403 495.4756,-136.9341 513.4944,-146.2178 522.0934,-150.6482 531.6038,-154.4235 541.0365,-157.5949"/>
<polygon fill="#0000ff" stroke="#0000ff" points="540.2068,-161.0033 550.7968,-160.6834 542.3187,-154.3295 540.2068,-161.0033"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M440.3324,-104.3024C478.0554,-115.746 541.2813,-131.9745 597.1318,-132.2178"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M597.1318,-132.2178C634.3388,-132.3799 675.2162,-129.205 710.4756,-125.4064"/>
<polygon fill="#0000ff" stroke="#0000ff" points="711.1915,-128.8485 720.744,-124.2659 710.4187,-121.8913 711.1915,-128.8485"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M800.1145,-13.2178C860.3868,-22.8741 924.2172,-56.9709 958.7805,-77.7231"/>
<polygon fill="#0000ff" stroke="#0000ff" points="956.9633,-80.7144 967.3218,-82.9398 960.612,-74.7405 956.9633,-80.7144"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M421.2653,-81.9985C440.9501,-67.5431 477.7169,-42.9951 513.4944,-32.2178 635.7351,4.6048 674.0558,6.9782 800.1145,-13.2178"/>
</g>
<!-- sourcefile~windowmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~windowmanager.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/windowmanager.f90.html" xlink:title="WindowManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="650.8575,-63.2232 543.4061,-63.2232 543.4061,-41.2124 650.8575,-41.2124 650.8575,-63.2232"/>
<text text-anchor="middle" x="597.1318" y="-49.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M457.9846,-82.1766C482.0057,-77.0048 510.8048,-70.8043 535.9551,-65.3893"/>
<polygon fill="#0000ff" stroke="#0000ff" points="536.7189,-68.8052 545.7582,-63.2787 535.2455,-61.962 536.7189,-68.8052"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~heatbalanceintradexchange.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/heatbalanceintradexchange.f90.html" xlink:title="HeatBalanceIntRadExchange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="680.907,-104.2232 513.3567,-104.2232 513.3567,-82.2124 680.907,-82.2124 680.907,-104.2232"/>
<text text-anchor="middle" x="597.1318" y="-90.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceIntRadExchange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M477.3408,-93.2178C485.7854,-93.2178 494.507,-93.2178 503.2141,-93.2178"/>
<polygon fill="#0000ff" stroke="#0000ff" points="503.4114,-96.7179 513.4114,-93.2178 503.4113,-89.7179 503.4114,-96.7179"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1013.9178,-105.2863C1043.898,-115.8073 1092.1567,-130.429 1135.4535,-133.2178"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1135.4535,-133.2178C1159.9951,-134.7986 1186.9185,-135.1745 1210.8439,-135.0343"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1210.9301,-138.5337 1220.8985,-134.9446 1210.8676,-131.534 1210.9301,-138.5337"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1184.9323,-105.2232 1085.9747,-105.2232 1085.9747,-83.2124 1184.9323,-83.2124 1184.9323,-105.2232"/>
<text text-anchor="middle" x="1135.4535" y="-91.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1049.9526,-94.2178C1058.438,-94.2178 1067.0978,-94.2178 1075.4913,-94.2178"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1075.5679,-97.7179 1085.5678,-94.2178 1075.5678,-90.7179 1075.5679,-97.7179"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1321.5281,-144.2893C1337.7944,-148.6944 1356.6846,-153.81 1373.8195,-158.4503"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1373.1052,-161.8829 1383.6724,-161.1186 1374.935,-155.1263 1373.1052,-161.8829"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~solarreflectionmanager.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1466.3661,-142.2232 1382.9491,-142.2232 1382.9491,-120.2124 1466.3661,-120.2124 1466.3661,-142.2232"/>
<text text-anchor="middle" x="1424.6576" y="-128.0678" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1340.4683,-132.387C1351.1329,-132.2389 1362.1647,-132.0857 1372.591,-131.9409"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1372.8291,-135.438 1382.7795,-131.7994 1372.7319,-128.4387 1372.8291,-135.438"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1176.6712,-105.2893C1193.1408,-109.7132 1212.2784,-114.8538 1229.6122,-119.5098"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1229.0102,-122.9721 1239.5758,-122.1861 1230.8261,-116.2117 1229.0102,-122.9721"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M643.756,-63.2453C655.859,-66.2933 668.8435,-69.7277 680.7693,-73.2178 707.3785,-81.0049 736.9266,-90.8983 759.9645,-98.8976"/>
<polygon fill="#ff0000" stroke="#ff0000" points="758.817,-102.2041 769.4118,-102.1982 761.1258,-95.5957 758.817,-102.2041"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M637.2101,-41.143C687.0682,-27.9574 769.3766,-8.2933 800.1145,-13.2178"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~solarreflectionmanager.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M680.8646,-101.468C689.4202,-102.311 698.1497,-103.1711 706.7994,-104.0234"/>
<polygon fill="#00ffff" stroke="#00ffff" points="706.6066,-107.5213 716.9016,-105.0188 707.293,-100.555 706.6066,-107.5213"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilesolarreflectionmanagerf90AfferentGraph = svgPanZoom('#sourcefilesolarreflectionmanagerf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/solarreflectionmanager.html">SolarReflectionManager</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html#src">SolarReflectionManager.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">SolarReflectionManager</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! MODULE INFORMATION</span>
<a name="ln-4"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5"></a>          <span class="c">!       DATE WRITTEN   September 2003</span>
<a name="ln-6"></a>          <span class="c">!       MODIFIED       May 2004, FCW: modify calculation of receiving point location on a</span>
<a name="ln-7"></a>          <span class="c">!                        receiving surface so can handle surface of any number of vertices</span>
<a name="ln-8"></a>          <span class="c">!                        (previously restricted to 3- or 4-sided surfaces).</span>
<a name="ln-9"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10"></a>
<a name="ln-11"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-12"></a>          <span class="c">! Manages the calculation of factors for solar reflected from obstructions and ground.</span>
<a name="ln-13"></a>
<a name="ln-14"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15"></a>          <span class="c">!</span>
<a name="ln-16"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-17"></a>
<a name="ln-18"></a>          <span class="c">! OTHER NOTES: na</span>
<a name="ln-19"></a>
<a name="ln-20"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-21"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-22"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-23"></a><span class="k">USE </span><span class="n">DataHeatBalance</span>
<a name="ln-24"></a><span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-25"></a><span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-26"></a><span class="k">USE </span><span class="n">DataEnvironment</span>
<a name="ln-27"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-28"></a>
<a name="ln-29"></a><span class="k">USE </span><span class="n">DataVectorTypes</span>
<a name="ln-30"></a>
<a name="ln-31"></a><span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-32"></a>
<a name="ln-33"></a><span class="k">PRIVATE</span>  <span class="c">! Only certain items will be declared public</span>
<a name="ln-34"></a>
<a name="ln-35"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:na</span>
<a name="ln-36"></a>
<a name="ln-37"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-38"></a>
<a name="ln-39"></a><span class="k">TYPE</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">SolReflRecSurfData</span>
<a name="ln-40"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">SurfNum</span>      <span class="o">=</span><span class="mi">0</span>   <span class="c">! Number of heat transfer surface</span>
<a name="ln-41"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SurfName</span>     <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Name of heat transfer surface</span>
<a name="ln-42"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">NumRecPts</span>    <span class="o">=</span><span class="mi">0</span>   <span class="c">! Number of receiving points</span>
<a name="ln-43"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:)</span>   <span class="kd">::</span> <span class="n">RecPt</span>        <span class="c">! Coordinates of receiving point on receiving surface in global CS (m)</span>
<a name="ln-44"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">NormVec</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Unit outward normal to receiving surface</span>
<a name="ln-45"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">ThetaNormVec</span> <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Azimuth of surface normal (radians)</span>
<a name="ln-46"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">PhiNormVec</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Altitude of surface normal (radians)</span>
<a name="ln-47"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">NumReflRays</span>  <span class="o">=</span><span class="mi">0</span>   <span class="c">! Number of rays from this receiving surface</span>
<a name="ln-48"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:)</span>   <span class="kd">::</span> <span class="n">RayVec</span>       <span class="c">! Unit vector in direction of ray from receiving surface</span>
<a name="ln-49"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span>     <span class="kd">::</span> <span class="n">CosIncAngRay</span> <span class="c">! Cosine of angle between ray and receiving surface outward normal</span>
<a name="ln-50"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span>     <span class="kd">::</span> <span class="n">dOmegaRay</span>    <span class="c">! Delta solid angle associated with ray</span>
<a name="ln-51"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">HitPt</span>        <span class="c">! For each receiving point and ray, coords of hit point on obstruction</span>
<a name="ln-52"></a>                                                    <span class="c">! that is closest to receiving point (m)</span>
<a name="ln-53"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:)</span><span class="kd">::</span> <span class="n">HitPtSurfNum</span> <span class="c">! Number of surface containing the hit point for a ray, except:</span>
<a name="ln-54"></a>                                                    <span class="c">!  0 =&gt; ray does not hit an obstruction, but hits sky</span>
<a name="ln-55"></a>                                                    <span class="c">!  -1 =&gt; ray does not hit an obstruction, but hits ground</span>
<a name="ln-56"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:)</span>   <span class="kd">::</span> <span class="n">HitPtSolRefl</span> <span class="c">! Beam-to-diffuse solar reflectance at hit point</span>
<a name="ln-57"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:)</span>   <span class="kd">::</span> <span class="n">RecPtHitPtDis</span> <span class="c">! Distance from receiving point to hit point (m)</span>
<a name="ln-58"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:,:,:)</span> <span class="kd">::</span> <span class="n">HitPtNormVec</span> <span class="c">! Hit point&#39;s surface normal unit vector pointing into hemisphere</span>
<a name="ln-59"></a>                                                    <span class="c">!  containing the receiving point</span>
<a name="ln-60"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(:)</span>  <span class="kd">::</span> <span class="n">PossibleObsSurfNums</span> <span class="c">! Surface numbers of possible obstructions for a receiving surf</span>
<a name="ln-61"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">NumPossibleObs</span>      <span class="o">=</span><span class="mi">0</span> <span class="c">! Number of possible obstructions for a receiving surface</span>
<a name="ln-62"></a><span class="k">END TYPE </span><span class="n">SolReflRecSurfData</span>
<a name="ln-63"></a>
<a name="ln-64"></a><span class="k">TYPE</span><span class="p">(</span><span class="n">SolReflRecSurfData</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SolReflRecSurf</span>
<a name="ln-65"></a>
<a name="ln-66"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-67"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotSolReflRecSurf</span>      <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Total number of exterior surfaces that can receive reflected solar</span>
<a name="ln-68"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotPhiReflRays</span>         <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Number of rays in altitude angle (-90 to 90 deg) for diffuse refl calc</span>
<a name="ln-69"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotThetaReflRays</span>       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Number of rays in azimuth angle (0 to 180 deg) for diffuse refl calc</span>
<a name="ln-70"></a>
<a name="ln-71"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE ExteriorSolarReflectionManager</span>
<a name="ln-72"></a><span class="k">PUBLIC  </span><span class="n">InitSolReflRecSurf</span>
<a name="ln-73"></a><span class="k">PUBLIC  </span><span class="n">CalcBeamSolDiffuseReflFactors</span>
<a name="ln-74"></a><span class="k">PRIVATE </span><span class="n">FigureBeamSolDiffuseReflFactors</span>
<a name="ln-75"></a><span class="k">PUBLIC  </span><span class="n">CalcBeamSolSpecularReflFactors</span>
<a name="ln-76"></a><span class="k">PRIVATE </span><span class="n">FigureBeamSolSpecularReflFactors</span>
<a name="ln-77"></a><span class="k">PUBLIC  </span><span class="n">CalcSkySolDiffuseReflFactors</span>
<a name="ln-78"></a><span class="k">PRIVATE </span><span class="n">PierceSurface</span>
<a name="ln-79"></a><span class="k">PRIVATE </span><span class="n">CrossProduct</span>
<a name="ln-80"></a>
<a name="ln-81"></a><span class="k">CONTAINS</span>
<a name="ln-82"></a>
<a name="ln-83"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-84"></a>
<a name="ln-85"></a><span class="k">SUBROUTINE </span><span class="n">InitSolReflRecSurf</span>
<a name="ln-86"></a>
<a name="ln-87"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-88"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-89"></a>          <span class="c">!       DATE WRITTEN   September 2003</span>
<a name="ln-90"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-91"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-92"></a>
<a name="ln-93"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-94"></a>          <span class="c">! Initializes the derived type SolReflRecSurf, which contains information</span>
<a name="ln-95"></a>          <span class="c">! needed to calculate factors for solar reflection from obstructions and ground.</span>
<a name="ln-96"></a>
<a name="ln-97"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-98"></a>
<a name="ln-99"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-100"></a>
<a name="ln-101"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-102"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-103"></a>
<a name="ln-104"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-105"></a>
<a name="ln-106"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-107"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-108"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-109"></a>
<a name="ln-110"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-111"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SurfNum</span>              <span class="c">! Surface number</span>
<a name="ln-112"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RecSurfNum</span>           <span class="c">! Receiving surface number</span>
<a name="ln-113"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loop</span>                 <span class="c">! DO loop indices</span>
<a name="ln-114"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loop1</span>                <span class="c">! DO loop indices</span>
<a name="ln-115"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loopA</span>                <span class="c">! DO loop indices</span>
<a name="ln-116"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">loopb</span>                <span class="c">! DO loop indices</span>
<a name="ln-117"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>           <span class="c">! Surface number of an obstruction</span>
<a name="ln-118"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ObsBehindRec</span>         <span class="c">! True if an obstruction is entirely behind a receiving surface</span>
<a name="ln-119"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ObsHasView</span>           <span class="c">! True if view between receiving surface and heat trans surf obstruction</span>
<a name="ln-120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RecVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>            <span class="c">! First vertex of a receiving surface (m)</span>
<a name="ln-121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>            <span class="c">! A vertex of a candidate obstructing surface (m)</span>
<a name="ln-122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VecAB</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Vector from receiving surface vertex to obstruction surface vertex (m)</span>
<a name="ln-123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Hit point (m)</span>
<a name="ln-124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DotProd</span>              <span class="c">! Dot product of vectors (m2)</span>
<a name="ln-125"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RecPtNum</span>             <span class="c">! Receiving point number</span>
<a name="ln-126"></a><span class="c">!unused  REAL(r64)         :: SumX                 ! Sum of X (or Y or Z) coordinate values of a surface</span>
<a name="ln-127"></a><span class="c">!unused  REAL(r64)         :: SumY                 ! Sum of X (or Y or Z) coordinate values of a surface</span>
<a name="ln-128"></a><span class="c">!unused  REAL(r64)         :: SumZ                 ! Sum of X (or Y or Z) coordinate values of a surface</span>
<a name="ln-129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PhiSurf</span>              <span class="c">! Altitude of normal to receiving surface (radians)</span>
<a name="ln-130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThetaSurf</span>            <span class="c">! Azimuth of normal to receiving surface (radians)</span>
<a name="ln-131"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PhiMin</span>               <span class="c">! Minimum and maximum values of ray altitude angle (radians)</span>
<a name="ln-132"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PhiMax</span>               <span class="c">! Minimum and maximum values of ray altitude angle (radians)</span>
<a name="ln-133"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThetaMin</span>             <span class="c">! Minimum and maximum values of ray azimuth angle (radians)</span>
<a name="ln-134"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThetaMax</span>             <span class="c">! Minimum and maximum values of ray azimuth angle (radians)</span>
<a name="ln-135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Phi</span>                  <span class="c">! Ray altitude angle, increment, sine, and cosine</span>
<a name="ln-136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DPhi</span>                 <span class="c">! Ray altitude angle, increment, sine, and cosine</span>
<a name="ln-137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPhi</span>                 <span class="c">! Ray altitude angle, increment, sine, and cosine</span>
<a name="ln-138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CPhi</span>                 <span class="c">! Ray altitude angle, increment, sine, and cosine</span>
<a name="ln-139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Theta</span>                <span class="c">! Ray azimuth angle and increment</span>
<a name="ln-140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DTheta</span>               <span class="c">! Ray azimuth angle and increment</span>
<a name="ln-141"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IPhi</span>                 <span class="c">! Ray altitude angle and azimuth angle indices</span>
<a name="ln-142"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ITheta</span>               <span class="c">! Ray altitude angle and azimuth angle indices</span>
<a name="ln-143"></a><span class="c">!unused  REAL(r64)         :: APhi                 ! Intermediate variable</span>
<a name="ln-144"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RayNum</span>               <span class="c">! Ray number</span>
<a name="ln-145"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">URay</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>              <span class="c">! Unit vector along ray pointing away from receiving surface</span>
<a name="ln-146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncAngRay</span>         <span class="c">! Cosine of angle of incidence of ray on receiving surface</span>
<a name="ln-147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dOmega</span>               <span class="c">! Solid angle associated with a ray</span>
<a name="ln-148"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHit</span>                 <span class="c">! = 1 if obstruction is hit, 0 otherwise</span>
<a name="ln-149"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TotObstructionsHit</span>   <span class="c">! Number of obstructions hit by a ray</span>
<a name="ln-150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitDistance</span>          <span class="c">! Distance from receiving point to hit point for a ray (m)</span>
<a name="ln-151"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NearestHitSurfNum</span>    <span class="c">! Surface number of nearest obstruction hit by a ray</span>
<a name="ln-152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NearestHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>      <span class="c">! Nearest hit pit for a ray (m)</span>
<a name="ln-153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NearestHitDistance</span>   <span class="c">! Distance from receiving point to nearest hit point for a ray (m)</span>
<a name="ln-154"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNumToSkip</span>     <span class="c">! Surface number of obstruction to be ignored</span>
<a name="ln-155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RecPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! Receiving point (m)</span>
<a name="ln-156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RayVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>            <span class="c">! Unit vector along ray</span>
<a name="ln-157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Vec1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>              <span class="c">! Vectors between hit surface vertices (m)</span>
<a name="ln-158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Vec2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>              <span class="c">! Vectors between hit surface vertices (m)</span>
<a name="ln-159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VNorm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c">! For a hit surface, unit normal vector pointing into the hemisphere</span>
<a name="ln-160"></a>                                    <span class="c">! containing the receiving point</span>
<a name="ln-161"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsConstrNum</span>         <span class="c">! Construction number of obstruction; = 0 if a shading surface</span>
<a name="ln-162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Alfa</span><span class="p">,</span><span class="n">Beta</span>            <span class="c">! Direction angles for ray heading towards the ground (radians)</span>
<a name="ln-163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HorDis</span>               <span class="c">! Distance between ground hit point and proj&#39;n of receiving pt onto ground (m)</span>
<a name="ln-164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>       <span class="c">! Coordinates of ground hit point</span>
<a name="ln-165"></a><span class="c">!unused  REAL(r64)         :: ArgASin</span>
<a name="ln-166"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ACosTanTan</span>
<a name="ln-167"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">J</span>                    <span class="c">! DO loop indices</span>
<a name="ln-168"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">K</span>                    <span class="c">! DO loop indices</span>
<a name="ln-169"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">L</span>                    <span class="c">! DO loop indices</span>
<a name="ln-170"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumRecPts</span>            <span class="c">! Number of surface receiving points for reflected solar radiation</span>
<a name="ln-171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VertexWt</span>             <span class="c">! Vertex weighting factor for calculating receiving points</span>
<a name="ln-172"></a>
<a name="ln-173"></a>          <span class="c">! FLOW:</span>
<a name="ln-174"></a>
<a name="ln-175"></a><span class="c">! Find number of surfaces that are sun-exposed exterior building heat transfer surfaces.</span>
<a name="ln-176"></a><span class="c">! These are candidates for receiving solar reflected from obstructions and ground.</span>
<a name="ln-177"></a><span class="c">! CR 7640.  12/3/2008 BG simplified logic to allow for Other Side Conditions Modeled boundary condition.</span>
<a name="ln-178"></a><span class="c">!           and solar collectors on shading surfaces that need this.</span>
<a name="ln-179"></a><span class="c">!</span>
<a name="ln-180"></a>
<a name="ln-181"></a><span class="c">! shading surfaces have ExtSolar = False, so they are not included in TotSolReflRecSurf</span>
<a name="ln-182"></a><span class="n">TotSolReflRecSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-183"></a><span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-184"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-185"></a><span class="k">    </span><span class="n">TotSolReflRecSurf</span> <span class="o">=</span> <span class="n">TotSolReflRecSurf</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-186"></a>  <span class="n">ENDIF</span>
<a name="ln-187"></a><span class="k">END DO</span>
<a name="ln-188"></a>
<a name="ln-189"></a><span class="c">! TH 3/29/2010. ShadowSurfPossibleReflector is not used!</span>
<a name="ln-190"></a><span class="c">! Set flag that determines whether a surface can be an exterior reflector</span>
<a name="ln-191"></a><span class="c">!DO SurfNum = 1,TotSurfaces</span>
<a name="ln-192"></a><span class="c">!  Surface(SurfNum)%ShadowSurfPossibleReflector = .FALSE.</span>
<a name="ln-193"></a>  <span class="c">! Exclude non-exterior heat transfer surfaces (but not OtherSideCondModeledExt = -4 CR7640)</span>
<a name="ln-194"></a><span class="c">!  IF(Surface(SurfNum)%HeatTransSurf .AND. Surface(SurfNum)%ExtBoundCond &gt; 0 ) CYCLE</span>
<a name="ln-195"></a><span class="c">!  IF(Surface(SurfNum)%HeatTransSurf .AND. Surface(SurfNum)%ExtBoundCond == Ground) CYCLE</span>
<a name="ln-196"></a><span class="c">!  IF(Surface(SurfNum)%HeatTransSurf .AND. Surface(SurfNum)%ExtBoundCond == OtherSideCoefNoCalcExt) CYCLE</span>
<a name="ln-197"></a><span class="c">!  IF(Surface(SurfNum)%HeatTransSurf .AND. Surface(SurfNum)%ExtBoundCond == OtherSideCoefCalcExt) CYCLE</span>
<a name="ln-198"></a>
<a name="ln-199"></a>  <span class="c">! Exclude daylighting shelves. A separate solar reflection calculation is done for these.</span>
<a name="ln-200"></a><span class="c">!  IF(Surface(SurfNum)%Shelf &gt; 0) CYCLE</span>
<a name="ln-201"></a>
<a name="ln-202"></a>  <span class="c">! Exclude duplicate shading surfaces</span>
<a name="ln-203"></a>  <span class="c">! TH 3/24/2010. Why? a mirror shading surface can reflect solar (either beam or diffuse)</span>
<a name="ln-204"></a>  <span class="c">!  can use a flag like Surface(SurfNum)%Mirrored (True or False) to avoid string comparison</span>
<a name="ln-205"></a>  <span class="c">!   and to allow surface names starting with &#39;Mir&#39;</span>
<a name="ln-206"></a>  <span class="c">!IF(Surface(SurfNum)%Name(1:3) == &#39;Mir&#39;) CYCLE</span>
<a name="ln-207"></a><span class="c">!  IF(Surface(SurfNum)%MirroredSurf) CYCLE</span>
<a name="ln-208"></a>
<a name="ln-209"></a><span class="c">!  Surface(SurfNum)%ShadowSurfPossibleReflector = .TRUE.</span>
<a name="ln-210"></a><span class="c">!END DO</span>
<a name="ln-211"></a>
<a name="ln-212"></a><span class="k">IF</span><span class="p">(</span><span class="n">TotSolReflRecSurf</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-213"></a><span class="k">  CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Calculation of solar reflected from obstructions has been requested but there&#39;</span><span class="p">)</span>
<a name="ln-214"></a>  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;are no building surfaces that can receive reflected solar. Calculation will not be done.&#39;</span><span class="p">)</span>
<a name="ln-215"></a>  <span class="n">CalcSolRefl</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-216"></a>  <span class="k">RETURN</span>
<a name="ln-217"></a><span class="k">END IF</span>
<a name="ln-218"></a>
<a name="ln-219"></a><span class="c">! Should this be moved up front?</span>
<a name="ln-220"></a><span class="k">IF</span> <span class="p">(</span><span class="n">IgnoreSolarRadiation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-221"></a><span class="k">  </span><span class="n">TotSolReflRecSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-222"></a>  <span class="n">CalcSolRefl</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-223"></a>  <span class="k">RETURN</span>
<a name="ln-224"></a><span class="n">ENDIF</span>
<a name="ln-225"></a>
<a name="ln-226"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">TotSolReflRecSurf</span><span class="p">))</span>
<a name="ln-227"></a>
<a name="ln-228"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ReflFacBmToDiffSolObs</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-229"></a><span class="n">ReflFacBmToDiffSolObs</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-230"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ReflFacBmToDiffSolGnd</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-231"></a><span class="n">ReflFacBmToDiffSolGnd</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-232"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ReflFacBmToBmSolObs</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-233"></a><span class="n">ReflFacBmToBmSolObs</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-234"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ReflFacSkySolObs</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-235"></a><span class="n">ReflFacSkySolObs</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-236"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ReflFacSkySolGnd</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-237"></a><span class="n">ReflFacSkySolGnd</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-238"></a><span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CosIncAveBmToBmSolObs</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-239"></a><span class="n">CosIncAveBmToBmSolObs</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-240"></a>
<a name="ln-241"></a><span class="c">! Only surfaces with sun exposure can receive solar reflection from ground or onstructions</span>
<a name="ln-242"></a><span class="c">!  Shading surfaces are always not exposed to solar (ExtSolar = False)</span>
<a name="ln-243"></a><span class="n">RecSurfNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-244"></a><span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-245"></a>  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfRecSurfNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-246"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-247"></a><span class="k">    </span><span class="n">RecSurfNum</span> <span class="o">=</span> <span class="n">RecSurfNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-248"></a>    <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfNum</span>
<a name="ln-249"></a>    <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">SurfName</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span>
<a name="ln-250"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowSurfRecSurfNum</span> <span class="o">=</span> <span class="n">RecSurfNum</span>
<a name="ln-251"></a>
<a name="ln-252"></a>    <span class="c">! Warning if any receiving surface vertex is below ground level, taken to be at Z = 0 in absolute coords</span>
<a name="ln-253"></a>    <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-254"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)%</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="n">GroundLevelZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-255"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Calculation of reflected solar onto surface=&#39;</span> <span class="p">&amp;</span>
<a name="ln-256"></a>               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; may be inaccurate&#39;</span><span class="p">)</span>
<a name="ln-257"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;because it has one or more vertices below ground level.&#39;</span><span class="p">)</span>
<a name="ln-258"></a>        <span class="k">EXIT</span>
<a name="ln-259"></a><span class="k">      END IF</span>
<a name="ln-260"></a><span class="k">    END DO</span>
<a name="ln-261"></a><span class="k">  END IF</span>
<a name="ln-262"></a><span class="k">END DO</span>
<a name="ln-263"></a>
<a name="ln-264"></a><span class="c">! Get MaxRecPts for allocating SolReflRecSurf arrays that depend on number of receiving points</span>
<a name="ln-265"></a><span class="n">MaxRecPts</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-266"></a><span class="k">DO </span><span class="n">RecSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSolReflRecSurf</span>
<a name="ln-267"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-268"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span> <span class="o">&gt;</span> <span class="n">MaxRecPts</span><span class="p">)</span> <span class="n">MaxRecPts</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span>
<a name="ln-269"></a><span class="k">END DO</span>
<a name="ln-270"></a>
<a name="ln-271"></a><span class="n">MaxReflRays</span> <span class="o">=</span> <span class="n">AltAngStepsForSolReflCalc</span> <span class="o">*</span> <span class="n">AzimAngStepsForSolReflCalc</span>
<a name="ln-272"></a><span class="k">DO </span><span class="n">RecSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSolReflRecSurf</span>
<a name="ln-273"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-274"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">MaxRecPts</span><span class="p">))</span>
<a name="ln-275"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-276"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RayVec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">MaxReflRays</span><span class="p">))</span>
<a name="ln-277"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RayVec</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-278"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">CosIncAngRay</span><span class="p">(</span><span class="n">MaxReflRays</span><span class="p">))</span>
<a name="ln-279"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">CosIncAngRay</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-280"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">dOmegaRay</span><span class="p">(</span><span class="n">MaxReflRays</span><span class="p">))</span>
<a name="ln-281"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">dOmegaRay</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-282"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">MaxRecPts</span><span class="p">,</span><span class="n">MaxReflRays</span><span class="p">))</span>
<a name="ln-283"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPt</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-284"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSurfNum</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">,</span><span class="n">MaxReflRays</span><span class="p">))</span>
<a name="ln-285"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSurfNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-286"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSolRefl</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">,</span><span class="n">MaxReflRays</span><span class="p">))</span>
<a name="ln-287"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSolRefl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-288"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPtHitPtDis</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">,</span><span class="n">MaxReflRays</span><span class="p">))</span>
<a name="ln-289"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPtHitPtDis</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-290"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtNormVec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">MaxRecPts</span><span class="p">,</span><span class="n">MaxReflRays</span><span class="p">))</span>
<a name="ln-291"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtNormVec</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-292"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-293"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-294"></a><span class="k">END DO</span>
<a name="ln-295"></a>
<a name="ln-296"></a><span class="k">DO </span><span class="n">RecSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSolReflRecSurf</span>
<a name="ln-297"></a>  <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">SurfNum</span>
<a name="ln-298"></a>  <span class="c">! Outward norm to receiving surface</span>
<a name="ln-299"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-300"></a>  <span class="n">RecVec</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-301"></a>  <span class="c">! Loop over all surfaces and find those that can be obstructing surfaces for this receiving surf</span>
<a name="ln-302"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-303"></a>  <span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-304"></a>    <span class="c">! Exclude the receiving surface itself and its base surface (if it has one)</span>
<a name="ln-305"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">SurfNum</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-306"></a>    <span class="c">! Exclude non-exterior heat transfer surfaces</span>
<a name="ln-307"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-308"></a>    <span class="c">! Exclude duplicate shading surfaces</span>
<a name="ln-309"></a>    <span class="c">!IF(Surface(ObsSurfNum)%Name(1:3) == &#39;Mir&#39;) CYCLE</span>
<a name="ln-310"></a>    <span class="c">!TH2 CR8959</span>
<a name="ln-311"></a>    <span class="c">!IF(Surface(ObsSurfNum)%MirroredSurf) CYCLE</span>
<a name="ln-312"></a>
<a name="ln-313"></a>    <span class="c">! Exclude surfaces that are entirely behind the receiving surface.This is true if dot products of the</span>
<a name="ln-314"></a>    <span class="c">! rec. surface outward normal and vector from first vertex of rec. surface and each vertex of</span>
<a name="ln-315"></a>    <span class="c">! obstructing surface are all negative.</span>
<a name="ln-316"></a>    <span class="n">ObsBehindRec</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-317"></a>    <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-318"></a>      <span class="n">ObsVec</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-319"></a>      <span class="n">DotProd</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span><span class="p">,</span><span class="n">ObsVec</span><span class="o">-</span><span class="n">RecVec</span><span class="p">)</span>
<a name="ln-320"></a><span class="c">!CR8251      IF(DotProd &gt; 0.01d0) THEN  ! This obstructing-surface vertex is not behind receiving surface</span>
<a name="ln-321"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">DotProd</span> <span class="o">&gt;</span> <span class="mf">1.d-6</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! This obstructing-surface vertex is not behind receiving surface</span>
<a name="ln-322"></a>        <span class="n">ObsBehindRec</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-323"></a>        <span class="k">EXIT</span>
<a name="ln-324"></a><span class="k">      END IF</span>
<a name="ln-325"></a><span class="k">    END DO</span>
<a name="ln-326"></a><span class="k">    IF</span><span class="p">(</span><span class="n">ObsBehindRec</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-327"></a>
<a name="ln-328"></a>    <span class="c">! Exclude heat transfer surfaces that have no view with the receiving surface.</span>
<a name="ln-329"></a>    <span class="c">! There is view if: for at least one vector VecAB from a receiving surface vertex to</span>
<a name="ln-330"></a>    <span class="c">! a vertex of a potential obstructing surface that satisfies VecAB.nA &gt; 0.0 and VecAB.nB &lt; 0.0,</span>
<a name="ln-331"></a>    <span class="c">! where nA and nB are the outward normal to the receiving and obstructing surface, resp.</span>
<a name="ln-332"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-333"></a><span class="k">      </span><span class="n">ObsHasView</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-334"></a>      <span class="k">DO </span><span class="n">loopA</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-335"></a>        <span class="k">DO </span><span class="n">loopB</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-336"></a>          <span class="n">VecAB</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loopB</span><span class="p">)</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">loopA</span><span class="p">)</span>
<a name="ln-337"></a>          <span class="k">IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">VecAB</span><span class="p">,</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-338"></a>             <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">VecAB</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-339"></a><span class="k">               </span><span class="n">ObsHasView</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-340"></a>               <span class="k">EXIT</span>
<a name="ln-341"></a><span class="k">          END IF</span>
<a name="ln-342"></a><span class="k">        END DO</span>
<a name="ln-343"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ObsHasView</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-344"></a><span class="k">      END DO</span>
<a name="ln-345"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ObsHasView</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-346"></a><span class="k">    END IF</span>
<a name="ln-347"></a>
<a name="ln-348"></a>    <span class="c">! This is a possible obstructing surface for this receiving surface</span>
<a name="ln-349"></a>    <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-350"></a>    <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span><span class="p">)</span> <span class="o">=</span> <span class="n">ObsSurfNum</span>
<a name="ln-351"></a>  <span class="k">END DO</span>
<a name="ln-352"></a>
<a name="ln-353"></a>  <span class="c">! Get coordinates of receiving points on this receiving surface. The number of receiving points</span>
<a name="ln-354"></a>  <span class="c">! is equal to the number of surface vertices (3 or higher).</span>
<a name="ln-355"></a>
<a name="ln-356"></a>  <span class="n">NumRecPts</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span>
<a name="ln-357"></a>  <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumRecPts</span>
<a name="ln-358"></a>    <span class="k">DO </span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-359"></a>      <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-360"></a>    <span class="k">END DO</span>
<a name="ln-361"></a><span class="k">    DO </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumRecPts</span>
<a name="ln-362"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">NumRecPts</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Receiving surface is a triangle</span>
<a name="ln-363"></a>        <span class="n">VertexWt</span> <span class="o">=</span> <span class="mf">0.2d0</span>
<a name="ln-364"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">K</span> <span class="o">==</span> <span class="n">J</span><span class="p">)</span> <span class="n">VertexWt</span> <span class="o">=</span> <span class="mf">0.6d0</span>
<a name="ln-365"></a>      <span class="k">ELSE</span>                     <span class="c">! Receiving surface has 4 or more vertices</span>
<a name="ln-366"></a>        <span class="n">VertexWt</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumRecPts</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span>
<a name="ln-367"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">K</span> <span class="o">==</span> <span class="n">J</span><span class="p">)</span> <span class="n">VertexWt</span> <span class="o">=</span> <span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumRecPts</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">+</span><span class="mf">1.d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumRecPts</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span>
<a name="ln-368"></a>      <span class="k">END IF</span>
<a name="ln-369"></a><span class="k">        </span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-370"></a>          <span class="n">VertexWt</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">K</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-371"></a>        <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">J</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-372"></a>          <span class="n">VertexWt</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">K</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-373"></a>        <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">J</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-374"></a>          <span class="n">VertexWt</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">K</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-375"></a>    <span class="k">END DO</span>
<a name="ln-376"></a><span class="k">  END DO</span>
<a name="ln-377"></a>
<a name="ln-378"></a>  <span class="c">! Create rays going outward from receiving surface. The same rays will be used at each receiving point.</span>
<a name="ln-379"></a>  <span class="c">! The rays are used in calculating diffusely reflected solar incident on receiving surface.</span>
<a name="ln-380"></a>
<a name="ln-381"></a>  <span class="c">! Divide hemisphere around receiving surface into elements of altitude Phi and</span>
<a name="ln-382"></a>  <span class="c">! azimuth Theta and create ray unit vector at each Phi,Theta pair in front of the surface.</span>
<a name="ln-383"></a>  <span class="c">! Phi = 0 at the horizon; Phi = Pi/2 at the zenith</span>
<a name="ln-384"></a>
<a name="ln-385"></a>  <span class="n">PhiSurf</span> <span class="o">=</span> <span class="nb">ASIN</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-386"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1.0d-5</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1.0d-5</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-387"></a><span class="k">    </span><span class="n">ThetaSurf</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-388"></a>  <span class="k">ELSE</span>
<a name="ln-389"></a><span class="k">    </span><span class="n">ThetaSurf</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-390"></a>  <span class="k">END IF</span>
<a name="ln-391"></a><span class="k">  </span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">PhiNormVec</span>   <span class="o">=</span> <span class="n">PhiSurf</span>
<a name="ln-392"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">ThetaNormVec</span> <span class="o">=</span> <span class="n">ThetaSurf</span>
<a name="ln-393"></a>  <span class="n">PhiMin</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="o">-</span><span class="n">PiOvr2</span><span class="p">,</span> <span class="n">PhiSurf</span> <span class="o">-</span> <span class="n">PiOvr2</span><span class="p">)</span>
<a name="ln-394"></a>  <span class="n">PhiMax</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">PiOvr2</span><span class="p">,</span> <span class="n">PhiSurf</span> <span class="o">+</span> <span class="n">PiOvr2</span><span class="p">)</span>
<a name="ln-395"></a>  <span class="n">DPhi</span> <span class="o">=</span> <span class="p">(</span><span class="n">PhiMax</span> <span class="o">-</span> <span class="n">PhiMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">AltAngStepsForSolReflCalc</span>
<a name="ln-396"></a>  <span class="n">RayNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-397"></a>
<a name="ln-398"></a>  <span class="c">! Altitude loop</span>
<a name="ln-399"></a>  <span class="k">DO </span><span class="n">IPhi</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">AltAngStepsForSolReflCalc</span>
<a name="ln-400"></a>    <span class="n">Phi</span> <span class="o">=</span> <span class="n">PhiMin</span> <span class="o">+</span> <span class="p">(</span><span class="n">IPhi</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DPhi</span>
<a name="ln-401"></a>    <span class="n">SPhi</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<a name="ln-402"></a>    <span class="n">CPhi</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<a name="ln-403"></a>    <span class="c">! Third component of ray unit vector in (Theta,Phi) direction</span>
<a name="ln-404"></a>    <span class="n">URay</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">SPhi</span>
<a name="ln-405"></a>
<a name="ln-406"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">PhiSurf</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-407"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Phi</span> <span class="o">&gt;=</span> <span class="n">PiOvr2</span> <span class="o">-</span> <span class="n">PhiSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-408"></a><span class="k">        </span><span class="n">ThetaMin</span> <span class="o">=</span> <span class="o">-</span><span class="n">Pi</span>
<a name="ln-409"></a>        <span class="n">ThetaMax</span> <span class="o">=</span> <span class="n">Pi</span>
<a name="ln-410"></a>      <span class="k">ELSE</span>
<a name="ln-411"></a><span class="k">        </span><span class="n">ACosTanTan</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="o">-</span><span class="nb">TAN</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span><span class="o">*</span><span class="nb">TAN</span><span class="p">(</span><span class="n">PhiSurf</span><span class="p">))</span>
<a name="ln-412"></a>        <span class="n">ThetaMin</span> <span class="o">=</span> <span class="n">ThetaSurf</span> <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ACosTanTan</span><span class="p">)</span>
<a name="ln-413"></a>        <span class="n">ThetaMax</span> <span class="o">=</span> <span class="n">ThetaSurf</span> <span class="o">+</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ACosTanTan</span><span class="p">)</span>
<a name="ln-414"></a>      <span class="k">END IF</span>
<a name="ln-415"></a>
<a name="ln-416"></a><span class="k">    ELSE</span>  <span class="c">! PhiSurf &lt; 0.0</span>
<a name="ln-417"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Phi</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">PhiSurf</span> <span class="o">-</span> <span class="n">PiOvr2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-418"></a><span class="k">        </span><span class="n">ThetaMin</span> <span class="o">=</span> <span class="o">-</span><span class="n">Pi</span>
<a name="ln-419"></a>        <span class="n">ThetaMax</span> <span class="o">=</span> <span class="n">Pi</span>
<a name="ln-420"></a>      <span class="k">ELSE</span>
<a name="ln-421"></a><span class="k">        </span><span class="n">ACosTanTan</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="o">-</span><span class="nb">TAN</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span><span class="o">*</span><span class="nb">TAN</span><span class="p">(</span><span class="n">PhiSurf</span><span class="p">))</span>
<a name="ln-422"></a>        <span class="n">ThetaMin</span> <span class="o">=</span> <span class="n">ThetaSurf</span> <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ACosTanTan</span><span class="p">)</span>
<a name="ln-423"></a>        <span class="n">ThetaMax</span> <span class="o">=</span> <span class="n">ThetaSurf</span> <span class="o">+</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ACosTanTan</span><span class="p">)</span>
<a name="ln-424"></a>      <span class="k">END IF</span>
<a name="ln-425"></a><span class="k">    END IF</span>
<a name="ln-426"></a>
<a name="ln-427"></a><span class="k">    </span><span class="n">DTheta</span> <span class="o">=</span> <span class="p">(</span><span class="n">ThetaMax</span> <span class="o">-</span> <span class="n">ThetaMin</span><span class="p">)</span> <span class="o">/</span> <span class="n">AzimAngStepsForSolReflCalc</span>
<a name="ln-428"></a>    <span class="n">dOmega</span> <span class="o">=</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="n">DTheta</span> <span class="o">*</span> <span class="n">DPhi</span>
<a name="ln-429"></a>
<a name="ln-430"></a>    <span class="c">! Azimuth loop</span>
<a name="ln-431"></a>    <span class="k">DO </span><span class="n">ITheta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">AzimAngStepsForSolReflCalc</span>
<a name="ln-432"></a>      <span class="n">Theta</span> <span class="o">=</span> <span class="n">ThetaMin</span> <span class="o">+</span> <span class="p">(</span><span class="n">ITheta</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DTheta</span>
<a name="ln-433"></a>      <span class="n">URay</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-434"></a>      <span class="n">URay</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-435"></a>      <span class="c">! Cosine of angle of incidence of ray on receiving surface</span>
<a name="ln-436"></a>      <span class="n">CosIncAngRay</span> <span class="o">=</span> <span class="n">SPhi</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">PhiSurf</span><span class="p">)</span> <span class="o">+</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">PhiSurf</span><span class="p">)</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Theta</span><span class="o">-</span><span class="n">ThetaSurf</span><span class="p">)</span>
<a name="ln-437"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CosIncAngRay</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Ray is behind receiving surface (although there shouldn&#39;t be any)</span>
<a name="ln-438"></a>      <span class="n">RayNum</span> <span class="o">=</span> <span class="n">RayNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-439"></a>      <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RayVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">URay</span>
<a name="ln-440"></a>      <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">CosIncAngRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">CosIncAngRay</span>
<a name="ln-441"></a>      <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">dOmegaRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">dOmega</span>
<a name="ln-442"></a>    <span class="k">END DO</span> <span class="c">! End of azimuth loop</span>
<a name="ln-443"></a>
<a name="ln-444"></a>  <span class="k">END DO</span>  <span class="c">! End of altitude loop</span>
<a name="ln-445"></a>  <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumReflRays</span> <span class="o">=</span> <span class="n">RayNum</span>
<a name="ln-446"></a>
<a name="ln-447"></a><span class="k">END DO</span>  <span class="c">! End of loop over receiving surfaces</span>
<a name="ln-448"></a>
<a name="ln-449"></a><span class="c">! Loop again over receiving surfaces and, for each ray, get hit point and info associated with that point</span>
<a name="ln-450"></a><span class="c">! (hit point = point that ray intersects nearest obstruction, or, if ray is downgoing and hits no</span>
<a name="ln-451"></a><span class="c">! obstructions, point that ray intersects ground plane).</span>
<a name="ln-452"></a>
<a name="ln-453"></a><span class="k">DO </span><span class="n">RecSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSolReflRecSurf</span>
<a name="ln-454"></a>  <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">SurfNum</span>
<a name="ln-455"></a>  <span class="k">DO </span><span class="n">RecPtNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span>
<a name="ln-456"></a>    <span class="n">RecPt</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">)</span>
<a name="ln-457"></a>    <span class="k">DO </span><span class="n">RayNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumReflRays</span>
<a name="ln-458"></a>      <span class="n">IHit</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-459"></a>      <span class="c">! Loop over possible obstructions. If ray hits one or more obstructions get hit point on closest obstruction.</span>
<a name="ln-460"></a>      <span class="c">! If ray hits no obstructions and is going upward set HitPointSurfNum = 0.</span>
<a name="ln-461"></a>      <span class="c">! If ray hits no obstructions and is going downward set HitPointSurfNum = -1 and get hit point on ground.</span>
<a name="ln-462"></a>      <span class="n">TotObstructionsHit</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-463"></a>      <span class="n">NearestHitSurfNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-464"></a>      <span class="n">NearestHitDistance</span> <span class="o">=</span> <span class="mf">1.d+8</span>
<a name="ln-465"></a>      <span class="n">ObsSurfNumToSkip</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-466"></a>      <span class="n">RayVec</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RayVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span>
<a name="ln-467"></a>      <span class="k">DO </span><span class="n">loop1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span>
<a name="ln-468"></a>        <span class="c">! Surface number of this obstruction</span>
<a name="ln-469"></a>        <span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span><span class="p">(</span><span class="n">loop1</span><span class="p">)</span>
<a name="ln-470"></a>        <span class="c">! If a window was hit previously (see below), ObsSurfNumToSkip was set to the window&#39;s base surface in order</span>
<a name="ln-471"></a>        <span class="c">! to remove that surface from consideration as a hit surface for this ray</span>
<a name="ln-472"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">ObsSurfNumToSkip</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-473"></a>        <span class="c">! Determine if this ray hits ObsSurfNum (in which case IHit &gt; 0) and, if so, what the</span>
<a name="ln-474"></a>        <span class="c">! distance from the receiving point to the hit point is</span>
<a name="ln-475"></a>        <span class="k">CALL </span><span class="n">PierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">RecPt</span><span class="p">,</span><span class="n">RayVec</span><span class="p">,</span><span class="n">IHit</span><span class="p">,</span><span class="n">HitPt</span><span class="p">)</span>
<a name="ln-476"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">IHit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-477"></a>          <span class="c">! added TH 3/29/2010 to set ObsSurfNumToSkip</span>
<a name="ln-478"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-479"></a><span class="k">            </span><span class="n">ObsSurfNumToSkip</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-480"></a>          <span class="n">ENDIF</span>
<a name="ln-481"></a>
<a name="ln-482"></a>          <span class="c">! If obstruction is a window and its base surface is the nearest obstruction hit so far,</span>
<a name="ln-483"></a>          <span class="c">! set NearestHitSurfNum to this window. Note that in this case NearestHitDistance has already</span>
<a name="ln-484"></a>          <span class="c">! been calculated, so does not have to be recalculated.</span>
<a name="ln-485"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">NearestHitSurfNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-486"></a><span class="k">            </span><span class="n">NearestHitSurfNum</span> <span class="o">=</span> <span class="n">ObsSurfNum</span>
<a name="ln-487"></a>          <span class="k">ELSE</span>
<a name="ln-488"></a><span class="k">            </span><span class="n">TotObstructionsHit</span> <span class="o">=</span> <span class="n">TotObstructionsHit</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-489"></a>            <span class="c">! Distance from receiving point to hit point</span>
<a name="ln-490"></a>            <span class="n">HitDistance</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">HitPt</span><span class="o">-</span><span class="n">RecPt</span><span class="p">,</span><span class="n">HitPt</span><span class="o">-</span><span class="n">RecPt</span><span class="p">))</span>
<a name="ln-491"></a>            <span class="c">! Reset NearestHitSurfNum and NearestHitDistance if this hit point is closer than previous closest</span>
<a name="ln-492"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HitDistance</span> <span class="o">&lt;</span> <span class="n">NearestHitDistance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-493"></a><span class="k">              </span><span class="n">NearestHitDistance</span> <span class="o">=</span> <span class="n">HitDistance</span>
<a name="ln-494"></a>              <span class="n">NearestHitSurfNum</span>  <span class="o">=</span> <span class="n">ObsSurfNum</span>
<a name="ln-495"></a>              <span class="n">NearestHitPt</span> <span class="o">=</span> <span class="n">HitPt</span>
<a name="ln-496"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">HitDistance</span> <span class="o">==</span> <span class="n">NearestHitDistance</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! TH2 CR8959</span>
<a name="ln-497"></a>              <span class="c">! Ray hits mirrored surfaces. Choose the surface facing the ray.</span>
<a name="ln-498"></a>              <span class="k">IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">,</span><span class="n">RayVec</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-499"></a><span class="k">                </span><span class="n">NearestHitSurfNum</span> <span class="o">=</span> <span class="n">ObsSurfNum</span>
<a name="ln-500"></a>              <span class="k">END IF</span>
<a name="ln-501"></a><span class="k">            END IF</span>
<a name="ln-502"></a><span class="k">          END IF</span>
<a name="ln-503"></a><span class="k">        END IF</span>  <span class="c">! End of check if obstruction was hit</span>
<a name="ln-504"></a>      <span class="k">END DO</span>  <span class="c">! End of loop over possible obstructions for this ray</span>
<a name="ln-505"></a>
<a name="ln-506"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">TotObstructionsHit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-507"></a>        <span class="c">! One or more obstructions were hit by this ray</span>
<a name="ln-508"></a>        <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSurfNum</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">NearestHitSurfNum</span>
<a name="ln-509"></a>        <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPtHitPtDis</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">NearestHitDistance</span>
<a name="ln-510"></a>        <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">NearestHitPt</span>
<a name="ln-511"></a>        <span class="c">! For hit surface, calculate unit normal vector pointing into the hemisphere</span>
<a name="ln-512"></a>        <span class="c">! containing the receiving point</span>
<a name="ln-513"></a>        <span class="n">Vec1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-514"></a>        <span class="n">Vec2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span>  <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-515"></a>        <span class="k">CALL </span><span class="n">CrossProduct</span><span class="p">(</span><span class="n">Vec1</span><span class="p">,</span><span class="n">Vec2</span><span class="p">,</span><span class="n">VNorm</span><span class="p">)</span>
<a name="ln-516"></a>        <span class="n">VNorm</span> <span class="o">=</span> <span class="n">VNorm</span><span class="o">/</span><span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">VNorm</span><span class="p">,</span><span class="n">VNorm</span><span class="p">))</span>
<a name="ln-517"></a>        <span class="k">IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">VNorm</span><span class="p">,</span><span class="o">-</span><span class="n">RayVec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">VNorm</span> <span class="o">=</span> <span class="o">-</span><span class="n">VNorm</span>
<a name="ln-518"></a>        <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">VNorm</span>
<a name="ln-519"></a>        <span class="c">! Get solar and visible beam-to-diffuse reflectance at nearest hit point</span>
<a name="ln-520"></a>        <span class="n">ObsConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-521"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ObsConstrNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-522"></a>          <span class="c">! Exterior building surface is nearest hit</span>
<a name="ln-523"></a>          <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Construct</span><span class="p">(</span><span class="n">ObsConstrNum</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-524"></a>            <span class="c">! Obstruction is not a window, i.e., is an opaque surface</span>
<a name="ln-525"></a>            <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSolRefl</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-526"></a>              <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ObsConstrNum</span><span class="p">)%</span><span class="n">OutsideAbsorpSolar</span>
<a name="ln-527"></a>          <span class="k">ELSE</span>
<a name="ln-528"></a>            <span class="c">! Obstruction is a window. Assume it is bare so that there is no beam-to-diffuse reflection</span>
<a name="ln-529"></a>            <span class="c">! (beam-to-beam reflection is calculated in subroutine CalcBeamSolSpecularReflFactors).</span>
<a name="ln-530"></a>            <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSolRefl</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-531"></a>          <span class="k">END IF</span>
<a name="ln-532"></a><span class="k">        ELSE</span>
<a name="ln-533"></a>          <span class="c">! Shading surface is nearest hit</span>
<a name="ln-534"></a>          <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSolRefl</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NearestHitSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfDiffuseSolRefl</span>
<a name="ln-535"></a>        <span class="k">END IF</span>
<a name="ln-536"></a><span class="k">      ELSE</span>
<a name="ln-537"></a>        <span class="c">! No obstructions were hit by this ray</span>
<a name="ln-538"></a>        <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSurfNum</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-539"></a>        <span class="c">! If ray is going downward find the hit point on the ground plane if the receiving point</span>
<a name="ln-540"></a>        <span class="c">! is above ground level; note that GroundLevelZ is &lt;= 0.0</span>
<a name="ln-541"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">RayVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">GroundLevelZ</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-542"></a>          <span class="c">! Ray hits ground</span>
<a name="ln-543"></a>          <span class="n">Alfa</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="o">-</span><span class="n">RayVec</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-544"></a>          <span class="n">Beta</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">RayVec</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">RayVec</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-545"></a>          <span class="n">HorDis</span> <span class="o">=</span> <span class="p">(</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">GroundLevelZ</span><span class="p">)</span><span class="o">*</span><span class="nb">TAN</span><span class="p">(</span><span class="n">Alfa</span><span class="p">)</span>
<a name="ln-546"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">GroundLevelZ</span>
<a name="ln-547"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">RecPt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">HorDis</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">Beta</span><span class="p">)</span>
<a name="ln-548"></a>          <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">RecPt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">HorDis</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">Beta</span><span class="p">)</span>
<a name="ln-549"></a>          <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">GroundHitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-550"></a>          <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSurfNum</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-551"></a>          <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPtHitPtDis</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">GroundLevelZ</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">RayVec</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-552"></a>          <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSolRefl</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">GndReflectance</span>
<a name="ln-553"></a>          <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-554"></a>          <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtNormVec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-555"></a>          <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtNormVec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-556"></a>        <span class="k">END IF</span>  <span class="c">! End of check if ray hits ground</span>
<a name="ln-557"></a>      <span class="k">END IF</span>  <span class="c">! End of check if obstruction hit</span>
<a name="ln-558"></a>    <span class="k">END DO</span>  <span class="c">! End of RayNum loop</span>
<a name="ln-559"></a>  <span class="k">END DO</span>  <span class="c">! End of receiving point loop</span>
<a name="ln-560"></a><span class="k">END DO</span>  <span class="c">! End of receiving surface loop</span>
<a name="ln-561"></a>
<a name="ln-562"></a><span class="k">RETURN</span>
<a name="ln-563"></a><span class="k">END SUBROUTINE </span><span class="n">InitSolReflRecSurf</span>
<a name="ln-564"></a>
<a name="ln-565"></a><span class="c">!=====================================================================================================</span>
<a name="ln-566"></a>
<a name="ln-567"></a><span class="k">SUBROUTINE </span><span class="n">CalcBeamSolDiffuseReflFactors</span>
<a name="ln-568"></a>
<a name="ln-569"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-570"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-571"></a>          <span class="c">!       DATE WRITTEN   September 2003</span>
<a name="ln-572"></a>          <span class="c">!       MODIFIED       TH 4/6/2010, fixed CR 7872</span>
<a name="ln-573"></a>          <span class="c">!       RE-ENGINEERED  B. Griffith, October 2012, for timestep integrated solar</span>
<a name="ln-574"></a>
<a name="ln-575"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-576"></a>          <span class="c">! manage calculations for factors for irradiance on exterior heat transfer surfaces due to</span>
<a name="ln-577"></a>          <span class="c">! beam-to-diffuse solar reflection from obstructions and ground.</span>
<a name="ln-578"></a>
<a name="ln-579"></a>          <span class="c">! METHODOLOGY EMPLOYED: call worker routine depending on solar calculation method</span>
<a name="ln-580"></a>
<a name="ln-581"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-582"></a>
<a name="ln-583"></a>          <span class="c">! USE STATEMENTS: na</span>
<a name="ln-584"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">HourOfDay</span>
<a name="ln-585"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-586"></a>
<a name="ln-587"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-588"></a>
<a name="ln-589"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-590"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-591"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-592"></a>
<a name="ln-593"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-594"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHr</span>                  <span class="o">=</span><span class="mi">0</span>   <span class="c">! Hour number</span>
<a name="ln-595"></a>
<a name="ln-596"></a>          <span class="c">! FLOW:</span>
<a name="ln-597"></a>
<a name="ln-598"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-599"></a><span class="k">    IF</span><span class="p">(</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-600"></a><span class="k">      CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Calculating Beam-to-Diffuse Exterior Solar Reflection Factors&#39;</span><span class="p">)</span>
<a name="ln-601"></a>    <span class="k">ELSE</span>
<a name="ln-602"></a><span class="k">      CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Updating Beam-to-Diffuse Exterior Solar Reflection Factors&#39;</span><span class="p">)</span>
<a name="ln-603"></a>    <span class="k">END IF</span>
<a name="ln-604"></a><span class="k">    </span><span class="n">ReflFacBmToDiffSolObs</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-605"></a>    <span class="n">ReflFacBmToDiffSolGnd</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-606"></a>    <span class="k">DO </span><span class="n">IHr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-607"></a>      <span class="k">CALL </span><span class="n">FigureBeamSolDiffuseReflFactors</span><span class="p">(</span><span class="n">IHr</span><span class="p">)</span>
<a name="ln-608"></a>    <span class="n">ENDDO</span>  <span class="c">! End of IHr loop</span>
<a name="ln-609"></a>  <span class="k">ELSE</span> <span class="c">! timestep integrated solar, use current hour of day</span>
<a name="ln-610"></a>    <span class="n">ReflFacBmToDiffSolObs</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-611"></a>    <span class="n">ReflFacBmToDiffSolGnd</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-612"></a>    <span class="k">CALL </span><span class="n">FigureBeamSolDiffuseReflFactors</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-613"></a>  <span class="n">ENDIF</span>
<a name="ln-614"></a>
<a name="ln-615"></a>  <span class="k">RETURN</span>
<a name="ln-616"></a><span class="k">END SUBROUTINE </span><span class="n">CalcBeamSolDiffuseReflFactors</span>
<a name="ln-617"></a>
<a name="ln-618"></a><span class="k">SUBROUTINE </span><span class="n">FigureBeamSolDiffuseReflFactors</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-619"></a>
<a name="ln-620"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-621"></a>          <span class="c">!       AUTHOR         Fred Winkelmann, derived from original CalcBeamSolDiffuseReflFactors</span>
<a name="ln-622"></a>          <span class="c">!       DATE WRITTEN   September 2003</span>
<a name="ln-623"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-624"></a>          <span class="c">!       RE-ENGINEERED  B. Griffith, October 2012, revised for timestep integrated solar</span>
<a name="ln-625"></a>
<a name="ln-626"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-627"></a>          <span class="c">! Calculates factors for irradiance on exterior heat transfer surfaces due to</span>
<a name="ln-628"></a>          <span class="c">! beam-to-diffuse solar reflection from obstructions and ground.</span>
<a name="ln-629"></a>
<a name="ln-630"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-631"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-632"></a>
<a name="ln-633"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-634"></a>          <span class="c">! na</span>
<a name="ln-635"></a>
<a name="ln-636"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-637"></a>          <span class="c">! na</span>
<a name="ln-638"></a>
<a name="ln-639"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-640"></a>
<a name="ln-641"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-642"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iHour</span>
<a name="ln-643"></a>
<a name="ln-644"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-645"></a>          <span class="c">! na</span>
<a name="ln-646"></a>
<a name="ln-647"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-648"></a>          <span class="c">! na</span>
<a name="ln-649"></a>
<a name="ln-650"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-651"></a>          <span class="c">! na</span>
<a name="ln-652"></a>
<a name="ln-653"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-654"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SunVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>            <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Unit vector to sun</span>
<a name="ln-655"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RecSurfNum</span>           <span class="o">=</span><span class="mi">0</span>   <span class="c">! Receiving surface number</span>
<a name="ln-656"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SurfNum</span>              <span class="o">=</span><span class="mi">0</span>   <span class="c">! Heat transfer surface number corresponding to RecSurfNum</span>
<a name="ln-657"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RecPtNum</span>             <span class="o">=</span><span class="mi">0</span>   <span class="c">! Receiving point number</span>
<a name="ln-658"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumRecPts</span>            <span class="o">=</span><span class="mi">0</span>   <span class="c">! Number of receiving points on a receiving surface</span>
<a name="ln-659"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HitPtSurfNum</span>         <span class="o">=</span><span class="mi">0</span>   <span class="c">! Surface number of hit point: -1 = ground,</span>
<a name="ln-660"></a>                                    <span class="c">! 0 = sky or obstruction with receiving point below ground level,</span>
<a name="ln-661"></a>                                    <span class="c">! &gt;0 = obstruction with receiving point above ground level</span>
<a name="ln-662"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflBmToDiffSolObs</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">)</span> <span class="c">! Irradiance at a receiving point for</span>
<a name="ln-663"></a>                                            <span class="c">! beam solar diffusely reflected from obstructions, divided by</span>
<a name="ln-664"></a>                                            <span class="c">! beam normal irradiance</span>
<a name="ln-665"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflBmToDiffSolGnd</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">)</span> <span class="c">! Irradiance at a receiving point for</span>
<a name="ln-666"></a>                                            <span class="c">! beam solar diffusely reflected from the ground, divided by</span>
<a name="ln-667"></a>                                            <span class="c">! beam normal irradiance</span>
<a name="ln-668"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RayNum</span>               <span class="o">=</span><span class="mi">0</span>   <span class="c">! Ray number</span>
<a name="ln-669"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHit</span>                 <span class="o">=</span><span class="mi">0</span>   <span class="c">! &gt; 0 if obstruction is hit; otherwise = 0</span>
<a name="ln-670"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OriginThisRay</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Origin point of a ray (m)</span>
<a name="ln-671"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ObsHitPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Hit point on obstruction (m)</span>
<a name="ln-672"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>           <span class="o">=</span><span class="mi">0</span>   <span class="c">! Obstruction surface number</span>
<a name="ln-673"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncBmAtHitPt</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cosine of incidence angle of beam solar at hit point</span>
<a name="ln-674"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncBmAtHitPt2</span>     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cosine of incidence angle of beam solar at hit point,</span>
<a name="ln-675"></a>                                         <span class="c">!  the mirrored shading surface</span>
<a name="ln-676"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BmReflSolRadiance</span>    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Solar radiance at hit point due to incident beam, divided</span>
<a name="ln-677"></a>                                         <span class="c">!  by beam normal irradiance</span>
<a name="ln-678"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dReflBeamToDiffSol</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Contribution to reflection factor at a receiving point</span>
<a name="ln-679"></a>                                         <span class="c">!  from beam solar reflected from a hit point</span>
<a name="ln-680"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SunLitFract</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sunlit fraction</span>
<a name="ln-681"></a>
<a name="ln-682"></a>  <span class="n">ReflBmToDiffSolObs</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-683"></a>  <span class="n">ReflBmToDiffSolGnd</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-684"></a>
<a name="ln-685"></a>  <span class="c">! Unit vector to sun</span>
<a name="ln-686"></a>  <span class="n">SunVec</span> <span class="o">=</span> <span class="n">SunCosHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-687"></a>
<a name="ln-688"></a>  <span class="c">! loop through each surface that can receive beam solar reflected as diffuse solar from other surfaces</span>
<a name="ln-689"></a>  <span class="k">DO </span><span class="n">RecSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSolReflRecSurf</span>
<a name="ln-690"></a>    <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">SurfNum</span>
<a name="ln-691"></a>
<a name="ln-692"></a>    <span class="k">DO </span><span class="n">RecPtNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span>
<a name="ln-693"></a>      <span class="n">ReflBmToDiffSolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-694"></a>      <span class="n">ReflBmToDiffSolGnd</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-695"></a>
<a name="ln-696"></a>      <span class="k">DO </span><span class="n">RayNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumReflRays</span>
<a name="ln-697"></a>        <span class="n">HitPtSurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSurfNum</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span>
<a name="ln-698"></a>
<a name="ln-699"></a>        <span class="c">! Skip rays that do not hit an obstruction or ground.</span>
<a name="ln-700"></a>        <span class="c">! (Note that if a downgoing ray does not hit an obstruction it will have HitPtSurfNum = 0</span>
<a name="ln-701"></a>        <span class="c">! if the receiving point is below ground level (see subr. InitSolReflRecSurf); this means</span>
<a name="ln-702"></a>        <span class="c">! that a below-ground-level receiving point receives no ground-reflected radiation although</span>
<a name="ln-703"></a>        <span class="c">! it is allowed to receive obstruction-reflected solar radiation and direct (unreflected)</span>
<a name="ln-704"></a>        <span class="c">! beam and sky solar radiation. As far as reflected solar is concerned, the program does</span>
<a name="ln-705"></a>        <span class="c">! not handle a sloped ground plane or a horizontal ground plane whose level is different</span>
<a name="ln-706"></a>        <span class="c">! from one side of the building to another.)</span>
<a name="ln-707"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HitPtSurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Ray hits sky or obstruction with receiving pt. below ground level</span>
<a name="ln-708"></a>
<a name="ln-709"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HitPtSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-710"></a>          <span class="c">! Skip rays that hit a daylighting shelf, from which solar reflection is calculated separately.</span>
<a name="ln-711"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="p">)%</span><span class="n">Shelf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-712"></a>
<a name="ln-713"></a>          <span class="c">! Skip rays that hit a window</span>
<a name="ln-714"></a>          <span class="c">! If hit point&#39;s surface is a window or glass door go to next ray since it is assumed for now</span>
<a name="ln-715"></a>          <span class="c">! that windows have only beam-to-beam, not beam-to-diffuse, reflection</span>
<a name="ln-716"></a>          <span class="c">! TH 3/29/2010. Code modified and moved</span>
<a name="ln-717"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-718"></a>             <span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_GLASSDOOR</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-719"></a>
<a name="ln-720"></a>          <span class="c">! Skip rays that hit non-sunlit surface. Assume first time step of the hour.</span>
<a name="ln-721"></a>          <span class="n">SunlitFract</span> <span class="o">=</span> <span class="n">SunlitFrac</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-722"></a>
<a name="ln-723"></a>          <span class="c">! If hit point&#39;s surface is not sunlit go to next ray</span>
<a name="ln-724"></a>          <span class="c">! TH 3/25/2010. why limit to HeatTransSurf? shading surfaces should also apply</span>
<a name="ln-725"></a>          <span class="c">!IF(Surface(HitPtSurfNum)%HeatTransSurf .AND. SunlitFract &lt; 0.01d0) CYCLE</span>
<a name="ln-726"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SunlitFract</span> <span class="o">&lt;</span> <span class="mf">0.01d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-727"></a>
<a name="ln-728"></a>          <span class="c">! TH 3/26/2010. If the hit point falls into the shadow even though SunlitFract &gt; 0, can Cycle.</span>
<a name="ln-729"></a>          <span class="c">!  This cannot be done now, therefore there are follow-up checks of blocking sun ray</span>
<a name="ln-730"></a>          <span class="c">!   from the hit point.</span>
<a name="ln-731"></a>
<a name="ln-732"></a>          <span class="c">! TH 3/29/2010. Code modified and moved up</span>
<a name="ln-733"></a>          <span class="c">! If hit point&#39;s surface is a window go to next ray since it is assumed for now</span>
<a name="ln-734"></a>          <span class="c">! that windows have only beam-to-beam, not beam-to-diffuse, reflection</span>
<a name="ln-735"></a>          <span class="c">!IF(Surface(HitPtSurfNum)%Construction &gt; 0) THEN</span>
<a name="ln-736"></a>          <span class="c">!  IF(Construct(Surface(HitPtSurfNum)%Construction)%TypeIsWindow) CYCLE</span>
<a name="ln-737"></a>          <span class="c">!END IF</span>
<a name="ln-738"></a>        <span class="k">END IF</span>
<a name="ln-739"></a>
<a name="ln-740"></a>        <span class="c">! Does an obstruction block the vector from this ray&#39;s hit point to the sun?</span>
<a name="ln-741"></a>        <span class="n">IHit</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-742"></a>        <span class="n">OriginThisRay</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span>
<a name="ln-743"></a>
<a name="ln-744"></a>        <span class="c">! Note: if sun is in back of hit surface relative to receiving point, CosIncBmAtHitPt will be &lt; 0</span>
<a name="ln-745"></a>        <span class="n">CosIncBmAtHitPt</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">),</span><span class="n">SunVec</span><span class="p">)</span>
<a name="ln-746"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CosIncBmAtHitPt</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-747"></a>
<a name="ln-748"></a>        <span class="c">! CR 7872 - TH 4/6/2010. The shading surfaces should point to the receiveing heat transfer surface</span>
<a name="ln-749"></a>        <span class="c">!  according to the the right hand rule. If user inputs do not follow the rule, use the following</span>
<a name="ln-750"></a>        <span class="c">!  code to check the mirrored shading surface</span>
<a name="ln-751"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">HitPtSurfNum</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-752"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-753"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">HitPtSurfNum</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">TotSurfaces</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-754"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">ShadowingSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-755"></a>                <span class="c">! Check whether the sun is behind the mirrored shading surface</span>
<a name="ln-756"></a>                <span class="n">CosIncBmAtHitPt2</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">,</span><span class="n">SunVec</span><span class="p">)</span>
<a name="ln-757"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CosIncBmAtHitPt2</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-758"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-759"></a>            <span class="n">ENDIF</span>
<a name="ln-760"></a>          <span class="n">ENDIF</span>
<a name="ln-761"></a>        <span class="n">ENDIF</span>
<a name="ln-762"></a>
<a name="ln-763"></a>        <span class="c">! TH 3/25/2010. CR 7872. Seems should loop over all possible obstructions for the HitPtSurfNum</span>
<a name="ln-764"></a>        <span class="c">!  rather than RecSurfNum, because if the HitPtSurfNum is a shading surface,</span>
<a name="ln-765"></a>        <span class="c">!  it does not belong to SolReflRecSurf which only contain heat transfer surfaces</span>
<a name="ln-766"></a>        <span class="c">!  that can receive reflected solar (ExtSolar = True)!</span>
<a name="ln-767"></a>
<a name="ln-768"></a>        <span class="c">! To speed up, ideally should store all possible shading surfaces for the HitPtSurfNum</span>
<a name="ln-769"></a>        <span class="c">!  obstruction surface in the SolReflSurf(HitPtSurfNum)%PossibleObsSurfNums(loop) array as well</span>
<a name="ln-770"></a>        <span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-771"></a><span class="c">!        DO loop = 1,SolReflRecSurf(RecSurfNum)%NumPossibleObs</span>
<a name="ln-772"></a><span class="c">!          ObsSurfNum = SolReflRecSurf(RecSurfNum)%PossibleObsSurfNums(loop)</span>
<a name="ln-773"></a>
<a name="ln-774"></a>          <span class="c">!CR 8959 -- The other side of a mirrored surface cannot obstruct the mirrored surface</span>
<a name="ln-775"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HitPtSurfNum</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-776"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-777"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">HitPtSurfNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-778"></a><span class="k">            END IF</span>
<a name="ln-779"></a><span class="k">          END IF</span>
<a name="ln-780"></a>
<a name="ln-781"></a>          <span class="c">! skip the hit surface</span>
<a name="ln-782"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">HitPtSurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-783"></a>
<a name="ln-784"></a>          <span class="c">! skip mirrored surfaces</span>
<a name="ln-785"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-786"></a>          <span class="c">!IF(Surface(ObsSurfNum)%ShadowingSurf .AND. Surface(ObsSurfNum)%Name(1:3) == &#39;Mir&#39;) THEN</span>
<a name="ln-787"></a>          <span class="c">!  CYCLE</span>
<a name="ln-788"></a>          <span class="c">!ENDIF</span>
<a name="ln-789"></a>
<a name="ln-790"></a>          <span class="c">! skip interior surfaces</span>
<a name="ln-791"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-792"></a>
<a name="ln-793"></a>
<a name="ln-794"></a>          <span class="c">! For now it is assumed that obstructions that are shading surfaces are opaque.</span>
<a name="ln-795"></a>          <span class="c">! An improvement here would be to allow these to have transmittance.</span>
<a name="ln-796"></a>          <span class="k">CALL </span><span class="n">PierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span> <span class="n">OriginThisRay</span><span class="p">,</span> <span class="n">SunVec</span><span class="p">,</span> <span class="n">IHit</span><span class="p">,</span> <span class="n">ObsHitPt</span><span class="p">)</span>
<a name="ln-797"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IHit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>  <span class="c">! An obstruction was hit</span>
<a name="ln-798"></a>        <span class="k">END DO</span>
<a name="ln-799"></a><span class="k">        IF</span><span class="p">(</span><span class="n">IHit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>    <span class="c">! Sun does not reach this ray&#39;s hit point</span>
<a name="ln-800"></a>
<a name="ln-801"></a>        <span class="c">! Sun reaches this ray&#39;s hit point; get beam-reflected diffuse radiance at hit point for</span>
<a name="ln-802"></a>        <span class="c">! unit beam normal solar</span>
<a name="ln-803"></a>
<a name="ln-804"></a>        <span class="c">!CosIncBmAtHitPt = DOT_PRODUCT(SolReflRecSurf(RecSurfNum)%HitPtNormVec(1:3,RecPtNum,RayNum),SunVec)</span>
<a name="ln-805"></a>        <span class="c">! Note: if sun is in back of hit surface relative to receiving point, CosIncBmAtHitPt will be &lt; 0</span>
<a name="ln-806"></a>        <span class="c">! and use of MAX in following gives zero beam solar reflecting at hit point.</span>
<a name="ln-807"></a>        <span class="c">!BmReflSolRadiance = MAX(0.0d0,CosIncBmAtHitPt)*SolReflRecSurf(RecSurfNum)%HitPtSolRefl(RecPtNum,RayNum)</span>
<a name="ln-808"></a>
<a name="ln-809"></a>        <span class="n">BmReflSolRadiance</span> <span class="o">=</span> <span class="n">CosIncBmAtHitPt</span> <span class="o">*</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSolRefl</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span>
<a name="ln-810"></a>
<a name="ln-811"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">BmReflSolRadiance</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-812"></a>          <span class="c">! Contribution to reflection factor from this hit point</span>
<a name="ln-813"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HitPtSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-814"></a>            <span class="c">! Ray hits an obstruction</span>
<a name="ln-815"></a>            <span class="n">dReflBeamToDiffSol</span> <span class="o">=</span> <span class="n">BmReflSolRadiance</span> <span class="o">*</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">dOmegaRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-816"></a>                                 <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">CosIncAngRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span><span class="o">/</span><span class="n">Pi</span>
<a name="ln-817"></a>            <span class="n">ReflBmToDiffSolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflBmToDiffSolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">dReflBeamToDiffSol</span>
<a name="ln-818"></a>          <span class="k">ELSE</span>
<a name="ln-819"></a>            <span class="c">! Ray hits ground (in this case we do not multiply by BmReflSolRadiance since</span>
<a name="ln-820"></a>            <span class="c">! ground reflectance and cos of incidence angle of sun on</span>
<a name="ln-821"></a>            <span class="c">! ground is taken into account later when ReflFacBmToDiffSolGnd is used)</span>
<a name="ln-822"></a>            <span class="n">dReflBeamToDiffSol</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">dOmegaRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-823"></a>                                 <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">CosIncAngRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span><span class="o">/</span><span class="n">Pi</span>
<a name="ln-824"></a>            <span class="n">ReflBmToDiffSolGnd</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflBmToDiffSolGnd</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">dReflBeamToDiffSol</span>
<a name="ln-825"></a>          <span class="k">END IF</span>
<a name="ln-826"></a><span class="k">        END IF</span>
<a name="ln-827"></a><span class="k">      END DO</span>  <span class="c">! End of loop over rays from receiving point</span>
<a name="ln-828"></a>    <span class="k">END DO</span>  <span class="c">! End of loop over receiving points</span>
<a name="ln-829"></a>
<a name="ln-830"></a>    <span class="c">! Average over receiving points</span>
<a name="ln-831"></a>    <span class="n">ReflFacBmToDiffSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-832"></a>    <span class="n">ReflFacBmToDiffSolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-833"></a>    <span class="n">NumRecPts</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span>
<a name="ln-834"></a>    <span class="k">DO </span><span class="n">RecPtNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumRecPts</span>
<a name="ln-835"></a>      <span class="n">ReflFacBmToDiffSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacBmToDiffSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">ReflBmToDiffSolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span>
<a name="ln-836"></a>      <span class="n">ReflFacBmToDiffSolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacBmToDiffSolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">ReflBmToDiffSolGnd</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span>
<a name="ln-837"></a>    <span class="k">END DO</span>
<a name="ln-838"></a><span class="k">    </span><span class="n">ReflFacBmToDiffSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacBmToDiffSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">/</span><span class="n">NumRecPts</span>
<a name="ln-839"></a>    <span class="n">ReflFacBmToDiffSolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacBmToDiffSolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span><span class="o">/</span><span class="n">NumRecPts</span>
<a name="ln-840"></a>
<a name="ln-841"></a>    <span class="c">! Do not allow ReflFacBmToDiffSolGnd to exceed the surface&#39;s unobstructed ground view factor</span>
<a name="ln-842"></a>    <span class="n">ReflFacBmToDiffSolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-843"></a>                                             <span class="n">ReflFacBmToDiffSolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">))</span>
<a name="ln-844"></a>    <span class="c">! Note: the above factors are dimensionless; they are equal to</span>
<a name="ln-845"></a>    <span class="c">! (W/m2 reflected solar incident on SurfNum)/(W/m2 beam normal solar)</span>
<a name="ln-846"></a>  <span class="k">END DO</span>  <span class="c">! End of loop over receiving surfaces</span>
<a name="ln-847"></a>
<a name="ln-848"></a>  <span class="k">RETURN</span>
<a name="ln-849"></a>
<a name="ln-850"></a><span class="k">END SUBROUTINE </span><span class="n">FigureBeamSolDiffuseReflFactors</span>
<a name="ln-851"></a>
<a name="ln-852"></a>
<a name="ln-853"></a><span class="c">!=================================================================================================</span>
<a name="ln-854"></a>
<a name="ln-855"></a><span class="k">SUBROUTINE </span><span class="n">CalcBeamSolSpecularReflFactors</span>
<a name="ln-856"></a>
<a name="ln-857"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-858"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-859"></a>          <span class="c">!       DATE WRITTEN   September 2003</span>
<a name="ln-860"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-861"></a>          <span class="c">!       RE-ENGINEERED  B. Griffith, October 2012, for timestep integrated solar</span>
<a name="ln-862"></a>
<a name="ln-863"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-864"></a>          <span class="c">! Manage calculation of factors for beam solar irradiance on exterior heat transfer surfaces due to</span>
<a name="ln-865"></a>          <span class="c">! specular (beam-to-beam) reflection from obstructions such as a highly-glazed neighboring</span>
<a name="ln-866"></a>          <span class="c">! building.</span>
<a name="ln-867"></a>
<a name="ln-868"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-869"></a>          <span class="c">! call worker routine as appropriate</span>
<a name="ln-870"></a>
<a name="ln-871"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-872"></a>
<a name="ln-873"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-874"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">HourOfDay</span>
<a name="ln-875"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-876"></a>
<a name="ln-877"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-878"></a>
<a name="ln-879"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-880"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-881"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-882"></a>
<a name="ln-883"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-884"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IHr</span>                  <span class="o">=</span><span class="mi">0</span>   <span class="c">! Hour number</span>
<a name="ln-885"></a>
<a name="ln-886"></a>          <span class="c">! FLOW:</span>
<a name="ln-887"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-888"></a><span class="k">    IF</span><span class="p">(</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-889"></a><span class="k">      CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Calculating Beam-to-Beam Exterior Solar Reflection Factors&#39;</span><span class="p">)</span>
<a name="ln-890"></a>    <span class="k">ELSE</span>
<a name="ln-891"></a><span class="k">      CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Updating Beam-to-Beam Exterior Solar Reflection Factors&#39;</span><span class="p">)</span>
<a name="ln-892"></a>    <span class="k">END IF</span>
<a name="ln-893"></a><span class="k">    </span><span class="n">ReflFacBmToBmSolObs</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-894"></a>    <span class="n">CosIncAveBmToBmSolObs</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-895"></a>    <span class="k">DO </span><span class="n">IHr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-896"></a>      <span class="k">CALL </span><span class="n">FigureBeamSolSpecularReflFactors</span><span class="p">(</span><span class="n">IHr</span><span class="p">)</span>
<a name="ln-897"></a>    <span class="k">END DO</span>  <span class="c">! End of IHr loop</span>
<a name="ln-898"></a>  <span class="k">ELSE</span> <span class="c">! timestep integrated solar, use current hour of day</span>
<a name="ln-899"></a>    <span class="n">ReflFacBmToBmSolObs</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-900"></a>    <span class="n">CosIncAveBmToBmSolObs</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-901"></a>    <span class="k">CALL </span><span class="n">FigureBeamSolSpecularReflFactors</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-902"></a>  <span class="n">ENDIF</span>
<a name="ln-903"></a>
<a name="ln-904"></a>  <span class="k">RETURN</span>
<a name="ln-905"></a><span class="k">END SUBROUTINE </span><span class="n">CalcBeamSolSpecularReflFactors</span>
<a name="ln-906"></a>
<a name="ln-907"></a><span class="k">SUBROUTINE </span><span class="n">FigureBeamSolSpecularReflFactors</span><span class="p">(</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-908"></a>
<a name="ln-909"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-910"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-911"></a>          <span class="c">!       DATE WRITTEN   September 2003</span>
<a name="ln-912"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-913"></a>          <span class="c">!       RE-ENGINEERED  B. Griffith, October 2012, for timestep integrated solar</span>
<a name="ln-914"></a>
<a name="ln-915"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-916"></a>          <span class="c">! Calculates factors for beam solar irradiance on exterior heat transfer surfaces due to</span>
<a name="ln-917"></a>          <span class="c">! specular (beam-to-beam) reflection from obstructions such as a highly-glazed neighboring</span>
<a name="ln-918"></a>          <span class="c">! building. Specular reflection can occur from shading surfaces with non-zero specular</span>
<a name="ln-919"></a>          <span class="c">! reflectance and from exterior windows of the building (in calculating reflection from</span>
<a name="ln-920"></a>          <span class="c">! these windows, they are assumed to have no shades or blinds).</span>
<a name="ln-921"></a>          <span class="c">! Reflection from the ground and opaque building surfaces is assumed to be totally diffuse,</span>
<a name="ln-922"></a>          <span class="c">! i.e. these surfaces has no specular reflection component.</span>
<a name="ln-923"></a>
<a name="ln-924"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-925"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-926"></a>
<a name="ln-927"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-928"></a>          <span class="c">! na</span>
<a name="ln-929"></a>
<a name="ln-930"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-931"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span>
<a name="ln-932"></a>
<a name="ln-933"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-934"></a>
<a name="ln-935"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-936"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iHour</span>
<a name="ln-937"></a>
<a name="ln-938"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-939"></a>          <span class="c">! na</span>
<a name="ln-940"></a>
<a name="ln-941"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-942"></a>          <span class="c">! na</span>
<a name="ln-943"></a>
<a name="ln-944"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-945"></a>          <span class="c">! na</span>
<a name="ln-946"></a>
<a name="ln-947"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-948"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">loop</span>                 <span class="o">=</span><span class="mi">0</span>   <span class="c">! DO loop indices</span>
<a name="ln-949"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">loop2</span>                <span class="o">=</span><span class="mi">0</span>   <span class="c">! DO loop indices</span>
<a name="ln-950"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SunVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>            <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Unit vector to sun</span>
<a name="ln-951"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SunVecMir</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>         <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Unit vector to sun mirrored by a reflecting surface</span>
<a name="ln-952"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">RecSurfNum</span>           <span class="o">=</span><span class="mi">0</span>   <span class="c">! Receiving surface number</span>
<a name="ln-953"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">SurfNum</span>              <span class="o">=</span><span class="mi">0</span>   <span class="c">! Heat transfer surface number corresponding to RecSurfNum</span>
<a name="ln-954"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">NumRecPts</span>            <span class="o">=</span><span class="mi">0</span>   <span class="c">! Number of receiving points on a receiving surface</span>
<a name="ln-955"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">RecPtNum</span>             <span class="o">=</span><span class="mi">0</span>   <span class="c">! Receiving point number</span>
<a name="ln-956"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">RecPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Receiving point (m)</span>
<a name="ln-957"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HitPtRefl</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>         <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Hit point on a reflecting surface (m)</span>
<a name="ln-958"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ReflBmToDiffSolObs</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">)</span> <span class="c">! Irradiance at a receiving point for</span>
<a name="ln-959"></a>                                            <span class="c">! beam solar diffusely reflected from obstructions, divided by</span>
<a name="ln-960"></a>                                            <span class="c">! beam normal irradiance</span>
<a name="ln-961"></a><span class="c">!unused  INTEGER           :: RayNum               =0   ! Ray number</span>
<a name="ln-962"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IHitRefl</span>             <span class="o">=</span><span class="mi">0</span>   <span class="c">! &gt; 0 if reflecting surface is hit; otherwise = 0</span>
<a name="ln-963"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IHitObs</span>              <span class="o">=</span><span class="mi">0</span>   <span class="c">! &gt; 0 if obstruction is hit</span>
<a name="ln-964"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HitPtObs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Hit point on obstruction (m)</span>
<a name="ln-965"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">IHitObsRefl</span>          <span class="o">=</span><span class="mi">0</span>   <span class="c">! &gt; 0 if obstruction hit between rec. pt. and reflection point</span>
<a name="ln-966"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ObsSurfNum</span>           <span class="o">=</span><span class="mi">0</span>   <span class="c">! Obstruction surface number</span>
<a name="ln-967"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ReflSurfNum</span>          <span class="o">=</span><span class="mi">0</span>   <span class="c">! Reflecting surface number</span>
<a name="ln-968"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ReflSurfRecNum</span>       <span class="o">=</span><span class="mi">0</span>   <span class="c">! Receiving surface number corresponding to a reflecting surface number</span>
<a name="ln-969"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ReflNorm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Unit normal to reflecting surface</span>
<a name="ln-970"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ReflBmToBmSolObs</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">)</span> <span class="c">! Irradiance at a receiving point for</span>
<a name="ln-971"></a>                                            <span class="c">! beam solar specularly reflected from obstructions, divided by</span>
<a name="ln-972"></a>                                            <span class="c">! beam normal irradiance</span>
<a name="ln-973"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ReflDistance</span>         <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Distance from receiving point to hit point on a reflecting surface (m)</span>
<a name="ln-974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ObsDistance</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Distance from receiving point to hit point on an obstruction (m)</span>
<a name="ln-975"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SpecReflectance</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Specular reflectance of a reflecting surface</span>
<a name="ln-976"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">ConstrNumRefl</span>        <span class="o">=</span><span class="mi">0</span>   <span class="c">! Construction number of a reflecting surface</span>
<a name="ln-977"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CosIncAngRefl</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cosine of incidence angle of beam on reflecting surface</span>
<a name="ln-978"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CosIncAngRec</span>         <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Angle of incidence of reflected beam on receiving surface</span>
<a name="ln-979"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ReflFac</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Contribution to specular reflection factor</span>
<a name="ln-980"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ReflFacTimesCosIncSum</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">)</span> <span class="c">! Sum of ReflFac times CosIncAngRefl</span>
<a name="ln-981"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CosIncWeighted</span>       <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cosine of incidence angle on receiving surf weighted by reflection factor</span>
<a name="ln-982"></a>
<a name="ln-983"></a>
<a name="ln-984"></a>  <span class="n">ReflBmToDiffSolObs</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-985"></a>  <span class="n">ReflFacTimesCosIncSum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-986"></a>
<a name="ln-987"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SunCosHr</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! Skip if sun is below horizon</span>
<a name="ln-988"></a>
<a name="ln-989"></a>  <span class="c">! Unit vector to sun</span>
<a name="ln-990"></a>  <span class="n">SunVec</span> <span class="o">=</span> <span class="n">SunCosHr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-991"></a>
<a name="ln-992"></a>  <span class="k">DO </span><span class="n">RecSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSolReflRecSurf</span>
<a name="ln-993"></a>    <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">SurfNum</span>
<a name="ln-994"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-995"></a><span class="k">      </span><span class="n">ReflBmToBmSolObs</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-996"></a>      <span class="n">ReflFacTimesCosIncSum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-997"></a>      <span class="c">! Find possible reflecting surfaces for this receiving surface</span>
<a name="ln-998"></a>      <span class="k">DO </span><span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span>
<a name="ln-999"></a>        <span class="n">ReflSurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a name="ln-1000"></a>        <span class="c">! Keep windows; keep shading surfaces with specular reflectance</span>
<a name="ln-1001"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1002"></a>            <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1003"></a>            <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1004"></a>          <span class="c">! Skip if window and not sunlit</span>
<a name="ln-1005"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SunlitFrac</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1006"></a>          <span class="c">! Check if sun is in front of this reflecting surface.</span>
<a name="ln-1007"></a>          <span class="n">ReflNorm</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1008"></a>          <span class="n">CosIncAngRefl</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SunVec</span><span class="p">,</span><span class="n">ReflNorm</span><span class="p">)</span>
<a name="ln-1009"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">CosIncAngRefl</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1010"></a>
<a name="ln-1011"></a>          <span class="c">! Get sun position unit vector for mirror image of sun in reflecting surface</span>
<a name="ln-1012"></a>          <span class="n">SunVecMir</span> <span class="o">=</span> <span class="n">SunVec</span> <span class="o">-</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SunVec</span><span class="p">,</span><span class="n">ReflNorm</span><span class="p">)</span><span class="o">*</span><span class="n">ReflNorm</span>
<a name="ln-1013"></a>          <span class="c">! Angle of incidence of reflected beam on receiving surface</span>
<a name="ln-1014"></a>          <span class="n">CosIncAngRec</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span><span class="p">,</span><span class="n">SunVecMir</span><span class="p">)</span>
<a name="ln-1015"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">CosIncAngRec</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1016"></a><span class="k">          DO </span><span class="n">RecPtNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span>
<a name="ln-1017"></a>            <span class="c">! See if ray from receiving point to mirrored sun hits the reflecting surface</span>
<a name="ln-1018"></a>            <span class="n">RecPt</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RecPt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">)</span>
<a name="ln-1019"></a>            <span class="k">CALL </span><span class="n">PierceSurface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">,</span> <span class="n">RecPt</span><span class="p">,</span> <span class="n">SunVecMir</span><span class="p">,</span> <span class="n">IHitRefl</span><span class="p">,</span> <span class="n">HitPtRefl</span><span class="p">)</span>
<a name="ln-1020"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IHitRefl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1021"></a>              <span class="c">! Reflecting surface was hit</span>
<a name="ln-1022"></a>              <span class="n">ReflDistance</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">HitPtRefl</span><span class="o">-</span><span class="n">RecPt</span><span class="p">,</span><span class="n">HitPtRefl</span><span class="o">-</span><span class="n">RecPt</span><span class="p">))</span>
<a name="ln-1023"></a>              <span class="c">! Determine if ray from receiving point to hit point is obstructed</span>
<a name="ln-1024"></a>              <span class="n">IHitObsRefl</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1025"></a>              <span class="k">DO </span><span class="n">loop2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span>
<a name="ln-1026"></a>                <span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span><span class="p">(</span><span class="n">loop2</span><span class="p">)</span>
<a name="ln-1027"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">ReflSurfNum</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1028"></a><span class="k">                CALL </span><span class="n">PierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">RecPt</span><span class="p">,</span><span class="n">SunVecMir</span><span class="p">,</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">HitPtObs</span><span class="p">)</span>
<a name="ln-1029"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1030"></a><span class="k">                  </span><span class="n">ObsDistance</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">HitPtObs</span><span class="o">-</span><span class="n">RecPt</span><span class="p">,</span><span class="n">HitPtObs</span><span class="o">-</span><span class="n">RecPt</span><span class="p">))</span>
<a name="ln-1031"></a>                    <span class="k">IF</span><span class="p">(</span><span class="n">ObsDistance</span> <span class="o">&lt;</span> <span class="n">ReflDistance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1032"></a><span class="k">                    </span><span class="n">IHitObsRefl</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1033"></a>                    <span class="k">EXIT</span>
<a name="ln-1034"></a><span class="k">                  END IF</span>
<a name="ln-1035"></a><span class="k">                END IF</span>
<a name="ln-1036"></a><span class="k">              END DO</span>
<a name="ln-1037"></a><span class="k">              IF</span><span class="p">(</span><span class="n">IHitObsRefl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Obstruct&#39;n closer than reflect&#39;n pt. was hit; go to next rec. pt.</span>
<a name="ln-1038"></a>              <span class="c">! There is no obstruction for this ray between rec. pt. and hit point on reflecting surface.</span>
<a name="ln-1039"></a>              <span class="c">! See if ray from hit pt. on reflecting surface to original (unmirrored) sun position is obstructed</span>
<a name="ln-1040"></a>              <span class="n">IHitObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1041"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1042"></a>                <span class="c">! Reflecting surface is a window.</span>
<a name="ln-1043"></a>                <span class="c">! Receiving surface number for this window.</span>
<a name="ln-1044"></a>                <span class="n">ReflSurfRecNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfRecSurfNum</span>
<a name="ln-1045"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ReflSurfRecNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1046"></a>                  <span class="c">! Loop over possible obstructions for this window</span>
<a name="ln-1047"></a>                  <span class="k">DO </span><span class="n">loop2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">ReflSurfRecNum</span><span class="p">)%</span><span class="n">NumPossibleObs</span>
<a name="ln-1048"></a>                    <span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">ReflSurfRecNum</span><span class="p">)%</span><span class="n">PossibleObsSurfNums</span><span class="p">(</span><span class="n">loop2</span><span class="p">)</span>
<a name="ln-1049"></a>                    <span class="k">CALL </span><span class="n">PierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">HitPtRefl</span><span class="p">,</span><span class="n">SunVec</span><span class="p">,</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">HitPtObs</span><span class="p">)</span>
<a name="ln-1050"></a>                    <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-1051"></a><span class="k">                  END DO</span>
<a name="ln-1052"></a><span class="k">                END IF</span>
<a name="ln-1053"></a><span class="k">              ELSE</span>
<a name="ln-1054"></a>                <span class="c">! Reflecting surface is a building shade</span>
<a name="ln-1055"></a>                <span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-1056"></a>                  <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1057"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">ReflSurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1058"></a>
<a name="ln-1059"></a>                  <span class="c">!TH2 CR8959 -- Skip mirrored surfaces</span>
<a name="ln-1060"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1061"></a>                  <span class="c">!TH2 CR8959 -- The other side of a mirrored surface cannot obstruct the mirrored surface</span>
<a name="ln-1062"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1063"></a><span class="k">                    IF</span> <span class="p">(</span><span class="n">ObsSurfNum</span> <span class="o">==</span> <span class="n">ReflSurfNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1064"></a><span class="k">                  END IF</span>
<a name="ln-1065"></a>
<a name="ln-1066"></a><span class="k">                  CALL </span><span class="n">PierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">HitPtRefl</span><span class="p">,</span><span class="n">SunVec</span><span class="p">,</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">HitPtObs</span><span class="p">)</span>
<a name="ln-1067"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-1068"></a><span class="k">                END DO</span>
<a name="ln-1069"></a><span class="k">              END IF</span>
<a name="ln-1070"></a>
<a name="ln-1071"></a><span class="k">              IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Obstruct&#39;n hit between reflect&#39;n hit point and sun; go to next receiving pt.</span>
<a name="ln-1072"></a>
<a name="ln-1073"></a>              <span class="c">! No obstructions. Calculate reflected beam irradiance at receiving pt. from this reflecting surface.</span>
<a name="ln-1074"></a>              <span class="n">SpecReflectance</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1075"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1076"></a><span class="k">                </span><span class="n">ConstrNumRefl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-1077"></a>                <span class="n">SpecReflectance</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosIncAngRefl</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumRefl</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1078"></a>              <span class="k">END IF</span>
<a name="ln-1079"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1080"></a><span class="k">                </span><span class="n">ConstrNumRefl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingConstruct</span>
<a name="ln-1081"></a>                <span class="n">SpecReflectance</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ReflSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfGlazingFrac</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-1082"></a>                   <span class="n">POLYF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosIncAngRefl</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumRefl</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-1083"></a>              <span class="n">ENDIF</span>
<a name="ln-1084"></a>              <span class="c">! Angle of incidence of reflected beam on receiving surface</span>
<a name="ln-1085"></a>              <span class="n">CosIncAngRec</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NormVec</span><span class="p">,</span><span class="n">SunVecMir</span><span class="p">)</span>
<a name="ln-1086"></a>              <span class="n">ReflFac</span> <span class="o">=</span> <span class="n">SpecReflectance</span> <span class="o">*</span> <span class="n">CosIncAngRec</span>
<a name="ln-1087"></a>              <span class="c">! Contribution to specular reflection factor</span>
<a name="ln-1088"></a>              <span class="n">ReflBmToBmSolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflBmToBmSolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">ReflFac</span>
<a name="ln-1089"></a>              <span class="n">ReflFacTimesCosIncSum</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacTimesCosIncSum</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">ReflFac</span><span class="o">*</span><span class="n">CosIncAngRec</span>
<a name="ln-1090"></a>            <span class="k">END IF</span>  <span class="c">! End of check if reflecting surface was hit</span>
<a name="ln-1091"></a>          <span class="k">END DO</span>  <span class="c">! End of loop over receiving points</span>
<a name="ln-1092"></a>        <span class="k">END IF</span>  <span class="c">! End of check if valid reflecting surface</span>
<a name="ln-1093"></a>      <span class="k">END DO</span>  <span class="c">! End of loop over obstructing surfaces</span>
<a name="ln-1094"></a>      <span class="c">! Average over receiving points</span>
<a name="ln-1095"></a>      <span class="n">NumRecPts</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span>
<a name="ln-1096"></a>
<a name="ln-1097"></a>      <span class="k">DO </span><span class="n">RecPtNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumRecPts</span>
<a name="ln-1098"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ReflBmToBmSolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1099"></a><span class="k">          </span><span class="n">CosIncWeighted</span> <span class="o">=</span> <span class="n">ReflFacTimesCosIncSum</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">/</span> <span class="n">ReflBmToBmSolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span>
<a name="ln-1100"></a>        <span class="k">ELSE</span>
<a name="ln-1101"></a><span class="k">          </span><span class="n">CosIncWeighted</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1102"></a>        <span class="n">ENDIF</span>
<a name="ln-1103"></a>        <span class="n">CosIncAveBmToBmSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">CosIncAveBmToBmSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">CosIncWeighted</span>
<a name="ln-1104"></a>        <span class="n">ReflFacBmToBmSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacBmToBmSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">+</span> <span class="n">ReflBmToBmSolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span>
<a name="ln-1105"></a>      <span class="k">END DO</span>
<a name="ln-1106"></a><span class="k">      </span><span class="n">ReflFacBmToBmSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacBmToBmSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">NumRecPts</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-1107"></a>      <span class="n">CosIncAveBmToBmSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">CosIncAveBmToBmSolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">NumRecPts</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-1108"></a>    <span class="k">END IF</span> <span class="c">! End of check if number of possible obstructions &gt; 0</span>
<a name="ln-1109"></a>  <span class="k">END DO</span>  <span class="c">! End of loop over receiving surfaces</span>
<a name="ln-1110"></a>
<a name="ln-1111"></a>  <span class="k">RETURN</span>
<a name="ln-1112"></a>
<a name="ln-1113"></a><span class="k">END SUBROUTINE </span><span class="n">FigureBeamSolSpecularReflFactors</span>
<a name="ln-1114"></a>
<a name="ln-1115"></a><span class="c">!=================================================================================================</span>
<a name="ln-1116"></a>
<a name="ln-1117"></a><span class="k">SUBROUTINE </span><span class="n">CalcSkySolDiffuseReflFactors</span>
<a name="ln-1118"></a>
<a name="ln-1119"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1120"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-1121"></a>          <span class="c">!       DATE WRITTEN   October 2003</span>
<a name="ln-1122"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1123"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1124"></a>
<a name="ln-1125"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1126"></a>          <span class="c">! Calculates factors for irradiance on exterior heat transfer surfaces due to</span>
<a name="ln-1127"></a>          <span class="c">! reflection of sky diffuse solar radiation from obstructions and ground.</span>
<a name="ln-1128"></a>
<a name="ln-1129"></a>          <span class="c">! METHODOLOGY EMPLOYED: na</span>
<a name="ln-1130"></a>
<a name="ln-1131"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-1132"></a>
<a name="ln-1133"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1134"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span>
<a name="ln-1135"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-1136"></a>
<a name="ln-1137"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1138"></a>
<a name="ln-1139"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-1140"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-1141"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-1142"></a>
<a name="ln-1143"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1144"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RecSurfNum</span>           <span class="o">=</span><span class="mi">0</span> <span class="c">! Receiving surface number</span>
<a name="ln-1145"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">SurfNum</span>              <span class="o">=</span><span class="mi">0</span> <span class="c">! Heat transfer surface number corresponding to RecSurfNum</span>
<a name="ln-1146"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ObsSurfNum</span>           <span class="o">=</span><span class="mi">0</span> <span class="c">! Obstruction surface number</span>
<a name="ln-1147"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RecPtNum</span>             <span class="o">=</span><span class="mi">0</span> <span class="c">! Receiving point number</span>
<a name="ln-1148"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumRecPts</span>            <span class="o">=</span><span class="mi">0</span> <span class="c">! Number of receiving points on a receiving surface</span>
<a name="ln-1149"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HitPtSurfNum</span>         <span class="o">=</span><span class="mi">0</span> <span class="c">! Surface number of hit point: -1 = ground,</span>
<a name="ln-1150"></a>                                    <span class="c">! 0 = sky or obstruction with receiving point below ground level,</span>
<a name="ln-1151"></a>                                    <span class="c">! &gt;0 = obstruction with receiving point above ground level</span>
<a name="ln-1152"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">HitPtSurfNumX</span>        <span class="o">=</span><span class="mi">0</span> <span class="c">! For a shading surface, HitPtSurfNum for original surface,</span>
<a name="ln-1153"></a>                                    <span class="c">! HitPitSurfNum + 1 for mirror surface</span>
<a name="ln-1154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflSkySolObs</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">)</span> <span class="c">! Irradiance at a receiving point for sky diffuse solar</span>
<a name="ln-1155"></a>                                    <span class="c">! reflected from obstructions, divided by unobstructed</span>
<a name="ln-1156"></a>                                    <span class="c">! sky diffuse horizontal irradiance</span>
<a name="ln-1157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReflSkySolGnd</span><span class="p">(</span><span class="n">MaxRecPts</span><span class="p">)</span> <span class="c">! Irradiance at a receiving point for sky diffuse solar</span>
<a name="ln-1158"></a>                                    <span class="c">! reflected from ground, divided by unobstructed</span>
<a name="ln-1159"></a>                                    <span class="c">! sky diffuse horizontal irradiance</span>
<a name="ln-1160"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">RayNum</span>               <span class="o">=</span><span class="mi">0</span> <span class="c">! Ray number</span>
<a name="ln-1161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitPtRefl</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>         <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Coordinates of hit point on obstruction or ground (m)</span>
<a name="ln-1162"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IHitObs</span>              <span class="o">=</span><span class="mi">0</span> <span class="c">! &gt; 0 if obstruction is hit; otherwise = 0</span>
<a name="ln-1163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HitPtObs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Hit point on an obstruction (m)</span>
<a name="ln-1164"></a><span class="c">!unused  REAL(r64)         :: ObsHitPt(3)          =0.0 ! Hit point on obstruction (m)</span>
<a name="ln-1165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dOmega</span>               <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Solid angle increment (steradians)</span>
<a name="ln-1166"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosIncAngRayToSky</span>            <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cosine of incidence angle on ground of ray to sky</span>
<a name="ln-1167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SkyReflSolRadiance</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Reflected radiance at hit point divided by unobstructed</span>
<a name="ln-1168"></a>                                    <span class="c">!  sky diffuse horizontal irradiance</span>
<a name="ln-1169"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dReflSkySol</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Contribution to reflection factor at a receiving point</span>
<a name="ln-1170"></a>                                    <span class="c">!  from sky solar reflected from a hit point</span>
<a name="ln-1171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Phi</span>                  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Altitude angle and increment (radians)</span>
<a name="ln-1172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DPhi</span>                 <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Altitude angle and increment (radians)</span>
<a name="ln-1173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SPhi</span>                 <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sine of Phi</span>
<a name="ln-1174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CPhi</span>                 <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cosine of Phi</span>
<a name="ln-1175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Theta</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Azimuth angle (radians)</span>
<a name="ln-1176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DTheta</span>               <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Azimuth increment (radians)</span>
<a name="ln-1177"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">IPhi</span>                 <span class="o">=</span><span class="mi">0</span> <span class="c">! Altitude angle index</span>
<a name="ln-1178"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ITheta</span>               <span class="o">=</span><span class="mi">0</span> <span class="c">! Azimuth angle index</span>
<a name="ln-1179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">URay</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>              <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Unit vector along ray from ground hit point</span>
<a name="ln-1180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfVertToGndPt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Vector from a vertex of possible obstructing surface to ground</span>
<a name="ln-1181"></a>                                    <span class="c">!  hit point (m)</span>
<a name="ln-1182"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfVert</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Surface vertex (m)</span>
<a name="ln-1183"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dReflSkyGnd</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Factor for ground radiance due to direct sky diffuse reflection</span>
<a name="ln-1184"></a>          <span class="c">! FLOW:</span>
<a name="ln-1185"></a>
<a name="ln-1186"></a><span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Calculating Sky Diffuse Exterior Solar Reflection Factors&#39;</span><span class="p">)</span>
<a name="ln-1187"></a><span class="n">ReflSkySolObs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1188"></a><span class="n">ReflSkySolGnd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1189"></a>
<a name="ln-1190"></a><span class="k">DO </span><span class="n">RecSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSolReflRecSurf</span>
<a name="ln-1191"></a>  <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">SurfNum</span>
<a name="ln-1192"></a>  <span class="k">DO </span><span class="n">RecPtNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span>
<a name="ln-1193"></a>    <span class="n">ReflSkySolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1194"></a>    <span class="n">ReflSkySolGnd</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1195"></a>    <span class="k">DO </span><span class="n">RayNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumReflRays</span>
<a name="ln-1196"></a>      <span class="n">HitPtSurfNum</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSurfNum</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span>
<a name="ln-1197"></a>      <span class="c">! Skip rays that do not hit an obstruction or ground.</span>
<a name="ln-1198"></a>      <span class="c">! (Note that if a downgoing ray does not hit an obstruction it will have HitPtSurfNum = 0</span>
<a name="ln-1199"></a>      <span class="c">! if the receiving point is below ground level (see subr. InitSolReflRecSurf); this means</span>
<a name="ln-1200"></a>      <span class="c">! that a below-ground-level receiving point receives no ground-reflected radiation although</span>
<a name="ln-1201"></a>      <span class="c">! it is allowed to receive obstruction-reflected solar radiation and direct (unreflected)</span>
<a name="ln-1202"></a>      <span class="c">! beam and sky solar radiation. As far as reflected solar is concerned, the program does</span>
<a name="ln-1203"></a>      <span class="c">! not handle a sloped ground plane or a horizontal ground plane whose level is different</span>
<a name="ln-1204"></a>      <span class="c">! from one side of the building to another.)</span>
<a name="ln-1205"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HitPtSurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Ray hits sky or obstruction with receiving pt. below ground level</span>
<a name="ln-1206"></a>      <span class="n">HitPtRefl</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span>
<a name="ln-1207"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HitPtSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1208"></a>        <span class="c">! Ray hits an obstruction</span>
<a name="ln-1209"></a>        <span class="c">! Skip hit points on daylighting shelves, from which solar reflection is separately calculated</span>
<a name="ln-1210"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="p">)%</span><span class="n">Shelf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1211"></a>        <span class="c">! Reflected radiance at hit point divided by unobstructed sky diffuse horizontal irradiance</span>
<a name="ln-1212"></a>        <span class="n">HitPtSurfNumX</span> <span class="o">=</span> <span class="n">HitPtSurfNum</span>
<a name="ln-1213"></a>        <span class="c">! Each shading surface has a &quot;mirror&quot; duplicate surface facing in the opposite direction.</span>
<a name="ln-1214"></a>        <span class="c">! The following gets the correct side of a shading surface in order to get the right value</span>
<a name="ln-1215"></a>        <span class="c">! of DifShdgRatioIsoSky (the two sides can have different sky shadowing).</span>
<a name="ln-1216"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1217"></a><span class="k">          IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">RayVec</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">RayNum</span><span class="p">),</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1218"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">HitPtSurfNum</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">TotSurfaces</span><span class="p">)</span> <span class="n">HitPtSurfNumX</span> <span class="o">=</span> <span class="n">HitPtSurfNum</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1219"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNumX</span><span class="p">)%</span><span class="n">Shelf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1220"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-1221"></a>        <span class="k">END IF</span>
<a name="ln-1222"></a>
<a name="ln-1223"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span>  <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1224"></a>            <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1225"></a><span class="k">          </span><span class="n">SkyReflSolRadiance</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNumX</span><span class="p">)%</span><span class="n">ViewFactorSky</span> <span class="o">*</span> <span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">HitPtSurfNumX</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-1226"></a>                                 <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSolRefl</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span>
<a name="ln-1227"></a>        <span class="k">ELSE</span>
<a name="ln-1228"></a><span class="k">          </span><span class="n">SkyReflSolRadiance</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HitPtSurfNumX</span><span class="p">)%</span><span class="n">ViewFactorSky</span> <span class="o">*</span> <span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">HitPtSurfNumX</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-1229"></a>                                 <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">HitPtSolRefl</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">,</span><span class="n">RayNum</span><span class="p">)</span>
<a name="ln-1230"></a>        <span class="n">ENDIF</span>
<a name="ln-1231"></a>        <span class="n">dReflSkySol</span> <span class="o">=</span> <span class="n">SkyReflSolRadiance</span> <span class="o">*</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">dOmegaRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1232"></a>                                 <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">CosIncAngRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span><span class="o">/</span><span class="n">Pi</span>
<a name="ln-1233"></a>        <span class="n">ReflSkySolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflSkySolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">dReflSkySol</span>
<a name="ln-1234"></a>      <span class="k">ELSE</span>
<a name="ln-1235"></a>        <span class="c">! Ray hits ground;</span>
<a name="ln-1236"></a>        <span class="c">! Find radiance at hit point due to reflection of sky diffuse reaching</span>
<a name="ln-1237"></a>        <span class="c">! ground directly, i.e., without reflecting from obstructions.</span>
<a name="ln-1238"></a>        <span class="c">! Send rays upward from hit point and see which ones are unobstructed and so go to sky.</span>
<a name="ln-1239"></a>        <span class="c">! Divide hemisphere centered at ground hit point into elements of altitude Phi and</span>
<a name="ln-1240"></a>        <span class="c">! azimuth Theta and create upward-going ray unit vector at each Phi,Theta pair.</span>
<a name="ln-1241"></a>        <span class="c">! Phi = 0 at the horizon; Phi = Pi/2 at the zenith.</span>
<a name="ln-1242"></a>        <span class="n">DPhi</span> <span class="o">=</span> <span class="n">PiOvr2</span> <span class="o">/</span> <span class="p">(</span><span class="n">AltAngStepsForSolReflCalc</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span>
<a name="ln-1243"></a>        <span class="n">dReflSkyGnd</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1244"></a>        <span class="c">! Altitude loop</span>
<a name="ln-1245"></a>        <span class="k">DO </span><span class="n">IPhi</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,(</span><span class="n">AltAngStepsForSolReflCalc</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1246"></a>          <span class="n">Phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">IPhi</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DPhi</span>
<a name="ln-1247"></a>          <span class="n">SPhi</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<a name="ln-1248"></a>          <span class="n">CPhi</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<a name="ln-1249"></a>          <span class="c">! Third component of ray unit vector in (Theta,Phi) direction</span>
<a name="ln-1250"></a>          <span class="n">URay</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">SPhi</span>
<a name="ln-1251"></a>          <span class="n">DTheta</span> <span class="o">=</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Pi</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="n">AzimAngStepsForSolReflCalc</span><span class="p">)</span>
<a name="ln-1252"></a>          <span class="n">dOmega</span> <span class="o">=</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="n">DTheta</span> <span class="o">*</span> <span class="n">DPhi</span>
<a name="ln-1253"></a>          <span class="c">! Cosine of angle of incidence of ray on ground</span>
<a name="ln-1254"></a>          <span class="n">CosIncAngRayToSky</span> <span class="o">=</span> <span class="n">SPhi</span>
<a name="ln-1255"></a>          <span class="c">! Azimuth loop</span>
<a name="ln-1256"></a>          <span class="k">DO </span><span class="n">ITheta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">AzimAngStepsForSolReflCalc</span>
<a name="ln-1257"></a>            <span class="n">Theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">ITheta</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DTheta</span>
<a name="ln-1258"></a>            <span class="n">URay</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-1259"></a>            <span class="n">URay</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhi</span> <span class="o">*</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-1260"></a>            <span class="c">! Does this ray hit an obstruction?</span>
<a name="ln-1261"></a>            <span class="n">IHitObs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1262"></a>            <span class="k">DO </span><span class="n">ObsSurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-1263"></a>              <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowSurfPossibleObstruction</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1264"></a>              <span class="c">! Horizontal roof surfaces cannot be obstructions for rays from ground</span>
<a name="ln-1265"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mf">5.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1266"></a><span class="k">              IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1267"></a><span class="k">                IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">URay</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1268"></a>                <span class="c">! Special test for vertical surfaces with URay dot OutNormVec &lt; 0; excludes</span>
<a name="ln-1269"></a>                <span class="c">! case where ground hit point is in back of ObsSurfNum</span>
<a name="ln-1270"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="mf">9.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1271"></a><span class="k">                  </span><span class="n">SurfVert</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1272"></a>                  <span class="n">SurfVertToGndPt</span> <span class="o">=</span> <span class="n">HitPtRefl</span> <span class="o">-</span> <span class="n">SurfVert</span>
<a name="ln-1273"></a>                  <span class="k">IF</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SurfVertToGndPt</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1274"></a><span class="k">                END IF</span>
<a name="ln-1275"></a><span class="k">              END IF</span>
<a name="ln-1276"></a><span class="k">              CALL </span><span class="n">PierceSurface</span><span class="p">(</span><span class="n">ObsSurfNum</span><span class="p">,</span><span class="n">HitPtRefl</span><span class="p">,</span><span class="n">URay</span><span class="p">,</span><span class="n">IHitObs</span><span class="p">,</span><span class="n">HitPtObs</span><span class="p">)</span>
<a name="ln-1277"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-1278"></a><span class="k">            END DO</span>
<a name="ln-1279"></a>
<a name="ln-1280"></a><span class="k">            IF</span><span class="p">(</span><span class="n">IHitObs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! Obstruction hit</span>
<a name="ln-1281"></a>            <span class="c">! Sky is hit</span>
<a name="ln-1282"></a>            <span class="n">dReflSkyGnd</span> <span class="o">=</span> <span class="n">dReflSkyGnd</span> <span class="o">+</span> <span class="n">CosIncAngRayToSky</span><span class="o">*</span><span class="n">dOmega</span><span class="o">/</span><span class="n">Pi</span>
<a name="ln-1283"></a>          <span class="k">END DO</span> <span class="c">! End of azimuth loop</span>
<a name="ln-1284"></a>        <span class="k">END DO</span>  <span class="c">! End of altitude loop</span>
<a name="ln-1285"></a>        <span class="n">ReflSkySolGnd</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflSkySolGnd</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">dReflSkyGnd</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-1286"></a>          <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">dOmegaRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">CosIncAngRay</span><span class="p">(</span><span class="n">RayNum</span><span class="p">)</span><span class="o">/</span><span class="n">Pi</span>
<a name="ln-1287"></a>      <span class="k">END IF</span>  <span class="c">! End of check if ray from receiving point hits obstruction or ground</span>
<a name="ln-1288"></a>    <span class="k">END DO</span>  <span class="c">! End of loop over rays from receiving point</span>
<a name="ln-1289"></a>  <span class="k">END DO</span>  <span class="c">! End of loop over receiving points</span>
<a name="ln-1290"></a>
<a name="ln-1291"></a>  <span class="c">! Average over receiving points</span>
<a name="ln-1292"></a>  <span class="n">ReflFacSkySolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1293"></a>  <span class="n">ReflFacSkySolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1294"></a>  <span class="n">NumRecPts</span> <span class="o">=</span> <span class="n">SolReflRecSurf</span><span class="p">(</span><span class="n">RecSurfNum</span><span class="p">)%</span><span class="n">NumRecPts</span>
<a name="ln-1295"></a>  <span class="k">DO </span><span class="n">RecPtNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumRecPts</span>
<a name="ln-1296"></a>    <span class="n">ReflFacSkySolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacSkySolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">ReflSkySolObs</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span>
<a name="ln-1297"></a>    <span class="n">ReflFacSkySolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacSkySolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">ReflSkySolGnd</span><span class="p">(</span><span class="n">RecPtNum</span><span class="p">)</span>
<a name="ln-1298"></a>  <span class="k">END DO</span>
<a name="ln-1299"></a><span class="k">  </span><span class="n">ReflFacSkySolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacSkySolObs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">/</span><span class="n">NumRecPts</span>
<a name="ln-1300"></a>  <span class="n">ReflFacSkySolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ReflFacSkySolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">/</span><span class="n">NumRecPts</span>
<a name="ln-1301"></a>  <span class="c">! Do not allow ReflFacBmToDiffSolGnd to exceed the surface&#39;s unobstructed ground view factor</span>
<a name="ln-1302"></a>  <span class="n">ReflFacSkySolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1303"></a>                                           <span class="n">ReflFacSkySolGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span>
<a name="ln-1304"></a>  <span class="c">! Note: the above factors are dimensionless; they are equal to</span>
<a name="ln-1305"></a>  <span class="c">! (W/m2 reflected solar incident on SurfNum)/(W/m2 unobstructed horizontal sky diffuse irradiance)</span>
<a name="ln-1306"></a><span class="k">END DO</span>  <span class="c">! End of loop over receiving surfaces</span>
<a name="ln-1307"></a>
<a name="ln-1308"></a><span class="k">RETURN</span>
<a name="ln-1309"></a><span class="k">END SUBROUTINE </span><span class="n">CalcSkySolDiffuseReflFactors</span>
<a name="ln-1310"></a>
<a name="ln-1311"></a>
<a name="ln-1312"></a><span class="c">!=================================================================================================</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a><span class="k">SUBROUTINE </span><span class="n">CrossProduct</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<a name="ln-1315"></a>
<a name="ln-1316"></a>  <span class="c">! Cross product between vectors A and B</span>
<a name="ln-1317"></a>
<a name="ln-1318"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1319"></a>
<a name="ln-1320"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>          <span class="c">! Vector components: C = A X B</span>
<a name="ln-1322"></a>
<a name="ln-1323"></a>          <span class="c">! FLOW:</span>
<a name="ln-1324"></a>  <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1325"></a>  <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1326"></a>  <span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1327"></a>
<a name="ln-1328"></a>  <span class="k">RETURN</span>
<a name="ln-1329"></a>
<a name="ln-1330"></a><span class="k">END SUBROUTINE </span><span class="n">CrossProduct</span>
<a name="ln-1331"></a>
<a name="ln-1332"></a><span class="k">SUBROUTINE </span><span class="n">PierceSurface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span> <span class="n">R1</span><span class="p">,</span> <span class="n">RN</span><span class="p">,</span> <span class="n">IPIERC</span><span class="p">,</span> <span class="n">CPhit</span><span class="p">)</span>
<a name="ln-1333"></a>
<a name="ln-1334"></a>
<a name="ln-1335"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1336"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-1337"></a>          <span class="c">!       DATE WRITTEN   July 1997</span>
<a name="ln-1338"></a>          <span class="c">!       MODIFIED       Sept 2003, FCW: modification of Daylighting routine DayltgPierceSurface</span>
<a name="ln-1339"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1340"></a>
<a name="ln-1341"></a>
<a name="ln-1342"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1343"></a>          <span class="c">! Returns point CPhit that line through point R1 in direction of unit vector RN intersects</span>
<a name="ln-1344"></a>          <span class="c">! the plan of surface ISurf. IPIERC = 1 if CPhit is inside the perimeter of ISurf. If not,</span>
<a name="ln-1345"></a>          <span class="c">! IPIERC = 0. This routine works for convex and concave surfaces with 3 or more vertices.</span>
<a name="ln-1346"></a>          <span class="c">!</span>
<a name="ln-1347"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1348"></a>
<a name="ln-1349"></a>
<a name="ln-1350"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1351"></a>          <span class="c">! Based on DOE-2.1E subroutine DPIERC.</span>
<a name="ln-1352"></a>
<a name="ln-1353"></a>
<a name="ln-1354"></a>          <span class="c">! USE STATEMENTS:na</span>
<a name="ln-1355"></a>
<a name="ln-1356"></a>
<a name="ln-1357"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1358"></a>
<a name="ln-1359"></a>
<a name="ln-1360"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:na</span>
<a name="ln-1361"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:na</span>
<a name="ln-1362"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:na</span>
<a name="ln-1363"></a>
<a name="ln-1364"></a>
<a name="ln-1365"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1366"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ISurf</span>      <span class="c">! Surface index</span>
<a name="ln-1367"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">R1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>      <span class="c">! Point from which ray originates</span>
<a name="ln-1368"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">RN</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>      <span class="c">! Unit vector along in direction of ray whose</span>
<a name="ln-1369"></a>                                             <span class="c">!  intersection with surface is to be determined</span>
<a name="ln-1370"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">IPIERC</span>     <span class="c">! =1 if line through point R1 in direction of unit vector</span>
<a name="ln-1371"></a>                                             <span class="c">!  RN intersects surface ISurf; =0 otherwise.</span>
<a name="ln-1372"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c">! Point that ray along RN intersects plane of surface</span>
<a name="ln-1373"></a>
<a name="ln-1374"></a>
<a name="ln-1375"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1376"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NV</span>                       <span class="c">! Number of vertices (3 or 4)</span>
<a name="ln-1377"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AXC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c">! Cross product of A and C</span>
<a name="ln-1378"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SN</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                    <span class="c">! Vector normal to surface (SN = A1 X A2)</span>
<a name="ln-1379"></a><span class="c">!unused  REAL(r64) :: AA(3)                    ! AA(I) = A(N,I)</span>
<a name="ln-1380"></a><span class="c">!unused  REAL(r64) :: CC(3)                    ! CC(I) = C(N,I)</span>
<a name="ln-1381"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CCC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c">! Vector from vertex 2 to CP</span>
<a name="ln-1382"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AAA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c">! Vector from vertex 2 to vertex 1</span>
<a name="ln-1383"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BBB</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c">! Vector from vertex 2 to vertex 3</span>
<a name="ln-1384"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">N</span>                        <span class="c">! Vertex loop index</span>
<a name="ln-1385"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F1</span><span class="p">,</span><span class="n">F2</span>                    <span class="c">! Intermediate variables</span>
<a name="ln-1386"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">SCALE</span>                    <span class="c">! Scale factor</span>
<a name="ln-1387"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DOTCB</span>                    <span class="c">! Dot product of vectors CCC and BBB</span>
<a name="ln-1388"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DOTCA</span>                    <span class="c">! Dot product of vectors CCC and AAA</span>
<a name="ln-1389"></a><span class="c">!unused  REAL(r64) :: DOTAXCSN                 ! Dot product of vectors AXC and SN</span>
<a name="ln-1390"></a>
<a name="ln-1391"></a>
<a name="ln-1392"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">V</span>     <span class="c">! Vertices of surfaces</span>
<a name="ln-1393"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">A</span>     <span class="c">! Vertex-to-vertex vectors; A(1,i) is from vertex 1 to 2, etc.</span>
<a name="ln-1394"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">C</span>     <span class="c">! Vectors from vertices to intersection point</span>
<a name="ln-1395"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">FirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1396"></a>
<a name="ln-1397"></a>
<a name="ln-1398"></a>          <span class="c">! FLOW:</span>
<a name="ln-1399"></a>  <span class="n">IPIERC</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1400"></a>
<a name="ln-1401"></a>
<a name="ln-1402"></a>  <span class="c">! Vertex vectors</span>
<a name="ln-1403"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTime</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1404"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1405"></a>    <span class="n">V</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1406"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1407"></a>    <span class="n">A</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1408"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1409"></a>    <span class="n">C</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1410"></a>    <span class="n">FirstTime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1411"></a>  <span class="n">ENDIF</span>
<a name="ln-1412"></a>
<a name="ln-1413"></a>
<a name="ln-1414"></a>  <span class="c">! Set the first two V &amp; A</span>
<a name="ln-1415"></a>  <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-1416"></a>  <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-1417"></a>  <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-1418"></a>
<a name="ln-1419"></a>
<a name="ln-1420"></a>  <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">X</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1421"></a>  <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Y</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1422"></a>  <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Z</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1423"></a>
<a name="ln-1424"></a>
<a name="ln-1425"></a>  <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-1426"></a>  <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-1427"></a>  <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-1428"></a>
<a name="ln-1429"></a>
<a name="ln-1430"></a>  <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">X</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1431"></a>  <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">Y</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1432"></a>  <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">Z</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1433"></a>
<a name="ln-1434"></a>
<a name="ln-1435"></a>  <span class="c">! Vector normal to surface</span>
<a name="ln-1436"></a>  <span class="n">SN</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1437"></a>  <span class="n">SN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1438"></a>  <span class="n">SN</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1439"></a>
<a name="ln-1440"></a>
<a name="ln-1441"></a>  <span class="c">! Scale factor, the solution of SN.(CPhit-V2) = 0 and</span>
<a name="ln-1442"></a>  <span class="c">! CPhit = R1 + SCALE*RN, where CPhit is the point that RN,</span>
<a name="ln-1443"></a>  <span class="c">! when extended, intersects the plane of the surface.</span>
<a name="ln-1444"></a>  <span class="n">F2</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SN</span><span class="p">,</span> <span class="n">RN</span><span class="p">)</span>
<a name="ln-1445"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01d0</span><span class="p">)</span> <span class="k">RETURN</span>   <span class="c">! Skip surfaces that are parallel to RN</span>
<a name="ln-1446"></a>  <span class="n">F1</span> <span class="o">=</span> <span class="n">SN</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">R1</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">SN</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">R1</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">SN</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">R1</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1447"></a>  <span class="c">!F1 = DOT_PRODUCT(SN, V2 - R1)</span>
<a name="ln-1448"></a>  <span class="nb">SCALE</span> <span class="o">=</span> <span class="n">F1</span> <span class="o">/</span> <span class="n">F2</span>
<a name="ln-1449"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">SCALE</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! Skip surfaces that RN points away from</span>
<a name="ln-1450"></a>  <span class="n">CPhit</span> <span class="o">=</span> <span class="n">R1</span> <span class="o">+</span> <span class="n">RN</span> <span class="o">*</span> <span class="nb">SCALE</span>  <span class="c">! Point that RN intersects plane of surface</span>
<a name="ln-1451"></a>
<a name="ln-1452"></a>
<a name="ln-1453"></a>  <span class="c">! Two cases: rectangle and non-rectangle; do rectangle</span>
<a name="ln-1454"></a>  <span class="c">! first since most common shape and faster calculation</span>
<a name="ln-1455"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">Rectangle</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">RectangularDoorWindow</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>         <span class="p">&amp;</span>
<a name="ln-1456"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">RectangularOverhang</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">RectangularLeftFin</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1457"></a>      <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="nb">Shape</span> <span class="o">==</span> <span class="n">RectangularRightFin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1458"></a>    <span class="c">!</span>
<a name="ln-1459"></a>    <span class="c">! Surface is rectangular</span>
<a name="ln-1460"></a>    <span class="c">!</span>
<a name="ln-1461"></a>    <span class="c">! Vectors from vertex 2 to vertex 1 and vertex 2 to vertex 3</span>
<a name="ln-1462"></a>
<a name="ln-1463"></a>
<a name="ln-1464"></a>    <span class="c">! Intersection point, CCC, is inside rectangle if</span>
<a name="ln-1465"></a>    <span class="c">! 0 &lt; CCC.BBB &lt; BBB.BBB AND 0 &lt; CCC.AAA &lt; AAA.AAA</span>
<a name="ln-1466"></a>
<a name="ln-1467"></a>
<a name="ln-1468"></a>    <span class="c">!CCC = CPhit - V2  ! Vector from vertex 2 to CPhit</span>
<a name="ln-1469"></a>    <span class="n">CCC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1470"></a>    <span class="n">CCC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1471"></a>    <span class="n">CCC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1472"></a>
<a name="ln-1473"></a>
<a name="ln-1474"></a>    <span class="c">! Set third V just for here</span>
<a name="ln-1475"></a>    <span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-1476"></a>    <span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-1477"></a>    <span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-1478"></a>
<a name="ln-1479"></a>
<a name="ln-1480"></a>    <span class="c">!BBB = V3 - V2</span>
<a name="ln-1481"></a>    <span class="n">BBB</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1482"></a>    <span class="n">BBB</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1483"></a>    <span class="n">BBB</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1484"></a>
<a name="ln-1485"></a>
<a name="ln-1486"></a>    <span class="n">DOTCB</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">CCC</span><span class="p">,</span> <span class="n">BBB</span><span class="p">)</span>
<a name="ln-1487"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DOTCB</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-1488"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DOTCB</span> <span class="o">&gt;</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">BBB</span><span class="p">,</span><span class="n">BBB</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-1489"></a>
<a name="ln-1490"></a>
<a name="ln-1491"></a>    <span class="c">!AAA = V1 - V2</span>
<a name="ln-1492"></a>    <span class="n">AAA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1493"></a>    <span class="n">AAA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1494"></a>    <span class="n">AAA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1495"></a>
<a name="ln-1496"></a>
<a name="ln-1497"></a>    <span class="n">DOTCA</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">CCC</span><span class="p">,</span> <span class="n">AAA</span><span class="p">)</span>
<a name="ln-1498"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DOTCA</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-1499"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">DOTCA</span> <span class="o">&gt;</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">AAA</span><span class="p">,</span><span class="n">AAA</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-1500"></a>    <span class="c">! Surface is intersected</span>
<a name="ln-1501"></a>    <span class="n">IPIERC</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1502"></a>
<a name="ln-1503"></a>
<a name="ln-1504"></a> <span class="k">ELSE</span>
<a name="ln-1505"></a>    <span class="c">!</span>
<a name="ln-1506"></a>    <span class="c">! Surface is not rectangular</span>
<a name="ln-1507"></a>    <span class="c">!</span>
<a name="ln-1508"></a>
<a name="ln-1509"></a>
<a name="ln-1510"></a>    <span class="c">!if (NV == 3) then</span>
<a name="ln-1511"></a>    <span class="c">!else ! NV=4</span>
<a name="ln-1512"></a>    <span class="c">!endif</span>
<a name="ln-1513"></a>
<a name="ln-1514"></a>
<a name="ln-1515"></a>    <span class="c">! First two of V &amp; A already set</span>
<a name="ln-1516"></a>    <span class="c">! test first vertex:</span>
<a name="ln-1517"></a>    <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1518"></a>    <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1519"></a>    <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1520"></a>    <span class="n">AXC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1521"></a>    <span class="n">AXC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1522"></a>    <span class="n">AXC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1523"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">AXC</span><span class="p">,</span><span class="n">SN</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! If at least one dot product is negative, intersection outside of surface</span>
<a name="ln-1524"></a>
<a name="ln-1525"></a>
<a name="ln-1526"></a>    <span class="c">! test second vertex:</span>
<a name="ln-1527"></a>    <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1528"></a>    <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1529"></a>    <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1530"></a>    <span class="n">AXC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1531"></a>    <span class="n">AXC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1532"></a>    <span class="n">AXC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1533"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">AXC</span><span class="p">,</span><span class="n">SN</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! If at least one dot product is negative, intersection outside of surface</span>
<a name="ln-1534"></a>
<a name="ln-1535"></a>
<a name="ln-1536"></a>    <span class="n">NV</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1537"></a>    <span class="c">! Since first two of V &amp; A already set, start with 3.  (so if NV=3, this loop won&#39;t happen)</span>
<a name="ln-1538"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span><span class="n">NV</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1539"></a>      <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-1540"></a>      <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-1541"></a>      <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-1542"></a>
<a name="ln-1543"></a>      <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">X</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1544"></a>      <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Y</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1545"></a>      <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">Z</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1546"></a>
<a name="ln-1547"></a>
<a name="ln-1548"></a>      <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1549"></a>      <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1550"></a>      <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1551"></a>
<a name="ln-1552"></a>
<a name="ln-1553"></a>      <span class="n">AXC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1554"></a>      <span class="n">AXC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1555"></a>      <span class="n">AXC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a>
<a name="ln-1558"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">AXC</span><span class="p">,</span><span class="n">SN</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! If at least one dot product is negative, intersection outside of surface</span>
<a name="ln-1559"></a>
<a name="ln-1560"></a>
<a name="ln-1561"></a>    <span class="k">END DO</span>
<a name="ln-1562"></a>
<a name="ln-1563"></a>
<a name="ln-1564"></a>    <span class="c">! Last vertex (NV=3 or NV=4)</span>
<a name="ln-1565"></a>    <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NV</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-1566"></a>    <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NV</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-1567"></a>    <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">NV</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-1568"></a>
<a name="ln-1569"></a>    <span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1570"></a>    <span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1571"></a>    <span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1572"></a>
<a name="ln-1573"></a>    <span class="n">C</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1574"></a>    <span class="n">C</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1575"></a>    <span class="n">C</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">CPhit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1576"></a>
<a name="ln-1577"></a>
<a name="ln-1578"></a>    <span class="n">AXC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1579"></a>    <span class="n">AXC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1580"></a>    <span class="n">AXC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">NV</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1581"></a>
<a name="ln-1582"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">AXC</span><span class="p">,</span><span class="n">SN</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! If at least one dot product is negative, intersection outside of surface</span>
<a name="ln-1583"></a>
<a name="ln-1584"></a>
<a name="ln-1585"></a>    <span class="n">IPIERC</span> <span class="o">=</span> <span class="mi">1</span>      <span class="c">! Surface is intersected</span>
<a name="ln-1586"></a>  <span class="k">END IF</span>
<a name="ln-1587"></a>
<a name="ln-1588"></a>
<a name="ln-1589"></a><span class="k">  RETURN</span>
<a name="ln-1590"></a>
<a name="ln-1591"></a><span class="k">END SUBROUTINE </span><span class="n">PierceSurface</span>
<a name="ln-1592"></a>
<a name="ln-1593"></a><span class="c">!     NOTICE</span>
<a name="ln-1594"></a><span class="c">!</span>
<a name="ln-1595"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-1596"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-1597"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-1598"></a><span class="c">!</span>
<a name="ln-1599"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-1600"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-1601"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-1602"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-1603"></a><span class="c">!</span>
<a name="ln-1604"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-1605"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-1606"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-1607"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-1608"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-1609"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-1610"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-1611"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-1612"></a><span class="c">!     permit others to do so.</span>
<a name="ln-1613"></a><span class="c">!</span>
<a name="ln-1614"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-1615"></a><span class="c">!</span>
<a name="ln-1616"></a>
<a name="ln-1617"></a><span class="k">END MODULE </span><span class="n">SolarReflectionManager</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
