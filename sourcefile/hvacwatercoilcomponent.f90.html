<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HVACWaterCoilComponent.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HVACWaterCoilComponent.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.3% of total for source files.">4838 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HVACWaterCoilComponent.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HVACWaterCoilComponent.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/watercoils.html">WaterCoils</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html#src">HVACWaterCoilComponent.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilehvacwatercoilcomponentf90EfferentGraph" width="641pt" height="1056pt"
 viewBox="0.00 0.00 641.00 1055.66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph" class="graph" transform="scale(.2333 .2333) rotate(0) translate(4 4521.5332)">
<title>sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-4521.5332 2743.9199,-4521.5332 2743.9199,4 -4,4"/>
<!-- sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~hvacwatercoilcomponent.f90</title>
<polygon fill="none" stroke="#000000" points="2739.8714,-2568.5282 2582.0656,-2568.5282 2582.0656,-2546.5174 2739.8714,-2546.5174 2739.8714,-2568.5282"/>
<text text-anchor="middle" x="2660.9685" y="-2554.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACWaterCoilComponent.f90</text>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-2684.5282 528.0262,-2684.5282 528.0262,-2662.5174 643.4123,-2662.5174 643.4123,-2684.5282"/>
<text text-anchor="middle" x="585.7192" y="-2670.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2490.9803,-3815.5228C2573.5271,-3715.5131 2647.9736,-2736.0704 2659.4415,-2578.7861"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.9513,-2578.7761 2660.1833,-2568.5493 2655.9696,-2578.2702 2662.9513,-2578.7761"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M969.4926,-3055.5228C1316.9827,-3092.9079 1441.8777,-2921.4981 1755.6028,-3075.5228 1840.5522,-3117.2291 1869.5762,-3131.5786 1918.6055,-3212.5228 1957.0425,-3275.9798 1903.8156,-3321.4433 1954.6055,-3375.5228 1990.9269,-3414.1967 2020.8554,-3386.954 2069.3291,-3408.5228 2227.5064,-3478.905 2285.8593,-3484.298 2399.9436,-3614.5228 2464.5666,-3688.2886 2428.5535,-3891.1561 2490.9803,-3815.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M590.0864,-2684.7173C602.4744,-2715.5522 640.2205,-2803.4138 690.4731,-2863.5228 787.0248,-2979.0117 819.8472,-3039.2076 969.4926,-3055.5228"/>
</g>
<!-- sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~setpointmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/setpointmanager.f90.html" xlink:title="SetPointManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2546.0539,-2568.5282 2435.9068,-2568.5282 2435.9068,-2546.5174 2546.0539,-2546.5174 2546.0539,-2568.5282"/>
<text text-anchor="middle" x="2490.9803" y="-2554.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SetPointManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M590.1987,-2684.5865C602.095,-2712.544 637.2536,-2786.4994 690.4731,-2824.5228 767.32,-2879.4271 802.9837,-2860.8417 894.9067,-2882.5228 976.4257,-2901.75 997.3113,-2904.6916 1080.0784,-2917.5228 1229.5118,-2940.6891 1614.3758,-2945.4676 1755.6028,-2999.5228 1838.1668,-3031.1245 1861.5565,-3045.9884 1918.6055,-3113.5228 1942.7244,-3142.0747 1933.1459,-3158.9217 1954.6055,-3189.5228 1973.0158,-3215.7757 2132.0868,-3413.7861 2157.7203,-3394.5228"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1351.7854,-1387.5282 1253.7864,-1387.5282 1253.7864,-1365.5174 1351.7854,-1365.5174 1351.7854,-1387.5282"/>
<text text-anchor="middle" x="1302.7859" y="-1373.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M593.9562,-2662.2687C607.2818,-2643.881 634.1268,-2606.0782 654.4731,-2572.5228 657.5868,-2567.3877 856.9717,-2197.2078 858.9067,-2191.5228 890.5485,-2098.5591 846.0723,-2058.7205 894.9067,-1973.5228 937.7797,-1898.7255 992.2858,-1918.4449 1044.0784,-1849.5228 1144.296,-1716.1599 1133.5422,-1660.9082 1194.2432,-1505.5228 1212.0411,-1459.9627 1195.6327,-1436.086 1230.2432,-1401.5228 1234.4097,-1397.3619 1239.3002,-1393.8926 1244.5404,-1391.0001"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1246.1119,-1394.1282 1253.6234,-1386.6564 1243.0919,-1387.8132 1246.1119,-1394.1282"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="808.0587,-1904.5282 741.3212,-1904.5282 741.3212,-1882.5174 808.0587,-1882.5174 808.0587,-1904.5282"/>
<text text-anchor="middle" x="774.6899" y="-1890.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M596.1205,-2662.487C611.8999,-2644.9846 641.4279,-2609.0829 654.4731,-2572.5228 715.7984,-2400.6555 655.1016,-2342.5424 690.4731,-2163.5228 709.3297,-2068.0877 749.4389,-1958.6594 766.6126,-1914.0538"/>
<polygon fill="#0000ff" stroke="#0000ff" points="769.9201,-1915.2052 770.278,-1904.6164 763.395,-1912.6708 769.9201,-1915.2052"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1917.9277,-2682.5282 1792.2805,-2682.5282 1792.2805,-2660.5174 1917.9277,-2660.5174 1917.9277,-2682.5282"/>
<text text-anchor="middle" x="1855.1041" y="-2668.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M590.505,-2684.6663C602.6267,-2711.2637 637.3961,-2778.1278 690.4731,-2803.5228 758.0012,-2835.832 784.1926,-2808.1835 858.9067,-2803.5228 1008.8182,-2794.1713 1045.8156,-2784.5481 1194.2432,-2761.5228 1408.7992,-2728.2391 1457.4734,-2671.4115 1674.5929,-2672.5228"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1755.6127,-1200.5282 1593.5731,-1200.5282 1593.5731,-1178.5174 1755.6127,-1178.5174 1755.6127,-1200.5282"/>
<text text-anchor="middle" x="1674.5929" y="-1186.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M597.7677,-2662.3956C620.9331,-2641.114 671.1039,-2595.5947 690.4731,-2582.5228 760.1441,-2535.5033 809.3318,-2564.3991 858.9067,-2496.5228 917.0852,-2416.867 845.0636,-2362.6429 894.9067,-2277.5228 991.3127,-2112.8844 1072.4508,-2116.7677 1230.2432,-2009.5228 1291.684,-1967.764 1314.5537,-1969.2449 1375.3286,-1926.5228 1427.4611,-1889.8759 1444.149,-1882.8801 1484.4558,-1833.5228"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1918.6068,-3330.5282 1791.6014,-3330.5282 1791.6014,-3308.5174 1918.6068,-3308.5174 1918.6068,-3330.5282"/>
<text text-anchor="middle" x="1855.1041" y="-3316.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M969.4926,-3055.5228C1022.5794,-3066.9926 1029.8664,-3086.8218 1080.0784,-3107.5228 1339.428,-3214.4452 1418.1628,-3205.7765 1674.5929,-3319.5228"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2546.1706,-2557.5228C2554.3927,-2557.5228 2563.0409,-2557.5228 2571.7483,-2557.5228"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2571.9753,-2561.0229 2581.9753,-2557.5228 2571.9753,-2554.0229 2571.9753,-2561.0229"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-1054.5282 344.7839,-1054.5282 344.7839,-1032.5174 453.3838,-1032.5174 453.3838,-1054.5282"/>
<text text-anchor="middle" x="399.0839" y="-1040.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.7475,-1032.4887C459.7795,-1028.9282 471.1129,-1024.3462 480.9653,-1018.5228 500.1759,-1007.1681 500.6763,-998.7754 516.9653,-983.5228 577.0352,-927.2748 609.0221,-928.1262 654.4731,-859.5228 681.488,-818.7467 672.4507,-800.9946 690.4731,-755.5228 772.3083,-549.0471 708.4808,-420.248 894.9067,-299.5228 950.5558,-263.4857 978.8619,-287.5939 1044.0784,-299.5228 1215.7524,-330.9242 1241.2588,-399.3529 1411.3286,-438.5228 1525.8227,-464.8926 1557.7632,-450.0697 1674.5929,-462.5228"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1194.3257,-932.5282 1079.9959,-932.5282 1079.9959,-910.5174 1194.3257,-910.5174 1194.3257,-932.5282"/>
<text text-anchor="middle" x="1137.1608" y="-918.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M969.4926,-845.5228C1023.6018,-844.2523 1030.7125,-874.3318 1080.0784,-896.5228 1087.1338,-899.6944 1094.701,-903.0445 1101.9436,-906.226"/>
<polygon fill="#0038ff" stroke="#0038ff" points="1100.9759,-909.6231 1111.5402,-910.4274 1103.7833,-903.2106 1100.9759,-909.6231"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M453.3669,-1050.9531C463.7818,-1054.7024 473.692,-1060.2721 480.9653,-1068.5228 543.2953,-1139.2287 489.9667,-1187.2154 516.9653,-1277.5228 560.8376,-1424.2704 612.8708,-1446.1156 654.4731,-1593.5228 685.6812,-1704.1005 624.2267,-1755.6463 690.4731,-1849.5228 700.4763,-1863.6981 716.4744,-1873.6524 731.8533,-1880.4615"/>
<polygon fill="#0000ff" stroke="#0000ff" points="730.7081,-1883.7742 741.2897,-1884.3043 733.3482,-1877.2912 730.7081,-1883.7742"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-1732.5282 536.1602,-1732.5282 536.1602,-1710.5174 635.2783,-1710.5174 635.2783,-1732.5282"/>
<text text-anchor="middle" x="585.7192" y="-1718.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M413.1277,-1054.5844C432.0224,-1070.3399 465.0867,-1101.1686 480.9653,-1135.5228 529.5405,-1240.6175 497.0776,-1279.4661 516.9653,-1393.5228 537.2634,-1509.9327 568.6286,-1648.0797 580.7249,-1700.2045"/>
<polygon fill="#ff0038" stroke="#ff0038" points="577.3867,-1701.3016 583.0644,-1710.2466 584.2041,-1699.7132 577.3867,-1701.3016"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1533.8457,-2833.5282 1435.0659,-2833.5282 1435.0659,-2811.5174 1533.8457,-2811.5174 1533.8457,-2833.5282"/>
<text text-anchor="middle" x="1484.4558" y="-2819.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M585.7192,-997.5228C707.5587,-971.9011 742.9429,-1014.205 858.9067,-1059.5228 920.559,-1083.616 1341.3105,-1299.7403 1375.3286,-1356.5228 1408.8922,-1412.5466 1402.3179,-2466.839 1411.3286,-2531.5228 1425.6977,-2634.6718 1462.2239,-2754.1918 1477.5357,-2801.6014"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1474.2789,-2802.9039 1480.7071,-2811.3258 1480.934,-2800.7334 1474.2789,-2802.9039"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1538.1815,-1048.5282 1430.7301,-1048.5282 1430.7301,-1026.5174 1538.1815,-1026.5174 1538.1815,-1048.5282"/>
<text text-anchor="middle" x="1484.4558" y="-1034.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-997.5228C649.4959,-983.2579 804.1749,-933.7087 858.9067,-897.5228 878.3132,-884.6922 874.4789,-870.6556 894.9067,-859.5228 924.5224,-843.3828 935.7737,-846.3145 969.4926,-845.5228"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M969.4926,-845.5228C1118.4293,-838.7627 1181.2374,-797.1874 1302.7859,-883.5228"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M440.4078,-1032.4711C478.1034,-1022.5969 535.4269,-1008.0988 585.7192,-997.5228"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2201.505,-3979.5282 2113.9357,-3979.5282 2113.9357,-3957.5174 2201.505,-3957.5174 2201.505,-3979.5282"/>
<text text-anchor="middle" x="2157.7203" y="-3965.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2159.2362,-3979.6367C2169.4135,-4052.2151 2230.2211,-4454.7282 2323.0276,-4423.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2323.0276,-4423.5228C2356.9706,-4412.1097 2376.5607,-4426.6452 2399.9436,-4399.5228 2571.4707,-4200.564 2325.4911,-4019.5313 2490.9803,-3815.5228"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-3641.5282 358.7923,-3641.5282 358.7923,-3619.5174 439.3754,-3619.5174 439.3754,-3641.5282"/>
<text text-anchor="middle" x="399.0839" y="-3627.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.4304,-3641.6578C409.1938,-3713.0214 459.5615,-4106.5441 516.9653,-4211.5228 593.5277,-4351.5381 615.109,-4461.5228 774.6899,-4461.5228 774.6899,-4461.5228 774.6899,-4461.5228 969.4926,-4461.5228 1069.9496,-4461.5228 1094.4767,-4473.7634 1194.2432,-4485.5228 1242.5496,-4491.2166 1254.2244,-4496.7465 1302.7859,-4499.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.7859,-4499.5228C1467.9342,-4505.2493 1509.3453,-4499.5228 1674.5929,-4499.5228 1674.5929,-4499.5228 1674.5929,-4499.5228 1855.1041,-4499.5228 1989.6002,-4499.5228 2025.2643,-4522.8593 2157.7203,-4499.5228"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M2011.9673,-4324.5228C2073.5536,-4287.3183 2134.7243,-4060.5377 2152.5487,-3989.6669"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="2156.0144,-3990.2332 2155.0307,-3979.6841 2149.2212,-3988.5442 2156.0144,-3990.2332"/>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M400.9593,-3641.7365C408.286,-3682.2904 438.5422,-3823.1618 516.9653,-3903.5228 576.2733,-3964.2963 611.485,-3952.3503 690.4731,-3983.5228 860.1412,-4050.4819 904.3676,-4063.5687 1080.0784,-4112.5228 1182.3713,-4141.0222 1921.0761,-4379.4304 2011.9673,-4324.5228"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2049.5937,-3558.5282 1974.3409,-3558.5282 1974.3409,-3536.5174 2049.5937,-3536.5174 2049.5937,-3558.5282"/>
<text text-anchor="middle" x="2011.9673" y="-3544.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M774.6899,-3969.5228C1041.2998,-3984.9783 1126.4378,-4083.3372 1375.3286,-3986.5228 1395.5572,-3978.6542 1392.5525,-3964.4116 1411.3286,-3953.5228 1616.0652,-3834.7899 1746.6053,-3954.0975 1918.6055,-3791.5228 1984.3803,-3729.3524 2004.3404,-3615.8514 2009.9451,-3568.8162"/>
<polygon fill="#7100ff" stroke="#7100ff" points="2013.454,-3568.9233 2011.0563,-3558.6034 2006.4951,-3568.1661 2013.454,-3568.9233"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M404.8977,-3619.1567C420.7147,-3587.5672 464.4424,-3495.6309 480.9653,-3413.5228 524.3954,-3197.7038 502.2292,-2643.1744 516.9653,-2423.5228 535.0478,-2153.9913 573.0187,-1827.7152 583.1755,-1742.6236"/>
<polygon fill="#ff0038" stroke="#ff0038" points="586.6561,-1742.9933 584.371,-1732.6479 579.7059,-1742.1603 586.6561,-1742.9933"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M969.4926,-3855.5228C1070.3688,-3813.3668 1104.4814,-3817.9406 1194.2432,-3755.5228 1307.5429,-3676.7373 1309.9671,-3627.1701 1411.3286,-3533.5228 1430.6966,-3515.6288 1571.6949,-3396.2275 1593.583,-3381.5228 1661.2541,-3336.0605 1708.2031,-3361.8514 1755.6028,-3295.5228 1827.2329,-3195.2873 1849.7648,-2790.5968 1854.2137,-2692.8503"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1857.7164,-2692.8655 1854.6591,-2682.7214 1850.7231,-2692.558 1857.7164,-2692.8655"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-3969.5228C873.9902,-3955.2933 876.6672,-3893.5555 969.4926,-3855.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M403.91,-3641.5876C431.5067,-3702.9941 575.1328,-3998.1189 774.6899,-3969.5228"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M969.4926,-3855.5228C1139.1985,-3788.4921 1245.9409,-3922.1775 1375.3286,-3793.5228 1447.7643,-3721.4975 1342.6816,-3642.1677 1411.3286,-3566.5228 1433.8952,-3541.6557 1455.7886,-3565.0102 1484.4558,-3547.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1674.5929,-3547.5228C1723.6853,-3496.0638 1722.0187,-3472.2141 1755.6028,-3409.5228 1771.457,-3379.9278 1764.6221,-3361.7474 1791.064,-3337.2718"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1793.6291,-3339.6854 1798.9898,-3330.5468 1789.1003,-3334.3478 1793.6291,-3339.6854"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1484.4558,-3547.5228C1556.7517,-3503.7682 1616.2611,-3608.6665 1674.5929,-3547.5228"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2369.6617,-2026.5282 2276.3935,-2026.5282 2276.3935,-2004.5174 2369.6617,-2004.5174 2369.6617,-2026.5282"/>
<text text-anchor="middle" x="2323.0276" y="-2012.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2323.7516,-2004.292C2330.8576,-1896.2816 2390.0343,-1045.8007 2490.9803,-1055.5228"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M2326.5355,-2026.8432C2347.5392,-2094.6241 2456.6723,-2446.8073 2484.5111,-2536.646"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2481.1886,-2537.7487 2487.4917,-2546.2646 2487.8749,-2535.6767 2481.1886,-2537.7487"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-2723.5282 350.2841,-2723.5282 350.2841,-2701.5174 447.8836,-2701.5174 447.8836,-2723.5282"/>
<text text-anchor="middle" x="399.0839" y="-2709.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.7636,-2723.7601C404.3514,-2796.4274 433.1858,-3207.034 516.9653,-3529.5228 571.2801,-3738.5942 566.8751,-3806.3662 690.4731,-3983.5228 821.9734,-4172.0059 872.3504,-4225.2004 1080.0784,-4323.5228 1322.2602,-4438.153 1410.4474,-4378.5866 1674.5929,-4423.5228"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M585.7192,-3017.5228C680.501,-3062.0006 617.0627,-3153.8719 690.4731,-3228.5228 814.5478,-3354.694 938.6345,-3269.4126 1044.0784,-3411.5228 1096.333,-3481.9481 1029.0308,-3534.2177 1080.0784,-3605.5228 1178.3638,-3742.8114 1247.9797,-3748.7991 1411.3286,-3791.5228 1631.6948,-3849.1593 1698.2339,-3776.1387 1918.6055,-3718.5228 2050.3063,-3684.0898 2111.9213,-3718.8064 2210.1116,-3624.5228 2370.8773,-3470.1534 2471.4504,-2714.7602 2488.4207,-2578.5802"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2491.9023,-2578.9437 2489.6532,-2568.5903 2484.955,-2578.0865 2491.9023,-2578.9437"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M399.8548,-2723.6632C405.1217,-2796.7675 437.9812,-3207.732 516.9653,-3299.5228 622.4065,-3422.0604 753.6435,-3300.8323 858.9067,-3423.5228 912.5978,-3486.103 858.4106,-3531.5833 894.9067,-3605.5228 919.8678,-3656.0929 1179.9585,-3960.9915 1230.2432,-3986.5228 1540.8546,-4144.2312 1673.4002,-4125.5213 2011.9673,-4043.5228"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M585.7192,-3017.5228C638.696,-3043.1556 639.3539,-3069.3611 690.4731,-3098.5228 806.3981,-3164.6538 840.5698,-3175.0142 969.4926,-3209.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M969.4926,-3209.5228C1142.9918,-3270.368 1624.8506,-3080.7821 1755.6028,-2951.5228 1852.5952,-2855.6378 1853.6338,-2811.44 1918.6055,-2691.5228 1994.6473,-2551.1737 2002.7388,-2510.595 2069.3291,-2365.5228 2085.4254,-2330.4557 2075.8717,-2311.4437 2105.3291,-2286.5228 2123.7296,-2270.9559 2144.545,-2292.7049 2157.7203,-2272.5228"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1549.9509,-740.5282 1418.9607,-740.5282 1418.9607,-718.5174 1549.9509,-718.5174 1549.9509,-740.5282"/>
<text text-anchor="middle" x="1484.4558" y="-726.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#71ff00" stroke-dasharray="5,2" d="M1302.7859,-1453.5228C1325.4631,-1419.3611 1356.2388,-1432.8112 1375.3286,-1396.5228 1433.7985,-1285.3755 1369.3796,-950.8981 1411.3286,-832.5228 1423.0581,-799.4235 1448.7242,-767.4334 1466.3036,-748.1145"/>
<polygon fill="#71ff00" stroke="#71ff00" points="1469.0119,-750.3424 1473.2783,-740.6445 1463.8955,-745.5651 1469.0119,-750.3424"/>
<path fill="none" stroke="#71ff00" stroke-dasharray="5,2" d="M403.5906,-2701.368C416.3688,-2669.5905 453.6742,-2575.7727 480.9653,-2496.5228 583.243,-2199.5218 471.0026,-2046.2515 690.4731,-1821.5228 806.3286,-1702.8916 932.9545,-1825.5972 1044.0784,-1702.5228 1092.6345,-1648.7448 1031.4333,-1597.2204 1080.0784,-1543.5228 1115.9817,-1503.8904 1147.0885,-1530.7461 1194.2432,-1505.5228 1212.1166,-1495.9622 1212.3611,-1487.0672 1230.2432,-1477.5228 1260.2027,-1461.5322 1284.0041,-1481.8162 1302.7859,-1453.5228"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="821.3138,-3487.5282 728.0661,-3487.5282 728.0661,-3465.5174 821.3138,-3465.5174 821.3138,-3487.5282"/>
<text text-anchor="middle" x="774.6899" y="-3473.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#38ff00" stroke-dasharray="5,2" d="M399.3406,-2723.756C401.4347,-2805.3874 418.2475,-3307.307 516.9653,-3413.5228 543.8837,-3442.4857 650.6138,-3460.9363 717.9969,-3469.948"/>
<polygon fill="#38ff00" stroke="#38ff00" points="717.6777,-3473.436 728.047,-3471.2614 718.5849,-3466.495 717.6777,-3473.436"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M404.8751,-2701.2081C420.6343,-2669.7615 464.2282,-2578.2428 480.9653,-2496.5228 500.2218,-2402.5022 456.0879,-1707.7159 516.9653,-1633.5228 669.8885,-1447.151 865.7047,-1667.704 1044.0784,-1505.5228 1080.2688,-1472.6177 1046.6295,-1437.2112 1080.0784,-1401.5228 1098.8985,-1381.4426 1110.5701,-1384.6183 1137.1608,-1377.5228"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1024.6306,-1693.5282 914.3545,-1693.5282 914.3545,-1671.5174 1024.6306,-1671.5174 1024.6306,-1693.5282"/>
<text text-anchor="middle" x="969.4926" y="-1679.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe2" stroke-dasharray="5,2" d="M404.8597,-2701.2049C420.5798,-2669.7503 464.0827,-2578.2128 480.9653,-2496.5228 498.8614,-2409.9289 454.3374,-1763.9449 516.9653,-1701.5228 627.5701,-1591.2813 838.9049,-1640.6486 928.1204,-1668.3313"/>
<polygon fill="#00ffe2" stroke="#00ffe2" points="927.2883,-1671.7391 937.8785,-1671.4249 929.4038,-1665.0664 927.2883,-1671.7391"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1186.7096,-2301.5282 1087.6119,-2301.5282 1087.6119,-2279.5174 1186.7096,-2279.5174 1186.7096,-2301.5282"/>
<text text-anchor="middle" x="1137.1608" y="-2287.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M401.4263,-2723.7791C412.0826,-2771.6096 460.9621,-2958.2433 585.7192,-3017.5228"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M585.7192,-3017.5228C691.5766,-3067.8219 624.0937,-2872.1124 690.4731,-2775.5228 749.826,-2689.1577 811.6871,-2704.0749 858.9067,-2610.5228 910.8774,-2507.5579 820.6637,-2441.7877 894.9067,-2353.5228 917.3225,-2326.8735 939.2675,-2346.8172 969.4926,-2329.5228"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1557.7104,-3063.5282 1411.2012,-3063.5282 1411.2012,-3041.5174 1557.7104,-3041.5174 1557.7104,-3063.5282"/>
<text text-anchor="middle" x="1484.4558" y="-3049.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0071ff" stroke-dasharray="5,2" d="M1137.1608,-3093.5228C1212.0758,-3096.4583 1228.1988,-3133.1154 1302.7859,-3125.5228"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M404.8899,-2701.2111C420.6872,-2669.7723 464.3693,-2578.2715 480.9653,-2496.5228 522.5994,-2291.4422 439.3143,-1749.8467 516.9653,-1555.5228 559.7793,-1448.3797 898.6586,-1048.427 1080.0784,-937.5228 1080.265,-937.4087 1080.4524,-937.2954 1080.6407,-937.1829"/>
<polygon fill="#0038ff" stroke="#0038ff" points="1082.247,-940.2927 1089.5673,-932.6335 1079.0684,-934.056 1082.247,-940.2927"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M404.6468,-2701.4989C419.5709,-2672.7584 463.0426,-2594.3197 516.9653,-2544.5228 569.0739,-2496.4012 615.6647,-2522.8936 654.4731,-2463.5228 691.2109,-2407.3198 676.4177,-2229.1801 690.4731,-2163.5228 710.8368,-2068.3979 750.1204,-1958.7997 766.8437,-1914.1014"/>
<polygon fill="#0000ff" stroke="#0000ff" points="770.1567,-1915.2353 770.4095,-1904.6434 763.6067,-1912.7658 770.1567,-1915.2353"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M969.4926,-3209.5228C1147.3692,-3258.4962 1086.8833,-3416.3917 1230.2432,-3532.5228 1265.3162,-3560.9343 1367.4328,-3614.0116 1411.3286,-3624.5228 1619.6827,-3674.4148 1876.9368,-3596.0798 1973.2054,-3562.0512"/>
<polygon fill="#7100ff" stroke="#7100ff" points="1974.5764,-3565.278 1982.8118,-3558.6125 1972.2173,-3558.6875 1974.5764,-3565.278"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1733.9285,-2529.5282 1615.2573,-2529.5282 1615.2573,-2507.5174 1733.9285,-2507.5174 1733.9285,-2529.5282"/>
<text text-anchor="middle" x="1674.5929" y="-2515.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M969.4926,-2979.5228C1041.8854,-2961.8481 1062.8505,-2985.0995 1137.1608,-2979.5228"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1137.1608,-2979.5228C1265.6149,-2969.8827 1288.5799,-2924.5887 1411.3286,-2885.5228 1475.8909,-2864.9752 1513.8143,-2894.2412 1557.583,-2842.5228 1644.0495,-2740.3513 1507.8021,-2646.2705 1593.583,-2543.5228 1597.1793,-2539.2152 1601.5012,-2535.6361 1606.2527,-2532.6641"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1607.992,-2535.7039 1615.2056,-2527.944 1604.7274,-2529.5117 1607.992,-2535.7039"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1019.6198,-2685.5282 919.3653,-2685.5282 919.3653,-2663.5174 1019.6198,-2663.5174 1019.6198,-2685.5282"/>
<text text-anchor="middle" x="969.4926" y="-2671.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0071" stroke-dasharray="5,2" d="M585.7192,-3017.5228C650.6436,-3049.1457 816.748,-2900.1557 858.9067,-2841.5228 896.9157,-2788.6613 850.63,-2747.2573 894.9067,-2699.5228 899.2341,-2694.8575 904.457,-2691.0622 910.1062,-2687.9749"/>
<polygon fill="#ff0071" stroke="#ff0071" points="911.6964,-2691.095 919.2667,-2683.6827 908.7264,-2684.7563 911.6964,-2691.095"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M404.848,-2701.2025C420.5383,-2669.7417 463.972,-2578.1899 480.9653,-2496.5228 497.9613,-2414.843 467.4767,-1813.6892 516.9653,-1746.5228 519.7529,-1742.7395 523.1709,-1739.5275 526.9789,-1736.8008"/>
<polygon fill="#ff0038" stroke="#ff0038" points="529.0084,-1739.6673 535.8449,-1731.5733 525.453,-1733.6374 529.0084,-1739.6673"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1137.1608,-3093.5228C1170.7232,-3094.8379 1653.6692,-2952.911 1674.5929,-2937.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3017.5228C632.4318,-3040.3184 640.2053,-3056.2999 690.4731,-3069.5228 882.7465,-3120.0999 938.3649,-3096.2229 1137.1608,-3093.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1674.5929,-2937.5228C1754.0441,-2870.2025 1728.0739,-2817.037 1791.6028,-2734.5228 1804.3126,-2718.0147 1821.1404,-2701.5073 1834.2798,-2689.5333"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1836.7945,-2691.9798 1841.9144,-2682.7042 1832.1276,-2686.7625 1836.7945,-2691.9798"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1917.8434,-2377.5282 1792.3649,-2377.5282 1792.3649,-2355.5174 1917.8434,-2355.5174 1917.8434,-2377.5282"/>
<text text-anchor="middle" x="1855.1041" y="-2363.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1674.5929,-2557.5228C1694.5057,-2526.3602 1725.9039,-2560.5592 1755.6028,-2538.5228 1808.0505,-2499.6069 1837.3415,-2424.1873 1849.0429,-2387.5348"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1852.416,-2388.4729 1851.9993,-2377.8863 1845.7231,-2386.4221 1852.416,-2388.4729"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1137.1608,-2979.5228C1233.2628,-2976.9136 1496.1554,-2951.4759 1557.583,-2877.5228 1620.6094,-2801.6449 1553.4097,-2748.611 1593.583,-2658.5228 1617.0192,-2605.9674 1643.608,-2606.0126 1674.5929,-2557.5228"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M585.7192,-3017.5228C739.98,-3092.2327 801.7785,-3014.8775 969.4926,-2979.5228"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M969.4926,-2979.5228C1048.9751,-2960.1172 1055.9705,-2913.6314 1137.1608,-2903.5228"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1192.9776,-700.5282 1081.344,-700.5282 1081.344,-678.5174 1192.9776,-678.5174 1192.9776,-700.5282"/>
<text text-anchor="middle" x="1137.1608" y="-686.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M404.9408,-2701.2213C420.8681,-2669.8085 464.8516,-2578.368 480.9653,-2496.5228 510.1875,-2348.097 445.1589,-1268.6693 516.9653,-1135.5228 604.857,-972.5502 735.2836,-1035.3718 858.9067,-897.5228 881.215,-872.6474 871.6471,-855.511 894.9067,-831.5228 954.5255,-770.0368 1046.4025,-726.0676 1098.1878,-704.5291"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1099.7511,-707.6712 1107.6814,-700.6456 1097.1007,-701.1924 1099.7511,-707.6712"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3017.5228C667.4525,-3057.5974 616.807,-2894.998 690.4731,-2841.5228 752.5764,-2796.4412 807.4702,-2860.474 858.9067,-2803.5228 903.6157,-2754.0204 869.3131,-2567.1211 894.9067,-2505.5228 945.9272,-2382.7278 989.1532,-2367.5501 1080.0784,-2270.5228 1141.4452,-2205.0375 1159.5198,-2190.7715 1230.2432,-2135.5228 1291.5644,-2087.619 1315.9758,-2087.8449 1375.3286,-2037.5228 1393.0735,-2022.4778 1395.2632,-2016.3495 1411.3286,-1999.5228 1476.068,-1931.7156 1515.0363,-1931.0619 1557.583,-1847.5228 1616.9059,-1731.044 1662.4454,-1309.8811 1672.5097,-1210.5951"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1675.998,-1210.8854 1673.514,-1200.5859 1669.033,-1210.1865 1675.998,-1210.8854"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M421.173,-2701.4072C479.8688,-2671.733 636.4817,-2591.6097 654.4731,-2572.5228 680.1097,-2545.3253 673.4308,-2529.7868 690.4731,-2496.5228 761.082,-2358.7055 788.2978,-2329.3401 858.9067,-2191.5228 875.9491,-2158.2588 871.396,-2144.5777 894.9067,-2115.5228 947.3951,-2050.6569 990.1591,-2065.2041 1044.0784,-2001.5228 1066.1755,-1975.4249 1063.1829,-1963.2537 1080.0784,-1933.5228 1174.1572,-1767.9726 1217.2834,-1737.661 1302.7859,-1567.5228"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-2454.5282 517.2105,-2454.5282 517.2105,-2432.5174 654.2279,-2432.5174 654.2279,-2454.5282"/>
<text text-anchor="middle" x="585.7192" y="-2440.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M403.9006,-2701.5061C418.2234,-2669.4323 462.9325,-2574.111 516.9653,-2506.5228 530.5711,-2489.5037 548.8738,-2472.9669 563.1744,-2461.1092"/>
<polygon fill="#0000ff" stroke="#0000ff" points="565.5101,-2463.7212 571.0661,-2454.7 561.0971,-2458.2874 565.5101,-2463.7212"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1371.1836,-778.5282 1234.3881,-778.5282 1234.3881,-756.5174 1371.1836,-756.5174 1371.1836,-778.5282"/>
<text text-anchor="middle" x="1302.7859" y="-764.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M404.8908,-2701.2113C420.6903,-2669.7729 464.3775,-2578.2732 480.9653,-2496.5228 522.7995,-2290.3498 460.15,-1753.0799 516.9653,-1550.5228 559.7112,-1398.1258 591.8419,-1363.3126 690.4731,-1239.5228 753.3085,-1160.6596 789.4852,-1160.655 858.9067,-1087.5228 948.7814,-992.8442 967.5156,-965.2566 1044.0784,-859.5228 1061.4316,-835.5578 1058.9347,-824.2207 1080.0784,-803.5228 1101.3443,-782.7052 1110.4538,-781.6509 1137.1608,-768.5228"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M969.4926,-3209.5228C1007.26,-3221.5824 1638.3474,-3303.458 1674.5929,-3319.5228"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1498.1724,-718.4927C1570.7462,-661.5462 1915.7453,-408.5462 2157.7203,-542.5228"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M821.3181,-3480.8838C835.2209,-3484.4417 849.2962,-3490.6799 858.9067,-3501.5228 922.2989,-3573.0439 847.8413,-3630.3443 894.9067,-3713.5228 937.9287,-3789.5553 989.7425,-3773.1163 1044.0784,-3841.5228 1065.5922,-3868.6078 1062.3907,-3880.7975 1080.0784,-3910.5228 1141.1791,-4013.2064 1145.1463,-4049.6435 1230.2432,-4133.5228 1398.1949,-4299.0715 1447.3133,-4360.6089 1674.5929,-4423.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1674.5929,-4423.5228C1851.2515,-4441.6789 1893.9086,-4457.8543 2069.3291,-4485.5228 2108.6181,-4491.7197 2118.0994,-4503.0164 2157.7203,-4499.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2157.7203,-4499.5228C2237.3564,-4485.4923 2246.205,-4448.7628 2323.0276,-4423.5228"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1352.9388,-3523.5282 1252.6329,-3523.5282 1252.6329,-3501.5174 1352.9388,-3501.5174 1352.9388,-3523.5282"/>
<text text-anchor="middle" x="1302.7859" y="-3509.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1306.5279,-3523.5602C1321.3112,-3565.2794 1380.0019,-3714.1825 1484.4558,-3777.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2157.7203,-3929.5228C2313.7717,-3941.9047 2389.9078,-3935.0622 2490.9803,-3815.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1484.4558,-3777.5228C1589.378,-3841.1471 1635.7643,-3803.151 1755.6028,-3829.5228 1935.4616,-3869.1027 1975.4681,-3903.0679 2157.7203,-3929.5228"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1674.5929,-3585.5228C1713.6617,-3573.1116 1815.7012,-3558.8284 1855.1041,-3547.5228"/>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1855.1041,-3547.5228C1915.6735,-3530.144 1899.9763,-3477.9285 1954.6055,-3446.5228 2035.3917,-3400.0796 2083.1621,-3450.4197 2157.7203,-3394.5228"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M1484.4558,-3777.5228C1692.6918,-3900.8549 1984.4938,-3947.8967 2103.7406,-3962.7009"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="2103.3718,-3966.1817 2113.7211,-3963.9143 2104.2167,-3959.2329 2103.3718,-3966.1817"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1315.5618,-3523.6371C1344.1,-3548.4571 1410.595,-3606.2493 1411.3286,-3606.5228 1466.3201,-3627.0249 1620.6214,-3608.5765 1674.5929,-3585.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1674.5929,-3585.5228C1709.6653,-3572.1057 1724.883,-3583.1189 1755.6028,-3561.5228 1805.6719,-3526.3241 1897.6731,-3397.0354 1918.6055,-3339.5228 2003.146,-3107.2442 1862.7007,-3013.9873 1954.6055,-2784.5228 1984.1336,-2710.798 2037.06,-2720.0898 2069.3291,-2647.5228 2116.0139,-2542.5375 2054.1113,-2494.3728 2105.3291,-2391.5228 2134.718,-2332.5073 2173.4549,-2341.3209 2210.1116,-2286.5228 2266.9009,-2201.6283 2303.9716,-2083.5885 2317.3971,-2036.3122"/>
<polygon fill="#e2ff00" stroke="#e2ff00" points="2320.7902,-2037.1741 2320.1022,-2026.6017 2314.047,-2035.2956 2320.7902,-2037.1741"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0071ff" stroke-dasharray="5,2" d="M1308.1244,-3501.1413C1321.0131,-3473.3442 1354.3156,-3399.5804 1375.3286,-3335.5228 1395.8908,-3272.8395 1387.8029,-3253.1551 1411.3286,-3191.5228 1428.3032,-3147.0531 1456.1301,-3098.5994 1472.1166,-3072.2719"/>
<polygon fill="#0071ff" stroke="#0071ff" points="1475.1781,-3073.9748 1477.4286,-3063.6218 1469.2131,-3070.3117 1475.1781,-3073.9748"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M1855.1041,-3547.5228C1890.4993,-3537.3671 1932.2655,-3537.9395 1963.7981,-3540.7404"/>
<polygon fill="#7100ff" stroke="#7100ff" points="1963.7779,-3544.2557 1974.0754,-3541.7635 1964.4713,-3537.2901 1963.7779,-3544.2557"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1309.4148,-3501.2791C1322.9697,-3477.9957 1354.3458,-3422.576 1375.3286,-3373.5228 1394.8962,-3327.7782 1383.339,-3308.6572 1411.3286,-3267.5228 1459.2701,-3197.0664 1519.464,-3219.7424 1557.583,-3143.5228 1617.3302,-3024.0571 1511.0873,-2648.5763 1593.583,-2543.5228 1597.1055,-2539.0371 1601.4178,-2535.3365 1606.1999,-2532.2862"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1608.0649,-2535.2585 1615.2463,-2527.4689 1604.7746,-2529.0799 1608.0649,-2535.2585"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1674.5929,-3089.5228C1711.3706,-3028.65 1725.5588,-3015.9856 1755.6028,-2951.5228 1799.1735,-2858.037 1835.3762,-2739.796 1849.1453,-2692.483"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1852.5403,-2693.3413 1851.9474,-2682.763 1845.8142,-2691.4022 1852.5403,-2693.3413"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1674.5929,-3089.5228C1693.7729,-3057.7769 1823.4724,-2502.6013 1850.2669,-2387.3628"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1853.6773,-2388.149 1852.5315,-2377.6164 1846.859,-2386.5647 1853.6773,-2388.149"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1311.9194,-3501.1733C1330.394,-3478.2897 1373.6496,-3425.082 1411.3286,-3381.5228 1525.6434,-3249.368 1584.2333,-3239.0818 1674.5929,-3089.5228"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1304.8485,-3501.2419C1314.6721,-3448.0711 1358.4362,-3217.3372 1411.3286,-3032.5228 1431.4377,-2962.2585 1461.7959,-2881.0741 1476.2479,-2843.5454"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1479.6897,-2844.3496 1480.0375,-2833.7605 1473.1622,-2841.8215 1479.6897,-2844.3496"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1333.7856,-3501.4713C1397.1559,-3479.1692 1546.379,-3428.1313 1674.5929,-3395.5228"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2210.003,-3615.5282 2105.4376,-3615.5282 2105.4376,-3593.5174 2210.003,-3593.5174 2210.003,-3615.5282"/>
<text text-anchor="middle" x="2157.7203" y="-3601.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2323.0276,-3815.5228C2358.8552,-3825.9813 2467.4678,-3844.5082 2490.9803,-3815.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2161.3118,-3615.7516C2174.7156,-3655.2932 2226.0915,-3787.226 2323.0276,-3815.5228"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M2161.2375,-3593.4729C2193.6801,-3491.5482 2440.608,-2715.777 2484.3632,-2578.3118"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2487.7647,-2579.1646 2487.4627,-2568.574 2481.0945,-2577.0414 2487.7647,-2579.1646"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M2158.9541,-3593.143C2165.2052,-3535.1652 2193.7242,-3266.7875 2210.1116,-3046.5228 2231.7427,-2755.7759 2208.7957,-2680.6753 2246.1116,-2391.5228 2263.7406,-2254.9197 2303.0519,-2093.7591 2317.5338,-2036.7729"/>
<polygon fill="#e2ff00" stroke="#e2ff00" points="2320.9967,-2037.3584 2320.0854,-2026.8028 2314.2153,-2035.6228 2320.9967,-2037.3584"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1311.4597,-1365.359C1355.9287,-1308.2081 1557.6492,-1050.001 1593.583,-1022.5228 1628.879,-995.5322 2287.4865,-667.8558 2323.0276,-694.5228"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1008.7305,-3487.5282 930.2546,-3487.5282 930.2546,-3465.5174 1008.7305,-3465.5174 1008.7305,-3487.5282"/>
<text text-anchor="middle" x="969.4926" y="-3473.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M989.0939,-3487.5405C1006.4841,-3498.409 1031.0862,-3516.6875 1044.0784,-3539.5228 1092.2068,-3624.1139 1017.9408,-3680.6167 1080.0784,-3755.5228 1157.6636,-3849.0509 1473.9298,-3922.3081 1593.583,-3943.5228 1735.8191,-3968.7414 1774.2128,-3947.7462 1918.6055,-3943.5228 2025.0152,-3940.4103 2051.2712,-3928.3807 2157.7203,-3929.5228"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M973.9033,-3465.1522C987.3352,-3429.9272 1027.8081,-3319.2299 1044.0784,-3223.5228 1070.8529,-3066.0264 1034.4144,-2658.6135 1080.0784,-2505.5228 1108.7841,-2409.2854 1166.0437,-2406.9097 1194.2432,-2310.5228 1222.6256,-2213.5102 1169.9399,-1482.6432 1230.2432,-1401.5228 1234.0504,-1396.4012 1238.9731,-1392.321 1244.4605,-1389.0718"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1246.0549,-1392.188 1253.4691,-1384.6196 1242.9534,-1385.9126 1246.0549,-1392.188"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1137.1608,-1491.5228C1201.8357,-1456.3694 1232.1463,-1512.2267 1302.7859,-1491.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.7859,-1491.5228C1335.3749,-1481.9712 1349.256,-1489.2826 1375.3286,-1467.5228 1400.9816,-1446.1132 1394.6031,-1430.4486 1411.3286,-1401.5228 1473.6653,-1293.7149 1498.8888,-1272.3563 1557.583,-1162.5228 1575.5782,-1128.8486 1563.4194,-1107.9308 1593.583,-1084.5228 1686.9422,-1012.073 1736.931,-1036.5228 1855.1041,-1036.5228 1855.1041,-1036.5228 1855.1041,-1036.5228 2011.9673,-1036.5228 2225.0294,-1036.5228 2278.9274,-1034.8107 2490.9803,-1055.5228"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1302.7859,-1491.5228C1429.0528,-1466.1758 1486.4411,-1460.8756 1557.583,-1353.5228 1613.5261,-1269.105 1518.5667,-1196.5563 1593.583,-1128.5228 1679.8416,-1050.2936 1738.6552,-1112.5228 1855.1041,-1112.5228 1855.1041,-1112.5228 1855.1041,-1112.5228 2157.7203,-1112.5228 2463.491,-1112.5228 2488.7486,-2356.5845 2490.8014,-2536.0533"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2487.3041,-2536.3468 2490.9058,-2546.3106 2494.3038,-2536.2755 2487.3041,-2536.3468"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M1024.2847,-1671.3893C1031.6832,-1667.9428 1038.5988,-1663.4303 1044.0784,-1657.5228 1088.3551,-1609.7883 1037.6123,-1564.8751 1080.0784,-1515.5228 1098.0288,-1494.6615 1112.7883,-1504.3054 1137.1608,-1491.5228"/>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M1137.1608,-1491.5228C1161.5332,-1478.7401 1173.8221,-1485.9725 1194.2432,-1467.5228 1219.0362,-1445.123 1204.7232,-1423.0907 1230.2432,-1401.5228 1234.7405,-1397.7219 1239.8476,-1394.4883 1245.2197,-1391.7393"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1246.7866,-1394.8719 1254.45,-1387.5559 1243.897,-1388.4961 1246.7866,-1394.8719"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M977.1093,-1693.8752C992.2143,-1716.9154 1026.0573,-1771.2514 1044.0784,-1821.5228 1074.7157,-1906.9882 1120.9561,-2188.8189 1133.7666,-2269.043"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1130.3815,-2270.0427 1135.4083,-2279.3691 1137.2947,-2268.9435 1130.3815,-2270.0427"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M977.6969,-1671.3588C993.8583,-1648.6573 1029.5069,-1594.9003 1044.0784,-1543.5228 1080.3428,-1415.6583 1004.0366,-1055.5278 1080.0784,-946.5228 1082.2816,-943.3645 1084.9757,-940.6011 1087.9815,-938.184"/>
<polygon fill="#0038ff" stroke="#0038ff" points="1090.1062,-940.9759 1096.5431,-932.5607 1086.2633,-935.1251 1090.1062,-940.9759"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M982.6217,-1693.6677C1020.6224,-1726.5736 1131.9595,-1827.6497 1194.2432,-1933.5228 1219.0447,-1975.6817 1205.115,-1995.5577 1230.2432,-2037.5228 1355.3972,-2246.5349 1582.3739,-2442.6602 1653.0156,-2501.0222"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1650.8893,-2503.8051 1660.8381,-2507.4482 1655.3326,-2498.3961 1650.8893,-2503.8051"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1137.1608,-1491.5228C1188.1224,-1464.7949 1176.8947,-1559.9494 1230.2432,-1581.5228 1299.4739,-1609.5187 1512.9127,-1565.3661 1557.583,-1505.5228 1602.5028,-1445.3453 1537.7267,-1219.7142 1593.583,-1169.5228 1647.1445,-1121.3935 1703.6406,-1119.671 1755.6028,-1169.5228 1790.4303,-1202.9358 1786.0139,-1989.5838 1791.6028,-2037.5228 1805.2841,-2154.8745 1837.2253,-2293.0983 1849.8423,-2345.2147"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1846.5212,-2346.369 1852.2927,-2355.2539 1853.3216,-2344.7091 1846.5212,-2346.369"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M970.7961,-1671.489C983.1289,-1567.1103 1078.8415,-757.2953 1080.0784,-754.5228 1088.1857,-736.3497 1103.1923,-719.5759 1115.7845,-707.6213"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1118.1995,-710.1558 1123.2297,-700.8312 1113.4825,-704.9837 1118.1995,-710.1558"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.7859,-1719.5228C1431.4779,-1724.4367 1476.3785,-1681.4809 1557.583,-1581.5228 1652.0183,-1465.2783 1670.2701,-1274.5576 1673.7703,-1210.9329"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1677.2838,-1210.7348 1674.2673,-1200.5784 1670.2918,-1210.3991 1677.2838,-1210.7348"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1024.7511,-1673.539C1042.3808,-1671.0728 1062.0041,-1668.743 1080.0784,-1667.5228 1130.703,-1664.105 1144.764,-1656.2824 1194.2432,-1667.5228 1246.4056,-1679.3728 1249.9772,-1728.042 1302.7859,-1719.5228"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1137.1608,-1491.5228C1161.5332,-1478.7401 1170.4911,-1481.4243 1194.2432,-1467.5228 1211.7369,-1457.2841 1212.3611,-1449.0672 1230.2432,-1439.5228 1260.2027,-1423.5322 1276.2553,-1436.7219 1302.7859,-1415.5228"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M977.5756,-1671.3235C993.5189,-1648.5585 1028.7947,-1594.6929 1044.0784,-1543.5228 1096.1757,-1369.099 1024.5538,-1308.886 1080.0784,-1135.5228 1110.5935,-1040.2461 1146.4749,-1029.4261 1194.2432,-941.5228 1211.3257,-910.0874 1211.8205,-900.1921 1230.2432,-869.5228 1248.2753,-839.5037 1272.3516,-806.859 1287.7168,-786.79"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1290.5784,-788.8107 1293.918,-778.7559 1285.0371,-784.5335 1290.5784,-788.8107"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1374.6234,-320.5282 1230.9483,-320.5282 1230.9483,-298.5174 1374.6234,-298.5174 1374.6234,-320.5282"/>
<text text-anchor="middle" x="1302.7859" y="-306.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2490.9803,-1055.5228C2646.3395,-1070.4854 2659.7496,-2354.7327 2660.8693,-2536.279"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2657.37,-2536.4343 2660.9256,-2546.4146 2664.3699,-2536.3953 2657.37,-2536.4343"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1336.1693,-320.5346C1348.5328,-324.742 1362.6288,-329.6921 1375.3286,-334.5228 1457.3573,-365.7246 1476.9769,-375.811 1557.583,-410.5228 1609.8511,-433.0312 1617.9609,-456.9191 1674.5929,-462.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2157.7203,-542.5228C2179.4051,-556.1514 2189.5492,-551.2533 2210.1116,-566.5228 2271.016,-611.7502 2263.3416,-647.6991 2323.0276,-694.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1674.5929,-462.5228C1849.3651,-481.1521 1902.0914,-432.4493 2069.3291,-486.5228 2113.5791,-500.8303 2118.3456,-517.7762 2157.7203,-542.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2323.0276,-694.5228C2361.0851,-724.379 2374.7626,-730.2228 2399.9436,-771.5228 2468.9455,-884.6946 2359.0423,-1042.8158 2490.9803,-1055.5228"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#71ff00" stroke-dasharray="5,2" d="M1309.2417,-320.8427C1322.4774,-344.2668 1353.2955,-399.9323 1375.3286,-448.5228 1418.5381,-543.8143 1460.8147,-661.6505 1477.2618,-708.6995"/>
<polygon fill="#71ff00" stroke="#71ff00" points="1474.0317,-710.0669 1480.6233,-718.3615 1480.643,-707.7667 1474.0317,-710.0669"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1310.6454,-320.7591C1326.1483,-343.5906 1360.4515,-397.57 1375.3286,-448.5228 1426.8458,-624.9644 1367.7308,-681.9593 1411.3286,-860.5228 1425.7743,-919.688 1456.9873,-984.8053 1473.5766,-1017.0653"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1470.6829,-1019.086 1478.4091,-1026.3356 1476.8901,-1015.8502 1470.6829,-1019.086"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1173.2433,-2279.4752C1206.5102,-2269.9033 1257.4502,-2256.7884 1302.7859,-2251.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2157.7203,-2405.5228C2230.6524,-2414.3963 2257.2339,-2438.2185 2323.0276,-2405.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.7859,-2251.5228C1384.7247,-2242.0058 1403.4157,-2228.919 1484.4558,-2213.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1484.4558,-2213.5228C1603.0539,-2190.9912 1637.2328,-2173.8223 1755.6028,-2197.5228 1832.572,-2212.9338 1848.3539,-2230.5019 1918.6055,-2265.5228 1973.7121,-2292.9938 2096.5967,-2398.086 2157.7203,-2405.5228"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1484.4558,-2213.5228C1682.1702,-2173.0884 1743.763,-2245.7457 1918.6055,-2346.5228 2018.4955,-2404.0982 2234.136,-2744.9478 2323.0276,-2671.5228"/>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M2323.0276,-2671.5228C2366.6562,-2630.5558 2426.311,-2593.7741 2461.5297,-2573.6531"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2463.3714,-2576.6327 2470.3571,-2568.667 2459.9287,-2570.5378 2463.3714,-2576.6327"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1145.4518,-2301.6702C1180.8207,-2347.8134 1324.5902,-2521.2792 1484.4558,-2517.5228"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1484.4558,-2517.5228C1524.2519,-2516.5057 1568.7479,-2516.6688 1604.6846,-2517.1259"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1605.0164,-2520.6307 1615.0638,-2517.269 1605.113,-2513.6313 1605.0164,-2520.6307"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1302.7859,-2251.5228C1384.7247,-2242.0058 1401.9662,-2289.5228 1484.4558,-2289.5228"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1484.4558,-2289.5228C1605.4367,-2289.5228 1639.6341,-2279.0606 1755.6028,-2313.5228 1782.8127,-2321.6087 1811.1276,-2337.5434 1830.5624,-2349.8386"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1828.7923,-2352.862 1839.0883,-2355.3607 1832.5977,-2346.9867 1828.7923,-2352.862"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1155.0192,-2279.3605C1231.8481,-2231.1825 1531.5303,-2041.5986 1557.583,-1999.5228 1643.0056,-1861.5632 1669.1428,-1324.9901 1673.785,-1210.9186"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1677.2913,-1210.8244 1674.1887,-1200.694 1670.2968,-1210.5481 1677.2913,-1210.8244"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1506.0046,-3063.6136C1589.475,-3106.7296 1888.3835,-3262.6253 1918.6055,-3299.5228 1950.9334,-3338.9914 1924.0027,-3367.7021 1954.6055,-3408.5228 2037.3186,-3518.8529 2099.983,-3501.5414 2210.1116,-3584.5228 2274.6537,-3633.155 2440.0697,-3878.2833 2490.9803,-3815.5228"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1490.4148,-3041.3136C1504.6892,-3013.8991 1540.8911,-2940.9207 1557.583,-2875.5228 1575.9358,-2803.6177 1546.3604,-2600.7695 1593.583,-2543.5228 1597.1538,-2539.194 1601.4577,-2535.6001 1606.1973,-2532.6181"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1607.9353,-2535.6583 1615.1345,-2527.8851 1604.6592,-2529.4722 1607.9353,-2535.6583"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1505.4944,-3041.4329C1541.4109,-3022.148 1616.3212,-2980.3783 1674.5929,-2937.5228"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1487.7936,-3063.5668C1501.7212,-3107.3283 1559.8917,-3268.6441 1674.5929,-3319.5228"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1674.5929,-770.5228C1879.6578,-698.4435 1944.1215,-654.2418 2157.7203,-694.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1484.4558,-846.5228C1575.0656,-838.0402 1588.2461,-799.2686 1674.5929,-770.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1152.3806,-910.3487C1170.0965,-898.0003 1200.7093,-878.6536 1230.2432,-869.5228 1338.6265,-836.0146 1371.5048,-857.0969 1484.4558,-846.5228"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1674.5929,-770.5228C2013.2313,-668.0396 2254.5018,-775.993 2399.9436,-1098.5228 2461.6443,-1235.3494 2487.0507,-2365.1732 2490.5528,-2535.9372"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2487.058,-2536.2383 2490.7596,-2546.1655 2494.0566,-2536.0967 2487.058,-2536.2383"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1484.4558,-846.5228C1559.3923,-839.3161 2119.7555,-857.5144 2157.7203,-922.5228"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M1139.0766,-932.6313C1146.7493,-975.7406 1177.4222,-1135.6095 1230.2432,-1257.5228 1246.3779,-1294.7624 1272.5121,-1334.2894 1288.6155,-1357.1193"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1285.7888,-1359.1835 1294.4513,-1365.2837 1291.4836,-1355.113 1285.7888,-1359.1835"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1139.0979,-932.7723C1145.8673,-969.4065 1171.3307,-1087.3057 1230.2432,-1163.5228 1278.7631,-1226.2946 1336.9145,-1198.105 1375.3286,-1267.5228 1437.8547,-1380.5132 1382.1535,-1721.7247 1411.3286,-1847.5228 1449.6026,-2012.5538 1495.8985,-2041.7408 1557.583,-2199.5228 1601.2977,-2311.34 1649.4605,-2446.9876 1667.3691,-2497.901"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1664.1033,-2499.1647 1670.7189,-2507.4402 1670.7079,-2496.8453 1664.1033,-2499.1647"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1182.7926,-932.5583C1216.022,-940.5234 1262.1377,-951.4311 1302.7859,-960.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.7859,-960.5228C1519.0957,-1008.9043 1654.6559,-972.1895 1755.6028,-1169.5228 1817.2133,-1289.9603 1774.817,-2252.2869 1791.6028,-2386.5228 1804.1489,-2486.8541 1835.6946,-2603.8559 1849.0163,-2650.6416"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1845.6534,-2651.6117 1851.7801,-2660.2555 1852.3809,-2649.6777 1845.6534,-2651.6117"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1302.7859,-960.5228C1359.4693,-973.201 1420.7626,-1002.864 1455.6927,-1021.4506"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1454.3574,-1024.707 1464.82,-1026.3759 1457.6817,-1018.5467 1454.3574,-1024.707"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1148.464,-910.2683C1165.8221,-893.0598 1200.1904,-859.2816 1230.2432,-831.5228 1247.3632,-815.7095 1267.2379,-798.235 1281.8507,-785.5464"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1284.5159,-787.8685 1289.7859,-778.6773 1279.9344,-782.576 1284.5159,-787.8685"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2323.0276,-2405.5228C2475.4551,-2334.9789 2375.044,-2201.627 2399.9436,-2035.5228 2416.1555,-1927.3734 2382.1474,-1044.8225 2490.9803,-1055.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1855.1041,-1795.5228C2005.6833,-1779.3157 1976.8384,-1940.5969 2069.3291,-2060.5228 2083.8584,-2079.3619 2301.4367,-2415.5151 2323.0276,-2405.5228"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1137.1608,-1947.5228C1291.4617,-1903.5863 1734.4753,-1917.75 1855.1041,-2023.5228"/>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1855.1041,-2023.5228C1878.7086,-2040.1983 1894.3081,-2021.8741 1918.6055,-2037.5228 2034.8995,-2112.4218 2013.2253,-2183.3188 2105.3291,-2286.5228 2162.6425,-2350.7435 2176.8186,-2368.458 2246.1116,-2419.5228 2316.8218,-2471.632 2409.1552,-2518.6877 2457.7461,-2542.0344"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2456.329,-2545.2362 2466.8616,-2546.3821 2459.3425,-2538.918 2456.329,-2545.2362"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M969.4926,-1987.5228C1107.9237,-2042.6174 1154.5851,-2038.8565 1302.7859,-2023.5228"/>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M1302.7859,-2023.5228C1502.6344,-1999.7924 1559.2249,-1980.497 1755.6028,-2024.5228 1765.241,-2026.6836 1912.9432,-2087.4294 1918.6055,-2095.5228 1956.2554,-2149.3374 1940.2337,-2621.4371 1954.6055,-2685.5228 1984.6651,-2819.5625 2040.8722,-2838.1337 2069.3291,-2972.5228 2091.6943,-3078.1438 2046.0441,-3853.2936 2105.3291,-3943.5228 2107.3266,-3946.5629 2109.8023,-3949.2427 2112.5816,-3951.6033"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="2110.8511,-3954.6611 2121.0735,-3957.4454 2114.8186,-3948.894 2110.8511,-3954.6611"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1137.1608,-1947.5228C1162.9052,-1937.7946 1170.4911,-1937.4243 1194.2432,-1923.5228 1211.7369,-1913.2841 1211.8521,-1904.0453 1230.2432,-1895.5228 1337.36,-1845.8845 1730.9428,-1803.0149 1855.1041,-1795.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M969.4926,-1987.5228C970.6027,-1987.9704 1136.0095,-1947.8506 1137.1608,-1947.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M795.323,-1904.605C830.4418,-1923.2101 904.3663,-1961.2629 969.4926,-1987.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1855.1041,-1795.5228C1926.4257,-1787.8463 1945.8355,-1729.733 2011.9673,-1757.5228"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#71ff00" stroke-dasharray="5,2" d="M969.4926,-1835.5228C1007.4573,-1815.1056 1016.3672,-1806.5421 1044.0784,-1773.5228 1064.8097,-1748.8203 1062.9646,-1737.8563 1080.0784,-1710.5228 1127.7904,-1634.3189 1147.2878,-1620.1953 1194.2432,-1543.5228 1211.6935,-1515.0284 1204.5902,-1498.9324 1230.2432,-1477.5228 1256.3158,-1455.7629 1284.4591,-1482.113 1302.7859,-1453.5228"/>
<path fill="none" stroke="#71ff00" stroke-dasharray="5,2" d="M808.1266,-1888.1623C848.3729,-1880.703 917.0783,-1864.7001 969.4926,-1835.5228"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M808.1854,-1883.9071C825.9025,-1877.1169 846.4978,-1866.1975 858.9067,-1849.5228 909.4357,-1781.6237 837.8265,-1725.0152 894.9067,-1662.5228 941.4397,-1611.5777 996.0852,-1669.0947 1044.0784,-1619.5228 1089.3656,-1572.7458 1037.6123,-1526.8751 1080.0784,-1477.5228 1115.9793,-1435.8002 1146.7391,-1457.3259 1194.2432,-1429.5228 1211.7369,-1419.2841 1212.4205,-1411.1776 1230.2432,-1401.5228 1237.4878,-1397.5983 1245.4663,-1394.1108 1253.4012,-1391.0782"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1254.7917,-1394.2973 1263.0062,-1387.606 1252.4119,-1387.7142 1254.7917,-1394.2973"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe2" stroke-dasharray="5,2" d="M804.2362,-1882.4742C821.5107,-1875.0046 842.9791,-1863.8825 858.9067,-1849.5228 907.1223,-1806.0535 943.8255,-1737.173 960.1659,-1703.0604"/>
<polygon fill="#00ffe2" stroke="#00ffe2" points="963.4986,-1704.1968 964.5735,-1693.6566 957.1603,-1701.226 963.4986,-1704.1968"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M784.7628,-1904.5552C834.7549,-1959.3096 1056.349,-2202.0128 1120.0067,-2271.7347"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1117.6374,-2274.3305 1126.9648,-2279.3555 1122.8069,-2269.6107 1117.6374,-2274.3305"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0071ff" stroke-dasharray="5,2" d="M969.4926,-2635.5228C989.995,-2662.9058 1015.5267,-2635.6818 1044.0784,-2654.5228 1066.0401,-2669.0151 1063.4173,-2681.1572 1080.0784,-2701.5228 1144.3348,-2780.0663 1154.8463,-2805.6017 1230.2432,-2873.5228 1305.972,-2941.7429 1408.2949,-3006.7126 1456.7769,-3036.1098"/>
<polygon fill="#0071ff" stroke="#0071ff" points="1455.0868,-3039.1777 1465.4583,-3041.3417 1458.7,-3033.1823 1455.0868,-3039.1777"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M808.3668,-1884.0402C826.1407,-1877.2916 846.7324,-1866.3695 858.9067,-1849.5228 916.939,-1769.2187 856.185,-1720.721 894.9067,-1629.5228 938.245,-1527.4516 1005.3319,-1533.4239 1044.0784,-1429.5228 1081.298,-1329.7159 1014.6698,-1039.4798 1078.9065,-940.9148"/>
<polygon fill="#0038ff" stroke="#0038ff" points="1081.7704,-942.928 1084.8625,-932.7944 1076.1259,-938.788 1081.7704,-942.928"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M1302.7859,-2023.5228C1592.5384,-2023.5228 1759.0714,-1995.6439 1918.6055,-2237.5228 1953.4322,-2290.3257 1943.4827,-3313.2545 1954.6055,-3375.5228 1964.6509,-3431.7602 1989.2819,-3494.704 2002.7698,-3526.5822"/>
<polygon fill="#7100ff" stroke="#7100ff" points="1999.7162,-3528.3414 2006.8796,-3536.1476 2006.1477,-3525.5781 1999.7162,-3528.3414"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M778.6484,-1904.719C791.5307,-1941.4408 832.9227,-2061.7072 858.9067,-2163.5228 879.081,-2242.5734 850.8848,-2274.8346 894.9067,-2343.5228 912.8593,-2371.5345 1104.2186,-2514.8573 1137.1608,-2519.5228"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1137.1608,-2519.5228C1289.9519,-2541.446 1330.1503,-2521.4663 1484.4558,-2517.5228"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0071" stroke-dasharray="5,2" d="M779.1596,-1904.6052C793.6079,-1940.9785 839.2531,-2060.2982 858.9067,-2163.5228 879.1621,-2269.9076 828.4523,-2564.0137 894.9067,-2649.5228 898.9765,-2654.7595 904.1862,-2658.909 909.9569,-2662.1954"/>
<polygon fill="#ff0071" stroke="#ff0071" points="908.869,-2665.5534 919.4036,-2666.6815 911.8718,-2659.2301 908.869,-2665.5534"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M969.4926,-1987.5228C1003.8352,-2003.3816 1015.2387,-2004.0443 1044.0784,-2028.5228 1146.197,-2115.1991 1117.358,-2193.426 1230.2432,-2265.5228 1432.4333,-2394.6562 1577.0993,-2229.233 1755.6028,-2389.5228 1834.4159,-2460.2942 1850.805,-2597.3817 1854.2112,-2650.1254"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1850.7276,-2650.5208 1854.7709,-2660.3138 1857.7171,-2650.1368 1850.7276,-2650.5208"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M779.1071,-1904.6153C793.3948,-1941.0198 838.6036,-2060.4239 858.9067,-2163.5228 876.7926,-2254.347 850.3327,-2497.3927 894.9067,-2578.5228 914.9965,-2615.0885 942.4256,-2603.7733 969.4926,-2635.5228"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M969.4926,-2635.5228C991.6852,-2661.5548 1011.505,-2644.0751 1044.0784,-2654.5228 1210.8685,-2708.0195 1246.8106,-2737.4008 1411.3286,-2797.5228 1421.0636,-2801.0804 1431.5822,-2804.7674 1441.525,-2808.1817"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1440.6311,-2811.5747 1451.2256,-2811.4902 1442.8908,-2804.9495 1440.6311,-2811.5747"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M808.4823,-1884.5724C826.5253,-1877.9572 847.3422,-1866.992 858.9067,-1849.5228 914.0387,-1766.2415 876.6357,-1499.7138 894.9067,-1401.5228 937.6417,-1171.8595 982.4009,-1122.839 1044.0784,-897.5228 1061.3821,-834.3097 1049.6033,-812.545 1080.0784,-754.5228 1089.4472,-736.6852 1104.6729,-719.6925 1117.044,-707.5577"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1119.4598,-710.0904 1124.3,-700.6658 1114.639,-705.0149 1119.4598,-710.0904"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M808.2143,-1891.3256C859.9355,-1887.212 961.8168,-1876.2161 1044.0784,-1849.5228 1166.4771,-1809.8052 1178.3373,-1752.2563 1302.7859,-1719.5228"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1302.7859,-1567.5228C1321.632,-1529.5277 1353.2927,-1541.7612 1375.3286,-1505.5228 1422.8349,-1427.398 1468.9914,-1139.9652 1481.2826,-1058.9221"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1484.7638,-1059.3087 1482.7888,-1048.8995 1477.8415,-1058.2683 1484.7638,-1059.3087"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M969.4926,-1835.5228C1137.772,-1747.1368 1218.3234,-1737.8054 1302.7859,-1567.5228"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M808.4469,-1884.5489C826.4785,-1877.9262 847.2958,-1866.9611 858.9067,-1849.5228 910.8234,-1771.5499 864.3361,-1518.0697 894.9067,-1429.5228 934.4255,-1315.0579 1002.6238,-1315.3009 1044.0784,-1201.5228 1090.05,-1075.3468 1007.1276,-1014.2701 1080.0784,-901.5228 1120.9541,-838.3483 1203.0721,-800.6194 1255.3605,-781.9913"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1256.7752,-785.2053 1265.0795,-778.6259 1254.4848,-778.5907 1256.7752,-785.2053"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M779.1487,-1904.6784C793.1685,-1939.0479 838.7768,-2045.6391 894.9067,-2122.5228 903.5509,-2134.3631 1067.446,-2303.0838 1080.0784,-2310.5228 1348.6181,-2468.6614 1552.4669,-2262.1815 1755.6028,-2498.5228 1782.6021,-2529.9355 1841.792,-3172.0001 1853.1856,-3298.1275"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1849.7275,-3298.7516 1854.1105,-3308.3973 1856.6993,-3298.1237 1849.7275,-3298.7516"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1044.1643,-2569.5282 894.8208,-2569.5282 894.8208,-2547.5174 1044.1643,-2547.5174 1044.1643,-2569.5282"/>
<text text-anchor="middle" x="969.4926" y="-2555.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.7859,-2555.5228C1431.1988,-2539.2599 1464.1932,-2567.9659 1593.583,-2571.5228 1925.9439,-2580.6593 2025.2794,-2553.4865 2323.0276,-2405.5228"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1302.7859,-2555.5228C1384.7847,-2546.538 1401.9931,-2519.6302 1484.4558,-2517.5228"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1044.2041,-2562.1071C1111.918,-2564.3459 1214.3466,-2565.2132 1302.7859,-2555.5228"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1302.7859,-2555.5228C1355.8652,-2548.8952 1361.5172,-2523.0206 1411.3286,-2503.5228 1549.319,-2449.5087 1717.8916,-2402.442 1802.0221,-2380.1847"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1803.0769,-2383.5263 1811.8556,-2377.5945 1801.2939,-2376.7572 1803.0769,-2383.5263"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2019.3405,-3558.706C2049.8584,-3603.724 2171.8043,-3771.379 2323.0276,-3815.5228"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M2045.9117,-3536.421C2054.0947,-3532.7838 2062.4516,-3528.1843 2069.3291,-3522.5228 2122.7054,-3478.5839 2095.991,-3425.6538 2157.7203,-3394.5228"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M2013.3059,-3558.8283C2020.3689,-3616.8598 2054.8978,-3880.974 2105.3291,-3943.5228 2107.8891,-3946.6978 2110.9489,-3949.4938 2114.2866,-3951.9512"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="2112.6884,-3955.0788 2123.0291,-3957.3852 2116.3837,-3949.1336 2112.6884,-3955.0788"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff38" stroke-dasharray="5,2" d="M2040.4159,-3558.6483C2063.0884,-3567.5148 2095.0379,-3580.0094 2119.8694,-3589.7203"/>
<polygon fill="#00ff38" stroke="#00ff38" points="2118.7555,-3593.0428 2129.3434,-3593.4254 2121.305,-3586.5236 2118.7555,-3593.0428"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-898.5282 -.2403,-898.5282 -.2403,-876.5174 130.719,-876.5174 130.719,-898.5282"/>
<text text-anchor="middle" x="65.2394" y="-884.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1137.1608,-4499.5228C1210.7238,-4496.8614 1229.2262,-4496.7694 1302.7859,-4499.5228"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.3342,-898.6018C66.9765,-1082.7426 91.0643,-3501.1774 223.8406,-3553.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-3553.5228C402.884,-3624.1084 178.5973,-2826.0425 317.2024,-2692.5228 374.9502,-2636.8937 475.9049,-2647.2967 536.2116,-2660.2084"/>
<polygon fill="#ff0000" stroke="#ff0000" points="535.7299,-2663.6873 546.2537,-2662.4622 537.2629,-2656.8572 535.7299,-2663.6873"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1137.1608,-4499.5228C1178.9278,-4497.1349 1188.7174,-4490.6019 1230.2432,-4485.5228 1342.8895,-4471.7448 1370.97,-4461.5228 1484.4558,-4461.5228 1484.4558,-4461.5228 1484.4558,-4461.5228 2011.9673,-4461.5228 2324.6916,-4461.5228 2326.9119,-4178.5998 2399.9436,-3874.5228 2462.6067,-3613.6166 2486.8001,-2728.2078 2490.4735,-2578.9658"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2493.9758,-2578.9064 2490.7191,-2568.8246 2486.9779,-2578.7369 2493.9758,-2578.9064"/>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M774.6899,-4499.5228C935.6987,-4494.1564 976.168,-4505.3473 1137.1608,-4499.5228"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff7100" stroke-dasharray="5,2" d="M223.8406,-955.5228C252.6047,-965.906 255.8947,-976.3557 281.2024,-993.5228 297.3231,-1004.458 299.6761,-1010.0207 317.2024,-1018.5228 325.7381,-1022.6635 335.1075,-1026.2935 344.3644,-1029.4101"/>
<polygon fill="#ff7100" stroke="#ff7100" points="343.3395,-1032.7569 353.9305,-1032.4719 345.4734,-1026.0901 343.3395,-1032.7569"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M969.4926,-4385.5228C1190.5215,-4323.7645 1254.961,-4347.5228 1484.4558,-4347.5228 1484.4558,-4347.5228 1484.4558,-4347.5228 1674.5929,-4347.5228 1824.8851,-4347.5228 1889.6263,-4411.8178 2011.9673,-4324.5228"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffe200" stroke-dasharray="5,2" d="M223.8406,-3553.5228C268.0269,-3570.9427 273.4973,-3586.9283 317.2024,-3605.5228 327.3597,-3609.8442 338.5147,-3613.7623 349.2337,-3617.1474"/>
<polygon fill="#ffe200" stroke="#ffe200" points="348.3279,-3620.5303 358.9141,-3620.1026 350.3717,-3613.8353 348.3279,-3620.5303"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M65.8243,-876.2977C69.9368,-800.7563 96.4117,-366.2324 166.4788,-257.5228 183.046,-231.8185 202.0294,-240.9578 223.8406,-219.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M969.4926,-47.5228C1043.6392,-54.9648 1071.2629,-12.7293 1137.1608,-47.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1484.4558,-424.5228C1547.763,-508.4681 1818.0359,-491.133 1918.6055,-535.5228 2111.0883,-620.4815 2147.8177,-707.5574 2210.1116,-908.5228 2276.5265,-1122.7832 2315.3661,-1859.2911 2322.0058,-1994.2076"/>
<polygon fill="#e2ff00" stroke="#e2ff00" points="2318.5219,-1994.6254 2322.5041,-2004.4434 2325.5136,-1994.2849 2318.5219,-1994.6254"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1137.1608,-47.5228C1163.6846,-61.5271 1173.4275,-61.9278 1194.2432,-83.5228 1260.9342,-152.7108 1249.566,-190.5083 1302.7859,-270.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1302.7859,-270.5228C1321.2438,-298.2737 1347.3336,-271.4374 1375.3286,-289.5228 1440.1333,-331.388 1437.8629,-363.0294 1484.4558,-424.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M223.8406,-219.5228C276.1321,-168.1331 253.2936,-119.4527 317.2024,-83.5228 570.2942,58.7672 680.5962,-18.5265 969.4926,-47.5228"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M223.8406,-3553.5228C304.3958,-3585.2806 383.0117,-2867.3371 396.9156,-2733.747"/>
<polygon fill="#aaff00" stroke="#aaff00" points="400.4189,-2733.8952 397.9649,-2723.5885 393.4559,-2733.176 400.4189,-2733.8952"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#71ff00" stroke-dasharray="5,2" d="M1302.7859,-270.5228C1321.2438,-298.2737 1351.9877,-265.7319 1375.3286,-289.5228 1423.0401,-338.154 1395.0264,-372.3743 1411.3286,-438.5228 1436.3071,-539.8769 1466.9883,-660.8627 1479.139,-708.6422"/>
<polygon fill="#71ff00" stroke="#71ff00" points="1475.7719,-709.6029 1481.6297,-718.4311 1482.5557,-707.8768 1475.7719,-709.6029"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#38ff00" stroke-dasharray="5,2" d="M223.8406,-3553.5228C374.3346,-3612.7231 424.2137,-3523.8337 585.7192,-3515.5228"/>
<path fill="none" stroke="#38ff00" stroke-dasharray="5,2" d="M585.7192,-3515.5228C630.3641,-3508.6912 680.3983,-3498.2381 717.7621,-3489.8729"/>
<polygon fill="#38ff00" stroke="#38ff00" points="718.9655,-3493.1894 727.9496,-3487.5736 717.4243,-3486.3611 718.9655,-3493.1894"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1137.1608,-3591.5228C1163.0635,-3582.2244 1170.7287,-3581.8225 1194.2432,-3567.5228 1212.0384,-3556.7011 1212.1,-3547.7503 1230.2432,-3537.5228 1237.1786,-3533.6132 1244.8295,-3530.1665 1252.4839,-3527.1797"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1253.9449,-3530.3719 1262.1278,-3523.642 1251.5341,-3523.8001 1253.9449,-3530.3719"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff38" stroke-dasharray="5,2" d="M1302.7859,-4309.5228C1513.5177,-4297.958 1587.9838,-4294.7629 1755.6028,-4166.5228 1965.341,-4006.0586 2111.6901,-3706.0456 2148.5961,-3625.0942"/>
<polygon fill="#00ff38" stroke="#00ff38" points="2151.9808,-3626.1026 2152.9011,-3615.5478 2145.5996,-3623.2249 2151.9808,-3626.1026"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M223.8406,-219.5228C244.4165,-199.3457 452.9947,-246.5856 480.9653,-253.5228 740.9814,-318.0115 831.9521,-304.9086 1044.0784,-468.5228 1132.3759,-536.6272 1155.2541,-565.0502 1194.2432,-669.5228 1271.2129,-875.7661 1186.4006,-947.795 1230.2432,-1163.5228 1245.0352,-1236.3072 1277.8681,-1318.465 1293.786,-1355.9279"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1290.6342,-1357.4585 1297.798,-1365.2643 1297.0655,-1354.6948 1290.6342,-1357.4585"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M774.6899,-3515.5228C780.5418,-3511.149 863.9987,-3495.4778 919.7591,-3485.3816"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="920.6041,-3488.7857 929.8235,-3483.5653 919.3608,-3481.897 920.6041,-3488.7857"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe2" stroke-dasharray="5,2" d="M223.8406,-692.5228C395.1124,-603.5486 484.2439,-657.5698 654.4731,-748.5228 674.1553,-759.0389 672.3332,-770.526 690.4731,-783.5228 758.7988,-832.4765 810.2778,-800.9656 858.9067,-869.5228 953.1236,-1002.3498 967.2571,-1546.4567 969.2017,-1661.2115"/>
<polygon fill="#00ffe2" stroke="#00ffe2" points="965.7063,-1661.5372 969.3617,-1671.4814 972.7054,-1661.4281 965.7063,-1661.5372"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00e2ff" stroke-dasharray="5,2" d="M1137.1608,-47.5228C1163.6846,-61.5271 1177.489,-58.6444 1194.2432,-83.5228 1244.9375,-158.7992 1171.2189,-215.5838 1230.2432,-284.5228 1233.1983,-287.9743 1236.6538,-290.9499 1240.4238,-293.5151"/>
<polygon fill="#00e2ff" stroke="#00e2ff" points="1238.6925,-296.5569 1249.1075,-298.5006 1242.1778,-290.4862 1238.6925,-296.5569"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M774.6899,-3515.5228C805.4244,-3492.5514 833.9452,-3525.664 858.9067,-3496.5228 897.3768,-3451.6112 878.2554,-3022.2655 894.9067,-2965.5228 933.62,-2833.5999 1003.7306,-2825.9549 1044.0784,-2694.5228 1068.5972,-2614.6532 1027.6925,-2389.6215 1081.1486,-2308.3254"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1084.1741,-2310.1249 1087.3755,-2300.0253 1078.5746,-2305.924 1084.1741,-2310.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M70.5486,-876.2585C87.3944,-841.9108 143.3202,-738.0755 223.8406,-692.5228"/>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M223.8406,-692.5228C264.8091,-669.3458 271.5476,-653.9783 317.2024,-642.5228 387.7975,-624.8093 408.5623,-635.0907 480.9653,-642.5228 743.5784,-669.4797 822.0196,-688.7565 1044.0784,-831.5228 1075.0166,-851.4136 1104.4324,-882.6449 1121.6329,-902.594"/>
<polygon fill="#0038ff" stroke="#0038ff" points="1119.0947,-905.0129 1128.2255,-910.3869 1124.4389,-900.4918 1119.0947,-905.0129"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-955.5228C252.3413,-966.6086 260.8008,-970.7421 281.2024,-993.5228 304.5418,-1019.5838 291.7244,-1039.5483 317.2024,-1063.5228 375.1052,-1118.0086 433.7801,-1071.5307 480.9653,-1135.5228 522.6476,-1192.0518 495.7517,-1382.5682 516.9653,-1449.5228 555.5022,-1571.153 608.4468,-1582.5246 654.4731,-1701.5228 678.8936,-1764.6604 648.7555,-1796.2091 690.4731,-1849.5228 700.9964,-1862.9711 716.7792,-1872.7378 731.8475,-1879.6014"/>
<polygon fill="#0000ff" stroke="#0000ff" points="730.5103,-1882.8359 741.0839,-1883.5067 733.2364,-1876.3886 730.5103,-1882.8359"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#3800ff" stroke-dasharray="5,2" d="M585.7192,-3515.5228C668.7399,-3502.8189 707.4169,-3565.8035 774.6899,-3515.5228"/>
<path fill="none" stroke="#3800ff" stroke-dasharray="5,2" d="M774.6899,-3515.5228C805.4244,-3492.5514 834.3345,-3525.9931 858.9067,-3496.5228 921.22,-3421.7884 852.122,-2708.9163 894.9067,-2621.5228 904.528,-2601.8701 923.4123,-2586.0177 939.7708,-2575.1303"/>
<polygon fill="#3800ff" stroke="#3800ff" points="941.9395,-2577.9002 948.5241,-2569.6 938.2006,-2571.9824 941.9395,-2577.9002"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M1302.7859,-4309.5228C1644.1912,-4274.1991 1730.8909,-4130.8704 1918.6055,-3843.5228 1978.3327,-3752.0942 2002.0056,-3619.9078 2009.2765,-3568.803"/>
<polygon fill="#7100ff" stroke="#7100ff" points="2012.7775,-3569.0316 2010.6533,-3558.6519 2005.841,-3568.0908 2012.7775,-3569.0316"/>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M1137.1608,-4309.5228C1207.1723,-4286.7853 1229.2853,-4313.5564 1302.7859,-4309.5228"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1375.3714,-3977.5282 1230.2004,-3977.5282 1230.2004,-3955.5174 1375.3714,-3955.5174 1375.3714,-3977.5282"/>
<text text-anchor="middle" x="1302.7859" y="-3963.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#e200ff" stroke-dasharray="5,2" d="M223.8406,-3553.5228C361.3313,-3609.1433 294.0035,-4092.8544 399.0839,-4197.5228"/>
<path fill="none" stroke="#e200ff" stroke-dasharray="5,2" d="M399.0839,-4197.5228C409.0654,-4207.4652 846.1457,-3989.4925 858.9067,-3983.5228 908.1017,-3960.509 915.3896,-3926.7645 969.4926,-3931.5228"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-1024.5282 180.0456,-1024.5282 180.0456,-1002.5174 267.6355,-1002.5174 267.6355,-1024.5282"/>
<text text-anchor="middle" x="223.8406" y="-1010.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#ff00e2" stroke-dasharray="5,2" d="M78.9019,-898.7798C98.2663,-914.6909 134.8605,-944.5985 166.4788,-969.5228 177.834,-978.474 190.5857,-988.2794 201.1774,-996.3575"/>
<polygon fill="#ff00e2" stroke="#ff00e2" points="199.063,-999.1466 209.1407,-1002.4163 203.3015,-993.5757 199.063,-999.1466"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M969.4926,-3591.5228C1126.7466,-3542.4275 1036.3959,-3445.6418 1411.3286,-3153.5228 1469.9433,-3107.8547 1517.7058,-3135.221 1557.583,-3072.5228 1620.8172,-2973.1007 1520.4409,-2635.9 1593.583,-2543.5228 1597.0664,-2539.1233 1601.3089,-2535.4798 1606.0073,-2532.4646"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1607.7408,-2535.5065 1614.8911,-2527.6883 1604.4259,-2529.3411 1607.7408,-2535.5065"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M774.6899,-3591.5228C861.2608,-3592.7076 885.0729,-3610.7384 969.4926,-3591.5228"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0071" stroke-dasharray="5,2" d="M774.6899,-3515.5228C805.4244,-3492.5514 834.2754,-3525.9436 858.9067,-3496.5228 915.8117,-3428.5529 841.5238,-2770.2925 894.9067,-2699.5228 898.9007,-2694.2281 904.0633,-2690.0425 909.8075,-2686.7358"/>
<polygon fill="#ff0071" stroke="#ff0071" points="911.7173,-2689.7021 919.2284,-2682.2299 908.697,-2683.3873 911.7173,-2689.7021"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M223.8406,-955.5228C252.6047,-965.906 265.7414,-967.1383 281.2024,-993.5228 335.6185,-1086.3847 270.1174,-1379.7372 317.2024,-1476.5228 371.0735,-1587.2576 498.834,-1671.5288 556.5384,-1705.3401"/>
<polygon fill="#ff0038" stroke="#ff0038" points="555.0891,-1708.5448 565.4994,-1710.5136 558.5891,-1702.4826 555.0891,-1708.5448"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-3591.5228C828.4757,-3592.2589 841.2063,-3602.4064 894.9067,-3605.5228 1027.7217,-3613.2303 1072.7126,-3659.6479 1194.2432,-3605.5228 1216.0919,-3595.7922 1209.6168,-3577.6307 1230.2432,-3565.5228 1287.2728,-3532.0457 1327.162,-3577.8336 1375.3286,-3532.5228 1416.8166,-3493.4947 1376.4302,-3454.54 1411.3286,-3409.5228 1457.6677,-3349.7477 1499.0662,-3370.4409 1557.583,-3322.5228 1659.1089,-3239.3855 1694.9192,-3219.8706 1755.6028,-3103.5228 1830.9805,-2959.0022 1849.7392,-2757.9413 1853.9705,-2692.7989"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1857.4786,-2692.7687 1854.5847,-2682.5768 1850.4912,-2692.3489 1857.4786,-2692.7687"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2069.1913,-3366.5282 1954.7433,-3366.5282 1954.7433,-3344.5174 2069.1913,-3344.5174 2069.1913,-3366.5282"/>
<text text-anchor="middle" x="2011.9673" y="-3352.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M969.4926,-4385.5228C1050.264,-4372.4838 1060.1767,-4337.2265 1137.1608,-4309.5228"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M399.0839,-4197.5228C488.5308,-4297.5734 419.0254,-4383.7696 516.9653,-4475.5228 540.585,-4497.6505 555.7289,-4487.3528 585.7192,-4499.5228"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1137.1608,-4309.5228C1572.0088,-4153.037 1694.524,-4027.711 1918.6055,-3623.5228 1931.1436,-3600.9071 1985.9025,-3435.157 2005.2039,-3376.2369"/>
<polygon fill="#ffda00" stroke="#ffda00" points="2008.5943,-3377.1296 2008.3771,-3366.537 2001.9412,-3374.9531 2008.5943,-3377.1296"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M585.7192,-4499.5228C626.9378,-4516.2492 925.578,-4392.6119 969.4926,-4385.5228"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1137.1608,-3591.5228C1163.0635,-3582.2244 1174.307,-3586.4955 1194.2432,-3567.5228 1221.0272,-3542.0331 1211.6171,-3524.463 1230.2432,-3492.5228 1301.1824,-3370.8752 1312.6933,-3333.0294 1411.3286,-3232.5228 1467.5585,-3175.2261 1518.3781,-3196.5777 1557.583,-3126.5228 1608.5223,-3035.4998 1555.2433,-2755.5283 1593.583,-2658.5228 1614.7342,-2605.0069 1643.695,-2606.0681 1674.5929,-2557.5228"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M969.4926,-3591.5228C1042.1532,-3574.9838 1067.3842,-3617.6828 1137.1608,-3591.5228"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M223.8406,-3553.5228C327.2012,-3595.3363 346.9688,-3591.5228 774.6899,-3591.5228"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M774.6899,-3591.5228C838.1674,-3591.5228 1001.6101,-3543.7015 1044.0784,-3496.5228 1090.2361,-3445.2454 1057.028,-3410.5503 1080.0784,-3345.5228 1119.2745,-3234.9464 1145.3465,-3214.1651 1194.2432,-3107.5228 1244.3898,-2998.1543 1200.6974,-2923.1946 1302.7859,-2859.5228"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M223.8406,-219.5228C224.9372,-218.4696 1042.9204,-525.5374 1044.0784,-526.5228 1090.2116,-565.7791 1118.4254,-633.9652 1130.4198,-668.3719"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1127.2445,-669.9112 1133.7463,-678.2765 1133.8803,-667.6825 1127.2445,-669.9112"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~datazoneenergydemands.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/datazoneenergydemands.f90.html" xlink:title="DataZoneEnergyDemands.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2399.8597,-3865.5282 2246.1955,-3865.5282 2246.1955,-3843.5174 2399.8597,-3843.5174 2399.8597,-3865.5282"/>
<text text-anchor="middle" x="2323.0276" y="-3851.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEnergyDemands.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M585.7192,-4499.5228C661.5572,-4535.6119 691.0923,-4507.6003 774.6899,-4499.5228"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M774.6899,-4499.5228C975.3322,-4480.1359 1473.0162,-4385.5228 1674.5929,-4385.5228 1674.5929,-4385.5228 1674.5929,-4385.5228 2011.9673,-4385.5228 2252.6967,-4385.5228 2310.6368,-3974.1835 2321.0677,-3875.579"/>
<polygon fill="#4800ff" stroke="#4800ff" points="2324.5516,-3875.9135 2322.0697,-3865.6135 2317.5867,-3875.2131 2324.5516,-3875.9135"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1718.477,-3711.5282 1630.7088,-3711.5282 1630.7088,-3689.5174 1718.477,-3689.5174 1718.477,-3711.5282"/>
<text text-anchor="middle" x="1674.5929" y="-3697.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M585.7192,-4197.5228C906.0916,-4186.0937 993.8667,-4205.185 1302.7859,-4119.5228"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1302.7859,-4119.5228C1420.1071,-4087.3506 1481.0671,-4114.0989 1557.583,-4019.5228 1619.3487,-3943.1785 1553.5554,-3891.1958 1593.583,-3801.5228 1608.2391,-3768.689 1636.2086,-3737.4536 1655.1316,-3718.6385"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1657.6457,-3721.0757 1662.3794,-3711.5972 1652.768,-3716.055 1657.6457,-3721.0757"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-211.5282 334.3841,-211.5282 334.3841,-189.5174 463.7837,-189.5174 463.7837,-211.5282"/>
<text text-anchor="middle" x="399.0839" y="-197.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-219.5228C249.9558,-194.4413 289.3659,-188.4858 324.2027,-189.3345"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.2267,-192.8387 334.3683,-189.7729 324.5284,-185.8452 324.2267,-192.8387"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-820.5282 340.6161,-820.5282 340.6161,-798.5174 457.5516,-798.5174 457.5516,-820.5282"/>
<text text-anchor="middle" x="399.0839" y="-806.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M88.5403,-898.5358C119.1597,-912.7698 174.8086,-937.8234 223.8406,-955.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-955.5228C287.7305,-978.5856 261.333,-873.1547 317.2024,-834.5228 323.0858,-830.4546 329.6509,-827.0324 336.4334,-824.1572"/>
<polygon fill="#ff0000" stroke="#ff0000" points="337.6956,-827.4218 345.7734,-820.5661 335.1835,-820.888 337.6956,-827.4218"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-779.5282 539.0902,-779.5282 539.0902,-757.5174 632.3482,-757.5174 632.3482,-779.5282"/>
<text text-anchor="middle" x="585.7192" y="-765.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M223.8406,-955.5228C277.4746,-974.8834 266.9423,-894.4554 317.2024,-867.5228 350.1313,-849.8774 366.8972,-867.4882 399.0839,-848.5228"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-848.5228C431.2706,-829.5574 448.3008,-847.6528 480.9653,-829.5228 500.7496,-818.5418 497.8797,-805.6775 516.9653,-793.5228 523.0785,-789.6296 529.8823,-786.23 536.7653,-783.2972"/>
<polygon fill="#cbff00" stroke="#cbff00" points="538.1332,-786.52 546.1428,-779.5848 535.5566,-780.0115 538.1332,-786.52"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-820.5282 168.8556,-820.5282 168.8556,-798.5174 278.8255,-798.5174 278.8255,-820.5282"/>
<text text-anchor="middle" x="223.8406" y="-806.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M87.6267,-876.5127C114.9427,-863.0787 161.3011,-840.2797 192.2418,-825.0631"/>
<polygon fill="#00ff66" stroke="#00ff66" points="193.882,-828.1568 201.3109,-820.6029 190.7928,-821.8753 193.882,-828.1568"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-976.5282 323.0941,-976.5282 323.0941,-954.5174 475.0737,-954.5174 475.0737,-976.5282"/>
<text text-anchor="middle" x="399.0839" y="-962.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-955.5228C251.7885,-965.6113 283.8688,-969.4656 312.8795,-970.371"/>
<polygon fill="#0066ff" stroke="#0066ff" points="312.933,-973.8727 323.0011,-970.5737 313.0732,-966.8741 312.933,-973.8727"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-898.5282 317.3208,-898.5282 317.3208,-876.5174 480.847,-876.5174 480.847,-898.5282"/>
<text text-anchor="middle" x="399.0839" y="-884.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-955.5228C266.8104,-971.0339 274.5114,-928.7856 317.2024,-912.5228 327.5176,-908.5933 338.739,-904.8397 349.4726,-901.4907"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="350.6106,-904.8028 359.1528,-898.5354 348.5666,-898.1079 350.6106,-904.8028"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1484.4558,-424.5228C1512.68,-461.948 1537.3583,-458.2355 1557.583,-500.5228 1612.4788,-615.303 1573.0924,-658.9514 1593.583,-784.5228 1617.7176,-932.4251 1656.437,-1108.7598 1669.8429,-1168.5315"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1666.4316,-1169.3152 1672.0423,-1178.3025 1673.2608,-1167.778 1666.4316,-1169.3152"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M969.4926,-47.5228C1080.8021,-59.9783 1125.9048,-72.7826 1194.2432,-161.5228 1240.8345,-222.0237 1193.9711,-262.3257 1230.2432,-329.5228 1273.8464,-410.3014 1336.5485,-393.3211 1375.3286,-476.5228 1447.745,-631.89 1370.1446,-694.1287 1411.3286,-860.5228 1425.9612,-919.642 1457.0936,-984.7792 1473.6219,-1017.0541"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1470.7225,-1019.0656 1478.4357,-1026.329 1476.9355,-1015.8409 1470.7225,-1019.0656"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-955.5228C262.7671,-970.5642 275.5303,-947.7482 317.2024,-945.5228 389.8824,-941.6415 428.3498,-895.2331 480.9653,-945.5228 512.9664,-976.1093 513.8068,-1697.3682 516.9653,-1741.5228 536.24,-2010.9717 573.3485,-2337.3075 583.2439,-2422.4172"/>
<polygon fill="#0000ff" stroke="#0000ff" points="579.7727,-2422.8682 584.4081,-2432.3951 586.7255,-2422.0569 579.7727,-2422.8682"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1137.1608,-389.5228C1152.5698,-412.3257 1177.619,-391.5899 1194.2432,-413.5228 1272.1632,-516.3258 1170.8504,-587.013 1230.2432,-701.5228 1240.6942,-721.6724 1259.9327,-738.7342 1275.9725,-750.4599"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1274.278,-753.546 1284.4782,-756.4109 1278.2909,-747.8104 1274.278,-753.546"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-219.5228C261.0538,-182.6319 268.4061,-166.6196 317.2024,-147.5228 428.7786,-103.8564 465.9027,-123.5228 585.7192,-123.5228 585.7192,-123.5228 585.7192,-123.5228 774.6899,-123.5228 897.5482,-123.5228 948.8934,-107.8442 1044.0784,-185.5228 1121.2896,-248.5334 1081.3619,-306.9492 1137.1608,-389.5228"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-742.5282 353.1239,-742.5282 353.1239,-720.5174 445.0438,-720.5174 445.0438,-742.5282"/>
<text text-anchor="middle" x="399.0839" y="-728.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-692.5228C235.1701,-686.6372 303.782,-704.2609 351.7113,-717.7119"/>
<polygon fill="#ff0000" stroke="#ff0000" points="351.0218,-721.1542 361.597,-720.5089 352.9276,-714.4186 351.0218,-721.1542"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.7859,-4119.5228C1340.9312,-4106.027 1527.3663,-3863.7828 1557.583,-3791.5228 1595.8067,-3700.1147 1528.0673,-3645.8477 1593.583,-3571.5228 1618.4138,-3543.3532 1648.6723,-3574.6929 1674.5929,-3547.5228"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1541.8589,-3597.5282 1427.0527,-3597.5282 1427.0527,-3575.5174 1541.8589,-3575.5174 1541.8589,-3597.5282"/>
<text text-anchor="middle" x="1484.4558" y="-3583.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-4197.5228C454.3691,-4259.362 503.6585,-4209.6296 585.7192,-4197.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4197.5228C765.3998,-4171.0137 1253.551,-4121.2746 1375.3286,-3986.5228 1442.6417,-3912.0382 1383.9778,-3860.1196 1411.3286,-3763.5228 1427.9207,-3704.9233 1458.2084,-3639.5621 1474.0976,-3607.1176"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1477.415,-3608.3054 1478.7149,-3597.7906 1471.1416,-3605.1998 1477.415,-3608.3054"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1319.3264,-3977.6713C1433.6115,-4054.1334 2107.7917,-4495.894 2323.0276,-4423.5228"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M1375.7005,-3961.8091C1409.0524,-3960.96 1448.9604,-3961.7858 1484.4558,-3967.5228"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1305.0186,-3955.5116C1314.9,-3906.3683 1355.1017,-3702.0577 1375.3286,-3532.5228 1401.723,-3311.2943 1366.3051,-3250.7236 1411.3286,-3032.5228 1426.1613,-2960.6383 1459.2968,-2879.6984 1475.3678,-2842.8027"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1478.5897,-2844.1707 1479.4187,-2833.6083 1472.1839,-2841.3483 1478.5897,-2844.1707"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1311.9852,-3955.3135C1327.8751,-3935.2755 1360.2105,-3891.385 1375.3286,-3848.5228 1396.3426,-3788.9449 1369.5872,-3613.9439 1411.3286,-3566.5228 1433.5158,-3541.3166 1455.7886,-3565.0102 1484.4558,-3547.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2157.7203,-694.5228C2229.6237,-709.6137 2265.2228,-649.1749 2323.0276,-694.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-883.5228C829.1566,-862.9744 838.4996,-845.9133 894.9067,-831.5228 1102.6667,-778.5193 1163.2722,-819.2344 1375.3286,-787.5228 1457.1625,-775.2851 1477.1376,-768.89 1557.583,-749.5228 1662.4159,-724.2842 1685.2777,-703.4643 1791.6028,-685.5228 1913.4115,-664.9685 1946.5622,-660.8071 2069.3291,-674.5228 2109.3581,-678.9949 2118.3011,-686.2495 2157.7203,-694.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2482.5228C475.8893,-2530.3662 444.9858,-2593.6867 516.9653,-2648.5228 522.0043,-2652.3616 527.6895,-2655.6536 533.5779,-2658.466"/>
<polygon fill="#ff0000" stroke="#ff0000" points="532.366,-2661.7549 542.9346,-2662.5006 535.1377,-2655.327 532.366,-2661.7549"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M399.0839,-2482.5228C456.0629,-2515.6631 462.2741,-2535.7292 516.9653,-2572.5228 575.8164,-2612.115 599.7523,-2608.3939 654.4731,-2653.5228 716.7116,-2704.8515 701.8211,-2754.9049 774.6899,-2789.5228"/>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M774.6899,-2789.5228C888.0541,-2848.0206 1792.4374,-2710.365 1918.6055,-2691.5228 1960.5756,-2685.2549 1969.5413,-2670.6216 2011.9673,-2671.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff7100" stroke-dasharray="5,2" d="M267.6098,-1021.0157C287.918,-1024.4922 312.4607,-1028.6937 334.8156,-1032.5207"/>
<polygon fill="#ff7100" stroke="#ff7100" points="334.4626,-1036.0111 344.9098,-1034.2487 335.6438,-1029.1114 334.4626,-1036.0111"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M2011.9673,-4043.5228C2058.2399,-4032.5498 2106.2085,-4003.9443 2133.9417,-3985.4019"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="2136.2491,-3988.0648 2142.5394,-3979.5394 2132.3055,-3982.2814 2136.2491,-3988.0648"/>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M1484.4558,-3967.5228C1718.2915,-4005.3167 1781.4887,-4098.1778 2011.9673,-4043.5228"/>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M774.6899,-3437.5228C813.0445,-3438.628 825.7992,-3437.1273 858.9067,-3456.5228 879.5437,-3468.6126 876.1258,-3481.7132 894.9067,-3496.5228 954.1466,-3543.2361 1000.5531,-3515.9026 1044.0784,-3577.5228 1103.2655,-3661.3161 1019.9049,-3722.4349 1080.0784,-3805.5228 1136.8591,-3883.926 1389.352,-3949.457 1484.4558,-3967.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffe200" stroke-dasharray="5,2" d="M223.974,-1024.6233C226.139,-1201.9641 254.7433,-3446.2994 317.2024,-3567.5228 327.696,-3587.8892 348.1032,-3603.6161 365.9186,-3614.263"/>
<polygon fill="#ffe200" stroke="#ffe200" points="364.5057,-3617.485 374.9323,-3619.3652 367.9539,-3611.3932 364.5057,-3617.485"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M399.0839,-1149.5228C476.6804,-1178.8369 502.7707,-1149.2302 585.7192,-1149.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M774.6899,-1073.5228C987.269,-1024.9784 1554.5043,-964.2269 1755.6028,-1048.5228 2169.9188,-1222.1946 2298.3788,-1868.6788 2319.6581,-1994.2975"/>
<polygon fill="#e2ff00" stroke="#e2ff00" points="2316.2617,-1995.2125 2321.3431,-2004.5092 2323.1683,-1994.0728 2316.2617,-1995.2125"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M585.7192,-1149.5228C639.8196,-1149.7136 639.6445,-1106.0521 690.4731,-1087.5228 726.1216,-1074.5273 737.2979,-1079.9672 774.6899,-1073.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#71ff00" stroke-dasharray="5,2" d="M585.7192,-845.5228C641.719,-818.3316 800.2894,-804.483 858.9067,-783.5228 875.7508,-777.4997 877.6301,-770.1616 894.9067,-765.5228 1074.4364,-717.3182 1295.329,-719.3313 1408.9824,-724.6132"/>
<polygon fill="#71ff00" stroke="#71ff00" points="1408.8176,-728.1092 1418.9758,-725.099 1409.1576,-721.1174 1408.8176,-728.1092"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#38ff00" stroke-dasharray="5,2" d="M585.7192,-3475.5228C629.6392,-3481.9164 679.9111,-3481.832 717.5571,-3480.3306"/>
<polygon fill="#38ff00" stroke="#38ff00" points="717.99,-3483.8149 727.8245,-3479.8738 717.6788,-3476.8218 717.99,-3483.8149"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1137.1608,-3553.5228C1148.2427,-3558.4865 1213.0753,-3540.2717 1258.2574,-3526.5338"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1259.3206,-3529.8687 1267.8568,-3523.593 1257.2701,-3523.1758 1259.3206,-3529.8687"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-3399.5228C788.7101,-3379.3154 870.7423,-3315.967 1044.0784,-3423.5228 1071.8092,-3440.7299 1061.3095,-3460.8242 1080.0784,-3487.5228 1102.3823,-3519.25 1101.7666,-3537.6694 1137.1608,-3553.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff38" stroke-dasharray="5,2" d="M1137.1608,-3553.5228C1176.3042,-3571.5055 1373.3724,-3640.3016 1411.3286,-3646.5228 1432.5675,-3650.0039 1730.1748,-3645.9131 1755.6028,-3644.5228 1875.9431,-3637.9428 2015.8495,-3622.1818 2094.8734,-3612.5244"/>
<polygon fill="#00ff38" stroke="#00ff38" points="2095.6439,-3615.9561 2105.142,-3611.2619 2094.7896,-3609.0084 2095.6439,-3615.9561"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M585.7192,-1149.5228C850.7785,-1158.3963 878.6021,-1436.5363 1137.1608,-1377.5228"/>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M1137.1608,-1377.5228C1172.0733,-1370.8363 1211.8894,-1370.3743 1243.7321,-1371.6846"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1243.6177,-1375.183 1253.7741,-1372.1666 1243.9534,-1368.1911 1243.6177,-1375.183"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M774.6899,-3437.5228C826.3844,-3439.0951 884.3538,-3452.2057 923.512,-3462.7985"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="922.723,-3466.2115 933.2938,-3465.4982 924.5854,-3459.4638 922.723,-3466.2115"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffe2" stroke-dasharray="5,2" d="M225.5617,-1024.871C233.9132,-1078.6699 271.674,-1307.6576 317.2024,-1361.5228 368.8793,-1422.6623 408.8112,-1401.8481 480.9653,-1436.5228 655.7939,-1520.5391 862.6513,-1627.0978 939.1206,-1666.7364"/>
<polygon fill="#00ffe2" stroke="#00ffe2" points="937.7156,-1669.9504 948.2041,-1671.4481 940.9389,-1663.7366 937.7156,-1669.9504"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00e2ff" stroke-dasharray="5,2" d="M246.6543,-1002.3781C259.2042,-994.9366 273.711,-983.8762 281.2024,-969.5228 321.8074,-891.7238 264.9227,-251.0088 317.2024,-180.5228 392.6152,-78.8476 459.1296,-85.5228 585.7192,-85.5228 585.7192,-85.5228 585.7192,-85.5228 969.4926,-85.5228 1073.1128,-85.5228 1121.421,-73.8065 1194.2432,-147.5228 1238.4873,-192.3102 1187.4248,-238.3703 1230.2432,-284.5228 1233.5246,-288.0598 1237.3296,-291.0963 1241.4443,-293.7033"/>
<polygon fill="#00e2ff" stroke="#00e2ff" points="1239.7964,-296.7911 1250.2567,-298.4737 1243.1288,-290.6352 1239.7964,-296.7911"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M399.0839,-2482.5228C497.5651,-2539.588 550.0006,-2508.6944 654.4731,-2463.5228 674.3957,-2454.9087 671.9813,-2441.8878 690.4731,-2430.5228 773.1903,-2379.6852 803.2378,-2385.5134 894.9067,-2353.5228 927.7853,-2342.0488 939.475,-2347.1748 969.4926,-2329.5228"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M969.4926,-2329.5228C987.7139,-2318.7934 1037.0219,-2308.0093 1077.4818,-2300.5093"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="1078.3421,-2303.9102 1087.5532,-2298.6753 1077.088,-2297.0235 1078.3421,-2303.9102"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0071ff" stroke-dasharray="5,2" d="M585.7192,-3285.5228C642.3589,-3256.9203 632.6596,-3214.6712 690.4731,-3188.5228 939.7386,-3075.7826 1030.6168,-3153.2283 1302.7859,-3125.5228"/>
<path fill="none" stroke="#0071ff" stroke-dasharray="5,2" d="M224.2062,-1024.55C229.951,-1196.2246 302.778,-3315.9281 399.0839,-3399.5228"/>
<path fill="none" stroke="#0071ff" stroke-dasharray="5,2" d="M399.0839,-3399.5228C472.4872,-3463.2378 497.9994,-3327.3903 585.7192,-3285.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M231.9179,-1024.8295C246.7958,-1044.976 280.3947,-1087.4135 317.2024,-1113.5228 349.627,-1136.5229 361.2077,-1137.4498 399.0839,-1149.5228"/>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M399.0839,-1149.5228C426.7604,-1158.3447 867.0448,-991.7404 894.9067,-983.5228 957.6264,-965.0242 1030.4049,-946.8304 1079.6932,-934.9867"/>
<polygon fill="#0038ff" stroke="#0038ff" points="1080.624,-938.3628 1089.5346,-932.6312 1078.9946,-931.5551 1080.624,-938.3628"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-2482.5228C517.0078,-2555.9796 724.6996,-2026.1949 767.031,-1914.0856"/>
<polygon fill="#0000ff" stroke="#0000ff" points="770.3637,-1915.1666 770.6028,-1904.5744 763.8105,-1912.7056 770.3637,-1915.1666"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#3800ff" stroke-dasharray="5,2" d="M585.7192,-2558.5228C687.1692,-2586.4032 809.484,-2579.8883 888.3228,-2570.8025"/>
<polygon fill="#3800ff" stroke="#3800ff" points="889.1589,-2574.2276 898.6731,-2569.566 888.3285,-2567.277 889.1589,-2574.2276"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M1137.1608,-3741.5228C1150.6912,-3749.049 1395.9088,-3790.1282 1411.3286,-3791.5228 1476.0664,-3797.3776 1493.4552,-3802.1471 1557.583,-3791.5228 1724.8147,-3763.8169 1780.7419,-3767.1519 1918.6055,-3668.5228 1956.6595,-3641.2985 1986.5877,-3594.1657 2001.528,-3567.4701"/>
<polygon fill="#7100ff" stroke="#7100ff" points="2004.6311,-3569.0901 2006.3415,-3558.6343 1998.484,-3565.7414 2004.6311,-3569.0901"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#e200ff" stroke-dasharray="5,2" d="M224.0068,-1024.728C226.5951,-1196.9982 259.3344,-3299.394 317.2024,-3413.5228 359.0563,-3496.0683 877.3715,-3940.4239 969.4926,-3931.5228"/>
<path fill="none" stroke="#e200ff" stroke-dasharray="5,2" d="M969.4926,-3931.5228C1055.1796,-3935.4732 1152.7137,-3946.4818 1220.0298,-3955.1087"/>
<polygon fill="#e200ff" stroke="#e200ff" points="1219.7859,-3958.6062 1230.1521,-3956.4172 1220.6834,-3951.664 1219.7859,-3958.6062"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M969.4926,-2519.5228C1043.4084,-2528.9863 1063.7346,-2506.8064 1137.1608,-2519.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0071" stroke-dasharray="5,2" d="M585.7192,-2558.5228C635.685,-2572.845 641.525,-2593.036 690.4731,-2610.5228 763.8742,-2636.7454 852.0603,-2654.8587 909.3674,-2664.9569"/>
<polygon fill="#ff0071" stroke="#ff0071" points="908.8946,-2668.4271 919.3459,-2666.6892 910.0919,-2661.5303 908.8946,-2668.4271"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M399.0839,-2482.5228C680.2718,-2657.6796 305.9833,-2001.9307 516.9653,-1746.5228 519.9115,-1742.9563 523.411,-1739.8986 527.2468,-1737.2771"/>
<polygon fill="#ff0038" stroke="#ff0038" points="529.1599,-1740.2148 536.0969,-1732.2068 525.6801,-1734.141 529.1599,-1740.2148"/>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M224.1486,-1024.6606C227.8965,-1155.6881 266.9175,-2400.1941 399.0839,-2482.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2558.5228C642.7661,-2578.7304 636.3562,-2618.4295 690.4731,-2645.5228 774.0205,-2687.3502 802.1195,-2683.5581 894.9067,-2694.5228 960.7471,-2702.3031 977.7899,-2695.6789 1044.0784,-2694.5228 1324.4349,-2689.6332 1394.2627,-2666.3009 1674.5929,-2672.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1674.5929,-2672.5228C1709.7808,-2671.3621 1748.8475,-2671.0275 1781.6124,-2671.0175"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1782.0134,-2674.5177 1792.016,-2671.0251 1782.0185,-2667.5177 1782.0134,-2674.5177"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M585.7192,-3399.5228C635.2738,-3392.8912 641.3441,-3367.7947 690.4731,-3358.5228 764.0339,-3344.6399 784.0485,-3358.1185 858.9067,-3358.5228 941.2088,-3358.9672 962.0725,-3353.5316 1044.0784,-3360.5228 1208.7961,-3374.5653 1246.5374,-3406.37 1411.3286,-3419.5228 1476.1245,-3424.6945 1492.6017,-3421.1625 1557.583,-3419.5228 1645.6759,-3417.2999 1668.2144,-3420.8615 1755.6028,-3409.5228 1827.068,-3400.2501 1908.2701,-3381.7713 1959.7833,-3369.0334"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1960.8219,-3372.3817 1969.6784,-3366.5668 1959.1288,-3365.5895 1960.8219,-3372.3817"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M399.0839,-3399.5228C461.7258,-3453.8968 503.1374,-3407.3188 585.7192,-3399.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M969.4926,-2519.5228C1004.633,-2524.0218 1558.5296,-2393.6563 1593.583,-2388.5228 1656.8746,-2379.2539 1729.3986,-2373.5348 1781.9944,-2370.2596"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1782.4701,-2373.7373 1792.2392,-2369.6368 1782.0452,-2366.7502 1782.4701,-2373.7373"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M585.7192,-2558.5228C750.6175,-2605.4454 799.6702,-2495.9953 969.4926,-2519.5228"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M399.0839,-2482.5228C476.5038,-2527.552 501.2966,-2528.6178 585.7192,-2558.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M774.6899,-2789.5228C808.2432,-2807.2394 824.6699,-2787.1663 858.9067,-2803.5228 878.2228,-2812.751 876.1216,-2825.2568 894.9067,-2835.5228 993.0386,-2889.1514 1026.1879,-2917.3394 1137.1608,-2903.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M267.5647,-1016.6102C303.5573,-1017.8954 355.5534,-1016.8396 399.0839,-1004.5228"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M585.7192,-845.5228C614.8341,-831.3858 624.3219,-833.2884 654.4731,-821.5228 708.7043,-800.3606 722.9949,-796.2899 774.6899,-769.5228"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M399.0839,-1004.5228C435.0313,-994.3516 453.6035,-1010.959 480.9653,-985.5228 520.5017,-948.7689 479.4672,-908.354 516.9653,-869.5228 539.4481,-846.2408 556.6044,-859.6597 585.7192,-845.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M399.0839,-3399.5228C466.7204,-3458.2321 497.0907,-3462.6207 585.7192,-3475.5228"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1137.1608,-3741.5228C1175.3495,-3758.6053 1188.5885,-3731.4064 1230.2432,-3727.5228 1375.1966,-3714.0084 1412.4909,-3727.4574 1557.583,-3715.5228 1578.1803,-3713.8285 1600.7203,-3711.1393 1620.471,-3708.5027"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1621.0838,-3711.9517 1630.5201,-3707.1343 1620.1393,-3705.0157 1621.0838,-3711.9517"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M774.6899,-3437.5228C894.6601,-3441.1718 954.28,-3376.8836 1044.0784,-3456.5228 1107.4005,-3512.6811 1050.3572,-3564.2757 1080.0784,-3643.5228 1097.7788,-3690.7183 1093.0774,-3717.0814 1137.1608,-3741.5228"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M585.7192,-3475.5228C670.4939,-3487.8639 689.0572,-3435.0553 774.6899,-3437.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M244.424,-1002.4268C256.8148,-994.7409 271.9355,-983.4071 281.2024,-969.5228 315.6749,-917.8735 274.0847,-879.2091 317.2024,-834.5228 321.3677,-830.2059 326.2548,-826.6288 331.5326,-823.6656"/>
<polygon fill="#ff0000" stroke="#ff0000" points="333.2359,-826.73 340.7251,-819.2358 330.1971,-820.424 333.2359,-826.73"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M243.5003,-1002.5158C255.8416,-994.7211 271.2491,-983.235 281.2024,-969.5228 309.4425,-930.6177 281.371,-899.5731 317.2024,-867.5228 345.0472,-842.6162 366.8972,-867.4882 399.0839,-848.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M264.0449,-1002.5106C289.2235,-995.6141 321.8773,-986.6701 348.7674,-979.3047"/>
<polygon fill="#0066ff" stroke="#0066ff" points="350.0434,-982.5842 358.7635,-976.5667 348.1941,-975.8329 350.0434,-982.5842"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M238.9967,-1002.3896C257.4299,-988.8711 289.5159,-965.41 317.2024,-945.5228 336.542,-931.6312 358.5728,-916.039 374.9074,-904.5225"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="377.1831,-907.2007 383.3429,-898.5805 373.1519,-901.4779 377.1831,-907.2007"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1149.5228C779.0103,-1149.6933 1357.5835,-1175.0815 1583.1401,-1185.3173"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1583.1387,-1188.8207 1593.2873,-1185.7783 1583.4565,-1181.8279 1583.1387,-1188.8207"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1137.1608,-1149.5228C1207.8231,-1128.8967 1235.6157,-1179.6354 1302.7859,-1149.5228"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1302.7859,-1149.5228C1363.3071,-1122.391 1428.0149,-1078.4422 1461.4639,-1054.4599"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1463.6046,-1057.2312 1469.657,-1048.5352 1459.5027,-1051.5589 1463.6046,-1057.2312"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M774.6899,-1073.5228C938.551,-1057.931 979.1534,-1195.6445 1137.1608,-1149.5228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-2482.5228C423.3473,-2497.6369 499.8232,-2474.6052 547.0153,-2458.0195"/>
<polygon fill="#0000ff" stroke="#0000ff" points="548.3704,-2461.2522 556.6118,-2454.5942 546.0172,-2454.6596 548.3704,-2461.2522"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-1352.5282 334.8633,-1352.5282 334.8633,-1330.5174 463.3044,-1330.5174 463.3044,-1352.5282"/>
<text text-anchor="middle" x="399.0839" y="-1338.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.8728,-1024.8133C255.4666,-1072.7166 355.2743,-1259.5252 388.3612,-1321.4533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="385.2775,-1323.109 393.077,-1330.2798 391.4516,-1319.8103 385.2775,-1323.109"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-1467.5282 354.6193,-1467.5282 354.6193,-1445.5174 443.5485,-1445.5174 443.5485,-1467.5282"/>
<text text-anchor="middle" x="399.0839" y="-1453.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M224.8427,-1024.7993C230.419,-1085.1135 259.4749,-1369.196 317.2024,-1431.5228 324.6258,-1439.5377 334.5362,-1445.0111 344.8936,-1448.7417"/>
<polygon fill="#7fff00" stroke="#7fff00" points="343.8851,-1452.0932 354.4726,-1451.7006 345.9511,-1445.4051 343.8851,-1452.0932"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1137.1608,-768.5228C1165.4007,-756.385 1198.9351,-754.2094 1228.4184,-755.7927"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1228.4456,-759.3028 1238.6628,-756.4994 1228.9273,-752.3194 1228.4456,-759.3028"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M774.6899,-883.5228C809.6343,-866.3865 828.5104,-883.8296 858.9067,-859.5228 885.0024,-838.6551 867.0893,-812.0332 894.9067,-793.5228 985.0197,-733.5595 1037.7169,-811.2648 1137.1608,-768.5228"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-1004.5228C435.0313,-994.3516 445.4198,-997.0201 480.9653,-985.5228 577.0587,-954.4412 593.4447,-925.5491 690.4731,-897.5228 726.9263,-886.9934 739.8231,-898.4895 774.6899,-883.5228"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="839.5104,-1389.5282 709.8695,-1389.5282 709.8695,-1367.5174 839.5104,-1367.5174 839.5104,-1389.5282"/>
<text text-anchor="middle" x="774.6899" y="-1375.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.0839,-1149.5228C549.205,-1195.3208 700.3522,-1315.1614 754.1372,-1360.6551"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="752.0397,-1363.4663 761.9184,-1367.2954 756.5837,-1358.1416 752.0397,-1363.4663"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M245.4474,-1002.371C257.8998,-994.8001 272.7216,-983.6086 281.2024,-969.5228 330.7246,-887.2712 253.8269,-828.643 317.2024,-756.5228 324.117,-748.654 333.4303,-743.2231 343.2973,-739.484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="344.4268,-742.7973 352.867,-736.3932 342.2753,-736.1361 344.4268,-742.7973"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="859.1241,-3219.5282 690.2558,-3219.5282 690.2558,-3197.5174 859.1241,-3197.5174 859.1241,-3219.5282"/>
<text text-anchor="middle" x="774.6899" y="-3205.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3285.5228C635.2784,-3260.4959 694.9791,-3237.2539 733.8313,-3222.9908"/>
<polygon fill="#ff0000" stroke="#ff0000" points="735.0433,-3226.2743 743.2409,-3219.5624 732.6469,-3219.6973 735.0433,-3226.2743"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3285.5228C769.8191,-3197.6543 840.9835,-3290.3885 1044.0784,-3309.5228 1325.6548,-3336.0512 1398.7664,-3458.0433 1674.5929,-3395.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1674.5929,-3395.5228C1730.6754,-3379.0814 1736.9129,-3356.1283 1791.6028,-3335.5228 1793.2485,-3334.9027 1794.9272,-3334.2992 1796.6289,-3333.7124"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1798.098,-3336.9173 1806.5565,-3330.5373 1795.9655,-3330.25 1798.098,-3336.9173"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1696.9317,-2507.3663C1765.133,-2474.5971 1977.0135,-2382.3535 2157.7203,-2405.5228"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1693.7288,-2529.5446C1754.5363,-2564.1886 1943.3682,-2668.7576 2011.9673,-2671.5228"/>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M2011.9673,-2671.5228C2076.7318,-2672.8984 2093.666,-2661.8597 2157.7203,-2671.5228"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1687.8663,-2529.7732C1718.9012,-2556.0782 1796.4173,-2621.7803 1834.0054,-2653.6397"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1831.9197,-2656.46 1841.8112,-2660.2558 1836.4458,-2651.12 1831.9197,-2656.46"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1733.9647,-2507.4056C1741.9222,-2503.9553 1749.4469,-2499.4374 1755.6028,-2493.5228 1790.2686,-2460.2153 1758.2226,-2426.1187 1791.6028,-2391.5228 1794.9732,-2388.0296 1798.8912,-2385.0143 1803.0951,-2382.4132"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1804.8696,-2385.4335 1812.0422,-2377.6357 1801.5724,-2379.2586 1804.8696,-2385.4335"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1678.8459,-2530.0158C1691.887,-2565.603 1731.8649,-2677.3116 1755.6028,-2772.5228 1805.9164,-2974.3273 1842.024,-3223.936 1852.1954,-3297.9094"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1848.7849,-3298.8038 1853.6034,-3308.2395 1855.7208,-3297.8584 1848.7849,-3298.8038"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.7859,-2593.5228C1351.6817,-2581.6321 1705.305,-2587.0469 1755.6028,-2585.5228 1828.0819,-2583.3266 1846.6119,-2587.1814 1918.6055,-2578.5228 2052.3492,-2562.4374 2084.5412,-2544.2896 2210.1116,-2495.5228 2294.8273,-2462.6224 2346.5259,-2493.0466 2399.9436,-2419.5228 2489.2234,-2296.6386 2339.7872,-1040.9614 2490.9803,-1055.5228"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M1019.6479,-2674.9778C1173.3161,-2677.2516 1634.5111,-2690.8796 1755.6028,-2772.5228 1993.1108,-2932.6569 1989.1319,-3060.5294 2069.3291,-3335.5228 2107.2225,-3465.4578 2029.7621,-3831.2346 2105.3291,-3943.5228 2107.36,-3946.5406 2109.8597,-3949.2045 2112.6557,-3951.5541"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="2110.9452,-3954.6244 2121.1762,-3957.3771 2114.8949,-3948.8451 2110.9452,-3954.6244"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1019.6485,-2665.099C1085.5306,-2652.0957 1204.3952,-2626.4744 1302.7859,-2593.5228"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1302.7859,-2593.5228C1335.7841,-2585.4982 1343.8177,-2582.1851 1375.3286,-2569.5228 1425.1801,-2549.4905 1430.7475,-2518.8954 1484.4558,-2517.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-1721.5228C893.3577,-1703.5196 929.5373,-1738.3904 1044.0784,-1702.5228 1321.988,-1615.4977 1427.3722,-1556.0074 1557.583,-1295.5228 1591.5321,-1227.6082 1545.3374,-1187.1513 1593.583,-1128.5228 1672.2382,-1032.9402 1984.0863,-933.4797 2105.3291,-908.5228 2150.9428,-899.1336 2164.8884,-897.4038 2210.1116,-908.5228 2346.9308,-942.1623 2350.7624,-1041.7367 2490.9803,-1055.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M774.6899,-2177.5228C815.0346,-2222.7806 1800.1136,-1997.9885 1855.1041,-2023.5228"/>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M587.4781,-1732.5619C596.7313,-1787.4056 644.3884,-2033.6608 774.6899,-2177.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M774.6899,-1835.5228C1239.319,-1961.6116 1433.1392,-1525.7381 1855.1041,-1757.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#38ff00" stroke-dasharray="5,2" d="M587.0731,-1732.6475C595.0077,-1798.3 635.7679,-2141.8773 654.4731,-2423.5228 658.2601,-2480.5433 655.4984,-3406.3294 690.4731,-3451.5228 697.4761,-3460.5718 707.6074,-3466.4641 718.4319,-3470.2727"/>
<polygon fill="#38ff00" stroke="#38ff00" points="717.4802,-3473.641 728.0617,-3473.1103 719.4588,-3466.9264 717.4802,-3473.641"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M635.3388,-1725.4128C673.6183,-1727.477 727.7786,-1728.3581 774.6899,-1721.5228"/>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M1137.1608,-1415.5228C1170.2437,-1398.1952 1211.0431,-1388.4705 1243.8697,-1383.0653"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1244.4409,-1386.5186 1253.7839,-1381.5229 1243.3647,-1379.6019 1244.4409,-1386.5186"/>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M774.6899,-1721.5228C844.028,-1711.4197 832.6425,-1651.6632 894.9067,-1619.5228 955.7008,-1588.1412 996.111,-1630.3066 1044.0784,-1581.5228 1092.7528,-1532.0198 1031.1835,-1478.8082 1080.0784,-1429.5228 1098.4757,-1410.9785 1114.0208,-1427.6426 1137.1608,-1415.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0071ff" stroke-dasharray="5,2" d="M586.8242,-1732.6677C593.3417,-1798.4356 627.4055,-2142.5576 654.4731,-2423.5228 662.6071,-2507.9544 652.9521,-2727.4502 690.4731,-2803.5228 803.4039,-3032.4856 953.5856,-2994.3097 1194.2432,-3079.5228 1243.633,-3097.011 1250.4835,-3128.6296 1302.7859,-3125.5228"/>
<path fill="none" stroke="#0071ff" stroke-dasharray="5,2" d="M1302.7859,-3125.5228C1336.5712,-3122.0836 1344.8052,-3116.4088 1375.3286,-3101.5228 1392.6123,-3093.0936 1394.0869,-3086.0375 1411.3286,-3077.5228 1419.2826,-3073.5948 1428.0059,-3070.0282 1436.5705,-3066.8983"/>
<polygon fill="#0071ff" stroke="#0071ff" points="1437.8414,-3070.1617 1446.1234,-3063.5541 1435.5285,-3063.5548 1437.8414,-3070.1617"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M597.1613,-1710.4155C662.4022,-1646.8255 986.5113,-1327.3762 1044.0784,-1201.5228 1091.9896,-1096.7792 1007.1782,-1030.5174 1079.0473,-940.2123"/>
<polygon fill="#0038ff" stroke="#0038ff" points="1081.7401,-942.4482 1085.4865,-932.5379 1076.3776,-937.9489 1081.7401,-942.4482"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M592.6236,-1732.7295C607.828,-1756.6888 646.3777,-1813.6306 690.4731,-1849.5228 704.5643,-1860.9925 722.1192,-1870.7374 737.5491,-1878.1185"/>
<polygon fill="#0000ff" stroke="#0000ff" points="736.2855,-1881.3901 746.8318,-1882.4032 739.2191,-1875.0345 736.2855,-1881.3901"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M774.6899,-2177.5228C799.9385,-2205.8461 824.74,-2175.0204 858.9067,-2191.5228 918.5756,-2220.3426 905.2369,-2275.331 969.4926,-2291.5228"/>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M969.4926,-2291.5228C971.0121,-2291.9057 1409.7698,-2199.6834 1411.3286,-2199.5228 1475.9884,-2192.8624 1493.7922,-2187.0335 1557.583,-2199.5228 1727.6008,-2232.8097 1819.4233,-2204.4771 1918.6055,-2346.5228 1984.1007,-2440.323 1934.3,-3262.9359 1954.6055,-3375.5228 1964.745,-3431.7433 1989.3367,-3494.6942 2002.7938,-3526.5779"/>
<polygon fill="#7100ff" stroke="#7100ff" points="1999.7376,-3528.3321 2006.8936,-3536.1451 2006.1717,-3525.5749 1999.7376,-3528.3321"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M586.4262,-1732.675C590.1706,-1786.1503 610.6405,-2020.7444 690.4731,-2191.5228 722.0442,-2259.0598 832.6714,-2416.4771 894.9067,-2457.5228 941.2956,-2488.1173 1082.3894,-2510.1396 1137.1608,-2519.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0071" stroke-dasharray="5,2" d="M774.6899,-2596.5228C802.3839,-2623.8688 824.3468,-2602.624 858.9067,-2620.5228 877.1508,-2629.9715 876.8838,-2639.6588 894.9067,-2649.5228 902.1463,-2653.485 910.124,-2656.9696 918.088,-2659.9814"/>
<polygon fill="#ff0071" stroke="#ff0071" points="917.1503,-2663.3627 927.745,-2663.4209 919.499,-2656.7685 917.1503,-2663.3627"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-2177.5228C798.9464,-2206.7002 831.1825,-2165.6179 858.9067,-2191.5228 909.6335,-2238.9206 844.4998,-2295.785 894.9067,-2343.5228 1177.119,-2610.791 1437.8019,-2274.7402 1755.6028,-2498.5228 1809.4917,-2536.4692 1838.2336,-2613.5421 1849.4459,-2650.6435"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1846.1226,-2651.7508 1852.2612,-2660.3861 1852.8475,-2649.8075 1846.1226,-2651.7508"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M969.4926,-2291.5228C1186.8768,-2363.1297 1255.6771,-2282.9105 1484.4558,-2289.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1137.1608,-2903.5228C1156.0416,-2901.0576 1286.6296,-2869.5994 1302.7859,-2859.5228"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1302.7859,-2859.5228C1322.9079,-2846.9728 1380.0568,-2836.6116 1424.9397,-2830.0775"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1425.4842,-2833.5353 1434.8914,-2828.6613 1424.498,-2826.6051 1425.4842,-2833.5353"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M586.7498,-1732.5508C596.0738,-1831.9767 666.082,-2571.0748 690.4731,-2610.5228 721.6888,-2661.0082 1078.3038,-2911.2075 1137.1608,-2903.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M587.1892,-1710.318C593.8059,-1662.1793 623.4717,-1468.8673 690.4731,-1325.5228 745.3459,-1208.1267 808.2562,-1206.8014 858.9067,-1087.5228 892.4999,-1008.413 836.0517,-960.1562 894.9067,-897.5228 941.7568,-847.665 993.7852,-905.9051 1044.0784,-859.5228 1080.3438,-826.0774 1055.332,-797.2006 1080.0784,-754.5228 1090.0897,-737.2571 1105.0891,-720.4013 1117.2002,-708.1824"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1119.9724,-710.366 1124.6604,-700.8648 1115.0705,-705.3687 1119.9724,-710.366"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-1835.5228C808.2761,-1844.869 1046.0061,-1770.9026 1080.0784,-1763.5228 1178.6863,-1742.1651 1204.4403,-1742.0577 1302.7859,-1719.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M598.2742,-1732.6203C626.996,-1757.1623 700.7348,-1815.4532 774.6899,-1835.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1137.1608,-1415.5228C1202.594,-1381.802 1245.2784,-1461.4737 1302.7859,-1415.5228"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1302.7859,-1415.5228C1328.8234,-1394.7177 1351.3073,-1419.6265 1375.3286,-1396.5228 1400.7837,-1372.0401 1461.4251,-1131.4044 1479.3699,-1058.4081"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1482.8065,-1059.0891 1481.7854,-1048.5436 1476.0074,-1057.4242 1482.8065,-1059.0891"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M587.9277,-1710.2243C598.7624,-1655.585 647.5079,-1418.9189 690.4731,-1358.5228 743.6049,-1283.8356 789.6215,-1299.5287 858.9067,-1239.5228 876.4926,-1224.2922 877.6092,-1217.0801 894.9067,-1201.5228 956.9476,-1145.7237 1002.4604,-1159.8453 1044.0784,-1087.5228 1107.5372,-977.2458 1011.0531,-910.4039 1080.0784,-803.5228 1096.2231,-778.5237 1110.6611,-782.0645 1137.1608,-768.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M587.5685,-1710.282C594.6221,-1670.1663 622.9183,-1531.64 690.4731,-1441.5228 704.9291,-1422.2387 726.8662,-1406.0924 744.7271,-1394.9746"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="746.861,-1397.776 753.6344,-1389.6292 743.2589,-1391.7739 746.861,-1397.776"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-2596.5228C785.385,-2607.0834 1029.3267,-2618.6419 1044.0784,-2621.5228 1281.5787,-2667.9041 1369.533,-2650.2243 1557.583,-2802.5228 1733.2347,-2944.78 1825.6412,-3220.2814 1849.0663,-3298.4084"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1845.8442,-3299.8577 1852.0236,-3308.4638 1852.5598,-3297.8826 1845.8442,-3299.8577"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.5471,-1732.7863C593.5923,-1825.6104 646.3861,-2464.1377 774.6899,-2596.5228"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1918.0973,-2670.3656C1946.7498,-2670.1368 1981.0827,-2670.2779 2011.9673,-2671.5228"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M2037.3121,-3366.6005C2073.164,-3381.5449 2136.6706,-3405.1385 2157.7203,-3394.5228"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M2014.563,-3344.3409C2042.1283,-3225.594 2280.6986,-2197.8696 2318.1028,-2036.7382"/>
<polygon fill="#e2ff00" stroke="#e2ff00" points="2321.5906,-2037.1912 2320.4425,-2026.6587 2314.7719,-2035.6083 2321.5906,-2037.1912"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M2157.7203,-2671.5228C2229.9177,-2685.1379 2266.3829,-2718.3117 2323.0276,-2671.5228"/>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1860.2473,-2377.8304C1884.4972,-2429.3265 1993.1607,-2640.4898 2157.7203,-2671.5228"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1917.9449,-2367.1549C1989.1762,-2364.0707 2102.5381,-2346.8356 2157.7203,-2272.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M2157.7203,-2272.5228C2215.2826,-2184.3485 2282.9597,-2078.4072 2310.4626,-2035.2568"/>
<polygon fill="#e2ff00" stroke="#e2ff00" points="2313.57,-2036.8931 2315.9916,-2026.5787 2307.6664,-2033.1317 2313.57,-2036.8931"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1533.95,-2833.4478C1620.4432,-2854.6214 1801.0652,-2908.3162 1918.6055,-3009.5228 1956.7657,-3042.3802 2112.5333,-3416.7477 2157.7203,-3394.5228"/>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M2157.7203,-3394.5228C2421.4577,-3196.7969 2068.889,-2881.443 2323.0276,-2671.5228"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1485.8925,-2811.1837C1493.5042,-2751.0358 1529.8192,-2463.1859 1557.583,-2227.5228 1605.7418,-1818.7445 1660.4814,-1318.8893 1672.2777,-1210.7724"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1675.7618,-1211.1076 1673.3666,-1200.7871 1668.8031,-1210.3488 1675.7618,-1211.1076"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1674.5929,-3319.5228C1710.965,-3335.6566 1755.6608,-3335.7868 1791.477,-3331.8193"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1792.3151,-3335.2421 1801.8074,-3330.536 1791.4521,-3328.2955 1792.3151,-3335.2421"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1488.4865,-2833.705C1514.8765,-2906.8355 1662.2951,-3314.0678 1674.5929,-3319.5228"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1141.3106,-678.3774C1151.6568,-652.4141 1181.3389,-588.1669 1230.2432,-562.5228 1365.7168,-491.4839 1770.4258,-524.5434 1918.6055,-562.5228 1992.0703,-581.3523 2015.3981,-589.2023 2069.3291,-642.5228 2093.0899,-666.0146 2081.6188,-684.9799 2105.3291,-708.5228 2210.7635,-813.2126 2320.2453,-741.1252 2399.9436,-866.5228 2446.9829,-940.5346 2485.4275,-2345.8217 2490.4293,-2536.2348"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2486.9338,-2536.4565 2490.6937,-2546.3617 2493.9314,-2536.2737 2486.9338,-2536.4565"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1147.3617,-678.2582C1171.3629,-652.8298 1234.5503,-591.9895 1302.7859,-576.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1302.7859,-576.5228C1413.3941,-551.4516 1448.3764,-559.9181 1557.583,-590.5228 1851.0967,-672.7786 2012.234,-654.6608 2157.7203,-922.5228"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M1140.7692,-700.8918C1150.6596,-732.4302 1178.509,-823.8176 1194.2432,-901.5228 1217.5696,-1016.7234 1203.1722,-1049.1442 1230.2432,-1163.5228 1247.3493,-1235.7984 1279.059,-1318.2031 1294.2457,-1355.8268"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1291.0518,-1357.2642 1298.0651,-1365.2055 1297.5348,-1354.624 1291.0518,-1357.2642"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1302.7859,-576.5228C1351.014,-566.934 1494.6495,-606.2013 1557.583,-673.5228 1593.0002,-711.4095 1570.2932,-738.1831 1593.583,-784.5228 1649.4074,-895.5964 1716.2617,-894.5991 1755.6028,-1012.5228 1803.9335,-1157.3926 1772.9092,-2234.9521 1791.6028,-2386.5228 1803.9795,-2486.8751 1835.6198,-2603.8652 1848.9915,-2650.6447"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1845.6301,-2651.62 1851.766,-2660.2572 1852.3555,-2649.6788 1845.6301,-2651.62"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1193.1006,-684.2468C1294.5807,-675.9281 1503.5336,-664.949 1557.583,-709.5228 1576.005,-724.7151 1650.9316,-1076.7563 1670.1063,-1168.055"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1666.7294,-1169.0056 1672.2065,-1178.0748 1673.5805,-1167.5695 1666.7294,-1169.0056"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1302.7859,-883.5228C1365.5584,-928.1099 1433.1354,-989.317 1465.3119,-1019.3722"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1463.019,-1022.0203 1472.7052,-1026.3131 1467.8101,-1016.9168 1463.019,-1022.0203"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1143.9378,-700.8466C1164.0871,-733.6239 1226.9665,-829.6685 1302.7859,-883.5228"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1160.5395,-700.5328C1189.1883,-714.0248 1237.8945,-736.9626 1270.2046,-752.1789"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1268.7203,-755.3485 1279.2585,-756.4427 1271.7028,-749.0156 1268.7203,-755.3485"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M2344.4497,-3843.5155C2362.6736,-3832.8847 2387.7697,-3814.9589 2399.9436,-3791.5228 2458.1492,-3679.4703 2486.2296,-2732.3616 2490.4237,-2578.5821"/>
<polygon fill="#ff3800" stroke="#ff3800" points="2493.9232,-2578.6438 2490.6938,-2568.5531 2486.9258,-2578.4553 2493.9232,-2578.6438"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff3800" stroke-dasharray="5,2" d="M1718.7298,-3698.0274C1772.5992,-3692.6864 1863.3237,-3675.9442 1918.6055,-3623.5228 1951.671,-3592.1681 1926.1333,-3563.1006 1954.6055,-3527.5228 1971.4609,-3506.4608 2133.6339,-3406.6699 2157.7203,-3394.5228"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1715.4601,-3689.4003C1771.0903,-3671.9847 1869.351,-3632.6778 1918.6055,-3561.5228 1976.495,-3477.8933 1935.5606,-3435.4346 1954.6055,-3335.5228 2012.4061,-3032.293 2016.8239,-2953.2525 2105.3291,-2657.5228 2142.9485,-2531.8221 2167.4646,-2505.6079 2210.1116,-2381.5228 2254.7907,-2251.5249 2300.9402,-2092.8226 2317.0525,-2036.5382"/>
<polygon fill="#e2ff00" stroke="#e2ff00" points="2320.4855,-2037.2624 2319.8651,-2026.6857 2313.7544,-2035.3408 2320.4855,-2037.2624"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M585.7192,-201.5228C822.6404,-235.9479 812.7515,-398.556 969.4926,-579.5228"/>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M969.4926,-579.5228C1006.1624,-621.1101 1018.0556,-630.5636 1044.0784,-679.5228 1066.8383,-722.3433 1062.8614,-737.1887 1080.0784,-782.5228 1096.1864,-824.937 1116.753,-873.874 1128.2861,-900.8963"/>
<polygon fill="#0038ff" stroke="#0038ff" points="1125.2158,-902.6177 1132.3699,-910.4324 1131.6506,-899.862 1125.2158,-902.6177"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M402.301,-211.7224C414.8754,-256.0166 460.9889,-423.428 480.9653,-564.5228 518.3527,-828.5918 492.6459,-897.9313 516.9653,-1163.5228 536.1827,-1373.3952 571.8922,-1626.1848 582.6037,-1700.2021"/>
<polygon fill="#ff0038" stroke="#ff0038" points="579.1486,-1700.7648 584.0501,-1710.1577 586.0759,-1699.7584 579.1486,-1700.7648"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M969.4926,-199.5228C1037.8895,-215.6403 1024.1468,-269.9837 1080.0784,-312.5228 1126.2059,-347.6054 1161.3321,-327.8217 1194.2432,-375.5228 1258.7429,-469.0083 1174.5399,-529.5435 1230.2432,-628.5228 1271.1452,-701.2018 1338.9021,-672.5006 1375.3286,-747.5228 1418.6272,-836.6982 1398.1646,-2433.2694 1411.3286,-2531.5228 1425.1585,-2634.7455 1461.9877,-2754.224 1477.4581,-2801.612"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1474.2076,-2802.931 1480.6635,-2811.3318 1480.8554,-2800.7387 1474.2076,-2802.931"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-201.5228C668.6858,-214.6056 691.4857,-188.0488 774.6899,-199.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M969.4926,-199.5228C1069.8221,-222.5726 1114.2689,-190.7044 1194.2432,-255.5228 1222.6569,-278.5519 1209.3905,-299.4754 1230.2432,-329.5228 1350.5705,-502.9069 1457.9259,-487.4874 1557.583,-673.5228 1581.7856,-718.7031 1652.7263,-1077.3172 1670.5124,-1168.4954"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1667.107,-1169.3194 1672.4533,-1178.4664 1673.9781,-1167.9819 1667.107,-1169.3194"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M463.8203,-196.0995C499.9119,-194.8246 545.5505,-195.1887 585.7192,-201.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.6899,-199.5228C860.4572,-211.3502 885.6578,-177.8975 969.4926,-199.5228"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M969.4926,-199.5228C998.1357,-205.7114 1178.1657,-313.0229 1194.2432,-337.5228 1256.5564,-432.4797 1157.3952,-503.3854 1230.2432,-590.5228 1273.8067,-642.6315 1331.2612,-586.8396 1375.3286,-638.5228 1440.1814,-714.5835 1384.0633,-764.3578 1411.3286,-860.5228 1427.9415,-919.1164 1458.2203,-984.4801 1474.1027,-1016.9265"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1471.1461,-1018.8434 1478.7179,-1026.2541 1477.4201,-1015.7391 1471.1461,-1018.8434"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M774.6899,-199.5228C813.245,-204.8396 824.3917,-205.5375 858.9067,-223.5228 915.1039,-252.8063 912.1499,-286.5511 969.4926,-313.5228"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M969.4926,-313.5228C1001.0039,-328.3445 1013.2904,-321.2517 1044.0784,-337.5228 1061.9994,-346.9939 1062.5846,-355.2841 1080.0784,-365.5228 1103.8304,-379.4243 1121.7517,-366.7198 1137.1608,-389.5228"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-288.5282 166.6166,-288.5282 166.6166,-266.5174 281.0645,-266.5174 281.0645,-288.5282"/>
<text text-anchor="middle" x="223.8406" y="-274.3728" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M230.3673,-288.7277C253.4311,-328.3243 333.2487,-465.3672 399.0839,-578.5228"/>
<path fill="none" stroke="#0038ff" stroke-dasharray="5,2" d="M399.0839,-578.5228C430.9564,-633.3044 927.5757,-531.9849 969.4926,-579.5228"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-578.5228C417.2066,-610.6887 456.2839,-565.0655 480.9653,-592.5228 565.9608,-687.0773 459.2967,-1050.213 516.9653,-1163.5228 552.9732,-1234.2726 618.4691,-1206.771 654.4731,-1277.5228 712.2362,-1391.0334 621.0916,-1742.7172 690.4731,-1849.5228 699.9987,-1864.1865 716.0747,-1874.2505 731.6434,-1881.0099"/>
<polygon fill="#0000ff" stroke="#0000ff" points="730.6225,-1884.3701 741.2085,-1884.8031 733.203,-1877.8631 730.6225,-1884.3701"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M224.5861,-288.672C227.9591,-331.7889 244.9393,-490.2818 317.2024,-592.5228 369.1314,-665.9942 437.5977,-632.6943 480.9653,-711.5228 541.7154,-821.9469 503.3083,-1152.233 516.9653,-1277.5228 534.7865,-1441.0145 569.8893,-1636.3742 581.7193,-1700.2107"/>
<polygon fill="#ff0038" stroke="#ff0038" points="578.3175,-1701.0615 583.5897,-1710.2514 585.1991,-1699.7796 578.3175,-1701.0615"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M248.9487,-266.4906C279.2694,-253.168 330.4289,-230.689 364.4763,-215.729"/>
<polygon fill="#ff0000" stroke="#ff0000" points="366.2751,-218.7616 374.0223,-211.5345 363.4592,-212.353 366.2751,-218.7616"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M241.0706,-266.4782C253.1164,-258.2619 269.1409,-246.3007 281.2024,-233.5228 300.7488,-212.8153 292.5245,-194.7308 317.2024,-180.5228 420.8853,-120.8286 466.08,-161.5228 585.7192,-161.5228 585.7192,-161.5228 585.7192,-161.5228 774.6899,-161.5228 965.7808,-161.5228 1078.8969,-103.1713 1194.2432,-255.5228 1254.3135,-334.8648 1174.1668,-394.3094 1230.2432,-476.5228 1272.4818,-538.4487 1334.3763,-499.7388 1375.3286,-562.5228 1448.2126,-674.2611 1377.5474,-731.4633 1411.3286,-860.5228 1426.7504,-919.4411 1457.5426,-984.6648 1473.8135,-1017.0053"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1470.8906,-1018.9784 1478.5482,-1026.3004 1477.128,-1015.8012 1470.8906,-1018.9784"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M279.6624,-266.4401C408.53,-243.6869 733.7625,-202.6446 969.4926,-313.5228"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M449.2378,-798.4509C460.1309,-794.9051 471.2815,-790.3389 480.9653,-784.5228 500.363,-772.8725 499.4473,-762.8448 516.9653,-748.5228 661.4521,-630.396 710.6781,-595.3588 894.9067,-565.5228 960.3525,-554.9238 984.7729,-535.8858 1044.0784,-565.5228 1087.3726,-587.1584 1115.7684,-639.5707 1128.8369,-668.8552"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1125.6671,-670.3443 1132.8194,-678.1606 1132.1024,-667.5901 1125.6671,-670.3443"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M449.5901,-798.4276C474.1785,-793.026 503.8297,-786.5123 529.1734,-780.9448"/>
<polygon fill="#cbff00" stroke="#cbff00" points="530.0003,-784.3466 539.0164,-778.7825 528.4983,-777.5097 530.0003,-784.3466"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M588.516,-757.3923C598.2568,-719.9681 633.2494,-596.1171 690.4731,-508.5228 761.5384,-399.7409 775.1365,-349.9099 894.9067,-299.5228 956.0175,-273.8136 979.4444,-284.7599 1044.0784,-299.5228 1220.7197,-339.8691 1244.3198,-406.2517 1411.3286,-476.5228 1490.7354,-509.9342 1511.9643,-514.9519 1593.583,-542.5228 1737.021,-590.9763 1775.8012,-594.2324 1918.6055,-644.5228 1986.4586,-668.4181 2018.1949,-652.9231 2069.3291,-703.5228 2106.6333,-740.4371 2135.2524,-875.0943 2157.7203,-922.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M2157.7203,-922.5228C2186.4921,-981.4817 2194.5003,-996.8026 2210.1116,-1060.5228 2299.9078,-1427.043 2319.1616,-1890.8128 2322.4392,-1994.3871"/>
<polygon fill="#e2ff00" stroke="#e2ff00" points="2318.9441,-1994.6025 2322.7434,-2004.4927 2325.9409,-1994.3919 2318.9441,-1994.6025"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff71" stroke-dasharray="5,2" d="M632.3747,-777.2883C690.0928,-789.9257 789.246,-817.6595 858.9067,-869.5228 990.0615,-967.1691 971.4862,-1041.2767 1080.0784,-1163.5228 1149.0541,-1241.1712 1241.4832,-1323.5378 1282.1332,-1358.8171"/>
<polygon fill="#00ff71" stroke="#00ff71" points="1279.9188,-1361.5293 1289.7729,-1365.4213 1284.4966,-1356.2337 1279.9188,-1361.5293"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M604.4721,-779.5633C620.9746,-790.4474 643.9621,-808.7361 654.4731,-831.5228 701.8811,-934.2974 630.1278,-1753.7702 690.4731,-1849.5228 699.7962,-1864.3161 715.8374,-1874.4024 731.4348,-1881.1434"/>
<polygon fill="#0000ff" stroke="#0000ff" points="730.4381,-1884.5124 741.0251,-1884.9205 733.0033,-1877.9994 730.4381,-1884.5124"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#3800ff" stroke-dasharray="5,2" d="M603.6126,-779.6204C619.7542,-790.667 642.7125,-809.1721 654.4731,-831.5228 707.9757,-933.203 651.3015,-979.5091 690.4731,-1087.5228 738.8209,-1220.8393 817.8984,-1222.769 858.9067,-1358.5228 896.6776,-1483.5592 817.0073,-2428.678 894.9067,-2533.5228 897.2433,-2536.6676 899.9929,-2539.4215 903.0334,-2541.8327"/>
<polygon fill="#3800ff" stroke="#3800ff" points="901.3853,-2544.9357 911.6781,-2547.4477 905.1983,-2539.0653 901.3853,-2544.9357"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M969.4926,-617.5228C1025.1246,-616.1838 1083.354,-650.5823 1114.4228,-672.3046"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1112.6366,-675.3308 1122.8009,-678.3202 1116.7193,-669.6447 1112.6366,-675.3308"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M601.6601,-757.4838C652.5978,-723.2892 817.0305,-621.1925 969.4926,-617.5228"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M591.408,-757.2771C604.9833,-731.5498 641.8048,-667.9747 690.4731,-633.5228 859.2333,-514.0591 968.4822,-383.9439 1137.1608,-503.5228"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M399.0839,-770.5228C433.156,-755.2008 453.4089,-776.748 480.9653,-751.5228 518.9088,-716.7893 482.1122,-679.3564 516.9653,-641.5228 634.389,-514.0576 721.8705,-555.226 894.9067,-545.5228 961.1012,-541.8109 985.8476,-513.8263 1044.0784,-545.5228 1092.4431,-571.8489 1119.5134,-635.3151 1130.8109,-668.5026"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1127.5181,-669.6953 1133.9316,-678.1284 1134.1769,-667.5364 1127.5181,-669.6953"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M274.9553,-798.4337C324.5204,-787.6366 393.1101,-772.5602 399.0839,-770.5228"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M278.8078,-809.5228C295.1003,-809.5228 313.1505,-809.5228 330.2066,-809.5228"/>
<polygon fill="#ff0000" stroke="#ff0000" points="330.6733,-813.0229 340.6733,-809.5228 330.6733,-806.0229 330.6733,-813.0229"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M399.0839,-770.5228C439.7772,-752.2233 490.6897,-753.0308 529.0554,-757.6852"/>
<polygon fill="#cbff00" stroke="#cbff00" points="528.649,-761.1619 539.0238,-759.0142 529.5741,-754.2233 528.649,-761.1619"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M420.572,-954.4223C438.6022,-944.2277 464.0507,-927.6685 480.9653,-907.5228 504.9986,-878.8987 489.1672,-856.5069 516.9653,-831.5228 541.0372,-809.8878 555.699,-819.6188 585.7192,-807.5228"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M585.7192,-807.5228C665.1797,-775.5059 698.6149,-808.9136 774.6899,-769.5228"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M774.6899,-769.5228C821.9151,-745.0702 823.0913,-723.8343 858.9067,-684.5228 875.6927,-666.0982 874.2312,-655.4425 894.9067,-641.5228 923.7933,-622.075 934.6964,-618.8937 969.4926,-617.5228"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M447.207,-876.458C458.6494,-872.8545 470.551,-868.2612 480.9653,-862.5228 499.4584,-852.3329 498.6772,-842.0761 516.9653,-831.5228 544.9982,-815.3462 555.699,-819.6188 585.7192,-807.5228"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1676.0773,-1200.5667C1686.3172,-1274.7554 1749.2237,-1699.3628 1855.1041,-1757.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1855.1041,-1757.5228C1916.2093,-1791.0878 1947.7427,-1730.3998 2011.9673,-1757.5228"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M1538.3334,-1042.3292C1598.4677,-1050.4007 1695.234,-1071.8548 1755.6028,-1128.5228 1975.7064,-1335.1335 1733.8665,-1640.0768 2011.9673,-1757.5228"/>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M2011.9673,-1757.5228C2157.2587,-1781.4047 2273.3771,-1939.5106 2310.515,-1995.7278"/>
<polygon fill="#e2ff00" stroke="#e2ff00" points="2307.7756,-1997.9358 2316.1577,-2004.4158 2313.6461,-1994.123 2307.7756,-1997.9358"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1485.877,-1048.5922C1501.98,-1174.0206 1649.9199,-2326.342 1671.8746,-2497.3495"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1668.4156,-2497.8937 1673.1606,-2507.3666 1675.3586,-2497.0023 1668.4156,-2497.8937"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1498.437,-1048.6997C1531.1269,-1074.8327 1612.7766,-1140.1054 1652.3691,-1171.7565"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1650.5948,-1174.8191 1660.5912,-1178.3295 1654.9657,-1169.3514 1650.5948,-1174.8191"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#e2ff00" stroke-dasharray="5,2" d="M598.3759,-2432.4775C617.5173,-2416.0711 655.3328,-2384.8067 690.4731,-2362.5228 761.4566,-2317.5093 787.1502,-2320.2934 858.9067,-2276.5228 1032.4416,-2170.6687 1047.4799,-2098.5006 1230.2432,-2009.5228 1516.6901,-1870.0669 1624.6054,-1932.2572 1918.6055,-1809.5228 1962.4357,-1791.2253 1968.1801,-1739.1226 2011.9673,-1757.5228"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M636.4747,-2432.4097C643.3485,-2428.9612 649.6746,-2424.4429 654.4731,-2418.5228 690.5091,-2374.0647 677.9116,-2219.3557 690.4731,-2163.5228 711.826,-2068.615 750.5677,-1958.8979 766.9955,-1914.1347"/>
<polygon fill="#0000ff" stroke="#0000ff" points="770.3125,-1915.2556 770.4957,-1904.6624 763.7465,-1912.8293 770.3125,-1915.2556"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M595.7727,-2432.3349C614.0371,-2412.1776 654.1421,-2368.6813 690.4731,-2334.5228 762.0172,-2267.257 796.9217,-2267.6877 858.9067,-2191.5228 879.9976,-2165.6071 871.3021,-2149.1716 894.9067,-2125.5228 1002.0726,-2018.1567 1067.4481,-2044.7995 1194.2432,-1961.5228 1211.1855,-1950.3953 1212.6317,-1943.5577 1230.2432,-1933.5228 1335.7315,-1873.4164 1402.8848,-1923.449 1484.4558,-1833.5228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1484.4558,-1833.5228C1647.6357,-1633.7025 1670.7783,-1298.1055 1674.0541,-1210.7981"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1677.5529,-1210.8894 1674.3804,-1200.7807 1670.5566,-1210.6614 1677.5529,-1210.8894"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M412.2328,-1352.6195C430.6971,-1368.9829 463.95,-1401.4579 480.9653,-1436.5228 517.5342,-1511.8833 484.5579,-1544.2813 516.9653,-1621.5228 529.9591,-1652.4929 553.4299,-1683.6681 569.2914,-1702.7843"/>
<polygon fill="#ff0038" stroke="#ff0038" points="566.6406,-1705.0701 575.7745,-1710.4389 571.9822,-1700.546 566.6406,-1705.0701"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M455.4645,-1352.5377C464.0087,-1354.2075 472.7205,-1355.9105 480.9653,-1357.5228 646.7841,-1389.9487 694.8411,-1438.893 858.9067,-1398.5228 926.1096,-1381.9868 1300.3353,-1150.5272 1302.7859,-1149.5228"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0038" stroke-dasharray="5,2" d="M443.5006,-1461.528C457.1234,-1465.1169 471.1034,-1471.2105 480.9653,-1481.5228 525.3692,-1527.9545 490.3581,-1563.0449 516.9653,-1621.5228 530.8122,-1651.9556 553.9124,-1683.0857 569.4725,-1702.3538"/>
<polygon fill="#ff0038" stroke="#ff0038" points="566.9752,-1704.8273 576.0308,-1710.3269 572.3813,-1700.3804 566.9752,-1704.8273"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M443.3427,-1456.5805C525.9224,-1455.8926 708.7214,-1450.611 858.9067,-1419.5228 1109.7628,-1367.5958 1178.1304,-1327.0405 1375.3286,-1163.5228 1414.585,-1130.9712 1451.5058,-1083.5292 1470.7048,-1057.1217"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1473.7483,-1058.8834 1476.7314,-1048.7171 1468.0597,-1054.8042 1473.7483,-1058.8834"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#71ff00" stroke-dasharray="5,2" d="M1355.8207,-756.4295C1376.4348,-752.1176 1400.21,-747.1445 1421.6695,-742.6558"/>
<polygon fill="#71ff00" stroke="#71ff00" points="1422.5976,-746.0375 1431.6691,-740.5642 1421.1643,-739.1858 1422.5976,-746.0375"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1310.9938,-778.7341C1324.6054,-797.3991 1352.6024,-836.0991 1375.3286,-869.5228 1411.3054,-922.4342 1451.9305,-986.058 1471.9437,-1017.6728"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1469.1639,-1019.8259 1477.465,-1026.4094 1475.0813,-1016.0862 1469.1639,-1019.8259"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M820.0623,-1367.4281C832.8722,-1363.6631 846.6529,-1358.998 858.9067,-1353.5228 947.1436,-1314.0969 967.7421,-1298.7927 1044.0784,-1239.5228 1089.5316,-1204.2315 1082.82,-1168.4583 1137.1608,-1149.5228"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M406.675,-720.4078C422.1756,-697.3615 457.9417,-642.3564 480.9653,-592.5228 501.48,-548.1196 480.3158,-520.9158 516.9653,-488.5228 723.5584,-305.9235 919.5169,-334.2469 1137.1608,-503.5228"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1137.1608,-503.5228C1201.493,-556.6362 1185.1637,-596.3265 1230.2432,-666.5228 1249.0429,-695.7971 1272.9204,-728.2385 1288.0329,-748.2589"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1285.2875,-750.4311 1294.1213,-756.2804 1290.8633,-746.199 1285.2875,-750.4311"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#0071ff" stroke-dasharray="5,2" d="M846.9645,-3219.5598C901.3438,-3226.1664 977.6111,-3231.819 1044.0784,-3223.5228 1194.7911,-3204.7113 1239.2815,-3207.046 1375.3286,-3139.5228 1394.2272,-3130.143 1437.9154,-3093.2628 1463.9193,-3070.6391"/>
<polygon fill="#0071ff" stroke="#0071ff" points="1466.4625,-3073.0647 1471.687,-3063.8476 1461.8549,-3067.7949 1466.4625,-3073.0647"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#7100ff" stroke-dasharray="5,2" d="M1860.9138,-3330.8106C1875.2335,-3358.2284 1914.0184,-3430.0806 1954.6055,-3484.5228 1966.4995,-3500.477 1981.7338,-3517.0613 1993.513,-3529.2074"/>
<polygon fill="#7100ff" stroke="#7100ff" points="1991.1767,-3531.8232 2000.6849,-3536.497 1996.1666,-3526.9139 1991.1767,-3531.8232"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1487.2546,-3575.5079C1498.3798,-3531.2159 1539.731,-3361.6601 1557.583,-3219.5228 1566.9564,-3144.8916 1547.3273,-2602.8362 1593.583,-2543.5228 1597.0904,-2539.0252 1601.3921,-2535.3165 1606.1673,-2532.2607"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="1608.0312,-2535.2332 1615.2046,-2527.4363 1604.7347,-2529.058 1608.0312,-2535.2332"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1542.177,-3578.0648C1594.686,-3569.832 1665.376,-3557.184 1674.5929,-3547.5228"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacwatercoilcomponentf90EfferentGraph = svgPanZoom('#sourcefilehvacwatercoilcomponentf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilehvacwatercoilcomponentf90AfferentGraph" width="641pt" height="428pt"
 viewBox="0.00 0.00 641.00 428.16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph" class="graph" transform="scale(.2142 .2142) rotate(0) translate(4 1994.8832)">
<title>sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1994.8832 2988.5576,-1994.8832 2988.5576,4 -4,4"/>
<!-- sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~hvacwatercoilcomponent.f90</title>
<polygon fill="none" stroke="#000000" points="157.8543,-1206.6386 .0486,-1206.6386 .0486,-1184.6278 157.8543,-1184.6278 157.8543,-1206.6386"/>
<text text-anchor="middle" x="78.9514" y="-1192.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACWaterCoilComponent.f90</text>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~hvachxassistedcoolingcoil.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/hvachxassistedcoolingcoil.f90.html" xlink:title="HVACHXAssistedCoolingCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="359.7157,-1530.6386 193.9652,-1530.6386 193.9652,-1508.6278 359.7157,-1508.6278 359.7157,-1530.6386"/>
<text text-anchor="middle" x="276.8405" y="-1516.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHXAssistedCoolingCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge178" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M81.7096,-1206.874C91.5334,-1245.1792 127.8096,-1372.8686 193.9028,-1456.6332 208.7821,-1475.4907 230.5524,-1491.7416 248.0552,-1503.0133"/>
<polygon fill="#ff0000" stroke="#ff0000" points="246.4226,-1506.1199 256.76,-1508.4412 250.1264,-1500.1801 246.4226,-1506.1199"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~hvacvariablerefrigerantflow.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/hvacvariablerefrigerantflow.f90.html" xlink:title="HVACVariableRefrigerantFlow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1169.2108,-1069.6386 999.8156,-1069.6386 999.8156,-1047.6278 1169.2108,-1047.6278 1169.2108,-1069.6386"/>
<text text-anchor="middle" x="1084.5132" y="-1055.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACVariableRefrigerantFlow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge179" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-890.6332C484.0589,-890.3496 891.7541,-1004.5943 1035.2572,-1044.823"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1034.5501,-1048.2596 1045.1237,-1047.589 1036.4397,-1041.5195 1034.5501,-1048.2596"/>
</g>
<!-- sourcefile~hvacsingleductsystem.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~hvacsingleductsystem.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/hvacsingleductsystem.f90.html" xlink:title="HVACSingleDuctSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="348.5368,-1276.6386 205.1441,-1276.6386 205.1441,-1254.6278 348.5368,-1254.6278 348.5368,-1276.6386"/>
<text text-anchor="middle" x="276.8405" y="-1262.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSingleDuctSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacsingleductsystem.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge180" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacsingleductsystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M110.3075,-1206.7249C144.3222,-1218.757 198.7503,-1238.0101 236.0644,-1251.2093"/>
<polygon fill="#ff0000" stroke="#ff0000" points="235.0363,-1254.5581 245.631,-1254.5934 237.3707,-1247.9588 235.0363,-1254.5581"/>
</g>
<!-- sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~fancoilunits.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/fancoilunits.f90.html" xlink:title="FanCoilUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1129.1309,-1331.6386 1039.8954,-1331.6386 1039.8954,-1309.6278 1129.1309,-1309.6278 1129.1309,-1331.6386"/>
<text text-anchor="middle" x="1084.5132" y="-1317.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FanCoilUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge181" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M157.9116,-1187.3011C283.7163,-1176.0149 536.845,-1161.4593 746.4507,-1200.6332 863.0125,-1222.4178 993.193,-1278.1777 1052.2563,-1305.324"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1050.8998,-1308.5529 1061.4447,-1309.5809 1053.8425,-1302.2014 1050.8998,-1308.5529"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1138.6926,-1951.6386 1030.3338,-1951.6386 1030.3338,-1929.6278 1138.6926,-1929.6278 1138.6926,-1951.6386"/>
<text text-anchor="middle" x="1084.5132" y="-1937.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge182" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M869.5847,-1940.6332C919.8975,-1936.2769 977.084,-1936.5267 1019.814,-1937.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1019.974,-1941.2364 1030.0768,-1938.045 1020.1889,-1934.2397 1019.974,-1941.2364"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1338.1423,-1876.6386 1241.2791,-1876.6386 1241.2791,-1854.6278 1338.1423,-1854.6278 1338.1423,-1876.6386"/>
<text text-anchor="middle" x="1289.7107" y="-1862.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge183" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.5132,-1865.6332C1132.22,-1850.5822 1189.3295,-1852.0429 1231.1727,-1856.4296"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1230.8669,-1859.9173 1241.1977,-1857.5668 1231.6559,-1852.9619 1230.8669,-1859.9173"/>
</g>
<!-- sourcefile~hvaccooledbeam.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~hvaccooledbeam.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/hvaccooledbeam.f90.html" xlink:title="HVACCooledBeam.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="335.9561,-1226.6386 217.7248,-1226.6386 217.7248,-1204.6278 335.9561,-1204.6278 335.9561,-1226.6386"/>
<text text-anchor="middle" x="276.8405" y="-1212.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACCooledBeam.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvaccooledbeam.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge184" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvaccooledbeam.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M158.0155,-1203.6239C174.3532,-1205.2751 191.445,-1207.0026 207.4087,-1208.616"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.4157,-1212.1344 217.717,-1209.6578 208.1196,-1205.1699 207.4157,-1212.1344"/>
</g>
<!-- sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~generalroutines.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/generalroutines.f90.html" xlink:title="GeneralRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1344.021,-922.6386 1235.4004,-922.6386 1235.4004,-900.6278 1344.021,-900.6278 1344.021,-922.6386"/>
<text text-anchor="middle" x="1289.7107" y="-908.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GeneralRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge185" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.8405,-1080.6332C390.7069,-1029.8593 367.245,-936.4066 483.212,-890.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M93.6564,-1184.4067C115.0109,-1168.3981 156.1821,-1138.6288 193.9028,-1117.6332 229.1706,-1098.0029 239.9764,-1097.0712 276.8405,-1080.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-890.6332C520.1158,-876.0669 533.593,-886.8155 570.646,-872.6332 587.9453,-866.0117 589.5615,-858.7907 606.646,-851.6332 636.3402,-839.1928 644.4847,-835.5375 676.5483,-832.6332"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~packagedterminalheatpump.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/packagedterminalheatpump.f90.html" xlink:title="PackagedTerminalHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1167.0149,-1488.6386 1002.0115,-1488.6386 1002.0115,-1466.6278 1167.0149,-1466.6278 1167.0149,-1488.6386"/>
<text text-anchor="middle" x="1084.5132" y="-1474.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedTerminalHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge186" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.8405,-1442.6332C324.2205,-1466.885 342.6433,-1431.7496 395.7781,-1428.6332 473.3638,-1424.0826 493.2149,-1421.9489 570.646,-1428.6332 705.003,-1440.2317 734.8623,-1474.6151 869.5847,-1480.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M83.9098,-1206.8362C102.4232,-1247.1574 171.8678,-1385.5076 276.8405,-1442.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M869.5847,-1480.6332C909.6623,-1480.1978 953.942,-1479.5997 991.8437,-1479.052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="991.8962,-1482.5517 1001.8443,-1478.9066 991.7944,-1475.5525 991.8962,-1482.5517"/>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1353.2134,-154.6386 1226.208,-154.6386 1226.208,-132.6278 1353.2134,-132.6278 1353.2134,-154.6386"/>
<text text-anchor="middle" x="1289.7107" y="-140.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge187" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M80.7068,-1184.2862C98.4831,-1071.3625 250.1212,-153.6332 483.212,-153.6332 483.212,-153.6332 483.212,-153.6332 869.5847,-153.6332 990.9255,-153.6332 1131.9237,-149.4126 1215.8249,-146.4553"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1216.1506,-149.946 1226.0197,-146.0923 1215.9015,-142.9505 1216.1506,-149.946"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~hvacunitarybypassvav.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/hvacunitarybypassvav.f90.html" xlink:title="HVACUnitaryBypassVAV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1156.6143,-1799.6386 1012.4121,-1799.6386 1012.4121,-1777.6278 1156.6143,-1777.6278 1156.6143,-1799.6386"/>
<text text-anchor="middle" x="1084.5132" y="-1785.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitaryBypassVAV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge188" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.8405,-1826.6332C415.6039,-1948.5783 492.6881,-1958.558 676.5483,-1940.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-1940.6332C768.5342,-1934.2976 779.7133,-1885.2406 869.5847,-1864.6332"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="904.3658,-1663.6386 834.8036,-1663.6386 834.8036,-1641.6278 904.3658,-1641.6278 904.3658,-1663.6386"/>
<text text-anchor="middle" x="869.5847" y="-1649.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge189" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1826.6332C602.3407,-1814.8872 640.6362,-1825.6054 746.4507,-1769.6332 747.2312,-1769.2203 815.8442,-1703.8619 850.2961,-1671.0233"/>
<polygon fill="#ff0000" stroke="#ff0000" points="853.0475,-1673.2359 857.8708,-1663.8026 848.2176,-1668.1692 853.0475,-1673.2359"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/hvacunitarysystem.f90.html" xlink:title="HVACUnitarySystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="739.7257,-1760.6386 613.371,-1760.6386 613.371,-1738.6278 739.7257,-1738.6278 739.7257,-1760.6386"/>
<text text-anchor="middle" x="676.5483" y="-1746.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitarySystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge190" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.8405,-1826.6332C345.7375,-1887.1798 391.934,-1835.6332 483.212,-1826.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1826.6332C523.3145,-1822.6791 534.6182,-1820.6841 570.646,-1802.6332 588.7684,-1793.5534 588.8795,-1784.3911 606.646,-1774.6332 613.6359,-1770.7941 621.3305,-1767.3503 628.9808,-1764.3351"/>
<polygon fill="#ff0000" stroke="#ff0000" points="630.4467,-1767.5239 638.5911,-1760.7475 627.9985,-1760.9659 630.4467,-1767.5239"/>
</g>
<!-- sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~hvacmultispeedheatpump.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/hvacmultispeedheatpump.f90.html" xlink:title="HVACMultiSpeedHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="563.2631,-1990.6386 403.161,-1990.6386 403.161,-1968.6278 563.2631,-1968.6278 563.2631,-1990.6386"/>
<text text-anchor="middle" x="483.212" y="-1976.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACMultiSpeedHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge191" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacmultispeedheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.8405,-1826.6332C335.0229,-1878.0671 329.5851,-1914.0235 395.7781,-1954.6332 402.4961,-1958.7547 409.919,-1962.2195 417.5162,-1965.1269"/>
<polygon fill="#ff0000" stroke="#ff0000" points="416.598,-1968.5138 427.1928,-1968.5191 418.9137,-1961.9079 416.598,-1968.5138"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~desiccantdehumidifiers.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/desiccantdehumidifiers.f90.html" xlink:title="DesiccantDehumidifiers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="746.3532,-1682.6386 606.7435,-1682.6386 606.7435,-1660.6278 746.3532,-1660.6278 746.3532,-1682.6386"/>
<text text-anchor="middle" x="676.5483" y="-1668.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DesiccantDehumidifiers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge192" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M80.8548,-1206.8414C94.2045,-1284.1349 176.1997,-1737.6657 276.8405,-1826.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.8405,-1826.6332C327.9463,-1871.8113 334.1779,-1758.9297 395.7781,-1729.6332 459.3833,-1699.3831 538.4573,-1684.8536 596.466,-1677.9079"/>
<polygon fill="#ff0000" stroke="#ff0000" points="597.1427,-1681.3534 606.679,-1676.7371 596.3454,-1674.3989 597.1427,-1681.3534"/>
</g>
<!-- sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~outdoorairunit.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/outdoorairunit.f90.html" xlink:title="OutdoorAirUnit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="919.043,-1530.6386 820.1265,-1530.6386 820.1265,-1508.6278 919.043,-1508.6278 919.043,-1530.6386"/>
<text text-anchor="middle" x="869.5847" y="-1516.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutdoorAirUnit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge193" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.8405,-1442.6332C456.0002,-1528.6632 698.8479,-1529.0668 809.8148,-1523.8124"/>
<polygon fill="#ff0000" stroke="#ff0000" points="810.0056,-1527.3074 819.8159,-1523.3062 809.6517,-1520.3163 810.0056,-1527.3074"/>
</g>
<!-- sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~poweredinductionunits.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/poweredinductionunits.f90.html" xlink:title="PoweredInductionUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="345.8338,-947.6386 207.8471,-947.6386 207.8471,-925.6278 345.8338,-925.6278 345.8338,-947.6386"/>
<text text-anchor="middle" x="276.8405" y="-933.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PoweredInductionUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge194" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M87.4545,-1184.5043C118.0917,-1144.4058 223.0724,-1007.0056 262.0857,-955.9445"/>
<polygon fill="#ff0000" stroke="#ff0000" points="265.079,-957.7917 268.3691,-947.7206 259.5167,-953.5418 265.079,-957.7917"/>
</g>
<!-- sourcefile~unitventilator.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~unitventilator.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/unitventilator.f90.html" xlink:title="UnitVentilator.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1130.41,-1110.6386 1038.6163,-1110.6386 1038.6163,-1088.6278 1130.41,-1088.6278 1130.41,-1110.6386"/>
<text text-anchor="middle" x="1084.5132" y="-1096.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UnitVentilator.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~unitventilator.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge195" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~unitventilator.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-1100.6332C801.162,-1082.6196 949.432,-1089.1414 1028.4149,-1094.8096"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1028.3949,-1098.3176 1038.626,-1095.5656 1028.9118,-1091.3367 1028.3949,-1098.3176"/>
</g>
<!-- sourcefile~unitheater.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~unitheater.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/unitheater.f90.html" xlink:title="UnitHeater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1124.1405,-922.6386 1044.8859,-922.6386 1044.8859,-900.6278 1124.1405,-900.6278 1124.1405,-922.6386"/>
<text text-anchor="middle" x="1084.5132" y="-908.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UnitHeater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~unitheater.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge196" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~unitheater.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.8405,-1080.6332C297.2194,-1071.7429 654.5824,-1104.0742 676.5483,-1100.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-1100.6332C779.0993,-1087.5418 929.0416,-962.9131 992.7188,-936.6332 1006.1103,-931.1064 1021.1011,-926.4321 1035.0232,-922.6749"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1036.134,-926.0026 1044.9336,-920.102 1034.375,-919.2272 1036.134,-926.0026"/>
</g>
<!-- sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~ventilatedslab.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/ventilatedslab.f90.html" xlink:title="VentilatedSlab.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="531.3689,-1072.6386 435.0552,-1072.6386 435.0552,-1050.6278 531.3689,-1050.6278 531.3689,-1072.6386"/>
<text text-anchor="middle" x="483.212" y="-1058.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VentilatedSlab.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge197" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.8405,-1080.6332C323.6063,-1060.2316 381.8857,-1056.6023 424.5732,-1057.4239"/>
<polygon fill="#ff0000" stroke="#ff0000" points="424.7048,-1060.9289 434.7991,-1057.711 424.9013,-1053.9316 424.7048,-1060.9289"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1547.9882,-1818.6386 1422.5611,-1818.6386 1422.5611,-1796.6278 1547.9882,-1796.6278 1547.9882,-1818.6386"/>
<text text-anchor="middle" x="1485.2747" y="-1804.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge198" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.5132,-1865.6332C1109.4903,-1857.7532 1263.872,-1745.3539 1289.7107,-1749.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M869.5847,-1940.6332C970.3802,-1931.9059 988.0284,-1896.073 1084.5132,-1865.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-1940.6332C762.1395,-1934.738 784.1106,-1948.0339 869.5847,-1940.6332"/>
</g>
<!-- sourcefile~hvacsingleductinduc.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~hvacsingleductinduc.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/hvacsingleductinduc.f90.html" xlink:title="HVACSingleDuctInduc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="344.2162,-1148.6386 209.4647,-1148.6386 209.4647,-1126.6278 344.2162,-1126.6278 344.2162,-1148.6386"/>
<text text-anchor="middle" x="276.8405" y="-1134.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSingleDuctInduc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacsingleductinduc.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge199" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacsingleductinduc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M116.6386,-1184.5873C148.585,-1175.2241 194.5773,-1161.744 229.095,-1151.6271"/>
<polygon fill="#ff0000" stroke="#ff0000" points="230.3452,-1154.908 238.9571,-1148.7366 228.3763,-1148.1905 230.3452,-1154.908"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M291.5611,-1508.5311C308.1722,-1495.9848 335.98,-1474.9256 359.7781,-1456.6332 375.8489,-1444.2803 379.1222,-1440.1851 395.7781,-1428.6332 648.3078,-1253.4876 704.5917,-1186.5446 992.7188,-1079.6332 1000.047,-1076.914 1007.8399,-1074.478 1015.6683,-1072.3142"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1016.7852,-1075.6398 1025.5708,-1069.7183 1015.0101,-1068.8686 1016.7852,-1075.6398"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-1328.6332C693.0013,-1323.264 922.1218,-1321.4302 1029.5944,-1320.863"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1029.622,-1324.363 1039.604,-1320.812 1029.5862,-1317.3631 1029.622,-1324.363"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M279.3212,-1530.8181C291.0793,-1582.7792 342.8343,-1799.8007 395.7781,-1840.6332 494.7116,-1916.935 838.191,-1918.1424 956.7188,-1878.6332 975.6924,-1872.3086 973.7451,-1857.9577 992.7188,-1851.6332 1075.349,-1824.0898 1178.0808,-1838.9384 1238.5156,-1852.2614"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1238.0401,-1855.7426 1248.5676,-1854.5498 1239.594,-1848.9173 1238.0401,-1855.7426"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1556.6332C570.5849,-1561.4551 782.4346,-1472.7504 869.5847,-1480.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M324.4646,-1530.7247C366.0815,-1539.8027 428.2709,-1551.8902 483.212,-1556.6332"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M869.5847,-1864.6332C926.7185,-1848.9976 936.6666,-1832.7877 992.7188,-1813.6332 1004.5582,-1809.5873 1017.4282,-1805.7469 1029.6823,-1802.3446"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1030.6165,-1805.7177 1039.3464,-1799.7143 1028.7782,-1798.9634 1030.6165,-1805.7177"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1788.6332C502.5139,-1798.9297 848.4841,-1870.4077 869.5847,-1864.6332"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1556.6332C612.4819,-1568.1298 759.9775,-1614.4063 829.4207,-1638.2586"/>
<polygon fill="#ff0000" stroke="#ff0000" points="828.4939,-1641.6415 839.0887,-1641.6083 830.7856,-1635.0273 828.4939,-1641.6415"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M278.5901,-1530.7602C285.4171,-1570.2598 314.049,-1704.8354 395.7781,-1769.6332 426.9391,-1794.3388 448.1257,-1769.9164 483.212,-1788.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1788.6332C509.2152,-1802.5046 587.6659,-1780.087 636.2727,-1763.9117"/>
<polygon fill="#ff0000" stroke="#ff0000" points="637.5127,-1767.1872 645.867,-1760.6713 635.2728,-1760.5552 637.5127,-1767.1872"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-1556.6332C725.9899,-1554.3967 781.3709,-1542.8178 820.0911,-1533.2005"/>
<polygon fill="#ff0000" stroke="#ff0000" points="821.2212,-1536.5249 830.0561,-1530.6773 819.5029,-1529.739 821.2212,-1536.5249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1556.6332C568.8015,-1564.2451 590.7089,-1560.5162 676.5483,-1556.6332"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~unitventilator.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~unitventilator.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M306.1743,-1508.5135C346.1372,-1493.4048 419.9608,-1465.6364 483.212,-1442.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-1328.6332C803.3896,-1272.2564 856.5447,-1286.7176 956.7188,-1190.6332 980.8326,-1167.5038 966.5012,-1145.3476 992.7188,-1124.6332 1003.1495,-1116.3919 1016.0947,-1110.8615 1028.9424,-1107.1521"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1029.8837,-1110.5241 1038.7048,-1104.6557 1028.1494,-1103.7423 1029.8837,-1110.5241"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1442.6332C576.9576,-1408.5397 584.2197,-1366.3959 676.5483,-1328.6332"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M300.2967,-1508.4275C319.617,-1497.8866 345.9958,-1480.2032 359.7781,-1456.6332 418.8863,-1355.548 354.791,-1305.3239 395.7781,-1195.6332 412.5643,-1150.7095 446.475,-1105.4343 466.7784,-1080.7132"/>
<polygon fill="#ff0000" stroke="#ff0000" points="469.6143,-1082.7779 473.3421,-1072.8605 464.2434,-1078.2886 469.6143,-1082.7779"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1788.6332C560.1446,-1826.9069 590.726,-1792.8776 676.5483,-1788.6332"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1173.8524,-1447.6386 995.174,-1447.6386 995.174,-1425.6278 1173.8524,-1425.6278 1173.8524,-1447.6386"/>
<text text-anchor="middle" x="1084.5132" y="-1433.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.212,-1442.6332C646.1125,-1388.3045 698.458,-1428.3573 869.5847,-1442.6332"/>
</g>
<!-- sourcefile~windowac.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~windowac.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/windowac.f90.html" xlink:title="WindowAC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1125.459,-1566.6386 1043.5674,-1566.6386 1043.5674,-1544.6278 1125.459,-1544.6278 1125.459,-1566.6386"/>
<text text-anchor="middle" x="1084.5132" y="-1552.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowAC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-1556.6332C804.775,-1550.8328 955.9033,-1552.7436 1033.2486,-1554.3547"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1033.5894,-1557.8628 1043.6626,-1554.5792 1033.7404,-1550.8644 1033.5894,-1557.8628"/>
</g>
<!-- sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~hvacdxsystem.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/hvacdxsystem.f90.html" xlink:title="HVACDXSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="536.7181,-1760.6386 429.706,-1760.6386 429.706,-1738.6278 536.7181,-1738.6278 536.7181,-1760.6386"/>
<text text-anchor="middle" x="483.212" y="-1746.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACDXSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286.7942,-1530.7266C319.6824,-1567.3803 425.1116,-1684.8806 466.4022,-1730.8987"/>
<polygon fill="#ff0000" stroke="#ff0000" points="463.8329,-1733.2761 473.1164,-1738.3817 469.0431,-1728.6012 463.8329,-1733.2761"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#ff4500" stroke-dasharray="5,2" d="M1096.1513,-1047.3491C1116.6415,-1026.6403 1158.6556,-980.2153 1176.3076,-931.6332 1253.15,-720.1466 1174.4448,-648.4388 1212.3076,-426.6332 1229.4036,-326.4824 1266.8485,-210.594 1282.554,-164.2913"/>
<polygon fill="#ff4500" stroke="#ff4500" points="1285.8831,-165.3726 1285.8085,-154.778 1279.26,-163.1067 1285.8831,-165.3726"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1774.3735,-1450.6386 1630.6778,-1450.6386 1630.6778,-1428.6278 1774.3735,-1428.6278 1774.3735,-1450.6386"/>
<text text-anchor="middle" x="1702.5256" y="-1436.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff4500" stroke-dasharray="5,2" d="M1135.68,-1069.6737C1191.3596,-1081.5575 1274.5169,-1098.8761 1289.7107,-1099.6332"/>
<path fill="none" stroke="#ff4500" stroke-dasharray="5,2" d="M1289.7107,-1099.6332C1491.2012,-1109.673 1648.0441,-1347.5989 1690.8794,-1419.3413"/>
<polygon fill="#ff4500" stroke="#ff4500" points="1688.0736,-1421.4747 1696.1598,-1428.3205 1694.1076,-1417.9263 1688.0736,-1421.4747"/>
</g>
<!-- sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M348.8711,-1270.5383C508.0471,-1281.3776 886.8821,-1307.1751 1029.2036,-1316.8668"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1029.2222,-1320.3761 1039.4369,-1317.5636 1029.6978,-1313.3922 1029.2222,-1320.3761"/>
</g>
<!-- sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M321.4469,-1276.66C422.4809,-1301.7731 666.2319,-1363.1683 746.4507,-1390.6332 802.654,-1409.8758 810.5479,-1436.0199 869.5847,-1442.6332"/>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M869.5847,-1442.6332C907.1535,-1446.7028 948.6188,-1446.6156 985.0242,-1445.0228"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="985.3304,-1448.5122 995.1507,-1444.5358 984.9941,-1441.5202 985.3304,-1448.5122"/>
</g>
<!-- sourcefile~zoneairloopequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node39" class="node">
<title>sourcefile~zoneairloopequipmentmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node39"><a xlink:href="../sourcefile/zoneairloopequipmentmanager.f90.html" xlink:title="Zoneairloopequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="570.58,-1226.6386 395.8441,-1226.6386 395.8441,-1204.6278 570.58,-1204.6278 570.58,-1226.6386"/>
<text text-anchor="middle" x="483.212" y="-1212.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneairloopequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~hvacsingleductsystem.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90</title>
<path fill="none" stroke="#ff8b00" stroke-dasharray="5,2" d="M322.3851,-1254.5986C353.4732,-1247.0665 394.8394,-1237.0442 427.8336,-1229.0504"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="428.8891,-1232.396 437.7838,-1226.6396 427.2408,-1225.5928 428.8891,-1232.396"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#ffd000" stroke-dasharray="5,2" d="M1090.8801,-1309.2349C1107.4127,-1279.1711 1152.1003,-1194.8614 1176.3076,-1119.6332 1201.6989,-1040.7257 1157.2574,-998.6056 1212.3076,-936.6332 1216.2729,-932.1693 1221.0398,-928.4979 1226.2353,-925.4791"/>
<polygon fill="#ffd000" stroke="#ffd000" points="1227.9039,-928.5587 1235.3179,-920.99 1224.8023,-922.2833 1227.9039,-928.5587"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ffd000" stroke-dasharray="5,2" d="M1129.2256,-1328.1186C1185.0765,-1337.6258 1275.1164,-1353.5289 1289.7107,-1359.6332"/>
</g>
<!-- sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node38" class="node">
<title>sourcefile~systemreports.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node38"><a xlink:href="../sourcefile/systemreports.f90.html" xlink:title="SystemReports.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1340.497,-1331.6386 1238.9244,-1331.6386 1238.9244,-1309.6278 1340.497,-1309.6278 1340.497,-1331.6386"/>
<text text-anchor="middle" x="1289.7107" y="-1317.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemReports.f90</text>
</a>
</g>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ffd000" stroke-dasharray="5,2" d="M1129.2911,-1320.6332C1158.4469,-1320.6332 1196.8522,-1320.6332 1228.7751,-1320.6332"/>
<polygon fill="#ffd000" stroke="#ffd000" points="1228.892,-1324.1333 1238.892,-1320.6332 1228.8919,-1317.1333 1228.892,-1324.1333"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1111.2611,-1929.6226C1136.9947,-1919.1595 1177.0783,-1903.2013 1212.3076,-1890.6332 1222.4877,-1887.0014 1233.4995,-1883.3066 1243.9357,-1879.911"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1245.2744,-1883.157 1253.7193,-1876.759 1243.1277,-1876.4942 1245.2744,-1883.157"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1289.7107,-1904.6332C1324.367,-1897.305 1334.6564,-1899.8206 1367.1138,-1885.6332 1403.6615,-1869.6579 1441.3519,-1842.5957 1464.052,-1824.9205"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1466.3109,-1827.5963 1471.9844,-1818.6486 1461.9693,-1822.1053 1466.3109,-1827.5963"/>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1138.7149,-1932.1778C1180.1983,-1925.4518 1238.7546,-1915.4081 1289.7107,-1904.6332"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node33" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node33"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2852.1402,-357.6386 2732.3298,-357.6386 2732.3298,-335.6278 2852.1402,-335.6278 2852.1402,-357.6386"/>
<text text-anchor="middle" x="2792.235" y="-343.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#e7ff00" stroke-dasharray="5,2" d="M1289.7107,-1904.6332C1649.6776,-1828.5166 1743.1518,-1823.7503 2098.8369,-1729.6332"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#a2ff00" stroke-dasharray="5,2" d="M1326.9551,-1854.5873C1358.5261,-1845.2241 1403.9781,-1831.744 1438.0902,-1821.6271"/>
<polygon fill="#a2ff00" stroke="#a2ff00" points="1439.2443,-1824.9355 1447.8364,-1818.7366 1437.2539,-1818.2245 1439.2443,-1824.9355"/>
</g>
<!-- sourcefile~hvaccooledbeam.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~hvaccooledbeam.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90</title>
<path fill="none" stroke="#5cff00" stroke-dasharray="5,2" d="M335.9783,-1215.6332C351.3653,-1215.6332 368.3611,-1215.6332 385.1742,-1215.6332"/>
<polygon fill="#5cff00" stroke="#5cff00" points="385.6031,-1219.1333 395.6031,-1215.6332 385.603,-1212.1333 385.6031,-1219.1333"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M1122.5832,-1488.7266C1172.8363,-1502.7016 1258.5807,-1524.0505 1289.7107,-1516.6332"/>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M1289.7107,-1516.6332C1380.4213,-1495.0196 1392.4449,-1449.476 1485.2747,-1440.6332"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#00ff2e" stroke-dasharray="5,2" d="M1161.7522,-1466.5646C1167.0295,-1463.877 1171.9656,-1460.6061 1176.3076,-1456.6332 1214.5705,-1421.6228 1175.6127,-1382.2837 1212.3076,-1345.6332 1217.2081,-1340.7386 1223.0721,-1336.8019 1229.3504,-1333.6356"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1231.0121,-1336.7294 1238.7814,-1329.5261 1228.2158,-1330.3122 1231.0121,-1336.7294"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node30"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1749.8394,-144.6386 1655.2119,-144.6386 1655.2119,-122.6278 1749.8394,-122.6278 1749.8394,-144.6386"/>
<text text-anchor="middle" x="1702.5256" y="-130.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#00ff73" stroke-dasharray="5,2" d="M1322.5067,-132.5448C1344.9139,-125.5697 1375.4462,-117.2309 1403.1138,-113.6332 1486.869,-102.7421 1584.6215,-113.6664 1645.0528,-123.1432"/>
<polygon fill="#00ff73" stroke="#00ff73" points="1644.7271,-126.6357 1655.1562,-124.7689 1645.8392,-119.7246 1644.7271,-126.6357"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node40" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node40"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1538.2671,-144.6386 1432.2822,-144.6386 1432.2822,-122.6278 1538.2671,-122.6278 1538.2671,-144.6386"/>
<text text-anchor="middle" x="1485.2747" y="-130.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#00ff73" stroke-dasharray="5,2" d="M1353.475,-140.3727C1375.4142,-139.2508 1399.9634,-137.9955 1421.8736,-136.8752"/>
<polygon fill="#00ff73" stroke="#00ff73" points="1422.2558,-140.3603 1432.064,-136.3541 1421.8983,-133.3694 1422.2558,-140.3603"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#00ffb9" stroke-dasharray="5,2" d="M1125.0361,-1777.5195C1175.4461,-1764.2924 1258.661,-1744.5839 1289.7107,-1749.6332"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M881.8532,-1641.5527C901.6681,-1622.8016 940.1643,-1582.6348 956.7188,-1539.6332 993.5563,-1443.9442 925.7279,-1157.258 992.7188,-1079.6332 993.7535,-1078.4342 994.8413,-1077.2959 995.9769,-1076.2154"/>
<polygon fill="#00ffff" stroke="#00ffff" points="998.3605,-1078.7954 1004.1042,-1069.8926 994.0623,-1073.2705 998.3605,-1078.7954"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M880.5829,-1641.4289C898.8979,-1622.1839 935.7055,-1580.919 956.7188,-1539.6332 982.5557,-1488.8701 964.2254,-1465.9543 992.7188,-1416.6332 1010.9472,-1385.0803 1041.6483,-1355.9021 1062.4782,-1338.1896"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1064.7522,-1340.8507 1070.1992,-1331.7633 1060.2741,-1335.4704 1064.7522,-1340.8507"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M873.3857,-1663.7296C885.8288,-1698.8097 928.2804,-1809.1533 992.7188,-1879.6332 1009.6951,-1898.2012 1033.448,-1913.7873 1052.5381,-1924.5564"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1051.0317,-1927.7217 1061.4849,-1929.4481 1054.3898,-1921.5798 1051.0317,-1927.7217"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M879.8114,-1641.5548C900.1431,-1619.8504 947.5837,-1570.7846 992.7188,-1535.6332 1012.6942,-1520.0762 1036.9761,-1504.8784 1055.5476,-1493.945"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1057.5355,-1496.8379 1064.4232,-1488.7874 1054.0185,-1490.7856 1057.5355,-1496.8379"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M887.1732,-1663.7626C924.9724,-1687.6808 1014.1106,-1744.0847 1058.4814,-1772.1611"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1056.6612,-1775.1512 1066.9831,-1777.5407 1060.4042,-1769.2359 1056.6612,-1775.1512"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1084.5132,-1673.6332C1180.8113,-1687.2288 1193.7185,-1734.0231 1289.7107,-1749.6332"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M879.7338,-1641.4294C897.1063,-1621.8562 932.9625,-1579.6923 956.7188,-1539.6332 977.021,-1505.3984 962.0471,-1482.9995 992.7188,-1457.6332 994.8132,-1455.901 997.0227,-1454.3053 999.3236,-1452.8356"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1001.5016,-1455.6341 1008.6006,-1447.7693 998.1465,-1449.4905 1001.5016,-1455.6341"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M883.8978,-1641.5996C906.0246,-1625.0695 950.4125,-1593.971 992.7188,-1576.6332 1005.4965,-1571.3966 1019.8358,-1567.3295 1033.3151,-1564.2301"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1034.3811,-1567.5805 1043.415,-1562.0453 1032.901,-1560.7388 1034.3811,-1567.5805"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1084.5132,-1673.6332C1400.1007,-1718.1886 1484.171,-1649.1812 1801.6157,-1677.6332 1935.1851,-1689.6048 1971.5597,-1771.8775 2098.8369,-1729.6332"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2098.8369,-1729.6332C2290.4839,-1650.5776 2309.9432,-1577.9652 2491.3594,-1477.6332"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M904.7403,-1654.7844C947.436,-1657.6923 1021.5577,-1663.6904 1084.5132,-1673.6332"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node41" class="node">
<title>sourcefile~hvacstandaloneerv.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node41"><a xlink:href="../sourcefile/hvacstandaloneerv.f90.html" xlink:title="HVACStandAloneERV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1150.6611,-1607.6386 1018.3653,-1607.6386 1018.3653,-1585.6278 1150.6611,-1585.6278 1150.6611,-1607.6386"/>
<text text-anchor="middle" x="1084.5132" y="-1593.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACStandAloneERV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M904.595,-1643.5112C939.2467,-1634.4826 992.7112,-1620.5524 1032.3629,-1610.221"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1033.332,-1613.5855 1042.1264,-1607.6771 1031.567,-1606.8116 1033.332,-1613.5855"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M714.0819,-1738.5341C724.8217,-1734.7441 736.3484,-1730.0669 746.4507,-1724.6332 764.0644,-1715.1593 765.5067,-1708.2588 782.4507,-1697.6332 799.5726,-1686.896 819.5502,-1676.441 836.0541,-1668.3151"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="837.855,-1671.3315 845.322,-1663.8152 834.7975,-1665.0344 837.855,-1671.3315"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M692.8479,-1738.5147C707.9217,-1727.7077 730.3591,-1710.2404 746.4507,-1691.6332 766.5442,-1668.3984 765.046,-1657.9449 782.4507,-1632.6332 805.8704,-1598.5738 835.7761,-1560.9098 853.7645,-1538.8082"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="856.6322,-1540.8304 860.255,-1530.8742 851.2141,-1536.3981 856.6322,-1540.8304"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M740.0341,-1748.5602C777.6985,-1748.1913 826.377,-1748.1799 869.5847,-1749.6332"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00b9ff" stroke-dasharray="5,2" d="M739.8144,-1741.1627C753.8491,-1739.3134 768.6522,-1737.386 782.4507,-1735.6332 957.3876,-1713.4108 1006.8737,-1736.5096 1176.3076,-1687.6332 1378.7085,-1629.2469 1600.6154,-1501.3708 1675.8815,-1455.9993"/>
<polygon fill="#00b9ff" stroke="#00b9ff" points="1677.983,-1458.8183 1684.7212,-1450.6423 1674.355,-1452.8318 1677.983,-1458.8183"/>
</g>
<!-- sourcefile~hvacmultispeedheatpump.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~hvacmultispeedheatpump.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0073ff" stroke-dasharray="5,2" d="M563.5016,-1979.6332C641.6504,-1979.6332 763.7682,-1979.6332 869.5847,-1979.6332 869.5847,-1979.6332 869.5847,-1979.6332 1084.5132,-1979.6332 1128.0419,-1979.6332 1320.6203,-1943.1589 1367.1138,-1918.6332 1410.7609,-1895.6089 1450.0462,-1852.0571 1470.4715,-1826.895"/>
<polygon fill="#0073ff" stroke="#0073ff" points="1473.4031,-1828.8317 1476.8858,-1818.8256 1467.9233,-1824.4759 1473.4031,-1828.8317"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M746.5118,-1664.7469C772.5236,-1662.1866 801.3257,-1659.3517 824.5235,-1657.0684"/>
<polygon fill="#002eff" stroke="#002eff" points="825.1484,-1660.5239 834.7574,-1656.0611 824.4626,-1653.5576 825.1484,-1660.5239"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M690.7428,-1660.4563C724.0008,-1634.2684 807.1743,-1568.7762 847.2748,-1537.2004"/>
<polygon fill="#002eff" stroke="#002eff" points="849.6781,-1539.7629 855.3695,-1530.8265 845.3475,-1534.2632 849.6781,-1539.7629"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M692.6994,-1682.7276C724.7813,-1703.6976 799.5016,-1747.276 869.5847,-1749.6332"/>
<path fill="none" stroke="#002eff" stroke-dasharray="5,2" d="M869.5847,-1749.6332C1056.2018,-1755.9099 1105.409,-1719.6623 1289.7107,-1749.6332"/>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#1700ff" stroke-dasharray="5,2" d="M880.562,-1508.4178C901.0532,-1487.9721 947.1856,-1444.2091 992.7188,-1416.6332 1068.2561,-1370.8861 1124.0243,-1411.803 1176.3076,-1340.6332 1229.6704,-1267.994 1156.0798,-1007.0781 1212.3076,-936.6332 1216.1452,-931.8253 1220.9181,-927.9297 1226.1968,-924.7752"/>
<polygon fill="#1700ff" stroke="#1700ff" points="1228.101,-927.7364 1235.4822,-920.1359 1224.9723,-921.4745 1228.101,-927.7364"/>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#1700ff" stroke-dasharray="5,2" d="M919.0957,-1522.0599C1014.5729,-1526.2819 1220.7966,-1533.0534 1289.7107,-1516.6332"/>
</g>
<!-- sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge165" class="edge">
<title>sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M294.6224,-925.4285C317.2375,-911.7149 357.911,-888.8186 395.7781,-876.6332 516.0157,-837.9413 550.5304,-841.2147 676.5483,-832.6332"/>
</g>
<!-- sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge164" class="edge">
<title>sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M285.1861,-947.9159C316.7587,-990.5999 429.119,-1142.5031 469.0242,-1196.4522"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="466.228,-1198.5575 474.9887,-1204.5158 471.8557,-1194.3947 466.228,-1198.5575"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node42" class="node">
<title>sourcefile~zoneplenumcomponent.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node42"><a xlink:href="../sourcefile/zoneplenumcomponent.f90.html" xlink:title="ZonePlenumComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="555.0445,-804.6386 411.3796,-804.6386 411.3796,-782.6278 555.0445,-782.6278 555.0445,-804.6386"/>
<text text-anchor="middle" x="483.212" y="-790.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZonePlenumComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge163" class="edge">
<title>sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#5c00ff" stroke-dasharray="5,2" d="M285.0026,-925.3349C302.5566,-901.8619 346.337,-847.5995 395.7781,-818.6332 402.8477,-814.4912 410.6444,-811.0012 418.5827,-808.069"/>
<polygon fill="#5c00ff" stroke="#5c00ff" points="419.9577,-811.2982 428.2966,-804.7627 417.7022,-804.6716 419.9577,-811.2982"/>
</g>
<!-- sourcefile~unitventilator.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge168" class="edge">
<title>sourcefile~unitventilator.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#a200ff" stroke-dasharray="5,2" d="M1130.3049,-1098.7802C1146.7154,-1096.2076 1164.1455,-1090.5141 1176.3076,-1078.6332 1222.8809,-1033.1366 1167.7689,-984.1233 1212.3076,-936.6332 1216.3302,-932.344 1221.0921,-928.7888 1226.2464,-925.8421"/>
<polygon fill="#a200ff" stroke="#a200ff" points="1227.7931,-928.9819 1235.2298,-921.4356 1224.7103,-922.6973 1227.7931,-928.9819"/>
</g>
<!-- sourcefile~unitventilator.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge167" class="edge">
<title>sourcefile~unitventilator.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#a200ff" stroke-dasharray="5,2" d="M1130.5913,-1098.3244C1172.2003,-1097.4539 1235.0947,-1096.9118 1289.7107,-1099.6332"/>
</g>
<!-- sourcefile~unitventilator.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge166" class="edge">
<title>sourcefile~unitventilator.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#a200ff" stroke-dasharray="5,2" d="M1130.6502,-1104.9449C1146.3501,-1108.5388 1163.2198,-1114.5575 1176.3076,-1124.6332 1236.6446,-1171.0836 1270.5969,-1259.4456 1283.55,-1299.7073"/>
<polygon fill="#a200ff" stroke="#a200ff" points="1280.2156,-1300.7717 1286.5233,-1309.2843 1286.9008,-1298.6962 1280.2156,-1300.7717"/>
</g>
<!-- sourcefile~unitheater.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge170" class="edge">
<title>sourcefile~unitheater.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1124.0773,-911.6332C1152.785,-911.6332 1192.2424,-911.6332 1225.4446,-911.6332"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1225.5291,-915.1333 1235.5291,-911.6332 1225.529,-908.1333 1225.5291,-915.1333"/>
</g>
<!-- sourcefile~unitheater.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge169" class="edge">
<title>sourcefile~unitheater.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1124.2216,-922.6171C1165.2683,-933.1559 1231.3939,-947.8685 1289.7107,-950.6332"/>
<path fill="none" stroke="#e700ff" stroke-dasharray="5,2" d="M1289.7107,-950.6332C1436.3957,-957.5873 1472.3143,-1017.7547 1567.4355,-1129.6332 1645.3631,-1221.2891 1685.0934,-1364.8469 1697.8451,-1418.4826"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1694.5007,-1419.5557 1700.1607,-1428.512 1701.3212,-1417.9809 1694.5007,-1419.5557"/>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge173" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#ff00d0" stroke-dasharray="5,2" d="M676.5483,-1062.6332C738.2503,-1059.7639 729.3462,-1004.1813 782.4507,-972.6332 843.2404,-936.5195 1014.0401,-866.8765 1084.5132,-872.6332"/>
<path fill="none" stroke="#ff00d0" stroke-dasharray="5,2" d="M531.7303,-1063.6803C570.8628,-1064.8989 627.3009,-1065.6811 676.5483,-1062.6332"/>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge172" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff00d0" stroke-dasharray="5,2" d="M676.5483,-1062.6332C682.301,-1062.2772 1079.5722,-1135.6657 1084.5132,-1138.6332"/>
</g>
<!-- sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node44" class="node">
<title>sourcefile~outputreporttabular.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node44"><a xlink:href="../sourcefile/outputreporttabular.f90.html" xlink:title="OutputReportTabular.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="739.9621,-711.6386 613.1346,-711.6386 613.1346,-689.6278 739.9621,-689.6278 739.9621,-711.6386"/>
<text text-anchor="middle" x="676.5483" y="-697.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportTabular.f90</text>
</a>
</g>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge171" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff00d0" stroke-dasharray="5,2" d="M490.0186,-1050.4387C505.3503,-1025.0124 543.377,-960.7566 570.646,-904.6332 588.7544,-867.3636 588.0421,-855.6579 606.646,-818.6332 624.5925,-782.9169 649.0605,-743.3019 663.7801,-720.2594"/>
<polygon fill="#ff00d0" stroke="#ff00d0" points="666.7989,-722.036 669.2665,-711.7325 660.9121,-718.2483 666.7989,-722.036"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1957.6866,-1373.6386 1859.1285,-1373.6386 1859.1285,-1351.6278 1957.6866,-1351.6278 1957.6866,-1373.6386"/>
<text text-anchor="middle" x="1908.4076" y="-1359.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge175" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M1509.5607,-1796.4776C1550.6054,-1777.2316 1635.746,-1735.6033 1702.5256,-1691.6332"/>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M1702.5256,-1691.6332C1750.2696,-1660.1969 1767.3042,-1655.3545 1801.6157,-1609.6332 1857.1836,-1535.5871 1890.7125,-1428.1769 1903.0265,-1383.4216"/>
<polygon fill="#ff008b" stroke="#ff008b" points="1906.4285,-1384.2482 1905.6403,-1373.6828 1899.6677,-1382.4337 1906.4285,-1384.2482"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node32" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node32"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2696.5221,-436.6386 2597.5646,-436.6386 2597.5646,-414.6278 2696.5221,-414.6278 2696.5221,-436.6386"/>
<text text-anchor="middle" x="2647.0433" y="-422.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge174" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff008b" stroke-dasharray="5,2" d="M1702.5256,-1691.6332C1712.1318,-1685.3082 2482.2073,-1446.5991 2491.3594,-1439.6332"/>
</g>
<!-- sourcefile~hvacsingleductinduc.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge177" class="edge">
<title>sourcefile~hvacsingleductinduc.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#ff0045" stroke-dasharray="5,2" d="M306.6675,-1126.4727C323.5213,-1119.1691 344.2557,-1108.4191 359.7781,-1094.6332 381.069,-1075.7239 373.0761,-1058.8228 395.7781,-1041.6332 526.7653,-942.4517 602.2694,-1003.4138 746.4507,-924.6332 764.4804,-914.7817 763.3483,-903.1978 782.4507,-895.6332 907.6312,-846.061 950.4293,-860.4237 1084.5132,-872.6332"/>
</g>
<!-- sourcefile~hvacsingleductinduc.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge176" class="edge">
<title>sourcefile~hvacsingleductinduc.f90&#45;&gt;sourcefile~zoneairloopequipmentmanager.f90</title>
<path fill="none" stroke="#ff0045" stroke-dasharray="5,2" d="M305.9708,-1148.6433C342.2038,-1162.3379 404.1852,-1185.7643 444.4155,-1200.9697"/>
<polygon fill="#ff0045" stroke="#ff0045" points="443.3049,-1204.2915 453.8965,-1204.5531 445.7798,-1197.7436 443.3049,-1204.2915"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1367.017,-1566.6386 1212.4044,-1566.6386 1212.4044,-1544.6278 1367.017,-1544.6278 1367.017,-1566.6386"/>
<text text-anchor="middle" x="1289.7107" y="-1552.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1159.7826,-1447.7983C1165.6966,-1450.444 1171.3053,-1453.68 1176.3076,-1457.6332 1204.69,-1480.0626 1184.9334,-1506.9838 1212.3076,-1530.6332 1216.582,-1534.326 1221.4104,-1537.4751 1226.5152,-1540.1603"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1225.3962,-1543.4986 1235.9427,-1544.5099 1228.3288,-1537.1424 1225.3962,-1543.4986"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1170.174,-1447.6509C1334.751,-1467.4707 1688.8384,-1503.2059 1801.6157,-1459.6332 1841.8064,-1444.1051 1876.2042,-1405.6464 1894.4467,-1382.0859"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1897.4156,-1383.9612 1900.6257,-1373.8644 1891.8198,-1379.7556 1897.4156,-1383.9612"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1125.2392,-1549.0323C1166.8128,-1542.0277 1233.0946,-1530.1231 1289.7107,-1516.6332"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1113.2251,-1544.5325C1133.8392,-1535.1006 1160.6462,-1519.5743 1176.3076,-1497.6332 1216.6413,-1441.127 1165.2157,-1396.644 1212.3076,-1345.6332 1217.0701,-1340.4743 1222.9023,-1336.3764 1229.2091,-1333.1217"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1230.9795,-1336.1664 1238.7194,-1328.9315 1228.1571,-1329.7606 1230.9795,-1336.1664"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M536.7434,-1739.3073C590.174,-1728.6569 674.4653,-1710.9216 746.4507,-1691.6332 773.7423,-1684.3204 803.9977,-1674.7585 827.6882,-1666.9329"/>
<polygon fill="#0000ff" stroke="#0000ff" points="829.0284,-1670.1757 837.4115,-1663.697 826.8179,-1663.5338 829.0284,-1670.1757"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M536.8102,-1749.6332C557.3551,-1749.6332 581.1625,-1749.6332 603.2405,-1749.6332"/>
<polygon fill="#0000ff" stroke="#0000ff" points="603.2449,-1753.1333 613.2449,-1749.6332 603.2449,-1746.1333 603.2449,-1753.1333"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M495.5347,-1738.4217C517.0424,-1719.1898 563.2864,-1679.3123 606.646,-1651.6332 683.9001,-1602.3172 782.0352,-1557.2842 833.8254,-1534.7585"/>
<polygon fill="#0000ff" stroke="#0000ff" points="835.4522,-1537.8684 843.2434,-1530.6886 832.6754,-1531.4427 835.4522,-1537.8684"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M676.5483,-1788.6332C763.9689,-1784.3098 782.0672,-1748.3186 869.5847,-1749.6332"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M525.4333,-1760.6866C573.0925,-1772.7113 647.7351,-1790.0582 676.5483,-1788.6332"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1298.3662,-1566.7865C1328.9097,-1606.1442 1431.8834,-1738.8342 1470.4907,-1788.5829"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1467.8232,-1790.8544 1476.7191,-1796.6087 1473.3533,-1786.5627 1467.8232,-1790.8544"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1367.2686,-1565.5725C1451.0648,-1574.0213 1587.9742,-1581.1474 1702.5256,-1555.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1702.5256,-1555.6332C1797.5205,-1531.0102 1869.9023,-1426.7641 1896.9015,-1382.5686"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1899.9773,-1384.2446 1902.1027,-1373.8651 1893.9684,-1380.6537 1899.9773,-1384.2446"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1332.9416,-1544.5145C1344.3693,-1540.818 1356.4761,-1536.1938 1367.1138,-1530.6332 1425.6174,-1500.0513 1419.5576,-1446.8933 1485.2747,-1440.6332"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1295.2189,-1544.3399C1310.2026,-1512.9598 1351.6123,-1421.6811 1367.1138,-1340.6332 1378.7148,-1279.978 1365.9151,-278.9271 1403.1138,-229.6332 1432.4584,-190.7471 1566.4297,-159.4187 1644.8692,-144.012"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1645.932,-147.3713 1655.0841,-142.0339 1644.6011,-140.499 1645.932,-147.3713"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node31" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node31"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2170.6745,-1411.6386 2026.9994,-1411.6386 2026.9994,-1389.6278 2170.6745,-1389.6278 2170.6745,-1411.6386"/>
<text text-anchor="middle" x="2098.8369" y="-1397.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1702.5256,-1555.6332C1842.9424,-1519.2367 2001.0949,-1447.493 2067.1789,-1416.0322"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2068.7388,-1419.1659 2076.2479,-1411.6918 2065.7168,-1412.8518 2068.7388,-1419.1659"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1957.9435,-1372.518C1980.9955,-1377.118 2008.729,-1382.6522 2033.4709,-1387.5895"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2033.0155,-1391.0675 2043.5071,-1389.5922 2034.3854,-1384.2029 2033.0155,-1391.0675"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2491.3594,-1477.6332C2524.325,-1478.2128 2539.7295,-1478.3468 2561.554,-1453.6332 2712.912,-1282.2383 2779.8213,-506.1331 2790.6427,-367.77"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2794.1445,-367.8797 2791.423,-357.6404 2787.1652,-367.342 2794.1445,-367.8797"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1957.8613,-1362.3508C2013.0855,-1362.8504 2104.9037,-1366.1221 2182.4744,-1380.6332 2217.834,-1387.2479 2459.2587,-1493.8693 2491.3594,-1477.6332"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1732.0235,-1428.601C1768.1804,-1415.0783 1829.5605,-1392.1221 1869.5383,-1377.1703"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1870.8242,-1380.4263 1878.9644,-1373.6449 1868.372,-1373.8698 1870.8242,-1380.4263"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1774.2014,-1444.3835C1957.7725,-1455.8882 2434.4373,-1481.3503 2491.3594,-1439.6332"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1726.3655,-144.639C1749.9023,-156.8937 1784.7454,-179.0753 1801.6157,-209.6332 1858.4913,-312.6541 1900.6647,-1191.7972 1907.4495,-1341.1199"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1903.9605,-1341.4455 1907.9073,-1351.2777 1910.9534,-1341.1303 1903.9605,-1341.4455"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1908.4076,-57.6332C1955.8907,-51.5658 1967.6038,-66.5235 2015.1995,-71.6332 2142.3016,-85.2783 2173.9871,-95.6332 2301.8196,-95.6332 2301.8196,-95.6332 2301.8196,-95.6332 2491.3594,-95.6332 2635.3782,-95.6332 2746.969,-267.3024 2781.2678,-326.6974"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2778.2944,-328.5495 2786.2697,-335.5242 2784.3845,-325.0984 2778.2944,-328.5495"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node35" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node35"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2984.3685,-259.6386 2888.1263,-259.6386 2888.1263,-237.6278 2984.3685,-237.6278 2984.3685,-259.6386"/>
<text text-anchor="middle" x="2936.2474" y="-245.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1722.9738,-122.399C1748.9192,-108.5831 1795.3839,-85.2898 1837.6157,-71.6332 1868.1323,-61.765 1876.6734,-62.2784 1908.4076,-57.6332"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1908.4076,-57.6332C1992.1504,-45.375 2014.2018,-57.7813 2098.8369,-57.6332"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2117.5877,-1411.7016C2152.4318,-1431.3495 2230.1469,-1470.8961 2301.8196,-1477.6332"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2301.8196,-1477.6332C2385.6898,-1485.5168 2407.1325,-1476.1524 2491.3594,-1477.6332"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node36" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node36"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2385.0103,-338.6386 2218.6289,-338.6386 2218.6289,-316.6278 2385.0103,-316.6278 2385.0103,-338.6386"/>
<text text-anchor="middle" x="2301.8196" y="-324.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2099.0636,-1389.509C2100.8771,-1313.0553 2115.7727,-857.9635 2218.4744,-506.6332 2236.1689,-446.1021 2271.4735,-380.1294 2289.9401,-347.7959"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2293.117,-349.2937 2295.0924,-338.8846 2287.057,-345.7899 2293.117,-349.2937"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2667.5378,-414.482C2692.399,-400.9548 2734.4904,-378.0525 2762.8125,-362.6422"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2764.7336,-365.5815 2771.8448,-357.7277 2761.388,-359.4328 2764.7336,-365.5815"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node34" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node34"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2977.9559,-357.6386 2894.5389,-357.6386 2894.5389,-335.6278 2977.9559,-335.6278 2977.9559,-357.6386"/>
<text text-anchor="middle" x="2936.2474" y="-343.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2852.0581,-346.6332C2862.7227,-346.6332 2873.7545,-346.6332 2884.1809,-346.6332"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2884.3694,-350.1333 2894.3694,-346.6332 2884.3693,-343.1333 2884.3694,-350.1333"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2808.4751,-335.5818C2833.5408,-318.5247 2881.8365,-285.6597 2911.3395,-265.583"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2913.5474,-268.314 2919.8457,-259.7945 2909.6093,-262.5269 2913.5474,-268.314"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2343.8234,-316.5827C2382.3785,-308.0044 2440.9859,-298.9148 2491.3594,-307.6332"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node37" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node37"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2556.3647,-357.6386 2426.354,-357.6386 2426.354,-335.6278 2556.3647,-335.6278 2556.3647,-357.6386"/>
<text text-anchor="middle" x="2491.3594" y="-343.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2385.2303,-335.9945C2395.5098,-337.025 2405.9702,-338.0735 2416.1183,-339.0908"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2415.8447,-342.5808 2426.144,-340.0958 2416.543,-335.6158 2415.8447,-342.5808"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2535.9415,-357.7318C2544.618,-360.5121 2553.5109,-363.8132 2561.554,-367.6332 2584.8694,-378.7067 2608.9877,-395.6596 2625.6378,-408.382"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2623.5793,-411.215 2633.6203,-414.5958 2627.8792,-405.6913 2623.5793,-411.215"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2556.5026,-346.4469C2584.3876,-346.4154 2617.3126,-346.4422 2647.0433,-346.6332"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1296.6979,-1309.3656C1343.773,-1234.064 1615.4062,-809.3423 1702.5256,-892.6332"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1340.5184,-1330.737C1488.2075,-1359.6254 1930.4898,-1442.729 2301.8196,-1477.6332"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1292.5527,-1309.5929C1304.2381,-1263.6633 1348.8251,-1083.0547 1367.1138,-931.6332 1372.5682,-886.473 1372.863,-147.605 1403.1138,-113.6332 1574.6371,78.9886 1721.7155,-28.619 1979.1995,-43.6332 2032.6437,-46.7496 2045.302,-57.7269 2098.8369,-57.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2792.235,-171.6332C2831.7799,-192.6227 2877.3342,-217.0155 2906.438,-232.6269"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2904.8142,-235.7276 2915.2807,-237.3715 2908.1238,-229.5594 2904.8142,-235.7276"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2098.8369,-57.6332C2304.7369,-54.2102 2358.8335,-45.4261 2561.554,-81.6332 2669.8911,-100.9829 2695.0276,-120.0378 2792.235,-171.6332"/>
</g>
<!-- sourcefile~zoneairloopequipmentmanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~zoneairloopequipmentmanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M518.9105,-1226.7124C601.3948,-1251.7976 811.9919,-1312.9056 992.7188,-1340.6332 1058.087,-1350.6622 1228.6994,-1334.1142 1289.7107,-1359.6332"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1538.4202,-133.6332C1570.612,-133.6332 1611.6901,-133.6332 1644.6944,-133.6332"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1645.1049,-137.1333 1655.1049,-133.6332 1645.1048,-130.1333 1645.1049,-137.1333"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1150.91,-1602.5005C1307.6579,-1615.0484 1695.48,-1638.0908 1801.6157,-1569.6332 1868.5149,-1526.4832 1895.6756,-1427.2868 1904.6541,-1383.7601"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1908.1308,-1384.2161 1906.5997,-1373.7325 1901.259,-1382.8827 1908.1308,-1384.2161"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1151.0816,-1586.5518C1159.8985,-1583.7579 1168.5562,-1580.1899 1176.3076,-1575.6332 1196.9264,-1563.5123 1191.7853,-1547.9166 1212.3076,-1535.6332 1242.7018,-1517.441 1255.2527,-1524.8435 1289.7107,-1516.6332"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1150.8525,-1591.5021C1160.4454,-1588.0993 1169.3943,-1583.0455 1176.3076,-1575.6332 1246.8784,-1499.9685 1145.1139,-1424.3122 1212.3076,-1345.6332 1217.0994,-1340.0224 1223.1596,-1335.6605 1229.7708,-1332.2714"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1231.2886,-1335.4279 1239.0602,-1328.227 1228.4943,-1329.0098 1231.2886,-1335.4279"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge156" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-832.6332C800.449,-819.1293 838.8305,-780.1848 956.7188,-820.6332 975.8914,-827.2115 974.5415,-839.6638 992.7188,-848.6332 1030.5345,-867.293 1042.5301,-868.6789 1084.5132,-872.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.5132,-872.6332C1136.5999,-876.888 1195.0729,-888.7122 1236.2343,-898.2348"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1235.5144,-901.6609 1246.0495,-900.5378 1237.1135,-894.846 1235.5144,-901.6609"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M524.5985,-804.6574C572.2263,-816.8684 647.5958,-834.6048 676.5483,-832.6332"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge160" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1289.7107,-1749.6332C1345.3464,-1758.9031 1407.4502,-1779.0879 1446.4398,-1793.0185"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1445.7232,-1796.4812 1456.3175,-1796.5911 1448.1041,-1789.8985 1445.7232,-1796.4812"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M496.3146,-804.8235C514.0103,-820.2077 546.1508,-849.1211 570.646,-876.6332 588.3785,-896.5497 588.5791,-905.0194 606.646,-924.6332 662.9161,-985.721 696.8009,-982.0528 746.4507,-1048.6332 878.6591,-1225.9247 877.2843,-1293.2319 956.7188,-1499.6332 976.2599,-1550.4086 952.9545,-1579.5009 992.7188,-1616.6332 1053.969,-1673.8293 1100.8639,-1623.1471 1176.3076,-1659.6332 1234.2342,-1687.6476 1226.2405,-1739.058 1289.7107,-1749.6332"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge154" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-910.6332C704.8657,-924.8476 719.205,-908.4594 746.4507,-924.6332 767.8834,-937.3562 763.7198,-951.1897 782.4507,-967.6332 851.4608,-1028.216 887.0006,-1018.8666 956.7188,-1078.6332 975.1294,-1094.416 971.7613,-1107.4334 992.7188,-1119.6332 1028.7247,-1140.5931 1049.762,-1115.6528 1084.5132,-1138.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1289.7107,-1359.6332C1376.0754,-1396.9396 1391.6209,-1449.5545 1485.2747,-1440.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.5132,-1138.6332C1128.7895,-1167.9779 1169.1911,-1309.6096 1212.3076,-1340.6332 1241.0607,-1361.3219 1257.1922,-1345.5864 1289.7107,-1359.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1485.2747,-1440.6332C1529.7539,-1436.3962 1579.5879,-1435.8663 1620.2967,-1436.5199"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1620.3771,-1440.022 1630.441,-1436.7101 1620.5084,-1433.0232 1620.3771,-1440.022"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge159" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M494.0239,-804.817C514.2528,-825.1038 560.0087,-868.0475 606.646,-891.6332 635.3759,-906.1626 647.0949,-897.633 676.5483,-910.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-910.6332C781.4287,-956.9256 1090.0879,-963.075 1176.3076,-1038.6332 1186.8572,-1047.8783 1258.1362,-1236.3646 1281.9678,-1299.9183"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1278.7033,-1301.181 1285.4881,-1309.3183 1285.2586,-1298.726 1278.7033,-1301.181"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node43" class="node">
<title>sourcefile~heatbalanceinternalheatgains.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node43"><a xlink:href="../sourcefile/heatbalanceinternalheatgains.f90.html" xlink:title="HeatBalanceInternalHeatGains.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="956.853,-552.6386 782.3164,-552.6386 782.3164,-530.6278 956.853,-530.6278 956.853,-552.6386"/>
<text text-anchor="middle" x="869.5847" y="-538.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceInternalHeatGains.f90</text>
</a>
</g>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge155" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-402.6332C754.1514,-371.3674 829.8207,-476.6373 858.0171,-521.9239"/>
<polygon fill="#ff0000" stroke="#ff0000" points="855.1106,-523.8807 863.2969,-530.6064 861.0916,-520.2436 855.1106,-523.8807"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge157" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M506.1495,-782.5997C540.4518,-766.0993 605.2491,-734.9301 644.3012,-716.1449"/>
<polygon fill="#ff0000" stroke="#ff0000" points="646.1463,-719.1413 653.6408,-711.6524 643.1119,-712.8332 646.1463,-719.1413"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node45" class="node">
<title>sourcefile~zonecontaminantpredictorcorrector.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node45"><a xlink:href="../sourcefile/zonecontaminantpredictorcorrector.f90.html" xlink:title="ZoneContaminantPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1801.7059,-528.6386 1603.3454,-528.6386 1603.3454,-506.6278 1801.7059,-506.6278 1801.7059,-528.6386"/>
<text text-anchor="middle" x="1702.5256" y="-514.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneContaminantPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge158" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M676.5483,-402.6332C756.1263,-370.5717 784.0623,-409.4535 869.5847,-402.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M869.5847,-402.6332C928.8028,-397.9106 934.4944,-362.4233 992.7188,-350.6332 1072.6907,-334.4394 1095.6739,-338.1452 1176.3076,-350.6332 1367.9013,-380.306 1585.255,-467.3503 1668.0426,-502.5768"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1666.8903,-505.8906 1677.4608,-506.6085 1669.6451,-499.4555 1666.8903,-505.8906"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483.9256,-782.5679C488.2835,-725.7556 516.7512,-467.0146 676.5483,-402.6332"/>
</g>
<!-- sourcefile~returnairpath.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node46" class="node">
<title>sourcefile~returnairpath.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node46"><a xlink:href="../sourcefile/returnairpath.f90.html" xlink:title="ReturnAirPath.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="724.5111,-882.6386 628.5855,-882.6386 628.5855,-860.6278 724.5111,-860.6278 724.5111,-882.6386"/>
<text text-anchor="middle" x="676.5483" y="-868.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReturnAirPath.f90</text>
</a>
</g>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~returnairpath.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge161" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~returnairpath.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M507.6165,-804.6439C532.3838,-815.6922 571.9182,-832.9826 606.646,-846.6332 615.7267,-850.2026 625.5497,-853.8471 634.8817,-857.2102"/>
<polygon fill="#ff0000" stroke="#ff0000" points="633.7826,-860.5341 644.3773,-860.5981 636.1349,-853.9412 633.7826,-860.5341"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node47" class="node">
<title>sourcefile~zonetemppredictorcorrector.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node47"><a xlink:href="../sourcefile/zonetemppredictorcorrector.f90.html" xlink:title="ZoneTempPredictorCorrector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1567.5968,-606.6386 1402.9526,-606.6386 1402.9526,-584.6278 1567.5968,-584.6278 1567.5968,-606.6386"/>
<text text-anchor="middle" x="1485.2747" y="-592.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZoneTempPredictorCorrector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge162" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M869.5847,-402.6332C1005.7996,-390.6843 1048.8016,-377.2421 1176.3076,-426.6332 1195.2089,-433.9548 1195.453,-443.3732 1212.3076,-454.6332 1278.1154,-498.5972 1301.306,-498.6692 1367.1138,-542.6332 1383.9683,-553.8932 1385.1179,-561.3052 1403.1138,-570.6332 1411.1822,-574.8154 1420.0663,-578.4233 1428.9202,-581.4933"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1427.8831,-584.8365 1438.4756,-584.6152 1430.0571,-578.1827 1427.8831,-584.8365"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge120" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M877.9872,-552.6994C894.106,-574.135 930.1274,-623.0494 956.7188,-666.6332 974.5293,-695.8251 965.5259,-713.8983 992.7188,-734.6332 1056.969,-783.6248 1642.408,-838.6505 1702.5256,-892.6332"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge114" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.5132,-950.6332C1166.9338,-989.6727 1202.3135,-924.5761 1289.7107,-950.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M880.3313,-552.9372C899.3043,-573.6333 938.4548,-619.8073 956.7188,-666.6332 999.9096,-777.3678 911.6248,-844.7345 992.7188,-931.6332 1021.1435,-962.0926 1046.8611,-932.7988 1084.5132,-950.6332"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge123" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.5132,-440.6332C1141,-432.0357 1155.2553,-451.5174 1212.3076,-454.6332 1281.008,-458.3851 1298.3777,-457.6621 1367.1138,-454.6332 1730.5537,-438.6177 1830.9048,-476.1422 2182.4744,-382.6332 2215.4164,-373.8714 2250.5598,-356.6017 2274.1132,-343.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2276.1171,-346.6304 2283.1526,-338.7087 2272.7127,-340.514 2276.1171,-346.6304"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge118" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1485.2747,-556.6332C1848.1722,-540.3794 1963.3173,-652.4476 2301.8196,-520.6332"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge117" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1485.2747,-556.6332C1542.2767,-554.0801 1606.4673,-541.3029 1650.1997,-531.0588"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1651.1165,-534.4385 1660.0337,-528.7171 1649.495,-527.6289 1651.1165,-534.4385"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.5132,-440.6332C1125.7011,-434.3643 1143.2121,-434.3264 1176.3076,-459.6332 1204.4127,-481.124 1185.5413,-507.4963 1212.3076,-530.6332 1239.7625,-554.3653 1255.1167,-545.6679 1289.7107,-556.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1289.7107,-556.6332C1372.5654,-582.8956 1398.4444,-560.5222 1485.2747,-556.6332"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge125" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1289.7107,-556.6332C1312.3093,-563.7963 1366.697,-574.4567 1412.3943,-582.8225"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1411.832,-586.2776 1422.2971,-584.6247 1413.0853,-579.3907 1411.832,-586.2776"/>
</g>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node48" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node48"><a xlink:href="../sourcefile/daylightingmanager.f90.html" xlink:title="DaylightingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1763.853,-240.6386 1641.1983,-240.6386 1641.1983,-218.6278 1763.853,-218.6278 1763.853,-240.6386"/>
<text text-anchor="middle" x="1702.5256" y="-226.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge115" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M877.938,-530.5367C893.9728,-509.0495 929.8566,-460.0506 956.7188,-416.6332 974.2987,-388.2186 966.7182,-371.6193 992.7188,-350.6332 1181.4513,-198.2988 1491.8175,-207.3677 1631.0403,-220.6885"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1630.8694,-224.1887 1641.1664,-221.6941 1631.5612,-217.2229 1630.8694,-224.1887"/>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node49" class="node">
<title>sourcefile~roomairmodelcrossvent.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node49"><a xlink:href="../sourcefile/roomairmodelcrossvent.f90.html" xlink:title="RoomAirModelCrossVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1158.4114,-490.6386 1010.6149,-490.6386 1010.6149,-468.6278 1158.4114,-468.6278 1158.4114,-490.6386"/>
<text text-anchor="middle" x="1084.5132" y="-476.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelCrossVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge116" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelcrossvent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M899.9462,-530.6131C924.7152,-521.844 960.7172,-509.5989 992.7188,-500.6332 1002.2821,-497.9539 1012.4758,-495.3636 1022.4622,-492.971"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1023.4141,-496.3427 1032.3485,-490.6483 1021.8131,-489.5283 1023.4141,-496.3427"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node50" class="node">
<title>sourcefile~roomairmodelusertemppattern.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node50"><a xlink:href="../sourcefile/roomairmodelusertemppattern.f90.html" xlink:title="RoomAirModelUserTempPattern.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1174.6646,-654.6386 994.3617,-654.6386 994.3617,-632.6278 1174.6646,-632.6278 1174.6646,-654.6386"/>
<text text-anchor="middle" x="1084.5132" y="-640.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUserTempPattern.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge119" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M883.0501,-552.8652C904.7494,-570.3929 949.4155,-604.1522 992.7188,-622.6332 998.9822,-625.3063 1005.6379,-627.6655 1012.3921,-629.7422"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1011.7472,-633.1982 1022.3244,-632.5863 1013.6743,-626.4686 1011.7472,-633.1982"/>
</g>
<!-- sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node51" class="node">
<title>sourcefile~delightmanagerf.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node51"><a xlink:href="../sourcefile/delightmanagerf.f90.html" xlink:title="DElightManagerF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1540.3276,-260.6386 1430.2217,-260.6386 1430.2217,-238.6278 1540.3276,-238.6278 1540.3276,-260.6386"/>
<text text-anchor="middle" x="1485.2747" y="-246.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DElightManagerF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge121" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M882.6284,-530.437C904.0958,-512.6177 948.8771,-477.9525 992.7188,-459.6332 1031.16,-443.5704 1043.1839,-445.8904 1084.5132,-440.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1084.5132,-440.6332C1241.2357,-420.6977 1403.9171,-310.2346 1462.5384,-266.9945"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1464.8037,-269.6713 1470.7288,-260.8881 1460.6197,-264.0593 1464.8037,-269.6713"/>
</g>
<!-- sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node52" class="node">
<title>sourcefile~roomairmodelufad.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node52"><a xlink:href="../sourcefile/roomairmodelufad.f90.html" xlink:title="RoomAirModelUFAD.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1147.9749,-613.6386 1021.0515,-613.6386 1021.0515,-591.6278 1147.9749,-591.6278 1147.9749,-613.6386"/>
<text text-anchor="middle" x="1084.5132" y="-599.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelUFAD.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge122" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelufad.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M900.9845,-552.6902C925.7286,-561.1949 961.195,-572.9258 992.7188,-581.6332 1002.2918,-584.2775 1012.4907,-586.8493 1022.4793,-589.2342"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1021.8318,-592.6773 1032.3668,-591.5526 1023.4298,-585.8621 1021.8318,-592.6773"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node53" class="node">
<title>sourcefile~roomairmodeldisplacementvent.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node53"><a xlink:href="../sourcefile/roomairmodeldisplacementvent.f90.html" xlink:title="RoomAirModelDisplacementVent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1176.1025,-572.6386 992.9239,-572.6386 992.9239,-550.6278 1176.1025,-550.6278 1176.1025,-572.6386"/>
<text text-anchor="middle" x="1084.5132" y="-558.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelDisplacementVent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge124" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodeldisplacementvent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M957.0044,-549.768C965.4411,-550.553 974.0488,-551.354 982.6093,-552.1506"/>
<polygon fill="#ff0000" stroke="#ff0000" points="982.3425,-555.6408 992.6238,-553.0825 982.9911,-548.6709 982.3425,-555.6408"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node54" class="node">
<title>sourcefile~roomairmodelmundt.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node54"><a xlink:href="../sourcefile/roomairmodelmundt.f90.html" xlink:title="RoomAirModelMundt.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1148.649,-531.6386 1020.3774,-531.6386 1020.3774,-509.6278 1148.649,-509.6278 1148.649,-531.6386"/>
<text text-anchor="middle" x="1084.5132" y="-517.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirModelMundt.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge126" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~roomairmodelmundt.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M957.0044,-533.0917C974.5207,-531.3802 992.7737,-529.5968 1009.8118,-527.932"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1010.6337,-531.3685 1020.2459,-526.9125 1009.9529,-524.4017 1010.6337,-531.3685"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge143" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1485.2747,-892.6332C1533.4802,-895.2777 1665.2877,-861.9069 1702.5256,-892.6332"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge137" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1485.2747,-892.6332C1538.0785,-895.5299 1550.6442,-881.7497 1603.4355,-878.6332 1691.3625,-873.4424 1718.6194,-849.1423 1801.6157,-878.6332 1848.1583,-895.171 2451.6708,-1469.0362 2491.3594,-1439.6332"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2491.3594,-1439.6332C2573.0694,-1375.7413 2634.9849,-588.4985 2645.4716,-447.2584"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2648.9898,-447.1386 2646.2334,-436.9086 2642.0087,-446.6247 2648.9898,-447.1386"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M705.1345,-711.7434C726.3442,-719.844 756.0393,-730.8868 782.4507,-739.6332 1085.925,-840.132 1166.4739,-868.9111 1485.2747,-892.6332"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge139" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M680.5688,-689.5594C692.0843,-659.162 727.9059,-573.262 782.4507,-521.6332 809.9214,-495.6311 1046.8041,-367.5951 1084.5132,-364.6332"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1084.5132,-364.6332C1567.7,-295.9189 1696.2086,-424.3083 2182.4744,-382.6332 2273.5583,-374.8269 2299.2748,-378.94 2385.1648,-347.6332 2402.568,-341.2897 2404.0765,-333.7817 2421.1648,-326.6332 2450.9812,-314.1601 2459.5162,-302.1005 2491.3594,-307.6332"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge146" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M676.9285,-689.4238C679.0546,-644.744 692.928,-477.4845 782.4507,-388.6332 882.8223,-289.0143 943.0976,-288.6332 1084.5132,-288.6332 1084.5132,-288.6332 1084.5132,-288.6332 1289.7107,-288.6332 1473.184,-288.6332 1519.2361,-280.4238 1702.5256,-288.6332"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge140" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M2301.8196,-520.6332C2381.5909,-487.8609 2349.9638,-416.2944 2421.1648,-367.6332 2424.2891,-365.4979 2427.6352,-363.5753 2431.1094,-361.8448"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2432.7948,-364.9273 2440.5406,-357.6986 2429.9776,-358.5192 2432.7948,-364.9273"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1289.7107,-440.6332C1412.4869,-453.7275 1444.1811,-440.299 1567.4355,-447.6332 1671.7893,-453.8427 1697.5753,-459.4424 1801.6157,-469.6332 1857.216,-475.0792 2250.1442,-541.8629 2301.8196,-520.6332"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1084.5132,-364.6332C1181.4677,-357.0178 1194.6051,-420.3081 1289.7107,-440.6332"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge138" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M690.1223,-689.4526C723.2118,-662.1975 808.2405,-592.1611 848.2145,-559.2354"/>
<polygon fill="#cbff00" stroke="#cbff00" points="850.5322,-561.8608 856.0258,-552.8014 846.0818,-556.4576 850.5322,-561.8608"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge142" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~roomairmodelusertemppattern.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M739.9816,-693.7062C777.628,-689.6838 826.306,-684.6366 869.5847,-680.6332"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M869.5847,-680.6332C921.9403,-675.7901 980.7384,-665.314 1023.5838,-656.7412"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1024.4625,-660.1344 1033.5693,-654.7199 1023.0737,-653.2735 1024.4625,-660.1344"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node60" class="node">
<title>sourcefile~economiclifecyclecost.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node60"><a xlink:href="../sourcefile/economiclifecyclecost.f90.html" xlink:title="EconomicLifeCycleCost.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2561.7491,-398.6386 2420.9697,-398.6386 2420.9697,-376.6278 2561.7491,-376.6278 2561.7491,-398.6386"/>
<text text-anchor="middle" x="2491.3594" y="-384.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicLifeCycleCost.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge141" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1289.7107,-440.6332C1496.4702,-457.4998 2011.2918,-524.1755 2218.4744,-534.6332 2292.4648,-538.3679 2326.2457,-579.5451 2385.1648,-534.6332 2430.6529,-499.9593 2383.1193,-450.8859 2420.2752,-406.1654"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2422.9694,-408.4104 2427.2986,-398.7404 2417.8841,-403.6 2422.9694,-408.4104"/>
</g>
<!-- sourcefile~economictariff.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node61" class="node">
<title>sourcefile~economictariff.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node61"><a xlink:href="../sourcefile/economictariff.f90.html" xlink:title="EconomicTariff.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2351.0038,-646.6386 2252.6353,-646.6386 2252.6353,-624.6278 2351.0038,-624.6278 2351.0038,-646.6386"/>
<text text-anchor="middle" x="2301.8196" y="-632.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EconomicTariff.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge144" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~economictariff.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M869.5847,-680.6332C1055.5157,-663.4339 1102.9859,-682.6332 1289.7107,-682.6332 1289.7107,-682.6332 1289.7107,-682.6332 1908.4076,-682.6332 2027.7258,-682.6332 2165.9716,-661.0544 2242.7132,-647.1398"/>
<polygon fill="#cbff00" stroke="#cbff00" points="2243.4656,-650.5603 2252.6706,-645.3146 2242.2034,-643.6751 2243.4656,-650.5603"/>
</g>
<!-- sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node62" class="node">
<title>sourcefile~thermalcomfort.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node62"><a xlink:href="../sourcefile/thermalcomfort.f90.html" xlink:title="ThermalComfort.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="922.4472,-730.6386 816.7223,-730.6386 816.7223,-708.6278 922.4472,-708.6278 922.4472,-730.6386"/>
<text text-anchor="middle" x="869.5847" y="-716.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ThermalComfort.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge145" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~thermalcomfort.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M739.7557,-706.8545C761.3032,-708.9754 785.3754,-711.3447 806.8831,-713.4617"/>
<polygon fill="#cbff00" stroke="#cbff00" points="806.5937,-716.95 816.8885,-714.4465 807.2795,-709.9837 806.5937,-716.95"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge148" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1705.816,-528.8078C1718.7776,-572.9888 1767.2776,-739.8358 1801.6157,-878.6332 1845.6605,-1056.6659 1890.3887,-1273.7393 1904.1326,-1341.4424"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1900.7193,-1342.2218 1906.1344,-1351.3282 1907.58,-1340.8325 1900.7193,-1342.2218"/>
</g>
<!-- sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge147" class="edge">
<title>sourcefile~zonecontaminantpredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1718.1102,-506.5671C1740.4336,-489.8159 1781.0793,-455.7908 1801.6157,-416.6332 1840.926,-341.6788 1778.5511,-290.2536 1837.6157,-229.6332 1894.0074,-171.7561 1934.864,-199.3507 2015.1995,-190.6332 2179.9276,-172.7578 2232.9556,-171.1562 2385.1648,-236.6332 2437.3186,-259.0686 2435.4164,-297.9509 2491.3594,-307.6332"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M2491.3594,-307.6332C2508.9289,-310.6858 2629.211,-346.5187 2647.0433,-346.6332"/>
</g>
<!-- sourcefile~returnairpath.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge149" class="edge">
<title>sourcefile~returnairpath.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M724.3822,-880.7371C831.2553,-901.0985 1080.4179,-948.6934 1084.5132,-950.6332"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge153" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1491.399,-606.6754C1514.7013,-648.0116 1601.6296,-796.1712 1702.5256,-892.6332"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1702.5256,-892.6332C1841.2681,-1025.2784 1892.3097,-1267.5991 1904.9933,-1340.9983"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1901.6113,-1341.9966 1906.7072,-1351.2854 1908.5162,-1340.8461 1901.6113,-1341.9966"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge151" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1488.6695,-606.6399C1500.2658,-644.3763 1539.153,-772.0714 1567.4355,-878.6332 1623.0459,-1088.1597 1681.1652,-1344.3025 1697.8185,-1418.5477"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1694.4492,-1419.519 1700.0494,-1428.5128 1701.2801,-1417.9897 1694.4492,-1419.519"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge152" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M2647.0433,-346.6332C2671.525,-346.7904 2698.3292,-346.8284 2722.1697,-346.8149"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="2722.1932,-350.315 2732.1901,-346.8062 2722.1871,-343.315 2722.1932,-350.315"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1543.5966,-584.4622C1552.2092,-581.0211 1560.5029,-576.5202 1567.4355,-570.6332 1595.0101,-547.2177 1584.0309,-528.1635 1603.4355,-497.6332 1679.1188,-378.5572 1721.9335,-366.0711 1801.6157,-249.6332 1819.6109,-223.3372 1811.762,-206.2583 1837.6157,-187.6332 1933.8071,-118.3364 1980.2839,-133.6332 2098.8369,-133.6332 2098.8369,-133.6332 2098.8369,-133.6332 2301.8196,-133.6332 2344.3458,-133.6332 2348.6725,-158.7976 2385.1648,-180.6332 2388.8601,-182.8443 2642.7371,-346.6055 2647.0433,-346.6332"/>
</g>
<!-- sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge150" class="edge">
<title>sourcefile~zonetemppredictorcorrector.f90&#45;&gt;sourcefile~zonecontaminantpredictorcorrector.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1523.9312,-584.552C1537.7354,-580.4157 1553.3528,-575.5298 1567.4355,-570.6332 1601.451,-558.8059 1639.5989,-543.662 1666.6586,-532.5931"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1668.1796,-535.7521 1676.0981,-528.7131 1665.5183,-529.2777 1668.1796,-535.7521"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge104" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1718.0157,-218.5166C1737.8488,-204.1121 1773.0634,-177.955 1801.6157,-153.6332 1818.3692,-139.362 1818.2488,-130.0864 1837.6157,-119.6332 1890.1181,-91.2954 2039.1751,-57.6332 2098.8369,-57.6332"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge102" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1908.4076,-288.6332C1961.0874,-303.2137 1964.2615,-329.8071 2015.1995,-349.6332 2050.7229,-363.4596 2061.0964,-363.2727 2098.8369,-368.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1738.8609,-240.667C1766.0133,-248.8454 1804.0708,-260.167 1837.6157,-269.6332 1868.9678,-278.4806 1877.0114,-279.9435 1908.4076,-288.6332"/>
</g>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node55" class="node">
<title>sourcefile~solarshading.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node55"><a xlink:href="../sourcefile/solarshading.f90.html" xlink:title="SolarShading.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2144.8978,-221.6386 2052.7761,-221.6386 2052.7761,-199.6278 2144.8978,-199.6278 2144.8978,-221.6386"/>
<text text-anchor="middle" x="2098.8369" y="-207.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarShading.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge103" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1764.0144,-226.6853C1840.2214,-223.0318 1969.0085,-216.8574 2042.6672,-213.3261"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2042.8628,-216.8208 2052.6837,-212.8459 2042.5275,-209.8289 2042.8628,-216.8208"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node56" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node56"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1978.9919,-260.6386 1837.8232,-260.6386 1837.8232,-238.6278 1978.9919,-238.6278 1978.9919,-260.6386"/>
<text text-anchor="middle" x="1908.4076" y="-246.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge105" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1763.7396,-235.5797C1783.7956,-237.528 1806.3953,-239.7234 1827.667,-241.7898"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1827.3667,-245.277 1837.6582,-242.7604 1828.0435,-238.3098 1827.3667,-245.277"/>
</g>
<!-- sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node59" class="node">
<title>sourcefile~roomairmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node59"><a xlink:href="../sourcefile/roomairmanager.f90.html" xlink:title="RoomAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1345.4328,-606.6386 1233.9885,-606.6386 1233.9885,-584.6278 1345.4328,-584.6278 1345.4328,-606.6386"/>
<text text-anchor="middle" x="1289.7107" y="-592.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RoomAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge107" class="edge">
<title>sourcefile~roomairmodelcrossvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1158.3377,-490.2937C1164.7705,-493.0265 1170.8848,-496.4215 1176.3076,-500.6332 1203.9376,-522.0922 1185.6427,-547.9863 1212.3076,-570.6332 1216.7896,-574.4398 1221.8614,-577.6695 1227.2126,-580.4092"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1225.8731,-583.6446 1236.4272,-584.5728 1228.7555,-577.2656 1225.8731,-583.6446"/>
</g>
<!-- sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge108" class="edge">
<title>sourcefile~roomairmodelusertemppattern.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1133.1238,-632.5967C1147.0729,-629.4068 1162.2978,-625.9034 1176.3076,-622.6332 1195.0153,-618.2663 1215.441,-613.4258 1233.7385,-609.0631"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1234.7464,-612.421 1243.6605,-606.6947 1233.1211,-605.6123 1234.7464,-612.421"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge109" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1527.7665,-260.7171C1571.2891,-271.2503 1641.0835,-285.8813 1702.5256,-288.6332"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1702.5256,-288.6332C1793.9371,-292.7274 1820.22,-264.225 1908.4076,-288.6332"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge110" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1540.3771,-244.5605C1567.9274,-242.0242 1601.6016,-238.9242 1631.1092,-236.2077"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1631.7188,-239.6665 1641.3558,-235.2645 1631.077,-232.696 1631.7188,-239.6665"/>
</g>
<!-- sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge111" class="edge">
<title>sourcefile~roomairmodelufad.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1148.0337,-600.4663C1172.0306,-599.6477 1199.3807,-598.7147 1223.6086,-597.8882"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1223.9072,-601.3801 1233.782,-597.5411 1223.6685,-594.3842 1223.9072,-601.3801"/>
</g>
<!-- sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge112" class="edge">
<title>sourcefile~roomairmodeldisplacementvent.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1151.1349,-572.672C1174.479,-576.54 1200.6681,-580.8794 1223.9419,-584.7357"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1223.6263,-588.2311 1234.064,-586.4129 1224.7706,-581.3252 1223.6263,-588.2311"/>
</g>
<!-- sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge113" class="edge">
<title>sourcefile~roomairmodelmundt.f90&#45;&gt;sourcefile~roomairmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1148.9958,-531.4631C1158.3982,-534.1555 1167.7758,-537.496 1176.3076,-541.6332 1194.7944,-550.5978 1194.2307,-560.8686 1212.3076,-570.6332 1219.8091,-574.6852 1228.0774,-578.2165 1236.3337,-581.2473"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1235.379,-584.6204 1245.9737,-584.5765 1237.664,-578.0038 1235.379,-584.6204"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2144.9854,-217.1765C2186.5229,-223.6656 2248.9737,-234.9156 2301.8196,-250.6332"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2301.8196,-250.6332C2338.7675,-261.6224 2348.2361,-263.5797 2385.1648,-274.6332 2432.5132,-288.8055 2442.6595,-299.2045 2491.3594,-307.6332"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2128.3864,-199.5907C2227.7683,-164.3344 2556.8805,-62.9675 2792.235,-171.6332"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2116.3633,-221.6801C2133.6763,-232.8453 2160.656,-250.9323 2182.4744,-268.6332 2199.5652,-282.4986 2199.4208,-291.6192 2218.4744,-302.6332 2225.7126,-306.8173 2233.7165,-310.3607 2241.8167,-313.3449"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2240.7352,-316.674 2251.3298,-316.5961 2242.9991,-310.0502 2240.7352,-316.674"/>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2301.8196,-250.6332C2338.7675,-261.6224 2353.3233,-252.9069 2385.1648,-274.6332 2406.8997,-289.4635 2399.8982,-306.1387 2421.1648,-321.6332 2426.3795,-325.4326 2432.2267,-328.7004 2438.2619,-331.4997"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2437.2617,-334.8757 2447.8368,-335.5218 2439.9727,-328.422 2437.2617,-334.8757"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge101" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2098.8369,-368.6332C2128.0355,-372.7804 2203.1768,-354.7727 2253.3821,-341.3036"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2254.3333,-344.6722 2263.0696,-338.6782 2252.5023,-337.9159 2254.3333,-344.6722"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1956.1959,-260.7009C1964.516,-264.1747 1972.603,-268.7135 1979.1995,-274.6332 2006.7179,-299.3282 1986.2947,-326.5762 2015.1995,-349.6332 2044.9993,-373.4041 2061.0964,-363.2727 2098.8369,-368.6332"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge99" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2301.8196,-288.6332C2339.0821,-296.0458 2348.8412,-296.4959 2385.1648,-307.6332 2401.5779,-312.6657 2405.077,-315.6416 2421.1648,-321.6332 2430.5222,-325.1182 2440.6182,-328.7744 2450.1568,-332.1818"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2449.2462,-335.5726 2459.8409,-335.6249 2451.5913,-328.9771 2449.2462,-335.5726"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1978.993,-252.645C2034.4471,-255.4649 2113.5573,-260.4891 2182.4744,-268.6332 2235.8847,-274.9448 2249.0712,-278.14 2301.8196,-288.6332"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge98" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1962.2134,-238.6137C1987.3612,-233.4635 2017.2953,-227.333 2042.7254,-222.1249"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2043.4982,-225.5393 2052.5926,-220.104 2042.0937,-218.6817 2043.4982,-225.5393"/>
</g>
<!-- sourcefile~windowmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node57" class="node">
<title>sourcefile~windowmanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node57"><a xlink:href="../sourcefile/windowmanager.f90.html" xlink:title="WindowManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2152.5626,-299.6386 2045.1112,-299.6386 2045.1112,-277.6278 2152.5626,-277.6278 2152.5626,-299.6386"/>
<text text-anchor="middle" x="2098.8369" y="-285.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge97" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~windowmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1962.2134,-260.6526C1984.829,-265.2843 2011.3155,-270.7088 2034.9159,-275.5421"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2034.3351,-278.9958 2044.834,-277.5734 2035.7396,-272.1381 2034.3351,-278.9958"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node58" class="node">
<title>sourcefile~heatbalanceintradexchange.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node58"><a xlink:href="../sourcefile/heatbalanceintradexchange.f90.html" xlink:title="HeatBalanceIntRadExchange.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2182.612,-340.6386 2015.0618,-340.6386 2015.0618,-318.6278 2182.612,-318.6278 2182.612,-340.6386"/>
<text text-anchor="middle" x="2098.8369" y="-326.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceIntRadExchange.f90</text>
</a>
</g>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge100" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~heatbalanceintradexchange.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1949.0503,-260.7297C1959.2786,-264.3857 1969.9662,-268.9956 1979.1995,-274.6332 1997.9829,-286.1018 1995.9007,-298.0547 2015.1995,-308.6332 2019.6795,-311.0889 2024.4512,-313.263 2029.3574,-315.187"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2028.3219,-318.5335 2038.9166,-318.587 2030.6677,-311.9382 2028.3219,-318.5335"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge95" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2152.6996,-298.9821C2177.7987,-303.8045 2207.9238,-309.5926 2234.5069,-314.7001"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2234.023,-318.1711 2244.5038,-316.6208 2235.3439,-311.2968 2234.023,-318.1711"/>
</g>
<!-- sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge94" class="edge">
<title>sourcefile~windowmanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2152.8186,-282.948C2194.0455,-279.97 2252.0491,-278.7324 2301.8196,-288.6332"/>
</g>
<!-- sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge96" class="edge">
<title>sourcefile~heatbalanceintradexchange.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2182.5696,-328.8082C2191.1253,-328.7239 2199.8548,-328.6379 2208.5045,-328.5526"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2208.6417,-332.0515 2218.6067,-328.4531 2208.5727,-325.0519 2208.6417,-332.0515"/>
</g>
<!-- sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge106" class="edge">
<title>sourcefile~roomairmanager.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1345.4898,-595.6332C1360.2617,-595.6332 1376.6126,-595.6332 1392.7707,-595.6332"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1392.7908,-599.1333 1402.7907,-595.6332 1392.7907,-592.1333 1392.7908,-599.1333"/>
</g>
<!-- sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge127" class="edge">
<title>sourcefile~economiclifecyclecost.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2528.9883,-376.6197C2571.1691,-364.4497 2635.2347,-346.5573 2647.0433,-346.6332"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge130" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2351.1537,-629.9393C2363.7477,-626.2515 2376.2342,-620.2755 2385.1648,-610.6332 2436.1679,-555.5654 2369.4209,-500.0055 2421.1648,-445.6332 2465.7268,-398.8077 2503.1269,-435.2859 2561.554,-407.6332 2603.7434,-387.6656 2600.3682,-346.3334 2647.0433,-346.6332"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge128" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2314.1639,-624.5285C2332.6107,-607.2093 2367.126,-571.8699 2385.1648,-534.6332 2418.267,-466.3018 2369.6207,-423.384 2421.1648,-367.6332 2422.5572,-366.1271 2424.0528,-364.7274 2425.6329,-363.4268"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2427.7962,-366.1902 2434.1524,-357.7138 2423.8976,-360.3763 2427.7962,-366.1902"/>
</g>
<!-- sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge129" class="edge">
<title>sourcefile~economictariff.f90&#45;&gt;sourcefile~economiclifecyclecost.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2350.9415,-630.2677C2363.6858,-626.5936 2376.3034,-620.5428 2385.1648,-610.6332 2444.7858,-543.9599 2363.2539,-480.7971 2421.1648,-412.6332 2423.9916,-409.3059 2427.2932,-406.4213 2430.8951,-403.9207"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2432.8837,-406.8128 2439.7626,-398.7548 2429.3601,-400.7643 2432.8837,-406.8128"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge135" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M870.9578,-731.0192C880.1044,-805.7915 933.6603,-1227.0194 992.7188,-1340.6332 1009.4318,-1372.7849 1040.2139,-1401.6369 1061.4958,-1419.1257"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1059.4213,-1421.9484 1069.4135,-1425.4707 1063.7988,-1416.486 1059.4213,-1421.9484"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge133" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1084.5132,-720.6332C1590.0645,-692.3488 1734.71,-653.0423 2182.4744,-416.6332 2220.3376,-396.6423 2259.1722,-365.2563 2281.8666,-345.5934"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2284.2596,-348.15 2289.4657,-338.9224 2279.6415,-342.8894 2284.2596,-348.15"/>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge134" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~zonetemppredictorcorrector.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M922.6976,-722.6446C966.267,-724.4512 1029.5076,-725.5544 1084.5132,-720.6332"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1084.5132,-720.6332C1226.6982,-707.9122 1385.9107,-641.4836 1452.8617,-610.9781"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1454.4347,-614.1072 1462.0572,-606.7487 1451.5096,-607.7476 1454.4347,-614.1072"/>
</g>
<!-- sourcefile~weathermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node63" class="node">
<title>sourcefile~weathermanager.f90</title>
<g id="a_sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_node63"><a xlink:href="../sourcefile/weathermanager.f90.html" xlink:title="WeatherManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2546.2381,-476.6386 2436.4806,-476.6386 2436.4806,-454.6278 2546.2381,-454.6278 2546.2381,-476.6386"/>
<text text-anchor="middle" x="2491.3594" y="-462.4832" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WeatherManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge136" class="edge">
<title>sourcefile~thermalcomfort.f90&#45;&gt;sourcefile~weathermanager.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.5945,-730.7461C932.7769,-734.3481 945.495,-738.9287 956.7188,-744.6332 974.7886,-753.8172 973.8268,-765.2875 992.7188,-772.6332 1116.1436,-820.6243 1157.284,-796.6332 1289.7107,-796.6332 1289.7107,-796.6332 1289.7107,-796.6332 2098.8369,-796.6332 2240.6869,-796.6332 2282.2841,-753.2906 2385.1648,-655.6332 2437.5236,-605.9327 2470.8753,-524.6019 2484.4301,-486.5263"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2487.7652,-487.591 2487.7276,-476.9962 2481.15,-485.302 2487.7652,-487.591"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge131" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2534.3128,-454.5971C2552.7838,-449.8514 2574.5593,-444.2566 2594.0226,-439.2559"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2595.1456,-442.5811 2603.9601,-436.7026 2593.4036,-435.8013 2595.1456,-442.5811"/>
</g>
<!-- sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacwatercoilcomponent.f90~~AfferentGraph_edge132" class="edge">
<title>sourcefile~weathermanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2533.059,-454.565C2542.8546,-450.9616 2552.9399,-446.3692 2561.554,-440.6332 2608.558,-409.3339 2590.5731,-346.2705 2647.0433,-346.6332"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacwatercoilcomponentf90AfferentGraph = svgPanZoom('#sourcefilehvacwatercoilcomponentf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/watercoils.html">WaterCoils</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html#src">HVACWaterCoilComponent.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">WaterCoils</span>
<a name="ln-2"></a>  <span class="c">! Module containing the WaterCoil simulation routines</span>
<a name="ln-3"></a>
<a name="ln-4"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-5"></a>  <span class="c">!       AUTHOR         Richard J. Liesen</span>
<a name="ln-6"></a>  <span class="c">!       DATE WRITTEN   April 1998</span>
<a name="ln-7"></a>  <span class="c">!       MODIFIED       April 2004: Rahul Chillar</span>
<a name="ln-8"></a>  <span class="c">!                      Feb. 2010, Brent Griffith, Plant Demand Side Update, general fluid properties</span>
<a name="ln-9"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10"></a>
<a name="ln-11"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-12"></a>  <span class="c">! To encapsulate the data and algorithms required to</span>
<a name="ln-13"></a>  <span class="c">! manage the WaterCoil System Component</span>
<a name="ln-14"></a>
<a name="ln-15"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-16"></a>  <span class="c">!</span>
<a name="ln-17"></a>
<a name="ln-18"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-19"></a>
<a name="ln-20"></a>
<a name="ln-21"></a>  <span class="c">! OTHER NOTES:</span>
<a name="ln-22"></a>  <span class="c">!</span>
<a name="ln-23"></a>
<a name="ln-24"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-25"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-26"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-27"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-28"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-29"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-30"></a><span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">StdBaroPress</span><span class="p">,</span> <span class="n">StdRhoAir</span>
<a name="ln-31"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span>
<a name="ln-32"></a><span class="k">USe </span><span class="n">Psychrometrics</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">,</span> <span class="n">PsyHFnTdbW</span><span class="p">,</span> <span class="n">PsyTdpFnWPb</span><span class="p">,</span> <span class="n">PsyWFnTdbH</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-33"></a>                           <span class="n">PsyWFnTdpPb</span><span class="p">,</span> <span class="n">PsyTdbFnHW</span><span class="p">,</span> <span class="n">PsyWFnTdbRhPb</span><span class="p">,</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-34"></a>                           <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">,</span> <span class="n">PsyHFnTdbRhPb</span><span class="p">,</span> <span class="n">PsyTsatFnHPb</span>
<a name="ln-35"></a><span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">,</span> <span class="n">GetDensityGlycol</span>
<a name="ln-36"></a><span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_CoilWaterCooling</span><span class="p">,</span> <span class="n">TypeOf_CoilWaterDetailedFlatCooling</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-37"></a>                           <span class="n">TypeOf_CoilWaterSimpleHeating</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">MyPlantSizingIndex</span>
<a name="ln-38"></a>
<a name="ln-39"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-40"></a><span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-41"></a>
<a name="ln-42"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-43"></a>
<a name="ln-44"></a><span class="c">!PRIVATE ! Everything private unless explicitly made public</span>
<a name="ln-45"></a>
<a name="ln-46"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-47"></a>
<a name="ln-48"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxPolynomOrder</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-49"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxOrderedPairs</span> <span class="o">=</span> <span class="mi">60</span>
<a name="ln-50"></a>
<a name="ln-51"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PolyConvgTol</span> <span class="o">=</span> <span class="mf">1.D-05</span>
<a name="ln-52"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MinWaterMassFlowFrac</span> <span class="o">=</span> <span class="mf">0.000001d0</span>
<a name="ln-53"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MinAirMassFlow</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="c">! coil types in this module</span>
<a name="ln-56"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WaterCoil_SimpleHeating</span>    <span class="o">=</span> <span class="n">TypeOf_CoilWaterSimpleHeating</span>
<a name="ln-57"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WaterCoil_DetFlatFinCooling</span>  <span class="o">=</span> <span class="n">TypeOf_CoilWaterDetailedFlatCooling</span>
<a name="ln-58"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WaterCoil_Cooling</span>  <span class="o">=</span> <span class="n">TypeOf_CoilWaterCooling</span>
<a name="ln-59"></a>
<a name="ln-60"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoilType_Cooling</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-61"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoilType_Heating</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-62"></a>
<a name="ln-63"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoilModel_Simple</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-64"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoilModel_Cooling</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-65"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoilModel_Detailed</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-66"></a>
<a name="ln-67"></a><span class="c">! Parameters for Heat Exchanger Configuration</span>
<a name="ln-68"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CounterFlow</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-69"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CrossFlow</span>   <span class="o">=</span> <span class="mi">2</span>
<a name="ln-70"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SimpleAnalysis</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-71"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DetailedAnalysis</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-72"></a>
<a name="ln-73"></a><span class="c">!Water Systems</span>
<a name="ln-74"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CondensateDiscarded</span> <span class="o">=</span> <span class="mi">1001</span> <span class="c">! default mode where water is &quot;lost&quot;</span>
<a name="ln-75"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CondensateToTank</span>    <span class="o">=</span> <span class="mi">1002</span> <span class="c">! collect coil condensate from air and store in water storage tank</span>
<a name="ln-76"></a>
<a name="ln-77"></a><span class="c">!Parameters for COIL:Water:SimpleHeating Coil Performance Input Method</span>
<a name="ln-78"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UAandFlow</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! for Coil Performance Input Method = UA and Design Water Flow Rate</span>
<a name="ln-79"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NomCap</span>    <span class="o">=</span> <span class="mi">2</span> <span class="c">! for Coil Performance Input Method = Nominal Capacity</span>
<a name="ln-80"></a>
<a name="ln-81"></a><span class="c">! Parameters Subroutine CoolingCoil: design calc or simulation calc.</span>
<a name="ln-82"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DesignCalc</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! ignore on/off check in CoolingCoil</span>
<a name="ln-83"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SimCalc</span> <span class="o">=</span> <span class="mi">2</span>    <span class="c">! pay attention to on/off check in CoolingCoil</span>
<a name="ln-84"></a>
<a name="ln-85"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-86"></a><span class="k">TYPE </span><span class="n">WaterCoilEquipConditions</span>
<a name="ln-87"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>           <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Name of the WaterCoil</span>
<a name="ln-88"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">WaterCoilTypeA</span>  <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Type of WaterCoil ie. Heating or Cooling</span>
<a name="ln-89"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">WaterCoilModelA</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! Type of WaterCoil ie. Simple, Detailed, etc.</span>
<a name="ln-90"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterCoilType</span>                  <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Type of WaterCoil ie. Heating or Cooling</span>
<a name="ln-91"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterCoilModel</span>                 <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Type of WaterCoil ie. Simple, Detailed, etc.</span>
<a name="ln-92"></a>  <span class="kt">INTEGER</span>                   <span class="kd">::</span> <span class="n">WaterCoilType_Num</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-93"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Schedule</span>       <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! WaterCoil Operation Schedule</span>
<a name="ln-94"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SchedPtr</span>                       <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Pointer to the correct schedule</span>
<a name="ln-95"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">RequestingAutoSize</span>             <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! True if this coil has appropriate autosize fields</span>
<a name="ln-96"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletAirMassFlowRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! MassFlow through the WaterCoil being Simulated [kg/s]</span>
<a name="ln-97"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletAirMassFlowRate</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! MassFlow throught the WaterCoil being Simulated[kg/s]</span>
<a name="ln-98"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletAirTemp</span>                   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Inlet Air Temperature Operating Condition [C]</span>
<a name="ln-99"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletAirTemp</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Outlet Air Temperature Operating Condition [C]</span>
<a name="ln-100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletAirHumRat</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Inlet Air Humidity Ratio Operating Condition</span>
<a name="ln-101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletAirHumRat</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Outlet Air Humidity Ratio Calculated Condition</span>
<a name="ln-102"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Inlet Air enthalpy [J/kg]</span>
<a name="ln-103"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Outlet Air enthalpy [J/kg]</span>
<a name="ln-104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotWaterCoilLoad</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Total Load on the Coil [W]</span>
<a name="ln-105"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SenWaterCoilLoad</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Sensible Load on the Coil [W]</span>
<a name="ln-106"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotWaterHeatingCoilEnergy</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Total Heating Coil energy of the Coil [J]</span>
<a name="ln-107"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotWaterCoolingCoilEnergy</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Total Cooling Coil energy of the Coil [J]</span>
<a name="ln-108"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SenWaterCoolingCoilEnergy</span>      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Sensible Cooling Coil energy of the Coil [J]</span>
<a name="ln-109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesWaterHeatingCoilRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design Heating Coil Rate used for sizing [W]</span>
<a name="ln-110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotWaterHeatingCoilRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Total Heating Coil Rate on the Coil [W]</span>
<a name="ln-111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesWaterCoolingCoilRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design Cooling Coil Rate used for sizing [W]</span>
<a name="ln-112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotWaterCoolingCoilRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Total Cooling Coil Rate on the Coil [W]</span>
<a name="ln-113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SenWaterCoolingCoilRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Sensible Cooling Coil Rate on the Coil [W]</span>
<a name="ln-114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UACoil</span>                         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! WaterCoil UA Value</span>
<a name="ln-115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LeavingRelHum</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Simple Coil Latent Model requires User input for leaving RH</span>
<a name="ln-116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesiredOutletTemp</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-117"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesiredOutletHumRat</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-118"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletWaterTemp</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Inlet Water Temperature [C]</span>
<a name="ln-119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletWaterTemp</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Outlet Water Temperature [C]</span>
<a name="ln-120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletWaterMassFlowRate</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Inlet Water Mass Flow Rate [Kg/s]</span>
<a name="ln-121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletWaterMassFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Outlet Water Mass Flow Rate [Kg/s]</span>
<a name="ln-122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxWaterVolFlowRate</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum water Volume flow rate [m3/s]</span>
<a name="ln-123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxWaterMassFlowRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Maximum water mass flow rate [Kg/s]</span>
<a name="ln-124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletWaterEnthalpy</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Inlet Water Enthalpy</span>
<a name="ln-125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutletWaterEnthalpy</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Outlet Water Enthalpy</span>
<a name="ln-126"></a>  <span class="c">!These are the additional Geometry and Design Variables for Detailed Flat Fin Coil</span>
<a name="ln-127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TubeOutsideSurfArea</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Tube Primary Surface Area</span>
<a name="ln-128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotTubeInsideArea</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Total Tube inside Surface Area</span>
<a name="ln-129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FinSurfArea</span>                    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Fin Surface Area</span>
<a name="ln-130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MinAirFlowArea</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-131"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoilDepth</span>                      <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-132"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FinDiam</span>                        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Fin Diameter or the Coil Height</span>
<a name="ln-133"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FinThickness</span>                   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-134"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TubeInsideDiam</span>                 <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Inner diameter of Tubes</span>
<a name="ln-135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TubeOutsideDiam</span>                <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Outer Diameter of the Tubes</span>
<a name="ln-136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TubeThermConductivity</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FinThermConductivity</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FinSpacing</span>                     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Fin Spacing or Distance</span>
<a name="ln-139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TubeDepthSpacing</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-140"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">NumofTubeRows</span>                  <span class="o">=</span> <span class="mi">0</span>   <span class="c">!</span>
<a name="ln-141"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">NumofTubesperRow</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">!</span>
<a name="ln-142"></a>  <span class="c">!BEGIN calculated parameters for detailed flat fin coil</span>
<a name="ln-143"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EffectiveFinDiam</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-144"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TotCoilOutsideSurfArea</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-145"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoilEffectiveInsideDiam</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">GeometryCoef1</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">GeometryCoef2</span>                  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DryFinEfficncyCoef</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-149"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SatEnthlCurveConstCoef</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SatEnthlCurveSlope</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnthVsTempCurveAppxSlope</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnthVsTempCurveConst</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-153"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MeanWaterTempSaved</span>             <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InWaterTempSaved</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OutWaterTempSaved</span>              <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SurfAreaWetSaved</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SurfAreaWetFraction</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!</span>
<a name="ln-158"></a>  <span class="c">!END calculated parameters for detailed flat fin coil</span>
<a name="ln-159"></a>  <span class="c">! Design Input Variables to the Design Detailed Simple inputs model</span>
<a name="ln-160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesInletWaterTemp</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Entering water temperature at Design(C)</span>
<a name="ln-161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesAirVolFlowRate</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Entering Air Volume Flow Rate Design( m3/s)</span>
<a name="ln-162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesInletAirTemp</span>           <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Entering air dry bulb temperature at Design(C)</span>
<a name="ln-163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesInletAirHumRat</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Entering air humidity ratio at design conditions</span>
<a name="ln-164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesTotWaterCoilLoad</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Total heat transfer rate at Design(Watt)</span>
<a name="ln-165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesSenWaterCoilLoad</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Sensible heat transfer rate at Design(Watt)</span>
<a name="ln-166"></a>  <span class="c">!BEGIN calculated parameters for Design Detailed Simple inputs model</span>
<a name="ln-167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesAirMassFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Design Air MassFlow through the WaterCoil [kg/Sec]</span>
<a name="ln-168"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UACoilTotal</span>               <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Overall external dry UA (W/C)</span>
<a name="ln-169"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UACoilInternal</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Overall internal UA(W/C)</span>
<a name="ln-170"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UACoilExternal</span>            <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Overall external heat transfer coefficient(W/C)</span>
<a name="ln-171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UACoilInternalDes</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Overall design internal UA(W/C)</span>
<a name="ln-172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UACoilExternalDes</span>         <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Overall design external heat transfer coefficient(W/C)</span>
<a name="ln-173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesOutletAirTemp</span>          <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Leaving air temperature at rating(C)</span>
<a name="ln-174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesOutletAirHumRat</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Humidity ratio of air leaving at design capacity.</span>
<a name="ln-175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesOutletWaterTemp</span>        <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Temp of Liquid Leaving the Coil at design Capacity</span>
<a name="ln-176"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatExchType</span>              <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Heat exchanger configuration, default to Cross Flow</span>
<a name="ln-177"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolingCoilAnalysisMode</span>   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Mode Of analysis, Simple=1 and Detailed =2</span>
<a name="ln-178"></a>                                                  <span class="c">!    Simple= AllWet-AllDry, Detailed= PartWet-PartDry</span>
<a name="ln-179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UACoilInternalPerUnitArea</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Internal overall heat transfer coefficient(W/m2 C)</span>
<a name="ln-180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UAWetExtPerUnitArea</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! External overall heat transfer coefficient(W/m2 C)</span>
<a name="ln-181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UADryExtPerUnitArea</span>       <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! External overall heat transfer coefficient(W/m2 C)</span>
<a name="ln-182"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SurfAreaWetFractionSaved</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Previous saved value, for numerical efficiency.</span>
<a name="ln-183"></a>  <span class="c">!END calculated parameters for Design Inputs Detailed coil</span>
<a name="ln-184"></a>
<a name="ln-185"></a>  <span class="c">! variables for simple heating coil with variable UA</span>
<a name="ln-186"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">UACoilVariable</span>                 <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! WaterCoil UA value when variable (simple heating coil only)</span>
<a name="ln-187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">RatioAirSideToWaterSideConvect</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="c">!&quot;r&quot; value for coil,</span>
<a name="ln-188"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirSideNominalConvect</span>          <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! nominal rating point air side convection term (fin_effic*(hc*A))</span>
<a name="ln-189"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LiquidSideNominalConvect</span>       <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! nominal rating point water side convection term (hc*A)</span>
<a name="ln-190"></a>
<a name="ln-191"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">Control</span>                        <span class="o">=</span> <span class="mi">0</span>   <span class="c">!Const Vol =1;  Variable Vol = 2</span>
<a name="ln-192"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">AirInletNodeNum</span>                <span class="o">=</span> <span class="mi">0</span>   <span class="c">!</span>
<a name="ln-193"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">AirOutletNodeNum</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">!</span>
<a name="ln-194"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterInletNodeNum</span>              <span class="o">=</span> <span class="mi">0</span>   <span class="c">!</span>
<a name="ln-195"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterOutletNodeNum</span>             <span class="o">=</span> <span class="mi">0</span>   <span class="c">!</span>
<a name="ln-196"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterLoopNum</span>                   <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Plant loop index</span>
<a name="ln-197"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterLoopSide</span>                  <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Plant loop side index</span>
<a name="ln-198"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterLoopBranchNum</span>             <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Plant loop branch index</span>
<a name="ln-199"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WaterLoopCompNum</span>               <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Plant loop Comp index</span>
<a name="ln-200"></a>
<a name="ln-201"></a>  <span class="c">!begin variables for Water System interactions</span>
<a name="ln-202"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">CondensateCollectMode</span>                 <span class="o">=</span> <span class="n">CondensateDiscarded</span> <span class="c">!  where does water come from</span>
<a name="ln-203"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! name of water source e.g. water storage tank</span>
<a name="ln-204"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">CondensateTankID</span>                      <span class="o">=</span> <span class="mi">0</span> <span class="c">!index &quot;pointer&quot; to Storage TAnk array WaterStorage</span>
<a name="ln-205"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span><span class="n">CondensateTankSupplyARRID</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">!index pointe to supply Vdot array in WaterStorage</span>
<a name="ln-206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CondensateVdot</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! rate of water condensation from air stream [m3/s]</span>
<a name="ln-207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CondensateVol</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! amount of water condensed from air stream [m3]</span>
<a name="ln-208"></a>  <span class="c">!end variables for water system interactions</span>
<a name="ln-209"></a>
<a name="ln-210"></a>  <span class="c">!COIL:Water:SimpleHeating Coil Performance Input Method</span>
<a name="ln-211"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoilPerfInpMeth</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! 1 = UA and Design Water Flow Rate; 2 = Nominal Capacity</span>
<a name="ln-212"></a>
<a name="ln-213"></a><span class="k">END TYPE </span><span class="n">WaterCoilEquipConditions</span>
<a name="ln-214"></a>
<a name="ln-215"></a>  <span class="c">!MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-216"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumWaterCoils</span> <span class="o">=</span><span class="mi">0</span>  <span class="c">! The Number of WaterCoils found in the Input</span>
<a name="ln-217"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">WaterCoilEquipConditions</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WaterCoil</span>
<a name="ln-218"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeFlag</span>
<a name="ln-219"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyUAAndFlowCalcFlag</span>
<a name="ln-220"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyCoilDesignFlag</span>
<a name="ln-221"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CoilWarningOnceFlag</span>
<a name="ln-222"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WaterTempCoolCoilErrs</span>  <span class="c">! error counting for detailed coils</span>
<a name="ln-223"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">PartWetCoolCoilErrs</span>    <span class="c">! error counting for detailed coils</span>
<a name="ln-224"></a>  <span class="kt">Logical</span>        <span class="kd">::</span> <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span> <span class="c">! Flag set to make sure you get input once</span>
<a name="ln-225"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-226"></a>
<a name="ln-227"></a><span class="c">! Subroutine Specifications for the Module</span>
<a name="ln-228"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-229"></a><span class="k">PUBLIC  </span><span class="n">SimulateWaterCoilComponents</span>
<a name="ln-230"></a>
<a name="ln-231"></a>          <span class="c">! Get Input routines for module</span>
<a name="ln-232"></a><span class="k">PRIVATE </span><span class="n">GetWaterCoilInput</span>
<a name="ln-233"></a>
<a name="ln-234"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-235"></a><span class="k">PRIVATE </span><span class="n">InitWaterCoil</span>
<a name="ln-236"></a><span class="k">PRIVATE </span><span class="n">SizeWaterCoil</span>
<a name="ln-237"></a>
<a name="ln-238"></a>          <span class="c">! Algorithms for the module</span>
<a name="ln-239"></a><span class="k">PRIVATE </span><span class="n">CalcSimpleHeatingCoil</span>
<a name="ln-240"></a><span class="k">PRIVATE </span><span class="n">CalcDetailFlatFinCoolingCoil</span>
<a name="ln-241"></a><span class="k">PRIVATE </span><span class="n">CoolingCoil</span>
<a name="ln-242"></a>
<a name="ln-243"></a>          <span class="c">! Update routine to check convergence and update nodes</span>
<a name="ln-244"></a><span class="k">PRIVATE </span><span class="n">UpdateWaterCoil</span>
<a name="ln-245"></a>
<a name="ln-246"></a>          <span class="c">! Reporting routines for module</span>
<a name="ln-247"></a><span class="k">PRIVATE </span><span class="n">ReportWaterCoil</span>
<a name="ln-248"></a>
<a name="ln-249"></a>          <span class="c">! Other routines</span>
<a name="ln-250"></a><span class="k">PRIVATE </span><span class="n">SimpleHeatingCoilUAResidual</span>
<a name="ln-251"></a><span class="k">PRIVATE </span><span class="n">SimpleCoolingCoilUAResidual</span>
<a name="ln-252"></a><span class="k">PUBLIC  </span><span class="n">CheckWaterCoilSchedule</span>
<a name="ln-253"></a><span class="k">PUBLIC  </span><span class="n">GetCoilMaxWaterFlowRate</span>
<a name="ln-254"></a><span class="k">PUBLIC  </span><span class="n">GetCoilInletNode</span>
<a name="ln-255"></a><span class="k">PUBLIC  </span><span class="n">GetCoilOutletNode</span>
<a name="ln-256"></a><span class="k">PUBLIC  </span><span class="n">GetCoilWaterInletNode</span>
<a name="ln-257"></a><span class="k">PUBLIC  </span><span class="n">GetCoilWaterOutletNode</span>
<a name="ln-258"></a><span class="k">PUBLIC  </span><span class="n">UpdateWaterToAirCoilPlantConnection</span>  <span class="c">!DSU3</span>
<a name="ln-259"></a><span class="k">PRIVATE </span><span class="n">EstimateHEXSurfaceArea</span>
<a name="ln-260"></a><span class="k">PUBLIC  </span><span class="n">GetWaterCoilIndex</span>
<a name="ln-261"></a><span class="k">PUBLIC  </span><span class="n">GetWaterCoilCapacity</span>
<a name="ln-262"></a><span class="k">PUBLIC  </span><span class="n">CheckForSensorAndSetpointNode</span>
<a name="ln-263"></a><span class="k">PUBLIC  </span><span class="n">GetWaterCoilAvailScheduleIndex</span>
<a name="ln-264"></a>
<a name="ln-265"></a><span class="k">CONTAINS</span>
<a name="ln-266"></a>
<a name="ln-267"></a><span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-268"></a><span class="c">!*************************************************************************</span>
<a name="ln-269"></a><span class="k">SUBROUTINE </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-270"></a>
<a name="ln-271"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-272"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-273"></a>          <span class="c">!       DATE WRITTEN   February 1998</span>
<a name="ln-274"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-275"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-276"></a>
<a name="ln-277"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-278"></a>          <span class="c">! This subroutine manages WaterCoil component simulation.</span>
<a name="ln-279"></a>
<a name="ln-280"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-281"></a>          <span class="c">! na</span>
<a name="ln-282"></a>
<a name="ln-283"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-284"></a>          <span class="c">! na</span>
<a name="ln-285"></a>
<a name="ln-286"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-287"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-288"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-289"></a>
<a name="ln-290"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-291"></a>
<a name="ln-292"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-293"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-294"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-295"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-296"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">QActual</span>
<a name="ln-297"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-298"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">OPTIONAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-299"></a>
<a name="ln-300"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-301"></a>          <span class="c">! na</span>
<a name="ln-302"></a>
<a name="ln-303"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-304"></a>          <span class="c">! na</span>
<a name="ln-305"></a>
<a name="ln-306"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-307"></a>          <span class="c">! na</span>
<a name="ln-308"></a>
<a name="ln-309"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-310"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">CoilNum</span>      <span class="c">! The WaterCoil that you are currently loading input into</span>
<a name="ln-311"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">OpMode</span>       <span class="c">! fan operating mode</span>
<a name="ln-312"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">PartLoadFrac</span> <span class="c">! part-load fraction of heating coil</span>
<a name="ln-313"></a>
<a name="ln-314"></a>          <span class="c">! FLOW:</span>
<a name="ln-315"></a>
<a name="ln-316"></a>  <span class="c">! Obtains and Allocates WaterCoil related parameters from input file</span>
<a name="ln-317"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-318"></a>    <span class="k">CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-319"></a>    <span class="n">GetWaterCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-320"></a>  <span class="k">End If</span>
<a name="ln-321"></a>
<a name="ln-322"></a>
<a name="ln-323"></a>  <span class="c">! Find the correct WaterCoilNumber with the Coil Name</span>
<a name="ln-324"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-325"></a><span class="k">    </span><span class="n">CoilNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-326"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CoilNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-327"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimulateWaterCoilComponents: Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-328"></a>    <span class="n">ENDIF</span>
<a name="ln-329"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">CoilNum</span>
<a name="ln-330"></a>  <span class="k">ELSE</span>
<a name="ln-331"></a><span class="k">    </span><span class="n">CoilNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-332"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CoilNum</span> <span class="o">&gt;</span> <span class="n">NumWaterCoils</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">CoilNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-333"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimulateWaterCoilComponents: Invalid CompIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-334"></a>                          <span class="s1">&#39;, Number of Water Coils=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-335"></a>    <span class="n">ENDIF</span>
<a name="ln-336"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-337"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-338"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimulateWaterCoilComponents: Invalid CompIndex passed=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-339"></a>                            <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Coil Name for that index=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-340"></a>      <span class="n">ENDIF</span>
<a name="ln-341"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-342"></a>    <span class="n">ENDIF</span>
<a name="ln-343"></a>  <span class="n">ENDIF</span>
<a name="ln-344"></a>
<a name="ln-345"></a>  <span class="c">! With the correct CoilNum Initialize</span>
<a name="ln-346"></a>  <span class="k">CALL </span><span class="n">InitWaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="c">! Initialize all WaterCoil related parameters</span>
<a name="ln-347"></a>
<a name="ln-348"></a>  <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">FanOpMode</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-349"></a><span class="k">    </span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">FanOpMode</span>
<a name="ln-350"></a>  <span class="k">ELSE</span>
<a name="ln-351"></a><span class="k">    </span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">ContFanCycCoil</span>
<a name="ln-352"></a>  <span class="k">END IF</span>
<a name="ln-353"></a><span class="k">  IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-354"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-355"></a>  <span class="k">ELSE</span>
<a name="ln-356"></a><span class="k">    </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-357"></a>  <span class="k">END IF</span>
<a name="ln-358"></a>
<a name="ln-359"></a>  <span class="c">! Calculate the Correct WaterCoil Model with the current CoilNum</span>
<a name="ln-360"></a>  <span class="k">If</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_DetFlatFinCooling</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-361"></a><span class="k">       Call </span><span class="n">CalcDetailFlatFinCoolingCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">SimCalc</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-362"></a>       <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">QActual</span><span class="p">))</span><span class="n">QActual</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span>
<a name="ln-363"></a>  <span class="n">ElseIf</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_Cooling</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-364"></a><span class="k">       Call </span><span class="n">CoolingCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">SimCalc</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-365"></a>       <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">QActual</span><span class="p">))</span><span class="n">QActual</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span>
<a name="ln-366"></a>  <span class="k">End If</span>
<a name="ln-367"></a>
<a name="ln-368"></a><span class="k">  If</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_SimpleHeating</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-369"></a><span class="k">       Call </span><span class="n">CalcSimpleHeatingCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">SimCalc</span><span class="p">)</span>
<a name="ln-370"></a>       <span class="k">IF</span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">QActual</span><span class="p">))</span><span class="n">QActual</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span>
<a name="ln-371"></a>  <span class="k">End If</span>
<a name="ln-372"></a>
<a name="ln-373"></a>
<a name="ln-374"></a>  <span class="c">! Update the current WaterCoil to the outlet nodes</span>
<a name="ln-375"></a>  <span class="k">Call </span><span class="n">UpdateWaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span>
<a name="ln-376"></a>
<a name="ln-377"></a>  <span class="c">! Report the current WaterCoil</span>
<a name="ln-378"></a>  <span class="k">Call </span><span class="n">ReportWaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span>
<a name="ln-379"></a>
<a name="ln-380"></a>  <span class="k">RETURN</span>
<a name="ln-381"></a>
<a name="ln-382"></a><span class="k">END SUBROUTINE </span><span class="n">SimulateWaterCoilComponents</span>
<a name="ln-383"></a>
<a name="ln-384"></a>
<a name="ln-385"></a><span class="c">! Get Input Section of the Module</span>
<a name="ln-386"></a><span class="c">!******************************************************************************</span>
<a name="ln-387"></a><span class="k">SUBROUTINE </span><span class="n">GetWaterCoilInput</span>
<a name="ln-388"></a>
<a name="ln-389"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-390"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-391"></a>          <span class="c">!       DATE WRITTEN   April 1998</span>
<a name="ln-392"></a>          <span class="c">!       MODIFIED       April 2004: Rahul Chillar</span>
<a name="ln-393"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-394"></a>
<a name="ln-395"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-396"></a>          <span class="c">! Obtains input data for coils and stores it in coil data structures</span>
<a name="ln-397"></a>
<a name="ln-398"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-399"></a>          <span class="c">! Uses &quot;Get&quot; routines to read in data.</span>
<a name="ln-400"></a>
<a name="ln-401"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-402"></a>          <span class="c">! na</span>
<a name="ln-403"></a>
<a name="ln-404"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-405"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-406"></a>  <span class="k">USE </span><span class="n">InputProcessor</span>
<a name="ln-407"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-408"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-409"></a>  <span class="k">USE </span><span class="n">WaterManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupTankSupplyComponent</span>
<a name="ln-410"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-411"></a>  <span class="k">USE </span><span class="n">GlobalNames</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerifyUniqueCoilName</span>
<a name="ln-412"></a>  <span class="k">USE </span><span class="n">SetPointManager</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">NodeHasSPMCtrlVarType</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">,</span> <span class="n">iCtrlVarType_HumRat</span>
<a name="ln-413"></a>
<a name="ln-414"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-415"></a>
<a name="ln-416"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-417"></a>          <span class="c">! na</span>
<a name="ln-418"></a>
<a name="ln-419"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-420"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetWaterCoilInput: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-421"></a>
<a name="ln-422"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-423"></a>          <span class="c">! na</span>
<a name="ln-424"></a>
<a name="ln-425"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-426"></a>          <span class="c">! na</span>
<a name="ln-427"></a>
<a name="ln-428"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-429"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoilNum</span>      <span class="c">! The WaterCoil that you are currently loading input into</span>
<a name="ln-430"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumSimpHeat</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-431"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumFlatFin</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-432"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumCooling</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-433"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SimpHeatNum</span>
<a name="ln-434"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FlatFinNum</span>
<a name="ln-435"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoolingNum</span>
<a name="ln-436"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>
<a name="ln-437"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNums</span>
<a name="ln-438"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOSTAT</span>
<a name="ln-439"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span>  <span class="c">! for ease in getting objects</span>
<a name="ln-440"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">AlphArray</span>      <span class="c">! Alpha input items for object</span>
<a name="ln-441"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cAlphaFields</span>   <span class="c">! Alpha field names</span>
<a name="ln-442"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cNumericFields</span> <span class="c">! Numeric field names</span>
<a name="ln-443"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">NumArray</span>          <span class="c">! Numeric input items for object</span>
<a name="ln-444"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lAlphaBlanks</span>      <span class="c">! Logical array, alpha field input BLANK = .true.</span>
<a name="ln-445"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lNumericBlanks</span>    <span class="c">! Logical array, numeric field input BLANK = .true.</span>
<a name="ln-446"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxNums</span><span class="o">=</span><span class="mi">0</span>               <span class="c">! Maximum number of numeric input fields</span>
<a name="ln-447"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxAlphas</span><span class="o">=</span><span class="mi">0</span>             <span class="c">! Maximum number of alpha input fields</span>
<a name="ln-448"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotalArgs</span><span class="o">=</span><span class="mi">0</span>             <span class="c">! Total number of alpha and numeric arguments (max) for a</span>
<a name="ln-449"></a>                                       <span class="c">!  certain object in the input file</span>
<a name="ln-450"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>   <span class="c">! If errors detected in input</span>
<a name="ln-451"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>                 <span class="c">! Flag to verify name</span>
<a name="ln-452"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>                 <span class="c">! Flag for blank name</span>
<a name="ln-453"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-454"></a>
<a name="ln-455"></a>          <span class="c">! Flow</span>
<a name="ln-456"></a>     <span class="n">NumSimpHeat</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">)</span>
<a name="ln-457"></a>     <span class="n">NumFlatFin</span>    <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">)</span>
<a name="ln-458"></a>     <span class="n">NumCooling</span>    <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">)</span>
<a name="ln-459"></a>     <span class="n">NumWaterCoils</span> <span class="o">=</span> <span class="n">NumSimpHeat</span> <span class="o">+</span> <span class="n">NumFlatFin</span> <span class="o">+</span> <span class="n">NumCooling</span>
<a name="ln-460"></a>
<a name="ln-461"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-462"></a><span class="k">       ALLOCATE</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-463"></a>       <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">WaterTempCoolCoilErrs</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-464"></a>       <span class="n">WaterTempCoolCoilErrs</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-465"></a>       <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PartWetCoolCoilErrs</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-466"></a>       <span class="n">PartWetCoolCoilErrs</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-467"></a>       <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-468"></a>       <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-469"></a>     <span class="n">ENDIF</span>
<a name="ln-470"></a>
<a name="ln-471"></a>     <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-472"></a>     <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-473"></a>     <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-474"></a>     <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-475"></a>     <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-476"></a>     <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-477"></a>     <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">TotalArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-478"></a>     <span class="n">MaxNums</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">,</span><span class="n">NumNums</span><span class="p">)</span>
<a name="ln-479"></a>     <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-480"></a>
<a name="ln-481"></a>     <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-482"></a>     <span class="n">AlphArray</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-483"></a>     <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-484"></a>     <span class="n">cAlphaFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-485"></a>     <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-486"></a>     <span class="n">cNumericFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-487"></a>     <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-488"></a>     <span class="n">NumArray</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-489"></a>     <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-490"></a>     <span class="n">lAlphaBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-491"></a>     <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">MaxNums</span><span class="p">))</span>
<a name="ln-492"></a>     <span class="n">lNumericBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-493"></a>
<a name="ln-494"></a>
<a name="ln-495"></a>      <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Heating:Water&#39;</span>
<a name="ln-496"></a>      <span class="c">! Get the data for simple heating coils</span>
<a name="ln-497"></a>      <span class="k">DO </span><span class="n">SimpHeatNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumSimpHeat</span>
<a name="ln-498"></a>
<a name="ln-499"></a>        <span class="n">CoilNum</span><span class="o">=</span> <span class="n">SimpHeatNum</span>
<a name="ln-500"></a>
<a name="ln-501"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">SimpHeatNum</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-502"></a>                           <span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-503"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-504"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-505"></a>
<a name="ln-506"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-507"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-508"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">CoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-509"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-510"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-511"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-512"></a>        <span class="n">ENDIF</span>
<a name="ln-513"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-514"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-515"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-516"></a>        <span class="n">ENDIF</span>
<a name="ln-517"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-518"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-519"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-520"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-521"></a>        <span class="k">ELSE</span>
<a name="ln-522"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-523"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-524"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-525"></a>                                <span class="s1">&#39; entered =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-526"></a>                                <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-527"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-528"></a>          <span class="k">END IF</span>
<a name="ln-529"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-530"></a>
<a name="ln-531"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilTypeA</span>  <span class="o">=</span> <span class="s1">&#39;Heating&#39;</span>
<a name="ln-532"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span>  <span class="o">=</span> <span class="n">CoilType_Heating</span>    <span class="c">! &#39;Heating&#39;</span>
<a name="ln-533"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModelA</span> <span class="o">=</span> <span class="s1">&#39;SIMPLE&#39;</span>
<a name="ln-534"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">=</span> <span class="n">CoilModel_Simple</span> <span class="c">! &#39;SIMPLE&#39;</span>
<a name="ln-535"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">=</span> <span class="n">WaterCoil_SimpleHeating</span>
<a name="ln-536"></a>
<a name="ln-537"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-538"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilVariable</span>      <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span>
<a name="ln-539"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-540"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-541"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-542"></a>                                 <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-543"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-544"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-545"></a>                                 <span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-546"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-547"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-548"></a>                                 <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-549"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-550"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-551"></a>                                 <span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-552"></a>
<a name="ln-553"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-554"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;UFACTORTIMESAREAANDDESIGNWATERFLOWRATE&#39;</span><span class="p">)</span>
<a name="ln-555"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">=</span> <span class="n">UAandFlow</span>
<a name="ln-556"></a>
<a name="ln-557"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NOMINALCAPACITY&#39;</span><span class="p">)</span>
<a name="ln-558"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">=</span> <span class="n">NomCap</span>
<a name="ln-559"></a>
<a name="ln-560"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-561"></a>            <span class="c">! will be caught by input processor</span>
<a name="ln-562"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">=</span> <span class="n">UAandFlow</span>
<a name="ln-563"></a>         <span class="k">END SELECT</span>
<a name="ln-564"></a>
<a name="ln-565"></a><span class="k">        </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-566"></a>
<a name="ln-567"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="o">==</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">UAandFlow</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-568"></a>           <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-569"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">==</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">UAandFlow</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-570"></a>           <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-571"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">==</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">NomCap</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-572"></a>           <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-573"></a>
<a name="ln-574"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-575"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-576"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletWaterTemp</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-577"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-578"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RatioAirSideToWaterSideConvect</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-579"></a>
<a name="ln-580"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="o">&lt;=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletWaterTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-581"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-582"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be greater than the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-583"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-584"></a>        <span class="k">END IF</span>
<a name="ln-585"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span> <span class="o">&gt;=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-586"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-587"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be less than the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-588"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-589"></a>        <span class="k">END IF</span>
<a name="ln-590"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span> <span class="o">&gt;=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-591"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-592"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; must be less than the &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-593"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-594"></a>        <span class="k">END IF</span>
<a name="ln-595"></a>
<a name="ln-596"></a><span class="k">        CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-597"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-598"></a>
<a name="ln-599"></a>        <span class="c">!Setup the Simple Heating Coil reporting variables</span>
<a name="ln-600"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Energy [J]&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-601"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-602"></a>                               <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-603"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-604"></a>                              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-605"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-606"></a>                               <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPHEATINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;HEATINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-607"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil Heating Rate [W]&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-608"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-609"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Heating Coil U Factor Times Area Value [W/K]&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilVariable</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-610"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-611"></a>
<a name="ln-612"></a>      <span class="k">END DO</span>
<a name="ln-613"></a>
<a name="ln-614"></a>
<a name="ln-615"></a><span class="k">      </span><span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span>
<a name="ln-616"></a>      <span class="c">! Get the data for detailed cooling coils.</span>
<a name="ln-617"></a>      <span class="k">DO </span><span class="n">FlatFinNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumFlatFin</span>
<a name="ln-618"></a>
<a name="ln-619"></a>        <span class="n">CoilNum</span><span class="o">=</span> <span class="n">NumSimpHeat</span> <span class="o">+</span> <span class="n">FlatFinNum</span>
<a name="ln-620"></a>
<a name="ln-621"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">FlatFinNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-622"></a>                           <span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-623"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-624"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-625"></a>
<a name="ln-626"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-627"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-628"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">CoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-629"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-630"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-631"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-632"></a>        <span class="n">ENDIF</span>
<a name="ln-633"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-634"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-635"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-636"></a>        <span class="n">ENDIF</span>
<a name="ln-637"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-638"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-639"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-640"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-641"></a>        <span class="k">ELSE</span>
<a name="ln-642"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-643"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-644"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-645"></a>                                <span class="s1">&#39; entered =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-646"></a>                                <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-647"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-648"></a>          <span class="k">END IF</span>
<a name="ln-649"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-650"></a>
<a name="ln-651"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilTypeA</span>    <span class="o">=</span> <span class="s1">&#39;Cooling&#39;</span>
<a name="ln-652"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span>     <span class="o">=</span> <span class="n">CoilType_Cooling</span>       <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-653"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModelA</span>   <span class="o">=</span> <span class="s1">&#39;DETAILED FLAT FIN&#39;</span>
<a name="ln-654"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span>    <span class="o">=</span> <span class="n">CoilModel_Detailed</span>  <span class="c">! &#39;DETAILED FLAT FIN&#39;</span>
<a name="ln-655"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">=</span> <span class="n">WaterCoil_DetFlatFinCooling</span>
<a name="ln-656"></a>
<a name="ln-657"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-658"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-659"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span>  <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-660"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-661"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-662"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-663"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span>          <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-664"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-665"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-666"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-667"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span>            <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-668"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-669"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span>              <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-670"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-671"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThickness</span>         <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-672"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThickness</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-673"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-674"></a>                         <span class="s1">&#39; must be &gt; 0.0, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-675"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-676"></a>        <span class="k">END IF</span>
<a name="ln-677"></a><span class="k">        </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeInsideDiam</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-678"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideDiam</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-679"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeThermConductivity</span><span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-680"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeThermConductivity</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-681"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-682"></a>                         <span class="s1">&#39; must be &gt; 0.0, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-683"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-684"></a>        <span class="k">END IF</span>
<a name="ln-685"></a><span class="k">        </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThermConductivity</span> <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-686"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThermConductivity</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-687"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-688"></a>                         <span class="s1">&#39; must be &gt; 0.0, for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-689"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-690"></a>        <span class="k">END IF</span>
<a name="ln-691"></a><span class="k">        </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSpacing</span>           <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-692"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeDepthSpacing</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a name="ln-693"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubeRows</span>        <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-694"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-695"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-696"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-697"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-698"></a>                                 <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-699"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-700"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-701"></a>                                 <span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-702"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-703"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-704"></a>                                 <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-705"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-706"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-707"></a>                                 <span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-708"></a>
<a name="ln-709"></a>        <span class="c">! A7 ; \field Name of Water Storage Tank for Condensate Collection</span>
<a name="ln-710"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-711"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-712"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateDiscarded</span>
<a name="ln-713"></a>        <span class="k">ELSE</span>
<a name="ln-714"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateToTank</span>
<a name="ln-715"></a>          <span class="k">CALL </span><span class="n">SetupTankSupplyComponent</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-716"></a>                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-717"></a>                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span> <span class="p">)</span>
<a name="ln-718"></a>        <span class="n">ENDIF</span>
<a name="ln-719"></a>
<a name="ln-720"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-721"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-722"></a>
<a name="ln-723"></a>        <span class="c">! Setup Report variables for the Detailed Flat Fin Cooling Coils</span>
<a name="ln-724"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-725"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-726"></a>                               <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-727"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-728"></a>                              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-729"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-730"></a>                               <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPCOOLINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-731"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-732"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-733"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-734"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-735"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-736"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-737"></a>
<a name="ln-738"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">==</span> <span class="n">CondensateToTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-739"></a>
<a name="ln-740"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span><span class="p">,&amp;</span>
<a name="ln-741"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-742"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume [m3]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateVol</span><span class="p">,&amp;</span>
<a name="ln-743"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-744"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;OnSiteWater&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-745"></a>                           <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Condensate&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-746"></a>        <span class="n">ENDIF</span>
<a name="ln-747"></a>
<a name="ln-748"></a>      <span class="k">END DO</span>
<a name="ln-749"></a>
<a name="ln-750"></a>
<a name="ln-751"></a><span class="k">      </span><span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water&#39;</span>
<a name="ln-752"></a>      <span class="c">! Get the data for Cooling coils.</span>
<a name="ln-753"></a>      <span class="k">DO </span><span class="n">CoolingNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumCooling</span>
<a name="ln-754"></a>
<a name="ln-755"></a>        <span class="n">CoilNum</span><span class="o">=</span> <span class="n">NumSimpHeat</span> <span class="o">+</span> <span class="n">NumFlatFin</span> <span class="o">+</span> <span class="n">CoolingNum</span>
<a name="ln-756"></a>
<a name="ln-757"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">CoolingNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-758"></a>                           <span class="n">AlphArray</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumArray</span><span class="p">,</span><span class="n">NumNums</span><span class="p">,</span><span class="n">IOSTAT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-759"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-760"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-761"></a>
<a name="ln-762"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-763"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-764"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">CoilNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-765"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-766"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-767"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-768"></a>        <span class="n">ENDIF</span>
<a name="ln-769"></a>        <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">errflag</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-770"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-771"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-772"></a>        <span class="n">ENDIF</span>
<a name="ln-773"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span>     <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-774"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Schedule</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-775"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-776"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-777"></a>        <span class="k">ELSE</span>
<a name="ln-778"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-779"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-780"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-781"></a>                                <span class="s1">&#39; entered =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-782"></a>                                <span class="s1">&#39; for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-783"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-784"></a>          <span class="k">END IF</span>
<a name="ln-785"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-786"></a>
<a name="ln-787"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilTypeA</span>    <span class="o">=</span> <span class="s1">&#39;Cooling&#39;</span>
<a name="ln-788"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span>     <span class="o">=</span> <span class="n">CoilType_Cooling</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-789"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModelA</span>   <span class="o">=</span> <span class="s1">&#39;Cooling&#39;</span>
<a name="ln-790"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span>    <span class="o">=</span> <span class="n">CoilModel_Cooling</span> <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-791"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">=</span> <span class="n">WaterCoil_Cooling</span>
<a name="ln-792"></a>
<a name="ln-793"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>   <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="c">!Liquid mass flow rate at Design  kg/s</span>
<a name="ln-794"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-795"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>   <span class="c">!Dry air mass flow rate at Design (kg/s)</span>
<a name="ln-796"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-797"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c">!Entering water temperature at Design C</span>
<a name="ln-798"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-799"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span>       <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>   <span class="c">!Entering air dry bulb temperature at Design(C)</span>
<a name="ln-800"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-801"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span>      <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>   <span class="c">!Leaving air dry bulb temperature at Design(C)</span>
<a name="ln-802"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-803"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>     <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>   <span class="c">!Entering air humidity ratio  at Design</span>
<a name="ln-804"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-805"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span>    <span class="o">=</span> <span class="n">NumArray</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>   <span class="c">!Leaving air humidity ratio  at Design</span>
<a name="ln-806"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">==</span> <span class="n">Autosize</span><span class="p">)</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-807"></a>
<a name="ln-808"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>    <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-809"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-810"></a>                                 <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-811"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>   <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-812"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-813"></a>                                 <span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-814"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-815"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-816"></a>                                 <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-817"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-818"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Air</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-819"></a>                                 <span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-820"></a>
<a name="ln-821"></a>       <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-822"></a>        <span class="c">!The default is SimpleAnalysis = 2.  and DetailedAnalysis   =1</span>
<a name="ln-823"></a>         <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SIMPLEANALYSIS&#39;</span><span class="p">)</span>
<a name="ln-824"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoolingCoilAnalysisMode</span> <span class="o">=</span> <span class="n">SimpleAnalysis</span>
<a name="ln-825"></a>
<a name="ln-826"></a>         <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;DETAILEDANALYSIS&#39;</span><span class="p">)</span>
<a name="ln-827"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoolingCoilAnalysisMode</span> <span class="o">=</span> <span class="n">DetailedAnalysis</span>
<a name="ln-828"></a>
<a name="ln-829"></a>         <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-830"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoolingCoilAnalysisMode</span> <span class="o">=</span> <span class="n">SimpleAnalysis</span>
<a name="ln-831"></a>        <span class="k">END SELECT</span>
<a name="ln-832"></a>
<a name="ln-833"></a><span class="k">       SELECT CASE</span> <span class="p">(</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-834"></a>        <span class="c">!The default is CrossFlow = 2.  and CounterFlow=1</span>
<a name="ln-835"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;CROSSFLOW&#39;</span><span class="p">)</span>
<a name="ln-836"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">HeatExchType</span> <span class="o">=</span> <span class="n">CrossFlow</span>
<a name="ln-837"></a>
<a name="ln-838"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;COUNTERFLOW&#39;</span><span class="p">)</span>
<a name="ln-839"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">HeatExchType</span> <span class="o">=</span> <span class="n">CounterFlow</span>
<a name="ln-840"></a>
<a name="ln-841"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-842"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">HeatExchType</span> <span class="o">=</span> <span class="n">CrossFlow</span>
<a name="ln-843"></a>       <span class="k">END SELECT</span>
<a name="ln-844"></a>
<a name="ln-845"></a>       <span class="c">!A9; \field Name of Water Storage Tank for Condensate Collection</span>
<a name="ln-846"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="n">AlphArray</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-847"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-848"></a><span class="k">         </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateDiscarded</span>
<a name="ln-849"></a>       <span class="k">ELSE</span>
<a name="ln-850"></a><span class="k">         </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateToTank</span>
<a name="ln-851"></a>         <span class="k">CALL </span><span class="n">SetupTankSupplyComponent</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-852"></a>                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-853"></a>                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span> <span class="p">)</span>
<a name="ln-854"></a>       <span class="n">ENDIF</span>
<a name="ln-855"></a>
<a name="ln-856"></a>
<a name="ln-857"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-858"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">AlphArray</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-859"></a>
<a name="ln-860"></a>        <span class="c">! Setup Report variables for the Design input Cooling Coils</span>
<a name="ln-861"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-862"></a>                              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-863"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-864"></a>                               <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-865"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Source Side Heat Transfer Energy [J]&#39;</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-866"></a>                               <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-867"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-868"></a>                               <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;PLANTLOOPCOOLINGDEMAND&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-869"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-870"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-871"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-872"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-873"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-874"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-875"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Wetted Area Fraction []&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-876"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-877"></a>
<a name="ln-878"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">==</span> <span class="n">CondensateToTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-879"></a>
<a name="ln-880"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span><span class="p">,&amp;</span>
<a name="ln-881"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-882"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condensate Volume [m3]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateVol</span><span class="p">,&amp;</span>
<a name="ln-883"></a>                           <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-884"></a>                           <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;OnSiteWater&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-885"></a>                           <span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Condensate&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-886"></a>        <span class="n">ENDIF</span>
<a name="ln-887"></a>
<a name="ln-888"></a>      <span class="k">END DO</span>
<a name="ln-889"></a>
<a name="ln-890"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-891"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting input.&#39;</span><span class="p">)</span>
<a name="ln-892"></a>      <span class="n">ENDIF</span>
<a name="ln-893"></a>
<a name="ln-894"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AlphArray</span><span class="p">)</span>
<a name="ln-895"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">)</span>
<a name="ln-896"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-897"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">NumArray</span><span class="p">)</span>
<a name="ln-898"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">)</span>
<a name="ln-899"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">)</span>
<a name="ln-900"></a>
<a name="ln-901"></a>  <span class="k">RETURN</span>
<a name="ln-902"></a>
<a name="ln-903"></a><span class="k">END SUBROUTINE </span><span class="n">GetWaterCoilInput</span>
<a name="ln-904"></a>
<a name="ln-905"></a><span class="c">! End of Get Input subroutines for the HB Module</span>
<a name="ln-906"></a><span class="c">!******************************************************************************</span>
<a name="ln-907"></a>
<a name="ln-908"></a>
<a name="ln-909"></a> <span class="c">! Beginning Initialization Section of the Module</span>
<a name="ln-910"></a><span class="c">!******************************************************************************</span>
<a name="ln-911"></a><span class="k">SUBROUTINE </span><span class="n">InitWaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-912"></a>
<a name="ln-913"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-914"></a>          <span class="c">!       AUTHOR         Richard J. Liesen</span>
<a name="ln-915"></a>          <span class="c">!       DATE WRITTEN   February 1998</span>
<a name="ln-916"></a>          <span class="c">!       MODIFIED       April 2004: Rahul Chillar</span>
<a name="ln-917"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-918"></a>
<a name="ln-919"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-920"></a>          <span class="c">! This subroutine is for initializations of the WaterCoil Components.</span>
<a name="ln-921"></a>
<a name="ln-922"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-923"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-924"></a>
<a name="ln-925"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-926"></a>
<a name="ln-927"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-928"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">Iterate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-929"></a>                        <span class="n">SafeDivide</span>
<a name="ln-930"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-931"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-932"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">ScanPlantLoopsForObject</span>
<a name="ln-933"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">InitComponentNodes</span><span class="p">,</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-934"></a>
<a name="ln-935"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-936"></a>
<a name="ln-937"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-938"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-939"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">!unused1208</span>
<a name="ln-940"></a>
<a name="ln-941"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-942"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">SmallNo</span> <span class="o">=</span> <span class="mf">1.d-9</span> <span class="c">! SmallNo number in place of zero</span>
<a name="ln-943"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">LargeNo</span> <span class="o">=</span><span class="mf">1.d20</span>  <span class="c">! Large number in place of infinity</span>
<a name="ln-944"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>           <span class="kd">::</span> <span class="n">itmax</span> <span class="o">=</span><span class="mi">10</span>
<a name="ln-945"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>           <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>        <span class="c">! Maximum number of iterations</span>
<a name="ln-946"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">0.0001d0</span>       <span class="c">! Accuracy of result</span>
<a name="ln-947"></a>
<a name="ln-948"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-949"></a>          <span class="c">! na</span>
<a name="ln-950"></a>
<a name="ln-951"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-952"></a>          <span class="c">! na</span>
<a name="ln-953"></a>
<a name="ln-954"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-955"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DesInletAirEnth</span>               <span class="c">! Entering air enthalpy at rating (J/kg)</span>
<a name="ln-956"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DesOutletAirEnth</span>              <span class="c">! Leaving air enthalpy at rating(J/kg)</span>
<a name="ln-957"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DesAirApparatusDewPtEnth</span>      <span class="c">! Air enthalpy at apparatus dew point at rating(J/kg)</span>
<a name="ln-958"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DesSatEnthAtWaterInTemp</span>       <span class="c">! Saturated enthalpy at entering liquid temp(J/kg)</span>
<a name="ln-959"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DesHumRatAtWaterInTemp</span>        <span class="c">! Enthalpy at water inlet temp and entering air HumRat (J/kg)</span>
<a name="ln-960"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CapacitanceAir</span>                <span class="c">! Air-side capacity rate(W/C)</span>
<a name="ln-961"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DesAirTempApparatusDewPt</span>      <span class="c">! Temperature apparatus dew point at design capacity</span>
<a name="ln-962"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DesAirHumRatApparatusDewPt</span>    <span class="c">! Humdity Ratio at apparatus dew point at design capacity</span>
<a name="ln-963"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DesByPassFactor</span>               <span class="c">! ByPass Factor at design condition</span>
<a name="ln-964"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SlopeTempVsHumRatio</span>           <span class="c">! Ratio temperature difference to humidity difference</span>
<a name="ln-965"></a>                                          <span class="c">! between entering and leaving air states</span>
<a name="ln-966"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempApparatusDewPtEstimate</span>    <span class="c">! Estimate of TAdp from SlopeTempVsHumRatio</span>
<a name="ln-967"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Y1</span>         <span class="c">! Previous values of dependent variable in ITERATE</span>
<a name="ln-968"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">X1</span>         <span class="c">! Previous values of independent variable in ITERATE</span>
<a name="ln-969"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">error</span>      <span class="c">! Deviation of dependent variable in iteration</span>
<a name="ln-970"></a>  <span class="kt">INTEGER </span><span class="n">iter</span>    <span class="c">! Iteration counter</span>
<a name="ln-971"></a>  <span class="kt">INTEGER </span><span class="n">icvg</span>    <span class="c">! Iteration convergence flag</span>
<a name="ln-972"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ResultX</span>    <span class="c">! Output variable from ITERATE function.</span>
<a name="ln-973"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Ipass</span>  <span class="c">! loop index for App_Dewpoint_Loop</span>
<a name="ln-974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TOutNew</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! reset outlet air temperature for Coil:Cooling:Water</span>
<a name="ln-975"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WOutNew</span> <span class="o">=</span> <span class="mf">0.0d0</span>       <span class="c">! reset outlet air humidity ratio for Coil:Cooling:Water</span>
<a name="ln-976"></a>
<a name="ln-977"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">AirInletNode</span>
<a name="ln-978"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">WaterInletNode</span>
<a name="ln-979"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">WaterOutletNode</span>
<a name="ln-980"></a>
<a name="ln-981"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DesCpAir</span>         <span class="c">! CPAir at Design Inlet Air Temp</span>
<a name="ln-982"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">DesUARangeCheck</span>  <span class="c">! Value for range check based on Design Inlet Air Humidity Ratio</span>
<a name="ln-983"></a>
<a name="ln-984"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-985"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">Save</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>
<a name="ln-986"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">Save</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyCoilReportFlag</span>
<a name="ln-987"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">Save</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">PlantLoopScanFlag</span>
<a name="ln-988"></a>
<a name="ln-989"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoefSeries</span>
<a name="ln-990"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FinDiamVar</span>
<a name="ln-991"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TubeToFinDiamRatio</span>
<a name="ln-992"></a>
<a name="ln-993"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RhoAirStd</span>     <span class="c">! density of air at standard conditions</span>
<a name="ln-994"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CpAirStd</span>      <span class="c">! specific heat of air at std conditions</span>
<a name="ln-995"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFla</span>              <span class="c">! Flag of solver</span>
<a name="ln-996"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA0</span>                 <span class="c">! lower bound for UA</span>
<a name="ln-997"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA1</span>                 <span class="c">! upper bound for UA</span>
<a name="ln-998"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA</span>
<a name="ln-999"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>
<a name="ln-1000"></a>
<a name="ln-1001"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">NoSatCurveIntersect</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! TRUE if failed to find appatatus dew-point</span>
<a name="ln-1002"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">BelowInletWaterTemp</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! TRUE if apparatus dew-point below design inlet water temperature</span>
<a name="ln-1003"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CBFTooLarge</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>         <span class="c">! TRUE if the coil bypass factor is unrealistically large</span>
<a name="ln-1004"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">NoExitCondReset</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>     <span class="c">! TRUE if exit condition reset is not to be done</span>
<a name="ln-1005"></a>
<a name="ln-1006"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedLatentCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! latent cooling capacity at the rating point [W]</span>
<a name="ln-1007"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedSHR</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! sensible heat ratio at the rating point</span>
<a name="ln-1008"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CapacitanceWater</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! capacitance of the water stream [W/K]</span>
<a name="ln-1009"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CMin</span>             <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">! minimum capacitance of 2 streams [W/K]</span>
<a name="ln-1010"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilEffectiveness</span> <span class="o">=</span> <span class="mf">0.0d0</span>   <span class="c">! effectiveness of the coil (rated)</span>
<a name="ln-1011"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfaceArea</span> <span class="o">=</span> <span class="mf">0.0d0</span>         <span class="c">! heat exchanger surface area, [m2]</span>
<a name="ln-1012"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UATotal</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! heat exchanger UA total, [W/C]</span>
<a name="ln-1013"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span><span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RptCoilHeaderFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1014"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x_a</span> <span class="c">! result of Eq.70 in Wetter 1999</span>
<a name="ln-1015"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x_w</span> <span class="c">! result of Eq.72 in Wetter 1999</span>
<a name="ln-1016"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirConvectTerm</span> <span class="c">! result of Eq.71 in Wetter 1999</span>
<a name="ln-1017"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterConvectTerm</span> <span class="c">! result of Eq.73 in Wetter 1999</span>
<a name="ln-1018"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterConvSensitivity</span> <span class="c">! &quot;s&quot; in Wetter 1999, temperature sensitivity in water side convection</span>
<a name="ln-1019"></a>
<a name="ln-1020"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesUACoilExternalEnth</span>     <span class="c">! enthalpy based UAExternal for wet coil surface {kg/s}</span>
<a name="ln-1021"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LogMeanEnthDiff</span>           <span class="c">! long mean enthalpy difference {J/kg}</span>
<a name="ln-1022"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LogMeanTempDiff</span>           <span class="c">! long mean temperature difference {C}</span>
<a name="ln-1023"></a>
<a name="ln-1024"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesOutletWaterTemp</span>
<a name="ln-1025"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesSatEnthAtWaterOutTemp</span>
<a name="ln-1026"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesEnthAtWaterOutTempAirInHumRat</span>
<a name="ln-1027"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DesEnthWaterOut</span>
<a name="ln-1028"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span> <span class="c">! local fluid specific heat</span>
<a name="ln-1029"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span> <span class="c">! local fluid density</span>
<a name="ln-1030"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-1031"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthCorrFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! enthalpy correction factor</span>
<a name="ln-1032"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempCorrFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! temperature correction factor</span>
<a name="ln-1033"></a>          <span class="c">! FLOW:</span>
<a name="ln-1034"></a>
<a name="ln-1035"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1036"></a>    <span class="c">! initialize the environment and sizing flags</span>
<a name="ln-1037"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-1038"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-1039"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CoilWarningOnceFlag</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-1040"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DesCpAir</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-1041"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyUAAndFlowCalcFlag</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-1042"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyCoilDesignFlag</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-1043"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyCoilReportFlag</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-1044"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DesUARangeCheck</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-1045"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PlantLoopScanFlag</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span>
<a name="ln-1046"></a>    <span class="n">DesCpAir</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1047"></a>    <span class="n">DesUARangeCheck</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1048"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1049"></a>    <span class="n">MySizeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1050"></a>    <span class="n">CoilWarningOnceFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1051"></a>    <span class="n">MyUAAndFlowCalcFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1052"></a>    <span class="n">MyCoilDesignFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1053"></a>    <span class="n">MyCoilReportFlag</span> <span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1054"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1055"></a>    <span class="n">PlantLoopScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1056"></a>  <span class="k">END IF</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">PlantLoopScanFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1059"></a><span class="k">    </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1060"></a>    <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1061"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1062"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1063"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1064"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopBranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1065"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopCompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1066"></a>                                 <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-1067"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1068"></a><span class="k">       CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitWaterCoil: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-1069"></a>     <span class="n">ENDIF</span>
<a name="ln-1070"></a>    <span class="n">PlantLoopScanFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1071"></a>  <span class="n">ENDIF</span>
<a name="ln-1072"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1073"></a>    <span class="c">! for each coil, do the sizing once.</span>
<a name="ln-1074"></a>    <span class="k">CALL </span><span class="n">SizeWaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span>
<a name="ln-1075"></a>
<a name="ln-1076"></a>    <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1077"></a>  <span class="k">END IF</span>
<a name="ln-1078"></a><span class="k">  </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1079"></a>                             <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-1080"></a>                             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1081"></a>                             <span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1082"></a>
<a name="ln-1083"></a>  <span class="c">! Do the Begin Environment initializations</span>
<a name="ln-1084"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1085"></a>    <span class="c">!Initialize all report variables to a known state at beginning of simulation</span>
<a name="ln-1086"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1087"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1088"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1089"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1090"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1091"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1092"></a>
<a name="ln-1093"></a>    <span class="c">! The rest of the one time initializations</span>
<a name="ln-1094"></a>    <span class="n">AirInletNode</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-1095"></a>    <span class="n">WaterInletNode</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-1096"></a>    <span class="n">WaterOutletNode</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-1097"></a>
<a name="ln-1098"></a>    <span class="n">DesCpAir</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">)</span>
<a name="ln-1099"></a>    <span class="n">DesUARangeCheck</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">156</span><span class="mf">8.6d0</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">+</span> <span class="mi">2</span><span class="mf">0.157d0</span><span class="p">)</span>
<a name="ln-1100"></a>
<a name="ln-1101"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span> <span class="o">==</span> <span class="n">CoilType_Cooling</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-1102"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="mf">5.0d0</span>
<a name="ln-1103"></a>
<a name="ln-1104"></a>      <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1105"></a>                                 <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-1106"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1107"></a>                                 <span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1108"></a>
<a name="ln-1109"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1110"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Quality</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1111"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Press</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1112"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">HumRat</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1113"></a>    <span class="k">END IF</span>
<a name="ln-1114"></a>
<a name="ln-1115"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span> <span class="o">==</span> <span class="n">CoilType_Heating</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! &#39;Heating&#39;</span>
<a name="ln-1116"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>          <span class="o">=</span> <span class="mi">6</span><span class="mf">0.0d0</span>
<a name="ln-1117"></a>
<a name="ln-1118"></a>      <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1119"></a>                                 <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-1120"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1121"></a>                                 <span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1122"></a>
<a name="ln-1123"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="n">Cp</span><span class="o">*</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1124"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Quality</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1125"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Press</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1126"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">HumRat</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1127"></a>
<a name="ln-1128"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyUAAndFlowCalcFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1129"></a>        <span class="c">! calculate design water flow rate</span>
<a name="ln-1130"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">NomCap</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">UAandFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1131"></a>              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1132"></a>          <span class="c">! check for very small heating capacity</span>
<a name="ln-1133"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1134"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">/</span> <span class="p">(</span><span class="n">Cp</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-1135"></a>                  <span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletWaterTemp</span><span class="p">))</span>
<a name="ln-1136"></a>            <span class="c">! save the design water volumetric flow rate for use by the water loop sizing algorithms</span>
<a name="ln-1137"></a>            <span class="k">CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-1138"></a>          <span class="k">ELSE</span>
<a name="ln-1139"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1140"></a>          <span class="k">END IF</span>
<a name="ln-1141"></a><span class="k">        END IF</span>
<a name="ln-1142"></a>        <span class="c">! calculate the coil UA</span>
<a name="ln-1143"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">NomCap</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">UAandFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1144"></a>              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1145"></a>          <span class="c">! check for very small heating capacity</span>
<a name="ln-1146"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1147"></a><span class="k">            </span><span class="n">RhoAirStd</span> <span class="o">=</span> <span class="n">StdRhoAir</span>
<a name="ln-1148"></a>            <span class="n">CpAirStd</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-1149"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span>
<a name="ln-1150"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-1151"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">ContFanCycCoil</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="c">!fan operating mode</span>
<a name="ln-1152"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! part-load ratio</span>
<a name="ln-1153"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span>
<a name="ln-1154"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="mf">0.008d0</span>
<a name="ln-1155"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span>
<a name="ln-1156"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-1157"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">/</span> <span class="p">(</span><span class="n">CpAirStd</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-1158"></a>                                                       <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">))</span>
<a name="ln-1159"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">/</span> <span class="n">RhoAirStd</span>
<a name="ln-1160"></a>            <span class="c">! set the lower and upper limits on the UA</span>
<a name="ln-1161"></a>            <span class="n">UA0</span> <span class="o">=</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span>
<a name="ln-1162"></a>            <span class="n">UA1</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span>
<a name="ln-1163"></a>            <span class="c">! Invert the simple heating coil model: given the design inlet conditions and the design load, fins the design UA</span>
<a name="ln-1164"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleHeatingCoilUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-1165"></a>            <span class="c">! if the numerical inversion failed, issue error messages.</span>
<a name="ln-1166"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1167"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Calculation of heating coil UA failed for coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1168"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating coil UA&#39;</span><span class="p">)</span>
<a name="ln-1169"></a>              <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding error causes program termination&#39;</span><span class="p">)</span>
<a name="ln-1170"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1171"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Calculation of heating coil UA failed for coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1172"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-1173"></a>              <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding error causes program termination&#39;</span><span class="p">)</span>
<a name="ln-1174"></a>            <span class="k">END IF</span>
<a name="ln-1175"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-1176"></a>          <span class="k">ELSE</span>
<a name="ln-1177"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1178"></a>          <span class="k">END IF</span>
<a name="ln-1179"></a><span class="k">        END IF</span>
<a name="ln-1180"></a><span class="k">      END IF</span>
<a name="ln-1181"></a><span class="k">      </span><span class="n">MyUAAndFlowCalcFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1182"></a>      <span class="c">!fill values for variable UA</span>
<a name="ln-1183"></a>      <span class="n">CpAirStd</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-1184"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirMassFlowRate</span> <span class="o">=</span> <span class="n">StdRhoAir</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span>
<a name="ln-1185"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">LiquidSideNominalConvect</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="p">&amp;</span>
<a name="ln-1186"></a>                                  <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RatioAirSideToWaterSideConvect</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)&amp;</span>
<a name="ln-1187"></a>                                       <span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RatioAirSideToWaterSideConvect</span>
<a name="ln-1188"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirSideNominalConvect</span> <span class="o">=</span>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RatioAirSideToWaterSideConvect</span> <span class="p">&amp;</span>
<a name="ln-1189"></a>                                                  <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">LiquidSideNominalConvect</span>
<a name="ln-1190"></a>    <span class="k">ELSE</span>
<a name="ln-1191"></a><span class="k">      </span><span class="n">MyUAAndFlowCalcFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1192"></a>    <span class="k">END IF</span>
<a name="ln-1193"></a>
<a name="ln-1194"></a><span class="k">    </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-1195"></a>
<a name="ln-1196"></a>    <span class="k">Call </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1197"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-1198"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1199"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-1200"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopSide</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-1201"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopBranchNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1202"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopCompNum</span> <span class="p">)</span>
<a name="ln-1203"></a>
<a name="ln-1204"></a>  <span class="c">! effective fin diameter for detailed flat fin coil</span>
<a name="ln-1205"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! &#39;DETAILED FLAT FIN&#39;</span>
<a name="ln-1206"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EffectiveFinDiam</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">4.d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1207"></a>                               <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span>                        <span class="p">&amp;</span>
<a name="ln-1208"></a>                                <span class="o">/</span> <span class="p">(</span><span class="n">Pi</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumOfTubeRows</span> <span class="o">*</span>           <span class="p">&amp;</span>
<a name="ln-1209"></a>                                      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumOfTubesPerRow</span><span class="p">))</span>
<a name="ln-1210"></a>
<a name="ln-1211"></a>  <span class="c">!   calculate fixed geometric parameters of the coil:</span>
<a name="ln-1212"></a>  <span class="c">!   Total Area</span>
<a name="ln-1213"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1214"></a>                                   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span>
<a name="ln-1215"></a>  <span class="c">!   Effective Tube Inside Diameter - the model assumes that the coil</span>
<a name="ln-1216"></a>  <span class="c">!   can be simulated as a tube with an equivalent hydraulic diameter.</span>
<a name="ln-1217"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilEffectiveInsideDiam</span> <span class="o">=</span> <span class="mf">4.d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1218"></a>                                      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1219"></a>                                      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1220"></a>  <span class="c">!   Ratio of tube outside diameter to effective fin diameter should always</span>
<a name="ln-1221"></a>  <span class="c">!   be less than 1</span>
<a name="ln-1222"></a>      <span class="n">TubeToFinDiamRatio</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideDiam</span> <span class="o">/</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EffectiveFinDiam</span>
<a name="ln-1223"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TubeToFinDiamRatio</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1224"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;InitWaterCoil: Detailed Flat Fin Coil, TubetoFinDiamRatio &gt; 1.0, [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1225"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TubeToFinDiamRatio</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-1226"></a>        <span class="c">! reset tube depth spacing and recalc dependent parameters</span>
<a name="ln-1227"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeDepthSpacing</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeDepthSpacing</span> <span class="o">*</span> <span class="p">(</span><span class="n">TubeToFinDiamRatio</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.1d0</span><span class="p">)</span>
<a name="ln-1228"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeDepthSpacing</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubeRows</span>
<a name="ln-1229"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EffectiveFinDiam</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">4.d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1230"></a>                                                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span>                        <span class="p">&amp;</span>
<a name="ln-1231"></a>                                                <span class="o">/</span> <span class="p">(</span><span class="n">Pi</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumOfTubeRows</span> <span class="o">*</span>           <span class="p">&amp;</span>
<a name="ln-1232"></a>                                                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumOfTubesPerRow</span><span class="p">))</span>
<a name="ln-1233"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilEffectiveInsideDiam</span> <span class="o">=</span> <span class="mf">4.d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1234"></a>                                                       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1235"></a>                                                       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1236"></a>        <span class="n">TubeToFinDiamRatio</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideDiam</span> <span class="o">/</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EffectiveFinDiam</span>
<a name="ln-1237"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Resetting tube depth spacing to &#39;</span> <span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-1238"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeDepthSpacing</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1239"></a>                               <span class="s1">&#39; meters&#39;</span><span class="p">)</span>
<a name="ln-1240"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Resetting coil depth to &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1241"></a>                               <span class="s1">&#39; meters&#39;</span><span class="p">)</span>
<a name="ln-1242"></a>      <span class="n">ENDIF</span>
<a name="ln-1243"></a>
<a name="ln-1244"></a>      <span class="k">CALL </span><span class="n">CalcDryFinEffCoef</span><span class="p">(</span><span class="n">TubeToFinDiamRatio</span><span class="p">,</span> <span class="n">CoefSeries</span><span class="p">)</span>
<a name="ln-1245"></a>
<a name="ln-1246"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DryFinEfficncyCoef</span> <span class="o">=</span> <span class="n">CoefSeries</span>
<a name="ln-1247"></a>
<a name="ln-1248"></a>      <span class="n">FinDiamVar</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EffectiveFinDiam</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideDiam</span><span class="p">)</span>
<a name="ln-1249"></a>
<a name="ln-1250"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">GeometryCoef1</span> <span class="o">=</span> <span class="mf">0.159d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThickness</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1251"></a>                             <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilEffectiveInsideDiam</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.065d0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-1252"></a>                             <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThickness</span><span class="o">/</span><span class="n">FinDiamVar</span><span class="p">)</span><span class="o">**</span><span class="mf">0.141d0</span>
<a name="ln-1253"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">GeometryCoef2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.323d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSpacing</span><span class="o">/</span><span class="n">FinDiamVar</span><span class="p">)</span><span class="o">**</span><span class="mf">0.049d0</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1254"></a>                       <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EffectiveFinDiam</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeDepthSpacing</span><span class="p">)</span><span class="o">**</span><span class="mf">0.549d0</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-1255"></a>                       <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThickness</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSpacing</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="p">.</span><span class="mi">028</span><span class="n">d0</span><span class="p">)</span>
<a name="ln-1256"></a>
<a name="ln-1257"></a>      <span class="c">! Set some initial values for simulation</span>
<a name="ln-1258"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveConstCoef</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="mf">0.57d0</span>
<a name="ln-1259"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span>       <span class="o">=</span>   <span class="mf">3.3867d0</span>
<a name="ln-1260"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">=</span>   <span class="mf">3.3867d0</span>
<a name="ln-1261"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveConst</span>     <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="mf">0.57d0</span>
<a name="ln-1262"></a>      <span class="c">! Set Saved Values to Zero</span>
<a name="ln-1263"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetSaved</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1264"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MeanWaterTempSaved</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1265"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InWaterTempSaved</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1266"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutWaterTempSaved</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1267"></a>
<a name="ln-1268"></a>    <span class="k">END IF</span>  <span class="c">! End the Detailed Flat Fin Coil Initialization</span>
<a name="ln-1269"></a>
<a name="ln-1270"></a>       <span class="c">! Calculation for Cooling Coil, The part between the &#39;@@@&#39; are design condition</span>
<a name="ln-1271"></a>       <span class="c">! and are calculated only once to calculate standard values for UAs and other physical parameters of</span>
<a name="ln-1272"></a>       <span class="c">! the cooling coil.</span>
<a name="ln-1273"></a>       <span class="c">! Basic Idea for UA:  Heat Transfer= UAenthalpybased*(Delta enthalpy), this is a necessity since the</span>
<a name="ln-1274"></a>       <span class="c">! coil may be Wet or Dry or Partially Wet-Dry, so latent effects are accounted for in this model while</span>
<a name="ln-1275"></a>       <span class="c">! calculating the UA. A fictitious specific heat is also defined to caculate the conventional UA.</span>
<a name="ln-1276"></a>       <span class="c">! On the air side, enthalpy capacity rate is the air mass flow rate,while on water side it is</span>
<a name="ln-1277"></a>       <span class="c">! enthalpy of saturated air at water temperature.</span>
<a name="ln-1278"></a>       <span class="c">!@@@ DESIGN CONDITION BEGIN HERE @@@</span>
<a name="ln-1279"></a>
<a name="ln-1280"></a>    <span class="c">! Check for zero design cooling capacity as specified by coil design inputs</span>
<a name="ln-1281"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">MyCoilDesignFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1282"></a>                  <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1283"></a>                           <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a><span class="k">      </span><span class="n">DesInletAirEnth</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">)</span>
<a name="ln-1286"></a>      <span class="n">DesOutletAirEnth</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">)</span>
<a name="ln-1287"></a>      <span class="n">DesSatEnthAtWaterInTemp</span> <span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1288"></a>                                             <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">))</span>
<a name="ln-1289"></a>      <span class="c">! check for dry coil</span>
<a name="ln-1290"></a>      <span class="n">DesHumRatAtWaterInTemp</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="n">DesSatEnthAtWaterInTemp</span><span class="p">,</span><span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1291"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">DesHumRatAtWaterInTemp</span> <span class="o">&gt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1292"></a>         <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">&gt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1293"></a>        <span class="c">! if the design outlet air humrat is lower than the saturated air humrat at the design inlet water temp</span>
<a name="ln-1294"></a>        <span class="c">! and the design outlet air temperature is higher than the design inlet water temp (i.e, cooling possible),</span>
<a name="ln-1295"></a>        <span class="c">! move the design outlet air saturated enthalpy down (i.e., to Twaterin, Wair,out) to allow the coil to size.</span>
<a name="ln-1296"></a>        <span class="n">DesSatEnthAtWaterInTemp</span> <span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">)</span><span class="o">-</span><span class="mf">0.0001d0</span>
<a name="ln-1297"></a>      <span class="k">END IF</span>
<a name="ln-1298"></a><span class="k">      IF</span> <span class="p">(</span> <span class="n">DesOutletAirEnth</span> <span class="o">&gt;=</span> <span class="n">DesInletAirEnth</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="o">&gt;=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1299"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The design cooling capacity is zero for Coil:Cooling:Water &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1300"></a>                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1301"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  The maximum water flow rate for this coil will be set to zero and the coil will do no cooling.&#39;</span><span class="p">)</span>
<a name="ln-1302"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Check the following coil design inputs for problems: Tair,in = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1303"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1304"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;                                                       Wair,in = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1305"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1306"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;                                                       Twater,in = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1307"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1308"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;                                                       Tair,out = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1309"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1310"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;                                                       Wair,out = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1311"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1312"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1313"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1314"></a>      <span class="k">END IF</span>
<a name="ln-1315"></a><span class="k">    END IF</span>
<a name="ln-1316"></a>
<a name="ln-1317"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MyCoilDesignFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1318"></a>                  <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1319"></a>                           <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span><span class="k">THEN</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a>      <span class="n">MyCoilDesignFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1322"></a>      <span class="n">NoSatCurveIntersect</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1323"></a>      <span class="n">BelowInletWaterTemp</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1324"></a>      <span class="n">CBFTooLarge</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1325"></a>      <span class="n">NoExitCondReset</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1326"></a>      <span class="n">Inlet_Conditions_Loop</span><span class="p">:</span> <span class="k">DO </span><span class="n">Ipass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-1327"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Ipass</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1328"></a><span class="k">          IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">NoSatCurveIntersect</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BelowInletWaterTemp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CBFTooLarge</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1329"></a><span class="k">            EXIT </span><span class="n">Inlet_Conditions_Loop</span> <span class="c">! coil UA calcs OK</span>
<a name="ln-1330"></a>          <span class="k">ELSE</span>
<a name="ln-1331"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;In calculating the design coil UA for Coil:Cooling:Water &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1332"></a>                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1333"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">NoSatCurveIntersect</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1334"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;no apparatus dew-point can be found for the initial entering and leaving conditions;&#39;</span><span class="p">)</span>
<a name="ln-1335"></a>            <span class="k">END IF</span>
<a name="ln-1336"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">BelowInletWaterTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1337"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the apparatus dew-point is below the coil design inlet water temperature;&#39;</span><span class="p">)</span>
<a name="ln-1338"></a>            <span class="k">END IF</span>
<a name="ln-1339"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">CBFTooLarge</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1340"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the coil bypass factor is unrealistically large;&#39;</span><span class="p">)</span>
<a name="ln-1341"></a>            <span class="k">END IF</span>
<a name="ln-1342"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">NoExitCondReset</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1343"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the coil outlet design conditions will be changed to correct the problem.&#39;</span><span class="p">)</span>
<a name="ln-1344"></a>            <span class="k">END IF</span>
<a name="ln-1345"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The initial design conditions are: Tair,in = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1346"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1347"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;                                   Wair,in = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1348"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1349"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;                                   Twater,in = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1350"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1351"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;                                   Tair,out = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1352"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1353"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;                                   Wair,out = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1354"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1355"></a>            <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">NoExitCondReset</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1356"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The revised design conditions are: Tair,out = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1357"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TOutNew</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1358"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;                                   Wair,out = &#39;</span> <span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1359"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WOutNew</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1360"></a>              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">=</span> <span class="n">WOutNew</span>
<a name="ln-1361"></a>              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">=</span> <span class="n">TOutNew</span>
<a name="ln-1362"></a>            <span class="k">END IF</span>
<a name="ln-1363"></a><span class="k">          END IF</span>
<a name="ln-1364"></a><span class="k">        END IF</span>
<a name="ln-1365"></a>
<a name="ln-1366"></a>        <span class="c">! Volume flow rate being converted to mass flow rate for water</span>
<a name="ln-1367"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirMassFlowRate</span>  <span class="o">=</span> <span class="n">StdRhoAir</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a>        <span class="c">! Enthalpy of Air at Inlet design conditions</span>
<a name="ln-1370"></a>        <span class="n">DesInletAirEnth</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">)</span>
<a name="ln-1371"></a>
<a name="ln-1372"></a>        <span class="c">! Enthalpy of Air at outlet at design conditions</span>
<a name="ln-1373"></a>        <span class="n">DesOutletAirEnth</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">)</span>
<a name="ln-1374"></a>
<a name="ln-1375"></a><span class="c">! already calculated above and possibly reset if dry coil</span>
<a name="ln-1376"></a><span class="c">!        ! Enthalpy of Water at Inlet design conditions</span>
<a name="ln-1377"></a><span class="c">!        DesSatEnthAtWaterInTemp =PsyHFnTdbW(WaterCoil(CoilNum)%DesInletWaterTemp, &amp;</span>
<a name="ln-1378"></a><span class="c">!                                             PsyWFnTdpPb(WaterCoil(CoilNum)%DesInletWaterTemp,StdBaroPress))</span>
<a name="ln-1379"></a>
<a name="ln-1380"></a>        <span class="c">! Total Coil Load from Inlet and Outlet Air States.</span>
<a name="ln-1381"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirMassFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">DesInletAirEnth</span><span class="o">-</span><span class="n">DesOutletAirEnth</span><span class="p">)</span>
<a name="ln-1382"></a>
<a name="ln-1383"></a>        <span class="c">! Enthalpy of Water at Intlet design conditions</span>
<a name="ln-1384"></a>        <span class="n">Cp</span>  <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1385"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-1386"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1387"></a>                                 <span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1388"></a>
<a name="ln-1389"></a>        <span class="n">DesOutletWaterTemp</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="p">&amp;</span>
<a name="ln-1390"></a>                                    <span class="o">+</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1391"></a>                           <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">*</span> <span class="n">CP</span><span class="p">)</span>
<a name="ln-1392"></a>
<a name="ln-1393"></a>        <span class="n">DesSatEnthAtWaterOutTemp</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">DesOutletWaterTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1394"></a>                                             <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">DesOutletWaterTemp</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">))</span>
<a name="ln-1395"></a>        <span class="n">DesEnthAtWaterOutTempAirInHumRat</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">DesOutletWaterTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">)</span>
<a name="ln-1396"></a>        <span class="n">DesEnthWaterOut</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">DesSatEnthAtWaterOutTemp</span><span class="p">,</span><span class="n">DesEnthAtWaterOutTempAirInHumRat</span><span class="p">)</span>
<a name="ln-1397"></a>
<a name="ln-1398"></a>        <span class="c">! dry coil test</span>
<a name="ln-1399"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">&lt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1400"></a>            <span class="n">DesHumRatAtWaterInTemp</span> <span class="o">&lt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! wet coil</span>
<a name="ln-1401"></a>
<a name="ln-1402"></a>          <span class="c">! Calculations for BYPASS FACTOR at design conditions</span>
<a name="ln-1403"></a>          <span class="c">! Calculate &quot;slope&quot; of temperature vs. humidity ratio between entering and leaving states</span>
<a name="ln-1404"></a>          <span class="n">SlopeTempVsHumRatio</span><span class="o">=</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="o">-</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1405"></a>                               <span class="nb">MAX</span><span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="o">-</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">),</span><span class="n">SmallNo</span><span class="p">)</span>
<a name="ln-1406"></a>
<a name="ln-1407"></a>          <span class="c">! Initialize iteration parameters</span>
<a name="ln-1408"></a>          <span class="n">DesAirTempApparatusDewPt</span> <span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-1409"></a>
<a name="ln-1410"></a>          <span class="c">! Iterating to calculate Apparatus Dew Point Temperature at Design Conditions</span>
<a name="ln-1411"></a>          <span class="n">App_Dewpoint_Loop1</span><span class="p">:</span> <span class="k">DO </span><span class="n">iter</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">itmax</span>
<a name="ln-1412"></a>
<a name="ln-1413"></a>            <span class="c">! Calculate apparatus dewpoint and compare with predicted value</span>
<a name="ln-1414"></a>            <span class="c">! using entering conditions and SlopeTempVsHumRatio</span>
<a name="ln-1415"></a>            <span class="n">DesAirHumRatApparatusDewPt</span><span class="o">=</span>  <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">DesAirTempApparatusDewPt</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-1416"></a>
<a name="ln-1417"></a>            <span class="c">! Initial Estimate for apparatus Dew Point Temperature</span>
<a name="ln-1418"></a>            <span class="n">TempApparatusDewPtEstimate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span> <span class="o">-</span> <span class="n">SlopeTempVsHumRatio</span><span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-1419"></a>                                           <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="o">-</span><span class="n">DesAirHumRatApparatusDewPt</span><span class="p">)</span>
<a name="ln-1420"></a>
<a name="ln-1421"></a>            <span class="c">! Iterating to calculate Apparatus Dew Point Temperature at Design Condition</span>
<a name="ln-1422"></a>            <span class="n">error</span> <span class="o">=</span> <span class="n">DesAirTempApparatusDewPt</span><span class="o">-</span><span class="n">TempApparatusDewPtEstimate</span>
<a name="ln-1423"></a>            <span class="k">Call </span><span class="n">ITERATE</span> <span class="p">(</span><span class="n">ResultX</span><span class="p">,</span><span class="mf">0.01d0</span><span class="p">,</span> <span class="n">DesAirTempApparatusDewPt</span><span class="p">,</span><span class="n">error</span><span class="p">,</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">iter</span><span class="p">,</span><span class="n">icvg</span><span class="p">)</span>
<a name="ln-1424"></a>            <span class="n">DesAirTempApparatusDewPt</span> <span class="o">=</span> <span class="n">ResultX</span>
<a name="ln-1425"></a>
<a name="ln-1426"></a>            <span class="c">! If converged, exit loop</span>
<a name="ln-1427"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">icvg</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1428"></a><span class="k">              Exit </span><span class="n">App_Dewpoint_Loop1</span>
<a name="ln-1429"></a>            <span class="k">END IF</span>
<a name="ln-1430"></a>
<a name="ln-1431"></a>            <span class="c">! If not converged due to low Humidity Ratio approximate value at outlet conditions</span>
<a name="ln-1432"></a>            <span class="k">IF</span><span class="p">((</span><span class="n">Iter</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">itmax</span><span class="p">))</span><span class="k">Then</span>
<a name="ln-1433"></a><span class="k">              </span><span class="n">NoSatCurveIntersect</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1434"></a>              <span class="n">DesAirTempApparatusDewPt</span> <span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-1435"></a>              <span class="n">DesAirHumRatApparatusDewPt</span> <span class="o">=</span> <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">DesAirTempApparatusDewPt</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-1436"></a>              <span class="k">Exit </span><span class="n">App_Dewpoint_Loop1</span>
<a name="ln-1437"></a>            <span class="k">End IF</span>
<a name="ln-1438"></a>
<a name="ln-1439"></a>            <span class="c">! End of Do Loop for Iteration</span>
<a name="ln-1440"></a>          <span class="k">End Do </span><span class="n">App_Dewpoint_Loop1</span>
<a name="ln-1441"></a>
<a name="ln-1442"></a>          <span class="c">! Air enthalpy at apparatus dew point at design conditions</span>
<a name="ln-1443"></a>          <span class="n">DesAirApparatusDewPtEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">DesAirTempApparatusDewPt</span><span class="p">,</span><span class="n">DesAirHumRatApparatusDewPt</span><span class="p">)</span>
<a name="ln-1444"></a>
<a name="ln-1445"></a>          <span class="c">! Calculate bypass factor from enthalpies calculated above.</span>
<a name="ln-1446"></a>          <span class="n">DesByPassFactor</span> <span class="o">=</span> <span class="p">(</span><span class="n">DesOutletAirEnth</span><span class="o">-</span><span class="n">DesAirApparatusDewPtEnth</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">DesInletAirEnth</span><span class="o">-</span><span class="n">DesAirApparatusDewPtEnth</span><span class="p">)</span>
<a name="ln-1447"></a>
<a name="ln-1448"></a>          <span class="c">! Check for bypass factor for unsuitable value. Note that bypass factor is never used in the coil calculation</span>
<a name="ln-1449"></a>          <span class="k">If</span><span class="p">((</span><span class="n">DesByPassFactor</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">DesByPassFactor</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span><span class="k">Then</span>
<a name="ln-1450"></a><span class="k">            </span><span class="n">CBFTooLarge</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1451"></a>            <span class="n">DesByPassFactor</span><span class="o">=</span><span class="mf">0.37d0</span>
<a name="ln-1452"></a>          <span class="k">End if</span>
<a name="ln-1453"></a>
<a name="ln-1454"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DesEnthWaterOut</span> <span class="o">&gt;</span> <span class="n">DesInletAirEnth</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1455"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;In calculating the design coil UA for Coil:Cooling:Water &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1456"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1457"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the outlet chilled water design enthalpy is greater than the inlet air design enthalpy.&#39;</span><span class="p">)</span>
<a name="ln-1458"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;To correct this condition the design chilled water flow rate will be increased from &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1459"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1460"></a>            <span class="n">EnthCorrFrac</span> <span class="o">=</span> <span class="p">(</span><span class="n">DesEnthWaterOut</span> <span class="o">-</span> <span class="n">DesInletAirEnth</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">DesEnthWaterOut</span> <span class="o">-</span> <span class="n">DesSatEnthAtWaterInTemp</span><span class="p">)</span>
<a name="ln-1461"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">EnthCorrFrac</span><span class="p">)</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-1462"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;to &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; m3/s&#39;</span><span class="p">)</span>
<a name="ln-1463"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-1464"></a>            <span class="n">DesOutletWaterTemp</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="p">&amp;</span>
<a name="ln-1465"></a>                                      <span class="o">+</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1466"></a>                                        <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">*</span> <span class="n">CP</span><span class="p">)</span>
<a name="ln-1467"></a>            <span class="n">DesSatEnthAtWaterOutTemp</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">DesOutletWaterTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1468"></a>                                                  <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">DesOutletWaterTemp</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">))</span>
<a name="ln-1469"></a>            <span class="n">DesEnthAtWaterOutTempAirInHumRat</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">DesOutletWaterTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">)</span>
<a name="ln-1470"></a>            <span class="n">DesEnthWaterOut</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">DesSatEnthAtWaterOutTemp</span><span class="p">,</span><span class="n">DesEnthAtWaterOutTempAirInHumRat</span><span class="p">)</span>
<a name="ln-1471"></a>          <span class="k">END IF</span>
<a name="ln-1472"></a>
<a name="ln-1473"></a>          <span class="c">! Determine air-side coefficient, UACoilExternal, assuming that the</span>
<a name="ln-1474"></a>          <span class="c">! surface temperature is at the apparatus dewpoint temperature</span>
<a name="ln-1475"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DesAirApparatusDewPtEnth</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">DesSatEnthAtWaterInTemp</span> <span class="p">)</span> <span class="n">BelowInletWaterTemp</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1476"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">DesInletAirEnth</span> <span class="o">-</span> <span class="n">DesEnthWaterOut</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallNo</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-1477"></a>              <span class="p">(</span><span class="n">DesOutletAirEnth</span> <span class="o">-</span> <span class="n">DesSatEnthAtWaterInTemp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallNo</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1478"></a><span class="k">            </span><span class="n">LogMeanEnthDiff</span> <span class="o">=</span> <span class="p">((</span><span class="n">DesInletAirEnth</span> <span class="o">-</span> <span class="n">DesEnthWaterOut</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">DesOutletAirEnth</span> <span class="o">-</span> <span class="n">DesSatEnthAtWaterInTemp</span><span class="p">))</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1479"></a>                                <span class="nb">LOG</span><span class="p">((</span><span class="n">DesInletAirEnth</span> <span class="o">-</span> <span class="n">DesEnthWaterOut</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">DesOutletAirEnth</span> <span class="o">-</span> <span class="n">DesSatEnthAtWaterInTemp</span><span class="p">))</span>
<a name="ln-1480"></a>          <span class="k">ELSE</span>
<a name="ln-1481"></a><span class="k">            </span><span class="n">LogMeanEnthDiff</span> <span class="o">=</span> <span class="mi">200</span><span class="mf">0.0d0</span> <span class="c">! UA will be 1/2 the design coil load</span>
<a name="ln-1482"></a>          <span class="k">END IF</span>
<a name="ln-1483"></a><span class="k">          </span><span class="n">DesUACoilExternalEnth</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span><span class="o">/</span><span class="n">LogMeanEnthDiff</span>
<a name="ln-1484"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="o">=</span> <span class="n">DesUACoilExternalEnth</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-1485"></a>                           <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">)</span>
<a name="ln-1486"></a>
<a name="ln-1487"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Ipass</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">NoSatCurveIntersect</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CBFTooLarge</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">BelowInletWaterTemp</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1488"></a>            <span class="c">! reset outlet conditions to 90% relative humidity at the same outlet enthalpy</span>
<a name="ln-1489"></a>            <span class="n">TOutNew</span> <span class="o">=</span> <span class="n">TdbFnHRhPb</span><span class="p">(</span><span class="n">DesOutletAirEnth</span><span class="p">,</span><span class="mf">0.9d0</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">)</span>
<a name="ln-1490"></a>            <span class="n">WOutNew</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">TOutNew</span><span class="p">,</span><span class="n">DesOutletAirEnth</span><span class="p">)</span>
<a name="ln-1491"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WOutNew</span> <span class="o">&gt;=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">TOutNew</span> <span class="o">&gt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1492"></a><span class="k">              </span><span class="n">NoExitCondReset</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1493"></a>            <span class="k">END IF</span>
<a name="ln-1494"></a><span class="k">            CYCLE </span><span class="n">Inlet_Conditions_Loop</span>
<a name="ln-1495"></a>          <span class="k">END IF</span>
<a name="ln-1496"></a>
<a name="ln-1497"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">*</span><span class="mf">3.30d0</span>
<a name="ln-1498"></a>          <span class="c">! Overall heat transfer coefficient</span>
<a name="ln-1499"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">+</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">)</span>
<a name="ln-1500"></a>
<a name="ln-1501"></a>
<a name="ln-1502"></a>        <span class="k">ELSE</span> <span class="c">! dry coil</span>
<a name="ln-1503"></a>
<a name="ln-1504"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DesOutletWaterTemp</span> <span class="o">&gt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1505"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;In calculating the design coil UA for Coil:Cooling:Water &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1506"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1507"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the outlet chilled water design temperature is greater than the inlet air design temperature.&#39;</span><span class="p">)</span>
<a name="ln-1508"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;To correct this condition the design chilled water flow rate will be increased from &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1509"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1510"></a>            <span class="n">TempCorrFrac</span> <span class="o">=</span> <span class="p">(</span><span class="n">DesOutletWaterTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">)</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-1511"></a>               <span class="p">(</span><span class="n">DesOutletWaterTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">)</span>
<a name="ln-1512"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">TempCorrFrac</span><span class="p">)</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-1513"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;to &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; m3/s&#39;</span><span class="p">)</span>
<a name="ln-1514"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-1515"></a>            <span class="n">DesOutletWaterTemp</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="p">&amp;</span>
<a name="ln-1516"></a>                                      <span class="o">+</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1517"></a>                                        <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">*</span> <span class="n">CP</span><span class="p">)</span>
<a name="ln-1518"></a>          <span class="k">END IF</span>
<a name="ln-1519"></a>
<a name="ln-1520"></a><span class="k">          IF</span> <span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span> <span class="o">-</span> <span class="n">DesOutletWaterTemp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallNo</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1521"></a>              <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SmallNo</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1522"></a><span class="k">            </span><span class="n">LogMeanTempDiff</span> <span class="o">=</span> <span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span> <span class="o">-</span> <span class="n">DesOutletWaterTemp</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-1523"></a>                               <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">))</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1524"></a>                               <span class="nb">LOG</span><span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span> <span class="o">-</span> <span class="n">DesOutletWaterTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1525"></a>                               <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">))</span>
<a name="ln-1526"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">/</span> <span class="n">LogMeanTempDiff</span>
<a name="ln-1527"></a>          <span class="k">ELSE</span>
<a name="ln-1528"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">/</span> <span class="mf">2.0d0</span> <span class="c">! make the UA large</span>
<a name="ln-1529"></a>          <span class="k">END IF</span>
<a name="ln-1530"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">*</span><span class="mf">3.30d0</span>
<a name="ln-1531"></a>          <span class="c">! Overall heat transfer coefficient</span>
<a name="ln-1532"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">+</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">)</span>
<a name="ln-1533"></a>          <span class="k">EXIT </span><span class="n">Inlet_Conditions_Loop</span>
<a name="ln-1534"></a>
<a name="ln-1535"></a>        <span class="k">END IF</span>
<a name="ln-1536"></a>
<a name="ln-1537"></a><span class="k">      END DO </span><span class="n">Inlet_Conditions_Loop</span>
<a name="ln-1538"></a>
<a name="ln-1539"></a>
<a name="ln-1540"></a>      <span class="c">! estimate the heat external transfer surface area using typical design over all U value</span>
<a name="ln-1541"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span><span class="o">=</span><span class="n">EstimateHEXSurfaceArea</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span>
<a name="ln-1542"></a>      <span class="c">! calculate internal and external &quot;UA per external surface area&quot;</span>
<a name="ln-1543"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1544"></a>                                                                      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1545"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1546"></a>      <span class="c">! approximate the dry UA as 1.0 times wet UA</span>
<a name="ln-1547"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UADryExtPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span>
<a name="ln-1548"></a>
<a name="ln-1549"></a>      <span class="c">! Now use SolveRegulaFalsi to &quot;invert&quot; the cooling coil model to obtain the UA given the specified design inlet and outlet conditions</span>
<a name="ln-1550"></a>      <span class="c">! Note that the UAs we have obtained so far are rough estimates that are the starting points for the the following iterative</span>
<a name="ln-1551"></a>      <span class="c">!   calulation of the actual UAs.</span>
<a name="ln-1552"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span>
<a name="ln-1553"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-1554"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">ContFanCycCoil</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="c">!fan operating mode</span>
<a name="ln-1555"></a>      <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! part-load ratio</span>
<a name="ln-1556"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span>
<a name="ln-1557"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-1558"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span>
<a name="ln-1559"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-1560"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirMassFlowRate</span>
<a name="ln-1561"></a>      <span class="c">! set the lower and upper limits on the UA</span>
<a name="ln-1562"></a>      <span class="n">UA0</span> <span class="o">=</span> <span class="mf">0.1d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span>
<a name="ln-1563"></a>      <span class="n">UA1</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.0d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span>
<a name="ln-1564"></a>      <span class="c">! Invert the simple cooling coil model: given the design inlet conditions and the design load, find the design UA</span>
<a name="ln-1565"></a>      <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="mf">0.001d0</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleCoolingCoilUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-1566"></a>      <span class="c">! if the numerical inversion failed, issue error messages.</span>
<a name="ln-1567"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1568"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Calculation of cooling coil design UA failed for coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1569"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating coil UA&#39;</span><span class="p">)</span>
<a name="ln-1570"></a>        <span class="c">! CALL ShowFatalError(&#39;Preceeding error causes program termination&#39;)</span>
<a name="ln-1571"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="o">=</span> <span class="n">UA0</span><span class="o">*</span><span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-1572"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">*</span><span class="mf">3.3d0</span>
<a name="ln-1573"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">+</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">)</span>
<a name="ln-1574"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span><span class="o">=</span><span class="n">EstimateHEXSurfaceArea</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span>
<a name="ln-1575"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1576"></a>                                                       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1577"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1578"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UADryExtPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span>
<a name="ln-1579"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Coil design UA set to &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [W/C]&#39;</span><span class="p">)</span>
<a name="ln-1580"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1581"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Calculation of cooling coil design UA failed for coil &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1582"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-1583"></a>        <span class="c">! CALL ShowFatalError(&#39;Preceeding error causes program termination&#39;)</span>
<a name="ln-1584"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="o">=</span> <span class="n">UA0</span><span class="o">*</span><span class="mi">1</span><span class="mf">0.0d0</span>
<a name="ln-1585"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">*</span><span class="mf">3.3d0</span>
<a name="ln-1586"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">+</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">)</span>
<a name="ln-1587"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span><span class="o">=</span><span class="n">EstimateHEXSurfaceArea</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span>
<a name="ln-1588"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1589"></a>                                                       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1590"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1591"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UADryExtPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span>
<a name="ln-1592"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Coil design UA set to &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [W/C]&#39;</span><span class="p">)</span>
<a name="ln-1593"></a>      <span class="k">END IF</span>
<a name="ln-1594"></a>
<a name="ln-1595"></a>       <span class="c">! cooling coil surface area</span>
<a name="ln-1596"></a>      <span class="n">SurfaceArea</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1597"></a>
<a name="ln-1598"></a>       <span class="c">! cooling coil overall UA value</span>
<a name="ln-1599"></a>      <span class="n">UATotal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span>
<a name="ln-1600"></a>
<a name="ln-1601"></a>      <span class="c">! save the design internal and external UAs</span>
<a name="ln-1602"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternalDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span>
<a name="ln-1603"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span>
<a name="ln-1604"></a>
<a name="ln-1605"></a>    <span class="k">End If</span>
<a name="ln-1606"></a>
<a name="ln-1607"></a>    <span class="c">!@@@@ DESIGN CONDITION END HERE @@@@</span>
<a name="ln-1608"></a>
<a name="ln-1609"></a>    <span class="c">! Calculate rated Total, latent, sensible capacity, SHR, effectiveness</span>
<a name="ln-1610"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_SimpleHeating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1611"></a><span class="k">      </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">6.6d0</span>
<a name="ln-1612"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbRhPb</span><span class="p">(</span><span class="mi">1</span><span class="mf">6.6d0</span><span class="p">,</span><span class="mf">0.5d0</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">calledfrom</span><span class="o">=</span><span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1613"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span> <span class="o">=</span><span class="mi">8</span><span class="mf">2.2d0</span>
<a name="ln-1614"></a>    <span class="k">ELSE</span>
<a name="ln-1615"></a><span class="k">      </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">6.67d0</span>
<a name="ln-1616"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="mi">2</span><span class="mf">6.67d0</span><span class="p">,</span><span class="mi">1</span><span class="mf">9.44d0</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">calledfrom</span><span class="o">=</span><span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1617"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span> <span class="o">=</span> <span class="mf">6.67d0</span>
<a name="ln-1618"></a>    <span class="k">END IF</span>
<a name="ln-1619"></a><span class="k">    </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1620"></a>       <span class="n">calledfrom</span><span class="o">=</span><span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1621"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span>
<a name="ln-1622"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">StdRhoAir</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span>
<a name="ln-1623"></a>    <span class="n">CapacitanceAir</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-1624"></a>       <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">calledfrom</span><span class="o">=</span><span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1625"></a>
<a name="ln-1626"></a>    <span class="n">Cp</span>  <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1627"></a>                   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-1628"></a>                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1629"></a>                   <span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-1630"></a>
<a name="ln-1631"></a>    <span class="n">CapacitanceWater</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="o">*</span> <span class="n">Cp</span>
<a name="ln-1632"></a>    <span class="n">CMin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">CapacitanceAir</span><span class="p">,</span><span class="n">CapacitanceWater</span><span class="p">)</span>
<a name="ln-1633"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CMin</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1634"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_Cooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1635"></a><span class="k">        CALL </span><span class="n">CoolingCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">DesignCalc</span><span class="p">,</span><span class="n">ContFanCycCoil</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1636"></a>        <span class="n">CoilEffectiveness</span> <span class="o">=</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1637"></a>                              <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1638"></a>                              <span class="p">(</span><span class="n">CapacitanceAir</span> <span class="o">/</span> <span class="n">CMin</span><span class="p">)</span>
<a name="ln-1639"></a>        <span class="n">RatedLatentCapacity</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span>
<a name="ln-1640"></a>        <span class="n">RatedSHR</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span> <span class="o">/</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span>
<a name="ln-1641"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_DetFlatFinCooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1642"></a><span class="k">        CALL </span><span class="n">CalcDetailFlatFinCoolingCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">DesignCalc</span><span class="p">,</span><span class="n">ContFanCycCoil</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-1643"></a>        <span class="n">CoilEffectiveness</span> <span class="o">=</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1644"></a>                              <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1645"></a>                              <span class="p">(</span><span class="n">CapacitanceAir</span> <span class="o">/</span> <span class="n">CMin</span><span class="p">)</span>
<a name="ln-1646"></a>        <span class="n">RatedLatentCapacity</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span>
<a name="ln-1647"></a>        <span class="n">RatedSHR</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span> <span class="o">/</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span>
<a name="ln-1648"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_SimpleHeating</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1649"></a><span class="k">        CALL </span><span class="n">CalcSimpleHeatingCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">ContFanCycCoil</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">DesignCalc</span><span class="p">)</span>
<a name="ln-1650"></a>        <span class="n">CoilEffectiveness</span> <span class="o">=</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-1651"></a>                              <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-1652"></a>                              <span class="p">(</span><span class="n">CapacitanceAir</span> <span class="o">/</span> <span class="n">CMin</span><span class="p">)</span>
<a name="ln-1653"></a>      <span class="k">END IF</span>
<a name="ln-1654"></a><span class="k">    ELSE</span>
<a name="ln-1655"></a><span class="k">      </span><span class="n">CoilEffectiveness</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1656"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1657"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1658"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1659"></a>      <span class="n">RatedLatentCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1660"></a>      <span class="n">RatedSHR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1661"></a>    <span class="k">END IF</span>
<a name="ln-1662"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1663"></a>
<a name="ln-1664"></a>  <span class="k">END IF</span>  <span class="c">! End If for the Begin Environment initializations</span>
<a name="ln-1665"></a>
<a name="ln-1666"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1667"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1668"></a>  <span class="n">ENDIF</span>
<a name="ln-1669"></a>
<a name="ln-1670"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoingSizing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1671"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">MyCoilReportFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1672"></a>      <span class="c">!create predefined report entries</span>
<a name="ln-1673"></a>      <span class="n">MyCoilReportFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1674"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span><span class="p">)</span>
<a name="ln-1675"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">WaterCoil_SimpleHeating</span><span class="p">)</span>
<a name="ln-1676"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">RptCoilHeaderFlag</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1677"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Water Heating Coil Capacity Information&gt;,Component Type,Name,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1678"></a>               <span class="s1">&#39;Nominal Total Capacity {W}&#39;</span>
<a name="ln-1679"></a>            <span class="n">RptCoilHeaderFlag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1680"></a>          <span class="n">ENDIF</span>
<a name="ln-1681"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilType</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">)</span>
<a name="ln-1682"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilDesCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterHeatingCoilRate</span><span class="p">)</span>
<a name="ln-1683"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span><span class="p">)</span>
<a name="ln-1684"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchHeatCoilNomEff</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-1685"></a>          <span class="k">CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstHeatCoil</span><span class="p">,</span> <span class="s1">&#39;Nominal values are gross at rated conditions, i.e., the supply air fan&#39;</span> <span class="p">&amp;</span>
<a name="ln-1686"></a>                                                  <span class="o">//</span><span class="s1">&#39; heat and electric power NOT accounted for.&#39;</span><span class="p">)</span>
<a name="ln-1687"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Water Heating Coil Capacity Information,Coil:Heating:Water,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1688"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1689"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1690"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">WaterCoil_DetFlatFinCooling</span><span class="p">)</span>
<a name="ln-1691"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">RptCoilHeaderFlag</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1692"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Water Cooling Coil Capacity Information&gt;,Component Type,Name,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1693"></a>               <span class="s1">&#39;Nominal Total Capacity {W},Nominal Sensible Capacity {W},Nominal Latent Capacity {W},&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1694"></a>               <span class="s1">&#39;Nominal Sensible Heat Ratio&#39;</span>
<a name="ln-1695"></a>            <span class="n">RptCoilHeaderFlag</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1696"></a>          <span class="n">ENDIF</span>
<a name="ln-1697"></a>          <span class="n">RatedLatentCapacity</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span>
<a name="ln-1698"></a>          <span class="n">RatedSHR</span> <span class="o">=</span> <span class="n">SafeDivide</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span> <span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-1699"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilType</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">)</span>
<a name="ln-1700"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilDesCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-1701"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-1702"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-1703"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">RatedLatentCapacity</span><span class="p">)</span>
<a name="ln-1704"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">RatedSHR</span><span class="p">)</span>
<a name="ln-1705"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-1706"></a>          <span class="k">CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstCoolCoil</span><span class="p">,</span> <span class="s1">&#39;Nominal values are gross at rated conditions, i.e., the supply air fan&#39;</span> <span class="p">&amp;</span>
<a name="ln-1707"></a>                                                  <span class="o">//</span><span class="s1">&#39; heat and electric power NOT accounted for.&#39;</span><span class="p">)</span>
<a name="ln-1708"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Water Cooling Coil Capacity Information,Coil:Cooling:Water:DetailedGeometry,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1709"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1710"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1711"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1712"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedLatentCapacity</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1713"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">WaterCoil_Cooling</span><span class="p">)</span>
<a name="ln-1714"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">RptCoilHeaderFlag</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1715"></a><span class="k">            WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Water Cooling Coil Capacity Information&gt;,Component Type,Name,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1716"></a>              <span class="s1">&#39;Nominal Total Capacity {W},Nominal Sensible Capacity {W},Nominal Latent Capacity {W},&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1717"></a>              <span class="s1">&#39;Nominal Sensible Heat Ratio, Nominal Coil UA Value {W/C}, Nominal Coil Surface Area {m2}&#39;</span>
<a name="ln-1718"></a>            <span class="n">RptCoilHeaderFlag</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1719"></a>          <span class="n">ENDIF</span>
<a name="ln-1720"></a>          <span class="n">RatedLatentCapacity</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span>
<a name="ln-1721"></a>          <span class="n">RatedSHR</span> <span class="o">=</span> <span class="n">SafeDivide</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span> <span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-1722"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilType</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">)</span>
<a name="ln-1723"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilDesCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-1724"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-1725"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-1726"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">RatedLatentCapacity</span><span class="p">)</span>
<a name="ln-1727"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">RatedSHR</span><span class="p">)</span>
<a name="ln-1728"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<a name="ln-1729"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilUATotal</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span><span class="p">)</span>
<a name="ln-1730"></a>          <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilArea</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span><span class="p">)</span>
<a name="ln-1731"></a>          <span class="k">CALL </span><span class="n">addFootNoteSubTable</span><span class="p">(</span><span class="n">pdstCoolCoil</span><span class="p">,</span> <span class="s1">&#39;Nominal values are gross at rated conditions, i.e., the supply air fan&#39;</span> <span class="p">&amp;</span>
<a name="ln-1732"></a>                                                  <span class="o">//</span><span class="s1">&#39; heat and electric power NOT accounted for.&#39;</span><span class="p">)</span>
<a name="ln-1733"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;Water Cooling Coil Capacity Information,Coil:Cooling:Water,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1734"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1735"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1736"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1737"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedLatentCapacity</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RatedSHR</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1738"></a>             <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">UATotal</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SurfaceArea</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1739"></a>      <span class="k">END SELECT</span>
<a name="ln-1740"></a><span class="k">      IF</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterCoolingCoilRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1741"></a>           <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterCoolingCoilRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span>
<a name="ln-1742"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterHeatingCoilRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1743"></a>           <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterHeatingCoilRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span>
<a name="ln-1744"></a>    <span class="n">ENDIF</span>
<a name="ln-1745"></a>  <span class="n">ENDIF</span>
<a name="ln-1746"></a>
<a name="ln-1747"></a>  <span class="c">! Do the Begin Day initializations</span>
<a name="ln-1748"></a>  <span class="c">! NONE</span>
<a name="ln-1749"></a>
<a name="ln-1750"></a>  <span class="c">! Do the begin HVAC time step initializations</span>
<a name="ln-1751"></a>  <span class="c">! NONE</span>
<a name="ln-1752"></a>
<a name="ln-1753"></a>
<a name="ln-1754"></a>  <span class="c">! Do the following initializations (every time step): This should be the info from</span>
<a name="ln-1755"></a>  <span class="c">! the previous components outlets or the node data in this section.</span>
<a name="ln-1756"></a>  <span class="c">!First set the conditions for the air into the coil model</span>
<a name="ln-1757"></a>  <span class="n">AirInletNode</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-1758"></a>  <span class="n">WaterInletNode</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-1759"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-1760"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1761"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-1762"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-1763"></a>
<a name="ln-1764"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-1765"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-1766"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">WaterInletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-1767"></a>
<a name="ln-1768"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilVariable</span>         <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span>
<a name="ln-1769"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_SimpleHeating</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1770"></a>     <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span> <span class="n">MyUAAndFlowCalcFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>    <span class="c">!update Coil UA based on inlet mass flows and temps</span>
<a name="ln-1771"></a>
<a name="ln-1772"></a>     <span class="n">x_a</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">+</span> <span class="mf">4.769D-3</span><span class="o">*</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">)</span>
<a name="ln-1773"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1774"></a><span class="k">       </span><span class="n">AirConvectTerm</span>  <span class="o">=</span> <span class="n">x_a</span> <span class="o">*</span> <span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirMassFlowRate</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1775"></a>                       <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirSideNominalConvect</span>
<a name="ln-1776"></a>     <span class="k">ELSE</span>
<a name="ln-1777"></a><span class="k">       </span><span class="n">AirConvectTerm</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1778"></a>     <span class="n">ENDIF</span>
<a name="ln-1779"></a>     <span class="n">WaterConvSensitivity</span> <span class="o">=</span> <span class="mf">0.014d0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="mf">0.014d0</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">)</span>
<a name="ln-1780"></a>     <span class="n">x_w</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">+</span> <span class="n">WaterConvSensitivity</span> <span class="o">*</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">)</span>
<a name="ln-1781"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1782"></a><span class="k">       </span><span class="n">WaterConvectTerm</span> <span class="o">=</span>  <span class="n">x_w</span> <span class="o">*</span> <span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span><span class="p">)</span><span class="o">**</span><span class="mf">0.85d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1783"></a>                         <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">LiquidSideNominalConvect</span>
<a name="ln-1784"></a>     <span class="k">ELSE</span>
<a name="ln-1785"></a><span class="k">       </span><span class="n">WaterConvectTerm</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-1786"></a>     <span class="n">ENDIF</span>
<a name="ln-1787"></a>     <span class="k">IF</span> <span class="p">((</span><span class="n">AirConvectTerm</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterConvectTerm</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">))</span> <span class="k">Then</span>
<a name="ln-1788"></a><span class="k">       </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilVariable</span> <span class="o">=</span><span class="mf">1.d0</span> <span class="o">/</span> <span class="p">(</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterConvectTerm</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">/</span> <span class="n">AirConvectTerm</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1789"></a>     <span class="k">ELSE</span>
<a name="ln-1790"></a>       <span class="c">! use nominal UA since variable UA cannot be calculated</span>
<a name="ln-1791"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilVariable</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span>
<a name="ln-1792"></a>     <span class="n">ENDIF</span>
<a name="ln-1793"></a>  <span class="n">ENDIF</span>
<a name="ln-1794"></a>
<a name="ln-1795"></a>  <span class="c">!update Coil UA based on inlet mass flows and temps</span>
<a name="ln-1796"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_Cooling</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">MyCoilDesignFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1797"></a>
<a name="ln-1798"></a><span class="k">     </span><span class="n">x_a</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">+</span> <span class="mf">4.769D-3</span><span class="o">*</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">)</span>
<a name="ln-1799"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1800"></a><span class="k">       </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span>  <span class="o">=</span> <span class="n">x_a</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-1801"></a>             <span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirMassFlowRate</span><span class="p">)</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1802"></a>                       <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternalDes</span>
<a name="ln-1803"></a>     <span class="k">ELSE</span>
<a name="ln-1804"></a><span class="k">       </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternalDes</span>
<a name="ln-1805"></a>     <span class="n">ENDIF</span>
<a name="ln-1806"></a>     <span class="n">WaterConvSensitivity</span> <span class="o">=</span> <span class="mf">0.014d0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="mf">0.014d0</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">)</span>
<a name="ln-1807"></a>     <span class="n">x_w</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">+</span> <span class="n">WaterConvSensitivity</span> <span class="o">*</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">)</span>
<a name="ln-1808"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1809"></a><span class="k">       </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span> <span class="o">=</span>  <span class="n">x_w</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-1810"></a>          <span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span><span class="p">)</span><span class="o">**</span><span class="mf">0.85d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1811"></a>                         <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalDes</span>
<a name="ln-1812"></a>     <span class="k">ELSE</span>
<a name="ln-1813"></a><span class="k">       </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalDes</span>
<a name="ln-1814"></a>     <span class="n">ENDIF</span>
<a name="ln-1815"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1816"></a><span class="k">       </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">+</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">)</span>
<a name="ln-1817"></a>     <span class="k">ELSE</span>
<a name="ln-1818"></a><span class="k">       </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalDes</span>
<a name="ln-1819"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternalDes</span>
<a name="ln-1820"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">+</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">)</span>
<a name="ln-1821"></a>     <span class="k">END IF</span>
<a name="ln-1822"></a><span class="k">     </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalPerUnitArea</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-1823"></a>                                                      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1824"></a>     <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-1825"></a>     <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UADryExtPerUnitArea</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span>
<a name="ln-1826"></a>  <span class="n">ENDIF</span>
<a name="ln-1827"></a>
<a name="ln-1828"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1829"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1830"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1831"></a>
<a name="ln-1832"></a>  <span class="k">RETURN</span>
<a name="ln-1833"></a>
<a name="ln-1834"></a><span class="k">END SUBROUTINE </span><span class="n">InitWaterCoil</span>
<a name="ln-1835"></a>
<a name="ln-1836"></a><span class="k">SUBROUTINE </span><span class="n">SizeWaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span>
<a name="ln-1837"></a>
<a name="ln-1838"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1839"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-1840"></a>          <span class="c">!       DATE WRITTEN   November 2001</span>
<a name="ln-1841"></a>          <span class="c">!       MODIFIED       August 2013 Daeho Kang, add component sizing table entries</span>
<a name="ln-1842"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1843"></a>
<a name="ln-1844"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1845"></a>          <span class="c">! This subroutine is for sizing Water Coil Components for which flow rates and UAs have not been</span>
<a name="ln-1846"></a>          <span class="c">! specified in the input.</span>
<a name="ln-1847"></a>
<a name="ln-1848"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1849"></a>          <span class="c">! Obtains flow rates from the zone or system sizing arrays and plant sizing data. UAs are</span>
<a name="ln-1850"></a>          <span class="c">! calculated by numerically inverting the individual coil calculation routines.</span>
<a name="ln-1851"></a>
<a name="ln-1852"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1853"></a>          <span class="c">! na</span>
<a name="ln-1854"></a>
<a name="ln-1855"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1856"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-1857"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">TrimSigDigits</span><span class="p">,</span> <span class="n">RoundSigDigits</span>
<a name="ln-1858"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RegisterPlantCompDesignFlow</span>
<a name="ln-1859"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span>
<a name="ln-1860"></a>  <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-1861"></a><span class="c">!  USE BranchInputManager, ONLY: MyPlantSizingIndex</span>
<a name="ln-1862"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-1863"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-1864"></a>
<a name="ln-1865"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1866"></a>
<a name="ln-1867"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1868"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-1869"></a>
<a name="ln-1870"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1871"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>          <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>        <span class="c">! Maximum number of iterations</span>
<a name="ln-1872"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">0.0001d0</span>       <span class="c">! Accuracy of result</span>
<a name="ln-1873"></a>
<a name="ln-1874"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1875"></a>          <span class="c">! na</span>
<a name="ln-1876"></a>
<a name="ln-1877"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1878"></a>          <span class="c">! na</span>
<a name="ln-1879"></a>
<a name="ln-1880"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1881"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">PltSizNum</span>     <span class="c">! do loop index for plant sizing</span>
<a name="ln-1882"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">PltSizCoolNum</span> <span class="c">! index of plant sizing object for 1st cooling loop</span>
<a name="ln-1883"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">PltSizHeatNum</span> <span class="c">! index of plant sizing object for 1st heating loop</span>
<a name="ln-1884"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">ErrorsFound</span>   <span class="c">! If errors detected in input</span>
<a name="ln-1885"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilInTemp</span>
<a name="ln-1886"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilOutTemp</span>
<a name="ln-1887"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilOutHumRat</span>
<a name="ln-1888"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilInHumRat</span>
<a name="ln-1889"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesCoilLoad</span>
<a name="ln-1890"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesMassFlow</span>
<a name="ln-1891"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesVolFlow</span>
<a name="ln-1892"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MinFlowFrac</span>
<a name="ln-1893"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FCOAFrac</span>
<a name="ln-1894"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutAirFrac</span>
<a name="ln-1895"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilDesWaterDeltaT</span>  <span class="c">! water delta T used to calculate the design water flow rate</span>
<a name="ln-1896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RhoAirStd</span>     <span class="c">! density of air at standard conditions</span>
<a name="ln-1897"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CpAirStd</span>      <span class="c">! specific heat of air at std conditions</span>
<a name="ln-1898"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SolFla</span>              <span class="c">! Flag of solver</span>
<a name="ln-1899"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA0</span>                 <span class="c">! lower bound for UA</span>
<a name="ln-1900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA1</span>                 <span class="c">! upper bound for UA</span>
<a name="ln-1901"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UA</span>
<a name="ln-1902"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>
<a name="ln-1903"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">LoopErrorsFound</span>
<a name="ln-1904"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">Cp</span>  <span class="c">!</span>
<a name="ln-1905"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span> <span class="c">!</span>
<a name="ln-1906"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesWaterVolFlow</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1907"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesSatEnthAtWaterInTemp</span> <span class="c">! used in testing coil inputs</span>
<a name="ln-1908"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesHumRatAtWaterInTemp</span>  <span class="c">! used in testing coil inputs</span>
<a name="ln-1909"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T1Out</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1910"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">T2Out</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TDpIn</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1912"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">IsAutosize</span>                     <span class="c">! Indicator to autosize</span>
<a name="ln-1913"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">IsAutosizeReq</span>                  <span class="c">! Indicator to autosizereq</span>
<a name="ln-1914"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">HardSizeNoDesRun</span>               <span class="c">! Indicator to hardsize with sizing run</span>
<a name="ln-1915"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MaxWaterVolFlowRateDes</span>         <span class="c">! Autosized max water flow for reporting</span>
<a name="ln-1916"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MaxWaterVolFlowRateUser</span>        <span class="c">! Hardsized max water flow for reporting</span>
<a name="ln-1917"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesAirVolFlowRateDes</span>           <span class="c">! Autosized design air flow for reporting</span>
<a name="ln-1918"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesAirVolFlowRateUser</span>          <span class="c">! Hardsized design air flow for reporting</span>
<a name="ln-1919"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesInletAirtempDes</span>             <span class="c">! Autosized design inlet air temperature for reporting</span>
<a name="ln-1920"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesInletAirtempUser</span>            <span class="c">! Hardsized design inlet air temperature for reporting</span>
<a name="ln-1921"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesInletWaterTempDes</span>           <span class="c">! Autosized design inlet water temperature for reporting</span>
<a name="ln-1922"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesInletWaterTempUser</span>          <span class="c">! Hardsized design inlet water temperature for reporting</span>
<a name="ln-1923"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesOutletAirtempDes</span>            <span class="c">! Autosized design outlet air temperature for reporting</span>
<a name="ln-1924"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesOutletAirtempUser</span>           <span class="c">! Hardsized design outlet air temperature for reporting</span>
<a name="ln-1925"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesInletAirHumRatDes</span>           <span class="c">! Autosized design inlet air humidity ratio for reporting</span>
<a name="ln-1926"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesInletAirHumRatUser</span>          <span class="c">! Hardsized design inlet air humidity ratio for reporting</span>
<a name="ln-1927"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesOutletAirHumRatDes</span>          <span class="c">! Autosized design outlet air humidity ratio for reporting</span>
<a name="ln-1928"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesOutletAirHumRatUser</span>         <span class="c">! Hardsized design outlet air humidity ratio for reporting</span>
<a name="ln-1929"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NumofTubesperRowDes</span>            <span class="c">! Autosized number of tubes per row for reporting</span>
<a name="ln-1930"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NumofTubesperRowUser</span>           <span class="c">! Hardsized number of tubes per row for reporting</span>
<a name="ln-1931"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FinDiamDes</span>                     <span class="c">! Autosized fin diameter for reporting</span>
<a name="ln-1932"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FinDiamUser</span>                    <span class="c">! Hardsized fin diameter for reporting</span>
<a name="ln-1933"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MinAirFlowAreaDes</span>              <span class="c">! Autosized min air flow area for reporting</span>
<a name="ln-1934"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">MinAirFlowAreaUser</span>             <span class="c">! Hardsized min air flow area for reporting</span>
<a name="ln-1935"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FinSurfAreaDes</span>                 <span class="c">! Autosized fin surface area for reporting</span>
<a name="ln-1936"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FinSurfAreaUser</span>                <span class="c">! Hardsized fin surface area for reporting</span>
<a name="ln-1937"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TotTubeInsideAreaDes</span>           <span class="c">! Autosized total tube inside area for reporting</span>
<a name="ln-1938"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TotTubeInsideAreaUser</span>          <span class="c">! Hardsized total tube inside area for reporting</span>
<a name="ln-1939"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TubeOutsideSurfAreaDes</span>         <span class="c">! Autosized total tube outside surface area for reporting</span>
<a name="ln-1940"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TubeOutsideSurfAreaUser</span>        <span class="c">! Hardsized total tube outside surface area for reporting</span>
<a name="ln-1941"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilDepthDes</span>                   <span class="c">! Autosized coil depth for reporting</span>
<a name="ln-1942"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilDepthUser</span>                  <span class="c">! Hardsized coil depth for reporting</span>
<a name="ln-1943"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesWaterHeatingCoilRateDes</span>     <span class="c">! Autosized rated capacity for reporting</span>
<a name="ln-1944"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">DesWaterHeatingCoilRateUser</span>    <span class="c">! Hardsized rated capacity for reporting</span>
<a name="ln-1945"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UACoilDes</span>                      <span class="c">! Autosized UA for reporting</span>
<a name="ln-1946"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UACoilUser</span>                     <span class="c">! Hardsized UA for reporting</span>
<a name="ln-1947"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SizingDesRunThisAirSys</span>            <span class="c">! true if a particular air system had a Sizing:System object and system sizing done</span>
<a name="ln-1948"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">SizingDesRunThisZone</span>              <span class="c">! true if a particular zone had a Sizing:Zone object and zone sizing was done</span>
<a name="ln-1949"></a>
<a name="ln-1950"></a>  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1951"></a>  <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1952"></a>  <span class="n">IsAutosizeReq</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1953"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SysSizingRunDone</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneSizingRunDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1954"></a><span class="k">    </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1955"></a>  <span class="k">ELSE</span>
<a name="ln-1956"></a><span class="k">    </span><span class="n">HardSizeNoDesRun</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1957"></a>  <span class="n">ENDIF</span>
<a name="ln-1958"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1959"></a><span class="k">    CALL </span><span class="n">CheckThisAirSystemForSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">,</span> <span class="n">SizingDesRunThisAirSys</span> <span class="p">)</span>
<a name="ln-1960"></a>  <span class="k">ELSE</span>
<a name="ln-1961"></a><span class="k">    </span><span class="n">SizingDesRunThisAirSys</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1962"></a>  <span class="n">ENDIF</span>
<a name="ln-1963"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1964"></a><span class="k">    CALL </span><span class="n">CheckThisZoneForSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">,</span> <span class="n">SizingDesRunThisZone</span><span class="p">)</span>
<a name="ln-1965"></a>  <span class="k">ELSE</span>
<a name="ln-1966"></a><span class="k">    </span><span class="n">SizingDesRunThisZone</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1967"></a>  <span class="n">ENDIF</span>
<a name="ln-1968"></a>  <span class="n">PltSizCoolNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1969"></a>  <span class="n">PltSizHeatNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1970"></a>  <span class="n">PltSizNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1971"></a>  <span class="n">CoilInTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1972"></a>  <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1973"></a>  <span class="n">CoilOutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1974"></a>  <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1975"></a>  <span class="n">MinFlowFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1976"></a>  <span class="n">DesMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1977"></a>  <span class="n">RhoAirStd</span> <span class="o">=</span> <span class="n">StdRhoAir</span>
<a name="ln-1978"></a>  <span class="n">CpAirStd</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-1979"></a>  <span class="n">CoilDesWaterDeltaT</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1980"></a>  <span class="n">LoopErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1981"></a>  <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1982"></a>  <span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1983"></a>  <span class="n">MaxWaterVolFlowRateUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1984"></a>  <span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1985"></a>  <span class="n">DesAirVolFlowRateUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1986"></a>  <span class="n">DesInletAirtempDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1987"></a>  <span class="n">DesInletAirtempUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1988"></a>  <span class="n">DesInletWaterTempDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1989"></a>  <span class="n">DesInletWaterTempUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1990"></a>  <span class="n">DesOutletAirtempDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1991"></a>  <span class="n">DesOutletAirtempUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1992"></a>  <span class="n">DesInletAirHumRatDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1993"></a>  <span class="n">DesInletAirHumRatUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1994"></a>  <span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1995"></a>  <span class="n">DesOutletAirHumRatUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1996"></a>  <span class="n">NumofTubesperRowDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1997"></a>  <span class="n">NumofTubesperRowUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1998"></a>  <span class="n">FinDiamDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1999"></a>  <span class="n">FinDiamUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2000"></a>  <span class="n">MinAirFlowAreaDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2001"></a>  <span class="n">MinAirFlowAreaUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2002"></a>  <span class="n">FinSurfAreaDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2003"></a>  <span class="n">FinSurfAreaUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2004"></a>  <span class="n">TotTubeInsideAreaDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2005"></a>  <span class="n">TotTubeInsideAreaUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2006"></a>  <span class="n">TubeOutsideSurfAreaDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2007"></a>  <span class="n">TubeOutsideSurfAreaUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2008"></a>  <span class="n">CoilDepthDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2009"></a>  <span class="n">CoilDepthUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2010"></a>  <span class="n">DesWaterHeatingCoilRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2011"></a>  <span class="n">DesWaterHeatingCoilRateUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2012"></a>  <span class="n">UACoilDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2013"></a>  <span class="n">UACoilUser</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2014"></a>
<a name="ln-2015"></a>  <span class="c">! cooling coils</span>
<a name="ln-2016"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span> <span class="o">==</span> <span class="n">CoilType_Cooling</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-2017"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2018"></a>    <span class="c">! find the appropriate Plant Sizing object</span>
<a name="ln-2019"></a>    <span class="n">PltSizCoolNum</span> <span class="o">=</span> <span class="n">MyPlantSizingIndex</span><span class="p">(</span><span class="s2">&quot;chilled water coil&quot;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2020"></a>                                       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span> <span class="n">LoopErrorsFound</span><span class="p">)</span>
<a name="ln-2021"></a>  <span class="n">ENDIF</span>
<a name="ln-2022"></a>
<a name="ln-2023"></a>  <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2024"></a>                       <span class="mf">5.0d0</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-2025"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2026"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>  <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2029"></a>                       <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-2030"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2031"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-2032"></a>
<a name="ln-2033"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span> <span class="o">==</span> <span class="n">CoilType_Cooling</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2034"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizCoolNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2035"></a>      <span class="c">! if this is a central system coil</span>
<a name="ln-2036"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2037"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2038"></a><span class="k">          </span><span class="n">IsAutosizeReq</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2039"></a>        <span class="k">END IF</span>
<a name="ln-2040"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosizeReq</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SizingDesRunThisAirSys</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-2041"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2042"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2043"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2044"></a>                                    <span class="s1">&#39;User-Specified Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-2045"></a>            <span class="k">END IF</span>
<a name="ln-2046"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2047"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2048"></a>                                    <span class="s1">&#39;User-Specified Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span><span class="p">)</span>
<a name="ln-2049"></a>            <span class="k">END IF</span>
<a name="ln-2050"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2051"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2052"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span><span class="p">)</span>
<a name="ln-2053"></a>            <span class="k">END IF</span>
<a name="ln-2054"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2055"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2056"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Water Temperature [C]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span><span class="p">)</span>
<a name="ln-2057"></a>            <span class="k">END IF</span>
<a name="ln-2058"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2059"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2060"></a>                                    <span class="s1">&#39;User-Specified Design Outlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">)</span>
<a name="ln-2061"></a>            <span class="k">END IF</span>
<a name="ln-2062"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2063"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-2064"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">)</span>
<a name="ln-2065"></a>            <span class="k">END IF</span>
<a name="ln-2066"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2067"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2068"></a>                                    <span class="s1">&#39;User-Specified Design Outlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">)</span>
<a name="ln-2069"></a>            <span class="k">END IF</span>
<a name="ln-2070"></a>
<a name="ln-2071"></a><span class="k">          ELSE IF</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2072"></a>
<a name="ln-2073"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2074"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2075"></a>                                    <span class="s1">&#39;User-Specified Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-2076"></a>            <span class="k">END IF</span>
<a name="ln-2077"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2078"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2079"></a>                                    <span class="s1">&#39;User-Specified Tube Outside Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span><span class="p">)</span>
<a name="ln-2080"></a>            <span class="k">END IF</span>
<a name="ln-2081"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2082"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2083"></a>                                    <span class="s1">&#39;User-Specified Total Tube Inside Area [m2]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span><span class="p">)</span>
<a name="ln-2084"></a>            <span class="k">END IF</span>
<a name="ln-2085"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2086"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2087"></a>                                    <span class="s1">&#39;User-Specified Fin Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span><span class="p">)</span>
<a name="ln-2088"></a>            <span class="k">END IF</span>
<a name="ln-2089"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2090"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2091"></a>                                    <span class="s1">&#39;User-Specified Minimum Airflow Area [m2]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span><span class="p">)</span>
<a name="ln-2092"></a>            <span class="k">END IF</span>
<a name="ln-2093"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2094"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2095"></a>                                    <span class="s1">&#39;User-Specified Coil Depth [m]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span><span class="p">)</span>
<a name="ln-2096"></a>            <span class="k">END IF</span>
<a name="ln-2097"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2098"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2099"></a>                                    <span class="s1">&#39;User-Specified Fin Diameter [m]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span><span class="p">)</span>
<a name="ln-2100"></a>            <span class="k">END IF</span>
<a name="ln-2101"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2102"></a><span class="k">              </span><span class="n">NumofTubesperRowUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="c">! convert integer to real for reporting</span>
<a name="ln-2103"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2104"></a>                                    <span class="s1">&#39;User-Specified Number of Tubes per Row&#39;</span><span class="p">,</span><span class="n">NumofTubesperRowUser</span><span class="p">)</span>
<a name="ln-2105"></a>            <span class="k">END IF</span>
<a name="ln-2106"></a><span class="k">          END IF</span>
<a name="ln-2107"></a><span class="k">        ELSE</span> <span class="c">! At least one field is autosize</span>
<a name="ln-2108"></a>          <span class="k">If</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! &#39;DETAILED FLAT FIN&#39;</span>
<a name="ln-2109"></a>            <span class="k">CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2110"></a>          <span class="n">ElseIf</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2111"></a>            <span class="k">CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2112"></a>          <span class="k">End If</span>
<a name="ln-2113"></a>        <span class="c">!ENDIF</span>
<a name="ln-2114"></a>        <span class="c">! if the water flow rate needs autosizing, calculate the volume flow rate</span>
<a name="ln-2115"></a><span class="c">!          If(WaterCoil(CoilNum)%WaterCoilModel == CoilModel_Detailed) Then  ! &#39;DETAILED FLAT FIN&#39;</span>
<a name="ln-2116"></a><span class="c">!            CALL CheckSysSizing(&#39;Coil:Cooling:Water:DetailedGeometry&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-2117"></a><span class="c">!          ElseIf(WaterCoil(CoilNum)%WaterCoilModel == CoilModel_Cooling) Then  ! &#39;Cooling&#39;</span>
<a name="ln-2118"></a><span class="c">!            CALL CheckSysSizing(&#39;Coil:Cooling:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-2119"></a><span class="c">!          End If</span>
<a name="ln-2120"></a>          <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2121"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2122"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2123"></a>          <span class="k">END IF</span>
<a name="ln-2124"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2125"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2126"></a>          <span class="k">ELSE</span>
<a name="ln-2127"></a><span class="k">            SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-2128"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-2129"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2130"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2131"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-2132"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-2133"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-2134"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-2135"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-2136"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-2137"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-2138"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2139"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2140"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2141"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2142"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2143"></a>            <span class="k">END SELECT</span>
<a name="ln-2144"></a><span class="k">          END IF</span>
<a name="ln-2145"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA system</span>
<a name="ln-2146"></a>            <span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2147"></a>            <span class="n">CoilOutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-2148"></a>            <span class="n">CoilOutHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-2149"></a>            <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-2150"></a>          <span class="k">ELSE</span> <span class="c">! coil is in the main air loop</span>
<a name="ln-2151"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-2152"></a>              <span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-2153"></a>              <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-2154"></a>            <span class="k">ELSE</span> <span class="c">! thereis precooling of the OA stream</span>
<a name="ln-2155"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DesVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2156"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">DesVolFlow</span>
<a name="ln-2157"></a>              <span class="k">ELSE</span>
<a name="ln-2158"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2159"></a>              <span class="k">END IF</span>
<a name="ln-2160"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-2161"></a>              <span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2162"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-2163"></a>              <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2164"></a>                         <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-2165"></a>            <span class="k">END IF</span>
<a name="ln-2166"></a><span class="k">            </span><span class="n">CoilOutHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-2167"></a>            <span class="n">CoilOutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-2168"></a>          <span class="k">END IF</span>
<a name="ln-2169"></a><span class="c">! None of these IF tests for &quot;.and. WaterCoil(CoilNum)%WaterCoilModel==CoilModel_Cooling&quot; are needed inside the outermost IF block</span>
<a name="ln-2170"></a>          <span class="k">If</span><span class="p">((</span><span class="n">CoilOutHumRat</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">CoilInHumRat</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-2171"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Coil=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2172"></a>                                  <span class="s1">&#39;&quot;, Cooling Coil has leaving humidity ratio &gt; entering humidity ratio.&#39;</span><span class="p">)</span>
<a name="ln-2173"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,in =  &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CoilInHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2174"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CoilOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2175"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">CoilInHumRat</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">016</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2176"></a><span class="k">              </span><span class="n">CoilOutHumRat</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">CoilInHumRat</span>
<a name="ln-2177"></a>            <span class="k">ELSE</span>
<a name="ln-2178"></a><span class="k">              </span><span class="n">CoilOutHumRat</span> <span class="o">=</span> <span class="n">CoilInHumRat</span>
<a name="ln-2179"></a>            <span class="k">END IF</span>
<a name="ln-2180"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;....coil chilled water flow rate will be sized using:&#39;</span><span class="p">)</span>
<a name="ln-2181"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CoilOutHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2182"></a>          <span class="k">End if</span>
<a name="ln-2183"></a><span class="k">          </span><span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>  <span class="p">&amp;</span>
<a name="ln-2184"></a>                          <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CoilInTemp</span><span class="p">,</span> <span class="n">CoilInHumRat</span><span class="p">)</span><span class="o">-</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CoilOutTemp</span><span class="p">,</span> <span class="n">CoilOutHumRat</span><span class="p">))</span>
<a name="ln-2185"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2186"></a><span class="k">            </span><span class="n">CoilDesWaterDeltaT</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCoolNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-2187"></a>          <span class="k">ELSE</span>
<a name="ln-2188"></a><span class="k">            </span><span class="n">CoilDesWaterDeltaT</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCoolNum</span><span class="p">)%</span><span class="n">DeltaT</span>
<a name="ln-2189"></a>          <span class="k">END IF</span>
<a name="ln-2190"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DesCoilLoad</span>  <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2191"></a>
<a name="ln-2192"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">DesCoilLoad</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2193"></a>                                     <span class="p">(</span> <span class="n">CoilDesWaterDeltaT</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-2194"></a>          <span class="k">ELSE</span>
<a name="ln-2195"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2196"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The design coil load is zero for Coil:Cooling:Water &#39;</span> <span class="p">&amp;</span>
<a name="ln-2197"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2198"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The autosize value for max water flow rate is zero&#39;</span><span class="p">)</span>
<a name="ln-2199"></a>          <span class="k">END IF</span>
<a name="ln-2200"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterCoolingCoilRate</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-2201"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2202"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="n">MaxWaterVolFlowRateDes</span>
<a name="ln-2203"></a>            <span class="k">If</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! &#39;DETAILED FLAT FIN&#39;</span>
<a name="ln-2204"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2205"></a>                                    <span class="s1">&#39;Design Size Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-2206"></a>            <span class="n">ElseIf</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2207"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2208"></a>                                    <span class="s1">&#39;Design Size Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterCoolingCoilRate</span><span class="p">)</span>
<a name="ln-2209"></a>            <span class="k">END IF</span>
<a name="ln-2210"></a><span class="k">            If</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! &#39;DETAILED FLAT FIN&#39;</span>
<a name="ln-2211"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2212"></a>                                    <span class="s1">&#39;Design Size Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">)</span>
<a name="ln-2213"></a>            <span class="n">ElseIf</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2214"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2215"></a>                                    <span class="s1">&#39;Design Size Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">)</span>
<a name="ln-2216"></a>            <span class="k">END IF</span>
<a name="ln-2217"></a><span class="k">          ELSE</span>
<a name="ln-2218"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-2219"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MaxWaterVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2220"></a><span class="k">              IF</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! &#39;DETAILED FLAT FIN&#39;</span>
<a name="ln-2221"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2222"></a>                                    <span class="s1">&#39;Design Size Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2223"></a>                                    <span class="s1">&#39;User-Specified Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span>
<a name="ln-2224"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2225"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">-</span> <span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span><span class="o">/</span> <span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2226"></a>                            <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2227"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2228"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2229"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Maximum Water Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2230"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-2231"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Maximum Water Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2232"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-2233"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2234"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2235"></a>                  <span class="k">END IF</span>
<a name="ln-2236"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-2237"></a>              <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2238"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2239"></a>                                    <span class="s1">&#39;Design Size Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2240"></a>                                    <span class="s1">&#39;User-Specified Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span>
<a name="ln-2241"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2242"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">-</span> <span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2243"></a>                                  <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2244"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2245"></a>                                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2246"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Water Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2247"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-2248"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Water Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2249"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-2250"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2251"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2252"></a>                  <span class="k">END IF</span>
<a name="ln-2253"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-2254"></a>              <span class="k">END IF</span>
<a name="ln-2255"></a><span class="k">            END IF</span>
<a name="ln-2256"></a><span class="k">          END IF</span>
<a name="ln-2257"></a>
<a name="ln-2258"></a>        <span class="c">! if the design input coil design air vol flow rate input needs autosizing, calculate it</span>
<a name="ln-2259"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2260"></a><span class="k">            </span><span class="n">IsAutosize</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2261"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2262"></a>            <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2263"></a>            <span class="k">END IF</span>
<a name="ln-2264"></a><span class="c">!          CALL CheckSysSizing(&#39;Coil:Cooling:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-2265"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2266"></a><span class="k">              </span><span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2267"></a>            <span class="k">ELSE</span>
<a name="ln-2268"></a><span class="k">              SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-2269"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-2270"></a>                  <span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2271"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-2272"></a>                 <span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-2273"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-2274"></a>                  <span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-2275"></a>                <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-2276"></a>                  <span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2277"></a>                <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2278"></a>                  <span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2279"></a>              <span class="k">END SELECT</span>
<a name="ln-2280"></a><span class="k">            END IF</span>
<a name="ln-2281"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DesAirVolFlowRateDes</span>  <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2282"></a><span class="k">              </span><span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2283"></a>              <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The design air flow rate is zero for Coil:Cooling:Water &#39;</span> <span class="p">&amp;</span>
<a name="ln-2284"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2285"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The autosize value for max air volume flow rate is zero&#39;</span><span class="p">)</span>
<a name="ln-2286"></a>            <span class="k">END IF</span>
<a name="ln-2287"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2288"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">=</span> <span class="n">DesAirVolFlowRateDes</span>
<a name="ln-2289"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2290"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2291"></a>                                    <span class="s1">&#39;Design Size Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">DesAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-2292"></a>              <span class="k">END IF</span>
<a name="ln-2293"></a><span class="k">            ELSE</span>
<a name="ln-2294"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesAirVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2295"></a><span class="k">                </span><span class="n">DesAirVolFlowRateUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span>
<a name="ln-2296"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2297"></a>                  <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2298"></a>                                    <span class="s1">&#39;Design Size Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">DesAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2299"></a>                                    <span class="s1">&#39;User-Specified Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">DesAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-2300"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2301"></a><span class="k">                    IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesAirVolFlowRateDes</span> <span class="o">-</span> <span class="n">DesAirVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">DesAirVolFlowRateUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2302"></a><span class="k">                      CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2303"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2304"></a>                      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Air Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2305"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesAirVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-2306"></a>                      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Air Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2307"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesAirVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-2308"></a>                      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2309"></a>                      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2310"></a>                    <span class="k">END IF</span>
<a name="ln-2311"></a><span class="k">                  </span><span class="n">ENDIF</span>
<a name="ln-2312"></a>                <span class="k">END IF</span>
<a name="ln-2313"></a><span class="k">              END IF</span>
<a name="ln-2314"></a><span class="k">            END IF</span>
<a name="ln-2315"></a>
<a name="ln-2316"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2317"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!  &#39;Cooling&#39;</span>
<a name="ln-2318"></a>              <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2319"></a>            <span class="k">END IF</span>
<a name="ln-2320"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in OA stream</span>
<a name="ln-2321"></a>              <span class="n">DesInletAirtempDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2322"></a>            <span class="k">ELSE</span> <span class="c">! coil is in main air loop</span>
<a name="ln-2323"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-2324"></a>                <span class="n">DesInletAirtempDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-2325"></a>              <span class="k">ELSE</span> <span class="c">! thereis precooling of the OA stream</span>
<a name="ln-2326"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DesVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2327"></a><span class="k">                  </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">DesVolFlow</span>
<a name="ln-2328"></a>                <span class="k">ELSE</span>
<a name="ln-2329"></a><span class="k">                  </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2330"></a>                <span class="k">END IF</span>
<a name="ln-2331"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-2332"></a>                <span class="n">DesInletAirtempDes</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2333"></a>                         <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-2334"></a>              <span class="k">END IF</span>
<a name="ln-2335"></a><span class="k">            END IF</span>
<a name="ln-2336"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2337"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span> <span class="o">=</span> <span class="n">DesInletAirtempDes</span>
<a name="ln-2338"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2339"></a>                                    <span class="s1">&#39;Design Size Design Inlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletAirtempDes</span><span class="p">)</span>
<a name="ln-2340"></a>            <span class="k">ELSE</span>
<a name="ln-2341"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesInletAirtempDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2342"></a><span class="k">                </span><span class="n">DesInletAirtempUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span>
<a name="ln-2343"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2344"></a>                                    <span class="s1">&#39;Design Size Design Inlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletAirtempDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2345"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletAirtempUser</span><span class="p">)</span>
<a name="ln-2346"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2347"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesInletAirtempDes</span> <span class="o">-</span> <span class="n">DesInletAirtempUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingDeltaTempThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2348"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2349"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2350"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Inlet Air Temperature of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2351"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletAirtempUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-2352"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Inlet Air Temperature of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2353"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletAirtempDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-2354"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2355"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2356"></a>                  <span class="k">END IF</span>
<a name="ln-2357"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-2358"></a>              <span class="k">END IF</span>
<a name="ln-2359"></a><span class="k">            END IF</span>
<a name="ln-2360"></a>
<a name="ln-2361"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2362"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!  &#39;Cooling&#39;</span>
<a name="ln-2363"></a>              <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2364"></a>            <span class="k">END IF</span>
<a name="ln-2365"></a><span class="k">            </span><span class="n">DesInletWaterTempDes</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCoolNum</span><span class="p">)%</span><span class="n">ExitTemp</span>
<a name="ln-2366"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2367"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span> <span class="o">=</span> <span class="n">DesInletwatertempDes</span>
<a name="ln-2368"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2369"></a>                                    <span class="s1">&#39;Design Size Design Inlet Water Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletwatertempDes</span><span class="p">)</span>
<a name="ln-2370"></a>            <span class="k">ELSE</span>
<a name="ln-2371"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesInletwatertempDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2372"></a><span class="k">                </span><span class="n">DesInletwatertempUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span>
<a name="ln-2373"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2374"></a>                                    <span class="s1">&#39;Design Size Design Inlet Water Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletwatertempDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2375"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Water Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletwatertempUser</span><span class="p">)</span>
<a name="ln-2376"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2377"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesInletwatertempDes</span> <span class="o">-</span> <span class="n">DesInletwatertempUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingDeltaTempThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2378"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2379"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2380"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Inlet Water Temperature of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2381"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletwatertempUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-2382"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Inlet Water Temperature of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2383"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletWatertempDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-2384"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2385"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2386"></a>                  <span class="k">END IF</span>
<a name="ln-2387"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-2388"></a>              <span class="k">END IF</span>
<a name="ln-2389"></a><span class="k">            END IF</span>
<a name="ln-2390"></a>
<a name="ln-2391"></a><span class="k">            </span><span class="n">IsAutosize</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2392"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!  &#39;Cooling&#39;</span>
<a name="ln-2393"></a>            <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2394"></a>            <span class="k">END IF</span>
<a name="ln-2395"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2396"></a><span class="k">              </span><span class="n">DesOutletAirTempDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-2397"></a>            <span class="k">ELSE</span>
<a name="ln-2398"></a><span class="k">              </span><span class="n">DesOutletAirTempDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-2399"></a>            <span class="k">END IF</span>
<a name="ln-2400"></a><span class="k">            If</span> <span class="p">(</span><span class="n">DesOutletAirTempDes</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="p">&amp;</span>
<a name="ln-2401"></a>               <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2402"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Coil=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2403"></a>                                  <span class="s1">&#39;&quot;, Cooling Coil has leaving air temperature &gt; entering water temperature.&#39;</span><span class="p">)</span>
<a name="ln-2404"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Tair,out  =  &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirTempDes</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2405"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Twater,in = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2406"></a>              <span class="n">DesOutletAirTempDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="o">+</span> <span class="mf">0.5d0</span>
<a name="ln-2407"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;....coil leaving air temperature will be reset to:&#39;</span><span class="p">)</span>
<a name="ln-2408"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Tair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirTempDes</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-2409"></a>            <span class="k">End If</span>
<a name="ln-2410"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2411"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">=</span> <span class="n">DesOutletAirTempDes</span>
<a name="ln-2412"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2413"></a>                                    <span class="s1">&#39;Design Size Design Outlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesOutletAirTempDes</span><span class="p">)</span>
<a name="ln-2414"></a>            <span class="k">ELSE</span>
<a name="ln-2415"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesOutletAirTempDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2416"></a><span class="k">                </span><span class="n">DesOutletAirTempUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span>
<a name="ln-2417"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2418"></a>                                    <span class="s1">&#39;Design Size Design Outlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesOutletAirTempDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2419"></a>                                    <span class="s1">&#39;User-Specified Design Outlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesOutletAirTempUser</span><span class="p">)</span>
<a name="ln-2420"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2421"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesOutletAirTempDes</span> <span class="o">-</span> <span class="n">DesOutletAirTempUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingDeltaTempThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2422"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2423"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2424"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Outlet Air Temperature of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2425"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirTempUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-2426"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Outlet Air Temperature of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2427"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirTempDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-2428"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2429"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2430"></a>                  <span class="k">END IF</span>
<a name="ln-2431"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-2432"></a>              <span class="k">END IF</span>
<a name="ln-2433"></a><span class="k">            END IF</span>
<a name="ln-2434"></a>
<a name="ln-2435"></a><span class="k">            </span><span class="n">IsAutosize</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2436"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!  &#39;Cooling&#39;</span>
<a name="ln-2437"></a>              <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2438"></a>            <span class="k">END IF</span>
<a name="ln-2439"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in OA stream</span>
<a name="ln-2440"></a>              <span class="n">DesInletAirHumRatDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-2441"></a>            <span class="k">ELSE</span> <span class="c">! coil is in main air loop</span>
<a name="ln-2442"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-2443"></a>                <span class="n">DesInletAirHumRatDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-2444"></a>              <span class="k">ELSE</span> <span class="c">! there is precooling of the OA stream</span>
<a name="ln-2445"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DesVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2446"></a><span class="k">                  </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">DesVolFlow</span>
<a name="ln-2447"></a>                <span class="k">ELSE</span>
<a name="ln-2448"></a><span class="k">                  </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2449"></a>                <span class="k">END IF</span>
<a name="ln-2450"></a><span class="k">                </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-2451"></a>                <span class="n">DesInletAirHumRatDes</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2452"></a>                         <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-2453"></a>              <span class="k">END IF</span>
<a name="ln-2454"></a><span class="k">            END IF</span>
<a name="ln-2455"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2456"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">=</span> <span class="n">DesInletAirHumRatDes</span>
<a name="ln-2457"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2458"></a>                                    <span class="s1">&#39;Design Size Design Inlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesInletAirHumRatDes</span><span class="p">)</span>
<a name="ln-2459"></a>            <span class="k">ELSE</span>
<a name="ln-2460"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesInletAirHumRatDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2461"></a><span class="k">                </span><span class="n">DesInletAirHumRatUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-2462"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2463"></a>                                    <span class="s1">&#39;Design Size Design Inlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesInletAirHumRatDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2464"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesInletAirHumRatUser</span><span class="p">)</span>
<a name="ln-2465"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2466"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesInletAirHumRatDes</span> <span class="o">-</span> <span class="n">DesInletAirHumRatUser</span><span class="p">)</span><span class="o">/</span><span class="n">DesInletAirHumRatUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2467"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2468"></a>                                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2469"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Inlet Air Humidity Ratio of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2470"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletAirHumRatUser</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2471"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Inlet Air Humidity Ratio of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2472"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2473"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2474"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2475"></a>                  <span class="k">END IF</span>
<a name="ln-2476"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-2477"></a>              <span class="k">END IF</span>
<a name="ln-2478"></a><span class="k">            END IF</span>
<a name="ln-2479"></a>
<a name="ln-2480"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2481"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!  &#39;Cooling&#39;</span>
<a name="ln-2482"></a>              <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2483"></a>            <span class="k">END IF</span>
<a name="ln-2484"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2485"></a><span class="k">              </span><span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-2486"></a>            <span class="k">ELSE</span>
<a name="ln-2487"></a><span class="k">              </span><span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-2488"></a>            <span class="k">END IF</span>
<a name="ln-2489"></a><span class="k">            If</span> <span class="p">(</span><span class="n">DesOutletAirHumRatDes</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="p">&amp;</span>
<a name="ln-2490"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-2491"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Coil=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2492"></a>                                  <span class="s1">&#39;&quot;, Cooling Coil has leaving humidity ratio &gt; entering humidity ratio.&#39;</span><span class="p">)</span>
<a name="ln-2493"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,in =  &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2494"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2495"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">016</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2496"></a><span class="k">                </span><span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-2497"></a>              <span class="k">ELSE</span>
<a name="ln-2498"></a><span class="k">                </span><span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-2499"></a>              <span class="k">END IF</span>
<a name="ln-2500"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;....coil leaving humidity ratio will be reset to:&#39;</span><span class="p">)</span>
<a name="ln-2501"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2502"></a>            <span class="k">End If</span>
<a name="ln-2503"></a>
<a name="ln-2504"></a>            <span class="c">! check for dry coil and reset outlet humrat if needed</span>
<a name="ln-2505"></a>            <span class="n">DesSatEnthAtWaterInTemp</span> <span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2506"></a>                                             <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">))</span>
<a name="ln-2507"></a>            <span class="n">DesHumRatAtWaterInTemp</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="n">DesSatEnthAtWaterInTemp</span><span class="p">,</span><span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-2508"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DesOutletAirHumRatDes</span> <span class="o">&lt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2509"></a>              <span class="n">DesHumRatAtWaterInTemp</span> <span class="o">&gt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2510"></a>              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2511"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">&gt;</span> <span class="n">DesOutletAirHumRatDes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2512"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Coil=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2513"></a>                                  <span class="s1">&#39;&quot;, Cooling Coil is dry and has air leaving humidity ratio &lt; entering humidity ratio.&#39;</span><span class="p">)</span>
<a name="ln-2514"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,in =  &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2515"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2516"></a>                <span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-2517"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;....coil leaving humidity ratio will be reset to:&#39;</span><span class="p">)</span>
<a name="ln-2518"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2519"></a>              <span class="k">END IF</span>
<a name="ln-2520"></a><span class="k">            END IF</span>
<a name="ln-2521"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2522"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">=</span> <span class="n">DesOutletAirHumRatDes</span>
<a name="ln-2523"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2524"></a>                                    <span class="s1">&#39;Design Size Design Outlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesOutletAirHumRatDes</span><span class="p">)</span>
<a name="ln-2525"></a>            <span class="k">ELSE</span>
<a name="ln-2526"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesOutletAirHumRatDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2527"></a><span class="k">                </span><span class="n">DesOutletAirHumRatUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span>
<a name="ln-2528"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2529"></a>                                    <span class="s1">&#39;Design Size Design Outlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2530"></a>                                    <span class="s1">&#39;User-Specified Design Outlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesOutletAirHumRatUser</span><span class="p">)</span>
<a name="ln-2531"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2532"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span> <span class="o">-</span> <span class="n">DesOutletAirHumRatUser</span><span class="p">)</span><span class="o">/</span><span class="n">DesOutletAirHumRatUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2533"></a>                                   <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2534"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2535"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2536"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Outlet Air Humidity Ratio of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2537"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatUser</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2538"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Outlet Air Humidity Ratio of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2539"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2540"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2541"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2542"></a>                  <span class="k">END IF</span>
<a name="ln-2543"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-2544"></a>              <span class="k">END IF</span>
<a name="ln-2545"></a><span class="k">            END IF</span>
<a name="ln-2546"></a><span class="k">          END IF</span> <span class="c">! End of simple coooling coil autosizable fields</span>
<a name="ln-2547"></a>
<a name="ln-2548"></a>          <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2549"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2550"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2551"></a>          <span class="k">END IF</span>
<a name="ln-2552"></a><span class="k">          </span><span class="n">NumofTubesperRowDes</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">1375</span><span class="mf">0.d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2553"></a>          <span class="n">NumofTubesperRowDes</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">3.d0</span><span class="p">,</span> <span class="n">NumofTubesperRowDes</span><span class="p">)</span>
<a name="ln-2554"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2555"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="o">=</span> <span class="n">NumofTubesperRowDes</span>
<a name="ln-2556"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2557"></a>                                    <span class="s1">&#39;Design Size Number of Tubes per Row&#39;</span><span class="p">,</span><span class="n">NumofTubesperRowDes</span><span class="p">)</span>
<a name="ln-2558"></a>          <span class="k">ELSE</span>
<a name="ln-2559"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumofTubesperRowDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2560"></a><span class="k">              </span><span class="n">NumofTubesperRowUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span>
<a name="ln-2561"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2562"></a>                                    <span class="s1">&#39;Design Size Number of Tubes per Row&#39;</span><span class="p">,</span><span class="n">NumofTubesperRowDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2563"></a>                                    <span class="s1">&#39;User-Specified Number of Tubes per Row&#39;</span><span class="p">,</span><span class="n">NumofTubesperRowUser</span><span class="p">)</span>
<a name="ln-2564"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2565"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">NumofTubesperRowDes</span> <span class="o">-</span> <span class="n">NumofTubesperRowUser</span><span class="p">)</span><span class="o">/</span><span class="n">NumofTubesperRowUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2566"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2567"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2568"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Number of Tubes per Row of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2569"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumofTubesperRowUser</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2570"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Number of Tubes per Row of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2571"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumofTubesperRowDes</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2572"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2573"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2574"></a>                <span class="k">END IF</span>
<a name="ln-2575"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-2576"></a>            <span class="k">END IF</span>
<a name="ln-2577"></a><span class="k">          END IF</span>
<a name="ln-2578"></a>
<a name="ln-2579"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2580"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2581"></a><span class="k">             </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2582"></a>          <span class="k">END IF</span>
<a name="ln-2583"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2584"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2585"></a>          <span class="k">ELSE</span>
<a name="ln-2586"></a><span class="k">            SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-2587"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-2588"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2589"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-2590"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-2591"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-2592"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-2593"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-2594"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2595"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2596"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2597"></a>            <span class="k">END SELECT</span>
<a name="ln-2598"></a><span class="k">          END IF</span>
<a name="ln-2599"></a><span class="k">          </span><span class="n">FinDiamDes</span> <span class="o">=</span> <span class="mf">0.335d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-2600"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2601"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">=</span> <span class="n">FinDiamDes</span>
<a name="ln-2602"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2603"></a>                                  <span class="s1">&#39;Design Size Fin Diameter [m]&#39;</span><span class="p">,</span><span class="n">FinDiamDes</span><span class="p">)</span>
<a name="ln-2604"></a>          <span class="k">ELSE</span>
<a name="ln-2605"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FinDiamDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2606"></a><span class="k">                </span><span class="n">FinDiamUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span>
<a name="ln-2607"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2608"></a>                                    <span class="s1">&#39;Design Size Fin Diameter [m]&#39;</span><span class="p">,</span><span class="n">FinDiamDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2609"></a>                                    <span class="s1">&#39;User-Specified Fin Diameter [m]&#39;</span><span class="p">,</span><span class="n">FinDiamUser</span><span class="p">)</span>
<a name="ln-2610"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2611"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">FinDiamDes</span> <span class="o">-</span> <span class="n">FinDiamUser</span><span class="p">)</span><span class="o">/</span><span class="n">FinDiamUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2612"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2613"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2614"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Fin Diameter of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2615"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FinDiamUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-2616"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Fin Diameter of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2617"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FinDiamUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-2618"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2619"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2620"></a>                <span class="k">END IF</span>
<a name="ln-2621"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-2622"></a>            <span class="k">END IF</span>
<a name="ln-2623"></a><span class="k">          END IF</span>
<a name="ln-2624"></a>
<a name="ln-2625"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2626"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2627"></a><span class="k">              </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2628"></a>          <span class="k">END IF</span>
<a name="ln-2629"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2630"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2631"></a>          <span class="k">ELSE</span>
<a name="ln-2632"></a><span class="k">            SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-2633"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-2634"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2635"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-2636"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-2637"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-2638"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-2639"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-2640"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2641"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2642"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2643"></a>            <span class="k">END SELECT</span>
<a name="ln-2644"></a><span class="k">          END IF</span>
<a name="ln-2645"></a><span class="k">          </span><span class="n">MinAirFlowAreaDes</span> <span class="o">=</span> <span class="mf">0.44d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-2646"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2647"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">=</span> <span class="n">MinAirFlowAreaDes</span>
<a name="ln-2648"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2649"></a>                                  <span class="s1">&#39;Design Size Minimum Airflow Area [m2]&#39;</span><span class="p">,</span><span class="n">MinAirFlowAreaDes</span><span class="p">)</span>
<a name="ln-2650"></a>          <span class="k">ELSE</span>
<a name="ln-2651"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MinAirFlowAreaDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2652"></a><span class="k">              </span><span class="n">MinAirFlowAreaUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span>
<a name="ln-2653"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2654"></a>                                    <span class="s1">&#39;Design Size Minimum Airflow Area [m2]&#39;</span><span class="p">,</span><span class="n">MinAirFlowAreaDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2655"></a>                                    <span class="s1">&#39;User-Specified Minimum Airflow Area [m2]&#39;</span><span class="p">,</span><span class="n">MinAirFlowAreaUser</span><span class="p">)</span>
<a name="ln-2656"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2657"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MinAirFlowAreaDes</span> <span class="o">-</span> <span class="n">MinAirFlowAreaUser</span><span class="p">)</span><span class="o">/</span><span class="n">MinAirFlowAreaUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2658"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2659"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2660"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Minimum Airflow Area of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2661"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinAirFlowAreaUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-2662"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Minimum Airflow Area of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2663"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinAirFlowAreaDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-2664"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2665"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2666"></a>                <span class="k">END IF</span>
<a name="ln-2667"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-2668"></a>            <span class="k">END IF</span>
<a name="ln-2669"></a><span class="k">          END IF</span>
<a name="ln-2670"></a>
<a name="ln-2671"></a><span class="k">          IF</span><span class="p">(</span><span class="n">MinAirFlowAreaDes</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0D0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2672"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry: &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2673"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil Minimum Airflow Area must be greater than 0. Coil area = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2674"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MinAirFlowAreaDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2675"></a>            <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2676"></a>          <span class="k">END IF</span>
<a name="ln-2677"></a>
<a name="ln-2678"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2679"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2680"></a><span class="k">              </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2681"></a>          <span class="k">END IF</span>
<a name="ln-2682"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2683"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2684"></a>          <span class="k">ELSE</span>
<a name="ln-2685"></a><span class="k">            SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-2686"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-2687"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2688"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-2689"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-2690"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-2691"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-2692"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-2693"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2694"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2695"></a>                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2696"></a>            <span class="k">END SELECT</span>
<a name="ln-2697"></a><span class="k">          END IF</span>
<a name="ln-2698"></a><span class="k">          </span><span class="n">FinSurfAreaDes</span> <span class="o">=</span> <span class="mi">7</span><span class="mf">8.5d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-2699"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2700"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">=</span> <span class="n">FinSurfAreaDes</span>
<a name="ln-2701"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2702"></a>                                  <span class="s1">&#39;Design Size Fin Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">FinSurfAreaDes</span><span class="p">)</span>
<a name="ln-2703"></a>          <span class="k">ELSE</span>
<a name="ln-2704"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FinSurfAreaDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2705"></a><span class="k">              </span><span class="n">FinSurfAreaUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span>
<a name="ln-2706"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2707"></a>                                    <span class="s1">&#39;Design Size Fin Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">FinSurfAreaDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2708"></a>                                    <span class="s1">&#39;User-Specified Fin Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">FinSurfAreaUser</span><span class="p">)</span>
<a name="ln-2709"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2710"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">FinSurfAreaDes</span> <span class="o">-</span> <span class="n">FinSurfAreaUser</span><span class="p">)</span><span class="o">/</span><span class="n">FinSurfAreaUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2711"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2712"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2713"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Fin Surface Area of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2714"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FinSurfAreaUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-2715"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Fin Surface Area of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2716"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FinSurfAreaDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-2717"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2718"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2719"></a>                <span class="k">END IF</span>
<a name="ln-2720"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-2721"></a>            <span class="k">END IF</span>
<a name="ln-2722"></a><span class="k">          END IF</span>
<a name="ln-2723"></a>
<a name="ln-2724"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2725"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2726"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2727"></a>          <span class="k">END IF</span>
<a name="ln-2728"></a><span class="k">          </span><span class="n">TotTubeInsideAreaDes</span> <span class="o">=</span> <span class="mf">4.4d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeInsideDiam</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2729"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubeRows</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span>
<a name="ln-2730"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2731"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="o">=</span> <span class="n">TotTubeInsideAreaDes</span>
<a name="ln-2732"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2733"></a>                                  <span class="s1">&#39;Design Size Total Tube Inside Area [m2]&#39;</span><span class="p">,</span><span class="n">TotTubeInsideAreaDes</span><span class="p">)</span>
<a name="ln-2734"></a>          <span class="k">ELSE</span>
<a name="ln-2735"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TotTubeInsideAreaDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2736"></a><span class="k">                </span><span class="n">TotTubeInsideAreaUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span>
<a name="ln-2737"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2738"></a>                                    <span class="s1">&#39;Design Size Total Tube Inside Area [m2]&#39;</span><span class="p">,</span><span class="n">TotTubeInsideAreaDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2739"></a>                                    <span class="s1">&#39;User-Specified Total Tube Inside Area [m2]&#39;</span><span class="p">,</span><span class="n">TotTubeInsideAreaUser</span><span class="p">)</span>
<a name="ln-2740"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2741"></a><span class="k">              IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TotTubeInsideAreaDes</span> <span class="o">-</span> <span class="n">TotTubeInsideAreaUser</span><span class="p">)</span><span class="o">/</span><span class="n">TotTubeInsideAreaUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2742"></a><span class="k">                CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2743"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2744"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Total Tube Inside Area of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2745"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotTubeInsideAreaUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-2746"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Total Tube Inside Area of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2747"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotTubeInsideAreaDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-2748"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2749"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2750"></a>              <span class="k">END IF</span>
<a name="ln-2751"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-2752"></a>            <span class="k">END IF</span>
<a name="ln-2753"></a><span class="k">          END IF</span>
<a name="ln-2754"></a>
<a name="ln-2755"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2756"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2757"></a><span class="k">              </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2758"></a>          <span class="k">END IF</span>
<a name="ln-2759"></a><span class="k">          </span><span class="n">TubeOutsideSurfAreaDes</span> <span class="o">=</span> <span class="mf">4.1d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideDiam</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2760"></a>                                   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubeRows</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span>
<a name="ln-2761"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2762"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">=</span> <span class="n">TubeOutsideSurfAreaDes</span>
<a name="ln-2763"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2764"></a>                                  <span class="s1">&#39;Design Size Tube Outside Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">TubeOutsideSurfAreaDes</span><span class="p">)</span>
<a name="ln-2765"></a>          <span class="k">ELSE</span>
<a name="ln-2766"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TubeOutsideSurfAreaDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2767"></a><span class="k">                </span><span class="n">TubeOutsideSurfAreaUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span>
<a name="ln-2768"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2769"></a>                                    <span class="s1">&#39;Design Size Tube Outside Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">TubeOutsideSurfAreaDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2770"></a>                                    <span class="s1">&#39;User-Specified Tube Outside Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">TubeOutsideSurfAreaUser</span><span class="p">)</span>
<a name="ln-2771"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2772"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TubeOutsideSurfAreaDes</span> <span class="o">-</span> <span class="n">TubeOutsideSurfAreaUser</span><span class="p">)</span><span class="o">/</span><span class="n">TubeOutsideSurfAreaUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2773"></a>                          <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2774"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2775"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2776"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Tube Outside Surface Area of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2777"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TubeOutsideSurfAreaUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-2778"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Tube Outside Surface Area of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2779"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TubeOutsideSurfAreaDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-2780"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2781"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2782"></a>                <span class="k">END IF</span>
<a name="ln-2783"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-2784"></a>            <span class="k">END IF</span>
<a name="ln-2785"></a><span class="k">          END IF</span>
<a name="ln-2786"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2787"></a><span class="k">            IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">+</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">&amp;</span>
<a name="ln-2788"></a>                <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2789"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry: &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2790"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil Fin Surface Area plus Coil Tube Outside Surface Area must be greater than 0.&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2791"></a>                        <span class="s1">&#39; Total surface area = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2792"></a>                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">((</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">+</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span><span class="p">),</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2793"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2794"></a>            <span class="k">END IF</span>
<a name="ln-2795"></a><span class="k">          END IF</span>
<a name="ln-2796"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2797"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2798"></a><span class="k">              </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2799"></a>          <span class="k">END IF</span>
<a name="ln-2800"></a><span class="k">          </span><span class="n">CoilDepthDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeDepthSpacing</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubeRows</span>
<a name="ln-2801"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2802"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">=</span> <span class="n">CoilDepthDes</span>
<a name="ln-2803"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2804"></a>                                  <span class="s1">&#39;Design Size Coil Depth [m]&#39;</span><span class="p">,</span><span class="n">CoilDepthDes</span><span class="p">)</span>
<a name="ln-2805"></a>          <span class="k">ELSE</span>
<a name="ln-2806"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoilDepthDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2807"></a><span class="k">                </span><span class="n">CoilDepthUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span>
<a name="ln-2808"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2809"></a>                                    <span class="s1">&#39;Design Size Coil Depth [m]&#39;</span><span class="p">,</span><span class="n">CoilDepthDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2810"></a>                                    <span class="s1">&#39;User-Specified Coil Depth [m]&#39;</span><span class="p">,</span><span class="n">CoilDepthUser</span><span class="p">)</span>
<a name="ln-2811"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2812"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CoilDepthDes</span> <span class="o">-</span> <span class="n">CoilDepthUser</span><span class="p">)</span><span class="o">/</span><span class="n">CoilDepthUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2813"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span>  <span class="p">&amp;</span>
<a name="ln-2814"></a>                               <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2815"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Coil Depth of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2816"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CoilDepthUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-2817"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Coil Depth of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2818"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CoilDepthDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-2819"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2820"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2821"></a>                <span class="k">END IF</span>
<a name="ln-2822"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-2823"></a>            <span class="k">END IF</span>
<a name="ln-2824"></a><span class="k">          END IF</span>
<a name="ln-2825"></a><span class="k">        END IF</span>
<a name="ln-2826"></a>
<a name="ln-2827"></a><span class="k">      ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! end system coil IF; start zone coil ELSE - IF</span>
<a name="ln-2828"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2829"></a><span class="k">          </span><span class="n">IsAutosizeReq</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2830"></a>        <span class="k">END IF</span>
<a name="ln-2831"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosizeReq</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingRunDone</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-2832"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2833"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2834"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2835"></a>                                    <span class="s1">&#39;User-Specified Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-2836"></a>            <span class="k">END IF</span>
<a name="ln-2837"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2838"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2839"></a>                                    <span class="s1">&#39;User-Specified Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span><span class="p">)</span>
<a name="ln-2840"></a>            <span class="k">END IF</span>
<a name="ln-2841"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2842"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2843"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span><span class="p">)</span>
<a name="ln-2844"></a>            <span class="k">END IF</span>
<a name="ln-2845"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2846"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2847"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Water Temperature [C]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span><span class="p">)</span>
<a name="ln-2848"></a>            <span class="k">END IF</span>
<a name="ln-2849"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2850"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2851"></a>                                    <span class="s1">&#39;User-Specified Design Outlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">)</span>
<a name="ln-2852"></a>            <span class="k">END IF</span>
<a name="ln-2853"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2854"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2855"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">)</span>
<a name="ln-2856"></a>            <span class="k">END IF</span>
<a name="ln-2857"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2858"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2859"></a>                                    <span class="s1">&#39;User-Specified Design Outlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span><span class="p">)</span>
<a name="ln-2860"></a>            <span class="k">END IF</span>
<a name="ln-2861"></a>
<a name="ln-2862"></a><span class="k">          ELSE IF</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2863"></a>
<a name="ln-2864"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2865"></a><span class="k">                CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2866"></a>                                    <span class="s1">&#39;User-Specified Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-2867"></a>            <span class="k">END IF</span>
<a name="ln-2868"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2869"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2870"></a>                                    <span class="s1">&#39;User-Specified Tube Outside Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span><span class="p">)</span>
<a name="ln-2871"></a>            <span class="k">END IF</span>
<a name="ln-2872"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2873"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2874"></a>                                    <span class="s1">&#39;User-Specified Total Tube Inside Area [m2]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span><span class="p">)</span>
<a name="ln-2875"></a>            <span class="k">END IF</span>
<a name="ln-2876"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2877"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2878"></a>                                    <span class="s1">&#39;User-Specified Fin Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span><span class="p">)</span>
<a name="ln-2879"></a>            <span class="k">END IF</span>
<a name="ln-2880"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2881"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2882"></a>                                    <span class="s1">&#39;User-Specified Minimum Airflow Area [m2]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span><span class="p">)</span>
<a name="ln-2883"></a>            <span class="k">END IF</span>
<a name="ln-2884"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2885"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2886"></a>                                    <span class="s1">&#39;User-Specified Coil Depth [m]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span><span class="p">)</span>
<a name="ln-2887"></a>            <span class="k">END IF</span>
<a name="ln-2888"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2889"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2890"></a>                                    <span class="s1">&#39;User-Specified Fin Diameter [m]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span><span class="p">)</span>
<a name="ln-2891"></a>            <span class="k">END IF</span>
<a name="ln-2892"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2893"></a><span class="k">              </span><span class="n">NumofTubesperRowUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span>
<a name="ln-2894"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2895"></a>                                    <span class="s1">&#39;User-Specified Number of Tubes per Row&#39;</span><span class="p">,</span><span class="n">NumofTubesperRowUser</span><span class="p">)</span>
<a name="ln-2896"></a>            <span class="k">END IF</span>
<a name="ln-2897"></a><span class="k">          END IF</span>
<a name="ln-2898"></a><span class="k">        ELSE</span> <span class="c">! At least one field is autosize</span>
<a name="ln-2899"></a>          <span class="k">If</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! &#39;DETAILED FLAT FIN&#39;</span>
<a name="ln-2900"></a>            <span class="k">CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2901"></a>          <span class="n">ElseIf</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2902"></a>            <span class="k">CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2903"></a>          <span class="k">End If</span>
<a name="ln-2904"></a>        <span class="c">! if the water flow rate needs autosizing, calculate the volume flow rate</span>
<a name="ln-2905"></a>          <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2906"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2907"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2908"></a>          <span class="k">END IF</span>
<a name="ln-2909"></a><span class="c">!          If (WaterCoil(CoilNum)%WaterCoilModel == CoilModel_Cooling) Then  ! &#39;Cooling&#39;</span>
<a name="ln-2910"></a><span class="c">!            CALL CheckZoneSizing(&#39;Coil:Cooling:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-2911"></a><span class="c">!          End If</span>
<a name="ln-2912"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2913"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">MaxCWVolFlow</span>
<a name="ln-2914"></a>            <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span>
<a name="ln-2915"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ZoneEqFanCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2916"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">MaxCWVolFlow</span>
<a name="ln-2917"></a>            <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolingLoad</span>
<a name="ln-2918"></a>          <span class="k">ELSE</span>
<a name="ln-2919"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-2920"></a>            <span class="n">CoilOutTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-2921"></a>            <span class="n">CoilOutHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-2922"></a>            <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-2923"></a>            <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolMassFlow</span> <span class="p">&amp;</span>
<a name="ln-2924"></a>                            <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CoilInTemp</span><span class="p">,</span> <span class="n">CoilInHumRat</span><span class="p">)</span><span class="o">-</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CoilOutTemp</span><span class="p">,</span> <span class="n">CoilOutHumRat</span><span class="p">))</span>
<a name="ln-2925"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DesCoilLoad</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2926"></a><span class="k">              </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">DesCoilLoad</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-2927"></a>                                       <span class="p">(</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCoolNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2928"></a>                                       <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-2929"></a>            <span class="k">ELSE</span>
<a name="ln-2930"></a><span class="k">              </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2931"></a>            <span class="k">END IF</span>
<a name="ln-2932"></a><span class="k">          END IF</span>
<a name="ln-2933"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterHeatingCoilRate</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-2934"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2935"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The design coil load is zero for Coil:Cooling:Water &#39;</span> <span class="p">&amp;</span>
<a name="ln-2936"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2937"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The autosize value for max water flow rate is zero&#39;</span><span class="p">)</span>
<a name="ln-2938"></a>          <span class="k">END IF</span>
<a name="ln-2939"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2940"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="n">MaxWaterVolFlowRateDes</span>
<a name="ln-2941"></a>            <span class="k">If</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">Then</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2942"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2943"></a>                                    <span class="s1">&#39;Design Size Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">)</span>
<a name="ln-2944"></a>            <span class="k">END IF</span>
<a name="ln-2945"></a><span class="k">          ELSE</span>
<a name="ln-2946"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MaxWaterVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2947"></a><span class="k">              </span><span class="n">MaxWaterVolFlowRateUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-2948"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-2949"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2950"></a>                                    <span class="s1">&#39;Design Size Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2951"></a>                                    <span class="s1">&#39;User-Specified Design Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span>
<a name="ln-2952"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2953"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">-</span> <span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2954"></a>                                     <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2955"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2956"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2957"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Water Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2958"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-2959"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Water Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2960"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-2961"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-2962"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-2963"></a>                  <span class="k">END IF</span>
<a name="ln-2964"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-2965"></a>              <span class="k">END IF</span>
<a name="ln-2966"></a><span class="k">            END IF</span>
<a name="ln-2967"></a><span class="k">          END IF</span>
<a name="ln-2968"></a>
<a name="ln-2969"></a><span class="c">!@@@@@@@@@@ INSERTING BELOW :Autosizing for Coil Water Cooling</span>
<a name="ln-2970"></a>
<a name="ln-2971"></a>        <span class="c">! if the design input coil design air vol flow rate input needs autosizing, calculate it</span>
<a name="ln-2972"></a>        <span class="c">! Avoid false calculation of temperatures and humidity ratios</span>
<a name="ln-2973"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Cooling</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2974"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2975"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2976"></a><span class="k">              </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2977"></a>            <span class="k">END IF</span>
<a name="ln-2978"></a><span class="c">!            CALL CheckZoneSizing(&#39;Coil:Cooling:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-2979"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2980"></a><span class="k">              </span><span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-2981"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ZoneEqFanCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2982"></a><span class="k">              </span><span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-2983"></a>            <span class="k">ELSE</span>
<a name="ln-2984"></a><span class="k">              </span><span class="n">DesAirVolFlowRateDes</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2985"></a>                                   <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatMassFlow</span><span class="p">)</span> <span class="o">/</span> <span class="n">RhoAirStd</span>
<a name="ln-2986"></a>            <span class="k">END IF</span>
<a name="ln-2987"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DesAirVolFlowRateDes</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2988"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The design air volume flow rate is zero for Coil:Cooling:Water &#39;</span> <span class="p">&amp;</span>
<a name="ln-2989"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2990"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The autosize value for max air volume flow rate is zero&#39;</span><span class="p">)</span>
<a name="ln-2991"></a>            <span class="k">END IF</span>
<a name="ln-2992"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2993"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">=</span> <span class="n">DesAirVolFlowRateDes</span>
<a name="ln-2994"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2995"></a>                                    <span class="s1">&#39;Design Size Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">DesAirVolFlowRateDes</span><span class="p">)</span>
<a name="ln-2996"></a>            <span class="k">ELSE</span>
<a name="ln-2997"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesAirVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2998"></a><span class="k">                </span><span class="n">DesAirVolFlowRateUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span>
<a name="ln-2999"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3000"></a>                                    <span class="s1">&#39;Design Size Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">DesAirVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3001"></a>                                    <span class="s1">&#39;User-Specified Design Air Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">DesAirVolFlowRateUser</span><span class="p">)</span>
<a name="ln-3002"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3003"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesAirVolFlowRateDes</span> <span class="o">-</span> <span class="n">DesAirVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">DesAirVolFlowRateUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3004"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3005"></a>                                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3006"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Air Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3007"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesAirVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3008"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Air Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3009"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesAirVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [ m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3010"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3011"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3012"></a>                  <span class="k">END IF</span>
<a name="ln-3013"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-3014"></a>              <span class="k">END IF</span>
<a name="ln-3015"></a><span class="k">            END IF</span>
<a name="ln-3016"></a>
<a name="ln-3017"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3018"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">Then</span>    <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-3019"></a>              <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3020"></a>            <span class="k">END IF</span>
<a name="ln-3021"></a><span class="c">!          CALL CheckZoneSizing(&#39;Coil:Cooling:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-3022"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3023"></a><span class="k">              </span><span class="n">DesInletAirtempDes</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneTempAtCoolPeak</span>
<a name="ln-3024"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ZoneEqFanCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3025"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolMassFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3026"></a><span class="k">                </span><span class="n">FCOAFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">RhoAirStd</span><span class="o">*</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span><span class="o">/</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolMassFlow</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3027"></a>              <span class="k">ELSE</span>
<a name="ln-3028"></a><span class="k">                </span><span class="n">FCOAFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3029"></a>              <span class="k">END IF</span>
<a name="ln-3030"></a><span class="k">              </span><span class="n">DesInletAirtempDes</span> <span class="o">=</span> <span class="n">FCOAFrac</span><span class="o">*</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OutTempAtCoolPeak</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3031"></a>                           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">FCOAFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneTempAtCoolPeak</span>
<a name="ln-3032"></a>            <span class="k">ELSE</span>
<a name="ln-3033"></a><span class="k">              </span><span class="n">DesInletAirtempDes</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-3034"></a>            <span class="k">END IF</span>
<a name="ln-3035"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3036"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span> <span class="o">=</span> <span class="n">DesInletAirtempDes</span>
<a name="ln-3037"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3038"></a>                                    <span class="s1">&#39;Design Size Design Inlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletAirtempDes</span><span class="p">)</span>
<a name="ln-3039"></a>            <span class="k">ELSE</span>
<a name="ln-3040"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesInletAirtempDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3041"></a><span class="k">                </span><span class="n">DesInletAirtempUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span>
<a name="ln-3042"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3043"></a>                                    <span class="s1">&#39;Design Size Design Inlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletAirtempDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3044"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletAirtempUser</span><span class="p">)</span>
<a name="ln-3045"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3046"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesInletAirtempDes</span> <span class="o">-</span> <span class="n">DesInletAirtempUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingDeltaTempThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3047"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3048"></a>                                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3049"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Inlet Air Temperature of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3050"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletAirtempUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-3051"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Inlet Air Temperature of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3052"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletAirtempDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-3053"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3054"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3055"></a>                  <span class="k">END IF</span>
<a name="ln-3056"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-3057"></a>               <span class="k">END IF</span>
<a name="ln-3058"></a><span class="k">            END IF</span>
<a name="ln-3059"></a>
<a name="ln-3060"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3061"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">Then</span>    <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-3062"></a>              <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3063"></a>            <span class="k">END IF</span>
<a name="ln-3064"></a><span class="c">!          CALL CheckZoneSizing(&#39;Coil:Cooling:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-3065"></a>            <span class="n">DesInletWaterTempDes</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCoolNum</span><span class="p">)%</span><span class="n">ExitTemp</span>
<a name="ln-3066"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3067"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span> <span class="o">=</span> <span class="n">DesInletwatertempDes</span>
<a name="ln-3068"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3069"></a>                                    <span class="s1">&#39;Design Size Design Inlet Water Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletwatertempDes</span><span class="p">)</span>
<a name="ln-3070"></a>            <span class="k">ELSE</span>
<a name="ln-3071"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesInletwatertempDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3072"></a><span class="k">                </span><span class="n">DesInletwatertempUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletwatertemp</span>
<a name="ln-3073"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3074"></a>                                    <span class="s1">&#39;Design Size Design Inlet Water Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletwatertempDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3075"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Water Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesInletwatertempUser</span><span class="p">)</span>
<a name="ln-3076"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3077"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesInletwatertempDes</span> <span class="o">-</span> <span class="n">DesInletwatertempUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingDeltaTempThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3078"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3079"></a>                                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3080"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Inlet Water Temperature of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3081"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletwatertempUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-3082"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Inlet Water Temperature of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3083"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletWatertempDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-3084"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3085"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3086"></a>                  <span class="k">END IF</span>
<a name="ln-3087"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-3088"></a>              <span class="k">END IF</span>
<a name="ln-3089"></a><span class="k">            END IF</span>
<a name="ln-3090"></a>
<a name="ln-3091"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3092"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-3093"></a>              <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3094"></a>            <span class="k">END IF</span>
<a name="ln-3095"></a><span class="c">!          CALL CheckZoneSizing(&#39;Coil:Cooling:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-3096"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3097"></a><span class="k">              </span><span class="n">DesInletAirHumRatDes</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-3098"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ZoneEqFanCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3099"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolMassFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3100"></a><span class="k">                </span><span class="n">FCOAFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">RhoAirStd</span><span class="o">*</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span><span class="o">/</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolMassFlow</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3101"></a>              <span class="k">ELSE</span>
<a name="ln-3102"></a><span class="k">                </span><span class="n">FCOAFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3103"></a>              <span class="k">END IF</span>
<a name="ln-3104"></a><span class="k">              </span><span class="n">DesInletAirHumRatDes</span> <span class="o">=</span> <span class="n">FCOAFrac</span><span class="o">*</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OutHumRatAtCoolPeak</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3105"></a>                           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">FCOAFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-3106"></a>            <span class="k">ELSE</span>
<a name="ln-3107"></a><span class="k">              </span><span class="n">DesInletAirHumRatDes</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-3108"></a>            <span class="k">END IF</span>
<a name="ln-3109"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3110"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">=</span> <span class="n">DesInletAirHumRatDes</span>
<a name="ln-3111"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3112"></a>                                    <span class="s1">&#39;Design Size Design Inlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesInletAirHumRatDes</span><span class="p">)</span>
<a name="ln-3113"></a>            <span class="k">ELSE</span>
<a name="ln-3114"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesInletAirHumRatDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3115"></a><span class="k">                </span><span class="n">DesInletAirHumRatUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-3116"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3117"></a>                                    <span class="s1">&#39;Design Size Design Inlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesInletAirHumRatDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3118"></a>                                    <span class="s1">&#39;User-Specified Design Inlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesInletAirHumRatUser</span><span class="p">)</span>
<a name="ln-3119"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3120"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesInletAirHumRatDes</span> <span class="o">-</span> <span class="n">DesInletAirHumRatUser</span><span class="p">)</span><span class="o">/</span><span class="n">DesInletAirHumRatUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3121"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3122"></a>                                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3123"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Inlet Air Humidity Ratio of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3124"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletAirHumRatUser</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3125"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Inlet Air Humidity Ratio of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3126"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesInletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3127"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3128"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3129"></a>                  <span class="k">END IF</span>
<a name="ln-3130"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-3131"></a>              <span class="k">END IF</span>
<a name="ln-3132"></a><span class="k">            END IF</span>
<a name="ln-3133"></a>
<a name="ln-3134"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3135"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">Then</span>    <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-3136"></a>              <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3137"></a>            <span class="k">END IF</span>
<a name="ln-3138"></a><span class="c">!          CALL CheckZoneSizing(&#39;Coil:Cooling:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-3139"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3140"></a>
<a name="ln-3141"></a><span class="k">              </span><span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3142"></a>                       <span class="mf">5.0d0</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3143"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3144"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3145"></a>
<a name="ln-3146"></a>              <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3147"></a>                       <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3148"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3149"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3150"></a>              <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCoolNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3151"></a>                            <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-3152"></a>              <span class="n">T1Out</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirtemp</span> <span class="o">-</span> <span class="n">DesCoilLoad</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3153"></a>                <span class="p">(</span><span class="n">RhoAirStd</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3154"></a>                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span><span class="p">)</span>
<a name="ln-3155"></a>              <span class="n">T2Out</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizCoolNum</span><span class="p">)%</span><span class="n">ExitTemp</span> <span class="o">+</span> <span class="mf">2.0d0</span>
<a name="ln-3156"></a>              <span class="n">DesOutletAirTempDes</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">T1Out</span><span class="p">,</span><span class="n">T2Out</span><span class="p">)</span>
<a name="ln-3157"></a>            <span class="k">ELSE</span>
<a name="ln-3158"></a><span class="k">              </span><span class="n">DesOutletAirTempDes</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-3159"></a>            <span class="k">END IF</span>
<a name="ln-3160"></a>
<a name="ln-3161"></a><span class="k">            If</span> <span class="p">(</span><span class="n">DesOutletAirTempDes</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="p">&amp;</span>
<a name="ln-3162"></a>              <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-3163"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Coil=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3164"></a>                                  <span class="s1">&#39;&quot;, Cooling Coil has leaving air temperature &gt; entering water temperature.&#39;</span><span class="p">)</span>
<a name="ln-3165"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Tair,out  =  &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirTempDes</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3166"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Twater,in = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3167"></a>              <span class="n">DesOutletAirTempDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span> <span class="o">+</span> <span class="mf">0.5d0</span>
<a name="ln-3168"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;....coil leaving air temperature will be reset to:&#39;</span><span class="p">)</span>
<a name="ln-3169"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Tair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirTempDes</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-3170"></a>            <span class="k">End If</span>
<a name="ln-3171"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3172"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">=</span> <span class="n">DesOutletAirTempDes</span>
<a name="ln-3173"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3174"></a>                                    <span class="s1">&#39;Design Size Design Outlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesOutletAirTempDes</span><span class="p">)</span>
<a name="ln-3175"></a>            <span class="k">ELSE</span>
<a name="ln-3176"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesOutletAirTempDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3177"></a><span class="k">                </span><span class="n">DesOutletAirTempUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span>
<a name="ln-3178"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3179"></a>                                    <span class="s1">&#39;Design Size Design Outlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesOutletAirTempDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3180"></a>                                    <span class="s1">&#39;User-Specified Design Outlet Air Temperature [C]&#39;</span><span class="p">,</span><span class="n">DesOutletAirTempUser</span><span class="p">)</span>
<a name="ln-3181"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3182"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesOutletAirTempDes</span> <span class="o">-</span> <span class="n">DesOutletAirTempUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingDeltaTempThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3183"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3184"></a>                                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3185"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Outlet Air Temperature of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3186"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirTempUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-3187"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Outlet Air Temperature of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3188"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirTempDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [C]&#39;</span><span class="p">)</span>
<a name="ln-3189"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3190"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3191"></a>                  <span class="k">END IF</span>
<a name="ln-3192"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-3193"></a>              <span class="k">END IF</span>
<a name="ln-3194"></a><span class="k">            END IF</span>
<a name="ln-3195"></a>
<a name="ln-3196"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3197"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">Then</span>    <span class="c">! &#39;Cooling&#39;</span>
<a name="ln-3198"></a>              <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3199"></a>            <span class="k">END IF</span>
<a name="ln-3200"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3201"></a><span class="k">              </span><span class="n">TDpIn</span> <span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">)</span>
<a name="ln-3202"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">TDpIn</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3203"></a><span class="k">                </span><span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-3204"></a>              <span class="k">ELSE</span>
<a name="ln-3205"></a><span class="k">                </span><span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">PsyWFnTdbRhPb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3206"></a>                                      <span class="mf">0.9d0</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">),</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">)</span>
<a name="ln-3207"></a>              <span class="k">END IF</span>
<a name="ln-3208"></a><span class="k">            ELSE</span>
<a name="ln-3209"></a><span class="k">              </span><span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-3210"></a>            <span class="k">END IF</span>
<a name="ln-3211"></a>
<a name="ln-3212"></a><span class="k">            If</span> <span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="p">&amp;</span>
<a name="ln-3213"></a>               <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-3214"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Coil=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3215"></a>                                  <span class="s1">&#39;&quot;, Cooling Coil has leaving humidity ratio &gt; entering humidity ratio.&#39;</span><span class="p">)</span>
<a name="ln-3216"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,in =  &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3217"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3218"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DesInletAirHumRatDes</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">016</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3219"></a><span class="k">                </span><span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-3220"></a>              <span class="k">ELSE</span>
<a name="ln-3221"></a><span class="k">                </span><span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-3222"></a>              <span class="k">END IF</span>
<a name="ln-3223"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;....coil leaving humidity ratio will be reset to:&#39;</span><span class="p">)</span>
<a name="ln-3224"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3225"></a>            <span class="k">End If</span>
<a name="ln-3226"></a>            <span class="c">! check for dry coil and reset outlet humrat if needed</span>
<a name="ln-3227"></a>            <span class="n">DesSatEnthAtWaterInTemp</span> <span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3228"></a>                                             <span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">))</span>
<a name="ln-3229"></a>            <span class="n">DesHumRatAtWaterInTemp</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletWaterTemp</span><span class="p">,</span><span class="n">DesSatEnthAtWaterInTemp</span><span class="p">,</span><span class="s1">&#39;InitWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3230"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DesOutletAirHumRatDes</span> <span class="o">&lt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3231"></a>              <span class="n">DesHumRatAtWaterInTemp</span> <span class="o">&gt;</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3232"></a>              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3233"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Coil=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3234"></a>                                  <span class="s1">&#39;&quot;, Cooling Coil is dry and has air leaving humidity ratio &lt; entering humidity ratio.&#39;</span><span class="p">)</span>
<a name="ln-3235"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,in =  &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3236"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3237"></a>              <span class="n">DesOutletAirHumRatDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesInletAirHumRat</span>
<a name="ln-3238"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;....coil leaving humidity ratio will be reset to:&#39;</span><span class="p">)</span>
<a name="ln-3239"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;    Wair,out = &#39;</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3240"></a>            <span class="k">END IF</span>
<a name="ln-3241"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3242"></a><span class="k">              </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">=</span> <span class="n">DesOutletAirHumRatDes</span>
<a name="ln-3243"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3244"></a>                                    <span class="s1">&#39;Design Size Design Outlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesOutletAirHumRatDes</span><span class="p">)</span>
<a name="ln-3245"></a>            <span class="k">ELSE</span>
<a name="ln-3246"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesOutletAirHumRatDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3247"></a><span class="k">                </span><span class="n">DesOutletAirHumRatUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesOutletAirHumRat</span>
<a name="ln-3248"></a>                <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3249"></a>                                    <span class="s1">&#39;Design Size Design Outlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3250"></a>                                    <span class="s1">&#39;User-Specified Design Outlet Air Humidity Ratio&#39;</span><span class="p">,</span><span class="n">DesOutletAirHumRatUser</span><span class="p">)</span>
<a name="ln-3251"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3252"></a><span class="k">                  IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span> <span class="o">-</span> <span class="n">DesOutletAirHumRatUser</span><span class="p">)</span><span class="o">/</span><span class="n">DesOutletAirHumRatUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3253"></a>                                                     <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3254"></a><span class="k">                    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3255"></a>                                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3256"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Outlet Air Humidity Ratio of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3257"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatUser</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3258"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Outlet Air Humidity Ratio of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3259"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesOutletAirHumRatDes</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3260"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3261"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3262"></a>                  <span class="k">END IF</span>
<a name="ln-3263"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-3264"></a>              <span class="k">END IF</span>
<a name="ln-3265"></a><span class="k">            END IF</span>
<a name="ln-3266"></a><span class="k">          END IF</span> <span class="c">! End of simple cooling coil autosizable fields</span>
<a name="ln-3267"></a>
<a name="ln-3268"></a>          <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3269"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3270"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3271"></a>          <span class="k">END IF</span>
<a name="ln-3272"></a><span class="k">          </span><span class="n">NumofTubesperRowDes</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="mi">1375</span><span class="mf">0.d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3273"></a>          <span class="n">NumofTubesperRowDes</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">3.d0</span><span class="p">,</span> <span class="n">NumofTubesperRowDes</span><span class="p">)</span>
<a name="ln-3274"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3275"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="o">=</span> <span class="n">NumofTubesperRowDes</span>
<a name="ln-3276"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3277"></a>                                  <span class="s1">&#39;Design Size Number of Tubes per Row&#39;</span><span class="p">,</span><span class="n">NumofTubesperRowDes</span><span class="p">)</span>
<a name="ln-3278"></a>          <span class="k">ELSE</span>
<a name="ln-3279"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NumofTubesperRowDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3280"></a><span class="k">              </span><span class="n">NumofTubesperRowUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span>
<a name="ln-3281"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3282"></a>                                    <span class="s1">&#39;Design Size Number of Tubes per Row&#39;</span><span class="p">,</span><span class="n">NumofTubesperRowDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3283"></a>                                    <span class="s1">&#39;User-Specified Number of Tubes per Row&#39;</span><span class="p">,</span><span class="n">NumofTubesperRowUser</span><span class="p">)</span>
<a name="ln-3284"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3285"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">NumofTubesperRowDes</span> <span class="o">-</span> <span class="n">NumofTubesperRowUser</span><span class="p">)</span><span class="o">/</span><span class="n">NumofTubesperRowUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3286"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3287"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3288"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Number of Tubes per Row of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3289"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumofTubesperRowUser</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-3290"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Number of Tubes per Row of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3291"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">NumofTubesperRowDes</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-3292"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3293"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3294"></a>                <span class="k">END IF</span>
<a name="ln-3295"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3296"></a>            <span class="k">END IF</span>
<a name="ln-3297"></a><span class="k">          END IF</span>
<a name="ln-3298"></a>
<a name="ln-3299"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3300"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3301"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3302"></a>          <span class="k">END IF</span>
<a name="ln-3303"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3304"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span> <span class="o">*</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3305"></a>          <span class="k">ELSE</span>
<a name="ln-3306"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3307"></a>                                                      <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatMassFlow</span><span class="p">)</span>
<a name="ln-3308"></a>          <span class="k">END IF</span>
<a name="ln-3309"></a><span class="k">          </span><span class="n">FinDiamDes</span> <span class="o">=</span> <span class="mf">0.335d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-3310"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3311"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">=</span> <span class="n">FinDiamDes</span>
<a name="ln-3312"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3313"></a>                                  <span class="s1">&#39;Design Size Fin Diameter [m]&#39;</span><span class="p">,</span><span class="n">FinDiamDes</span><span class="p">)</span>
<a name="ln-3314"></a>          <span class="k">ELSE</span>
<a name="ln-3315"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FinDiamDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3316"></a><span class="k">              </span><span class="n">FinDiamUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinDiam</span>
<a name="ln-3317"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3318"></a>                                    <span class="s1">&#39;Design Size Fin Diameter [m]&#39;</span><span class="p">,</span><span class="n">FinDiamDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3319"></a>                                    <span class="s1">&#39;User-Specified Fin Diameter [m]&#39;</span><span class="p">,</span><span class="n">FinDiamUser</span><span class="p">)</span>
<a name="ln-3320"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3321"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">FinDiamDes</span> <span class="o">-</span> <span class="n">FinDiamUser</span><span class="p">)</span><span class="o">/</span><span class="n">FinDiamUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3322"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3323"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3324"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Fin Diameter of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3325"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FinDiamUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-3326"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Fin Diameter of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3327"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FinDiamDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-3328"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3329"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3330"></a>                <span class="k">END IF</span>
<a name="ln-3331"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3332"></a>            <span class="k">END IF</span>
<a name="ln-3333"></a><span class="k">          END IF</span>
<a name="ln-3334"></a>
<a name="ln-3335"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3336"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3337"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3338"></a>          <span class="k">END IF</span>
<a name="ln-3339"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3340"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span> <span class="o">*</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3341"></a>          <span class="k">ELSE</span>
<a name="ln-3342"></a><span class="k">           </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3343"></a>                                                      <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatMassFlow</span><span class="p">)</span>
<a name="ln-3344"></a>          <span class="k">END IF</span>
<a name="ln-3345"></a><span class="k">          </span><span class="n">MinAirFlowAreaDes</span> <span class="o">=</span> <span class="mf">0.44d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-3346"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3347"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">=</span> <span class="n">MinAirFlowAreaDes</span>
<a name="ln-3348"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3349"></a>                                  <span class="s1">&#39;Design Size Minimum Airflow Area [m2]&#39;</span><span class="p">,</span><span class="n">MinAirFlowAreaDes</span><span class="p">)</span>
<a name="ln-3350"></a>          <span class="k">ELSE</span>
<a name="ln-3351"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MinAirFlowAreaDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3352"></a><span class="k">              </span><span class="n">MinAirFlowAreaUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span>
<a name="ln-3353"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3354"></a>                                    <span class="s1">&#39;Design Size Minimum Airflow Area [m2]&#39;</span><span class="p">,</span><span class="n">MinAirFlowAreaDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3355"></a>                                    <span class="s1">&#39;User-Specified Minimum Airflow Area [m2]&#39;</span><span class="p">,</span><span class="n">MinAirFlowAreaUser</span><span class="p">)</span>
<a name="ln-3356"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3357"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MinAirFlowAreaDes</span> <span class="o">-</span> <span class="n">MinAirFlowAreaUser</span><span class="p">)</span><span class="o">/</span><span class="n">MinAirFlowAreaUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3358"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3359"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3360"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Minimum Airflow Area of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3361"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinAirFlowAreaUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-3362"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Minimum Airflow Area of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3363"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinAirFlowAreaDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-3364"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3365"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3366"></a>                <span class="k">END IF</span>
<a name="ln-3367"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3368"></a>            <span class="k">END IF</span>
<a name="ln-3369"></a><span class="k">          END IF</span>
<a name="ln-3370"></a>
<a name="ln-3371"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3372"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3373"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3374"></a>          <span class="k">END IF</span>
<a name="ln-3375"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3376"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAirStd</span> <span class="o">*</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span>
<a name="ln-3377"></a>          <span class="k">ELSE</span>
<a name="ln-3378"></a><span class="k">           </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolMassFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3379"></a>                                                      <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatMassFlow</span><span class="p">)</span>
<a name="ln-3380"></a>          <span class="k">END IF</span>
<a name="ln-3381"></a><span class="k">          </span><span class="n">FinSurfAreaDes</span> <span class="o">=</span> <span class="mi">7</span><span class="mf">8.5d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-3382"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3383"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">=</span> <span class="n">FinSurfAreaDes</span>
<a name="ln-3384"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3385"></a>                                  <span class="s1">&#39;Design Size Fin Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">FinSurfAreaDes</span><span class="p">)</span>
<a name="ln-3386"></a>          <span class="k">ELSE</span>
<a name="ln-3387"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FinSurfAreaDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3388"></a><span class="k">              </span><span class="n">FinSurfAreaUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span>
<a name="ln-3389"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3390"></a>                                    <span class="s1">&#39;Design Size Fin Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">FinSurfAreaDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3391"></a>                                    <span class="s1">&#39;User-Specified Fin Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">FinSurfAreaUser</span><span class="p">)</span>
<a name="ln-3392"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3393"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">FinSurfAreaDes</span> <span class="o">-</span> <span class="n">FinSurfAreaUser</span><span class="p">)</span><span class="o">/</span><span class="n">FinSurfAreaUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3394"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3395"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3396"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Fin Surface Area of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3397"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FinSurfAreaUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-3398"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Fin Surface Area of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3399"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FinSurfAreaDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-3400"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3401"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3402"></a>                <span class="k">END IF</span>
<a name="ln-3403"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3404"></a>            <span class="k">END IF</span>
<a name="ln-3405"></a><span class="k">          END IF</span>
<a name="ln-3406"></a>
<a name="ln-3407"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3408"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3409"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3410"></a>          <span class="k">END IF</span>
<a name="ln-3411"></a><span class="k">          </span><span class="n">TotTubeInsideAreaDes</span> <span class="o">=</span> <span class="mf">4.4d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeInsideDiam</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3412"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubeRows</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span>
<a name="ln-3413"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3414"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="o">=</span> <span class="n">TotTubeInsideAreaDes</span>
<a name="ln-3415"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3416"></a>                                  <span class="s1">&#39;Design Size Total Tube Inside Area [m2]&#39;</span><span class="p">,</span><span class="n">TotTubeInsideAreaDes</span><span class="p">)</span>
<a name="ln-3417"></a>          <span class="k">ELSE</span>
<a name="ln-3418"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TotTubeInsideAreaDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3419"></a><span class="k">              </span><span class="n">TotTubeInsideAreaUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span>
<a name="ln-3420"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3421"></a>                                    <span class="s1">&#39;Design Size Total Tube Inside Area [m2]&#39;</span><span class="p">,</span><span class="n">TotTubeInsideAreaDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3422"></a>                                    <span class="s1">&#39;User-Specified Total Tube Inside Area [m2]&#39;</span><span class="p">,</span><span class="n">TotTubeInsideAreaUser</span><span class="p">)</span>
<a name="ln-3423"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3424"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TotTubeInsideAreaDes</span> <span class="o">-</span> <span class="n">TotTubeInsideAreaUser</span><span class="p">)</span><span class="o">/</span><span class="n">TotTubeInsideAreaUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3425"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3426"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3427"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Total Tube Inside Area of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3428"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotTubeInsideAreaUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-3429"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Total Tube Inside Area of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3430"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TotTubeInsideAreaDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-3431"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3432"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3433"></a>                <span class="k">END IF</span>
<a name="ln-3434"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3435"></a>            <span class="k">END IF</span>
<a name="ln-3436"></a><span class="k">          END IF</span>
<a name="ln-3437"></a>
<a name="ln-3438"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3439"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3440"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3441"></a>          <span class="k">END IF</span>
<a name="ln-3442"></a><span class="k">            </span><span class="n">TubeOutsideSurfAreaDes</span> <span class="o">=</span> <span class="mf">4.1d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideDiam</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3443"></a>                                     <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubeRows</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubesperRow</span>
<a name="ln-3444"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3445"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">=</span> <span class="n">TubeOutsideSurfAreaDes</span>
<a name="ln-3446"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3447"></a>                                  <span class="s1">&#39;Design Size Tube Outside Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">TubeOutsideSurfAreaDes</span><span class="p">)</span>
<a name="ln-3448"></a>          <span class="k">ELSE</span>
<a name="ln-3449"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TubeOutsideSurfAreaDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3450"></a><span class="k">              </span><span class="n">TubeOutsideSurfAreaUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideSurfArea</span>
<a name="ln-3451"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3452"></a>                                    <span class="s1">&#39;Design Size Tube Outside Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">TubeOutsideSurfAreaDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3453"></a>                                    <span class="s1">&#39;User-Specified Tube Outside Surface Area [m2]&#39;</span><span class="p">,</span><span class="n">TubeOutsideSurfAreaUser</span><span class="p">)</span>
<a name="ln-3454"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3455"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TubeOutsideSurfAreaDes</span> <span class="o">-</span> <span class="n">TubeOutsideSurfAreaUser</span><span class="p">)</span><span class="o">/</span><span class="n">TubeOutsideSurfAreaUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3456"></a>                                  <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3457"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3458"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3459"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Tube Outside Surface Area of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3460"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TubeOutsideSurfAreaUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-3461"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Tube Outside Surface Area of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3462"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TubeOutsideSurfAreaDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m2]&#39;</span><span class="p">)</span>
<a name="ln-3463"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3464"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3465"></a>                <span class="k">END IF</span>
<a name="ln-3466"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3467"></a>            <span class="k">END IF</span>
<a name="ln-3468"></a><span class="k">          END IF</span>
<a name="ln-3469"></a>
<a name="ln-3470"></a><span class="k">          </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3471"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">==</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilModel</span> <span class="o">==</span> <span class="n">CoilModel_Detailed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3472"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3473"></a>          <span class="k">END IF</span>
<a name="ln-3474"></a><span class="k">            </span><span class="n">CoilDepthDes</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeDepthSpacing</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3475"></a>                           <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumofTubeRows</span>
<a name="ln-3476"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3477"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">=</span> <span class="n">CoilDepthDes</span>
<a name="ln-3478"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3479"></a>                                  <span class="s1">&#39;Design Size Coil Depth [m]&#39;</span><span class="p">,</span><span class="n">CoilDepthDes</span><span class="p">)</span>
<a name="ln-3480"></a>          <span class="k">ELSE</span>
<a name="ln-3481"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoilDepthDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3482"></a><span class="k">              </span><span class="n">CoilDepthUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilDepth</span>
<a name="ln-3483"></a>              <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3484"></a>                                    <span class="s1">&#39;Design Size Coil Depth [m]&#39;</span><span class="p">,</span><span class="n">CoilDepthDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3485"></a>                                    <span class="s1">&#39;User-Specified Coil Depth [m]&#39;</span><span class="p">,</span><span class="n">CoilDepthUser</span><span class="p">)</span>
<a name="ln-3486"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3487"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CoilDepthDes</span> <span class="o">-</span> <span class="n">CoilDepthUser</span><span class="p">)</span><span class="o">/</span><span class="n">CoilDepthUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3488"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3489"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3490"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Coil Depth of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3491"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CoilDepthUser</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-3492"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Coil Depth of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3493"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">CoilDepthDes</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-3494"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3495"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3496"></a>                <span class="k">END IF</span>
<a name="ln-3497"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3498"></a>            <span class="k">END IF</span>
<a name="ln-3499"></a><span class="k">          END IF</span>
<a name="ln-3500"></a><span class="k">        END IF</span>
<a name="ln-3501"></a><span class="k">      END IF</span> <span class="c">! end zone coil ELSE - IF</span>
<a name="ln-3502"></a>    <span class="k">ELSE</span>
<a name="ln-3503"></a>      <span class="c">! If there is no cooling Plant Sizing object and autosizing was requested, issue fatal error message</span>
<a name="ln-3504"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3505"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of water coil requires a cooling loop Sizing:Plant object&#39;</span><span class="p">)</span>
<a name="ln-3506"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in water coil object= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3507"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3508"></a>      <span class="k">END IF</span>
<a name="ln-3509"></a><span class="k">    END IF</span> <span class="c">! end of cooling Plant Sizing existence IF - ELSE</span>
<a name="ln-3510"></a>  <span class="k">END IF</span> <span class="c">! end cooling coil IF</span>
<a name="ln-3511"></a>
<a name="ln-3512"></a>  <span class="c">! if this is a heating coil</span>
<a name="ln-3513"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span> <span class="o">==</span> <span class="n">CoilType_Heating</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-3514"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3515"></a>    <span class="c">! find the appropriate heating Plant Sizing object</span>
<a name="ln-3516"></a>    <span class="n">PltSizHeatNum</span> <span class="o">=</span> <span class="n">MyPlantSizingIndex</span><span class="p">(</span><span class="s2">&quot;hot water coil&quot;</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3517"></a>                                       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span><span class="p">,</span> <span class="n">LoopErrorsFound</span><span class="p">)</span>
<a name="ln-3518"></a>  <span class="n">ENDIF</span>
<a name="ln-3519"></a>
<a name="ln-3520"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span> <span class="o">==</span> <span class="n">CoilType_Heating</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! &#39;Heating&#39;</span>
<a name="ln-3521"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PltSizHeatNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3522"></a>      <span class="c">! if this is a central air system heating coil</span>
<a name="ln-3523"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3524"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3525"></a><span class="k">          </span><span class="n">IsAutosizeReq</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3526"></a>        <span class="k">END IF</span>
<a name="ln-3527"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosizeReq</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingRunDone</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Simulation continue</span>
<a name="ln-3528"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3529"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3530"></a>                                <span class="s1">&#39;User-Specified Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-3531"></a>          <span class="k">END IF</span>
<a name="ln-3532"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3533"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3534"></a>                                <span class="s1">&#39;User-Specified U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span><span class="p">)</span>
<a name="ln-3535"></a>          <span class="k">END IF</span>
<a name="ln-3536"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3537"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3538"></a>                                <span class="s1">&#39;User-Specified Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span><span class="p">)</span>
<a name="ln-3539"></a>          <span class="k">END IF</span>
<a name="ln-3540"></a><span class="k">        ELSE</span>
<a name="ln-3541"></a><span class="k">          CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3542"></a>
<a name="ln-3543"></a>        <span class="c">! if the coil water volume flow rate needs autosizing, then do it</span>
<a name="ln-3544"></a>          <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3545"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">UAandFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3546"></a>               <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">NomCap</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3547"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3548"></a>          <span class="k">END IF</span>
<a name="ln-3549"></a><span class="c">!          CALL CheckSysSizing(&#39;Coil:Heating:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-3550"></a>          <span class="c">! set the duct flow rate</span>
<a name="ln-3551"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3552"></a><span class="k">            </span><span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-3553"></a>          <span class="k">ELSE</span>
<a name="ln-3554"></a><span class="k">            SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-3555"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-3556"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">SysAirMinFlowRat</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3557"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-3558"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">SysAirMinFlowRat</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-3559"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-3560"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-3561"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-3562"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3563"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3564"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3565"></a>           <span class="k">END SELECT</span>
<a name="ln-3566"></a><span class="k">          END IF</span>
<a name="ln-3567"></a><span class="k">          </span><span class="n">DesMassFlow</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">DesVolFlow</span>
<a name="ln-3568"></a>          <span class="c">! reset the design air volume flow rate</span>
<a name="ln-3569"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">=</span> <span class="n">DesVolFlow</span>
<a name="ln-3570"></a>          <span class="c">! get the outside air fraction</span>
<a name="ln-3571"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3572"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3573"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOAOption</span> <span class="o">==</span> <span class="n">MinOA</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3574"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DesVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3575"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">DesVolFlow</span>
<a name="ln-3576"></a>            <span class="k">ELSE</span>
<a name="ln-3577"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3578"></a>            <span class="k">END IF</span>
<a name="ln-3579"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-3580"></a>          <span class="k">ELSE</span>
<a name="ln-3581"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3582"></a>          <span class="k">END IF</span>
<a name="ln-3583"></a>          <span class="c">! coil input temperature</span>
<a name="ln-3584"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOAHeatCoils</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3585"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PreheatTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3586"></a>                           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetTemp</span>
<a name="ln-3587"></a>          <span class="k">ELSE</span>
<a name="ln-3588"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3589"></a>                           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetTemp</span>
<a name="ln-3590"></a>          <span class="k">END IF</span>
<a name="ln-3591"></a>          <span class="c">! coil load</span>
<a name="ln-3592"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3593"></a><span class="k">            </span><span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">CpAirStd</span><span class="o">*</span><span class="n">DesMassFlow</span><span class="o">*</span><span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PreheatTemp</span> <span class="o">-</span> <span class="n">CoilInTemp</span><span class="p">)</span>
<a name="ln-3594"></a>          <span class="k">ELSE</span>
<a name="ln-3595"></a><span class="k">            </span><span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">CpAirStd</span><span class="o">*</span><span class="n">DesMassFlow</span><span class="o">*</span><span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span> <span class="o">-</span> <span class="n">CoilInTemp</span><span class="p">)</span>
<a name="ln-3596"></a>          <span class="k">END IF</span>
<a name="ln-3597"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DesCoilLoad</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3598"></a>
<a name="ln-3599"></a><span class="k">            </span><span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3600"></a>                       <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3601"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3602"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3603"></a>
<a name="ln-3604"></a>            <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3605"></a>                       <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3606"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3607"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3608"></a>            <span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">DesCoilLoad</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3609"></a>                                  <span class="p">(</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3610"></a>                                  <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-3611"></a>          <span class="k">ELSE</span>
<a name="ln-3612"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3613"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The design coil load is zero for Coil:Heating:Water &#39;</span> <span class="p">&amp;</span>
<a name="ln-3614"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3615"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The autosize value for maximum water flow rate is zero&#39;</span><span class="p">)</span>
<a name="ln-3616"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;To change this, input a value for UA, change the heating design day, or lower&#39;</span><span class="p">)</span>
<a name="ln-3617"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the system heating design supply air temperature&#39;</span><span class="p">)</span>
<a name="ln-3618"></a>          <span class="k">END IF</span>
<a name="ln-3619"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterHeatingCoilRate</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-3620"></a>          <span class="n">DesWaterHeatingCoilRateDes</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-3621"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3622"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="n">MaxWaterVolFlowRateDes</span>
<a name="ln-3623"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">=</span> <span class="n">DesWaterHeatingCoilRateDes</span>
<a name="ln-3624"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3625"></a>                                  <span class="s1">&#39;Design Size Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">DesWaterHeatingCoilRateDes</span><span class="p">)</span>
<a name="ln-3626"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3627"></a>                                  <span class="s1">&#39;Design Size Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">)</span>
<a name="ln-3628"></a>          <span class="k">ELSE</span>
<a name="ln-3629"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-3630"></a>            <span class="n">DesWaterHeatingCoilRateUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span>
<a name="ln-3631"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MaxWaterVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3632"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3633"></a>                                  <span class="s1">&#39;Design Size Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3634"></a>                                  <span class="s1">&#39;User-Specified Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span>
<a name="ln-3635"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3636"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">-</span> <span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span> <span class="o">&gt;</span><span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3637"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3638"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3639"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Maximum Water Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3640"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3641"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Maximum Water Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3642"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3643"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3644"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3645"></a>                <span class="k">END IF</span>
<a name="ln-3646"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3647"></a>            <span class="k">END IF</span>
<a name="ln-3648"></a><span class="k">            IF</span> <span class="p">(</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesWaterHeatingCoilRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3649"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3650"></a>                                  <span class="s1">&#39;Design Size Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">DesWaterHeatingCoilRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3651"></a>                                  <span class="s1">&#39;User-Specified Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">DesWaterHeatingCoilRateUser</span><span class="p">)</span>
<a name="ln-3652"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3653"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesWaterHeatingCoilRateDes</span> <span class="o">-</span> <span class="n">DesWaterHeatingCoilRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">DesWaterHeatingCoilRateUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3654"></a>                                       <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3655"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3656"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3657"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Coil Load of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3658"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesWaterHeatingCoilRateUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3659"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Coil Load of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3660"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesWaterHeatingCoilRateDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3661"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3662"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3663"></a>                <span class="k">END IF</span>
<a name="ln-3664"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3665"></a>            <span class="k">END IF</span>
<a name="ln-3666"></a><span class="k">          END IF</span>
<a name="ln-3667"></a>          <span class="c">! if the coil UA needs autosizing, then do it</span>
<a name="ln-3668"></a>          <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3669"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">UAandFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3670"></a>             <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">NomCap</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3671"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3672"></a>          <span class="k">END IF</span>
<a name="ln-3673"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3674"></a>            <span class="c">! to avoid a false indication after calling SolveRegulaFalsi</span>
<a name="ln-3675"></a>            <span class="n">UACoilUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span>
<a name="ln-3676"></a>          <span class="k">END IF</span>
<a name="ln-3677"></a> <span class="c">!         CALL CheckSysSizing(&#39;Coil:Heating:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-3678"></a>          <span class="c">! set the duct flow rate</span>
<a name="ln-3679"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3680"></a><span class="k">            </span><span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-3681"></a>          <span class="k">ELSE</span>
<a name="ln-3682"></a><span class="k">            SELECT CASE</span><span class="p">(</span><span class="n">CurDuctType</span><span class="p">)</span>
<a name="ln-3683"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Main</span><span class="p">)</span>
<a name="ln-3684"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">SysAirMinFlowRat</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3685"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Cooling</span><span class="p">)</span>
<a name="ln-3686"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">SysAirMinFlowRat</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span>
<a name="ln-3687"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Heating</span><span class="p">)</span>
<a name="ln-3688"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-3689"></a>              <span class="k">CASE</span><span class="p">(</span><span class="n">Other</span><span class="p">)</span>
<a name="ln-3690"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3691"></a>              <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-3692"></a>                <span class="n">DesVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-3693"></a>           <span class="k">END SELECT</span>
<a name="ln-3694"></a><span class="k">          END IF</span>
<a name="ln-3695"></a><span class="k">          </span><span class="n">DesMassFlow</span> <span class="o">=</span> <span class="n">RhoAirStd</span><span class="o">*</span><span class="n">DesVolFlow</span>
<a name="ln-3696"></a>          <span class="c">! reset the coil design air volume flow rate</span>
<a name="ln-3697"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">=</span> <span class="n">DesVolFlow</span>
<a name="ln-3698"></a>          <span class="c">! get the outside air fraction</span>
<a name="ln-3699"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3700"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3701"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOAOption</span> <span class="o">==</span> <span class="n">MinOA</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3702"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">DesVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3703"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">DesVolFlow</span>
<a name="ln-3704"></a>            <span class="k">ELSE</span>
<a name="ln-3705"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3706"></a>            <span class="k">END IF</span>
<a name="ln-3707"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-3708"></a>          <span class="k">ELSE</span>
<a name="ln-3709"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3710"></a>          <span class="k">END IF</span>
<a name="ln-3711"></a>          <span class="c">! coil inlet temperature</span>
<a name="ln-3712"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOAHeatCoils</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3713"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PreheatTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3714"></a>                           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetTemp</span>
<a name="ln-3715"></a>            <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PreheatHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3716"></a>                             <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetHumRat</span>
<a name="ln-3717"></a>          <span class="k">ELSE</span>
<a name="ln-3718"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3719"></a>                           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetTemp</span>
<a name="ln-3720"></a>            <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatOutHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3721"></a>                           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatRetHumRat</span>
<a name="ln-3722"></a>          <span class="k">END IF</span>
<a name="ln-3723"></a>          <span class="c">! coil load</span>
<a name="ln-3724"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3725"></a><span class="k">            </span><span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">CpAirStd</span><span class="o">*</span><span class="n">DesMassFlow</span><span class="o">*</span><span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PreheatTemp</span> <span class="o">-</span> <span class="n">CoilInTemp</span><span class="p">)</span>
<a name="ln-3726"></a>          <span class="k">ELSE</span>
<a name="ln-3727"></a><span class="k">            </span><span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">CpAirStd</span><span class="o">*</span><span class="n">DesMassFlow</span><span class="o">*</span><span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span> <span class="o">-</span> <span class="n">CoilInTemp</span><span class="p">)</span>
<a name="ln-3728"></a>          <span class="k">END IF</span>
<a name="ln-3729"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DesCoilLoad</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3730"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-3731"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-3732"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">ContFanCycCoil</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="c">!fan operating mode</span>
<a name="ln-3733"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! part-load ratio</span>
<a name="ln-3734"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="n">CoilInTemp</span>
<a name="ln-3735"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">CoilInHumRat</span>
<a name="ln-3736"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">ExitTemp</span>
<a name="ln-3737"></a>
<a name="ln-3738"></a>            <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3739"></a>                       <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3740"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3741"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3742"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-3743"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">DesMassFlow</span>
<a name="ln-3744"></a>            <span class="c">! set the lower and upper limits on the UA</span>
<a name="ln-3745"></a>            <span class="n">UA0</span> <span class="o">=</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span> <span class="o">*</span> <span class="n">DesCoilLoad</span>
<a name="ln-3746"></a>            <span class="n">UA1</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-3747"></a>            <span class="c">! Invert the simple heating coil model: given the design inlet conditions and the design load,</span>
<a name="ln-3748"></a>            <span class="c">! find the design UA.</span>
<a name="ln-3749"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleHeatingCoilUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-3750"></a>            <span class="c">! if the numerical inversion failed, issue error messages.</span>
<a name="ln-3751"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3752"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of heating coil UA failed for Coil:Heating:Water &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3753"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3754"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating coil UA&#39;</span><span class="p">)</span>
<a name="ln-3755"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Lower UA estimate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K (1% of Design Coil Load)&#39;</span><span class="p">)</span>
<a name="ln-3756"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Upper UA estimate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K (100% of Design Coil Load)&#39;</span><span class="p">)</span>
<a name="ln-3757"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Final UA estimate when iterations exceeded limit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K&#39;</span><span class="p">)</span>
<a name="ln-3758"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  AirloopHVAC &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirPriLoopName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3759"></a>                                     <span class="s1">&#39;&quot; coil sizing conditions (may be different than Sizing inputs):&#39;</span><span class="p">)</span>
<a name="ln-3760"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilInTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-3761"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air humidity ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilInHumRat</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3762"></a>                 <span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-3763"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air mass flow rate  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesMassFlow</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-3764"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Capacity           = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3765"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3766"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Load               = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesCoilLoad</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3767"></a>              <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3768"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3769"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of heating coil UA failed for Coil:Heating:Water &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3770"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3771"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-3772"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Lower UA estimate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K (1% of Design Coil Load)&#39;</span><span class="p">)</span>
<a name="ln-3773"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Upper UA estimate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K (100% of Design Coil Load)&#39;</span><span class="p">)</span>
<a name="ln-3774"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  AirloopHVAC &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">AirPriLoopName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3775"></a>                                     <span class="s1">&#39;&quot; coil sizing conditions (may be different than Sizing inputs):&#39;</span><span class="p">)</span>
<a name="ln-3776"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilInTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-3777"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air humidity ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilInHumRat</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3778"></a>                 <span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-3779"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air mass flow rate  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesMassFlow</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-3780"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Capacity           = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3781"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3782"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Load               = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesCoilLoad</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-3783"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span> <span class="o">&lt;</span> <span class="n">DesCoilLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3784"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Inadequate water side capacity: in Plant Sizing for this hot water loop&#39;</span><span class="p">)</span>
<a name="ln-3785"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  increase design loop exit temperature and/or decrease design loop delta T&#39;</span><span class="p">)</span>
<a name="ln-3786"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Plant Sizing object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">PlantLoopName</span><span class="p">))</span>
<a name="ln-3787"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Plant design loop exit temperature = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3788"></a>                                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-3789"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Plant design loop delta T          = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3790"></a>                                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">DeltaT</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-3791"></a>              <span class="k">END IF</span>
<a name="ln-3792"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3793"></a>            <span class="k">END IF</span>
<a name="ln-3794"></a><span class="k">            </span><span class="n">UACoilDes</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-3795"></a>          <span class="k">ELSE</span>
<a name="ln-3796"></a><span class="k">            </span><span class="n">UACoilDes</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3797"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3798"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3799"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The design coil load is zero for Coil:Heating:Water &#39;</span> <span class="p">&amp;</span>
<a name="ln-3800"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3801"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;An autosize value for UA cannot be calculated&#39;</span><span class="p">)</span>
<a name="ln-3802"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input a value for UA, change the heating design day, or raise&#39;</span><span class="p">)</span>
<a name="ln-3803"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the system heating design supply air temperature&#39;</span><span class="p">)</span>
<a name="ln-3804"></a>            <span class="k">END IF</span>
<a name="ln-3805"></a><span class="k">          END IF</span>
<a name="ln-3806"></a><span class="k">          </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterHeatingCoilRate</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-3807"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3808"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="o">=</span> <span class="n">UACoilDes</span>
<a name="ln-3809"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-3810"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3811"></a>                                  <span class="s1">&#39;Design Size U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span><span class="n">UACoilDes</span><span class="p">)</span>
<a name="ln-3812"></a>          <span class="k">ELSE</span>
<a name="ln-3813"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">UACoilUser</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UACoilDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3814"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3815"></a>                                  <span class="s1">&#39;Design Size U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span><span class="n">UACoilDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3816"></a>                                  <span class="s1">&#39;User-Specified U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span><span class="n">UACoilUser</span><span class="p">)</span>
<a name="ln-3817"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3818"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">UACoilDes</span> <span class="o">-</span> <span class="n">UACoilUser</span><span class="p">)</span><span class="o">/</span><span class="n">UACoilUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3819"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3820"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3821"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified U-Factor Times Area Value of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3822"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">UACoilUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W/K]&#39;</span><span class="p">)</span>
<a name="ln-3823"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size U-Factor Times Area Value of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3824"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">UACoilDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W/K]&#39;</span><span class="p">)</span>
<a name="ln-3825"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3826"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3827"></a>                <span class="k">END IF</span>
<a name="ln-3828"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3829"></a>            <span class="k">END IF</span>
<a name="ln-3830"></a><span class="k">          END IF</span>
<a name="ln-3831"></a><span class="k">        END IF</span>
<a name="ln-3832"></a>      <span class="c">! if this is a zone coil</span>
<a name="ln-3833"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3834"></a><span class="k">        </span><span class="n">IsAutosizeReq</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3835"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3836"></a><span class="k">          </span><span class="n">IsAutosizeReq</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3837"></a>        <span class="k">END IF</span>
<a name="ln-3838"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosizeReq</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ZoneSizingRunDone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3839"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3840"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3841"></a>                                <span class="s1">&#39;User-Specified Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-3842"></a>          <span class="k">END IF</span>
<a name="ln-3843"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3844"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3845"></a>                                <span class="s1">&#39;User-Specified U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span><span class="p">)</span>
<a name="ln-3846"></a>          <span class="k">END IF</span>
<a name="ln-3847"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3848"></a><span class="k">            CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3849"></a>                                <span class="s1">&#39;User-Specified Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span><span class="p">)</span>
<a name="ln-3850"></a>          <span class="k">END IF</span>
<a name="ln-3851"></a><span class="k">        ELSE</span>
<a name="ln-3852"></a><span class="k">          CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-3853"></a>          <span class="c">! autosize the coil water volume flow rate if needed</span>
<a name="ln-3854"></a>          <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3855"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">UAandFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3856"></a>             <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">NomCap</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3857"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3858"></a>          <span class="k">END IF</span>
<a name="ln-3859"></a><span class="c">!          CALL CheckZoneSizing(&#39;Coil:Heating:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-3860"></a>          <span class="c">! if coil is part of a terminal unit just use the terminal unit value</span>
<a name="ln-3861"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">TermUnitSingDuct</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TermUnitPIU</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3862"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">MaxHWVolFlow</span>
<a name="ln-3863"></a>            <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3864"></a>                       <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3865"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3866"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3867"></a>
<a name="ln-3868"></a>            <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3869"></a>                       <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3870"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3871"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3872"></a>
<a name="ln-3873"></a>            <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">MaxWaterVolFlowRateDes</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3874"></a>                          <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-3875"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ZoneEqFanCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3876"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">MaxHWVolFlow</span>
<a name="ln-3877"></a>            <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3878"></a>                       <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3879"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3880"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3881"></a>
<a name="ln-3882"></a>            <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3883"></a>                       <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3884"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3885"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3886"></a>
<a name="ln-3887"></a>            <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">MaxWaterVolFlowRateDes</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3888"></a>                          <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-3889"></a>          <span class="c">! if coil is part of a zonal unit, calc coil load to get hot water flow rate</span>
<a name="ln-3890"></a>          <span class="k">ELSE</span>
<a name="ln-3891"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTemp</span>
<a name="ln-3892"></a>            <span class="n">CoilOutTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesTemp</span>
<a name="ln-3893"></a>            <span class="n">CoilOutHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesHumRat</span>
<a name="ln-3894"></a>            <span class="n">DesMassFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatMassFlow</span>
<a name="ln-3895"></a>            <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">CoilOutHumRat</span><span class="p">,</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="n">CoilInTemp</span><span class="o">+</span><span class="n">CoilOutTemp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-3896"></a>                          <span class="o">*</span> <span class="n">DesMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">CoilOutTemp</span><span class="o">-</span><span class="n">CoilInTemp</span><span class="p">)</span>
<a name="ln-3897"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">DesCoilLoad</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3898"></a><span class="k">              </span><span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3899"></a>                       <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3900"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3901"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3902"></a>
<a name="ln-3903"></a>              <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3904"></a>                       <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-3905"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3906"></a>                       <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-3907"></a>
<a name="ln-3908"></a>              <span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="n">DesCoilLoad</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-3909"></a>                                       <span class="p">(</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3910"></a>                                       <span class="n">Cp</span><span class="o">*</span> <span class="n">rho</span> <span class="p">)</span>
<a name="ln-3911"></a>            <span class="k">ELSE</span>
<a name="ln-3912"></a><span class="k">              </span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-3913"></a>            <span class="k">END IF</span>
<a name="ln-3914"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterHeatingCoilRate</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-3915"></a>            <span class="n">DesWaterHeatingCoilRateDes</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-3916"></a>          <span class="k">END IF</span>
<a name="ln-3917"></a>          <span class="c">! issue warning if hw coil has zero flow</span>
<a name="ln-3918"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3919"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;The design coil load is zero for Coil:Heating:Water &#39;</span> <span class="p">&amp;</span>
<a name="ln-3920"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3921"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The autosize value for maximum water flow rate is zero&#39;</span><span class="p">)</span>
<a name="ln-3922"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;To change this, input a value for UA, change the heating design day, or lower&#39;</span><span class="p">)</span>
<a name="ln-3923"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the system heating design supply air temperature&#39;</span><span class="p">)</span>
<a name="ln-3924"></a>          <span class="k">END IF</span>
<a name="ln-3925"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3926"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">=</span> <span class="n">MaxWaterVolFlowRateDes</span>
<a name="ln-3927"></a>            <span class="c">!WaterCoil(CoilNum)%DesTotWaterCoilLoad = DesWaterHeatingCoilRateDes</span>
<a name="ln-3928"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3929"></a>                                  <span class="s1">&#39;Design Size Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">DesCoilLoad</span><span class="p">)</span> <span class="c">!DesWaterHeatingCoilRateDes)</span>
<a name="ln-3930"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3931"></a>                                  <span class="s1">&#39;Design Size Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">)</span>
<a name="ln-3932"></a>          <span class="k">ELSE</span>
<a name="ln-3933"></a><span class="k">            </span><span class="n">MaxWaterVolFlowRateUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-3934"></a>            <span class="n">DesWaterHeatingCoilRateUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span>
<a name="ln-3935"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MaxWaterVolFlowRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3936"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3937"></a>                                  <span class="s1">&#39;Design Size Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3938"></a>                                  <span class="s1">&#39;User-Specified Maximum Water Flow Rate [m3/s]&#39;</span><span class="p">,</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span>
<a name="ln-3939"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3940"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span> <span class="o">-</span> <span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3941"></a>                               <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3942"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3943"></a>                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3944"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Maximum Water Flow Rate of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3945"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateUser</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3946"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Maximum Water Flow Rate of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3947"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxWaterVolFlowRateDes</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [m3/s]&#39;</span><span class="p">)</span>
<a name="ln-3948"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3949"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3950"></a>                <span class="k">END IF</span>
<a name="ln-3951"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3952"></a>            <span class="k">END IF</span>
<a name="ln-3953"></a><span class="k">            IF</span> <span class="p">(</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">DesWaterHeatingCoilRateDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3954"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3955"></a>                                  <span class="s1">&#39;Design Size Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">DesWaterHeatingCoilRateDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3956"></a>                                  <span class="s1">&#39;User-Specified Design Coil Load [W]&#39;</span><span class="p">,</span><span class="n">DesWaterHeatingCoilRateUser</span><span class="p">)</span>
<a name="ln-3957"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3958"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesWaterHeatingCoilRateDes</span> <span class="o">-</span> <span class="n">DesWaterHeatingCoilRateUser</span><span class="p">)</span><span class="o">/</span><span class="n">DesWaterHeatingCoilRateUser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3959"></a>                                <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3960"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3961"></a>                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3962"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified Design Coil Load of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3963"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesWaterHeatingCoilRateUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3964"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size Design Coil Load of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3965"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">DesWaterHeatingCoilRateDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W]&#39;</span><span class="p">)</span>
<a name="ln-3966"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-3967"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-3968"></a>                <span class="k">END IF</span>
<a name="ln-3969"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-3970"></a>            <span class="k">END IF</span>
<a name="ln-3971"></a><span class="k">          END IF</span>
<a name="ln-3972"></a>
<a name="ln-3973"></a>        <span class="c">! autosize the coil UA if needed</span>
<a name="ln-3974"></a>          <span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3975"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">UAandFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3976"></a>             <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilPerfInpMeth</span> <span class="o">==</span> <span class="n">NomCap</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesTotWaterCoilLoad</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3977"></a><span class="k">            </span><span class="n">IsAutosize</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3978"></a>          <span class="k">END IF</span>
<a name="ln-3979"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3980"></a><span class="k">            </span><span class="n">UACoilUser</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span>
<a name="ln-3981"></a>          <span class="k">END IF</span>
<a name="ln-3982"></a><span class="c">!          CALL CheckZoneSizing(&#39;Coil:Heating:Water&#39;,WaterCoil(CoilNum)%Name)</span>
<a name="ln-3983"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">TermUnitPIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3984"></a><span class="k">            </span><span class="n">MinFlowFrac</span> <span class="o">=</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">MinFlowFrac</span>
<a name="ln-3985"></a>            <span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTempTU</span> <span class="o">*</span> <span class="n">MinFlowFrac</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3986"></a>                         <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneTempAtHeatPeak</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">MinFlowFrac</span><span class="p">)</span>
<a name="ln-3987"></a>            <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInHumRatTU</span> <span class="o">*</span> <span class="n">MinFlowFrac</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3988"></a>                         <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtHeatPeak</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">MinFlowFrac</span><span class="p">)</span>
<a name="ln-3989"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3990"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneTempAtHeatPeak</span>
<a name="ln-3991"></a>            <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtHeatPeak</span>
<a name="ln-3992"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">TermUnitSingDuct</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3993"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTempTU</span>
<a name="ln-3994"></a>            <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInHumRatTU</span>
<a name="ln-3995"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ZoneEqFanCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3996"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatMassFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3997"></a><span class="k">              </span><span class="n">FCOAFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">RhoAirStd</span><span class="o">*</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">/</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatMassFlow</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-3998"></a>            <span class="k">ELSE</span>
<a name="ln-3999"></a><span class="k">              </span><span class="n">FCOAFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4000"></a>            <span class="k">END IF</span>
<a name="ln-4001"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">FCOAFrac</span><span class="o">*</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OutTempAtHeatPeak</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4002"></a>                           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">FCOAFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneTempAtHeatPeak</span>
<a name="ln-4003"></a>            <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">FCOAFrac</span><span class="o">*</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OutHumRatAtHeatPeak</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4004"></a>                           <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">FCOAFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtHeatPeak</span>
<a name="ln-4005"></a>          <span class="k">ELSE</span>
<a name="ln-4006"></a><span class="k">            </span><span class="n">CoilInTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInTemp</span>
<a name="ln-4007"></a>            <span class="n">CoilInHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatCoilInHumRat</span>
<a name="ln-4008"></a>          <span class="k">END IF</span>
<a name="ln-4009"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">TermUnitSingDuct</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TermUnitPIU</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TermUnitIU</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4010"></a><span class="k">            </span><span class="n">DesMassFlow</span> <span class="o">=</span> <span class="n">RhoAirStd</span> <span class="o">*</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">AirVolFlow</span> <span class="o">*</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ReheatAirFlowMult</span>
<a name="ln-4011"></a>            <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4012"></a>                     <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-4013"></a>                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4014"></a>                     <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-4015"></a>
<a name="ln-4016"></a>            <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4017"></a>                     <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-4018"></a>                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4019"></a>                     <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-4020"></a>
<a name="ln-4021"></a>            <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4022"></a>                            <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ReheatLoadMult</span>
<a name="ln-4023"></a>            <span class="n">DesWaterVolFlow</span> <span class="o">=</span>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">*</span> <span class="n">TermUnitSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ReheatLoadMult</span>
<a name="ln-4024"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ZoneEqFanCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4025"></a><span class="k">            </span><span class="n">DesMassFlow</span> <span class="o">=</span> <span class="n">RhoAirStd</span> <span class="o">*</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span>
<a name="ln-4026"></a>            <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4027"></a>                     <span class="mi">6</span><span class="mf">0.0d0</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-4028"></a>                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4029"></a>                     <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-4030"></a>
<a name="ln-4031"></a>            <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4032"></a>                     <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-4033"></a>                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4034"></a>                     <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-4035"></a>
<a name="ln-4036"></a>            <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">*</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">DeltaT</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4037"></a>                            <span class="n">Cp</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-4038"></a>            <span class="n">DesWaterVolFlow</span> <span class="o">=</span>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-4039"></a>          <span class="k">ELSE</span>
<a name="ln-4040"></a><span class="k">            </span><span class="n">DesMassFlow</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatMassFlow</span>
<a name="ln-4041"></a>            <span class="n">CoilOutTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesTemp</span>
<a name="ln-4042"></a>            <span class="n">CoilOutHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">HeatDesHumRat</span>
<a name="ln-4043"></a>            <span class="n">DesCoilLoad</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">CoilOutHumRat</span><span class="p">,</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="n">CoilInTemp</span><span class="o">+</span><span class="n">CoilOutTemp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-4044"></a>                          <span class="o">*</span> <span class="n">DesMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">CoilOutTemp</span><span class="o">-</span><span class="n">CoilInTemp</span><span class="p">)</span>
<a name="ln-4045"></a>            <span class="n">DesWaterVolFlow</span> <span class="o">=</span>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-4046"></a>          <span class="k">END IF</span>
<a name="ln-4047"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DesCoilLoad</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4048"></a>          <span class="c">! pass along the coil number and the design load to the residual calculation</span>
<a name="ln-4049"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-4050"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-4051"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">ContFanCycCoil</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="c">!fan operating mode</span>
<a name="ln-4052"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! part-load ratio</span>
<a name="ln-4053"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">=</span> <span class="n">CoilInTemp</span>
<a name="ln-4054"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">CoilInHumRat</span>
<a name="ln-4055"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CoilInTemp</span><span class="p">,</span><span class="n">CoilInHumrat</span><span class="p">)</span> <span class="c">!9216 added</span>
<a name="ln-4056"></a>          <span class="c">!  WaterCoil(CoilNum)%InletAirMassFlowRate = MAX(FinalZoneSizing(CurZoneEqNum)%DesCoolMassFlow, &amp;</span>
<a name="ln-4057"></a>          <span class="c">!                                   FinalZoneSizing(CurZoneEqNum)%DesHeatMassFlow)</span>
<a name="ln-4058"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">=</span> <span class="n">DesMassFlow</span>
<a name="ln-4059"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span> <span class="o">=</span> <span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">ExitTemp</span>
<a name="ln-4060"></a>            <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4061"></a>                     <span class="n">InitConvTemp</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-4062"></a>                     <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4063"></a>                     <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-4064"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">DesWaterVolFlow</span>
<a name="ln-4065"></a>            <span class="c">! set the lower and upper limits on the UA</span>
<a name="ln-4066"></a>            <span class="n">UA0</span> <span class="o">=</span> <span class="p">.</span><span class="mi">001</span><span class="n">d0</span> <span class="o">*</span> <span class="n">DesCoilLoad</span>
<a name="ln-4067"></a>            <span class="n">UA1</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-4068"></a>            <span class="c">! Invert the simple heating coil model: given the design inlet conditions and the design load,</span>
<a name="ln-4069"></a>            <span class="c">! find the design UA.</span>
<a name="ln-4070"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">UA</span><span class="p">,</span> <span class="n">SimpleHeatingCoilUAResidual</span><span class="p">,</span> <span class="n">UA0</span><span class="p">,</span> <span class="n">UA1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-4071"></a>            <span class="c">! if the numerical inversion failed, issue error messages.</span>
<a name="ln-4072"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4073"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of heating coil UA failed for Coil:Heating:Water &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4074"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4075"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating coil UA&#39;</span><span class="p">)</span>
<a name="ln-4076"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Lower UA estimate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K (0.1% of Design Coil Load)&#39;</span><span class="p">)</span>
<a name="ln-4077"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Upper UA estimate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K (100% of Design Coil Load)&#39;</span><span class="p">)</span>
<a name="ln-4078"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Final UA estimate when iterations exceeded limit = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K&#39;</span><span class="p">)</span>
<a name="ln-4079"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Zone &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4080"></a>                                     <span class="s1">&#39;&quot; coil sizing conditions (may be different than Sizing inputs):&#39;</span><span class="p">)</span>
<a name="ln-4081"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilInTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-4082"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air humidity ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilInHumRat</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4083"></a>                 <span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-4084"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air mass flow rate  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesMassFlow</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-4085"></a><span class="c">! TotWaterHeatingCoilRate is set in CALL to CalcSimpleHeatingCoil</span>
<a name="ln-4086"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Capacity           = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4087"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4088"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">TermUnitSingDuct</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TermUnitPIU</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TermUnitIU</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneEqFanCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4089"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Load               = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesCoilLoad</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4090"></a>              <span class="k">ELSE</span>
<a name="ln-4091"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Load               = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesCoilLoad</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4092"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil outlet air temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilOutTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-4093"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil outlet air humidity ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilOutHumRat</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4094"></a>                   <span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-4095"></a>              <span class="k">END IF</span>
<a name="ln-4096"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4097"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4098"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of heating coil UA failed for Coil:Heating:Water &quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4099"></a>                                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4100"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Bad starting values for UA&#39;</span><span class="p">)</span>
<a name="ln-4101"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Lower UA estimate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K (0.1% of Design Coil Load)&#39;</span><span class="p">)</span>
<a name="ln-4102"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Upper UA estimate = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">UA1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W/m2-K (100% of Design Coil Load)&#39;</span><span class="p">)</span>
<a name="ln-4103"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Zone &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4104"></a>                                     <span class="s1">&#39;&quot; coil sizing conditions (may be different than Sizing inputs):&#39;</span><span class="p">)</span>
<a name="ln-4105"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air temperature     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilInTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-4106"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air humidity ratio  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilInHumRat</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4107"></a>                 <span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-4108"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil inlet air mass flow rate  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesMassFlow</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-4109"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Capacity           = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4110"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4111"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">TermUnitSingDuct</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TermUnitPIU</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TermUnitIU</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ZoneEqFanCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4112"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Load               = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesCoilLoad</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4113"></a>              <span class="k">ELSE</span>
<a name="ln-4114"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Design Coil Load               = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">DesCoilLoad</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; W&#39;</span><span class="p">)</span>
<a name="ln-4115"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil outlet air temperature    = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilOutTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-4116"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Coil outlet air humidity ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilOutHumRat</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4117"></a>                   <span class="s1">&#39; kgWater/kgDryAir&#39;</span><span class="p">)</span>
<a name="ln-4118"></a>              <span class="k">END IF</span>
<a name="ln-4119"></a><span class="c">! TotWaterHeatingCoilRate is set in CALL to CalcSimpleHeatingCoil</span>
<a name="ln-4120"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span> <span class="o">&lt;</span> <span class="n">DesCoilLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4121"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Inadequate water side capacity: in Plant Sizing for this hot water loop&#39;</span><span class="p">)</span>
<a name="ln-4122"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  increase design loop exit temperature and/or decrease design loop delta T&#39;</span><span class="p">)</span>
<a name="ln-4123"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Plant Sizing object = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">PlantLoopName</span><span class="p">))</span>
<a name="ln-4124"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Plant design loop exit temperature = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4125"></a>                                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">ExitTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-4126"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Plant design loop delta T          = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4127"></a>                                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">PlantSizData</span><span class="p">(</span><span class="n">PltSizHeatNum</span><span class="p">)%</span><span class="n">DeltaT</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; C&#39;</span><span class="p">)</span>
<a name="ln-4128"></a>              <span class="k">END IF</span>
<a name="ln-4129"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4130"></a>            <span class="k">END IF</span>
<a name="ln-4131"></a><span class="k">            </span><span class="n">UACoilDes</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-4132"></a>          <span class="k">ELSE</span>
<a name="ln-4133"></a><span class="k">            </span><span class="n">UACoilDes</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4134"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4135"></a><span class="k">              </span><span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4136"></a>              <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;The design coil load is zero for Coil:Heating:Water &#39;</span> <span class="p">&amp;</span>
<a name="ln-4137"></a>                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4138"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;An autosize value for UA cannot be calculated&#39;</span><span class="p">)</span>
<a name="ln-4139"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Input a value for UA, change the heating design day, or raise&#39;</span><span class="p">)</span>
<a name="ln-4140"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  the zone heating design supply air temperature&#39;</span><span class="p">)</span>
<a name="ln-4141"></a>            <span class="k">END IF</span>
<a name="ln-4142"></a><span class="k">          END IF</span>
<a name="ln-4143"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">IsAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4144"></a><span class="k">            </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoil</span> <span class="o">=</span> <span class="n">UACoilDes</span>
<a name="ln-4145"></a>            <span class="c">!WaterCoil(CoilNum)%DesTotWaterCoilLoad = DesCoilLoad</span>
<a name="ln-4146"></a>            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesWaterHeatingCoilRate</span> <span class="o">=</span> <span class="n">DesCoilLoad</span>
<a name="ln-4147"></a>            <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4148"></a>                                  <span class="s1">&#39;Design Size U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span><span class="n">UACoilDes</span><span class="p">)</span>
<a name="ln-4149"></a>          <span class="k">ELSE</span>
<a name="ln-4150"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">UACoilUser</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">UACoilDes</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4151"></a><span class="k">              CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,&amp;</span>
<a name="ln-4152"></a>                                  <span class="s1">&#39;Design Size U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span><span class="n">UACoilDes</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4153"></a>                                  <span class="s1">&#39;User-Specified U-Factor Times Area Value [W/K]&#39;</span><span class="p">,</span><span class="n">UACoilUser</span><span class="p">)</span>
<a name="ln-4154"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4155"></a><span class="k">                IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">UACoilDes</span> <span class="o">-</span> <span class="n">UACoilUser</span><span class="p">)</span><span class="o">/</span><span class="n">UACoilUser</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">AutoVsHardSizingThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4156"></a><span class="k">                  CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;SizeWaterCoil: Potential issue with equipment sizing for Coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4157"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4158"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;User-Specified U-Factor Times Area Value of &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4159"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">UACoilUser</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W/K]&#39;</span><span class="p">)</span>
<a name="ln-4160"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;differs from Design Size U-Factor Times Area Value of &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4161"></a>                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">UACoilDes</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="s1">&#39; [W/K]&#39;</span><span class="p">)</span>
<a name="ln-4162"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may, or may not, indicate mismatched component sizes.&#39;</span><span class="p">)</span>
<a name="ln-4163"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Verify that the value entered is intended and is consistent with other components.&#39;</span><span class="p">)</span>
<a name="ln-4164"></a>                <span class="k">END IF</span>
<a name="ln-4165"></a><span class="k">              </span><span class="n">ENDIF</span>
<a name="ln-4166"></a>            <span class="k">END IF</span>
<a name="ln-4167"></a><span class="k">          END IF</span>
<a name="ln-4168"></a><span class="k">        END IF</span> <span class="c">! end UA autosize IF</span>
<a name="ln-4169"></a>      <span class="k">END IF</span> <span class="c">! end zone coil ELSE - IF</span>
<a name="ln-4170"></a>    <span class="k">ELSE</span>
<a name="ln-4171"></a>      <span class="c">! if there is no heating Plant Sizing object and autosizng was requested, issue an error message</span>
<a name="ln-4172"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">RequestingAutosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4173"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Autosizing of water coil requires a heating loop Sizing:Plant object&#39;</span><span class="p">)</span>
<a name="ln-4174"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in water coil object= &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4175"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4176"></a>      <span class="k">END IF</span>
<a name="ln-4177"></a><span class="k">    END IF</span> <span class="c">! end of heating Plant Sizing existence IF - ELSE</span>
<a name="ln-4178"></a>  <span class="k">END IF</span> <span class="c">! end heating coil IF</span>
<a name="ln-4179"></a>
<a name="ln-4180"></a>  <span class="c">! save the design water volumetric flow rate for use by the water loop sizing algorithms</span>
<a name="ln-4181"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4182"></a><span class="k">    CALL </span><span class="n">RegisterPlantCompDesignFlow</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span><span class="p">)</span>
<a name="ln-4183"></a>  <span class="k">END IF</span>
<a name="ln-4184"></a>
<a name="ln-4185"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4186"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Preceding water coil sizing errors cause program termination&#39;</span><span class="p">)</span>
<a name="ln-4187"></a>  <span class="k">END IF</span>
<a name="ln-4188"></a>
<a name="ln-4189"></a>
<a name="ln-4190"></a><span class="k">  RETURN</span>
<a name="ln-4191"></a>
<a name="ln-4192"></a><span class="k">END SUBROUTINE </span><span class="n">SizeWaterCoil</span>
<a name="ln-4193"></a>
<a name="ln-4194"></a> <span class="c">! End Initialization Section of the Module</span>
<a name="ln-4195"></a><span class="c">!******************************************************************************</span>
<a name="ln-4196"></a>
<a name="ln-4197"></a>
<a name="ln-4198"></a> <span class="c">! Begin Algorithm Section of the Module</span>
<a name="ln-4199"></a><span class="c">!******************************************************************************</span>
<a name="ln-4200"></a><span class="k">Subroutine </span><span class="n">CalcSimpleHeatingCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CalcMode</span><span class="p">)</span>
<a name="ln-4201"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4202"></a>          <span class="c">!       AUTHOR         Rich Liesen</span>
<a name="ln-4203"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-4204"></a>          <span class="c">!       MODIFIED       Aug. 2007 - R. Raustad, added fan operating mode and part-load ratio to</span>
<a name="ln-4205"></a>          <span class="c">!                                  calculate the outlet conditions when fan and coil cycle.</span>
<a name="ln-4206"></a>          <span class="c">!                                  Air and water outlet temperature are full output with average</span>
<a name="ln-4207"></a>          <span class="c">!                                  air and water mass flow rate when fan and coil cycle.</span>
<a name="ln-4208"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4209"></a>
<a name="ln-4210"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4211"></a>          <span class="c">! Simulates a simple NTU effectiveness model heating coil</span>
<a name="ln-4212"></a>
<a name="ln-4213"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4214"></a>          <span class="c">! (1) outlet conditions are calculated from the effectiveness and the inlet conditions.</span>
<a name="ln-4215"></a>          <span class="c">! (2) Effectiveness is calculated from the NTU formula for a cross flow heat exchanger</span>
<a name="ln-4216"></a>          <span class="c">!     with both streams unmixed.</span>
<a name="ln-4217"></a>          <span class="c">! Note: UA is input by user and is fixed.</span>
<a name="ln-4218"></a>
<a name="ln-4219"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4220"></a>          <span class="c">! See for instance ASHRAE HVAC 2 Toolkit, page 4-4, formula (4-7)</span>
<a name="ln-4221"></a>
<a name="ln-4222"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4223"></a>          <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span>  <span class="n">ONLY</span> <span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-4224"></a>
<a name="ln-4225"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4226"></a>
<a name="ln-4227"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4228"></a>   <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>        <span class="c">! index to heating coil</span>
<a name="ln-4229"></a>   <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>      <span class="c">! fan operating mode</span>
<a name="ln-4230"></a>   <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>  <span class="c">! part-load ratio of heating coil</span>
<a name="ln-4231"></a>   <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CalcMode</span> <span class="c">! 1 = design calc; 2 = simulation calculation</span>
<a name="ln-4232"></a>
<a name="ln-4233"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4234"></a>          <span class="c">! na</span>
<a name="ln-4235"></a>
<a name="ln-4236"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4237"></a>          <span class="c">! na</span>
<a name="ln-4238"></a>
<a name="ln-4239"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4240"></a>          <span class="c">! na</span>
<a name="ln-4241"></a>
<a name="ln-4242"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4243"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WaterMassFlowRate</span>
<a name="ln-4244"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">AirMassFlow</span>  <span class="c">! [kg/sec]</span>
<a name="ln-4245"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempAirIn</span>    <span class="c">! [C]</span>
<a name="ln-4246"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempAirOut</span>   <span class="c">! [C]</span>
<a name="ln-4247"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Win</span>
<a name="ln-4248"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempWaterIn</span>
<a name="ln-4249"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempWaterOut</span>
<a name="ln-4250"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">UA</span>
<a name="ln-4251"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CapacitanceAir</span>
<a name="ln-4252"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CapacitanceWater</span>
<a name="ln-4253"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CapacitanceMin</span>
<a name="ln-4254"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CapacitanceMax</span>
<a name="ln-4255"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">HeatingCoilLoad</span>
<a name="ln-4256"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">NTU</span><span class="p">,</span> <span class="n">ETA</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">CapRatio</span><span class="p">,</span> <span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">Effec</span>
<a name="ln-4257"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Cp</span>
<a name="ln-4258"></a>      <span class="kt">Integer </span><span class="n">Control</span>
<a name="ln-4259"></a>
<a name="ln-4260"></a>   <span class="n">UA</span>           <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilVariable</span>
<a name="ln-4261"></a>   <span class="n">TempAirIn</span>    <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-4262"></a>   <span class="n">Win</span>          <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-4263"></a>   <span class="n">Control</span>      <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Control</span>
<a name="ln-4264"></a>   <span class="n">TempWaterIn</span>  <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-4265"></a>
<a name="ln-4266"></a><span class="c">!  adjust mass flow rates for cycling fan cycling coil operation</span>
<a name="ln-4267"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4268"></a><span class="k">     IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4269"></a><span class="k">       </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span>
<a name="ln-4270"></a>       <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4271"></a>                               <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span><span class="p">)</span>
<a name="ln-4272"></a>     <span class="k">ELSE</span>
<a name="ln-4273"></a><span class="k">       </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4274"></a>       <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4275"></a>     <span class="k">END IF</span>
<a name="ln-4276"></a><span class="k">   ELSE</span>
<a name="ln-4277"></a><span class="k">     </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-4278"></a>     <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-4279"></a>   <span class="k">END IF</span>
<a name="ln-4280"></a>
<a name="ln-4281"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">WaterMassFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MassFlowTolerance</span><span class="p">)</span> <span class="k">THEN</span>     <span class="c">! If the coil is operating</span>
<a name="ln-4282"></a>    <span class="n">CapacitanceAir</span><span class="o">=</span><span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Win</span><span class="p">,</span><span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="n">TempAirIn</span><span class="o">+</span><span class="n">TempWaterIn</span><span class="p">))</span><span class="o">*</span><span class="n">AirMassFlow</span>
<a name="ln-4283"></a>    <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4284"></a>             <span class="n">TempWaterIn</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-4285"></a>             <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4286"></a>             <span class="s1">&#39;SizeWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-4287"></a>    <span class="n">CapacitanceWater</span><span class="o">=</span><span class="n">Cp</span><span class="o">*</span><span class="n">WaterMassFlowRate</span>
<a name="ln-4288"></a>    <span class="n">CapacitanceMin</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">CapacitanceAir</span><span class="p">,</span><span class="n">CapacitanceWater</span><span class="p">)</span>
<a name="ln-4289"></a>    <span class="n">CapacitanceMax</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">CapacitanceAir</span><span class="p">,</span><span class="n">CapacitanceWater</span><span class="p">)</span>
<a name="ln-4290"></a>  <span class="k">Else</span>
<a name="ln-4291"></a><span class="k">    </span><span class="n">CapacitanceAir</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4292"></a>    <span class="n">CapacitanceWater</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4293"></a>  <span class="k">End If</span>
<a name="ln-4294"></a>
<a name="ln-4295"></a>  <span class="c">! If the coil is operating there should be some heating capacitance</span>
<a name="ln-4296"></a>  <span class="c">!  across the coil, so do the simulation. If not set outlet to inlet and no load.</span>
<a name="ln-4297"></a>  <span class="c">!  Also the coil has to be scheduled to be available</span>
<a name="ln-4298"></a>  <span class="k">IF</span><span class="p">(((</span><span class="n">CapacitanceAir</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">CapacitanceWater</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>     <span class="p">&amp;</span>
<a name="ln-4299"></a>      <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4300"></a>       <span class="n">MyUAAndFlowCalcFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">CalcMode</span> <span class="o">==</span> <span class="n">DesignCalc</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-4301"></a>
<a name="ln-4302"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">UA</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4303"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UA is zero for COIL:Heating:Water &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4304"></a>      <span class="k">END IF</span>
<a name="ln-4305"></a><span class="k">      </span><span class="n">NTU</span><span class="o">=</span><span class="n">UA</span><span class="o">/</span><span class="n">CapacitanceMin</span>
<a name="ln-4306"></a>      <span class="n">ETA</span><span class="o">=</span><span class="n">NTU</span><span class="o">**</span><span class="mf">0.22d0</span>
<a name="ln-4307"></a>      <span class="n">CapRatio</span><span class="o">=</span><span class="n">CapacitanceMin</span><span class="o">/</span><span class="n">CapacitanceMax</span>
<a name="ln-4308"></a>      <span class="n">A</span><span class="o">=</span><span class="n">CapRatio</span><span class="o">*</span><span class="n">NTU</span><span class="o">/</span><span class="n">ETA</span>
<a name="ln-4309"></a>
<a name="ln-4310"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">A</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-4311"></a><span class="k">        </span><span class="n">A</span><span class="o">=</span><span class="n">ETA</span><span class="o">*</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">CapRatio</span>
<a name="ln-4312"></a>      <span class="k">Else</span>
<a name="ln-4313"></a><span class="k">        </span><span class="n">E1</span><span class="o">=</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">A</span><span class="p">)</span>
<a name="ln-4314"></a>        <span class="n">A</span><span class="o">=</span><span class="n">ETA</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">E1</span><span class="p">)</span><span class="o">/</span><span class="n">CapRatio</span>
<a name="ln-4315"></a>      <span class="k">End If</span>
<a name="ln-4316"></a>
<a name="ln-4317"></a><span class="k">      IF</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">2</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-4318"></a><span class="k">        </span><span class="n">Effec</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-4319"></a>      <span class="k">Else</span>
<a name="ln-4320"></a><span class="k">        </span><span class="n">E2</span><span class="o">=</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">A</span><span class="p">)</span>
<a name="ln-4321"></a>        <span class="n">Effec</span><span class="o">=</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">E2</span>
<a name="ln-4322"></a>      <span class="k">End IF</span>
<a name="ln-4323"></a>
<a name="ln-4324"></a><span class="k">      </span><span class="n">TempAirOut</span><span class="o">=</span><span class="n">TempAirIn</span><span class="o">+</span><span class="n">Effec</span><span class="o">*</span><span class="n">CapacitanceMin</span><span class="o">*</span><span class="p">(</span><span class="n">TempWaterIn</span><span class="o">-</span><span class="n">TempAirIn</span><span class="p">)</span><span class="o">/</span><span class="n">CapacitanceAir</span>
<a name="ln-4325"></a>      <span class="n">TempWaterOut</span><span class="o">=</span><span class="n">TempWaterIn</span><span class="o">-</span><span class="n">CapacitanceAir</span><span class="o">*</span><span class="p">(</span><span class="n">TempAirOut</span><span class="o">-</span><span class="n">TempAirIn</span><span class="p">)</span><span class="o">/</span><span class="n">CapacitanceWater</span>
<a name="ln-4326"></a>      <span class="n">HeatingCoilLoad</span><span class="o">=</span><span class="n">CapacitanceWater</span><span class="o">*</span><span class="p">(</span><span class="n">TempWaterIn</span><span class="o">-</span><span class="n">TempWaterOut</span><span class="p">)</span>
<a name="ln-4327"></a>     <span class="c">!The HeatingCoilLoad is the change in the enthalpy of the water</span>
<a name="ln-4328"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4329"></a>        <span class="n">HeatingCoilLoad</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-4330"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-4331"></a>
<a name="ln-4332"></a>  <span class="k">ELSE</span>    <span class="c">! If not running Conditions do not change across coil from inlet to outlet</span>
<a name="ln-4333"></a>
<a name="ln-4334"></a>      <span class="n">TempAirOut</span><span class="o">=</span><span class="n">TempAirIn</span>
<a name="ln-4335"></a>      <span class="n">TempWaterOut</span> <span class="o">=</span><span class="n">TempWaterIn</span>
<a name="ln-4336"></a>      <span class="n">HeatingCoilLoad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4337"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-4338"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4339"></a>  <span class="n">ENDIF</span>
<a name="ln-4340"></a>
<a name="ln-4341"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4342"></a><span class="k">     </span><span class="n">HeatingCoilLoad</span> <span class="o">=</span> <span class="n">HeatingCoilLoad</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-4343"></a>   <span class="k">END IF</span>
<a name="ln-4344"></a>
<a name="ln-4345"></a>  <span class="c">! Set the outlet conditions</span>
<a name="ln-4346"></a>   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span> <span class="o">=</span> <span class="n">HeatingCoilLoad</span>
<a name="ln-4347"></a>   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>   <span class="o">=</span> <span class="n">TempAirOut</span>
<a name="ln-4348"></a>   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">TempWaterOut</span>
<a name="ln-4349"></a>
<a name="ln-4350"></a>   <span class="c">! This WaterCoil does not change the moisture or Mass Flow across the component</span>
<a name="ln-4351"></a>   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-4352"></a>   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-4353"></a>   <span class="c">!Set the outlet enthalpys for air and water</span>
<a name="ln-4354"></a>   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4355"></a>                                             <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-4356"></a>
<a name="ln-4357"></a><span class="k">RETURN</span>
<a name="ln-4358"></a><span class="k">END Subroutine </span><span class="n">CalcSimpleHeatingCoil</span>
<a name="ln-4359"></a>
<a name="ln-4360"></a>
<a name="ln-4361"></a>
<a name="ln-4362"></a><span class="k">SUBROUTINE </span><span class="n">CalcDetailFlatFinCoolingCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">CalcMode</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-4363"></a>
<a name="ln-4364"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4365"></a>          <span class="c">!       AUTHOR(S)      Russell Taylor / Richard Liesen</span>
<a name="ln-4366"></a>          <span class="c">!       DATE WRITTEN   Mar 1997</span>
<a name="ln-4367"></a>          <span class="c">!       MODIFIED       Feb 2010, B. Nigusse, FSEC, corrected units inconsistency for tube and fins</span>
<a name="ln-4368"></a>          <span class="c">!                      materials thermal conductivties. Now input values in the idf are in {W/(m.K)}</span>
<a name="ln-4369"></a>          <span class="c">!       RE-ENGINEERED  Sept 1998</span>
<a name="ln-4370"></a>
<a name="ln-4371"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4372"></a>          <span class="c">! This subroutine simulates a chilled water cooling coil.  Provided with</span>
<a name="ln-4373"></a>          <span class="c">! the coil geometry and the flow (i.e. air and water) inlet conditions,</span>
<a name="ln-4374"></a>          <span class="c">! it will calculate the flow outlet conditions and the total and latent</span>
<a name="ln-4375"></a>          <span class="c">! heat extraction rates from the air.  The coil model has some limitations</span>
<a name="ln-4376"></a>          <span class="c">! as noted in the code.</span>
<a name="ln-4377"></a>
<a name="ln-4378"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4379"></a>          <span class="c">! successive substitution, solve coil as if all wet, then</span>
<a name="ln-4380"></a>          <span class="c">! again if partly or entirely dry</span>
<a name="ln-4381"></a>
<a name="ln-4382"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4383"></a>          <span class="c">! First found in Type 12 from MODSIM, but now</span>
<a name="ln-4384"></a>          <span class="c">! programmed directly from Elmahdy, A.H. and Mitalas, G.P.  &quot;A</span>
<a name="ln-4385"></a>          <span class="c">! Simple Model for Cooling and Dehumidifying Coils for Use in</span>
<a name="ln-4386"></a>          <span class="c">! Calculating Energy Requirements for Buildings&quot;  _ASHRAE</span>
<a name="ln-4387"></a>          <span class="c">! Transactions_ Vol. 83, Part 2, pp. 103-117 (1977).</span>
<a name="ln-4388"></a>
<a name="ln-4389"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-4390"></a>          <span class="c">! Routine was originally adapted for use in IBLAST by R.D. Taylor in l993.</span>
<a name="ln-4391"></a>          <span class="c">! Subsequently rewritten and improved by J.C. Vanderzee in 1994</span>
<a name="ln-4392"></a>          <span class="c">! Revised and further enanced by R.D. Taylor in Jan 1996</span>
<a name="ln-4393"></a>          <span class="c">! Re-engineered for EnergyPlus by Richard Liesen PhD in 1998</span>
<a name="ln-4394"></a>
<a name="ln-4395"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4396"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-4397"></a>
<a name="ln-4398"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4399"></a>
<a name="ln-4400"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4401"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-4402"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CalcMode</span>
<a name="ln-4403"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>      <span class="c">! fan operating mode</span>
<a name="ln-4404"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>  <span class="c">! part-load ratio of heating coil</span>
<a name="ln-4405"></a>
<a name="ln-4406"></a>
<a name="ln-4407"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4408"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxCoolCoilErrs</span> <span class="o">=</span> <span class="mi">5</span>
<a name="ln-4409"></a>
<a name="ln-4410"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AirViscosity</span> <span class="o">=</span> <span class="mf">1.846d-5</span>      <span class="c">! Dynamic Viscosity of Air in kg/(m.s)</span>
<a name="ln-4411"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ConvK</span> <span class="o">=</span> <span class="mf">1.0d-3</span>               <span class="c">! Unit conversion factor</span>
<a name="ln-4412"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">unity</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4413"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">zero</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4414"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TubeFoulFactor</span> <span class="o">=</span> <span class="mf">5.0d-2</span>      <span class="c">! Inside tube fouling factor for water, in m2K/kW</span>
<a name="ln-4415"></a>                                                         <span class="c">! Changed from m2K/W to m2K/kW for consistency with the</span>
<a name="ln-4416"></a>                                                         <span class="c">! other parameters in &quot;TubeFoulThermResis&quot; calculation</span>
<a name="ln-4417"></a>
<a name="ln-4418"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4419"></a>          <span class="c">! na</span>
<a name="ln-4420"></a>
<a name="ln-4421"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4422"></a>          <span class="c">! na</span>
<a name="ln-4423"></a>
<a name="ln-4424"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4425"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoefPointer</span>
<a name="ln-4426"></a><span class="c">!    INTEGER :: CoolCoilErrs = 0</span>
<a name="ln-4427"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PartWetIterations</span>
<a name="ln-4428"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterTempConvgLoop</span>
<a name="ln-4429"></a>
<a name="ln-4430"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">CoilPartWetConvg</span>
<a name="ln-4431"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">WaterTempConvg</span>
<a name="ln-4432"></a>
<a name="ln-4433"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirEnthAtRsdInletWaterTemp</span>
<a name="ln-4434"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirExitEnthlAtCoilSurfTemp</span>
<a name="ln-4435"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirExitCoilSurfTemp</span>
<a name="ln-4436"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirReynoldsNo</span>
<a name="ln-4437"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirEnthAtWetDryIntrfcSurfTemp</span>
<a name="ln-4438"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirSideDrySurfFilmCoef</span>
<a name="ln-4439"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirSideWetSurfFilmCoef</span>
<a name="ln-4440"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirWetDryInterfcTemp</span>
<a name="ln-4441"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilToAirThermResistDrySurf</span>
<a name="ln-4442"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilToAirThermResistWetSurf</span>
<a name="ln-4443"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryAirSpecHeat</span>
<a name="ln-4444"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilCoeff1</span>
<a name="ln-4445"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilCoeff</span>
<a name="ln-4446"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilEfficiency</span>
<a name="ln-4447"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryFinEfficncy</span>
<a name="ln-4448"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilInThermResist</span>
<a name="ln-4449"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DrySideEffectiveWaterTemp</span>
<a name="ln-4450"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnterAirDewPoint</span>
<a name="ln-4451"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnterAirHumRatDiff</span>
<a name="ln-4452"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetDryInterSurfTempErrorLast</span>
<a name="ln-4453"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetDryInterSurfTempError</span>
<a name="ln-4454"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">expon</span>
<a name="ln-4455"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FilmCoefEqnFactor</span>
<a name="ln-4456"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FilmCoefReynldsCorrelatnFact</span>
<a name="ln-4457"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FinToTotSurfAreaRatio</span>
<a name="ln-4458"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InCoilSurfTemp</span>
<a name="ln-4459"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InsdToOutsdThermResistRatio</span>
<a name="ln-4460"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InSurfTempSatAirEnthl</span>
<a name="ln-4461"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">K1</span>
<a name="ln-4462"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MeanWaterTemp</span>
<a name="ln-4463"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MoistAirSpecificHeat</span>
<a name="ln-4464"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutCoilSurfTemp</span>
<a name="ln-4465"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutSurfTempSatAirEnthl</span>
<a name="ln-4466"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RaisedInletWaterTemp</span>
<a name="ln-4467"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RsdInletWaterTempSatAirHumRat</span>
<a name="ln-4468"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ScaledAirMassFlowRate</span>
<a name="ln-4469"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ScaledCoilAirThermResistWetSurf</span>
<a name="ln-4470"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ScaledWaterSpecHeat</span>
<a name="ln-4471"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ScaledWaterToTubeThermResist</span>
<a name="ln-4472"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SensToTotEnthDiffRatio</span>
<a name="ln-4473"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAreaWet</span>
<a name="ln-4474"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TubeFoulThermResist</span>
<a name="ln-4475"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TubeWaterVel</span>
<a name="ln-4476"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UACoilAllWet</span>
<a name="ln-4477"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UACoilPartWet</span>
<a name="ln-4478"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UADryCoil</span>
<a name="ln-4479"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterToTubeThermResist</span>
<a name="ln-4480"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetAreaChange</span>
<a name="ln-4481"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetAreaLast</span>
<a name="ln-4482"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetCoilCoeff</span>
<a name="ln-4483"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetCoilFinEfficncy</span>
<a name="ln-4484"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetDryInterfcAirEnthl</span>
<a name="ln-4485"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetDryInterfcSurfTemp</span>
<a name="ln-4486"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetDryInterfcWaterTemp</span>
<a name="ln-4487"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetFinEfficncy</span>
<a name="ln-4488"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WetSideEffctvWaterTemp</span>
<a name="ln-4489"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">y</span>
<a name="ln-4490"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempAirIn</span>
<a name="ln-4491"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempAirOut</span>
<a name="ln-4492"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirHumRat</span>
<a name="ln-4493"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>
<a name="ln-4494"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletAirEnthalpy</span>
<a name="ln-4495"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirEnthalpy</span>
<a name="ln-4496"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRate</span>
<a name="ln-4497"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>
<a name="ln-4498"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempWaterIn</span>
<a name="ln-4499"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TempWaterOut</span>
<a name="ln-4500"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotWaterCoilLoad</span>
<a name="ln-4501"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SenWaterCoilLoad</span>
<a name="ln-4502"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirDensity</span>
<a name="ln-4503"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirVelocity</span>
<a name="ln-4504"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">denom</span>
<a name="ln-4505"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-4506"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-4507"></a>
<a name="ln-4508"></a>   <span class="c">! Set derived type variables to shorter local variables</span>
<a name="ln-4509"></a>    <span class="n">TempAirIn</span>    <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-4510"></a>    <span class="n">InletAirHumRat</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-4511"></a>    <span class="n">TempWaterIn</span>  <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-4512"></a>
<a name="ln-4513"></a>    <span class="c">!  adjust mass flow rates for cycling fan cycling coil operation</span>
<a name="ln-4514"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4515"></a><span class="k">      IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4516"></a><span class="k">        </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span>
<a name="ln-4517"></a>        <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4518"></a>                                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span><span class="p">)</span>
<a name="ln-4519"></a>      <span class="k">ELSE</span>
<a name="ln-4520"></a><span class="k">        </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4521"></a>        <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4522"></a>      <span class="k">END IF</span>
<a name="ln-4523"></a><span class="k">    ELSE</span>
<a name="ln-4524"></a><span class="k">      </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-4525"></a>      <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-4526"></a>    <span class="k">END IF</span>
<a name="ln-4527"></a>
<a name="ln-4528"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WaterMassFlowRate</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="o">*</span> <span class="n">MinWaterMassFlowFrac</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4529"></a><span class="k">        </span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4530"></a>    <span class="k">END IF</span>
<a name="ln-4531"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TempAirIn</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="n">TempWaterIn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4532"></a><span class="k">        </span><span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4533"></a>    <span class="k">END IF</span>
<a name="ln-4534"></a><span class="k">    </span><span class="n">WetDryInterfcAirEnthl</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4535"></a>    <span class="n">OutletAirEnthalpy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4536"></a>    <span class="n">InletAirEnthalpy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4537"></a>
<a name="ln-4538"></a>    <span class="c">!Warning and error messages for large flow rates for the given user input geometry</span>
<a name="ln-4539"></a>    <span class="n">AirDensity</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">OutBaroPress</span><span class="p">,</span><span class="n">TempAirIn</span><span class="p">,</span><span class="n">InletAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span>
<a name="ln-4540"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">AirMassFlow</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">5.0</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span><span class="o">/</span><span class="n">AirDensity</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoilWarningOnceFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4541"></a><span class="k">       CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry in Coil =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">coilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4542"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Air Flow Rate Velocity has greatly exceeded upper design guidelines of ~2.5 m/s&#39;</span><span class="p">)</span>
<a name="ln-4543"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Air MassFlowRate[kg/s]=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AirMassFlow</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-4544"></a>       <span class="n">AirVelocity</span><span class="o">=</span><span class="n">AirMassFlow</span><span class="o">*</span><span class="n">AirDensity</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span>
<a name="ln-4545"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Air Face Velocity[m/s]=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AirVelocity</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-4546"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Approximate MassFlowRate limit for Face Area[kg/s]=&#39;</span>  <span class="p">&amp;</span>
<a name="ln-4547"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="mf">2.5d0</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span><span class="o">/</span><span class="n">AirDensity</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-4548"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry could be resized/autosized to handle capacity&#39;</span><span class="p">)</span>
<a name="ln-4549"></a>       <span class="n">CoilWarningOnceFlag</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">False</span><span class="p">.</span>
<a name="ln-4550"></a>    <span class="k">Else IF</span><span class="p">(</span><span class="n">AirMassFlow</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">4</span><span class="mf">4.7d0</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span><span class="o">/</span><span class="n">AirDensity</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4551"></a><span class="k">       CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry in Coil =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">coilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4552"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Air Flow Rate Velocity is &gt; 100MPH (44.7m/s) and simulation cannot continue&#39;</span><span class="p">)</span>
<a name="ln-4553"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Air Mass Flow Rate[kg/s]=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AirMassFlow</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-4554"></a>       <span class="n">AirVelocity</span><span class="o">=</span><span class="n">AirMassFlow</span><span class="o">*</span><span class="n">AirDensity</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span>
<a name="ln-4555"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Air Face Velocity[m/s]=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">AirVelocity</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-4556"></a>       <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Approximate MassFlowRate limit for Face Area[kg/s]=&#39;</span>  <span class="p">&amp;</span>
<a name="ln-4557"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="mf">2.5d0</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span><span class="o">/</span><span class="n">AirDensity</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-4558"></a>       <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry needs to be resized/autosized to handle capacity&#39;</span><span class="p">)</span>
<a name="ln-4559"></a>    <span class="k">END IF</span>
<a name="ln-4560"></a>
<a name="ln-4561"></a><span class="c">! If Coil is Scheduled ON then do the simulation</span>
<a name="ln-4562"></a><span class="k">IF</span><span class="p">(((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterMassFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4563"></a>    <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">AirMassFlow</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">MinAirMassFlow</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">CalcMode</span> <span class="o">==</span> <span class="n">DesignCalc</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-4564"></a>    <span class="c">!        transfer inputs to simulation variables and calculate</span>
<a name="ln-4565"></a>    <span class="c">!        known thermodynamic functions</span>
<a name="ln-4566"></a>    <span class="c">! All coil calcs are done in KJoules.  Convert to KJ here and then convert</span>
<a name="ln-4567"></a>    <span class="c">!  back to Joules at the end of the Subroutine.</span>
<a name="ln-4568"></a>    <span class="n">DryAirSpecHeat</span>       <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">zero</span><span class="p">,</span><span class="n">TempAirIn</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">ConvK</span>
<a name="ln-4569"></a>    <span class="n">MoistAirSpecificHeat</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span> <span class="n">TempAirIn</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">ConvK</span>
<a name="ln-4570"></a>    <span class="n">InletAirEnthalpy</span>     <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span> <span class="o">*</span> <span class="n">ConvK</span>
<a name="ln-4571"></a>    <span class="n">EnterAirDewPoint</span>     <span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span>
<a name="ln-4572"></a>    <span class="c">!</span>
<a name="ln-4573"></a>    <span class="c">!       Ratio of secondary (fin) to total (secondary plus primary) surface areas</span>
<a name="ln-4574"></a>    <span class="n">FinToTotSurfAreaRatio</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinSurfArea</span> <span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-4575"></a>                            <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-4576"></a>    <span class="c">!</span>
<a name="ln-4577"></a>    <span class="c">!      known water and air flow parameters:</span>
<a name="ln-4578"></a>    <span class="c">!</span>
<a name="ln-4579"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4580"></a>                           <span class="n">TempWaterIn</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-4581"></a>                           <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4582"></a>                          <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span>
<a name="ln-4583"></a>    <span class="c">!      water flow velocity - assuming number of water circuits = NumOfTubesPerRow</span>
<a name="ln-4584"></a>    <span class="n">TubeWaterVel</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="mf">4.d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">NumOfTubesPerRow</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4585"></a>                   <span class="n">rho</span> <span class="o">*</span> <span class="n">Pi</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeInsideDiam</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4586"></a>                   <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeInsideDiam</span><span class="p">)</span>
<a name="ln-4587"></a>    <span class="c">!      air mass flow rate per unit area</span>
<a name="ln-4588"></a>    <span class="n">ScaledAirMassFlowRate</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="n">InletAirHumRat</span><span class="p">)</span> <span class="o">*</span> <span class="n">AirMassFlow</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MinAirFlowArea</span>
<a name="ln-4589"></a>    <span class="c">!      air flow Reynold&#39;s Number</span>
<a name="ln-4590"></a>    <span class="n">AirReynoldsNo</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoilEffectiveInsideDiam</span> <span class="o">*</span> <span class="n">ScaledAirMassFlowRate</span> <span class="o">/</span> <span class="n">AirViscosity</span>
<a name="ln-4591"></a>    <span class="c">!</span>
<a name="ln-4592"></a>    <span class="c">!       heat transfer coefficients and resistance components:</span>
<a name="ln-4593"></a>    <span class="c">!              inside (water)</span>
<a name="ln-4594"></a>    <span class="n">WaterToTubeThermResist</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeInsideDiam</span><span class="o">**</span><span class="mf">0.2d0</span><span class="o">/</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span> <span class="p">&amp;</span>
<a name="ln-4595"></a>                             <span class="o">*</span> <span class="mf">1.429d0</span> <span class="o">*</span> <span class="n">TubeWaterVel</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span>
<a name="ln-4596"></a>    <span class="c">!              metal and fouling</span>
<a name="ln-4597"></a>    <span class="n">TubeFoulThermResist</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideDiam</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeInsideDiam</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4598"></a>                             <span class="o">/</span> <span class="p">(</span><span class="n">ConvK</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeThermConductivity</span><span class="p">)</span> <span class="o">+</span> <span class="n">TubeFoulFactor</span><span class="p">)</span> <span class="o">/</span>       <span class="p">&amp;</span>
<a name="ln-4599"></a>                             <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotTubeInsideArea</span>
<a name="ln-4600"></a>    <span class="c">!</span>
<a name="ln-4601"></a>    <span class="c">!              outside (wet and dry coil)</span>
<a name="ln-4602"></a>    <span class="c">!</span>
<a name="ln-4603"></a>    <span class="n">FilmCoefEqnFactor</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">GeometryCoef1</span> <span class="o">*</span> <span class="n">AirReynoldsNo</span><span class="o">**</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">GeometryCoef2</span>
<a name="ln-4604"></a>    <span class="c">!       (1.23 is 1/Prandt(air)**(2/3))</span>
<a name="ln-4605"></a>    <span class="n">AirSideDrySurfFilmCoef</span> <span class="o">=</span> <span class="mf">1.23d0</span> <span class="o">*</span> <span class="n">FilmCoefEqnFactor</span> <span class="o">*</span> <span class="n">MoistAirSpecificHeat</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4606"></a>                                     <span class="n">ScaledAirMassFlowRate</span>
<a name="ln-4607"></a>    <span class="n">FilmCoefReynldsCorrelatnFact</span> <span class="o">=</span> <span class="mf">1.425d0</span> <span class="o">+</span> <span class="n">AirReynoldsNo</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.51d-3</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-4608"></a>                                     <span class="n">AirReynoldsNo</span> <span class="o">*</span> <span class="mf">0.263d-6</span><span class="p">)</span>
<a name="ln-4609"></a>    <span class="c">!</span>
<a name="ln-4610"></a>    <span class="c">!       NOTE: the equation for FilmCoefReynldsCorrelatnFact generates valid results over</span>
<a name="ln-4611"></a>    <span class="c">!             a limited range of Air Reynolds Numbers as indicated by</span>
<a name="ln-4612"></a>    <span class="c">!             deleted code below.  Reynolds Numbers outside this range</span>
<a name="ln-4613"></a>    <span class="c">!             may result in inaccurate results or failure of the coil</span>
<a name="ln-4614"></a>    <span class="c">!             simulation to obtain a solution</span>
<a name="ln-4615"></a>    <span class="c">!</span>
<a name="ln-4616"></a>    <span class="c">!             Deleted code by J.C. Vanderzee</span>
<a name="ln-4617"></a>    <span class="c">!</span>
<a name="ln-4618"></a>
<a name="ln-4619"></a>    <span class="n">AirSideWetSurfFilmCoef</span> <span class="o">=</span> <span class="n">FilmCoefReynldsCorrelatnFact</span> <span class="o">*</span> <span class="n">AirSideDrySurfFilmCoef</span>
<a name="ln-4620"></a>    <span class="c">!--                     need wet fin efficiency for outside</span>
<a name="ln-4621"></a>    <span class="n">RaisedInletWaterTemp</span> <span class="o">=</span> <span class="n">TempWaterIn</span> <span class="o">+</span> <span class="mf">0.5d0</span>
<a name="ln-4622"></a>
<a name="ln-4623"></a>    <span class="c">! By this statement the Inlet Air enthalpy will never be equal to AirEnthAtRsdInletWaterTemp</span>
<a name="ln-4624"></a>    <span class="k">If</span><span class="p">((</span><span class="n">RaisedInletWaterTemp</span><span class="o">-</span><span class="n">TempAirIn</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.000001d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-4625"></a><span class="k">      </span><span class="n">RaisedInletWaterTemp</span><span class="o">=</span><span class="n">TempWaterIn</span><span class="o">+</span><span class="mf">0.3d0</span>
<a name="ln-4626"></a>    <span class="k">End If</span>
<a name="ln-4627"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TempAirIn</span> <span class="o">&lt;</span> <span class="n">RaisedInletWaterTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4628"></a><span class="k">      </span><span class="n">RaisedInletWaterTemp</span><span class="o">=</span><span class="n">TempAirIn</span> <span class="o">-</span> <span class="p">.</span><span class="mi">3</span><span class="n">d0</span>
<a name="ln-4629"></a>    <span class="n">ENDIF</span>
<a name="ln-4630"></a>
<a name="ln-4631"></a>    <span class="n">RsdInletWaterTempSatAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbRhPb</span><span class="p">(</span><span class="n">RaisedInletWaterTemp</span><span class="p">,</span> <span class="n">unity</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span>
<a name="ln-4632"></a>    <span class="n">AirEnthAtRsdInletWaterTemp</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">RaisedInletWaterTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4633"></a>                                    <span class="n">RsdInletWaterTempSatAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">ConvK</span>
<a name="ln-4634"></a>
<a name="ln-4635"></a>    <span class="n">SensToTotEnthDiffRatio</span> <span class="o">=</span> <span class="n">DryAirSpecHeat</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempAirIn</span> <span class="o">-</span> <span class="n">RaisedInletWaterTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4636"></a>                                  <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">AirEnthAtRsdInletWaterTemp</span><span class="p">)</span>
<a name="ln-4637"></a>
<a name="ln-4638"></a>    <span class="n">EnterAirHumRatDiff</span> <span class="o">=</span> <span class="n">InletAirHumRat</span> <span class="o">-</span> <span class="n">RsdInletWaterTempSatAirHumRat</span>
<a name="ln-4639"></a>    <span class="n">DryFinEfficncy</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EffectiveFinDiam</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideDiam</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4640"></a>                       <span class="nb">SQRT</span><span class="p">(</span><span class="mf">2.d0</span> <span class="o">*</span> <span class="n">AirSideWetSurfFilmCoef</span> <span class="o">/</span> <span class="p">(</span><span class="n">ConvK</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThermConductivity</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4641"></a>                       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThickness</span><span class="p">))</span>
<a name="ln-4642"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">EnterAirHumRatDiff</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4643"></a>    <span class="c">!       note that this condition indicates dry coil</span>
<a name="ln-4644"></a>       <span class="n">EnterAirHumRatDiff</span> <span class="o">=</span> <span class="o">-</span><span class="n">EnterAirHumRatDiff</span>
<a name="ln-4645"></a>       <span class="n">SensToTotEnthDiffRatio</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">SensToTotEnthDiffRatio</span><span class="p">)</span>
<a name="ln-4646"></a>    <span class="k">END IF</span>
<a name="ln-4647"></a>
<a name="ln-4648"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">EnterAirHumRatDiff</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">EnterAirHumRatDiff</span> <span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-4649"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">EnterAirHumRatDiff</span> <span class="o">&lt;</span> <span class="mf">0.00001d0</span><span class="p">)</span> <span class="n">EnterAirHumRatDiff</span> <span class="o">=</span><span class="mf">0.00001d0</span>
<a name="ln-4650"></a>
<a name="ln-4651"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DryFinEfficncy</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">DryFinEfficncy</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-4652"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DryFinEfficncy</span> <span class="o">&lt;</span> <span class="mf">0.00001d0</span><span class="p">)</span> <span class="n">DryFinEfficncy</span><span class="o">=</span><span class="mf">0.00001d0</span>
<a name="ln-4653"></a>
<a name="ln-4654"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TempAirIn</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">4</span><span class="mf">8.d0</span><span class="o">/</span><span class="mf">1.8d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4655"></a><span class="k">       </span><span class="n">WetFinEfficncy</span><span class="o">=</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">0.41718d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">SensToTotEnthDiffRatio</span><span class="o">**</span><span class="p">(</span><span class="mf">0.09471d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4656"></a>                      <span class="n">EnterAirHumRatDiff</span><span class="o">**</span><span class="p">(</span><span class="mf">0.0108d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DryFinEfficncy</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.50303d0</span><span class="p">)</span>
<a name="ln-4657"></a>    <span class="k">ELSE</span>
<a name="ln-4658"></a><span class="k">       </span><span class="n">WetFinEfficncy</span><span class="o">=</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3574d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">SensToTotEnthDiffRatio</span><span class="o">**</span><span class="p">(</span><span class="mf">0.16081d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4659"></a>                      <span class="n">EnterAirHumRatDiff</span><span class="o">**</span><span class="p">(</span><span class="mf">0.01995d0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DryFinEfficncy</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.52951d0</span><span class="p">)</span>
<a name="ln-4660"></a>    <span class="k">END IF</span>
<a name="ln-4661"></a>
<a name="ln-4662"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WetFinEfficncy</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">WetFinEfficncy</span><span class="o">=</span><span class="mf">0.99d0</span>
<a name="ln-4663"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">WetFinEfficncy</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">WetFinEfficncy</span><span class="o">=</span><span class="mf">0.001d0</span>
<a name="ln-4664"></a>    <span class="c">!</span>
<a name="ln-4665"></a>    <span class="c">!       wet coil fin efficiency</span>
<a name="ln-4666"></a>    <span class="c">!</span>
<a name="ln-4667"></a>
<a name="ln-4668"></a>    <span class="n">WetCoilFinEfficncy</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">+</span> <span class="n">FinToTotSurfAreaRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">WetFinEfficncy</span> <span class="o">-</span> <span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-4669"></a>    <span class="c">!</span>
<a name="ln-4670"></a>    <span class="c">!       wet coil outside thermal resistance = [1/UA] (wet coil)</span>
<a name="ln-4671"></a>    <span class="c">!</span>
<a name="ln-4672"></a>    <span class="n">CoilToAirThermResistWetSurf</span> <span class="o">=</span> <span class="n">MoistAirSpecificHeat</span> <span class="o">/</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4673"></a>                                        <span class="n">AirSideWetSurfFilmCoef</span> <span class="o">*</span> <span class="n">WetCoilFinEfficncy</span><span class="p">)</span>
<a name="ln-4674"></a>    <span class="c">!--                     and dry fin efficiency</span>
<a name="ln-4675"></a>    <span class="n">DryFinEfficncy</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EffectiveFinDiam</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TubeOutsideDiam</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4676"></a>                       <span class="nb">SQRT</span><span class="p">(</span><span class="mf">2.d0</span> <span class="o">*</span> <span class="n">AirSideDrySurfFilmCoef</span> <span class="o">/</span> <span class="p">(</span><span class="n">ConvK</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThermConductivity</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4677"></a>                       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">FinThickness</span><span class="p">))</span>
<a name="ln-4678"></a>    <span class="c">!</span>
<a name="ln-4679"></a>    <span class="c">!      NOTE: The same caveats on the validity of the FilmCoefReynldsCorrelatnFact equation</span>
<a name="ln-4680"></a>    <span class="c">!            hold for the DryFinEfficncy equation.  Values of DryFinEfficncy outside the</span>
<a name="ln-4681"></a>    <span class="c">!            specified range of validity are not guaranteed to</span>
<a name="ln-4682"></a>    <span class="c">!            produce results</span>
<a name="ln-4683"></a>    <span class="c">!</span>
<a name="ln-4684"></a>    <span class="c">!             Deleted code by J.C. Vanderzee</span>
<a name="ln-4685"></a>    <span class="c">!</span>
<a name="ln-4686"></a>    <span class="c">!</span>
<a name="ln-4687"></a>    <span class="c">!       dry coil fin efficiency</span>
<a name="ln-4688"></a>    <span class="c">!</span>
<a name="ln-4689"></a>    <span class="n">DryCoilEfficiency</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4690"></a>    <span class="k">DO </span><span class="n">CoefPointer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
<a name="ln-4691"></a>      <span class="n">DryCoilEfficiency</span> <span class="o">=</span> <span class="n">DryCoilEfficiency</span> <span class="o">+</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DryFinEfficncyCoef</span><span class="p">(</span><span class="n">CoefPointer</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4692"></a>                             <span class="n">DryFinEfficncy</span><span class="o">**</span><span class="p">(</span><span class="n">CoefPointer</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4693"></a>    <span class="k">END DO</span> <span class="c">! CoefPointer</span>
<a name="ln-4694"></a>    <span class="n">DryCoilEfficiency</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">+</span> <span class="n">FinToTotSurfAreaRatio</span> <span class="o">*</span> <span class="p">(</span><span class="n">DryCoilEfficiency</span> <span class="o">-</span> <span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-4695"></a>    <span class="c">!</span>
<a name="ln-4696"></a>    <span class="c">!       dry coil outside thermal resistance = [1/UA] (dry coil)</span>
<a name="ln-4697"></a>    <span class="c">!</span>
<a name="ln-4698"></a>    <span class="n">CoilToAirThermResistDrySurf</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span> <span class="o">*</span> <span class="n">AirSideDrySurfFilmCoef</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4699"></a>                                  <span class="n">DryCoilEfficiency</span><span class="p">)</span>
<a name="ln-4700"></a>    <span class="c">!</span>
<a name="ln-4701"></a>    <span class="c">!       definitions made to simplify some of the expressions used below</span>
<a name="ln-4702"></a>    <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4703"></a>                       <span class="n">TempWaterIn</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-4704"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4705"></a>                       <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span>
<a name="ln-4706"></a>    <span class="n">ScaledWaterSpecHeat</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">ConvK</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-4707"></a>                          <span class="n">AirMassFlow</span>
<a name="ln-4708"></a>    <span class="n">DryCoilCoeff1</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">AirMassFlow</span> <span class="o">*</span> <span class="n">MoistAirSpecificHeat</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-4709"></a>                    <span class="p">(</span><span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">ConvK</span><span class="p">)</span>
<a name="ln-4710"></a>    <span class="c">!</span>
<a name="ln-4711"></a>    <span class="c">!       perform initialisations for all wet solution</span>
<a name="ln-4712"></a>    <span class="c">!</span>
<a name="ln-4713"></a>    <span class="n">WetSideEffctvWaterTemp</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MeanWaterTempSaved</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-4714"></a>                             <span class="p">(</span><span class="n">TempWaterIn</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InWaterTempSaved</span><span class="p">)</span>
<a name="ln-4715"></a>    <span class="n">WaterTempConvgLoop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4716"></a>    <span class="n">WaterTempConvg</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4717"></a>    <span class="c">!</span>
<a name="ln-4718"></a>    <span class="c">!       Loop to solve coil as if all wet, converges on MeanWaterTemp eq WetSideEffctvWaterTemp</span>
<a name="ln-4719"></a>    <span class="c">!       if conv=.TRUE. at any time program exits loop and proceeds</span>
<a name="ln-4720"></a>    <span class="c">!       to part wet / part dry solution</span>
<a name="ln-4721"></a>    <span class="c">!</span>
<a name="ln-4722"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">WaterTempConvgLoop</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">8</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WaterTempConvg</span><span class="p">)</span>
<a name="ln-4723"></a>      <span class="n">WaterTempConvgLoop</span> <span class="o">=</span> <span class="n">WaterTempConvgLoop</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4724"></a>      <span class="n">ScaledWaterToTubeThermResist</span> <span class="o">=</span> <span class="n">WaterToTubeThermResist</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span> <span class="o">+</span> <span class="mf">0.0146d0</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4725"></a>                                     <span class="n">WetSideEffctvWaterTemp</span><span class="p">)</span>
<a name="ln-4726"></a>      <span class="n">ScaledCoilAirThermResistWetSurf</span> <span class="o">=</span> <span class="n">CoilToAirThermResistWetSurf</span> <span class="o">/</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span>
<a name="ln-4727"></a>      <span class="n">UACoilAllWet</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span> <span class="o">*</span> <span class="p">(</span><span class="n">TubeFoulThermResist</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-4728"></a>                     <span class="n">ScaledWaterToTubeThermResist</span> <span class="o">+</span> <span class="n">ScaledCoilAirThermResistWetSurf</span><span class="p">))</span>
<a name="ln-4729"></a>    <span class="c">!</span>
<a name="ln-4730"></a>    <span class="c">!       prevents floating point error when taking exponential</span>
<a name="ln-4731"></a>    <span class="c">!       of a very large number</span>
<a name="ln-4732"></a>    <span class="c">!</span>
<a name="ln-4733"></a>      <span class="n">expon</span> <span class="o">=</span> <span class="n">UACoilAllWet</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">/</span> <span class="n">AirMassFlow</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4734"></a>              <span class="p">(</span><span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">ConvK</span><span class="p">))</span>
<a name="ln-4735"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">expon</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!CR7189 changed from ABS(expon) &lt; 20</span>
<a name="ln-4736"></a>        <span class="c">!       negative expon can happen, but lead to tiny WetCoilCoef that aren&#39;t a problem</span>
<a name="ln-4737"></a>        <span class="n">WetCoilCoeff</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">expon</span><span class="p">)</span>
<a name="ln-4738"></a>        <span class="c">! following appears similar to eq. 320 in Eng Ref but neglects K1 term</span>
<a name="ln-4739"></a>        <span class="n">TempWaterOut</span> <span class="o">=</span><span class="p">((</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">WetCoilCoeff</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveConstCoef</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4740"></a>                         <span class="n">WetCoilCoeff</span> <span class="o">*</span> <span class="n">TempWaterIn</span> <span class="o">*</span>   <span class="p">&amp;</span>
<a name="ln-4741"></a>                        <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span> <span class="o">-</span> <span class="n">ScaledWaterSpecHeat</span><span class="p">))</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4742"></a>                        <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span> <span class="o">-</span> <span class="n">WetCoilCoeff</span> <span class="o">*</span> <span class="n">ScaledWaterSpecHeat</span><span class="p">)</span>
<a name="ln-4743"></a>      <span class="k">ELSE</span>
<a name="ln-4744"></a>        <span class="c">! following appears to be same as above with equation simplified to use only significant terms when WetCoilCoeff very large</span>
<a name="ln-4745"></a>        <span class="n">TempWaterOut</span> <span class="o">=</span> <span class="p">((</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveConstCoef</span><span class="p">)</span> <span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-4746"></a>                         <span class="n">TempWaterIn</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4747"></a>                         <span class="n">ScaledWaterSpecHeat</span><span class="p">))</span> <span class="o">/</span> <span class="n">ScaledWaterSpecHeat</span>
<a name="ln-4748"></a>
<a name="ln-4749"></a>      <span class="k">END IF</span>
<a name="ln-4750"></a>    <span class="c">!      above is inverted form of WaterMassFlowRate*cpw*(TempWaterOut-TempWaterIn) = UA(LMHD)</span>
<a name="ln-4751"></a>    <span class="c">!      note simplification that hsat = WaterCoil(CoilNum)%SatEnthlCurveConstCoef +  &amp;</span>
<a name="ln-4752"></a>    <span class="c">!                                      WaterCoil(CoilNum)%SatEnthlCurveSlope*WetSideEffctvWaterTemp</span>
<a name="ln-4753"></a>      <span class="n">MeanWaterTemp</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempWaterIn</span> <span class="o">+</span> <span class="n">TempWaterOut</span><span class="p">)</span>
<a name="ln-4754"></a>      <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="n">TempWaterOut</span> <span class="o">-</span> <span class="n">TempWaterIn</span><span class="p">)</span> <span class="o">*</span> <span class="n">ScaledWaterSpecHeat</span>
<a name="ln-4755"></a>
<a name="ln-4756"></a>      <span class="n">InsdToOutsdThermResistRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">TubeFoulThermResist</span> <span class="o">+</span> <span class="n">ScaledWaterToTubeThermResist</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4757"></a>                                        <span class="n">ScaledCoilAirThermResistWetSurf</span>
<a name="ln-4758"></a>      <span class="n">InCoilSurfTemp</span> <span class="o">=</span> <span class="n">UACoilAllWet</span> <span class="o">*</span> <span class="n">ScaledCoilAirThermResistWetSurf</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4759"></a>                           <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span> <span class="o">*</span> <span class="n">TempWaterIn</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4760"></a>                           <span class="p">(</span><span class="n">OutletAirEnthalpy</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveConstCoef</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4761"></a>                           <span class="n">InsdToOutsdThermResistRatio</span><span class="p">)</span>
<a name="ln-4762"></a>      <span class="n">OutCoilSurfTemp</span> <span class="o">=</span> <span class="n">UACoilAllWet</span> <span class="o">*</span> <span class="n">ScaledCoilAirThermResistWetSurf</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4763"></a>                            <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span> <span class="o">*</span> <span class="n">TempWaterOut</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4764"></a>                            <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveConstCoef</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4765"></a>                            <span class="n">InsdToOutsdThermResistRatio</span><span class="p">)</span>
<a name="ln-4766"></a>
<a name="ln-4767"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">MeanWaterTemp</span> <span class="o">-</span> <span class="n">WetSideEffctvWaterTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.01d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4768"></a><span class="k">         </span><span class="n">WetSideEffctvWaterTemp</span> <span class="o">=</span> <span class="n">MeanWaterTemp</span>
<a name="ln-4769"></a>         <span class="n">InSurfTempSatAirEnthl</span> <span class="o">=</span> <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">InCoilSurfTemp</span><span class="p">,</span> <span class="n">unity</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">ConvK</span>
<a name="ln-4770"></a>         <span class="n">OutSurfTempSatAirEnthl</span> <span class="o">=</span> <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">OutCoilSurfTemp</span><span class="p">,</span> <span class="n">unity</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span> <span class="o">*</span><span class="n">ConvK</span>
<a name="ln-4771"></a>
<a name="ln-4772"></a>         <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span> <span class="o">=</span> <span class="p">(</span><span class="n">OutSurfTempSatAirEnthl</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4773"></a>                            <span class="n">InSurfTempSatAirEnthl</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">OutCoilSurfTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4774"></a>                            <span class="n">InCoilSurfTemp</span><span class="p">)</span>
<a name="ln-4775"></a>         <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveConstCoef</span> <span class="o">=</span> <span class="n">InSurfTempSatAirEnthl</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SatEnthlCurveSlope</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4776"></a>                               <span class="n">InCoilSurfTemp</span>
<a name="ln-4777"></a>      <span class="k">ELSE</span>
<a name="ln-4778"></a><span class="k">         </span><span class="n">WaterTempConvg</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4779"></a>      <span class="k">END IF</span>
<a name="ln-4780"></a><span class="k">    END DO</span>    <span class="c">! End of iteration loop to get MeanWaterTemp=WetSideEffctvWaterTemp</span>
<a name="ln-4781"></a>    <span class="c">!</span>
<a name="ln-4782"></a>    <span class="c">!      if 8 CoolCoilErrs are reached without convergence and the</span>
<a name="ln-4783"></a>    <span class="c">!      predicted coil surface temperature at the outlet is less than</span>
<a name="ln-4784"></a>    <span class="c">!      the dew point coil is apparently all wet but a solution</span>
<a name="ln-4785"></a>    <span class="c">!      cannot be obtained</span>
<a name="ln-4786"></a>    <span class="c">!</span>
<a name="ln-4787"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WaterTempConvg</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">OutCoilSurfTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">EnterAirDewPoint</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4788"></a><span class="k">       CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4789"></a>            <span class="s1">&#39; not converged (8 iterations) due to &quot;Wet Convergence&quot; conditions.&#39;</span><span class="p">,</span><span class="n">WaterTempCoolCoilErrs</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-4790"></a>            <span class="nb">abs</span><span class="p">(</span><span class="n">MeanWaterTemp</span> <span class="o">-</span> <span class="n">WetSideEffctvWaterTemp</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">MeanWaterTemp</span> <span class="o">-</span> <span class="n">WetSideEffctvWaterTemp</span><span class="p">))</span>
<a name="ln-4791"></a><span class="c">!       CoolCoilErrs = CoolCoilErrs + 1</span>
<a name="ln-4792"></a><span class="c">!       IF (CoolCoilErrs .LE. MaxCoolCoilErrs) THEN</span>
<a name="ln-4793"></a><span class="c">!          CALL ShowWarningError(&#39;tp12c0:  not converged in 8 CoolCoilErrs&#39;)</span>
<a name="ln-4794"></a><span class="c">!       END IF</span>
<a name="ln-4795"></a>    <span class="k">END IF</span>
<a name="ln-4796"></a><span class="k">    </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MeanWaterTempSaved</span> <span class="o">=</span> <span class="n">MeanWaterTemp</span>
<a name="ln-4797"></a>    <span class="c">!</span>
<a name="ln-4798"></a>    <span class="c">!      now simulate wet dry coil - test outlet condition from all</span>
<a name="ln-4799"></a>    <span class="c">!      wet case to give an idea of the expected solution</span>
<a name="ln-4800"></a>    <span class="c">!</span>
<a name="ln-4801"></a>    <span class="n">PartWetIterations</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4802"></a>    <span class="n">WetDryInterSurfTempError</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4803"></a>    <span class="n">CoilPartWetConvg</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4804"></a>    <span class="c">!</span>
<a name="ln-4805"></a>    <span class="c">!      Surface temp at coil water outlet (air inlet) is less than</span>
<a name="ln-4806"></a>    <span class="c">!      the dew point - Coil must be completely wet so no need to</span>
<a name="ln-4807"></a>    <span class="c">!      simulate wet/dry case</span>
<a name="ln-4808"></a>    <span class="c">!</span>
<a name="ln-4809"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OutCoilSurfTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">EnterAirDewPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4810"></a><span class="k">      </span><span class="n">CoilPartWetConvg</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4811"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4812"></a>      <span class="n">TotWaterCoilLoad</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">*</span><span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-4813"></a>      <span class="n">AirWetDryInterfcTemp</span> <span class="o">=</span> <span class="n">TempAirIn</span>
<a name="ln-4814"></a>      <span class="n">WetDryInterfcAirEnthl</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span>
<a name="ln-4815"></a>    <span class="c">!</span>
<a name="ln-4816"></a>    <span class="c">!      Surface temperature at coil water inlet is greater than the</span>
<a name="ln-4817"></a>    <span class="c">!      dewpoint - coil cannot be all wet but may be all dry -</span>
<a name="ln-4818"></a>    <span class="c">!      initialise with all dry solution</span>
<a name="ln-4819"></a>    <span class="c">!</span>
<a name="ln-4820"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">InCoilSurfTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">EnterAirDewPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4821"></a><span class="k">      </span><span class="n">SurfAreaWet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4822"></a>      <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4823"></a>      <span class="n">WetDryInterfcWaterTemp</span> <span class="o">=</span> <span class="n">TempWaterIn</span>
<a name="ln-4824"></a>      <span class="n">TempWaterOut</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutWaterTempSaved</span> <span class="o">+</span> <span class="p">(</span><span class="n">TempWaterIn</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InWaterTempSaved</span><span class="p">)</span>
<a name="ln-4825"></a>      <span class="n">WetAreaLast</span> <span class="o">=</span> <span class="mf">0.05d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-4826"></a>    <span class="c">!</span>
<a name="ln-4827"></a>    <span class="c">!      General case - must be part-wet/part-dry - initialise</span>
<a name="ln-4828"></a>    <span class="c">!      accordingly with some non-zero wet area</span>
<a name="ln-4829"></a>    <span class="c">!</span>
<a name="ln-4830"></a>    <span class="k">ELSE</span>
<a name="ln-4831"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetSaved</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4832"></a><span class="k">         </span><span class="n">SurfAreaWet</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetSaved</span>
<a name="ln-4833"></a>      <span class="k">ELSE</span>
<a name="ln-4834"></a><span class="k">         </span><span class="n">SurfAreaWet</span> <span class="o">=</span> <span class="mf">0.8d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span> <span class="o">*</span> <span class="p">(</span><span class="n">EnterAirDewPoint</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4835"></a>                        <span class="n">InCoilSurfTemp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">OutCoilSurfTemp</span> <span class="o">-</span> <span class="n">InCoilSurfTemp</span><span class="p">)</span>
<a name="ln-4836"></a>      <span class="k">END IF</span>
<a name="ln-4837"></a><span class="k">      </span><span class="n">WetDryInterfcWaterTemp</span> <span class="o">=</span> <span class="n">TempWaterIn</span> <span class="o">+</span> <span class="n">EnterAirDewPoint</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4838"></a>                                 <span class="n">InCoilSurfTemp</span>
<a name="ln-4839"></a>      <span class="n">WetAreaLast</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4840"></a>    <span class="k">END IF</span>
<a name="ln-4841"></a>    <span class="c">!       Loop to solve partly wet coil, converges on wet area and</span>
<a name="ln-4842"></a>    <span class="c">!       boundary temperature at dew point</span>
<a name="ln-4843"></a>    <span class="c">!       Dry coil is special case with zero wet area, converges on</span>
<a name="ln-4844"></a>    <span class="c">!       mean water temperature</span>
<a name="ln-4845"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">PartWetIterations</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">40</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CoilPartWetConvg</span><span class="p">)</span>
<a name="ln-4846"></a>      <span class="n">PartWetIterations</span> <span class="o">=</span> <span class="n">PartWetIterations</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4847"></a>    <span class="c">!</span>
<a name="ln-4848"></a>    <span class="c">!      effective water temp on dry side of coil</span>
<a name="ln-4849"></a>    <span class="c">!</span>
<a name="ln-4850"></a>      <span class="n">DrySideEffectiveWaterTemp</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempWaterOut</span> <span class="o">+</span> <span class="n">WetDryInterfcWaterTemp</span><span class="p">)</span>
<a name="ln-4851"></a>    <span class="c">!</span>
<a name="ln-4852"></a>    <span class="c">!      tube inside thermal resistance</span>
<a name="ln-4853"></a>    <span class="c">!</span>
<a name="ln-4854"></a>      <span class="n">DryCoilInThermResist</span> <span class="o">=</span> <span class="n">WaterToTubeThermResist</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">0.0146d0</span> <span class="o">*</span> <span class="n">DrySideEffectiveWaterTemp</span><span class="p">)</span>
<a name="ln-4855"></a>    <span class="c">!</span>
<a name="ln-4856"></a>    <span class="c">!      overall UA, from water to air, of dry portion of coil</span>
<a name="ln-4857"></a>    <span class="c">!</span>
<a name="ln-4858"></a>
<a name="ln-4859"></a>      <span class="n">UADryCoil</span> <span class="o">=</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span> <span class="o">-</span> <span class="n">SurfAreaWet</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4860"></a>              <span class="p">(</span><span class="n">TubeFoulThermResist</span> <span class="o">+</span> <span class="n">DryCoilInThermResist</span> <span class="o">+</span> <span class="n">CoilToAirThermResistDrySurf</span><span class="p">))</span>
<a name="ln-4861"></a>
<a name="ln-4862"></a>    <span class="c">! This is a numerical trap for a very small number in the EXP function that is approaching zero</span>
<a name="ln-4863"></a>      <span class="k">If</span><span class="p">((</span><span class="n">UADryCoil</span><span class="o">*</span><span class="n">DryCoilCoeff1</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="o">-</span><span class="mi">6</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-4864"></a><span class="k">         </span><span class="n">DryCoilCoeff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4865"></a>      <span class="k">Else</span>
<a name="ln-4866"></a><span class="k">         </span><span class="n">DryCoilCoeff</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">UADryCoil</span><span class="o">*</span><span class="n">DryCoilCoeff1</span><span class="p">)</span>
<a name="ln-4867"></a>      <span class="k">End If</span>
<a name="ln-4868"></a>
<a name="ln-4869"></a><span class="k">      </span><span class="n">K1</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">ConvK</span> <span class="o">*</span> <span class="p">(</span><span class="n">DryCoilCoeff</span> <span class="o">-</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4870"></a>           <span class="p">(</span><span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">ConvK</span> <span class="o">*</span> <span class="n">DryCoilCoeff</span>     <span class="p">&amp;</span>
<a name="ln-4871"></a>           <span class="o">-</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="n">MoistAirSpecificHeat</span><span class="p">)</span>
<a name="ln-4872"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfAreaWet</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4873"></a><span class="k">        </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="n">SurfAreaWet</span> <span class="o">/</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-4874"></a>    <span class="c">!</span>
<a name="ln-4875"></a>    <span class="c">!      effective water temp on wet side of coil</span>
<a name="ln-4876"></a>    <span class="c">!</span>
<a name="ln-4877"></a>        <span class="n">WetSideEffctvWaterTemp</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempWaterIn</span> <span class="o">+</span> <span class="n">WetDryInterfcWaterTemp</span><span class="p">)</span>
<a name="ln-4878"></a>    <span class="c">!</span>
<a name="ln-4879"></a>    <span class="c">!      tube inside thermal resistance</span>
<a name="ln-4880"></a>    <span class="c">!</span>
<a name="ln-4881"></a>        <span class="n">ScaledWaterToTubeThermResist</span> <span class="o">=</span> <span class="n">WaterToTubeThermResist</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="mf">0.0146d0</span> <span class="o">*</span> <span class="n">WetSideEffctvWaterTemp</span><span class="p">)</span>
<a name="ln-4882"></a>        <span class="n">ScaledCoilAirThermResistWetSurf</span> <span class="o">=</span> <span class="n">CoilToAirThermResistWetSurf</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4883"></a>                                                  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span>
<a name="ln-4884"></a>    <span class="c">!</span>
<a name="ln-4885"></a>    <span class="c">!      overall UA, from water to air, of wet portion of coil</span>
<a name="ln-4886"></a>    <span class="c">!</span>
<a name="ln-4887"></a>        <span class="n">UACoilAllWet</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">/</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">*</span> <span class="p">(</span><span class="n">TubeFoulThermResist</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4888"></a>                       <span class="n">ScaledWaterToTubeThermResist</span> <span class="o">+</span>   <span class="p">&amp;</span>
<a name="ln-4889"></a>                       <span class="n">ScaledCoilAirThermResistWetSurf</span><span class="p">))</span>
<a name="ln-4890"></a>        <span class="n">UACoilPartWet</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span> <span class="o">*</span> <span class="n">UACoilAllWet</span>
<a name="ln-4891"></a>        <span class="n">expon</span><span class="o">=</span><span class="n">UACoilPartWet</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">/</span> <span class="n">AirMassFlow</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4892"></a>              <span class="p">(</span><span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">ConvK</span><span class="p">))</span>
<a name="ln-4893"></a>    <span class="c">!</span>
<a name="ln-4894"></a>    <span class="c">!        prevents floating point error when taking exponential</span>
<a name="ln-4895"></a>    <span class="c">!        of a very large number</span>
<a name="ln-4896"></a>    <span class="c">!</span>
<a name="ln-4897"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">expon</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mi">20</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4898"></a><span class="k">          </span><span class="n">WetCoilCoeff</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">expon</span><span class="p">)</span>
<a name="ln-4899"></a><span class="c">!          write(outputfiledebug,*) &#39; wcc=&#39;,wetcoilcoeff</span>
<a name="ln-4900"></a>          <span class="n">denom</span><span class="o">=</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-4901"></a>                                      <span class="n">WetCoilCoeff</span> <span class="o">*</span> <span class="n">ScaledWaterSpecHeat</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">WetCoilCoeff</span><span class="p">)</span> <span class="o">*</span> <span class="n">K1</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4902"></a>                                     <span class="n">MoistAirSpecificHeat</span><span class="p">)</span>
<a name="ln-4903"></a><span class="c">!          write(outputfiledebug,*) &#39; denom=&#39;,denom</span>
<a name="ln-4904"></a><span class="c">!          WetDryInterfcWaterTemp = ((1.0 - WetCoilCoeff) * (InletAirEnthalpy - WaterCoil(CoilNum)%EnthVsTempCurveConst - K1 *  &amp;</span>
<a name="ln-4905"></a><span class="c">!                                     MoistAirSpecificHeat * TempAirIn) + WetCoilCoeff * &amp;</span>
<a name="ln-4906"></a><span class="c">!                                     TempWaterIn * (WaterCoil(CoilNum)%EnthVsTempCurveAppxSlope -  &amp;</span>
<a name="ln-4907"></a><span class="c">!                                     ScaledWaterSpecHeat)) / (WaterCoil(CoilNum)%EnthVsTempCurveAppxSlope -  &amp;</span>
<a name="ln-4908"></a><span class="c">!                                      WetCoilCoeff * ScaledWaterSpecHeat - (1.0 - WetCoilCoeff) * K1 * &amp;</span>
<a name="ln-4909"></a><span class="c">!                                     MoistAirSpecificHeat)</span>
<a name="ln-4910"></a>          <span class="n">WetDryInterfcWaterTemp</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">WetCoilCoeff</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveConst</span> <span class="o">-</span> <span class="n">K1</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4911"></a>                                     <span class="n">MoistAirSpecificHeat</span> <span class="o">*</span> <span class="n">TempAirIn</span><span class="p">)</span> <span class="o">+</span> <span class="n">WetCoilCoeff</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4912"></a>                                     <span class="n">TempWaterIn</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-4913"></a>                                     <span class="n">ScaledWaterSpecHeat</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
<a name="ln-4914"></a>        <span class="k">ELSE</span>
<a name="ln-4915"></a>    <span class="c">!</span>
<a name="ln-4916"></a>    <span class="c">!         approximation to equation for WetDryInterfcWaterTemp when WetCoilCoeff--&gt;inf.</span>
<a name="ln-4917"></a>    <span class="c">!</span>
<a name="ln-4918"></a>        <span class="n">WetDryInterfcWaterTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempWaterIn</span> <span class="o">*</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4919"></a>                                 <span class="n">ScaledWaterSpecHeat</span><span class="p">)</span> <span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-4920"></a>                                 <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveConst</span> <span class="o">-</span> <span class="n">K1</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4921"></a>                                 <span class="n">MoistAirSpecificHeat</span> <span class="o">*</span> <span class="n">TempAirIn</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-4922"></a>                                 <span class="o">/</span> <span class="p">(</span><span class="n">K1</span> <span class="o">*</span> <span class="n">MoistAirSpecificHeat</span> <span class="o">-</span> <span class="n">ScaledWaterSpecHeat</span><span class="p">)</span>
<a name="ln-4923"></a>        <span class="k">END IF</span>
<a name="ln-4924"></a><span class="k">      END IF</span>
<a name="ln-4925"></a>    <span class="c">!</span>
<a name="ln-4926"></a>    <span class="c">!        air temperature at wet-dry interface</span>
<a name="ln-4927"></a>    <span class="c">!</span>
<a name="ln-4928"></a>      <span class="n">AirWetDryInterfcTemp</span> <span class="o">=</span> <span class="n">TempAirIn</span> <span class="o">-</span> <span class="p">(</span><span class="n">TempAirIn</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4929"></a>                                      <span class="n">WetDryInterfcWaterTemp</span><span class="p">)</span> <span class="o">*</span> <span class="n">K1</span>
<a name="ln-4930"></a>    <span class="c">!</span>
<a name="ln-4931"></a>    <span class="c">!        coil surface temperature at wet-dry interface</span>
<a name="ln-4932"></a>    <span class="c">!</span>
<a name="ln-4933"></a>      <span class="n">WetDryInterfcSurfTemp</span> <span class="o">=</span> <span class="n">WetDryInterfcWaterTemp</span> <span class="o">+</span> <span class="p">(</span><span class="n">AirWetDryInterfcTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4934"></a>                                <span class="n">WetDryInterfcWaterTemp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">TubeFoulThermResist</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4935"></a>                                <span class="n">DryCoilInThermResist</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">TubeFoulThermResist</span> <span class="o">+</span> <span class="n">DryCoilInThermResist</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4936"></a>                                <span class="n">CoilToAirThermResistDrySurf</span><span class="p">)</span>
<a name="ln-4937"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfAreaWet</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4938"></a><span class="k">        </span><span class="n">WetDryInterfcAirEnthl</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">MoistAirSpecificHeat</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4939"></a>                                                  <span class="p">(</span><span class="n">TempAirIn</span> <span class="o">-</span> <span class="n">AirWetDryInterfcTemp</span><span class="p">)</span>
<a name="ln-4940"></a>    <span class="c">!</span>
<a name="ln-4941"></a>    <span class="c">!        conservation of energy - wet portion of coil</span>
<a name="ln-4942"></a>    <span class="c">!</span>
<a name="ln-4943"></a>        <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">WetDryInterfcAirEnthl</span> <span class="o">-</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4944"></a>                                 <span class="n">Cp</span> <span class="o">*</span> <span class="n">ConvK</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4945"></a>                                 <span class="p">(</span><span class="n">WetDryInterfcWaterTemp</span> <span class="o">-</span> <span class="n">TempWaterIn</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4946"></a>                                 <span class="n">AirMassFlow</span>
<a name="ln-4947"></a>    <span class="c">!</span>
<a name="ln-4948"></a>    <span class="c">!        ratio of inside to outside thermal resistance</span>
<a name="ln-4949"></a>    <span class="c">!</span>
<a name="ln-4950"></a>        <span class="n">InsdToOutsdThermResistRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">TubeFoulThermResist</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4951"></a>                                                  <span class="n">ScaledWaterToTubeThermResist</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4952"></a>                                                  <span class="n">ScaledCoilAirThermResistWetSurf</span>
<a name="ln-4953"></a>    <span class="c">!</span>
<a name="ln-4954"></a>    <span class="c">!        coil surface temperature at water inlet (air outlet)</span>
<a name="ln-4955"></a>    <span class="c">!</span>
<a name="ln-4956"></a>        <span class="n">InCoilSurfTemp</span> <span class="o">=</span> <span class="n">UACoilAllWet</span> <span class="o">*</span> <span class="n">ScaledCoilAirThermResistWetSurf</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4957"></a>                             <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">*</span> <span class="n">TempWaterIn</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutletAirEnthalpy</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4958"></a>                             <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveConst</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4959"></a>                             <span class="n">InsdToOutsdThermResistRatio</span><span class="p">)</span>
<a name="ln-4960"></a>        <span class="n">WetDryInterSurfTempErrorLast</span> <span class="o">=</span> <span class="n">WetDryInterSurfTempError</span>
<a name="ln-4961"></a>    <span class="c">!</span>
<a name="ln-4962"></a>    <span class="c">!        in part-wet/part-dry solution EnterAirDewPoint=WetDryInterfcSurfTemp drives WetDryInterSurfTempError-&gt;0</span>
<a name="ln-4963"></a>    <span class="c">!</span>
<a name="ln-4964"></a>        <span class="n">WetDryInterSurfTempError</span> <span class="o">=</span> <span class="n">EnterAirDewPoint</span> <span class="o">-</span> <span class="n">WetDryInterfcSurfTemp</span>
<a name="ln-4965"></a>      <span class="k">ELSE</span>
<a name="ln-4966"></a>    <span class="c">!</span>
<a name="ln-4967"></a>    <span class="c">!        dry coil solution</span>
<a name="ln-4968"></a>    <span class="c">!</span>
<a name="ln-4969"></a>        <span class="n">WetDryInterfcAirEnthl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4970"></a>        <span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="n">MoistAirSpecificHeat</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4971"></a>                                         <span class="p">(</span><span class="n">TempAirIn</span> <span class="o">-</span> <span class="n">AirWetDryInterfcTemp</span><span class="p">)</span>
<a name="ln-4972"></a>      <span class="k">END IF</span>
<a name="ln-4973"></a>    <span class="c">!</span>
<a name="ln-4974"></a>    <span class="c">!        total cooling = change in air enmthalpy across coil</span>
<a name="ln-4975"></a>    <span class="c">!</span>
<a name="ln-4976"></a>      <span class="n">TotWaterCoilLoad</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">InletAirEnthalpy</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4977"></a>                            <span class="n">OutletAirEnthalpy</span><span class="p">)</span>
<a name="ln-4978"></a>    <span class="c">!</span>
<a name="ln-4979"></a>    <span class="c">!        conservation of energy on water stream gives water outlet</span>
<a name="ln-4980"></a>    <span class="c">!        temperature</span>
<a name="ln-4981"></a>    <span class="c">!</span>
<a name="ln-4982"></a>      <span class="n">TempWaterOut</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">ConvK</span>  <span class="c">! Temp for next calc</span>
<a name="ln-4983"></a>      <span class="n">TempWaterOut</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">TempWaterIn</span> <span class="o">+</span> <span class="n">TotWaterCoilLoad</span><span class="o">/</span><span class="n">TempWaterOut</span><span class="p">,</span> <span class="n">TempAirIn</span><span class="p">)</span>
<a name="ln-4984"></a>    <span class="c">!</span>
<a name="ln-4985"></a>    <span class="c">!        update estimate of coil wet area</span>
<a name="ln-4986"></a>    <span class="c">!</span>
<a name="ln-4987"></a>
<a name="ln-4988"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfAreaWet</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4989"></a><span class="k">        </span><span class="n">MeanWaterTemp</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempWaterOut</span> <span class="o">+</span> <span class="n">WetDryInterfcWaterTemp</span><span class="p">)</span>
<a name="ln-4990"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">EnterAirDewPoint</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">WetDryInterfcSurfTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4991"></a><span class="k">          </span><span class="n">SurfAreaWet</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">WetAreaLast</span>
<a name="ln-4992"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MeanWaterTemp</span> <span class="o">-</span> <span class="n">DrySideEffectiveWaterTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="p">.</span><span class="mi">00002</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4993"></a><span class="k">            </span><span class="n">CoilPartWetConvg</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4994"></a>        <span class="k">END IF</span>
<a name="ln-4995"></a><span class="k">      ELSE IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">WetDryInterSurfTempError</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">.</span><span class="mi">00002</span><span class="n">d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">SurfAreaWet</span> <span class="o">-</span> <span class="n">WetAreaLast</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4996"></a>              <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">.</span><span class="mi">00001</span><span class="n">d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4997"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">WetAreaLast</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4998"></a><span class="k">          </span><span class="n">WetAreaLast</span> <span class="o">=</span> <span class="n">SurfAreaWet</span>
<a name="ln-4999"></a>          <span class="n">SurfAreaWet</span> <span class="o">=</span> <span class="n">SurfAreaWet</span> <span class="o">+</span> <span class="mf">0.4d0</span> <span class="o">*</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span> <span class="o">*</span> <span class="n">WetDryInterSurfTempError</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5000"></a>                        <span class="p">(</span><span class="n">OutCoilSurfTemp</span> <span class="o">-</span> <span class="n">InCoilSurfTemp</span><span class="p">)</span>
<a name="ln-5001"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WetDryInterSurfTempError</span> <span class="p">.</span><span class="n">ne</span><span class="p">.</span> <span class="n">WetDryInterSurfTempErrorLast</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5002"></a><span class="k">          </span><span class="n">WetAreaChange</span> <span class="o">=</span> <span class="n">SurfAreaWet</span> <span class="o">-</span> <span class="n">WetAreaLast</span>
<a name="ln-5003"></a>          <span class="n">WetAreaLast</span> <span class="o">=</span> <span class="n">SurfAreaWet</span>
<a name="ln-5004"></a>          <span class="n">SurfAreaWet</span> <span class="o">=</span> <span class="n">SurfAreaWet</span> <span class="o">-</span> <span class="mf">0.8d0</span> <span class="o">*</span> <span class="n">WetDryInterSurfTempError</span> <span class="o">*</span> <span class="n">WetAreaChange</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5005"></a>                        <span class="p">(</span><span class="n">WetDryInterSurfTempError</span> <span class="o">-</span> <span class="n">WetDryInterSurfTempErrorLast</span><span class="p">)</span>
<a name="ln-5006"></a>        <span class="k">END IF</span>
<a name="ln-5007"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfAreaWet</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5008"></a><span class="k">          </span><span class="n">SurfAreaWet</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-5009"></a>          <span class="n">MeanWaterTemp</span> <span class="o">=</span> <span class="mf">0.5d0</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempWaterIn</span> <span class="o">+</span> <span class="n">WetDryInterfcWaterTemp</span><span class="p">)</span>
<a name="ln-5010"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">WetAreaLast</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="nb">abs</span><span class="p">(</span><span class="n">MeanWaterTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5011"></a>              <span class="n">WetSideEffctvWaterTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="p">.</span><span class="mi">00002</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5012"></a><span class="k">            </span><span class="n">CoilPartWetConvg</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5013"></a>          <span class="k">END IF</span>
<a name="ln-5014"></a><span class="k">        END IF</span>
<a name="ln-5015"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SurfAreaWet</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5016"></a><span class="k">          </span><span class="n">SurfAreaWet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5017"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5018"></a>          <span class="n">WetDryInterfcWaterTemp</span> <span class="o">=</span> <span class="n">TempWaterIn</span>
<a name="ln-5019"></a>        <span class="k">END IF</span>
<a name="ln-5020"></a><span class="k">        </span><span class="n">InSurfTempSatAirEnthl</span> <span class="o">=</span> <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">InCoilSurfTemp</span><span class="p">,</span> <span class="n">unity</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">ConvK</span>
<a name="ln-5021"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">EnterAirDewPoint</span> <span class="o">-</span> <span class="n">InCoilSurfTemp</span><span class="p">)</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="p">.</span><span class="mi">0001</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5022"></a><span class="k">          </span><span class="n">AirEnthAtWetDryIntrfcSurfTemp</span> <span class="o">=</span> <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">EnterAirDewPoint</span><span class="p">,</span> <span class="n">unity</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5023"></a>                                                               <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">ConvK</span>
<a name="ln-5024"></a>          <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">=</span> <span class="p">(</span><span class="n">AirEnthAtWetDryIntrfcSurfTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5025"></a>                                             <span class="n">InSurfTempSatAirEnthl</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5026"></a>                                             <span class="p">(</span><span class="n">EnterAirDewPoint</span> <span class="o">-</span> <span class="n">InCoilSurfTemp</span><span class="p">)</span>
<a name="ln-5027"></a>        <span class="k">ELSE</span>
<a name="ln-5028"></a><span class="k">           </span><span class="n">AirEnthAtWetDryIntrfcSurfTemp</span> <span class="o">=</span> <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">InCoilSurfTemp</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">,</span> <span class="n">unity</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5029"></a>                                               <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">ConvK</span>
<a name="ln-5030"></a>           <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">=</span> <span class="p">(</span><span class="n">AirEnthAtWetDryIntrfcSurfTemp</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5031"></a>                                      <span class="n">InSurfTempSatAirEnthl</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.0001d0</span>
<a name="ln-5032"></a>        <span class="k">END IF</span>
<a name="ln-5033"></a><span class="k">        </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveConst</span> <span class="o">=</span> <span class="n">InSurfTempSatAirEnthl</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">EnthVsTempCurveAppxSlope</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5034"></a>                                       <span class="n">InCoilSurfTemp</span>
<a name="ln-5035"></a>      <span class="k">ELSE</span>
<a name="ln-5036"></a><span class="k">         </span><span class="n">CoilPartWetConvg</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5037"></a>      <span class="k">END IF</span>
<a name="ln-5038"></a><span class="k">    END DO</span>
<a name="ln-5039"></a>    <span class="c">!</span>
<a name="ln-5040"></a>    <span class="c">!      error checking to see if convergence has been achieved</span>
<a name="ln-5041"></a>    <span class="c">!</span>
<a name="ln-5042"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CoilPartWetConvg</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5043"></a><span class="k">       CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5044"></a>            <span class="s1">&#39; not converged (40 iterations) due to &quot;Partial Wet Convergence&quot; conditions.&#39;</span><span class="p">,</span><span class="n">PartWetCoolCoilErrs</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span>
<a name="ln-5045"></a><span class="c">!      CoolCoilErrs = CoolCoilErrs + 1</span>
<a name="ln-5046"></a><span class="c">!      IF (CoolCoilErrs .LE. MaxCoolCoilErrs) THEN</span>
<a name="ln-5047"></a><span class="c">!        CALL ShowWarningError(&#39;tp12c0:  not converged in 20 CoolCoilErrs&#39;)</span>
<a name="ln-5048"></a><span class="c">!      END IF</span>
<a name="ln-5049"></a>    <span class="k">END IF</span>
<a name="ln-5050"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5051"></a><span class="k">      </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetSaved</span><span class="o">=</span> <span class="n">SurfAreaWet</span>
<a name="ln-5052"></a>    <span class="k">END IF</span>
<a name="ln-5053"></a>    <span class="c">!</span>
<a name="ln-5054"></a>    <span class="c">!       calculate TempAirOut, OutletAirHumRat, and SensCoolRate based on equations from</span>
<a name="ln-5055"></a>    <span class="c">!       TYPE12 and the ASHRAE toolkit</span>
<a name="ln-5056"></a>    <span class="c">!</span>
<a name="ln-5057"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5058"></a>    <span class="c">!</span>
<a name="ln-5059"></a>    <span class="c">!       dry coil</span>
<a name="ln-5060"></a>    <span class="c">!</span>
<a name="ln-5061"></a>      <span class="n">TempAirOut</span> <span class="o">=</span> <span class="n">TempAirIn</span> <span class="o">-</span> <span class="n">TotWaterCoilLoad</span> <span class="o">/</span> <span class="p">(</span><span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5062"></a>                                <span class="n">MoistAirSpecificHeat</span><span class="p">)</span>
<a name="ln-5063"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">InletAirHumRat</span>
<a name="ln-5064"></a>      <span class="n">SenWaterCoilLoad</span> <span class="o">=</span> <span class="n">TotWaterCoilLoad</span>
<a name="ln-5065"></a>    <span class="k">ELSE</span>
<a name="ln-5066"></a>    <span class="c">!</span>
<a name="ln-5067"></a>    <span class="c">!       coil effectiveness</span>
<a name="ln-5068"></a>      <span class="n">expon</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span> <span class="o">/</span> <span class="p">(</span><span class="n">CoilToAirThermResistWetSurf</span> <span class="o">*</span> <span class="n">AirMassFlow</span><span class="p">)</span>
<a name="ln-5069"></a>      <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5070"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">expon</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span><span class="mf">0.d0</span><span class="p">)</span> <span class="n">y</span><span class="o">=</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">expon</span><span class="p">)</span>
<a name="ln-5071"></a>      <span class="n">AirExitEnthlAtCoilSurfTemp</span> <span class="o">=</span> <span class="n">WetDryInterfcAirEnthl</span> <span class="o">-</span> <span class="p">(</span><span class="n">WetDryInterfcAirEnthl</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5072"></a>                                   <span class="n">OutletAirEnthalpy</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
<a name="ln-5073"></a>      <span class="n">AirExitCoilSurfTemp</span><span class="o">=</span><span class="n">AirExitEnthlAtCoilSurfTemp</span><span class="o">/</span><span class="n">ConvK</span>  <span class="c">! TEmporary calc</span>
<a name="ln-5074"></a>      <span class="n">AirExitCoilSurfTemp</span><span class="o">=</span><span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">AirExitCoilSurfTemp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-5075"></a>    <span class="c">!</span>
<a name="ln-5076"></a>    <span class="c">!       Implementation of epsilon*NTU method</span>
<a name="ln-5077"></a>      <span class="n">TempAirOut</span> <span class="o">=</span> <span class="n">AirExitCoilSurfTemp</span> <span class="o">+</span> <span class="p">(</span><span class="n">AirWetDryInterfcTemp</span> <span class="o">-</span> <span class="n">AirExitCoilSurfTemp</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span>
<a name="ln-5078"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">TempAirOut</span><span class="p">,</span> <span class="mi">100</span><span class="mf">0.d0</span> <span class="o">*</span> <span class="n">OutletAirEnthalpy</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span>
<a name="ln-5079"></a>      <span class="n">SenWaterCoilLoad</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">InletAirHumRat</span><span class="p">,</span> <span class="n">TempAirIn</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">TempAirIn</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5080"></a>                            <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">OutletAirHumRat</span><span class="p">,</span> <span class="n">TempAirOut</span><span class="p">,</span> <span class="s1">&#39;CalcDetailFlatFinCoolingCoil&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5081"></a>                            <span class="n">TempAirOut</span><span class="p">)</span> <span class="o">*</span> <span class="n">ConvK</span>
<a name="ln-5082"></a>    <span class="k">END IF</span>
<a name="ln-5083"></a>
<a name="ln-5084"></a><span class="k">   IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5085"></a><span class="k">     </span><span class="n">TotWaterCoilLoad</span> <span class="o">=</span> <span class="n">TotWaterCoilLoad</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5086"></a>     <span class="n">SenWaterCoilLoad</span> <span class="o">=</span> <span class="n">SenWaterCoilLoad</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5087"></a>   <span class="k">END IF</span>
<a name="ln-5088"></a>
<a name="ln-5089"></a>
<a name="ln-5090"></a>   <span class="c">! Set the outlet conditions</span>
<a name="ln-5091"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span>  <span class="o">=</span> <span class="n">TotWaterCoilLoad</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5092"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span>  <span class="o">=</span> <span class="n">SenWaterCoilLoad</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5093"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">TempAirOut</span>
<a name="ln-5094"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>   <span class="o">=</span> <span class="n">TempWaterOut</span>
<a name="ln-5095"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">OutletAirEnthalpy</span> <span class="o">*</span> <span class="mi">100</span><span class="mf">0.0d0</span>
<a name="ln-5096"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">OutletAirHumRat</span>
<a name="ln-5097"></a>   <span class="c">!The CoolingCoilLoad is the change in the enthalpy of the water</span>
<a name="ln-5098"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5099"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-5100"></a>
<a name="ln-5101"></a>   <span class="c">!This WaterCoil does not change the Mass Flow across the component</span>
<a name="ln-5102"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-5103"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-5104"></a><span class="k">Else</span>
<a name="ln-5105"></a><span class="c">! If Coil is scheduled OFF then Outlet conditions are set to Inlet Conditions</span>
<a name="ln-5106"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5107"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5108"></a>  <span class="n">TempAirOut</span><span class="o">=</span><span class="n">TempAirIn</span>
<a name="ln-5109"></a>  <span class="n">TempWaterOut</span> <span class="o">=</span><span class="n">TempWaterIn</span>
<a name="ln-5110"></a><span class="c">! set the outlet conditions to the coil derived type</span>
<a name="ln-5111"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>     <span class="o">=</span> <span class="n">TempAirOut</span>
<a name="ln-5112"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>   <span class="o">=</span> <span class="n">TempWaterOut</span>
<a name="ln-5113"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirEnthalpy</span>
<a name="ln-5114"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>   <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-5115"></a><span class="c">!The CoolingCoilLoad is the change in the enthalpy of the water</span>
<a name="ln-5116"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-5117"></a>
<a name="ln-5118"></a><span class="c">!This WaterCoil does not change the Mass Flow across the component</span>
<a name="ln-5119"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-5120"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5121"></a><span class="k">End If</span>
<a name="ln-5122"></a>
<a name="ln-5123"></a>  <span class="c">!Save some of the Values for next Time step</span>
<a name="ln-5124"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InWaterTempSaved</span> <span class="o">=</span> <span class="n">TempWaterIn</span>
<a name="ln-5125"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutWaterTempSaved</span> <span class="o">=</span> <span class="n">TempWaterOut</span>
<a name="ln-5126"></a>
<a name="ln-5127"></a>    <span class="k">RETURN</span>
<a name="ln-5128"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDetailFlatFinCoolingCoil</span>
<a name="ln-5129"></a>
<a name="ln-5130"></a>
<a name="ln-5131"></a><span class="k">SUBROUTINE </span><span class="n">CoolingCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">CalcMode</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5132"></a>
<a name="ln-5133"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5134"></a>          <span class="c">! AUTHOR         Rahul Chillar</span>
<a name="ln-5135"></a>          <span class="c">! DATE WRITTEN   Mar 2004</span>
<a name="ln-5136"></a>          <span class="c">! MODIFIED       na</span>
<a name="ln-5137"></a>          <span class="c">! RE-ENGINEERED  na</span>
<a name="ln-5138"></a>
<a name="ln-5139"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5140"></a>          <span class="c">! The subroutine has the coil logic. Three types of Cooling Coils exist:</span>
<a name="ln-5141"></a>          <span class="c">! They are 1.CoilDry , 2.CoilWet, 3. CoilPartDryPartWet. The logic for</span>
<a name="ln-5142"></a>          <span class="c">! the three individual cases is in this subroutine.</span>
<a name="ln-5143"></a>
<a name="ln-5144"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5145"></a>          <span class="c">! Simulates a Coil Model from Design conditions and subsequently uses</span>
<a name="ln-5146"></a>          <span class="c">! configuration values (example: UA)calculated from those design conditions</span>
<a name="ln-5147"></a>          <span class="c">! to calculate new performance of coil from operating inputs.The values are</span>
<a name="ln-5148"></a>          <span class="c">! calculated in the Subroutine InitWaterCoil</span>
<a name="ln-5149"></a>
<a name="ln-5150"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5151"></a>          <span class="c">! ASHRAE Secondary HVAC Toolkit TRNSYS.  1990.  A Transient System</span>
<a name="ln-5152"></a>          <span class="c">! Simulation Program: Reference Manual. Solar Energy Laboratory, Univ. Wisconsin-</span>
<a name="ln-5153"></a>          <span class="c">! Madison, pp. 4.6.8-1 - 4.6.8-12.</span>
<a name="ln-5154"></a>          <span class="c">! Threlkeld, J.L.  1970.  Thermal Environmental Engineering, 2nd Edition,</span>
<a name="ln-5155"></a>          <span class="c">! Englewood Cliffs: Prentice-Hall,Inc. pp. 254-270.</span>
<a name="ln-5156"></a>
<a name="ln-5157"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5158"></a>        <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SafeDivide</span>
<a name="ln-5159"></a>
<a name="ln-5160"></a>          <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5161"></a>        <span class="k">IMPLICIT NONE</span>
<a name="ln-5162"></a>
<a name="ln-5163"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5164"></a>        <span class="kt">Integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-5165"></a>        <span class="kt">Logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-5166"></a>        <span class="kt">Integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CalcMode</span>
<a name="ln-5167"></a>        <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>      <span class="c">! fan operating mode</span>
<a name="ln-5168"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>  <span class="c">! part-load ratio of heating coil</span>
<a name="ln-5169"></a>
<a name="ln-5170"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5171"></a>          <span class="c">! na</span>
<a name="ln-5172"></a>
<a name="ln-5173"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5174"></a>          <span class="c">! na</span>
<a name="ln-5175"></a>
<a name="ln-5176"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5177"></a>          <span class="c">! na</span>
<a name="ln-5178"></a>
<a name="ln-5179"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5180"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AirInletCoilSurfTemp</span>  <span class="c">! Coil surface temperature at air entrance(C)</span>
<a name="ln-5181"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AirDewPointTemp</span>       <span class="c">! Temperature dew point at operating condition</span>
<a name="ln-5182"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutletAirTemp</span>         <span class="c">! Outlet air temperature at operating condition</span>
<a name="ln-5183"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutletAirHumRat</span>       <span class="c">! Outlet air humidity ratio at operating condition</span>
<a name="ln-5184"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">OutletWaterTemp</span>       <span class="c">! Outlet water temperature at operating condtitons</span>
<a name="ln-5185"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">TotWaterCoilLoad</span>      <span class="c">! Total heat transfer rate(W)</span>
<a name="ln-5186"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SenWaterCoilLoad</span>      <span class="c">! Sensible heat transfer rate</span>
<a name="ln-5187"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">SurfAreaWetFraction</span>   <span class="c">! Fraction of surface area wet</span>
<a name="ln-5188"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">AirMassFlowRate</span>       <span class="c">! Air mass flow rate for the calculation</span>
<a name="ln-5189"></a>
<a name="ln-5190"></a>     <span class="n">AirInletCoilSurfTemp</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! Coil surface temperature at air entrance(C)</span>
<a name="ln-5191"></a>     <span class="n">AirDewPointTemp</span><span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! Temperature dew point at operating condition</span>
<a name="ln-5192"></a>     <span class="n">OutletAirTemp</span><span class="o">=</span><span class="mf">0.0d0</span>         <span class="c">! Outlet air temperature at operating condition</span>
<a name="ln-5193"></a>     <span class="n">OutletAirHumRat</span><span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! Outlet air humidity ratio at operating condition</span>
<a name="ln-5194"></a>     <span class="n">OutletWaterTemp</span><span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! Outlet water temperature at operating condtitons</span>
<a name="ln-5195"></a>     <span class="n">TotWaterCoilLoad</span><span class="o">=</span><span class="mf">0.0d0</span>      <span class="c">! Total heat transfer rate(W)</span>
<a name="ln-5196"></a>     <span class="n">SenWaterCoilLoad</span><span class="o">=</span><span class="mf">0.0d0</span>      <span class="c">! Sensible heat transfer rate</span>
<a name="ln-5197"></a>     <span class="n">SurfAreaWetFraction</span><span class="o">=</span><span class="mf">0.0d0</span>   <span class="c">! Fraction of surface area wet</span>
<a name="ln-5198"></a>
<a name="ln-5199"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!FB Start</span>
<a name="ln-5200"></a>       <span class="n">AirMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">/</span> <span class="n">PartLoadRatio</span>
<a name="ln-5201"></a>     <span class="k">ELSE</span>
<a name="ln-5202"></a><span class="k">       </span><span class="n">AirMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-5203"></a>     <span class="k">END IF</span>
<a name="ln-5204"></a>
<a name="ln-5205"></a>      <span class="c">! If Coil is Scheduled ON then do the simulation</span>
<a name="ln-5206"></a>  <span class="k">IF</span><span class="p">(((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-5207"></a>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>            <span class="p">&amp;</span>
<a name="ln-5208"></a>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">AirMassFlowRate</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">MinAirMassFlow</span><span class="p">)</span>                           <span class="p">&amp;</span>
<a name="ln-5209"></a>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>                 <span class="p">&amp;</span>
<a name="ln-5210"></a>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">CalcMode</span> <span class="o">==</span> <span class="n">DesignCalc</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5211"></a>
<a name="ln-5212"></a>        <span class="c">!Calculate Temperature Dew Point at operating conditions.</span>
<a name="ln-5213"></a>      <span class="n">AirDewPointTemp</span><span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-5214"></a>
<a name="ln-5215"></a>
<a name="ln-5216"></a>     <span class="k">Select Case</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CoolingCoilAnalysisMode</span><span class="p">)</span>
<a name="ln-5217"></a>      <span class="k">Case</span><span class="p">(</span><span class="n">DetailedAnalysis</span><span class="p">)</span>
<a name="ln-5218"></a>        <span class="c">!Coil is completely dry if AirDewPointTemp is less than InletWaterTemp,hence Call CoilCompletelyDry</span>
<a name="ln-5219"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AirDewPointTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5220"></a>
<a name="ln-5221"></a>            <span class="c">!Calculate the leaving conditions and performance of dry coil</span>
<a name="ln-5222"></a>          <span class="k">CALL </span><span class="n">CoilCompletelyDry</span> <span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">,&amp;</span>
<a name="ln-5223"></a>                                                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-5224"></a>                                                <span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">TotWaterCoilLoad</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span> <span class="p">)</span>
<a name="ln-5225"></a>
<a name="ln-5226"></a>          <span class="n">SenWaterCoilLoad</span> <span class="o">=</span> <span class="n">TotWaterCoilLoad</span>
<a name="ln-5227"></a>          <span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5228"></a>
<a name="ln-5229"></a>        <span class="k">ELSE</span>
<a name="ln-5230"></a>         <span class="c">!Else If AirDewPointTemp is greater than InletWaterTemp then assume the</span>
<a name="ln-5231"></a>         <span class="c">!external surface of coil is completely wet,hence Call CoilCompletelyWet</span>
<a name="ln-5232"></a>         <span class="c">!Calculate the leaving conditions and performance of wet coil</span>
<a name="ln-5233"></a>          <span class="k">CALL </span><span class="n">CoilCompletelyWet</span> <span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span>                            <span class="p">&amp;</span>
<a name="ln-5234"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5235"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5236"></a>                                 <span class="n">OutletWaterTemp</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">TotWaterCoilLoad</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-5237"></a>                                 <span class="n">SenWaterCoilLoad</span><span class="p">,</span><span class="n">SurfAreaWetFraction</span><span class="p">,</span><span class="n">AirInletCoilSurfTemp</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5238"></a>
<a name="ln-5239"></a>
<a name="ln-5240"></a>           <span class="c">!If AirDewPointTemp is less than temp of coil surface at entry of air</span>
<a name="ln-5241"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">AirDewPointTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">AirInletCoilSurfTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5242"></a>
<a name="ln-5243"></a>             <span class="c">!Then coil is partially wet and dry hence call CoilPartWetPartDry</span>
<a name="ln-5244"></a>             <span class="c">!Calculate the leaving conditions and performance of dry coil</span>
<a name="ln-5245"></a>              <span class="k">CALL </span><span class="n">CoilPartWetPartDry</span> <span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-5246"></a>                                     <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">,</span>                                           <span class="p">&amp;</span>
<a name="ln-5247"></a>                                     <span class="n">AirDewPointTemp</span><span class="p">,</span><span class="n">OutletWaterTemp</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-5248"></a>                                     <span class="n">TotWaterCoilLoad</span><span class="p">,</span><span class="n">SenWaterCoilLoad</span><span class="p">,</span><span class="n">SurfAreaWetFraction</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5249"></a>
<a name="ln-5250"></a>           <span class="n">ENDIF</span>  <span class="c">!End if for part wet part dry coil</span>
<a name="ln-5251"></a>        <span class="n">ENDIF</span>  <span class="c">!End if for dry coil</span>
<a name="ln-5252"></a>
<a name="ln-5253"></a>      <span class="k">Case</span><span class="p">(</span><span class="n">SimpleAnalysis</span><span class="p">)</span>
<a name="ln-5254"></a>        <span class="c">!Coil is completely dry if AirDewPointTemp is less than InletWaterTemp,hence Call CoilCompletelyDry</span>
<a name="ln-5255"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AirDewPointTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5256"></a>
<a name="ln-5257"></a>            <span class="c">!Calculate the leaving conditions and performance of dry coil</span>
<a name="ln-5258"></a>          <span class="k">CALL </span><span class="n">CoilCompletelyDry</span> <span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">,&amp;</span>
<a name="ln-5259"></a>                                                <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span><span class="p">,</span> <span class="n">OutletWaterTemp</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-5260"></a>                                                <span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">TotWaterCoilLoad</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span> <span class="p">)</span>
<a name="ln-5261"></a>
<a name="ln-5262"></a>          <span class="n">SenWaterCoilLoad</span> <span class="o">=</span> <span class="n">TotWaterCoilLoad</span>
<a name="ln-5263"></a>          <span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5264"></a>
<a name="ln-5265"></a>        <span class="k">ELSE</span>
<a name="ln-5266"></a>         <span class="c">!Else If AirDewPointTemp is greater than InletWaterTemp then assume the</span>
<a name="ln-5267"></a>         <span class="c">!external surface of coil is completely wet,hence Call CoilCompletelyWet</span>
<a name="ln-5268"></a>         <span class="c">!Calculate the leaving conditions and performance of wet coil</span>
<a name="ln-5269"></a>          <span class="k">CALL </span><span class="n">CoilCompletelyWet</span> <span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">,</span>                            <span class="p">&amp;</span>
<a name="ln-5270"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5271"></a>                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5272"></a>                                 <span class="n">OutletWaterTemp</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">TotWaterCoilLoad</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-5273"></a>                                 <span class="n">SenWaterCoilLoad</span><span class="p">,</span><span class="n">SurfAreaWetFraction</span><span class="p">,</span><span class="n">AirInletCoilSurfTemp</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5274"></a>
<a name="ln-5275"></a>        <span class="n">ENDIF</span>  <span class="c">!End if for dry coil</span>
<a name="ln-5276"></a>
<a name="ln-5277"></a>     <span class="k">End Select</span>
<a name="ln-5278"></a>
<a name="ln-5279"></a>         <span class="c">! Report outlet variables at nodes</span>
<a name="ln-5280"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">OutletAirTemp</span>
<a name="ln-5281"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="o">=</span><span class="n">OutletAirHumRat</span>
<a name="ln-5282"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="o">=</span><span class="n">OutletWaterTemp</span>
<a name="ln-5283"></a>         <span class="c">!Report output results if the coil was operating</span>
<a name="ln-5284"></a>
<a name="ln-5285"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5286"></a><span class="k">         </span><span class="n">TotWaterCoilLoad</span> <span class="o">=</span> <span class="n">TotWaterCoilLoad</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5287"></a>         <span class="n">SenWaterCoilLoad</span> <span class="o">=</span> <span class="n">SenWaterCoilLoad</span><span class="o">*</span><span class="n">PartLoadRatio</span>
<a name="ln-5288"></a>       <span class="k">END IF</span>
<a name="ln-5289"></a>
<a name="ln-5290"></a><span class="k">       </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="o">=</span><span class="n">TotWaterCoilLoad</span>
<a name="ln-5291"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span><span class="o">=</span><span class="n">SenWaterCoilLoad</span>
<a name="ln-5292"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span><span class="o">=</span><span class="n">SurfAreaWetFraction</span>
<a name="ln-5293"></a><span class="c">!       WaterCoil(CoilNum)%OutletWaterEnthalpy = WaterCoil(CoilNum)%InletWaterEnthalpy+ &amp;</span>
<a name="ln-5294"></a><span class="c">!                                WaterCoil(CoilNum)%TotWaterCoolingCoilRate/WaterCoil(CoilNum)%InletWaterMassFlowRate</span>
<a name="ln-5295"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span><span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5296"></a>                                <span class="n">SafeDivide</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="p">)</span>
<a name="ln-5297"></a>
<a name="ln-5298"></a>  <span class="k">ELSE</span>
<a name="ln-5299"></a>        <span class="c">!If both mass flow rates are zero, set outputs to inputs and return</span>
<a name="ln-5300"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span>
<a name="ln-5301"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>   <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span>
<a name="ln-5302"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-5303"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterEnthalpy</span>
<a name="ln-5304"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5305"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5306"></a>        <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFraction</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5307"></a>
<a name="ln-5308"></a>  <span class="n">ENDIF</span>  <span class="c">!End of the Flow or No flow If block</span>
<a name="ln-5309"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-5310"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-5311"></a>       <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-5312"></a>
<a name="ln-5313"></a>
<a name="ln-5314"></a>    <span class="k">RETURN</span>
<a name="ln-5315"></a><span class="k">End Subroutine </span><span class="n">CoolingCoil</span>
<a name="ln-5316"></a><span class="c">! End Algorithm Section of the Module</span>
<a name="ln-5317"></a>
<a name="ln-5318"></a>
<a name="ln-5319"></a><span class="c">! Coil Completely Dry Subroutine for Cooling Coil</span>
<a name="ln-5320"></a><span class="k">SUBROUTINE </span><span class="n">CoilCompletelyDry</span> <span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">WaterTempIn</span><span class="p">,</span> <span class="n">AirTempIn</span><span class="p">,</span><span class="n">CoilUA</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5321"></a>                                    <span class="n">OutletWaterTemp</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5322"></a>
<a name="ln-5323"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5324"></a>          <span class="c">! AUTHOR         Rahul Chillar</span>
<a name="ln-5325"></a>          <span class="c">! DATE WRITTEN   March 2004</span>
<a name="ln-5326"></a>          <span class="c">! MODIFIED       na</span>
<a name="ln-5327"></a>          <span class="c">! RE-ENGINEERED  na</span>
<a name="ln-5328"></a>
<a name="ln-5329"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5330"></a>          <span class="c">! Calculate the performance of a sensible air-liquid heat exchanger.  Calculated</span>
<a name="ln-5331"></a>          <span class="c">! results include outlet air temperature and humidity, outlet water temperature,</span>
<a name="ln-5332"></a>          <span class="c">! and heat transfer rate.</span>
<a name="ln-5333"></a>
<a name="ln-5334"></a>
<a name="ln-5335"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5336"></a>          <span class="c">! Models coil using effectiveness-NTU model.</span>
<a name="ln-5337"></a>
<a name="ln-5338"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5339"></a>          <span class="c">! Kays, W.M. and A.L. London.  1964,Compact Heat Exchangers, 2nd Edition,</span>
<a name="ln-5340"></a>          <span class="c">! New York: McGraw-Hill.</span>
<a name="ln-5341"></a>
<a name="ln-5342"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5343"></a>          <span class="c">! na</span>
<a name="ln-5344"></a>
<a name="ln-5345"></a>          <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5346"></a>       <span class="k">Implicit None</span>
<a name="ln-5347"></a>
<a name="ln-5348"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5349"></a>       <span class="kt">Integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>      <span class="c">!</span>
<a name="ln-5350"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WaterTempIn</span>  <span class="c">! Entering water temperature</span>
<a name="ln-5351"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirTempIn</span>    <span class="c">! Entering air dry bulb temperature</span>
<a name="ln-5352"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoilUA</span>       <span class="c">! Overall heat transfer coefficient</span>
<a name="ln-5353"></a>       <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>      <span class="c">! fan operating mode</span>
<a name="ln-5354"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>  <span class="c">! part-load ratio of heating coil</span>
<a name="ln-5355"></a>
<a name="ln-5356"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5357"></a>          <span class="c">! na</span>
<a name="ln-5358"></a>
<a name="ln-5359"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5360"></a>          <span class="c">! na</span>
<a name="ln-5361"></a>
<a name="ln-5362"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5363"></a>          <span class="c">! na</span>
<a name="ln-5364"></a>
<a name="ln-5365"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5366"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletWaterTemp</span>   <span class="c">! Leaving water temperature</span>
<a name="ln-5367"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirTemp</span>     <span class="c">! Leaving air dry bulb temperature</span>
<a name="ln-5368"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutletAirHumRat</span>   <span class="c">! Leaving air humidity ratio</span>
<a name="ln-5369"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Q</span>                 <span class="c">! Heat transfer rate</span>
<a name="ln-5370"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CapacitanceAir</span>    <span class="c">! Air-side capacity rate(W/C)</span>
<a name="ln-5371"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CapacitanceWater</span>  <span class="c">! Water-side capacity rate(W/C)</span>
<a name="ln-5372"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>
<a name="ln-5373"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRate</span>
<a name="ln-5374"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-5375"></a>
<a name="ln-5376"></a>       <span class="c">!  adjust mass flow rates for cycling fan cycling coil operation</span>
<a name="ln-5377"></a>       <span class="k">IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5378"></a><span class="k">         IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5379"></a><span class="k">           </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span>
<a name="ln-5380"></a>           <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5381"></a>                               <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span><span class="p">)</span>
<a name="ln-5382"></a>         <span class="k">ELSE</span>
<a name="ln-5383"></a><span class="k">           </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5384"></a>           <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5385"></a>         <span class="k">END IF</span>
<a name="ln-5386"></a><span class="k">       ELSE</span>
<a name="ln-5387"></a><span class="k">         </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-5388"></a>         <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-5389"></a>       <span class="k">END IF</span>
<a name="ln-5390"></a>
<a name="ln-5391"></a>        <span class="c">! Calculate air and water capacity rates</span>
<a name="ln-5392"></a>      <span class="n">CapacitanceAir</span> <span class="o">=</span> <span class="n">AirMassFlow</span><span class="o">*</span>    <span class="p">&amp;</span>
<a name="ln-5393"></a>                              <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span><span class="p">)</span>
<a name="ln-5394"></a>        <span class="c">! Water Capacity Rate</span>
<a name="ln-5395"></a>      <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5396"></a>                               <span class="n">WaterTempIn</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-5397"></a>                              <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5398"></a>                              <span class="s1">&#39;CoilCompletelyDry&#39;</span><span class="p">)</span>
<a name="ln-5399"></a>
<a name="ln-5400"></a>      <span class="n">CapacitanceWater</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span><span class="o">*</span> <span class="n">Cp</span>
<a name="ln-5401"></a>
<a name="ln-5402"></a>        <span class="c">! Determine the air and water outlet conditions</span>
<a name="ln-5403"></a>      <span class="k">CALL </span><span class="n">CoilOutletStreamCondition</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">CapacitanceWater</span><span class="p">,</span><span class="n">WaterTempIn</span><span class="p">,</span><span class="n">CapacitanceAir</span><span class="p">,</span><span class="n">AirTempIn</span><span class="p">,</span><span class="n">CoilUA</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5404"></a>                                <span class="n">OutletWaterTemp</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">)</span>
<a name="ln-5405"></a>
<a name="ln-5406"></a>        <span class="c">! Calculate the total and sensible heat transfer rate both are equal in case of Dry Coil</span>
<a name="ln-5407"></a>      <span class="n">Q</span><span class="o">=</span><span class="n">CapacitanceAir</span><span class="o">*</span><span class="p">(</span><span class="n">AirTempIn</span><span class="o">-</span><span class="n">OutletAirTemp</span><span class="p">)</span>
<a name="ln-5408"></a>
<a name="ln-5409"></a>        <span class="c">! Outlet humidity is equal to Inlet Humidity because its a dry coil</span>
<a name="ln-5410"></a>      <span class="n">OutletAirHumRat</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-5411"></a>
<a name="ln-5412"></a>  <span class="k">RETURN</span>
<a name="ln-5413"></a><span class="k">END SUBROUTINE  </span><span class="n">CoilCompletelyDry</span>
<a name="ln-5414"></a>
<a name="ln-5415"></a>
<a name="ln-5416"></a>
<a name="ln-5417"></a><span class="c">! Coil Completely Wet Subroutine for Cooling Coil</span>
<a name="ln-5418"></a><span class="k">SUBROUTINE </span><span class="n">CoilCompletelyWet</span> <span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">WaterTempIn</span><span class="p">,</span> <span class="n">AirTempIn</span><span class="p">,</span><span class="n">AirHumRat</span><span class="p">,</span><span class="n">UAInternalTotal</span><span class="p">,</span><span class="n">UAExternalTotal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5419"></a>                                   <span class="n">OutletWaterTemp</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">TotWaterCoilLoad</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-5420"></a>                                   <span class="n">SenWaterCoilLoad</span><span class="p">,</span><span class="n">SurfAreaWetFraction</span><span class="p">,</span><span class="n">AirInletCoilSurfTemp</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5421"></a>
<a name="ln-5422"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5423"></a>          <span class="c">! AUTHOR         Rahul Chillar</span>
<a name="ln-5424"></a>          <span class="c">! DATE WRITTEN   Mar 2004</span>
<a name="ln-5425"></a>          <span class="c">! MODIFIED       na</span>
<a name="ln-5426"></a>          <span class="c">! RE-ENGINEERED  na</span>
<a name="ln-5427"></a>
<a name="ln-5428"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5429"></a>          <span class="c">! Calculate the performance of a cooling coil when the external fin surface is</span>
<a name="ln-5430"></a>          <span class="c">! complete wet.  Results include outlet air temperature and humidity,</span>
<a name="ln-5431"></a>          <span class="c">! outlet water temperature, sensible and total cooling capacities, and the wet</span>
<a name="ln-5432"></a>          <span class="c">! fraction of the air-side surface area.</span>
<a name="ln-5433"></a>
<a name="ln-5434"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5435"></a>          <span class="c">! Models coil as counterflow heat exchanger. Approximates saturated air enthalpy as</span>
<a name="ln-5436"></a>          <span class="c">! a linear function of temperature</span>
<a name="ln-5437"></a>          <span class="c">! TRNSYS.  1990.  A Transient System Simulation Program: Reference Manual.</span>
<a name="ln-5438"></a>          <span class="c">! Solar Energy Laboratory, Univ. Wisconsin Madison, pp. 4.6.8-1 - 4.6.8-12.</span>
<a name="ln-5439"></a>          <span class="c">! Threlkeld, J.L.  1970.  Thermal Environmental Engineering, 2nd Edition,</span>
<a name="ln-5440"></a>          <span class="c">! Englewood Cliffs: Prentice-Hall,Inc. pp. 254-270.</span>
<a name="ln-5441"></a>          <span class="c">! Coil Uses Enthalpy Based Heat Transfer Coefficents and converts them to</span>
<a name="ln-5442"></a>          <span class="c">! convential UA values. Intermediate value of fictitious Cp is defined. This follow</span>
<a name="ln-5443"></a>          <span class="c">! the same procedure followed in the Design Calculation of the Coil. See the node in</span>
<a name="ln-5444"></a>          <span class="c">! the one time calculation for design condition.</span>
<a name="ln-5445"></a>
<a name="ln-5446"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5447"></a>          <span class="c">! Elmahdy, A.H. and Mitalas, G.P.  1977.&quot;A Simple Model for Cooling and</span>
<a name="ln-5448"></a>          <span class="c">! Dehumidifying Coils for Use In Calculating Energy Requirements for Buildings,&quot;</span>
<a name="ln-5449"></a>          <span class="c">! ASHRAE Transactions,Vol.83 Part 2, pp. 103-117.</span>
<a name="ln-5450"></a>
<a name="ln-5451"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5452"></a>
<a name="ln-5453"></a>          <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5454"></a>      <span class="k">Implicit None</span>
<a name="ln-5455"></a>
<a name="ln-5456"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5457"></a>      <span class="kt">Integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>          <span class="c">! Number of Coil</span>
<a name="ln-5458"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterTempIn</span>         <span class="c">! Water temperature IN to this function (C)</span>
<a name="ln-5459"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirTempIn</span>           <span class="c">! Air dry bulb temperature IN to this function(C)</span>
<a name="ln-5460"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirHumRat</span>           <span class="c">! Air Humidity Ratio IN to this funcation (C)</span>
<a name="ln-5461"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAInternalTotal</span>     <span class="c">! Internal overall heat transfer coefficient(W/m2 C)</span>
<a name="ln-5462"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UAExternalTotal</span>     <span class="c">! External overall heat transfer coefficient(W/m2 C)</span>
<a name="ln-5463"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span>  <span class="n">OutletWaterTemp</span>       <span class="c">! Leaving water temperature (C)</span>
<a name="ln-5464"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span>  <span class="n">OutletAirTemp</span>         <span class="c">! Leaving air dry bulb temperature(C)</span>
<a name="ln-5465"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span>  <span class="n">OutletAirHumRat</span>       <span class="c">! Leaving air humidity ratio</span>
<a name="ln-5466"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span>  <span class="n">TotWaterCoilLoad</span>      <span class="c">! Total heat transfer rate(W)</span>
<a name="ln-5467"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span>  <span class="n">SenWaterCoilLoad</span>      <span class="c">! Sensible heat transfer rate(W)</span>
<a name="ln-5468"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span>  <span class="n">AirInletCoilSurfTemp</span>  <span class="c">! Surface temperature at air entrance(C)</span>
<a name="ln-5469"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>     <span class="kd">::</span>  <span class="n">SurfAreaWetFraction</span>   <span class="c">! Fraction of surface area wet</span>
<a name="ln-5470"></a>      <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>      <span class="c">! fan operating mode</span>
<a name="ln-5471"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>  <span class="c">! part-load ratio of heating coil</span>
<a name="ln-5472"></a>
<a name="ln-5473"></a>
<a name="ln-5474"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5475"></a>          <span class="c">! na</span>
<a name="ln-5476"></a>
<a name="ln-5477"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5478"></a>          <span class="c">! na</span>
<a name="ln-5479"></a>
<a name="ln-5480"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5481"></a>          <span class="c">! na</span>
<a name="ln-5482"></a>
<a name="ln-5483"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5484"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">AirSideResist</span>                    <span class="c">! Air-side resistance to heat transfer(m2 C/W)</span>
<a name="ln-5485"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WaterSideResist</span>                  <span class="c">! Liquid-side resistance to heat transfer(m2 C/W)</span>
<a name="ln-5486"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnteringAirDewPt</span>                 <span class="c">! Entering air dew point(C)</span>
<a name="ln-5487"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">UACoilTotalEnth</span>                  <span class="c">! Overall enthalpy heat transfer coefficient(kg/s)</span>
<a name="ln-5488"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CapacityRateAirWet</span>               <span class="c">! Air-side capacity rate(kg/s)</span>
<a name="ln-5489"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CapacityRateWaterWet</span>             <span class="c">! Liquid-side capacity rate(kg/s)</span>
<a name="ln-5490"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ResistRatio</span>                      <span class="c">! Ratio of resistances</span>
<a name="ln-5491"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnthAirOutlet</span>                    <span class="c">! Outlet air enthalpy</span>
<a name="ln-5492"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnthSatAirInletWaterTemp</span>         <span class="c">! Saturated enthalpy of air at entering water temperature(J/kg)</span>
<a name="ln-5493"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnthSatAirOutletWaterTemp</span>        <span class="c">! Saturated enthalpy of air at exit water temperature(J/kg)</span>
<a name="ln-5494"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnthSatAirCoilSurfaceEntryTemp</span>   <span class="c">! Saturated enthalpy of air at entering surface temperature(J/kg)</span>
<a name="ln-5495"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnthSatAirCoilSurfaceExitTemp</span>    <span class="c">! Saturated enthalpy of air at exit surface temperature(J/kg)</span>
<a name="ln-5496"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnthAirInlet</span>                     <span class="c">! Enthalpy of air at inlet</span>
<a name="ln-5497"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">IntermediateCpSat</span>                <span class="c">! Coefficient for equation below(J/kg C)</span>
<a name="ln-5498"></a>                                            <span class="c">! EnthSat1-EnthSat2 = IntermediateCpSat*(TSat1-TSat2)</span>
<a name="ln-5499"></a>                                            <span class="c">! (all water and surface temperatures are</span>
<a name="ln-5500"></a>                                            <span class="c">! related to saturated air enthalpies for</span>
<a name="ln-5501"></a>                                            <span class="c">! wet surface heat transfer calculations)</span>
<a name="ln-5502"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">Parameter</span><span class="kd">::</span><span class="n">SmallNo</span> <span class="o">=</span> <span class="mf">1.d-9</span>       <span class="c">! smallNo used in place of 0</span>
<a name="ln-5503"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlow</span>
<a name="ln-5504"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterMassFlowRate</span>
<a name="ln-5505"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-5506"></a>
<a name="ln-5507"></a>      <span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-5508"></a>      <span class="n">AirSideResist</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">/</span><span class="nb">MAX</span><span class="p">(</span><span class="n">UAExternalTotal</span><span class="p">,</span><span class="n">SmallNo</span><span class="p">)</span>
<a name="ln-5509"></a>      <span class="n">WaterSideResist</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">/</span><span class="nb">MAX</span><span class="p">(</span><span class="n">UAInternalTotal</span><span class="p">,</span><span class="n">SmallNo</span><span class="p">)</span>
<a name="ln-5510"></a>
<a name="ln-5511"></a>      <span class="c">!  adjust mass flow rates for cycling fan cycling coil operation</span>
<a name="ln-5512"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">FanOpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5513"></a><span class="k">          IF</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5514"></a><span class="k">            </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span>
<a name="ln-5515"></a>            <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="o">/</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5516"></a>                                    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">MaxWaterMassFlowRate</span><span class="p">)</span>
<a name="ln-5517"></a>          <span class="k">ELSE</span>
<a name="ln-5518"></a><span class="k">            </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5519"></a>            <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5520"></a>          <span class="k">END IF</span>
<a name="ln-5521"></a><span class="k">        ELSE</span>
<a name="ln-5522"></a><span class="k">          </span><span class="n">AirMassFlow</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span>
<a name="ln-5523"></a>          <span class="n">WaterMassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span>
<a name="ln-5524"></a>        <span class="k">END IF</span>
<a name="ln-5525"></a>
<a name="ln-5526"></a>         <span class="c">! Calculate enthalpies of entering air and water</span>
<a name="ln-5527"></a>
<a name="ln-5528"></a>         <span class="c">! Enthalpy of air at inlet to the coil</span>
<a name="ln-5529"></a>      <span class="n">EnthAirInlet</span><span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">AirTempIn</span><span class="p">,</span><span class="n">AirHumRat</span> <span class="p">)</span>
<a name="ln-5530"></a>
<a name="ln-5531"></a>         <span class="c">! Saturation Enthalpy of Air at inlet water temperature</span>
<a name="ln-5532"></a>      <span class="n">EnthSatAirInletWaterTemp</span><span class="o">=</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">WaterTempIn</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">WaterTempIn</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span>
<a name="ln-5533"></a>
<a name="ln-5534"></a>         <span class="c">! Estimate IntermediateCpSat using entering air dewpoint and water temperature</span>
<a name="ln-5535"></a>      <span class="n">EnteringAirDewPt</span> <span class="o">=</span> <span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">AirHumRat</span> <span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-5536"></a>
<a name="ln-5537"></a>         <span class="c">! An intermediate value of Specific heat . EnthSat1-EnthSat2 = IntermediateCpSat*(TSat1-TSat2)</span>
<a name="ln-5538"></a>      <span class="n">IntermediateCpSat</span><span class="o">=</span><span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EnteringAirDewPt</span><span class="p">,</span><span class="n">PsyWFnTdpPb</span><span class="p">(</span><span class="n">EnteringAirDewPt</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">))</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5539"></a>                                                            <span class="n">EnthSatAirInletWaterTemp</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">EnteringAirDewPt</span><span class="o">-</span><span class="n">WaterTempIn</span><span class="p">)</span>
<a name="ln-5540"></a>
<a name="ln-5541"></a>         <span class="c">! Determine air and water enthalpy outlet conditions by modeling</span>
<a name="ln-5542"></a>         <span class="c">! coil as counterflow enthalpy heat exchanger</span>
<a name="ln-5543"></a>       <span class="n">UACoilTotalEnth</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">/</span><span class="p">(</span><span class="n">IntermediateCpSat</span><span class="o">*</span><span class="n">WaterSideResist</span><span class="o">+</span><span class="n">AirSideResist</span><span class="o">*</span><span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">AirTempIn</span><span class="p">))</span>
<a name="ln-5544"></a>       <span class="n">CapacityRateAirWet</span> <span class="o">=</span> <span class="n">AirMassFlow</span>
<a name="ln-5545"></a>       <span class="n">Cp</span> <span class="o">=</span>  <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5546"></a>                                  <span class="n">WaterTempIn</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-5547"></a>                                  <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5548"></a>                                  <span class="s1">&#39;CoilCompletelyWet&#39;</span><span class="p">)</span>
<a name="ln-5549"></a>       <span class="n">CapacityRateWaterWet</span> <span class="o">=</span> <span class="n">WaterMassFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">Cp</span><span class="o">/</span><span class="n">IntermediateCpSat</span><span class="p">)</span>
<a name="ln-5550"></a>       <span class="k">CALL </span><span class="n">CoilOutletStreamCondition</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">CapacityRateAirWet</span><span class="p">,</span><span class="n">EnthAirInlet</span><span class="p">,</span><span class="n">CapacityRateWaterWet</span><span class="p">,</span><span class="n">EnthSatAirInletWaterTemp</span><span class="p">,&amp;</span>
<a name="ln-5551"></a>                                      <span class="n">UACoilTotalEnth</span><span class="p">,</span><span class="n">EnthAirOutlet</span><span class="p">,</span><span class="n">EnthSatAirOutletWaterTemp</span><span class="p">)</span>
<a name="ln-5552"></a>
<a name="ln-5553"></a>         <span class="c">! Calculate entering and leaving external surface conditions from</span>
<a name="ln-5554"></a>         <span class="c">! air and water conditions and the ratio of resistances</span>
<a name="ln-5555"></a>       <span class="n">ResistRatio</span><span class="o">=</span><span class="p">(</span><span class="n">WaterSideResist</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">WaterSideResist</span><span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-5556"></a>                                      <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">AirTempIn</span><span class="p">)</span><span class="o">/</span><span class="n">IntermediateCpSat</span><span class="o">*</span><span class="n">AirSideResist</span><span class="p">)</span>
<a name="ln-5557"></a>       <span class="n">EnthSatAirCoilSurfaceEntryTemp</span> <span class="o">=</span> <span class="n">EnthSatAirOutletWaterTemp</span> <span class="o">+</span> <span class="n">ResistRatio</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5558"></a>                                               <span class="p">(</span><span class="n">EnthAirInlet</span><span class="o">-</span><span class="n">EnthSatAirOutletWaterTemp</span><span class="p">)</span>
<a name="ln-5559"></a>       <span class="n">EnthSatAirCoilSurfaceExitTemp</span> <span class="o">=</span> <span class="n">EnthSatAirInletWaterTemp</span> <span class="o">+</span> <span class="n">ResistRatio</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5560"></a>                                               <span class="p">(</span><span class="n">EnthAirOutlet</span><span class="o">-</span><span class="n">EnthSatAirInletWaterTemp</span><span class="p">)</span>
<a name="ln-5561"></a>
<a name="ln-5562"></a>         <span class="c">! Calculate Coil Surface Temperature at air entry to the coil</span>
<a name="ln-5563"></a>        <span class="n">AirInletCoilSurfTemp</span><span class="o">=</span>  <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EnthSatAirCoilSurfaceEntryTemp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-5564"></a>
<a name="ln-5565"></a>         <span class="c">! Calculate outlet air temperature and humidity from enthalpies and surface conditions.</span>
<a name="ln-5566"></a>       <span class="n">TotWaterCoilLoad</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">EnthAirInlet</span><span class="o">-</span><span class="n">EnthAirOutlet</span><span class="p">)</span>
<a name="ln-5567"></a>       <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">WaterTempIn</span><span class="o">+</span><span class="n">TotWaterCoilLoad</span><span class="o">/</span><span class="nb">MAX</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterMassFlowRate</span><span class="p">,</span><span class="n">SmallNo</span><span class="p">)</span><span class="o">/</span><span class="n">Cp</span>
<a name="ln-5568"></a>
<a name="ln-5569"></a>         <span class="c">! Calculates out put variable for  the completely wet coil</span>
<a name="ln-5570"></a>       <span class="k">CALL </span><span class="n">WetCoilOutletCondition</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">AirTempIn</span> <span class="p">,</span><span class="n">EnthAirInlet</span><span class="p">,</span><span class="n">EnthAirOutlet</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5571"></a>                     <span class="n">UAExternalTotal</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">SenWaterCoilLoad</span><span class="p">)</span>
<a name="ln-5572"></a>
<a name="ln-5573"></a>
<a name="ln-5574"></a><span class="mi">999</span>   <span class="k">RETURN</span>
<a name="ln-5575"></a><span class="k">END SUBROUTINE </span><span class="n">CoilCompletelyWet</span>
<a name="ln-5576"></a>
<a name="ln-5577"></a>
<a name="ln-5578"></a><span class="c">! Coil Part Wet Part Dry Subroutine for Cooling Coil</span>
<a name="ln-5579"></a><span class="k">SUBROUTINE </span><span class="n">CoilPartWetPartDry</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">InletWaterTemp</span><span class="p">,</span> <span class="n">InletAirTemp</span><span class="p">,</span> <span class="n">AirDewPointTemp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5580"></a>                              <span class="n">OutletWaterTemp</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">TotWaterCoilLoad</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-5581"></a>                              <span class="n">SenWaterCoilLoad</span><span class="p">,</span><span class="n">SurfAreaWetFraction</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5582"></a>
<a name="ln-5583"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5584"></a>          <span class="c">! AUTHOR         Rahul Chillar</span>
<a name="ln-5585"></a>          <span class="c">! DATE WRITTEN   March 2004</span>
<a name="ln-5586"></a>          <span class="c">! MODIFIED       na</span>
<a name="ln-5587"></a>          <span class="c">! RE-ENGINEERED  na</span>
<a name="ln-5588"></a>
<a name="ln-5589"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5590"></a>          <span class="c">! Calculate the performance of a cooling  coil when the external fin surface is</span>
<a name="ln-5591"></a>          <span class="c">! part wet and part dry.  Results include outlet air temperature and humidity,</span>
<a name="ln-5592"></a>          <span class="c">! outlet liquid temperature, sensible and total cooling capacities, and the wet</span>
<a name="ln-5593"></a>          <span class="c">! fraction of the air-side surface area.</span>
<a name="ln-5594"></a>
<a name="ln-5595"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5596"></a>          <span class="c">! Models coil using effectiveness NTU model</span>
<a name="ln-5597"></a>
<a name="ln-5598"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5599"></a>          <span class="c">! Elmahdy, A.H. and Mitalas, G.P.  1977. &quot;A Simple Model for Cooling and</span>
<a name="ln-5600"></a>          <span class="c">! Dehumidifying Coils for Use In Calculating Energy Requirements for Buildings,&quot;</span>
<a name="ln-5601"></a>          <span class="c">! ASHRAE Transactions,Vol.83 Part 2, pp. 103-117.</span>
<a name="ln-5602"></a>          <span class="c">! TRNSYS.  1990.  A Transient System Simulation Program: Reference Manual.</span>
<a name="ln-5603"></a>          <span class="c">! Solar Energy Laboratory, Univ. Wisconsin- Madison, pp. 4.6.8-1 - 4.6.8-12.</span>
<a name="ln-5604"></a>          <span class="c">! Threlkeld, J.L.  1970.  Thermal Environmental Engineering, 2nd Edition,</span>
<a name="ln-5605"></a>          <span class="c">! Englewood Cliffs: Prentice-Hall,Inc. pp. 254-270.</span>
<a name="ln-5606"></a>
<a name="ln-5607"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5608"></a>      <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Iterate</span>
<a name="ln-5609"></a>
<a name="ln-5610"></a>          <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5611"></a>      <span class="k">Implicit None</span>
<a name="ln-5612"></a>
<a name="ln-5613"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5614"></a>      <span class="kt">Integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>                <span class="c">! Number of Coil</span>
<a name="ln-5615"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletWaterTemp</span>         <span class="c">! Entering liquid temperature(C)</span>
<a name="ln-5616"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InletAirTemp</span>           <span class="c">! Entering air dry bulb temperature(C)</span>
<a name="ln-5617"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirDewPointTemp</span>        <span class="c">! Entering air dew point(C)</span>
<a name="ln-5618"></a>      <span class="kt">Logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>     <span class="c">! Saving Old values</span>
<a name="ln-5619"></a>      <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>      <span class="c">! fan operating mode</span>
<a name="ln-5620"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>  <span class="c">! part-load ratio of heating coil</span>
<a name="ln-5621"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletWaterTemp</span>        <span class="c">! Leaving liquid temperature(C)</span>
<a name="ln-5622"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletAirTemp</span>          <span class="c">! Leaving air dry bulb temperature(C)</span>
<a name="ln-5623"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">OutletAirHumRat</span>        <span class="c">! Leaving air humidity ratio</span>
<a name="ln-5624"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TotWaterCoilLoad</span>       <span class="c">! Total heat transfer rate (W)</span>
<a name="ln-5625"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SenWaterCoilLoad</span>       <span class="c">! Sensible heat transfer rate (W)</span>
<a name="ln-5626"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SurfAreaWetFraction</span>    <span class="c">! Fraction of surface area wet</span>
<a name="ln-5627"></a>
<a name="ln-5628"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5629"></a>      <span class="kt">Integer</span><span class="p">,</span> <span class="k">Parameter</span><span class="kd">::</span> <span class="n">itmax</span> <span class="o">=</span> <span class="mi">60</span>
<a name="ln-5630"></a>      <span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">smalltempdiff</span><span class="o">=</span><span class="mf">1.0d-9</span>
<a name="ln-5631"></a>
<a name="ln-5632"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5633"></a>          <span class="c">! na</span>
<a name="ln-5634"></a>
<a name="ln-5635"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5636"></a>          <span class="c">! na</span>
<a name="ln-5637"></a>
<a name="ln-5638"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5639"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DryCoilHeatTranfer</span>              <span class="c">! Heat transfer rate for dry coil(W)</span>
<a name="ln-5640"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WetCoilTotalHeatTransfer</span>        <span class="c">! Total heat transfer rate for wet coil(W)</span>
<a name="ln-5641"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WetCoilSensibleHeatTransfer</span>     <span class="c">! Sensible heat transfer rate for wet coil(W)</span>
<a name="ln-5642"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfAreaWet</span>                     <span class="c">! Air-side area of wet coil(m2)</span>
<a name="ln-5643"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfAreaDry</span>                     <span class="c">! Air-side area of dry coil(m2)</span>
<a name="ln-5644"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DryCoilUA</span>                       <span class="c">! Overall heat transfer coefficient for dry coil(W/C)</span>
<a name="ln-5645"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WetDryInterfcWaterTemp</span>          <span class="c">! Liquid temperature at wet/dry boundary(C)</span>
<a name="ln-5646"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WetDryInterfcAirTemp</span>            <span class="c">! Air temperature at wet/dry boundary(C)</span>
<a name="ln-5647"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WetDryInterfcSurfTemp</span>           <span class="c">! Surface temperature at wet/dry boundary(C)</span>
<a name="ln-5648"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EstimateWetDryInterfcWaterTemp</span>  <span class="c">! Estimated liquid temperature at wet/dry boundary(C)</span>
<a name="ln-5649"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EstimateSurfAreaWetFraction</span>     <span class="c">! Initial Estimate for Fraction of Surface Wet with condensation</span>
<a name="ln-5650"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WetPartUAInternal</span>               <span class="c">! UA of Wet Coil Internal</span>
<a name="ln-5651"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WetPartUAExternal</span>               <span class="c">! UA of Dry Coil External</span>
<a name="ln-5652"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">WetDryInterfcHumRat</span>             <span class="c">! Humidity Ratio at interface of the wet dry transition</span>
<a name="ln-5653"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">X1T</span>                             <span class="c">! Variables used in the two iteration in this subroutine.</span>
<a name="ln-5654"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">NewSurfAreaWetFrac</span>              <span class="c">! Variables used in the two iteration in this subroutine.</span>
<a name="ln-5655"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ResultXT</span>                        <span class="c">! Variables used in the two iteration in this subroutine.</span>
<a name="ln-5656"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Y1T</span>                             <span class="c">! Variables used in the two iterations in this subroutine.</span>
<a name="ln-5657"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">errorT</span>                          <span class="c">! Error in interation for First If loop</span>
<a name="ln-5658"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">error</span>                           <span class="c">! Deviation of dependent variable in iteration</span>
<a name="ln-5659"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfAreaFracPrevious</span><span class="p">,</span> <span class="n">ErrorPrevious</span><span class="p">,</span><span class="n">SurfAreaFracLast</span><span class="p">,</span><span class="n">ErrorLast</span>
<a name="ln-5660"></a>      <span class="kt">Integer </span><span class="n">iter</span>     <span class="c">! Iteration counter</span>
<a name="ln-5661"></a>      <span class="kt">Integer </span><span class="n">icvg</span>     <span class="c">! Iteration convergence flag</span>
<a name="ln-5662"></a>      <span class="kt">INTEGER </span><span class="n">icvgT</span>    <span class="c">! Iteration Convergence Flag for First If loop</span>
<a name="ln-5663"></a>      <span class="kt">INTEGER </span><span class="n">itT</span>      <span class="c">! Iteration Counter for First If Loop</span>
<a name="ln-5664"></a>
<a name="ln-5665"></a>        <span class="c">! Iterates on SurfAreaWetFraction to converge on surface temperature equal to</span>
<a name="ln-5666"></a>        <span class="c">! entering air dewpoint at wet/dry boundary.</span>
<a name="ln-5667"></a>
<a name="ln-5668"></a>        <span class="c">! Preliminary estimates of coil performance to begin iteration</span>
<a name="ln-5669"></a>      <span class="n">OutletWaterTemp</span> <span class="o">=</span> <span class="n">InletAirTemp</span>
<a name="ln-5670"></a>      <span class="n">DryCoilHeatTranfer</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5671"></a>      <span class="n">WetCoilTotalHeatTransfer</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5672"></a>      <span class="n">WetCoilSensibleHeatTransfer</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5673"></a>
<a name="ln-5674"></a>      <span class="k">If</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">Then</span>
<a name="ln-5675"></a>         <span class="c">! Estimate liquid temperature at boundary as entering air dew point</span>
<a name="ln-5676"></a>         <span class="n">WetDryInterfcWaterTemp</span> <span class="o">=</span> <span class="n">AirDewPointTemp</span>
<a name="ln-5677"></a>
<a name="ln-5678"></a>         <span class="c">! Estimate fraction wet surface area based on liquid temperatures</span>
<a name="ln-5679"></a>         <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">OutletWaterTemp</span><span class="o">-</span><span class="n">InletWaterTemp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">smalltempdiff</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-5680"></a><span class="k">           </span><span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">WetDryInterfcWaterTemp</span><span class="o">-</span><span class="n">InletWaterTemp</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">OutletWaterTemp</span><span class="o">-</span><span class="n">InletWaterTemp</span><span class="p">)</span>
<a name="ln-5681"></a>         <span class="k">ELSE</span>
<a name="ln-5682"></a><span class="k">           </span><span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5683"></a>         <span class="n">ENDIF</span>
<a name="ln-5684"></a>
<a name="ln-5685"></a>      <span class="k">Else</span>
<a name="ln-5686"></a><span class="k">         </span><span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFractionSaved</span>
<a name="ln-5687"></a>
<a name="ln-5688"></a>      <span class="k">End IF</span>
<a name="ln-5689"></a>       <span class="c">! BEGIN LOOP to converge on SurfAreaWetFraction</span>
<a name="ln-5690"></a>       <span class="c">! The method employed in this loop is as follows: The coil is partially wet and partially dry,</span>
<a name="ln-5691"></a>       <span class="c">! we calculate the temperature of the coil at the interface, (the point at which the moisture begins</span>
<a name="ln-5692"></a>       <span class="c">! to condense) temperature of the  water  at interface and air temp is dew point at that location.</span>
<a name="ln-5693"></a>       <span class="c">! This is done by Iterating between the Completely Dry and Completely Wet Coil until the outlet</span>
<a name="ln-5694"></a>       <span class="c">! water temperature of one coil equals the inlet water temperature of another.</span>
<a name="ln-5695"></a>       <span class="c">! Using this value of interface temperature we now iterate to calculate Surface Fraction Wet, Iterate</span>
<a name="ln-5696"></a>       <span class="c">! function perturbs the value of Surface Fraction Wet and based on this new value the entire loop is</span>
<a name="ln-5697"></a>       <span class="c">! repeated to get a new interface water temperature and then surface fraction wet is again calculated.</span>
<a name="ln-5698"></a>       <span class="c">! This process continues till the error between the Wet Dry Interface Temp and Air Dew Point becomes</span>
<a name="ln-5699"></a>       <span class="c">! very negligible and in 95% of the cases its is a complete convergence to give the exact surface Wet</span>
<a name="ln-5700"></a>       <span class="c">! fraction.</span>
<a name="ln-5701"></a>     <span class="n">NewSurfAreaWetFrac</span><span class="o">=</span><span class="n">SurfAreaWetFraction</span>
<a name="ln-5702"></a>     <span class="n">error</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5703"></a>     <span class="n">SurfAreaFracPrevious</span><span class="o">=</span><span class="n">SurfAreaWetFraction</span>
<a name="ln-5704"></a>     <span class="n">ErrorPrevious</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5705"></a>     <span class="n">SurfAreaFracLast</span><span class="o">=</span><span class="n">SurfAreaWetFraction</span>
<a name="ln-5706"></a>     <span class="n">ErrorLast</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5707"></a>
<a name="ln-5708"></a>     <span class="k">DO </span><span class="n">iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">itmax</span>
<a name="ln-5709"></a>
<a name="ln-5710"></a>           <span class="c">! Calculating Surface Area Wet and Surface Area Dry</span>
<a name="ln-5711"></a>        <span class="n">SurfAreaWet</span> <span class="o">=</span> <span class="n">SurfAreaWetFraction</span><span class="o">*</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-5712"></a>        <span class="n">SurfAreaDry</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span><span class="o">-</span><span class="n">SurfAreaWet</span>
<a name="ln-5713"></a>
<a name="ln-5714"></a>           <span class="c">! Calculating UA values for the Dry Part of the Coil</span>
<a name="ln-5715"></a>        <span class="n">DryCoilUA</span> <span class="o">=</span> <span class="n">SurfAreaDry</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalPerUnitArea</span><span class="o">+</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UADryExtPerUnitArea</span><span class="p">)</span>
<a name="ln-5716"></a>
<a name="ln-5717"></a>           <span class="c">! Calculating UA Value for the Wet part of the Coil</span>
<a name="ln-5718"></a>        <span class="n">WetPartUAExternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span><span class="o">*</span><span class="n">SurfAreaWet</span>
<a name="ln-5719"></a>        <span class="n">WetPartUAInternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalPerUnitArea</span><span class="o">*</span><span class="n">SurfAreaWet</span>
<a name="ln-5720"></a>
<a name="ln-5721"></a>           <span class="c">! Calculating Water Temperature at Wet Dry Interface of the coil</span>
<a name="ln-5722"></a>        <span class="n">WetDryInterfcWaterTemp</span> <span class="o">=</span> <span class="n">InletWaterTemp</span><span class="o">+</span><span class="n">SurfAreaWetFraction</span><span class="o">*</span><span class="p">(</span><span class="n">OutletWaterTemp</span><span class="o">-</span><span class="n">InletWaterTemp</span><span class="p">)</span>
<a name="ln-5723"></a>
<a name="ln-5724"></a>           <span class="c">! BEGIN LOOP to converge on liquid temperature at wet/dry boundary</span>
<a name="ln-5725"></a>        <span class="k">DO </span><span class="n">itT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">itmax</span>
<a name="ln-5726"></a>
<a name="ln-5727"></a>           <span class="c">! Calculate dry coil performance with estimated liquid temperature at the boundary.</span>
<a name="ln-5728"></a>          <span class="k">CALL </span><span class="n">CoilCompletelyDry</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">WetDryInterfcWaterTemp</span><span class="p">,</span> <span class="n">InletAirTemp</span><span class="p">,</span><span class="n">DryCoilUA</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5729"></a>                                 <span class="n">OutletWaterTemp</span><span class="p">,</span><span class="n">WetDryInterfcAirTemp</span><span class="p">,</span><span class="n">WetDryInterfcHumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5730"></a>                                 <span class="n">DryCoilHeatTranfer</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5731"></a>
<a name="ln-5732"></a>           <span class="c">! Calculate wet coil performance with calculated air temperature at the boundary.</span>
<a name="ln-5733"></a>          <span class="k">CALL </span><span class="n">CoilCompletelyWet</span> <span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">InletWaterTemp</span><span class="p">,</span><span class="n">WetDryInterfcAirTemp</span><span class="p">,</span><span class="n">WetDryInterfcHumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5734"></a>                                  <span class="n">WetPartUAInternal</span><span class="p">,</span><span class="n">WetPartUAExternal</span><span class="p">,</span>                             <span class="p">&amp;</span>
<a name="ln-5735"></a>                                  <span class="n">EstimateWetDryInterfcWaterTemp</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-5736"></a>                                  <span class="n">WetCoilTotalHeatTransfer</span><span class="p">,</span><span class="n">WetCoilSensibleHeatTransfer</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-5737"></a>                                  <span class="n">EstimateSurfAreaWetFraction</span><span class="p">,</span><span class="n">WetDryInterfcSurfTemp</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5738"></a>
<a name="ln-5739"></a>              <span class="c">! Iterating to calculate the actual wet dry interface water temperature.</span>
<a name="ln-5740"></a>            <span class="n">errorT</span> <span class="o">=</span> <span class="n">EstimateWetDryInterfcWaterTemp</span> <span class="o">-</span> <span class="n">WetDryInterfcWaterTemp</span>
<a name="ln-5741"></a>          <span class="k">Call </span><span class="n">ITERATE</span> <span class="p">(</span><span class="n">ResultXT</span><span class="p">,</span><span class="mf">0.001d0</span><span class="p">,</span> <span class="n">WetDryInterfcWaterTemp</span><span class="p">,</span><span class="n">errorT</span><span class="p">,</span><span class="n">X1T</span><span class="p">,</span><span class="n">Y1T</span><span class="p">,</span><span class="n">itT</span><span class="p">,</span><span class="n">icvgT</span><span class="p">)</span>
<a name="ln-5742"></a>            <span class="n">WetDryInterfcWaterTemp</span> <span class="o">=</span> <span class="n">ResultXT</span>
<a name="ln-5743"></a>
<a name="ln-5744"></a>            <span class="c">! IF convergence is achieved then exit the itT to itmax Do loop.</span>
<a name="ln-5745"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">icvgT</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Exit</span>
<a name="ln-5746"></a>
<a name="ln-5747"></a><span class="k">        End Do</span>  <span class="c">! End Do for Liq Boundary temp Convergence</span>
<a name="ln-5748"></a>
<a name="ln-5749"></a>          <span class="c">! Wet Dry Interface temperature not converged after maximum specified iterations.</span>
<a name="ln-5750"></a>          <span class="c">! Print error message, set return error flag</span>
<a name="ln-5751"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">itT</span> <span class="o">&gt;</span> <span class="n">itmax</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">WarmUpFlag</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5752"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;For Coil:Cooling:Water &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5753"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;CoilPartWetPartDry: Maximum iterations exceeded for Liq Temp, at Interface&#39;</span><span class="p">)</span>
<a name="ln-5754"></a>        <span class="k">END IF</span>
<a name="ln-5755"></a>
<a name="ln-5756"></a>          <span class="c">! If Following condition prevails then surface is dry, calculate dry coil performance and return</span>
<a name="ln-5757"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfAreaWetFraction</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">WetDryInterfcSurfTemp</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">AirDewPointTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5758"></a>
<a name="ln-5759"></a>            <span class="c">! Calculating Value of Dry UA for the coil</span>
<a name="ln-5760"></a>          <span class="n">DryCoilUA</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternalPerUnitArea</span><span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5761"></a>                                                                 <span class="mf">1.0d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UADryExtPerUnitArea</span><span class="p">)</span>
<a name="ln-5762"></a>
<a name="ln-5763"></a>            <span class="c">! Calling the Completely Dry Coil for outputs</span>
<a name="ln-5764"></a>          <span class="k">CALL </span><span class="n">CoilCompletelyDry</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">InletWaterTemp</span><span class="p">,</span> <span class="n">InletAirTemp</span><span class="p">,</span><span class="n">DryCoilUA</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5765"></a>                                 <span class="n">OutletWaterTemp</span><span class="p">,</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">TotWaterCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5766"></a>
<a name="ln-5767"></a>            <span class="c">! Sensible load = Total load in a Completely Dry Coil</span>
<a name="ln-5768"></a>          <span class="n">SenWaterCoilLoad</span> <span class="o">=</span> <span class="n">TotWaterCoilLoad</span>
<a name="ln-5769"></a>
<a name="ln-5770"></a>            <span class="c">! All coil is Dry so fraction wet is ofcourse =0</span>
<a name="ln-5771"></a>          <span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5772"></a>          <span class="k">RETURN</span>
<a name="ln-5773"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-5774"></a>
<a name="ln-5775"></a>          <span class="c">! IF the coil is not Dry then iterate to calculate Fraction of surface area that is wet.</span>
<a name="ln-5776"></a>        <span class="n">error</span> <span class="o">=</span> <span class="n">WetDryInterfcSurfTemp</span> <span class="o">-</span> <span class="n">AirDewPointTemp</span>
<a name="ln-5777"></a>        <span class="k">Call </span><span class="n">CoilAreaFracIter</span> <span class="p">(</span><span class="n">NewSurfAreaWetFrac</span><span class="p">,</span><span class="n">SurfAreaWetFraction</span><span class="p">,</span><span class="n">error</span><span class="p">,</span><span class="n">SurfAreaFracPrevious</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5778"></a>                                                       <span class="n">ErrorPrevious</span><span class="p">,</span><span class="n">SurfAreaFracLast</span><span class="p">,</span><span class="n">ErrorLast</span><span class="p">,</span><span class="n">iter</span><span class="p">,</span><span class="n">icvg</span><span class="p">)</span>
<a name="ln-5779"></a>        <span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="n">NewSurfAreaWetFrac</span>
<a name="ln-5780"></a>
<a name="ln-5781"></a>          <span class="c">!If converged, leave iteration loop</span>
<a name="ln-5782"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">icvg</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Exit</span>
<a name="ln-5783"></a>
<a name="ln-5784"></a>          <span class="c">! Surface temperature not converged.  Repeat calculations with new</span>
<a name="ln-5785"></a>          <span class="c">! estimate of fraction wet surface area.</span>
<a name="ln-5786"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfAreaWetFraction</span>  <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5787"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfAreaWetFraction</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SurfAreaWetFraction</span> <span class="o">=</span> <span class="mf">0.0098d0</span>
<a name="ln-5788"></a>
<a name="ln-5789"></a>     <span class="k">End Do</span>  <span class="c">! End do for the overall iteration</span>
<a name="ln-5790"></a>
<a name="ln-5791"></a>     <span class="c">! Calculate sum of total and sensible heat transfer from dry and wet parts.</span>
<a name="ln-5792"></a>     <span class="n">TotWaterCoilLoad</span> <span class="o">=</span> <span class="n">DryCoilHeatTranfer</span><span class="o">+</span><span class="n">WetCoilTotalHeatTransfer</span>
<a name="ln-5793"></a>     <span class="n">SenWaterCoilLoad</span> <span class="o">=</span> <span class="n">DryCoilHeatTranfer</span><span class="o">+</span><span class="n">WetCoilSensibleHeatTransfer</span>
<a name="ln-5794"></a>
<a name="ln-5795"></a>     <span class="c">! Save last iterations values for this current time step</span>
<a name="ln-5796"></a>     <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SurfAreaWetFractionSaved</span> <span class="o">=</span> <span class="n">SurfAreaWetFraction</span>
<a name="ln-5797"></a>
<a name="ln-5798"></a>
<a name="ln-5799"></a>     <span class="k">RETURN</span>
<a name="ln-5800"></a><span class="k">   END SUBROUTINE </span><span class="n">CoilPartWetPartDry</span>
<a name="ln-5801"></a>
<a name="ln-5802"></a>
<a name="ln-5803"></a><span class="c">! Calculating coil UA for Cooling Coil</span>
<a name="ln-5804"></a><span class="k">FUNCTION </span><span class="n">CalcCoilUAbyEffectNTU</span> <span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">CapacityStream1</span><span class="p">,</span><span class="n">EnergyInStreamOne</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5805"></a>                                          <span class="n">CapacityStream2</span><span class="p">,</span><span class="n">EnergyInStreamTwo</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5806"></a>                                          <span class="n">DesTotalHeatTransfer</span><span class="p">)</span>
<a name="ln-5807"></a>
<a name="ln-5808"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5809"></a>          <span class="c">! AUTHOR         Rahul Chillar</span>
<a name="ln-5810"></a>          <span class="c">! DATE WRITTEN   March 2004</span>
<a name="ln-5811"></a>          <span class="c">! MODIFIED       na</span>
<a name="ln-5812"></a>          <span class="c">! RE-ENGINEERED  na</span>
<a name="ln-5813"></a>
<a name="ln-5814"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5815"></a>          <span class="c">! Calculate the UA of a heat exchanger using the effectiveness-NTU relationships</span>
<a name="ln-5816"></a>          <span class="c">! given the entering capacity rate and temperature of each flow stream, the</span>
<a name="ln-5817"></a>          <span class="c">! heat transfer rate under these conditions and the heat exchanger configuration.</span>
<a name="ln-5818"></a>
<a name="ln-5819"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5820"></a>          <span class="c">! Models coil using effectiveness NTU model</span>
<a name="ln-5821"></a>
<a name="ln-5822"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5823"></a>          <span class="c">! na</span>
<a name="ln-5824"></a>
<a name="ln-5825"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5826"></a>      <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Iterate</span>
<a name="ln-5827"></a>
<a name="ln-5828"></a>          <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5829"></a>      <span class="k">Implicit None</span>
<a name="ln-5830"></a>
<a name="ln-5831"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5832"></a>      <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-5833"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CapacityStream1</span>        <span class="c">! Capacity rate of stream1.(W/C)</span>
<a name="ln-5834"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnergyInStreamOne</span>      <span class="c">! Inlet state of stream1.(C)</span>
<a name="ln-5835"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CapacityStream2</span>        <span class="c">! Capacity rate of stream2.(W/C)</span>
<a name="ln-5836"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EnergyInStreamTwo</span>      <span class="c">! Inlet state of stream2.(C)</span>
<a name="ln-5837"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesTotalHeatTransfer</span>   <span class="c">! Heat transfer rate(W)</span>
<a name="ln-5838"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CalcCoilUAbyEffectNTU</span>  <span class="c">! Overall heat transfer coefficient(W/C)</span>
<a name="ln-5839"></a>
<a name="ln-5840"></a>
<a name="ln-5841"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5842"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Parameter</span><span class="kd">::</span> <span class="n">SmallNo</span><span class="o">=</span><span class="mf">1.d-9</span>
<a name="ln-5843"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Parameter</span><span class="kd">::</span> <span class="n">LargeNo</span><span class="o">=</span><span class="mf">1.d9</span>
<a name="ln-5844"></a>      <span class="kt">Integer</span><span class="p">,</span> <span class="k">Parameter</span><span class="kd">::</span> <span class="n">itmax</span><span class="o">=</span><span class="mi">12</span>
<a name="ln-5845"></a>
<a name="ln-5846"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5847"></a>          <span class="c">! na</span>
<a name="ln-5848"></a>
<a name="ln-5849"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5850"></a>          <span class="c">! na</span>
<a name="ln-5851"></a>
<a name="ln-5852"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5853"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">MaxHeatTransfer</span>       <span class="c">! Maximum heat transfer from inlet conditions (W)</span>
<a name="ln-5854"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EstimatedHeatTransfer</span> <span class="c">! Estimated heat transfer in iteration(W)</span>
<a name="ln-5855"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CoilUA</span>                <span class="c">! Estimated heat transfer coefficient(W/C)</span>
<a name="ln-5856"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">error</span>                 <span class="c">! Deviation of dependent variable in iteration</span>
<a name="ln-5857"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">X1</span><span class="p">,</span><span class="n">Y1</span> <span class="p">,</span> <span class="n">ResultX</span>       <span class="c">! Previous values of independent variable in iteration</span>
<a name="ln-5858"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnergyOutStreamOne</span> <span class="c">! Intermediate Variable used</span>
<a name="ln-5859"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnergyOutStreamTwo</span> <span class="c">! Intermediate variable used</span>
<a name="ln-5860"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DesTotalHeatTransferCheck</span> <span class="c">! Check value to keep design total heat transfer in range</span>
<a name="ln-5861"></a>      <span class="kt">INTEGER </span><span class="n">iter</span>   <span class="c">! Iteration index</span>
<a name="ln-5862"></a>      <span class="kt">INTEGER </span><span class="n">icvg</span>   <span class="c">! Iteration convergence flag</span>
<a name="ln-5863"></a>
<a name="ln-5864"></a>         <span class="c">! Check for Q out of range (effectiveness &gt; 1)</span>
<a name="ln-5865"></a>      <span class="n">MaxHeatTransfer</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">MIN</span><span class="p">(</span><span class="n">CapacityStream1</span><span class="p">,</span><span class="n">CapacityStream2</span><span class="p">)</span><span class="o">*</span>    <span class="p">&amp;</span>
<a name="ln-5866"></a>                              <span class="p">(</span><span class="n">EnergyInStreamOne</span><span class="o">-</span><span class="n">EnergyInStreamTwo</span><span class="p">))</span>
<a name="ln-5867"></a>
<a name="ln-5868"></a>         <span class="c">! Error Message</span>
<a name="ln-5869"></a>      <span class="k">IF</span><span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DesTotalHeatTransfer</span><span class="p">)</span><span class="o">-</span><span class="n">MaxHeatTransfer</span><span class="p">)</span><span class="o">/</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxHeatTransfer</span><span class="p">,</span><span class="n">SmallNo</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallNo</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5870"></a><span class="k">         CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;For Coil:Cooling:Water &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5871"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;CalcCoilUAbyEffectNTU:Given Q impossible for given inlet states, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5872"></a>                                <span class="s1">&#39;proceeding with MaxHeat Transfer&#39;</span><span class="p">)</span>
<a name="ln-5873"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the Sizing:System and Sizing:Zone cooling design supply air temperature and &#39;</span><span class="p">)</span>
<a name="ln-5874"></a>         <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the Sizing:Plant design Loop exit temperature.  There must be sufficient difference between &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-5875"></a>                                <span class="s1">&#39;these two temperatures.&#39;</span><span class="p">)</span>
<a name="ln-5876"></a>      <span class="k">END IF</span>
<a name="ln-5877"></a>
<a name="ln-5878"></a>
<a name="ln-5879"></a>         <span class="c">! Design Heat Transfer cannot exceed Max heat Transfer , setting it value such that effectiveness&lt;1.0</span>
<a name="ln-5880"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">DesTotalHeatTransfer</span><span class="p">).</span><span class="n">GT</span><span class="p">.(</span><span class="n">MaxHeatTransfer</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-5881"></a>            <span class="c">! Pegging value so that effectiveness is less than 1.</span>
<a name="ln-5882"></a>            <span class="n">DesTotalHeatTransferCheck</span><span class="o">=</span> <span class="mf">0.9d0</span><span class="o">*</span><span class="n">MaxHeatTransfer</span>
<a name="ln-5883"></a>
<a name="ln-5884"></a>           <span class="c">! Estimate CalcCoilUAbyEffectNTU</span>
<a name="ln-5885"></a>          <span class="n">CoilUA</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DesTotalHeatTransferCheck</span><span class="o">/</span><span class="p">(</span><span class="n">EnergyInStreamOne</span><span class="o">-</span><span class="n">EnergyInStreamTwo</span><span class="p">))</span>
<a name="ln-5886"></a>
<a name="ln-5887"></a>        <span class="k">ELSE</span>
<a name="ln-5888"></a>
<a name="ln-5889"></a>           <span class="c">! Estimate CalcCoilUAbyEffectNTU</span>
<a name="ln-5890"></a>          <span class="n">CoilUA</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DesTotalHeatTransfer</span><span class="o">/</span><span class="p">(</span><span class="n">EnergyInStreamOne</span><span class="o">-</span><span class="n">EnergyInStreamTwo</span><span class="p">))</span>
<a name="ln-5891"></a>
<a name="ln-5892"></a>        <span class="k">END IF</span>
<a name="ln-5893"></a>
<a name="ln-5894"></a>         <span class="c">! BEGIN LOOP to iteratively calculate CalcCoilUAbyEffectNTU</span>
<a name="ln-5895"></a>        <span class="k">DO </span><span class="n">iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">itmax</span>
<a name="ln-5896"></a>
<a name="ln-5897"></a>           <span class="c">! Calculate heat transfer rate for estimated CalcCoilUAbyEffectNTU</span>
<a name="ln-5898"></a>          <span class="k">CALL </span><span class="n">CoilOutletStreamCondition</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">CapacityStream1</span><span class="p">,</span><span class="n">EnergyInStreamOne</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5899"></a>                                 <span class="n">CapacityStream2</span><span class="p">,</span><span class="n">EnergyInStreamTwo</span><span class="p">,</span>                   <span class="p">&amp;</span>
<a name="ln-5900"></a>                                 <span class="n">CoilUA</span><span class="p">,</span><span class="n">EnergyOutStreamOne</span><span class="p">,</span><span class="n">EnergyOutStreamTwo</span><span class="p">)</span>
<a name="ln-5901"></a>
<a name="ln-5902"></a>            <span class="c">! Initial Guess for a value of heat transfer</span>
<a name="ln-5903"></a>           <span class="n">EstimatedHeatTransfer</span> <span class="o">=</span> <span class="n">CapacityStream1</span><span class="o">*</span><span class="p">(</span><span class="n">EnergyInStreamOne</span><span class="o">-</span><span class="n">EnergyOutStreamOne</span><span class="p">)</span>
<a name="ln-5904"></a>
<a name="ln-5905"></a>            <span class="c">! Calculate new estimate for CalcCoilUAbyEffectNTU by iteration</span>
<a name="ln-5906"></a>                <span class="k">If</span><span class="p">(</span><span class="n">DesTotalHeatTransfer</span><span class="o">&gt;</span><span class="n">MaxHeatTransfer</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5907"></a><span class="k">                   </span><span class="n">error</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">EstimatedHeatTransfer</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DesTotalHeatTransferCheck</span><span class="p">)</span>
<a name="ln-5908"></a>                  <span class="k">Else</span>
<a name="ln-5909"></a><span class="k">                   </span><span class="n">error</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">EstimatedHeatTransfer</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">DesTotalHeatTransfer</span><span class="p">)</span>
<a name="ln-5910"></a>                <span class="k">END If</span>
<a name="ln-5911"></a><span class="k">           Call </span><span class="n">ITERATE</span> <span class="p">(</span><span class="n">ResultX</span><span class="p">,</span><span class="mf">0.01d0</span><span class="p">,</span> <span class="n">CoilUA</span><span class="p">,</span><span class="n">error</span><span class="p">,</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">iter</span><span class="p">,</span><span class="n">icvg</span><span class="p">)</span>
<a name="ln-5912"></a>                <span class="n">CoilUA</span> <span class="o">=</span> <span class="n">ResultX</span>
<a name="ln-5913"></a>         <span class="c">! If converged, leave loop</span>
<a name="ln-5914"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">icvg</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span>   <span class="k">Exit</span>
<a name="ln-5915"></a><span class="k">      End Do</span>
<a name="ln-5916"></a>
<a name="ln-5917"></a>
<a name="ln-5918"></a>         <span class="c">! If not converged after itmax iterations, return error code</span>
<a name="ln-5919"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">iter</span> <span class="o">&gt;</span> <span class="n">itmax</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">WarmUpFlag</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5920"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;For Coil:Cooling:Water &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5921"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span> <span class="p">(</span><span class="s1">&#39;CalcCoilUAbyEffectNTU: Maximum iterations exceeded:Coil UA calculation&#39;</span><span class="p">)</span>
<a name="ln-5922"></a>            <span class="n">CalcCoilUAbyEffectNTU</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">!Objexx:Return Line added to set return value: Using non-converged CoilUA value may be preferred but that was not happening</span>
<a name="ln-5923"></a>          <span class="k">ELSE</span>
<a name="ln-5924"></a>
<a name="ln-5925"></a>          <span class="c">! Assign value to CalcCoilUAbyEffectNTU</span>
<a name="ln-5926"></a>          <span class="n">CalcCoilUAbyEffectNTU</span> <span class="o">=</span> <span class="n">CoilUA</span>
<a name="ln-5927"></a>        <span class="k">END IF</span>
<a name="ln-5928"></a>
<a name="ln-5929"></a><span class="k">  Return</span>
<a name="ln-5930"></a><span class="k">END FUNCTION  </span><span class="n">CalcCoilUAbyEffectNTU</span>
<a name="ln-5931"></a>
<a name="ln-5932"></a>
<a name="ln-5933"></a><span class="c">! Calculating coil outlet stream conditions and coil UA for Cooling Coil</span>
<a name="ln-5934"></a><span class="k">SUBROUTINE </span><span class="n">CoilOutletStreamCondition</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span> <span class="n">CapacityStream1</span><span class="p">,</span><span class="n">EnergyInStreamOne</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-5935"></a>                                     <span class="n">CapacityStream2</span><span class="p">,</span><span class="n">EnergyInStreamTwo</span><span class="p">,</span>                    <span class="p">&amp;</span>
<a name="ln-5936"></a>                                     <span class="n">CoilUA</span><span class="p">,</span><span class="n">EnergyOutStreamOne</span><span class="p">,</span><span class="n">EnergyOutStreamTwo</span><span class="p">)</span>
<a name="ln-5937"></a>
<a name="ln-5938"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-5939"></a>          <span class="c">! AUTHOR         Rahul Chillar</span>
<a name="ln-5940"></a>          <span class="c">! DATE WRITTEN   March 2004</span>
<a name="ln-5941"></a>          <span class="c">! MODIFIED       na</span>
<a name="ln-5942"></a>          <span class="c">! RE-ENGINEERED  na</span>
<a name="ln-5943"></a>
<a name="ln-5944"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-5945"></a>          <span class="c">! Calculate the outlet states of a simple heat exchanger using the effectiveness-Ntu</span>
<a name="ln-5946"></a>          <span class="c">! method of analysis.</span>
<a name="ln-5947"></a>
<a name="ln-5948"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5949"></a>          <span class="c">! na</span>
<a name="ln-5950"></a>
<a name="ln-5951"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5952"></a>          <span class="c">! Kays, W.M. and A.L. London.  1964.Compact Heat Exchangers, 2nd Ed.McGraw-Hill:New York.</span>
<a name="ln-5953"></a>
<a name="ln-5954"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5955"></a>          <span class="c">! na</span>
<a name="ln-5956"></a>
<a name="ln-5957"></a>          <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5958"></a>      <span class="k">Implicit None</span>
<a name="ln-5959"></a>
<a name="ln-5960"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-5961"></a>      <span class="kt">Integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-5962"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CapacityStream1</span>              <span class="c">! Capacity rate of stream1(W/C)</span>
<a name="ln-5963"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergyInStreamOne</span>   <span class="c">! Inlet state of stream1 (C)</span>
<a name="ln-5964"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CapacityStream2</span>              <span class="c">! Capacity rate of stream2 (W/C)</span>
<a name="ln-5965"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnergyInStreamTwo</span>   <span class="c">! Inlet state of stream2 (C)</span>
<a name="ln-5966"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilUA</span>                       <span class="c">! Heat transfer rateW)</span>
<a name="ln-5967"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">EnergyOutStreamOne</span>  <span class="c">! Outlet state of stream1 (C)</span>
<a name="ln-5968"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">EnergyOutStreamTwo</span>  <span class="c">! Outlet state of stream2 (C)</span>
<a name="ln-5969"></a>
<a name="ln-5970"></a>
<a name="ln-5971"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-5972"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">Parameter</span><span class="kd">::</span> <span class="n">LargeNo</span> <span class="o">=</span> <span class="mf">1.d10</span>   <span class="c">! value used in place of infinity</span>
<a name="ln-5973"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">Parameter</span><span class="kd">::</span> <span class="n">SmallNo</span> <span class="o">=</span> <span class="mf">1.d-15</span>  <span class="c">! value used in place of zero</span>
<a name="ln-5974"></a>
<a name="ln-5975"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5976"></a>          <span class="c">! na</span>
<a name="ln-5977"></a>
<a name="ln-5978"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5979"></a>          <span class="c">! na</span>
<a name="ln-5980"></a>
<a name="ln-5981"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5982"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">MinimumCapacityStream</span>    <span class="c">! Minimum capacity rate of the streams(W/C)</span>
<a name="ln-5983"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">MaximumCapacityStream</span>    <span class="c">! Maximum capacity rate of the streams(W/C)</span>
<a name="ln-5984"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">RatioStreamCapacity</span>      <span class="c">! Ratio of minimum to maximum capacity rate</span>
<a name="ln-5985"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">NTU</span>             <span class="c">! Number of transfer units</span>
<a name="ln-5986"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">effectiveness</span><span class="o">=</span><span class="mf">0.0d0</span>   <span class="c">! Heat exchanger effectiveness</span>
<a name="ln-5987"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">MaxHeatTransfer</span> <span class="c">! Maximum heat transfer possible(W)</span>
<a name="ln-5988"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="n">e</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span>   <span class="c">! Intermediate variables in effectivness equation</span>
<a name="ln-5989"></a>
<a name="ln-5990"></a>
<a name="ln-5991"></a>         <span class="c">! NTU and MinimumCapacityStream/MaximumCapacityStream (RatioStreamCapacity) calculations</span>
<a name="ln-5992"></a>      <span class="n">MinimumCapacityStream</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">CapacityStream1</span><span class="p">,</span><span class="n">CapacityStream2</span><span class="p">)</span>
<a name="ln-5993"></a>      <span class="n">MaximumCapacityStream</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">CapacityStream1</span><span class="p">,</span><span class="n">CapacityStream2</span><span class="p">)</span>
<a name="ln-5994"></a>
<a name="ln-5995"></a>
<a name="ln-5996"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MaximumCapacityStream</span><span class="p">)</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mf">1.d-6</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! .EQ. 0.0d0) THEN</span>
<a name="ln-5997"></a>        <span class="n">RatioStreamCapacity</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-5998"></a>      <span class="k">ELSE</span>
<a name="ln-5999"></a><span class="k">        </span><span class="n">RatioStreamCapacity</span> <span class="o">=</span> <span class="n">MinimumCapacityStream</span><span class="o">/</span><span class="n">MaximumCapacityStream</span>
<a name="ln-6000"></a>      <span class="n">ENDIF</span>
<a name="ln-6001"></a>
<a name="ln-6002"></a>
<a name="ln-6003"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">MinimumCapacityStream</span><span class="p">)</span> <span class="p">.</span><span class="n">le</span><span class="p">.</span> <span class="mf">1.d-6</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! .EQ. 0.0d0) THEN</span>
<a name="ln-6004"></a>        <span class="n">NTU</span> <span class="o">=</span> <span class="n">LargeNo</span>
<a name="ln-6005"></a>      <span class="k">ELSE</span>
<a name="ln-6006"></a><span class="k">        </span><span class="n">NTU</span> <span class="o">=</span> <span class="n">CoilUA</span><span class="o">/</span><span class="n">MinimumCapacityStream</span>
<a name="ln-6007"></a>      <span class="n">ENDIF</span>
<a name="ln-6008"></a>
<a name="ln-6009"></a>
<a name="ln-6010"></a>       <span class="c">! Calculate effectiveness for special limiting cases</span>
<a name="ln-6011"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">NTU</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6012"></a><span class="k">        </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6013"></a>
<a name="ln-6014"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">RatioStreamCapacity</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SmallNo</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6015"></a>         <span class="c">! MinimumCapacityStream/MaximumCapacityStream = 0 and effectiveness is independent of configuration</span>
<a name="ln-6016"></a>         <span class="c">! 20 is the Limit Chosen for Exponential Function, beyond which there is float point error.</span>
<a name="ln-6017"></a>        <span class="k">If</span><span class="p">(</span><span class="n">NTU</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6018"></a><span class="k">          </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6019"></a>        <span class="k">Else</span>
<a name="ln-6020"></a><span class="k">          </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="p">)</span>
<a name="ln-6021"></a>        <span class="k">End If</span>
<a name="ln-6022"></a>         <span class="c">! Calculate effectiveness depending on heat exchanger configuration</span>
<a name="ln-6023"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">HeatExchType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CounterFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6024"></a>
<a name="ln-6025"></a>          <span class="c">! Counterflow Heat Exchanger Configuration</span>
<a name="ln-6026"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">RatioStreamCapacity</span><span class="o">-</span><span class="mf">1.d0</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SmallNo</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6027"></a><span class="k">          </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="n">NTU</span><span class="o">/</span><span class="p">(</span><span class="n">NTU</span><span class="o">+</span><span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-6028"></a>        <span class="k">ELSE</span>
<a name="ln-6029"></a><span class="k">          If</span><span class="p">(</span><span class="n">NTU</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RatioStreamCapacity</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6030"></a><span class="k">            </span><span class="n">e</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6031"></a>          <span class="k">Else</span>
<a name="ln-6032"></a><span class="k">            </span><span class="n">e</span><span class="o">=</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RatioStreamCapacity</span><span class="p">))</span>
<a name="ln-6033"></a>          <span class="k">End If</span>
<a name="ln-6034"></a><span class="k">          </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">e</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RatioStreamCapacity</span><span class="o">*</span><span class="n">e</span><span class="p">)</span>
<a name="ln-6035"></a>        <span class="n">ENDIF</span>
<a name="ln-6036"></a>
<a name="ln-6037"></a>       <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">HeatExchType</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CrossFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6038"></a>         <span class="c">! Cross flow, both streams unmixed</span>
<a name="ln-6039"></a>        <span class="n">eta</span> <span class="o">=</span> <span class="n">NTU</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.22d0</span><span class="p">)</span>
<a name="ln-6040"></a>        <span class="k">If</span><span class="p">((</span><span class="n">NTU</span><span class="o">*</span><span class="n">RatioStreamCapacity</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6041"></a><span class="k">          </span><span class="n">b</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">RatioStreamCapacity</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span>
<a name="ln-6042"></a>          <span class="k">If</span><span class="p">(</span><span class="n">b</span><span class="o">&gt;</span><span class="mi">2</span><span class="mf">0.d0</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-6043"></a><span class="k">            </span><span class="n">effectiveness</span><span class="o">=</span><span class="mf">1.d0</span>
<a name="ln-6044"></a>          <span class="k">Else</span>
<a name="ln-6045"></a><span class="k">            </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">)</span>
<a name="ln-6046"></a>            <span class="k">If</span><span class="p">(</span><span class="n">effectiveness</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="n">effectiveness</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6047"></a>          <span class="k">End If</span>
<a name="ln-6048"></a><span class="k">        Else</span>
<a name="ln-6049"></a><span class="k">          </span><span class="n">d</span><span class="o">=</span><span class="p">((</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="o">*</span><span class="n">RatioStreamCapacity</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">-</span><span class="mf">1.d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">RatioStreamCapacity</span><span class="o">*</span><span class="n">eta</span><span class="p">))</span>
<a name="ln-6050"></a>          <span class="k">If</span><span class="p">(</span><span class="n">d</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="mi">2</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">d</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-6051"></a><span class="k">            </span><span class="n">effectiveness</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-6052"></a>          <span class="k">Else</span>
<a name="ln-6053"></a><span class="k">            </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">((</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="o">*</span><span class="n">RatioStreamCapacity</span><span class="o">*</span><span class="n">eta</span><span class="p">)</span><span class="o">-</span><span class="mf">1.d0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">RatioStreamCapacity</span><span class="o">*</span><span class="n">eta</span><span class="p">))</span>
<a name="ln-6054"></a>            <span class="k">If</span><span class="p">(</span><span class="n">effectiveness</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="n">effectiveness</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6055"></a>          <span class="k">End if</span>
<a name="ln-6056"></a><span class="k">        End if</span>
<a name="ln-6057"></a>
<a name="ln-6058"></a>
<a name="ln-6059"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-6060"></a>
<a name="ln-6061"></a>         <span class="c">! Determine leaving conditions for the two streams</span>
<a name="ln-6062"></a>      <span class="n">MaxHeatTransfer</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MinimumCapacityStream</span><span class="p">,</span><span class="n">SmallNo</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">EnergyInStreamOne</span><span class="o">-</span><span class="n">EnergyInStreamTwo</span><span class="p">)</span>
<a name="ln-6063"></a>      <span class="n">EnergyOutStreamOne</span> <span class="o">=</span> <span class="n">EnergyInStreamOne</span> <span class="o">-</span> <span class="n">effectiveness</span><span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-6064"></a>                                             <span class="n">MaxHeatTransfer</span><span class="o">/</span><span class="nb">MAX</span><span class="p">(</span><span class="n">CapacityStream1</span><span class="p">,</span><span class="n">SmallNo</span><span class="p">)</span>
<a name="ln-6065"></a>      <span class="n">EnergyOutStreamTwo</span> <span class="o">=</span> <span class="n">EnergyInStreamTwo</span> <span class="o">+</span> <span class="n">effectiveness</span><span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-6066"></a>                                             <span class="n">MaxHeatTransfer</span><span class="o">/</span><span class="nb">MAX</span><span class="p">(</span><span class="n">CapacityStream2</span><span class="p">,</span><span class="n">SmallNo</span><span class="p">)</span>
<a name="ln-6067"></a>
<a name="ln-6068"></a>      <span class="k">RETURN</span>
<a name="ln-6069"></a><span class="k">      END SUBROUTINE  </span><span class="n">CoilOutletStreamCondition</span>
<a name="ln-6070"></a>
<a name="ln-6071"></a>
<a name="ln-6072"></a>
<a name="ln-6073"></a><span class="c">! Subroutine for caculating outlet condition if coil is wet , for Cooling Coil</span>
<a name="ln-6074"></a>      <span class="k">SUBROUTINE </span><span class="n">WetCoilOutletCondition</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">,</span><span class="n">AirTempIn</span><span class="p">,</span><span class="n">EnthAirInlet</span><span class="p">,</span><span class="n">EnthAirOutlet</span><span class="p">,</span><span class="n">UACoilExternal</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6075"></a>                                        <span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">,</span><span class="n">SenWaterCoilLoad</span><span class="p">)</span>
<a name="ln-6076"></a>
<a name="ln-6077"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-6078"></a>          <span class="c">! AUTHOR         Rahul Chillar</span>
<a name="ln-6079"></a>          <span class="c">! DATE WRITTEN   Mar 2004</span>
<a name="ln-6080"></a>          <span class="c">! MODIFIED       na</span>
<a name="ln-6081"></a>          <span class="c">! RE-ENGINEERED  na</span>
<a name="ln-6082"></a>
<a name="ln-6083"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-6084"></a>          <span class="c">! Calculate the leaving air temperature,the leaving air humidity ratio and the</span>
<a name="ln-6085"></a>          <span class="c">! sensible cooling capacity of wet cooling coil.</span>
<a name="ln-6086"></a>
<a name="ln-6087"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6088"></a>          <span class="c">! Assumes condensate at uniform temperature.</span>
<a name="ln-6089"></a>
<a name="ln-6090"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6091"></a>          <span class="c">! Elmahdy, A.H. and Mitalas, G.P.  1977.&quot;A Simple Model for Cooling and</span>
<a name="ln-6092"></a>          <span class="c">! Dehumidifying Coils for Use In Calculating Energy Requirements for Buildings,&quot;</span>
<a name="ln-6093"></a>          <span class="c">! ASHRAE Transactions,Vol.83 Part 2, pp. 103-117.</span>
<a name="ln-6094"></a>
<a name="ln-6095"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6096"></a>
<a name="ln-6097"></a>          <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6098"></a>      <span class="k">Implicit None</span>
<a name="ln-6099"></a>
<a name="ln-6100"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-6101"></a>      <span class="kt">Integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>        <span class="c">!</span>
<a name="ln-6102"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirTempIn</span>      <span class="c">! Entering air dry bulb temperature(C)</span>
<a name="ln-6103"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthAirInlet</span>      <span class="c">! Entering air enthalpy(J/kg)</span>
<a name="ln-6104"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EnthAirOutlet</span>     <span class="c">! Leaving air enthalpy(J/kg)</span>
<a name="ln-6105"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UACoilExternal</span>    <span class="c">! Heat transfer coefficient for external surface (W/C)</span>
<a name="ln-6106"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutletAirTemp</span>     <span class="c">! Leaving air dry bulb temperature(C)</span>
<a name="ln-6107"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">OutletAirHumRat</span>   <span class="c">! Leaving air humidity ratio</span>
<a name="ln-6108"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">SenWaterCoilLoad</span>  <span class="c">! Sensible heat transfer rate(W)</span>
<a name="ln-6109"></a>
<a name="ln-6110"></a>
<a name="ln-6111"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-6112"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Parameter</span><span class="kd">::</span> <span class="n">SmallNo</span><span class="o">=</span><span class="mf">1.d-9</span> <span class="c">! SmallNo value used in place of zero</span>
<a name="ln-6113"></a>
<a name="ln-6114"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6115"></a>          <span class="c">! na</span>
<a name="ln-6116"></a>
<a name="ln-6117"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6118"></a>          <span class="c">! na</span>
<a name="ln-6119"></a>
<a name="ln-6120"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6121"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CapacitanceAir</span>         <span class="c">! Air capacity rate(W/C)</span>
<a name="ln-6122"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">NTU</span>                    <span class="c">! Number of heat transfer units</span>
<a name="ln-6123"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">effectiveness</span>          <span class="c">! Heat exchanger effectiveness</span>
<a name="ln-6124"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EnthAirCondensateTemp</span>  <span class="c">! Saturated air enthalpy at temperature of condensate(J/kg)</span>
<a name="ln-6125"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempCondensation</span>       <span class="c">! Temperature of condensate(C)</span>
<a name="ln-6126"></a>      <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">TempAirDewPoint</span>        <span class="c">! Temperature air dew point</span>
<a name="ln-6127"></a>
<a name="ln-6128"></a>
<a name="ln-6129"></a>          <span class="c">! Determine the temperature effectiveness, assuming the temperature</span>
<a name="ln-6130"></a>          <span class="c">! of the condensate is constant (MinimumCapacityStream/MaximumCapacityStream = 0) and the specific heat</span>
<a name="ln-6131"></a>          <span class="c">! of moist air is constant</span>
<a name="ln-6132"></a>      <span class="n">CapacitanceAir</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span><span class="o">*</span>     <span class="p">&amp;</span>
<a name="ln-6133"></a>                                    <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">AirTempIn</span><span class="p">)</span>
<a name="ln-6134"></a>
<a name="ln-6135"></a>          <span class="c">! Calculating NTU from UA and Capacitance.</span>
<a name="ln-6136"></a><span class="c">!del      NTU = UACoilExternal/MAX(CapacitanceAir,SmallNo)</span>
<a name="ln-6137"></a><span class="c">!del      effectiveness = 1 - EXP(-MAX(0.0d0,NTU))</span>
<a name="ln-6138"></a>          <span class="c">! Calculating NTU from UA and Capacitance.</span>
<a name="ln-6139"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">UACoilExternal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6140"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CapacitanceAir</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6141"></a><span class="k">          </span><span class="n">NTU</span> <span class="o">=</span> <span class="n">UACoilExternal</span><span class="o">/</span><span class="n">CapacitanceAir</span>
<a name="ln-6142"></a>        <span class="k">ELSE</span>
<a name="ln-6143"></a><span class="k">          </span><span class="n">NTU</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6144"></a>        <span class="k">END IF</span>
<a name="ln-6145"></a><span class="k">        </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">NTU</span><span class="p">)</span>
<a name="ln-6146"></a>      <span class="k">ELSE</span>
<a name="ln-6147"></a><span class="k">        </span><span class="n">effectiveness</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6148"></a>      <span class="k">END IF</span>
<a name="ln-6149"></a>
<a name="ln-6150"></a>          <span class="c">! Calculate coil surface enthalpy and temperature at the exit</span>
<a name="ln-6151"></a>          <span class="c">! of the wet part of the coil using the effectiveness relation</span>
<a name="ln-6152"></a>      <span class="n">effectiveness</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">effectiveness</span><span class="p">,</span><span class="n">SmallNo</span><span class="p">)</span>
<a name="ln-6153"></a>      <span class="n">EnthAirCondensateTemp</span> <span class="o">=</span> <span class="n">EnthAirInlet</span><span class="o">-</span><span class="p">(</span><span class="n">EnthAirInlet</span><span class="o">-</span><span class="n">EnthAirOutlet</span><span class="p">)</span><span class="o">/</span><span class="n">effectiveness</span>
<a name="ln-6154"></a>
<a name="ln-6155"></a>
<a name="ln-6156"></a>        <span class="c">! Calculate condensate temperature as the saturation temperature</span>
<a name="ln-6157"></a>        <span class="c">! at given saturation enthalpy</span>
<a name="ln-6158"></a>      <span class="n">TempCondensation</span><span class="o">=</span>  <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EnthAirCondensateTemp</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-6159"></a>
<a name="ln-6160"></a>      <span class="n">TempAirDewPoint</span><span class="o">=</span><span class="n">PsyTdpFnWPb</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">)</span>
<a name="ln-6161"></a>
<a name="ln-6162"></a>      <span class="k">If</span><span class="p">((</span><span class="n">TempAirDewPoint</span><span class="o">-</span><span class="n">TempCondensation</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="mf">0.1d0</span><span class="p">)</span><span class="k">Then</span>
<a name="ln-6163"></a>
<a name="ln-6164"></a>           <span class="c">! Calculate Outlet Air Temperature using effectivness</span>
<a name="ln-6165"></a>           <span class="n">OutletAirTemp</span> <span class="o">=</span> <span class="n">AirTempIn</span><span class="o">-</span><span class="p">(</span><span class="n">AirTempIn</span><span class="o">-</span><span class="n">TempCondensation</span><span class="p">)</span><span class="o">*</span><span class="n">effectiveness</span>
<a name="ln-6166"></a>           <span class="c">! Calculate Outlet air humidity ratio from PsyWFnTdbH routine</span>
<a name="ln-6167"></a>           <span class="n">OutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">OutletAirTemp</span><span class="p">,</span><span class="n">EnthAirOutlet</span><span class="p">)</span>
<a name="ln-6168"></a>
<a name="ln-6169"></a>      <span class="k">Else</span>
<a name="ln-6170"></a><span class="k">           </span><span class="n">OutletAirHumRat</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-6171"></a>           <span class="n">OutletAirTemp</span><span class="o">=</span><span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">EnthAirOutlet</span><span class="p">,</span><span class="n">OutletAirHumRat</span><span class="p">)</span>
<a name="ln-6172"></a>
<a name="ln-6173"></a>      <span class="n">EndIf</span>
<a name="ln-6174"></a>
<a name="ln-6175"></a>
<a name="ln-6176"></a>        <span class="c">! Calculate Sensible Coil Load</span>
<a name="ln-6177"></a>      <span class="n">SenWaterCoilLoad</span> <span class="o">=</span> <span class="n">CapacitanceAir</span><span class="o">*</span><span class="p">(</span><span class="n">AirTempIn</span><span class="o">-</span><span class="n">OutletAirTemp</span><span class="p">)</span>
<a name="ln-6178"></a>
<a name="ln-6179"></a>      <span class="k">RETURN</span>
<a name="ln-6180"></a><span class="k">      END SUBROUTINE </span><span class="n">WetCoilOutletCondition</span>
<a name="ln-6181"></a>
<a name="ln-6182"></a>
<a name="ln-6183"></a><span class="c">! Beginning of Update subroutines for the WaterCoil Module</span>
<a name="ln-6184"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6185"></a>
<a name="ln-6186"></a><span class="k">SUBROUTINE </span><span class="n">UpdateWaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span>
<a name="ln-6187"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6188"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-6189"></a>          <span class="c">!       DATE WRITTEN   1998</span>
<a name="ln-6190"></a>          <span class="c">!       MODIFIED       April 2004: Rahul Chillar</span>
<a name="ln-6191"></a>          <span class="c">!                      Feb 2010 B. Griffith, plant upgrades</span>
<a name="ln-6192"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6193"></a>
<a name="ln-6194"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6195"></a>          <span class="c">! This subroutine updates the coil outlet nodes.</span>
<a name="ln-6196"></a>
<a name="ln-6197"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6198"></a>          <span class="c">! Data is moved from the coil data structure to the coil outlet nodes.</span>
<a name="ln-6199"></a>
<a name="ln-6200"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6201"></a>          <span class="c">! na</span>
<a name="ln-6202"></a>
<a name="ln-6203"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6204"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span> <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-6205"></a>  <span class="k">USE </span><span class="n">DataContaminantBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">Contaminant</span>
<a name="ln-6206"></a>
<a name="ln-6207"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6208"></a>
<a name="ln-6209"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6210"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">In</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-6211"></a>
<a name="ln-6212"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6213"></a>          <span class="c">! na</span>
<a name="ln-6214"></a>
<a name="ln-6215"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6216"></a>          <span class="c">! na</span>
<a name="ln-6217"></a>
<a name="ln-6218"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6219"></a>          <span class="c">! na</span>
<a name="ln-6220"></a>
<a name="ln-6221"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6222"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">AirInletNode</span>
<a name="ln-6223"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">WaterInletNode</span>
<a name="ln-6224"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">AirOutletNode</span>
<a name="ln-6225"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">WaterOutletNode</span>
<a name="ln-6226"></a>
<a name="ln-6227"></a>  <span class="n">AirInletNode</span>    <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-6228"></a>  <span class="n">WaterInletNode</span>  <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-6229"></a>  <span class="n">AirOutletNode</span>   <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-6230"></a>  <span class="n">WaterOutletNode</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-6231"></a>
<a name="ln-6232"></a>  <span class="c">! Set the outlet air nodes of the WaterCoil</span>
<a name="ln-6233"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirMassFlowRate</span>
<a name="ln-6234"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-6235"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-6236"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirEnthalpy</span>
<a name="ln-6237"></a>
<a name="ln-6238"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span>
<a name="ln-6239"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">WaterOutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterEnthalpy</span>
<a name="ln-6240"></a>
<a name="ln-6241"></a>     <span class="c">! Set the outlet nodes for properties that just pass through &amp; not used</span>
<a name="ln-6242"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Quality</span>             <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Quality</span>
<a name="ln-6243"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">Press</span>               <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-6244"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span>
<a name="ln-6245"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-6246"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span><span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span>
<a name="ln-6247"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span><span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>
<a name="ln-6248"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">CO2Simulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6249"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">CO2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">CO2</span>
<a name="ln-6250"></a>  <span class="k">END IF</span>
<a name="ln-6251"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Contaminant</span><span class="p">%</span><span class="n">GenericContamSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6252"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">AirOutletNode</span><span class="p">)%</span><span class="n">GenContam</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">AirInletNode</span><span class="p">)%</span><span class="n">GenContam</span>
<a name="ln-6253"></a>  <span class="k">END IF</span>
<a name="ln-6254"></a>
<a name="ln-6255"></a><span class="k">  RETURN</span>
<a name="ln-6256"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateWaterCoil</span>
<a name="ln-6257"></a>
<a name="ln-6258"></a><span class="c">!        End of Update subroutines for the WaterCoil Module</span>
<a name="ln-6259"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6260"></a>
<a name="ln-6261"></a>
<a name="ln-6262"></a><span class="c">! Beginning of Reporting subroutines for the WaterCoil Module</span>
<a name="ln-6263"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6264"></a>
<a name="ln-6265"></a><span class="k">SUBROUTINE </span><span class="n">ReportWaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span>
<a name="ln-6266"></a>
<a name="ln-6267"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6268"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-6269"></a>          <span class="c">!       DATE WRITTEN   1998</span>
<a name="ln-6270"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-6271"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6272"></a>
<a name="ln-6273"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6274"></a>          <span class="c">! This subroutine updates the report variable for the coils.</span>
<a name="ln-6275"></a>
<a name="ln-6276"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6277"></a>          <span class="c">! NA</span>
<a name="ln-6278"></a>
<a name="ln-6279"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6280"></a>          <span class="c">! na</span>
<a name="ln-6281"></a>
<a name="ln-6282"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6283"></a>  <span class="k">USE </span><span class="n">DataWater</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-6284"></a>
<a name="ln-6285"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6286"></a>
<a name="ln-6287"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6288"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-6289"></a>
<a name="ln-6290"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6291"></a>          <span class="c">! na</span>
<a name="ln-6292"></a>
<a name="ln-6293"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6294"></a>          <span class="c">! na</span>
<a name="ln-6295"></a>
<a name="ln-6296"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6297"></a>          <span class="c">! na</span>
<a name="ln-6298"></a>
<a name="ln-6299"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6300"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoWater</span>
<a name="ln-6301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Tavg</span>
<a name="ln-6302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecHumOut</span>
<a name="ln-6303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpecHumIn</span>
<a name="ln-6304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReportingConstant</span>
<a name="ln-6305"></a>
<a name="ln-6306"></a>  <span class="n">ReportingConstant</span> <span class="o">=</span> <span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-6307"></a> <span class="c">! report the WaterCoil energy from this component</span>
<a name="ln-6308"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilEnergy</span><span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-6309"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilEnergy</span><span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-6310"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilEnergy</span><span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SenWaterCoolingCoilRate</span><span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-6311"></a>
<a name="ln-6312"></a><span class="c">! report the WaterCoil water collection to water storage tank (if needed)</span>
<a name="ln-6313"></a>
<a name="ln-6314"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">==</span> <span class="n">CondensateToTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6315"></a>    <span class="c">! calculate and report condensation rates  (how much water extracted from the air stream)</span>
<a name="ln-6316"></a>    <span class="c">! water volumetric flow of water in m3/s for water system interactions</span>
<a name="ln-6317"></a>    <span class="c">!  put here to catch all types of DX coils</span>
<a name="ln-6318"></a>    <span class="n">Tavg</span> <span class="o">=</span><span class="p">(</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirTemp</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-6319"></a>
<a name="ln-6320"></a>
<a name="ln-6321"></a>    <span class="n">rhoWater</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6322"></a>                       <span class="n">Tavg</span><span class="p">,</span>                      <span class="p">&amp;</span>
<a name="ln-6323"></a>                       <span class="n">PlantLoop</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6324"></a>                       <span class="s1">&#39;ReportWaterCoil&#39;</span><span class="p">)</span>
<a name="ln-6325"></a><span class="c">!   CR9155 Remove specific humidity calculations</span>
<a name="ln-6326"></a>    <span class="n">SpecHumIn</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirHumRat</span>
<a name="ln-6327"></a>    <span class="n">SpecHumOut</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirHumRat</span>
<a name="ln-6328"></a>    <span class="c">!  mdot * del HumRat / rho water</span>
<a name="ln-6329"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletAirMassFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">SpecHumIn</span> <span class="o">-</span> <span class="n">SpecHumOut</span><span class="p">)</span> <span class="o">/</span> <span class="n">rhoWater</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-6330"></a>    <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateVol</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span> <span class="o">*</span><span class="n">ReportingConstant</span>
<a name="ln-6331"></a>
<a name="ln-6332"></a>    <span class="n">WaterStorage</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">)%</span><span class="n">VdotAvailSupply</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6333"></a>      <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateVdot</span>
<a name="ln-6334"></a>    <span class="n">WaterStorage</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">)%</span><span class="n">TwaterSupply</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6335"></a>      <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletAirTemp</span>
<a name="ln-6336"></a>
<a name="ln-6337"></a>  <span class="n">ENDIF</span>
<a name="ln-6338"></a>
<a name="ln-6339"></a>  <span class="k">RETURN</span>
<a name="ln-6340"></a><span class="k">END SUBROUTINE </span><span class="n">ReportWaterCoil</span>
<a name="ln-6341"></a>
<a name="ln-6342"></a><span class="c">!        End of Reporting subroutines for the WaterCoil Module</span>
<a name="ln-6343"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6344"></a>
<a name="ln-6345"></a><span class="c">! Beginning of Coil Utility subroutines for the Detailed Model</span>
<a name="ln-6346"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6347"></a><span class="k">SUBROUTINE </span><span class="n">CalcDryFinEffCoef</span><span class="p">(</span><span class="n">OutTubeEffFinDiamRatio</span><span class="p">,</span><span class="n">PolynomCoef</span><span class="p">)</span>
<a name="ln-6348"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6349"></a>          <span class="c">!       AUTHOR   Unknown</span>
<a name="ln-6350"></a>          <span class="c">!       DATE WRITTEN   Unknown</span>
<a name="ln-6351"></a>          <span class="c">!       DATE REWRITTEN  April 1997 by Russell D. Taylor, Ph.D.</span>
<a name="ln-6352"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-6353"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-6354"></a>
<a name="ln-6355"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6356"></a>          <span class="c">! The following subroutines are used once per cooling coil</span>
<a name="ln-6357"></a>          <span class="c">! simulation to obtain the coefficients of the dry fin</span>
<a name="ln-6358"></a>          <span class="c">! efficiency equation.  CalcDryFinEffCoef is the main calling</span>
<a name="ln-6359"></a>          <span class="c">! routine which manages calls to the Bessel funtion and polynomial</span>
<a name="ln-6360"></a>          <span class="c">! fit routines.</span>
<a name="ln-6361"></a>
<a name="ln-6362"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6363"></a>          <span class="c">! First found in MODSIM.</span>
<a name="ln-6364"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6365"></a>          <span class="c">! na</span>
<a name="ln-6366"></a>
<a name="ln-6367"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6368"></a>
<a name="ln-6369"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6370"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">OutTubeEffFinDiamRatio</span>
<a name="ln-6371"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">PolynomCoef</span>
<a name="ln-6372"></a>
<a name="ln-6373"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6374"></a>          <span class="c">! na</span>
<a name="ln-6375"></a>
<a name="ln-6376"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6377"></a>          <span class="c">! na</span>
<a name="ln-6378"></a>
<a name="ln-6379"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6380"></a>          <span class="c">! na</span>
<a name="ln-6381"></a>
<a name="ln-6382"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6383"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">MaxOrderedPairs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OrderedPair</span>
<a name="ln-6384"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">FAI</span><span class="p">,</span><span class="n">FED</span>
<a name="ln-6385"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">FEDnumerator</span>
<a name="ln-6386"></a>    <span class="kt">INTEGER </span><span class="n">I</span><span class="p">,</span><span class="n">IE1</span><span class="p">,</span><span class="n">IE2</span><span class="p">,</span><span class="n">IE3</span><span class="p">,</span><span class="n">IE4</span><span class="p">,</span><span class="n">IE5</span><span class="p">,</span><span class="n">IE6</span>
<a name="ln-6387"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">R1</span><span class="p">,</span><span class="n">R1I1</span><span class="p">,</span><span class="n">R1K1</span><span class="p">,</span><span class="n">R2</span><span class="p">,</span><span class="n">R2I0</span><span class="p">,</span><span class="n">R2I1</span><span class="p">,</span><span class="n">R2K0</span><span class="p">,</span><span class="n">R2K1</span><span class="p">,</span><span class="n">RO</span>
<a name="ln-6388"></a>
<a name="ln-6389"></a>    <span class="n">FAI</span> <span class="o">=</span> <span class="mf">0.02d0</span>
<a name="ln-6390"></a>    <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">60</span>
<a name="ln-6391"></a>      <span class="n">FAI</span> <span class="o">=</span> <span class="n">FAI</span> <span class="o">+</span> <span class="mf">0.035d0</span>
<a name="ln-6392"></a>      <span class="n">R1</span> <span class="o">=</span> <span class="n">FAI</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">OutTubeEffFinDiamRatio</span><span class="p">)</span>
<a name="ln-6393"></a>      <span class="n">R2</span> <span class="o">=</span> <span class="n">R1</span> <span class="o">*</span> <span class="n">OutTubeEffFinDiamRatio</span>
<a name="ln-6394"></a>      <span class="n">RO</span> <span class="o">=</span> <span class="mf">2.0d0</span> <span class="o">*</span> <span class="n">OutTubeEffFinDiamRatio</span> <span class="o">/</span> <span class="p">(</span><span class="n">FAI</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">OutTubeEffFinDiamRatio</span><span class="p">))</span>
<a name="ln-6395"></a>      <span class="k">CALL </span><span class="n">CalcIBesselFunc</span><span class="p">(</span><span class="n">R1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R1I1</span><span class="p">,</span> <span class="n">IE1</span><span class="p">)</span>
<a name="ln-6396"></a>      <span class="k">CALL </span><span class="n">CalcKBesselFunc</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R2K1</span><span class="p">,</span> <span class="n">IE2</span><span class="p">)</span>
<a name="ln-6397"></a>      <span class="k">CALL </span><span class="n">CalcIBesselFunc</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R2I1</span><span class="p">,</span> <span class="n">IE3</span><span class="p">)</span>
<a name="ln-6398"></a>      <span class="k">CALL </span><span class="n">CalcKBesselFunc</span><span class="p">(</span><span class="n">R1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R1K1</span><span class="p">,</span> <span class="n">IE4</span><span class="p">)</span>
<a name="ln-6399"></a>      <span class="k">CALL </span><span class="n">CalcIBesselFunc</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">R2I0</span><span class="p">,</span> <span class="n">IE5</span><span class="p">)</span>
<a name="ln-6400"></a>      <span class="k">CALL </span><span class="n">CalcKBesselFunc</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">R2K0</span><span class="p">,</span> <span class="n">IE6</span><span class="p">)</span>
<a name="ln-6401"></a>      <span class="n">FEDnumerator</span> <span class="o">=</span> <span class="n">RO</span> <span class="o">*</span> <span class="p">(</span><span class="n">R1I1</span> <span class="o">*</span> <span class="n">R2K1</span> <span class="o">-</span> <span class="n">R2I1</span> <span class="o">*</span> <span class="n">R1K1</span><span class="p">)</span>
<a name="ln-6402"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FEDnumerator</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6403"></a><span class="k">        </span><span class="n">FED</span> <span class="o">=</span> <span class="n">FEDnumerator</span> <span class="o">/</span> <span class="p">(</span><span class="n">R2I0</span> <span class="o">*</span> <span class="n">R1K1</span> <span class="o">+</span> <span class="n">R1I1</span> <span class="o">*</span> <span class="n">R2K0</span><span class="p">)</span>
<a name="ln-6404"></a>      <span class="k">ELSE</span>
<a name="ln-6405"></a><span class="k">        </span><span class="n">FED</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6406"></a>      <span class="n">ENDIF</span>
<a name="ln-6407"></a><span class="c">!      FED = RO * (R1I1 * R2K1 - R2I1 * R1K1) / (R2I0 * R1K1 + R1I1 * R2K0)</span>
<a name="ln-6408"></a>      <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">FAI</span>
<a name="ln-6409"></a>      <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">FED</span>
<a name="ln-6410"></a>    <span class="k">END DO</span>
<a name="ln-6411"></a><span class="k">    CALL </span><span class="n">CalcPolynomCoef</span><span class="p">(</span><span class="n">OrderedPair</span><span class="p">,</span><span class="n">PolynomCoef</span><span class="p">)</span>
<a name="ln-6412"></a>    <span class="k">RETURN</span>
<a name="ln-6413"></a><span class="k">END SUBROUTINE </span><span class="n">CalcDryFinEffCoef</span>
<a name="ln-6414"></a>
<a name="ln-6415"></a><span class="k">SUBROUTINE </span><span class="n">CalcIBesselFunc</span><span class="p">(</span><span class="n">BessFuncArg</span><span class="p">,</span><span class="n">BessFuncOrd</span><span class="p">,</span><span class="n">IBessFunc</span><span class="p">,</span><span class="n">ErrorCode</span><span class="p">)</span>
<a name="ln-6416"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6417"></a>          <span class="c">!       AUTHOR   Unknown</span>
<a name="ln-6418"></a>          <span class="c">!       DATE WRITTEN   Unknown</span>
<a name="ln-6419"></a>          <span class="c">!       DATE REWRITTEN  April 1997 by Russell D. Taylor, Ph.D.</span>
<a name="ln-6420"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-6421"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-6422"></a>
<a name="ln-6423"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6424"></a>          <span class="c">! To calculate the modified Bessel Function from order 0 to BessFuncOrd</span>
<a name="ln-6425"></a>          <span class="c">! BessFuncArg    ARGUMENT OF BESSEL FUNCTION</span>
<a name="ln-6426"></a>          <span class="c">! BessFuncOrd    ORDER OF BESSEL FUNCTION, GREATER THAN OR EQUAL TO ZERO</span>
<a name="ln-6427"></a>          <span class="c">! IBessFunc   RESULTANT VALUE OF I BESSEL FUNCTION</span>
<a name="ln-6428"></a>          <span class="c">! ErrorCode  RESULTANT ERROR CODE:</span>
<a name="ln-6429"></a>          <span class="c">!       ErrorCode = 0   NO ERROR</span>
<a name="ln-6430"></a>          <span class="c">!       ErrorCode = 1   BessFuncOrd .LT. 0</span>
<a name="ln-6431"></a>          <span class="c">!       ErrorCode = 2   BessFuncArg .LT. 0</span>
<a name="ln-6432"></a>          <span class="c">!       ErrorCode = 3   IBessFunc .LT. 10**(-30),     IBessFunc IS SET TO 0</span>
<a name="ln-6433"></a>          <span class="c">!       ErrorCode = 4   BessFuncArg .GT. BessFuncOrd &amp; BessFuncArg .GT. 90,  IBessFunc IS SET TO 10**38</span>
<a name="ln-6434"></a>
<a name="ln-6435"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6436"></a>          <span class="c">! First found in MODSIM.</span>
<a name="ln-6437"></a>
<a name="ln-6438"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6439"></a>          <span class="c">! na</span>
<a name="ln-6440"></a>
<a name="ln-6441"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6442"></a>
<a name="ln-6443"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6444"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BessFuncArg</span>
<a name="ln-6445"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BessFuncOrd</span>
<a name="ln-6446"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IBessFunc</span>
<a name="ln-6447"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ErrorCode</span>
<a name="ln-6448"></a>
<a name="ln-6449"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6450"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ErrorTol</span> <span class="o">=</span> <span class="mf">1.0d-06</span>
<a name="ln-6451"></a>
<a name="ln-6452"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6453"></a>          <span class="c">! na</span>
<a name="ln-6454"></a>
<a name="ln-6455"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6456"></a>          <span class="c">! na</span>
<a name="ln-6457"></a>
<a name="ln-6458"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6459"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopCount</span>
<a name="ln-6460"></a>
<a name="ln-6461"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FI</span>
<a name="ln-6462"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FK</span>
<a name="ln-6463"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TERM</span>
<a name="ln-6464"></a>
<a name="ln-6465"></a>    <span class="n">ErrorCode</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6466"></a>    <span class="n">IBessFunc</span><span class="o">=</span><span class="mf">1.d0</span>
<a name="ln-6467"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncArg</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">BessFuncOrd</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-6468"></a>
<a name="ln-6469"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">BessFuncOrd</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6470"></a><span class="k">      </span><span class="n">ErrorCode</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6471"></a>      <span class="k">RETURN</span>
<a name="ln-6472"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">BessFuncArg</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6473"></a><span class="k">      </span><span class="n">ErrorCode</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-6474"></a>      <span class="k">RETURN</span>
<a name="ln-6475"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">BessFuncArg</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="mf">2.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">BessFuncArg</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">BessFuncOrd</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6476"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">BessFuncArg</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">9</span><span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6477"></a><span class="k">        </span><span class="n">ErrorCode</span> <span class="o">=</span> <span class="mi">4</span>
<a name="ln-6478"></a>        <span class="n">IBessFunc</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.d0</span><span class="o">**</span><span class="mi">30</span>
<a name="ln-6479"></a>        <span class="k">RETURN</span>
<a name="ln-6480"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-6481"></a>      <span class="n">TERM</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-6482"></a>      <span class="n">IBessFunc</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-6483"></a>      <span class="k">DO </span><span class="n">LoopCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span>  <span class="c">!Start of 1st LoopCount Loop</span>
<a name="ln-6484"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TERM</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ErrorTol</span> <span class="o">*</span> <span class="n">IBessFunc</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6485"></a><span class="k">          </span><span class="n">IBessFunc</span> <span class="o">=</span> <span class="n">IBessFunc</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">BessFuncArg</span><span class="p">)</span> <span class="o">/</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mf">2.d0</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">BessFuncArg</span><span class="p">)</span>
<a name="ln-6486"></a>          <span class="k">RETURN</span>
<a name="ln-6487"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6488"></a>        <span class="n">TERM</span> <span class="o">=</span> <span class="n">TERM</span> <span class="o">*</span> <span class="mf">0.125d0</span> <span class="o">/</span> <span class="n">BessFuncArg</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">LoopCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-6489"></a>               <span class="mi">4</span> <span class="o">*</span> <span class="n">BessFuncOrd</span> <span class="o">*</span> <span class="n">BessFuncOrd</span><span class="p">)</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-6490"></a>        <span class="n">IBessFunc</span> <span class="o">=</span> <span class="n">IBessFunc</span> <span class="o">+</span> <span class="n">TERM</span>
<a name="ln-6491"></a>      <span class="k">END DO</span>  <span class="c">! End of 1st LoopCount loop</span>
<a name="ln-6492"></a>    <span class="n">ENDIF</span>
<a name="ln-6493"></a>
<a name="ln-6494"></a>    <span class="n">TERM</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-6495"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncOrd</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6496"></a><span class="k">      DO </span><span class="n">LoopCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">BessFuncOrd</span> <span class="c">!Start of 2nd LoopCount Loop</span>
<a name="ln-6497"></a>        <span class="n">FI</span> <span class="o">=</span> <span class="n">LoopCount</span>
<a name="ln-6498"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TERM</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.d-30</span> <span class="o">*</span> <span class="n">FI</span> <span class="o">/</span> <span class="p">(</span><span class="n">BessFuncArg</span> <span class="o">*</span> <span class="mf">2.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6499"></a><span class="k">          </span><span class="n">ErrorCode</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-6500"></a>          <span class="n">IBessFunc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6501"></a>          <span class="k">RETURN</span>
<a name="ln-6502"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6503"></a>        <span class="n">TERM</span> <span class="o">=</span> <span class="n">TERM</span> <span class="o">*</span> <span class="n">BessFuncArg</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.d0</span> <span class="o">*</span> <span class="n">FI</span><span class="p">)</span>
<a name="ln-6504"></a>      <span class="k">END DO</span> <span class="c">!End of 2nd LoopCount loop</span>
<a name="ln-6505"></a>    <span class="n">ENDIF</span>
<a name="ln-6506"></a>
<a name="ln-6507"></a>    <span class="n">IBessFunc</span> <span class="o">=</span> <span class="n">TERM</span>
<a name="ln-6508"></a>    <span class="k">DO </span><span class="n">LoopCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1000</span> <span class="c">!Start of 3rd LoopCount Loop</span>
<a name="ln-6509"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">TERM</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">IBessFunc</span> <span class="o">*</span> <span class="n">ErrorTol</span><span class="p">))</span> <span class="k">RETURN</span>
<a name="ln-6510"></a><span class="k">      </span><span class="n">FK</span> <span class="o">=</span> <span class="n">LoopCount</span> <span class="o">*</span> <span class="p">(</span><span class="n">BessFuncOrd</span> <span class="o">+</span> <span class="n">LoopCount</span><span class="p">)</span>
<a name="ln-6511"></a>      <span class="n">TERM</span> <span class="o">=</span> <span class="n">TERM</span> <span class="o">*</span> <span class="p">(</span><span class="n">BessFuncArg</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.d0</span> <span class="o">*</span> <span class="n">FK</span><span class="p">))</span>
<a name="ln-6512"></a>      <span class="n">IBessFunc</span> <span class="o">=</span> <span class="n">IBessFunc</span> <span class="o">+</span> <span class="n">TERM</span>
<a name="ln-6513"></a>    <span class="k">END DO</span> <span class="c">!End of  3rd LoopCount loop</span>
<a name="ln-6514"></a>    <span class="k">RETURN</span>
<a name="ln-6515"></a>
<a name="ln-6516"></a><span class="k">END SUBROUTINE </span><span class="n">CalcIBesselFunc</span>
<a name="ln-6517"></a>
<a name="ln-6518"></a><span class="k">SUBROUTINE </span><span class="n">CalcKBesselFunc</span><span class="p">(</span><span class="n">BessFuncArg</span><span class="p">,</span><span class="n">BessFuncOrd</span><span class="p">,</span><span class="n">KBessFunc</span><span class="p">,</span><span class="n">ErrorCode</span><span class="p">)</span>
<a name="ln-6519"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6520"></a>          <span class="c">!       AUTHOR   Unknown</span>
<a name="ln-6521"></a>          <span class="c">!       DATE WRITTEN   Unknown</span>
<a name="ln-6522"></a>          <span class="c">!       DATE REWRITTEN  April 1997 by Russell D. Taylor, Ph.D.</span>
<a name="ln-6523"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-6524"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-6525"></a>
<a name="ln-6526"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6527"></a>          <span class="c">! To calculate the K Bessel Function for a given argument and</span>
<a name="ln-6528"></a>          <span class="c">! order</span>
<a name="ln-6529"></a>          <span class="c">!</span>
<a name="ln-6530"></a>          <span class="c">!  BessFuncArg    THE ARGUMENT OF THE K BESSEL FUNCTION DESIRED</span>
<a name="ln-6531"></a>          <span class="c">!  BessFuncOrd    THE ORDER OF THE K BESSEL FUNCTION DESIRED</span>
<a name="ln-6532"></a>          <span class="c">!  KBessFunc   THE RESULTANT K BESSEL FUNCTION</span>
<a name="ln-6533"></a>          <span class="c">!  ErrorCode  RESULTANT ERROR CODE:</span>
<a name="ln-6534"></a>          <span class="c">!        ErrorCode=0  NO ERROR</span>
<a name="ln-6535"></a>          <span class="c">!        ErrorCode=1  BessFuncOrd IS NEGATIVE</span>
<a name="ln-6536"></a>          <span class="c">!        ErrorCode=2  BessFuncArg IS ZERO OR NEGATIVE</span>
<a name="ln-6537"></a>          <span class="c">!        ErrorCode=3  BessFuncArg .GT. 85, KBessFunc .LT. 10**-38; KBessFunc SET TO 0.</span>
<a name="ln-6538"></a>          <span class="c">!        ErrorCode=4  KBessFunc .GT. 10**38; KBessFunc SET TO 10**38</span>
<a name="ln-6539"></a>          <span class="c">!</span>
<a name="ln-6540"></a>          <span class="c">! NOTE: BessFuncOrd MUST BE GREATER THAN OR EQUAL TO ZERO</span>
<a name="ln-6541"></a>          <span class="c">!</span>
<a name="ln-6542"></a>          <span class="c">! METHOD:</span>
<a name="ln-6543"></a>          <span class="c">!  COMPUTES ZERO ORDER AND FIRST ORDER BESSEL FUNCTIONS USING</span>
<a name="ln-6544"></a>          <span class="c">!  SERIES APPROXIMATIONS AND THEN COMPUTES BessFuncOrd TH ORDER FUNCTION</span>
<a name="ln-6545"></a>          <span class="c">!  USING RECURRENCE RELATION.</span>
<a name="ln-6546"></a>          <span class="c">!  RECURRENCE RELATION AND POLYNOMIAL APPROXIMATION TECHNIQUE</span>
<a name="ln-6547"></a>          <span class="c">!  AS DESCRIBED BY A.J.M. HITCHCOCK, &#39;POLYNOMIAL APPROXIMATIONS</span>
<a name="ln-6548"></a>          <span class="c">!  TO BESSEL FUNCTIONS OF ORDER ZERO AND ONE AND TO RELATED</span>
<a name="ln-6549"></a>          <span class="c">!  FUNCTIONS,&#39; M.T.A.C., V.11, 1957, PP. 86-88, AND G.BessFuncOrd. WATSON,</span>
<a name="ln-6550"></a>          <span class="c">!  &#39;A TREATISE ON THE THEORY OF BESSEL FUNCTIONS,&#39; CAMBRIDGE</span>
<a name="ln-6551"></a>          <span class="c">!  UNIVERSITY PRESS, 1958, P.62</span>
<a name="ln-6552"></a>
<a name="ln-6553"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6554"></a>          <span class="c">! na</span>
<a name="ln-6555"></a>
<a name="ln-6556"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6557"></a>
<a name="ln-6558"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6559"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">BessFuncArg</span>
<a name="ln-6560"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BessFuncOrd</span>
<a name="ln-6561"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">KBessFunc</span>
<a name="ln-6562"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ErrorCode</span>
<a name="ln-6563"></a>
<a name="ln-6564"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6565"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">GJMAX</span> <span class="o">=</span> <span class="mf">1.0d+38</span>
<a name="ln-6566"></a>
<a name="ln-6567"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6568"></a>          <span class="c">! na</span>
<a name="ln-6569"></a>
<a name="ln-6570"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6571"></a>          <span class="c">! na</span>
<a name="ln-6572"></a>
<a name="ln-6573"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6574"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LoopCount</span>
<a name="ln-6575"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">StopLoop</span>
<a name="ln-6576"></a>
<a name="ln-6577"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FACT</span>
<a name="ln-6578"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">G0</span>
<a name="ln-6579"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">G1</span>
<a name="ln-6580"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GJ</span>
<a name="ln-6581"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HJ</span>
<a name="ln-6582"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T</span>
<a name="ln-6583"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X2J</span>
<a name="ln-6584"></a>
<a name="ln-6585"></a>
<a name="ln-6586"></a>    <span class="n">KBessFunc</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6587"></a>    <span class="n">G0</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6588"></a>    <span class="n">GJ</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6589"></a>
<a name="ln-6590"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncOrd</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6591"></a><span class="k">      </span><span class="n">ErrorCode</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-6592"></a>      <span class="k">RETURN</span>
<a name="ln-6593"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">BessFuncArg</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6594"></a><span class="k">      </span><span class="n">ErrorCode</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-6595"></a>      <span class="k">RETURN</span>
<a name="ln-6596"></a><span class="k">    ELSE IF</span><span class="p">(</span><span class="n">BessFuncArg</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">8</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6597"></a><span class="k">      </span><span class="n">ErrorCode</span><span class="o">=</span><span class="mi">3</span>
<a name="ln-6598"></a>      <span class="n">KBessFunc</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6599"></a>      <span class="k">RETURN</span>
<a name="ln-6600"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-6601"></a>
<a name="ln-6602"></a>    <span class="n">ErrorCode</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-6603"></a>
<a name="ln-6604"></a>  <span class="c">!     Use polynomial approximation if BessFuncArg &gt; 1.</span>
<a name="ln-6605"></a>
<a name="ln-6606"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncArg</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6607"></a><span class="k">      </span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">BessFuncArg</span>
<a name="ln-6608"></a>      <span class="k">DO </span><span class="n">LoopCount</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">12</span>
<a name="ln-6609"></a>        <span class="n">T</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">)</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="n">LoopCount</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">BessFuncArg</span>
<a name="ln-6610"></a>      <span class="k">END DO</span> <span class="c">!End of LoopCount Loop</span>
<a name="ln-6611"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncOrd</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6612"></a>
<a name="ln-6613"></a>  <span class="c">!     Compute K0 using polynomial approximation</span>
<a name="ln-6614"></a>
<a name="ln-6615"></a>        <span class="n">G0</span><span class="o">=</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">BessFuncArg</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.2533141d0</span><span class="o">-</span><span class="p">.</span><span class="mi">1566642</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">08811128</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="p">.</span><span class="mi">09139095</span><span class="n">d0</span>    <span class="p">&amp;</span>
<a name="ln-6616"></a>           <span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">1344596</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">-</span><span class="p">.</span><span class="mi">2299850</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">3792410</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">-</span><span class="p">.</span><span class="mi">5247277</span><span class="n">d0</span>  <span class="p">&amp;</span>
<a name="ln-6617"></a>           <span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">5575368</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">-</span><span class="p">.</span><span class="mi">4262633</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">2184518</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>          <span class="p">&amp;</span>
<a name="ln-6618"></a>           <span class="o">-</span><span class="p">.</span><span class="mi">06680977</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">009189383</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">*</span><span class="nb">SQRT</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">BessFuncArg</span><span class="p">)</span>
<a name="ln-6619"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncOrd</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6620"></a><span class="k">          </span><span class="n">KBessFunc</span><span class="o">=</span><span class="n">G0</span>
<a name="ln-6621"></a>          <span class="k">RETURN</span>
<a name="ln-6622"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6623"></a>      <span class="n">ENDIF</span>
<a name="ln-6624"></a>
<a name="ln-6625"></a>  <span class="c">!     Compute K1 using polynomial approximation</span>
<a name="ln-6626"></a>
<a name="ln-6627"></a>      <span class="n">G1</span><span class="o">=</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">BessFuncArg</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.2533141d0</span><span class="o">+</span><span class="p">.</span><span class="mi">4699927</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="p">.</span><span class="mi">1468583</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">1280427</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>    <span class="p">&amp;</span>
<a name="ln-6628"></a>         <span class="o">-</span><span class="p">.</span><span class="mi">1736432</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">2847618</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="p">.</span><span class="mi">4594342</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">6283381</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>     <span class="p">&amp;</span>
<a name="ln-6629"></a>         <span class="o">-</span><span class="p">.</span><span class="mi">6632295</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">5050239</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">-</span><span class="p">.</span><span class="mi">2581304</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="p">.</span><span class="mi">07880001</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-6630"></a>         <span class="o">-</span><span class="p">.</span><span class="mi">01082418</span><span class="n">d0</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">*</span><span class="nb">SQRT</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">BessFuncArg</span><span class="p">)</span>
<a name="ln-6631"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncOrd</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6632"></a><span class="k">        </span><span class="n">KBessFunc</span><span class="o">=</span><span class="n">G1</span>
<a name="ln-6633"></a>        <span class="k">RETURN</span>
<a name="ln-6634"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-6635"></a>    <span class="k">ELSE</span>
<a name="ln-6636"></a>
<a name="ln-6637"></a>  <span class="c">!     Use series expansion if BessFuncArg &lt;= 1.</span>
<a name="ln-6638"></a>
<a name="ln-6639"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncOrd</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6640"></a>
<a name="ln-6641"></a>  <span class="c">!     Compute K0 using series expansion</span>
<a name="ln-6642"></a>
<a name="ln-6643"></a>        <span class="n">G0</span><span class="o">=-</span><span class="p">(.</span><span class="mi">5772157</span><span class="n">d0</span><span class="o">+</span><span class="nb">LOG</span><span class="p">(</span><span class="n">BessFuncArg</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">))</span>
<a name="ln-6644"></a>        <span class="n">X2J</span><span class="o">=</span><span class="mf">1.d0</span>
<a name="ln-6645"></a>        <span class="n">FACT</span><span class="o">=</span><span class="mf">1.d0</span>
<a name="ln-6646"></a>        <span class="n">HJ</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6647"></a>        <span class="k">DO </span><span class="n">LoopCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
<a name="ln-6648"></a>          <span class="n">X2J</span><span class="o">=</span><span class="n">X2J</span><span class="o">*</span><span class="n">BessFuncArg</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">4.0d0</span>
<a name="ln-6649"></a>          <span class="n">FACT</span><span class="o">=</span><span class="n">FACT</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-6650"></a>          <span class="n">HJ</span><span class="o">=</span><span class="n">HJ</span><span class="o">+</span><span class="mf">1.0d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-6651"></a>          <span class="n">G0</span><span class="o">=</span><span class="n">G0</span><span class="o">+</span><span class="n">X2J</span><span class="o">*</span><span class="n">FACT</span><span class="o">*</span><span class="p">(</span><span class="n">HJ</span><span class="o">-</span><span class="p">(.</span><span class="mi">5772157</span><span class="n">d0</span><span class="o">+</span><span class="nb">LOG</span><span class="p">(</span><span class="n">BessFuncArg</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)))</span>
<a name="ln-6652"></a>        <span class="k">END DO</span> <span class="c">!End of LoopCount Loop</span>
<a name="ln-6653"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncOrd</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6654"></a><span class="k">          </span><span class="n">KBessFunc</span><span class="o">=</span><span class="n">G0</span>
<a name="ln-6655"></a>          <span class="k">RETURN</span>
<a name="ln-6656"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6657"></a>      <span class="n">ENDIF</span>
<a name="ln-6658"></a>
<a name="ln-6659"></a>  <span class="c">!     Compute K1 using series expansion</span>
<a name="ln-6660"></a>
<a name="ln-6661"></a>      <span class="n">X2J</span><span class="o">=</span><span class="n">BessFuncArg</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-6662"></a>      <span class="n">FACT</span><span class="o">=</span><span class="mf">1.d0</span>
<a name="ln-6663"></a>      <span class="n">HJ</span><span class="o">=</span><span class="mf">1.d0</span>
<a name="ln-6664"></a>      <span class="n">G1</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">/</span><span class="n">BessFuncArg</span><span class="o">+</span><span class="n">X2J</span><span class="o">*</span><span class="p">(.</span><span class="mi">5</span><span class="n">d0</span><span class="o">+</span><span class="p">(.</span><span class="mi">5772157</span><span class="n">d0</span><span class="o">+</span><span class="nb">LOG</span><span class="p">(</span><span class="n">BessFuncArg</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">))</span><span class="o">-</span><span class="n">HJ</span><span class="p">)</span>
<a name="ln-6665"></a>      <span class="k">DO </span><span class="n">LoopCount</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">8</span>
<a name="ln-6666"></a>        <span class="n">X2J</span><span class="o">=</span><span class="n">X2J</span><span class="o">*</span><span class="n">BessFuncArg</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">4.0d0</span>
<a name="ln-6667"></a>        <span class="n">FACT</span><span class="o">=</span><span class="n">FACT</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-6668"></a>        <span class="n">HJ</span><span class="o">=</span><span class="n">HJ</span><span class="o">+</span><span class="mf">1.0d0</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-6669"></a>        <span class="n">G1</span><span class="o">=</span><span class="n">G1</span><span class="o">+</span><span class="n">X2J</span><span class="o">*</span><span class="n">FACT</span><span class="o">*</span><span class="p">(.</span><span class="mi">5</span><span class="n">d0</span><span class="o">+</span><span class="p">((.</span><span class="mi">5772157</span><span class="n">d0</span><span class="o">+</span><span class="nb">LOG</span><span class="p">(</span><span class="n">BessFuncArg</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">))</span><span class="o">-</span><span class="n">HJ</span><span class="p">)</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">,</span><span class="n">r64</span><span class="p">))</span>
<a name="ln-6670"></a>      <span class="k">END DO</span> <span class="c">!End of LoopCount Loop</span>
<a name="ln-6671"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">BessFuncOrd</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6672"></a><span class="k">        </span><span class="n">KBessFunc</span><span class="o">=</span><span class="n">G1</span>
<a name="ln-6673"></a>        <span class="k">RETURN</span>
<a name="ln-6674"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-6675"></a>    <span class="n">ENDIF</span>
<a name="ln-6676"></a>
<a name="ln-6677"></a>  <span class="c">!     From K0 and K1 compute KN using recurrence relation</span>
<a name="ln-6678"></a>
<a name="ln-6679"></a>    <span class="n">LoopCount</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-6680"></a>    <span class="n">StopLoop</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6681"></a>    <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">LoopCount</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">BessFuncOrd</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">StopLoop</span><span class="p">)</span>
<a name="ln-6682"></a>      <span class="n">GJ</span><span class="o">=</span><span class="mf">2.d0</span><span class="o">*</span><span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">LoopCount</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span><span class="o">*</span><span class="n">G1</span><span class="o">/</span><span class="n">BessFuncArg</span><span class="o">+</span><span class="n">G0</span>
<a name="ln-6683"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GJ</span><span class="o">-</span><span class="n">GJMAX</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6684"></a><span class="k">        </span><span class="n">ErrorCode</span><span class="o">=</span><span class="mi">4</span>
<a name="ln-6685"></a>        <span class="n">GJ</span><span class="o">=</span><span class="n">GJMAX</span>
<a name="ln-6686"></a>        <span class="n">StopLoop</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6687"></a>      <span class="k">ELSE</span>
<a name="ln-6688"></a><span class="k">        </span><span class="n">G0</span><span class="o">=</span><span class="n">G1</span>
<a name="ln-6689"></a>        <span class="n">G1</span><span class="o">=</span><span class="n">GJ</span>
<a name="ln-6690"></a>        <span class="n">LoopCount</span> <span class="o">=</span> <span class="n">LoopCount</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6691"></a>      <span class="k">END IF</span>
<a name="ln-6692"></a><span class="k">    END DO</span> <span class="c">!End of LoopCount Loop</span>
<a name="ln-6693"></a>    <span class="n">KBessFunc</span><span class="o">=</span><span class="n">GJ</span>
<a name="ln-6694"></a>
<a name="ln-6695"></a>    <span class="k">RETURN</span>
<a name="ln-6696"></a><span class="k">END SUBROUTINE </span><span class="n">CalcKBesselFunc</span>
<a name="ln-6697"></a>
<a name="ln-6698"></a><span class="k">SUBROUTINE </span><span class="n">CalcPolynomCoef</span><span class="p">(</span><span class="n">OrderedPair</span><span class="p">,</span><span class="n">PolynomCoef</span><span class="p">)</span>
<a name="ln-6699"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6700"></a>          <span class="c">!       AUTHOR   Unknown</span>
<a name="ln-6701"></a>          <span class="c">!       DATE WRITTEN   Unknown</span>
<a name="ln-6702"></a>          <span class="c">!       DATE REWRITTEN  April 1997 by Russell D. Taylor, Ph.D.</span>
<a name="ln-6703"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-6704"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-6705"></a>
<a name="ln-6706"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6707"></a>          <span class="c">! Fits polynomial of order from 1 to MaxPolynomOrder to the</span>
<a name="ln-6708"></a>          <span class="c">! ordered pairs of data points X,Y</span>
<a name="ln-6709"></a>
<a name="ln-6710"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6711"></a>          <span class="c">! na</span>
<a name="ln-6712"></a>
<a name="ln-6713"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6714"></a>
<a name="ln-6715"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6716"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxPolynomOrder</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PolynomCoef</span>
<a name="ln-6717"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">MaxOrderedPairs</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OrderedPair</span>
<a name="ln-6718"></a>
<a name="ln-6719"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6720"></a>          <span class="c">! na</span>
<a name="ln-6721"></a>
<a name="ln-6722"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6723"></a>          <span class="c">! na</span>
<a name="ln-6724"></a>
<a name="ln-6725"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6726"></a>          <span class="c">! na</span>
<a name="ln-6727"></a>
<a name="ln-6728"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6729"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">Converged</span>
<a name="ln-6730"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OrdPairSum</span>
<a name="ln-6731"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OrdPairSumMatrix</span>
<a name="ln-6732"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">B</span>
<a name="ln-6733"></a>    <span class="kt">INTEGER </span><span class="n">I</span><span class="p">,</span><span class="n">II</span><span class="p">,</span><span class="n">J</span>
<a name="ln-6734"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">PolynomOrder</span>
<a name="ln-6735"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurrentOrder</span>
<a name="ln-6736"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurrentOrdPair</span>
<a name="ln-6737"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">S1</span><span class="p">,</span><span class="n">S2</span>
<a name="ln-6738"></a>
<a name="ln-6739"></a>    <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">MaxOrderedPairs</span>
<a name="ln-6740"></a>    <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6741"></a>    <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6742"></a>    <span class="n">PolynomCoef</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6743"></a>    <span class="k">DO </span><span class="n">CurrentOrdPair</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MaxOrderedPairs</span>
<a name="ln-6744"></a>      <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">CurrentOrdPair</span><span class="p">)</span>
<a name="ln-6745"></a>      <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">CurrentOrdPair</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6746"></a>                        <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">CurrentOrdPair</span><span class="p">)</span>
<a name="ln-6747"></a>      <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">CurrentOrdPair</span><span class="p">)</span>
<a name="ln-6748"></a>      <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">CurrentOrdPair</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6749"></a>                        <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">CurrentOrdPair</span><span class="p">)</span>
<a name="ln-6750"></a>    <span class="k">END DO</span>
<a name="ln-6751"></a><span class="k">    </span><span class="n">PolynomOrder</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-6752"></a>    <span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6753"></a>    <span class="k">DO WHILE</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Converged</span><span class="p">)</span>
<a name="ln-6754"></a>      <span class="k">DO </span><span class="n">CurrentOrder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6755"></a>        <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6756"></a>          <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="n">CurrentOrder</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">CurrentOrder</span><span class="p">)</span>
<a name="ln-6757"></a>        <span class="k">END DO</span> <span class="c">!End of J loop</span>
<a name="ln-6758"></a>        <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="n">CurrentOrder</span><span class="p">,</span> <span class="p">(</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span> <span class="o">=</span> <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">CurrentOrder</span><span class="p">)</span>
<a name="ln-6759"></a>      <span class="k">END DO</span> <span class="c">!End of CurrentOrder loop</span>
<a name="ln-6760"></a>
<a name="ln-6761"></a>      <span class="k">DO </span><span class="n">CurrentOrder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6762"></a>        <span class="n">OrdPairSumMatrix</span><span class="p">((</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">CurrentOrder</span><span class="p">)</span><span class="o">=</span> <span class="o">-</span><span class="mf">1.d0</span>
<a name="ln-6763"></a>        <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="n">CurrentOrder</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,(</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-6764"></a>          <span class="n">OrdPairSumMatrix</span><span class="p">((</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6765"></a>        <span class="k">END DO</span> <span class="c">!End of J loop</span>
<a name="ln-6766"></a>
<a name="ln-6767"></a>        <span class="k">DO </span><span class="n">II</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-6768"></a>          <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="n">CurrentOrder</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-6769"></a>            <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="n">II</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="n">II</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">-</span> <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6770"></a>                                      <span class="o">*</span> <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="n">II</span><span class="p">,</span> <span class="n">CurrentOrder</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6771"></a>                                      <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">CurrentOrder</span><span class="p">)</span>
<a name="ln-6772"></a>          <span class="k">END DO</span> <span class="c">!End of J loop</span>
<a name="ln-6773"></a>        <span class="k">END DO</span> <span class="c">!End of II loop</span>
<a name="ln-6774"></a>        <span class="k">DO </span><span class="n">II</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6775"></a>          <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="n">CurrentOrder</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-6776"></a>            <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="n">II</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="n">II</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>
<a name="ln-6777"></a>          <span class="k">END DO</span> <span class="c">!End of J loop</span>
<a name="ln-6778"></a>        <span class="k">END DO</span> <span class="c">!End of II loop</span>
<a name="ln-6779"></a>      <span class="k">END DO</span> <span class="c">!End of CurrentOrder loop</span>
<a name="ln-6780"></a>
<a name="ln-6781"></a>      <span class="n">S2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6782"></a>      <span class="k">DO </span><span class="n">CurrentOrdPair</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MaxOrderedPairs</span>
<a name="ln-6783"></a>        <span class="n">S1</span> <span class="o">=</span> <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-6784"></a>        <span class="k">DO </span><span class="n">CurrentOrder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PolynomOrder</span>
<a name="ln-6785"></a>          <span class="n">S1</span> <span class="o">=</span> <span class="n">S1</span> <span class="o">+</span> <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="n">CurrentOrder</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,(</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6786"></a>               <span class="o">*</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">CurrentOrdPair</span><span class="p">)</span><span class="o">**</span><span class="n">CurrentOrder</span>
<a name="ln-6787"></a>        <span class="k">END DO</span> <span class="c">!End of CurrentOrder loop</span>
<a name="ln-6788"></a>        <span class="n">S2</span> <span class="o">=</span> <span class="n">S2</span> <span class="o">+</span> <span class="p">(</span><span class="n">S1</span> <span class="o">-</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">CurrentOrdPair</span><span class="p">))</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6789"></a>             <span class="p">(</span><span class="n">S1</span> <span class="o">-</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">CurrentOrdPair</span><span class="p">))</span>
<a name="ln-6790"></a>      <span class="k">END DO</span> <span class="c">!End of CurrentOrdPair loop</span>
<a name="ln-6791"></a>      <span class="n">B</span> <span class="o">=</span> <span class="n">MaxOrderedPairs</span> <span class="o">-</span> <span class="p">(</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-6792"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">S2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0001d0</span><span class="p">)</span> <span class="n">S2</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">S2</span> <span class="o">/</span> <span class="n">B</span><span class="p">)</span>
<a name="ln-6793"></a>      <span class="k">DO </span><span class="n">CurrentOrder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6794"></a>        <span class="n">PolynomCoef</span><span class="p">(</span><span class="n">CurrentOrder</span><span class="p">)</span> <span class="o">=</span> <span class="n">OrdPairSumMatrix</span><span class="p">(</span><span class="n">CurrentOrder</span><span class="p">,</span> <span class="p">(</span><span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-6795"></a>      <span class="k">END DO</span> <span class="c">!End of CurrentOrder loop</span>
<a name="ln-6796"></a>
<a name="ln-6797"></a>      <span class="k">IF</span> <span class="p">(((</span><span class="n">PolynomOrder</span> <span class="o">-</span> <span class="n">MaxPolynomOrder</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6798"></a>          <span class="p">((</span><span class="n">S2</span> <span class="o">-</span> <span class="n">PolyConvgTol</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6799"></a><span class="k">        </span><span class="n">PolynomOrder</span> <span class="o">=</span> <span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6800"></a>        <span class="n">J</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">PolynomOrder</span>
<a name="ln-6801"></a>        <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="p">:</span><span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6802"></a>        <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">PolynomOrder</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6803"></a>        <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MaxOrderedPairs</span>
<a name="ln-6804"></a>          <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span> <span class="o">+</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6805"></a>          <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span><span class="o">**</span><span class="n">J</span>
<a name="ln-6806"></a>          <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">PolynomOrder</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">OrdPairSum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">PolynomOrder</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6807"></a>                                          <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="n">OrderedPair</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span><span class="o">**</span><span class="n">PolynomOrder</span>
<a name="ln-6808"></a>        <span class="k">END DO</span>
<a name="ln-6809"></a><span class="k">      ELSE</span>
<a name="ln-6810"></a><span class="k">        </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6811"></a>      <span class="k">END IF</span>
<a name="ln-6812"></a>
<a name="ln-6813"></a><span class="k">    END DO</span>
<a name="ln-6814"></a>
<a name="ln-6815"></a><span class="k">    RETURN</span>
<a name="ln-6816"></a><span class="k">END SUBROUTINE </span><span class="n">CalcPolynomCoef</span>
<a name="ln-6817"></a>
<a name="ln-6818"></a><span class="k">FUNCTION </span><span class="n">SimpleHeatingCoilUAResidual</span><span class="p">(</span><span class="n">UA</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-6819"></a>
<a name="ln-6820"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-6821"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-6822"></a>          <span class="c">!       DATE WRITTEN   November 2001</span>
<a name="ln-6823"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-6824"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-6825"></a>
<a name="ln-6826"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-6827"></a>          <span class="c">! Calculates residual function (Design Coil Load - Coil Heating Output) / Design Coil Load.</span>
<a name="ln-6828"></a>          <span class="c">! Coil Heating Output depends on the UA which is being varied to zero the residual.</span>
<a name="ln-6829"></a>
<a name="ln-6830"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6831"></a>          <span class="c">! Puts UA into the water coil data structure, calls CalcSimpleHeatingCoil, and calculates</span>
<a name="ln-6832"></a>          <span class="c">! the residual as defined above.</span>
<a name="ln-6833"></a>
<a name="ln-6834"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6835"></a>
<a name="ln-6836"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6837"></a>          <span class="c">! na</span>
<a name="ln-6838"></a>
<a name="ln-6839"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6840"></a>
<a name="ln-6841"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6842"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UA</span> <span class="c">! UA of coil</span>
<a name="ln-6843"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = design coil load [W]</span>
<a name="ln-6844"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-6845"></a>
<a name="ln-6846"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-6847"></a>          <span class="c">! na</span>
<a name="ln-6848"></a>
<a name="ln-6849"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6850"></a>          <span class="c">! na</span>
<a name="ln-6851"></a>
<a name="ln-6852"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6853"></a>          <span class="c">! na</span>
<a name="ln-6854"></a>
<a name="ln-6855"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6856"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoilIndex</span>
<a name="ln-6857"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-6858"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-6859"></a>
<a name="ln-6860"></a>  <span class="n">CoilIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-6861"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6862"></a><span class="k">    </span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-6863"></a>  <span class="k">ELSE</span>
<a name="ln-6864"></a><span class="k">    </span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">ContFanCycCoil</span>
<a name="ln-6865"></a>  <span class="k">END IF</span>
<a name="ln-6866"></a><span class="k">  </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-6867"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilVariable</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-6868"></a>  <span class="k">CALL </span><span class="n">CalcSimpleHeatingCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">SimCalc</span><span class="p">)</span>
<a name="ln-6869"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">TotWaterHeatingCoilRate</span><span class="p">)</span> <span class="o">/</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6870"></a>
<a name="ln-6871"></a>  <span class="k">RETURN</span>
<a name="ln-6872"></a><span class="k">END FUNCTION </span><span class="n">SimpleHeatingCoilUAResidual</span>
<a name="ln-6873"></a>
<a name="ln-6874"></a><span class="k">FUNCTION </span><span class="n">SimpleCoolingCoilUAResidual</span><span class="p">(</span><span class="n">UA</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-6875"></a>
<a name="ln-6876"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-6877"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-6878"></a>          <span class="c">!       DATE WRITTEN   September 2011</span>
<a name="ln-6879"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-6880"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-6881"></a>
<a name="ln-6882"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-6883"></a>          <span class="c">! Calculates residual function (Design Coil Load - Coil Cooling Output) / Design Coil Load.</span>
<a name="ln-6884"></a>          <span class="c">! Coil Cooling Output depends on the UA which is being varied to zero the residual.</span>
<a name="ln-6885"></a>
<a name="ln-6886"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6887"></a>          <span class="c">! Puts UA into the water coil data structure, calls CoolingCoil, and calculates</span>
<a name="ln-6888"></a>          <span class="c">! the residual as defined above.</span>
<a name="ln-6889"></a>
<a name="ln-6890"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6891"></a>
<a name="ln-6892"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6893"></a>          <span class="c">! na</span>
<a name="ln-6894"></a>
<a name="ln-6895"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6896"></a>
<a name="ln-6897"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6898"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">UA</span> <span class="c">! UA of coil</span>
<a name="ln-6899"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = design coil load [W]</span>
<a name="ln-6900"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-6901"></a>
<a name="ln-6902"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-6903"></a>          <span class="c">! na</span>
<a name="ln-6904"></a>
<a name="ln-6905"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6906"></a>          <span class="c">! na</span>
<a name="ln-6907"></a>
<a name="ln-6908"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6909"></a>          <span class="c">! na</span>
<a name="ln-6910"></a>
<a name="ln-6911"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6912"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoilIndex</span>
<a name="ln-6913"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-6914"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-6915"></a>
<a name="ln-6916"></a>  <span class="n">CoilIndex</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-6917"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6918"></a><span class="k">    </span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-6919"></a>  <span class="k">ELSE</span>
<a name="ln-6920"></a><span class="k">    </span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">ContFanCycCoil</span>
<a name="ln-6921"></a>  <span class="k">END IF</span>
<a name="ln-6922"></a><span class="k">  </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-6923"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="o">=</span> <span class="n">UA</span>
<a name="ln-6924"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilInternal</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">*</span><span class="mf">3.3d0</span>
<a name="ln-6925"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilTotal</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">+</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">)</span>
<a name="ln-6926"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span><span class="o">=</span><span class="n">EstimateHEXSurfaceArea</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)</span>
<a name="ln-6927"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilInternalPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-6928"></a>                                                 <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-6929"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UACoilExternal</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">TotCoilOutsideSurfArea</span>
<a name="ln-6930"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UADryExtPerUnitArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">UAWetExtPerUnitArea</span>
<a name="ln-6931"></a>
<a name="ln-6932"></a>  <span class="k">CALL </span><span class="n">CoolingCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">,</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">DesignCalc</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-6933"></a>
<a name="ln-6934"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilIndex</span><span class="p">)%</span><span class="n">TotWaterCoolingCoilRate</span><span class="p">)</span> <span class="o">/</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6935"></a>
<a name="ln-6936"></a>  <span class="k">RETURN</span>
<a name="ln-6937"></a><span class="k">END FUNCTION </span><span class="n">SimpleCoolingCoilUAResidual</span>
<a name="ln-6938"></a>
<a name="ln-6939"></a><span class="c">! Iterate Routine for Cooling Coil</span>
<a name="ln-6940"></a><span class="k">Subroutine </span><span class="n">CoilAreaFracIter</span><span class="p">(</span><span class="n">NewSurfAreaWetFrac</span><span class="p">,</span> <span class="n">SurfAreaFracCurrent</span><span class="p">,</span><span class="n">ErrorCurrent</span><span class="p">,</span><span class="n">SurfAreaFracPrevious</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6941"></a>                                       <span class="n">ErrorPrevious</span><span class="p">,</span><span class="n">SurfAreaFracLast</span><span class="p">,</span><span class="n">ErrorLast</span><span class="p">,</span><span class="n">IterNum</span><span class="p">,</span><span class="n">ICvg</span><span class="p">)</span>
<a name="ln-6942"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-6943"></a>          <span class="c">! AUTHOR         Rahul Chillar</span>
<a name="ln-6944"></a>          <span class="c">! DATE WRITTEN   June 2004</span>
<a name="ln-6945"></a>          <span class="c">! MODIFIED       na</span>
<a name="ln-6946"></a>          <span class="c">! RE-ENGINEERED  na</span>
<a name="ln-6947"></a>
<a name="ln-6948"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-6949"></a>          <span class="c">! Iterately solves for the value of SurfAreaWetFraction for the Cooling Coil.</span>
<a name="ln-6950"></a>
<a name="ln-6951"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6952"></a>          <span class="c">! First function generates 2 sets of guess points by perturbation and subsequently</span>
<a name="ln-6953"></a>          <span class="c">! by Linear Fit and using the generated points calculates coeffecients for Quadratic</span>
<a name="ln-6954"></a>          <span class="c">! fit to predict the next value of surface area wet fraction.</span>
<a name="ln-6955"></a>
<a name="ln-6956"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6957"></a>          <span class="c">! ME 423 Design of Thermal Systems Class Notes.UIUC. W.F.Stoecker</span>
<a name="ln-6958"></a>
<a name="ln-6959"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6960"></a>          <span class="c">! na</span>
<a name="ln-6961"></a>
<a name="ln-6962"></a>          <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6963"></a>       <span class="k">Implicit None</span>
<a name="ln-6964"></a>
<a name="ln-6965"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-6966"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">Out</span><span class="p">)</span><span class="kd">::</span> <span class="n">NewSurfAreaWetFrac</span>    <span class="c">! Out Value of variable</span>
<a name="ln-6967"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAreaFracCurrent</span>   <span class="c">! Driver Value</span>
<a name="ln-6968"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorCurrent</span>          <span class="c">! Objective Function</span>
<a name="ln-6969"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorPrevious</span>          <span class="c">! First Previous value of error</span>
<a name="ln-6970"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ErrorLast</span>              <span class="c">! Second Previous value of error</span>
<a name="ln-6971"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAreaFracPrevious</span>   <span class="c">! First Previous value of Surf Area Fraction</span>
<a name="ln-6972"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAreaFracLast</span>       <span class="c">! Second Previous value of Surf Area Fraction</span>
<a name="ln-6973"></a>       <span class="kt">Integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IterNum</span>             <span class="c">! Number of Iterations</span>
<a name="ln-6974"></a>       <span class="kt">Integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">icvg</span>                <span class="c">! Iteration convergence flag</span>
<a name="ln-6975"></a>
<a name="ln-6976"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-6977"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Parameter</span><span class="kd">::</span> <span class="n">Tolerance</span> <span class="o">=</span><span class="mf">1.d-5</span>         <span class="c">! Relative error tolerance</span>
<a name="ln-6978"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Parameter</span><span class="kd">::</span> <span class="n">PerturbSurfAreaFrac</span><span class="o">=</span> <span class="mf">0.1d0</span> <span class="c">! Perturbation applied to Surf Fraction to initialize iteration</span>
<a name="ln-6979"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Parameter</span><span class="kd">::</span> <span class="n">SmallNum</span><span class="o">=</span> <span class="mf">1.d-9</span>          <span class="c">! Small Number</span>
<a name="ln-6980"></a>
<a name="ln-6981"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6982"></a>          <span class="c">! na</span>
<a name="ln-6983"></a>
<a name="ln-6984"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6985"></a>          <span class="c">! na</span>
<a name="ln-6986"></a>
<a name="ln-6987"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6988"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">check</span>                          <span class="c">! Validity Check for moving to Quad Solution</span>
<a name="ln-6989"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QuadCoefThree</span>                  <span class="c">! Term under radical in quadratic solution</span>
<a name="ln-6990"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QuadCoefOne</span>            <span class="c">! Term under radical in quadratic solution</span>
<a name="ln-6991"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QuadCoefTwo</span>            <span class="c">! Term under radical in quadratic solution</span>
<a name="ln-6992"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Slope</span>                  <span class="c">! Slope for linear fit</span>
<a name="ln-6993"></a>       <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfAreaFracOther</span>      <span class="c">! Intermediate Value of Surf Area</span>
<a name="ln-6994"></a>       <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">mode</span>                <span class="c">! Linear/ perturbation option</span>
<a name="ln-6995"></a>
<a name="ln-6996"></a>        <span class="c">! Convergence Check  by comparing previous and current value of surf area fraction</span>
<a name="ln-6997"></a>      <span class="k">IF</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfAreaFracCurrent</span><span class="o">-</span><span class="n">SurfAreaFracPrevious</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Tolerance</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfAreaFracCurrent</span><span class="p">),</span><span class="n">SmallNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>               <span class="p">&amp;</span>
<a name="ln-6998"></a>          <span class="n">IterNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ErrorCurrent</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6999"></a>        <span class="c">! Setting value for surface area fraction for coil</span>
<a name="ln-7000"></a>        <span class="n">NewSurfAreaWetFrac</span> <span class="o">=</span> <span class="n">SurfAreaFracCurrent</span>
<a name="ln-7001"></a>        <span class="n">ICvg</span><span class="o">=</span><span class="mi">1</span>  <span class="c">! Convergance Flag</span>
<a name="ln-7002"></a>        <span class="k">RETURN</span>
<a name="ln-7003"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-7004"></a>
<a name="ln-7005"></a>        <span class="c">! If Icvg = 0 , it has not converged.By perturbation for getting second set of</span>
<a name="ln-7006"></a>        <span class="c">! data (mode=1), Getting Third set of data by performing a  linear fit(Mode=2).</span>
<a name="ln-7007"></a>        <span class="c">! Now using the above 3 points generated by perturbation and Linear Fit to perform</span>
<a name="ln-7008"></a>        <span class="c">! a quadratic fit.This will happen after second iteration only.</span>
<a name="ln-7009"></a>      <span class="n">ICvg</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Convergance flag = false</span>
<a name="ln-7010"></a>        <span class="c">! For First Iteration Start with perturbation, For second iteration start with linear fit</span>
<a name="ln-7011"></a>        <span class="c">! from the previous two values</span>
<a name="ln-7012"></a>      <span class="n">mode</span><span class="o">=</span><span class="n">IterNum</span>
<a name="ln-7013"></a>
<a name="ln-7014"></a><span class="mi">10</span>    <span class="k">IF</span> <span class="p">(</span><span class="n">mode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7015"></a>
<a name="ln-7016"></a>        <span class="c">! FirstGuess Set of Points provided by perturbation</span>
<a name="ln-7017"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SurfAreaFracCurrent</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7018"></a><span class="k">          </span><span class="n">NewSurfAreaWetFrac</span> <span class="o">=</span> <span class="n">SurfAreaFracCurrent</span><span class="o">*</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">+</span><span class="n">PerturbSurfAreaFrac</span><span class="p">)</span>
<a name="ln-7019"></a>        <span class="k">ELSE</span>
<a name="ln-7020"></a><span class="k">          </span><span class="n">NewSurfAreaWetFrac</span> <span class="o">=</span> <span class="n">PerturbSurfAreaFrac</span>
<a name="ln-7021"></a>        <span class="n">ENDIF</span>
<a name="ln-7022"></a>
<a name="ln-7023"></a>        <span class="c">! Second set of values being calculated from the first set of values (incoming &amp; perturb)</span>
<a name="ln-7024"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">mode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7025"></a>
<a name="ln-7026"></a>        <span class="c">! Calculating Slope for interpolating to the New Point (Simple Linear Extrapolation)</span>
<a name="ln-7027"></a>        <span class="n">Slope</span><span class="o">=</span><span class="p">(</span><span class="n">ErrorPrevious</span><span class="o">-</span><span class="n">ErrorCurrent</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SurfAreaFracPrevious</span><span class="o">-</span><span class="n">SurfAreaFracCurrent</span><span class="p">)</span>
<a name="ln-7028"></a>        <span class="c">! Error Check for value or Slope</span>
<a name="ln-7029"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">Slope</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7030"></a><span class="k">              </span><span class="n">mode</span><span class="o">=</span><span class="mi">1</span> <span class="c">! Go back to Perturbation</span>
<a name="ln-7031"></a>              <span class="n">GO</span> <span class="n">TO</span> <span class="mi">10</span>
<a name="ln-7032"></a>           <span class="n">ENDIF</span>
<a name="ln-7033"></a>        <span class="c">! Guessing New Value for Surface Area Fraction</span>
<a name="ln-7034"></a>        <span class="n">NewSurfAreaWetFrac</span><span class="o">=</span><span class="n">SurfAreaFracCurrent</span><span class="o">-</span><span class="n">ErrorCurrent</span><span class="o">/</span><span class="n">Slope</span>
<a name="ln-7035"></a>      <span class="k">ELSE</span>
<a name="ln-7036"></a>
<a name="ln-7037"></a>        <span class="c">! Check for Quadratic Fit possible here ,Previous value of surf area fraction</span>
<a name="ln-7038"></a>        <span class="c">! equals current value then Try linear fit for another point.</span>
<a name="ln-7039"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfAreaFracCurrent</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfAreaFracPrevious</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7040"></a>        <span class="c">! Assign Value of previous point to Last Variable for storing</span>
<a name="ln-7041"></a>        <span class="c">! Go back and calculate new value for Previous.</span>
<a name="ln-7042"></a>          <span class="n">SurfAreaFracPrevious</span><span class="o">=</span><span class="n">SurfAreaFracLast</span>
<a name="ln-7043"></a>          <span class="n">ErrorPrevious</span><span class="o">=</span><span class="n">ErrorLast</span>
<a name="ln-7044"></a>          <span class="n">mode</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-7045"></a>          <span class="n">GO</span> <span class="n">TO</span> <span class="mi">10</span>
<a name="ln-7046"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfAreaFracCurrent</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfAreaFracLast</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7047"></a>        <span class="c">! Calculate another value using Linear Fit.</span>
<a name="ln-7048"></a>          <span class="n">mode</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-7049"></a>          <span class="n">GO</span> <span class="n">TO</span> <span class="mi">10</span>
<a name="ln-7050"></a>        <span class="n">ENDIF</span>
<a name="ln-7051"></a>
<a name="ln-7052"></a>        <span class="c">! Now We have enough previous points to calculate coefficients and</span>
<a name="ln-7053"></a>        <span class="c">! perform a quadratic fit for new guess value of surface area fraction</span>
<a name="ln-7054"></a>
<a name="ln-7055"></a>        <span class="c">! Calculating First Coefficients for Quadratic Curve Fit</span>
<a name="ln-7056"></a>        <span class="n">QuadCoefThree</span><span class="o">=</span><span class="p">((</span><span class="n">ErrorLast</span><span class="o">-</span><span class="n">ErrorCurrent</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SurfAreaFracLast</span><span class="o">-</span><span class="n">SurfAreaFracCurrent</span><span class="p">)</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-7057"></a>                     <span class="p">(</span><span class="n">ErrorPrevious</span><span class="o">-</span><span class="n">ErrorCurrent</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SurfAreaFracPrevious</span><span class="o">-</span><span class="n">SurfAreaFracCurrent</span><span class="p">))</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-7058"></a>                                                            <span class="p">(</span><span class="n">SurfAreaFracLast</span><span class="o">-</span><span class="n">SurfAreaFracPrevious</span><span class="p">)</span>
<a name="ln-7059"></a>        <span class="c">! Calculating Second Coefficients for Quadratic Curve Fit</span>
<a name="ln-7060"></a>        <span class="n">QuadCoefTwo</span><span class="o">=</span><span class="p">(</span><span class="n">ErrorPrevious</span><span class="o">-</span><span class="n">ErrorCurrent</span><span class="p">)</span><span class="o">/</span>   <span class="p">&amp;</span>
<a name="ln-7061"></a>                                    <span class="p">(</span><span class="n">SurfAreaFracPrevious</span><span class="o">-</span><span class="n">SurfAreaFracCurrent</span><span class="p">)</span><span class="o">-</span>  <span class="p">&amp;</span>
<a name="ln-7062"></a>                                      <span class="p">(</span><span class="n">SurfAreaFracPrevious</span><span class="o">+</span><span class="n">SurfAreaFracCurrent</span><span class="p">)</span><span class="o">*</span><span class="n">QuadCoefThree</span>
<a name="ln-7063"></a>
<a name="ln-7064"></a>        <span class="c">! Calculating Third Coefficients for Quadratic Curve Fit</span>
<a name="ln-7065"></a>        <span class="n">QuadCoefOne</span><span class="o">=</span><span class="n">ErrorCurrent</span><span class="o">-</span><span class="p">(</span><span class="n">QuadCoefTwo</span><span class="o">+</span><span class="n">QuadCoefThree</span><span class="o">*</span><span class="n">SurfAreaFracCurrent</span><span class="p">)</span><span class="o">*</span><span class="n">SurfAreaFracCurrent</span>
<a name="ln-7066"></a>
<a name="ln-7067"></a>        <span class="c">! Check for validity of coefficients , if not REAL(r64) ,Then fit is linear</span>
<a name="ln-7068"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">QuadCoefThree</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.D-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7069"></a><span class="k">          </span><span class="n">mode</span><span class="o">=</span><span class="mi">2</span>  <span class="c">! going to Linear mode, due to colinear points.</span>
<a name="ln-7070"></a>          <span class="n">GO</span> <span class="n">TO</span> <span class="mi">10</span>
<a name="ln-7071"></a>        <span class="n">ENDIF</span>
<a name="ln-7072"></a>
<a name="ln-7073"></a>        <span class="c">! If value of Quadratic coefficients not suitable enought due to round off errors</span>
<a name="ln-7074"></a>        <span class="c">! to predict new point go to linear fit and acertain new values for the coefficients.</span>
<a name="ln-7075"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">QuadCoefOne</span><span class="o">+</span><span class="p">(</span><span class="n">QuadCoefTwo</span><span class="o">+</span><span class="n">QuadCoefThree</span><span class="o">*</span><span class="n">SurfAreaFracPrevious</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7076"></a>                  <span class="n">SurfAreaFracPrevious</span><span class="o">-</span><span class="n">ErrorPrevious</span><span class="p">)</span><span class="o">/</span><span class="n">ErrorPrevious</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.D-4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7077"></a><span class="k">           </span><span class="n">mode</span><span class="o">=</span><span class="mi">2</span> <span class="c">! go to linear mode</span>
<a name="ln-7078"></a>           <span class="n">GO</span> <span class="n">TO</span> <span class="mi">10</span>
<a name="ln-7079"></a>        <span class="n">ENDIF</span>
<a name="ln-7080"></a>
<a name="ln-7081"></a>        <span class="c">! Validity Check for Imaginary roots, In this case go back to linear fit.</span>
<a name="ln-7082"></a>        <span class="n">check</span><span class="o">=</span><span class="n">QuadCoefTwo</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mf">4.0d0</span><span class="o">*</span><span class="n">QuadCoefOne</span><span class="o">*</span><span class="n">QuadCoefThree</span>
<a name="ln-7083"></a>        <span class="c">! Imaginary Root Exist</span>
<a name="ln-7084"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">check</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7085"></a><span class="k">           </span><span class="n">mode</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-7086"></a>           <span class="n">GO</span> <span class="n">TO</span> <span class="mi">10</span>
<a name="ln-7087"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">check</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7088"></a>          <span class="c">! real unequal roots exist, Determine the roots nearest to most recent guess</span>
<a name="ln-7089"></a>          <span class="n">NewSurfAreaWetFrac</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">QuadCoefTwo</span><span class="o">+</span><span class="nb">SQRT</span><span class="p">(</span><span class="n">check</span><span class="p">))</span><span class="o">/</span><span class="n">QuadCoefThree</span><span class="o">/</span><span class="mf">2.0d0</span>
<a name="ln-7090"></a>          <span class="n">SurfAreaFracOther</span><span class="o">=-</span><span class="n">NewSurfAreaWetFrac</span><span class="o">-</span><span class="n">QuadCoefTwo</span><span class="o">/</span><span class="n">QuadCoefThree</span>
<a name="ln-7091"></a>          <span class="c">! Assigning value to Surface Area Fraction with recent</span>
<a name="ln-7092"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">NewSurfAreaWetFrac</span><span class="o">-</span><span class="n">SurfAreaFracCurrent</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7093"></a>                                   <span class="nb">ABS</span><span class="p">(</span><span class="n">SurfAreaFracOther</span><span class="o">-</span><span class="n">SurfAreaFracCurrent</span><span class="p">))</span> <span class="n">NewSurfAreaWetFrac</span><span class="o">=</span><span class="n">SurfAreaFracOther</span>
<a name="ln-7094"></a>        <span class="k">ELSE</span>
<a name="ln-7095"></a>          <span class="c">! The roots are real, one solution exists.</span>
<a name="ln-7096"></a>          <span class="n">NewSurfAreaWetFrac</span><span class="o">=-</span><span class="n">QuadCoefTwo</span><span class="o">/</span><span class="n">QuadCoefThree</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-7097"></a>        <span class="n">ENDIF</span>
<a name="ln-7098"></a>
<a name="ln-7099"></a>      <span class="n">ENDIF</span>
<a name="ln-7100"></a>
<a name="ln-7101"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">mode</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7102"></a>        <span class="c">! No valid previous points to eliminate, since it just has 2 points.</span>
<a name="ln-7103"></a>        <span class="c">! Loading previous values into last</span>
<a name="ln-7104"></a>        <span class="n">SurfAreaFracLast</span><span class="o">=</span><span class="n">SurfAreaFracPrevious</span>
<a name="ln-7105"></a>        <span class="n">ErrorLast</span><span class="o">=</span><span class="n">ErrorPrevious</span>
<a name="ln-7106"></a>        <span class="c">! Loading Current Values into previous</span>
<a name="ln-7107"></a>        <span class="n">SurfAreaFracPrevious</span><span class="o">=</span><span class="n">SurfAreaFracCurrent</span>
<a name="ln-7108"></a>        <span class="n">ErrorPrevious</span><span class="o">=</span><span class="n">ErrorCurrent</span>
<a name="ln-7109"></a>      <span class="k">ELSE</span>
<a name="ln-7110"></a>
<a name="ln-7111"></a>        <span class="c">! Elimination the most distance previous point from the answer based on sign and</span>
<a name="ln-7112"></a>        <span class="c">! magnitute of the error. Keeping Current Point</span>
<a name="ln-7113"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorPrevious</span><span class="o">*</span><span class="n">ErrorCurrent</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ErrorLast</span><span class="o">*</span><span class="n">ErrorCurrent</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7114"></a>            <span class="c">! If sign are same , simply eliminate the one with biggest error value.</span>
<a name="ln-7115"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ErrorLast</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ErrorPrevious</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7116"></a>            <span class="c">! Eliminating Last Value</span>
<a name="ln-7117"></a>            <span class="n">SurfAreaFracLast</span><span class="o">=</span><span class="n">SurfAreaFracPrevious</span>
<a name="ln-7118"></a>            <span class="n">ErrorLast</span><span class="o">=</span><span class="n">ErrorPrevious</span>
<a name="ln-7119"></a>          <span class="n">ENDIF</span>
<a name="ln-7120"></a>        <span class="k">ELSE</span>
<a name="ln-7121"></a>            <span class="c">! If signs are different eliminate previous error with same sign as current error</span>
<a name="ln-7122"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorLast</span><span class="o">*</span><span class="n">ErrorCurrent</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-7123"></a>            <span class="c">! Previous Loaded to Last</span>
<a name="ln-7124"></a>            <span class="n">SurfAreaFracLast</span><span class="o">=</span><span class="n">SurfAreaFracPrevious</span>
<a name="ln-7125"></a>            <span class="n">ErrorLast</span><span class="o">=</span><span class="n">ErrorPrevious</span>
<a name="ln-7126"></a>          <span class="n">ENDIF</span>
<a name="ln-7127"></a>        <span class="n">ENDIF</span>
<a name="ln-7128"></a>        <span class="c">! Current Loaded into previous.</span>
<a name="ln-7129"></a>        <span class="n">SurfAreaFracPrevious</span><span class="o">=</span><span class="n">SurfAreaFracCurrent</span>
<a name="ln-7130"></a>        <span class="n">ErrorPrevious</span><span class="o">=</span><span class="n">ErrorCurrent</span>
<a name="ln-7131"></a>      <span class="n">ENDIF</span>
<a name="ln-7132"></a>      <span class="k">RETURN</span>
<a name="ln-7133"></a>
<a name="ln-7134"></a><span class="k">END SUBROUTINE </span><span class="n">CoilAreaFracIter</span>
<a name="ln-7135"></a>
<a name="ln-7136"></a><span class="k">SUBROUTINE </span><span class="n">CheckWaterCoilSchedule</span><span class="p">(</span><span class="n">CompType</span><span class="p">,</span><span class="n">CompName</span><span class="p">,</span><span class="k">Value</span><span class="p">,</span><span class="n">CompIndex</span><span class="p">)</span>
<a name="ln-7137"></a>
<a name="ln-7138"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7139"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-7140"></a>          <span class="c">!       DATE WRITTEN   October 2005</span>
<a name="ln-7141"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7142"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7143"></a>
<a name="ln-7144"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7145"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7146"></a>
<a name="ln-7147"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7148"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-7149"></a>
<a name="ln-7150"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7151"></a>          <span class="c">! na</span>
<a name="ln-7152"></a>
<a name="ln-7153"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7154"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-7155"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-7156"></a>
<a name="ln-7157"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7158"></a>
<a name="ln-7159"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7160"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompType</span> <span class="c">!unused1208</span>
<a name="ln-7161"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompName</span>
<a name="ln-7162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="k">Value</span>
<a name="ln-7163"></a><span class="k">  </span><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-7164"></a>
<a name="ln-7165"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7166"></a>          <span class="c">! na</span>
<a name="ln-7167"></a>
<a name="ln-7168"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7169"></a>          <span class="c">! na</span>
<a name="ln-7170"></a>
<a name="ln-7171"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7172"></a>          <span class="c">! na</span>
<a name="ln-7173"></a>
<a name="ln-7174"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7175"></a>  <span class="kt">INTEGER </span><span class="n">CoilNum</span>
<a name="ln-7176"></a>
<a name="ln-7177"></a>  <span class="c">! Obtains and Allocates WaterCoil related parameters from input file</span>
<a name="ln-7178"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-7179"></a>    <span class="k">CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-7180"></a>    <span class="n">GetWaterCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7181"></a>  <span class="k">End If</span>
<a name="ln-7182"></a>
<a name="ln-7183"></a>  <span class="c">! Find the correct Coil number</span>
<a name="ln-7184"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7185"></a><span class="k">    </span><span class="n">CoilNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-7186"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CoilNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7187"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckWaterCoilSchedule: Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-7188"></a>    <span class="n">ENDIF</span>
<a name="ln-7189"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">CoilNum</span>
<a name="ln-7190"></a>    <span class="k">Value</span><span class="o">=</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span>  <span class="c">! not scheduled?</span>
<a name="ln-7191"></a>  <span class="k">ELSE</span>
<a name="ln-7192"></a><span class="k">    </span><span class="n">CoilNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-7193"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CoilNum</span> <span class="o">&gt;</span> <span class="n">NumWaterCoils</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">CoilNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7194"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckWaterCoilSchedule: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7195"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7196"></a>                          <span class="s1">&#39;, Number of Heating Coils=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7197"></a>                          <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-7198"></a>    <span class="n">ENDIF</span>
<a name="ln-7199"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7200"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;CheckWaterCoilSchedule: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7201"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7202"></a>                          <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Coil Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7203"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7204"></a>    <span class="n">ENDIF</span>
<a name="ln-7205"></a>    <span class="k">Value</span><span class="o">=</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span>  <span class="c">! not scheduled?</span>
<a name="ln-7206"></a>  <span class="n">ENDIF</span>
<a name="ln-7207"></a>
<a name="ln-7208"></a>  <span class="k">RETURN</span>
<a name="ln-7209"></a>
<a name="ln-7210"></a><span class="k">END SUBROUTINE </span><span class="n">CheckWaterCoilSchedule</span>
<a name="ln-7211"></a>
<a name="ln-7212"></a><span class="k">FUNCTION </span><span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">MaxWaterFlowRate</span><span class="p">)</span>
<a name="ln-7213"></a>
<a name="ln-7214"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-7215"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-7216"></a>          <span class="c">!       DATE WRITTEN   November 2006</span>
<a name="ln-7217"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7218"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7219"></a>
<a name="ln-7220"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-7221"></a>          <span class="c">! This function looks up the max water flow rate for the given coil and returns it.  If</span>
<a name="ln-7222"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-7223"></a>          <span class="c">! as negative.</span>
<a name="ln-7224"></a>
<a name="ln-7225"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7226"></a>          <span class="c">! na</span>
<a name="ln-7227"></a>
<a name="ln-7228"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7229"></a>          <span class="c">! na</span>
<a name="ln-7230"></a>
<a name="ln-7231"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7232"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-7233"></a>
<a name="ln-7234"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7235"></a>
<a name="ln-7236"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7237"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-7238"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-7239"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-7240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">MaxWaterFlowRate</span>  <span class="c">! returned max water flow rate of matched coil</span>
<a name="ln-7241"></a>
<a name="ln-7242"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7243"></a>          <span class="c">! na</span>
<a name="ln-7244"></a>
<a name="ln-7245"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7246"></a>          <span class="c">! na</span>
<a name="ln-7247"></a>
<a name="ln-7248"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7249"></a>          <span class="c">! na</span>
<a name="ln-7250"></a>
<a name="ln-7251"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7252"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-7253"></a>
<a name="ln-7254"></a>  <span class="c">! Obtains and Allocates WaterCoil related parameters from input file</span>
<a name="ln-7255"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-7256"></a>    <span class="k">CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-7257"></a>    <span class="n">GetWaterCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7258"></a>  <span class="k">End If</span>
<a name="ln-7259"></a>
<a name="ln-7260"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7261"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">)</span>       <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7262"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7263"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7264"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-7265"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7266"></a>      <span class="c">! coil does not specify MaxWaterFlowRate</span>
<a name="ln-7267"></a>      <span class="n">MaxWaterFlowRate</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">MaxWaterVolFlowRate</span>
<a name="ln-7268"></a>    <span class="n">ENDIF</span>
<a name="ln-7269"></a>  <span class="k">ELSE</span>
<a name="ln-7270"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7271"></a>  <span class="n">ENDIF</span>
<a name="ln-7272"></a>
<a name="ln-7273"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7274"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilMaxWaterFlowRate: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7275"></a>                         <span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7276"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Max Water Flow rate returned as -1000.&#39;</span><span class="p">)</span>
<a name="ln-7277"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7278"></a>    <span class="n">MaxWaterFlowRate</span><span class="o">=-</span><span class="mi">100</span><span class="mf">0.d0</span>
<a name="ln-7279"></a>  <span class="n">ENDIF</span>
<a name="ln-7280"></a>
<a name="ln-7281"></a>  <span class="k">RETURN</span>
<a name="ln-7282"></a>
<a name="ln-7283"></a><span class="k">END FUNCTION </span><span class="n">GetCoilMaxWaterFlowRate</span>
<a name="ln-7284"></a>
<a name="ln-7285"></a><span class="k">FUNCTION </span><span class="n">GetCoilInletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-7286"></a>
<a name="ln-7287"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-7288"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-7289"></a>          <span class="c">!       DATE WRITTEN   March 2007</span>
<a name="ln-7290"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7291"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7292"></a>
<a name="ln-7293"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-7294"></a>          <span class="c">! This function looks up the given coil and returns the inlet node number.  If</span>
<a name="ln-7295"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and node number is returned</span>
<a name="ln-7296"></a>          <span class="c">! as zero.</span>
<a name="ln-7297"></a>
<a name="ln-7298"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7299"></a>          <span class="c">! na</span>
<a name="ln-7300"></a>
<a name="ln-7301"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7302"></a>          <span class="c">! na</span>
<a name="ln-7303"></a>
<a name="ln-7304"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7305"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-7306"></a>
<a name="ln-7307"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7308"></a>
<a name="ln-7309"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7310"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-7311"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-7312"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-7313"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned node number of matched coil</span>
<a name="ln-7314"></a>
<a name="ln-7315"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7316"></a>          <span class="c">! na</span>
<a name="ln-7317"></a>
<a name="ln-7318"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7319"></a>          <span class="c">! na</span>
<a name="ln-7320"></a>
<a name="ln-7321"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7322"></a>          <span class="c">! na</span>
<a name="ln-7323"></a>
<a name="ln-7324"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7325"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-7326"></a>
<a name="ln-7327"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-7328"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7329"></a><span class="k">    CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-7330"></a>    <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7331"></a>  <span class="k">END IF</span>
<a name="ln-7332"></a>
<a name="ln-7333"></a><span class="k">  </span><span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7334"></a>  <span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7335"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">)</span>       <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7336"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7337"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7338"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-7339"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7340"></a><span class="k">      </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirInletNodeNum</span>
<a name="ln-7341"></a>    <span class="n">ENDIF</span>
<a name="ln-7342"></a>  <span class="k">ELSE</span>
<a name="ln-7343"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7344"></a>  <span class="n">ENDIF</span>
<a name="ln-7345"></a>
<a name="ln-7346"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7347"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilInletNode: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7348"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7349"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7350"></a>  <span class="n">ENDIF</span>
<a name="ln-7351"></a>
<a name="ln-7352"></a>  <span class="k">RETURN</span>
<a name="ln-7353"></a>
<a name="ln-7354"></a><span class="k">END FUNCTION </span><span class="n">GetCoilInletNode</span>
<a name="ln-7355"></a>
<a name="ln-7356"></a><span class="k">FUNCTION </span><span class="n">GetCoilOutletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-7357"></a>
<a name="ln-7358"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-7359"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-7360"></a>          <span class="c">!       DATE WRITTEN   March 2007</span>
<a name="ln-7361"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7362"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7363"></a>
<a name="ln-7364"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-7365"></a>          <span class="c">! This function looks up the given coil and returns the inlet node number.  If</span>
<a name="ln-7366"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and node number is returned</span>
<a name="ln-7367"></a>          <span class="c">! as zero.</span>
<a name="ln-7368"></a>
<a name="ln-7369"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7370"></a>          <span class="c">! na</span>
<a name="ln-7371"></a>
<a name="ln-7372"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7373"></a>          <span class="c">! na</span>
<a name="ln-7374"></a>
<a name="ln-7375"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7376"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-7377"></a>
<a name="ln-7378"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7379"></a>
<a name="ln-7380"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7381"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-7382"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-7383"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-7384"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned node number of matched coil</span>
<a name="ln-7385"></a>
<a name="ln-7386"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7387"></a>          <span class="c">! na</span>
<a name="ln-7388"></a>
<a name="ln-7389"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7390"></a>          <span class="c">! na</span>
<a name="ln-7391"></a>
<a name="ln-7392"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7393"></a>          <span class="c">! na</span>
<a name="ln-7394"></a>
<a name="ln-7395"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7396"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-7397"></a>
<a name="ln-7398"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-7399"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7400"></a><span class="k">    CALL </span><span class="n">GetWaterCoilinput</span>
<a name="ln-7401"></a>    <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7402"></a>  <span class="k">END IF</span>
<a name="ln-7403"></a>
<a name="ln-7404"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7405"></a>  <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7406"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">)</span>       <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7407"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7408"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7409"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-7410"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7411"></a><span class="k">      </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span>
<a name="ln-7412"></a>    <span class="n">ENDIF</span>
<a name="ln-7413"></a>  <span class="k">ELSE</span>
<a name="ln-7414"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7415"></a>  <span class="n">ENDIF</span>
<a name="ln-7416"></a>
<a name="ln-7417"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7418"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilOutletNode: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7419"></a>       <span class="s1">&#39;&quot; when accessing coil outlet node number.&#39;</span><span class="p">)</span>
<a name="ln-7420"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7421"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7422"></a>  <span class="n">ENDIF</span>
<a name="ln-7423"></a>
<a name="ln-7424"></a>  <span class="k">RETURN</span>
<a name="ln-7425"></a>
<a name="ln-7426"></a><span class="k">END FUNCTION </span><span class="n">GetCoilOutletNode</span>
<a name="ln-7427"></a>
<a name="ln-7428"></a><span class="k">FUNCTION </span><span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-7429"></a>
<a name="ln-7430"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-7431"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-7432"></a>          <span class="c">!       DATE WRITTEN   July 2007</span>
<a name="ln-7433"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7434"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7435"></a>
<a name="ln-7436"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-7437"></a>          <span class="c">! This function looks up the given coil and returns the inlet water control node number.  If</span>
<a name="ln-7438"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and node number is returned</span>
<a name="ln-7439"></a>          <span class="c">! as zero.</span>
<a name="ln-7440"></a>
<a name="ln-7441"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7442"></a>          <span class="c">! na</span>
<a name="ln-7443"></a>
<a name="ln-7444"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7445"></a>          <span class="c">! na</span>
<a name="ln-7446"></a>
<a name="ln-7447"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7448"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-7449"></a>
<a name="ln-7450"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7451"></a>
<a name="ln-7452"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7453"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-7454"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-7455"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-7456"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned node number of matched coil</span>
<a name="ln-7457"></a>
<a name="ln-7458"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7459"></a>          <span class="c">! na</span>
<a name="ln-7460"></a>
<a name="ln-7461"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7462"></a>          <span class="c">! na</span>
<a name="ln-7463"></a>
<a name="ln-7464"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7465"></a>          <span class="c">! na</span>
<a name="ln-7466"></a>
<a name="ln-7467"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7468"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-7469"></a>
<a name="ln-7470"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-7471"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7472"></a><span class="k">    CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-7473"></a>    <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7474"></a>  <span class="k">END IF</span>
<a name="ln-7475"></a>
<a name="ln-7476"></a><span class="k">  </span><span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7477"></a>  <span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7478"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">)</span>       <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7479"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7480"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7481"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-7482"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7483"></a><span class="k">      </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-7484"></a>    <span class="n">ENDIF</span>
<a name="ln-7485"></a>  <span class="k">ELSE</span>
<a name="ln-7486"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7487"></a>  <span class="n">ENDIF</span>
<a name="ln-7488"></a>
<a name="ln-7489"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7490"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilWaterInletNode: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7491"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7492"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7493"></a>  <span class="n">ENDIF</span>
<a name="ln-7494"></a>
<a name="ln-7495"></a>  <span class="k">RETURN</span>
<a name="ln-7496"></a>
<a name="ln-7497"></a><span class="k">END FUNCTION </span><span class="n">GetCoilWaterInletNode</span>
<a name="ln-7498"></a>
<a name="ln-7499"></a><span class="k">FUNCTION </span><span class="n">GetCoilWaterOutletNode</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">NodeNumber</span><span class="p">)</span>
<a name="ln-7500"></a>
<a name="ln-7501"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-7502"></a>          <span class="c">!       AUTHOR         R. Raustad</span>
<a name="ln-7503"></a>          <span class="c">!       DATE WRITTEN   July 2007</span>
<a name="ln-7504"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7505"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7506"></a>
<a name="ln-7507"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-7508"></a>          <span class="c">! This function looks up the given coil and returns the outlet water node number.  If</span>
<a name="ln-7509"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and node number is returned</span>
<a name="ln-7510"></a>          <span class="c">! as zero.</span>
<a name="ln-7511"></a>
<a name="ln-7512"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7513"></a>          <span class="c">! na</span>
<a name="ln-7514"></a>
<a name="ln-7515"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7516"></a>          <span class="c">! na</span>
<a name="ln-7517"></a>
<a name="ln-7518"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7519"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-7520"></a>
<a name="ln-7521"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7522"></a>
<a name="ln-7523"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7524"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-7525"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-7526"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-7527"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">NodeNumber</span>   <span class="c">! returned node number of matched coil</span>
<a name="ln-7528"></a>
<a name="ln-7529"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7530"></a>          <span class="c">! na</span>
<a name="ln-7531"></a>
<a name="ln-7532"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7533"></a>          <span class="c">! na</span>
<a name="ln-7534"></a>
<a name="ln-7535"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7536"></a>          <span class="c">! na</span>
<a name="ln-7537"></a>
<a name="ln-7538"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7539"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-7540"></a>
<a name="ln-7541"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-7542"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7543"></a><span class="k">    CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-7544"></a>    <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7545"></a>  <span class="k">END IF</span>
<a name="ln-7546"></a>
<a name="ln-7547"></a><span class="k">  </span><span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7548"></a>  <span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7549"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">)</span>       <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7550"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7551"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7552"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-7553"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7554"></a><span class="k">      </span><span class="n">NodeNumber</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-7555"></a>    <span class="n">ENDIF</span>
<a name="ln-7556"></a>  <span class="k">ELSE</span>
<a name="ln-7557"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7558"></a>  <span class="n">ENDIF</span>
<a name="ln-7559"></a>
<a name="ln-7560"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7561"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilWaterOutletNode: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7562"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7563"></a>    <span class="n">NodeNumber</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-7564"></a>  <span class="n">ENDIF</span>
<a name="ln-7565"></a>
<a name="ln-7566"></a>  <span class="k">RETURN</span>
<a name="ln-7567"></a>
<a name="ln-7568"></a><span class="k">END FUNCTION </span><span class="n">GetCoilWaterOutletNode</span>
<a name="ln-7569"></a>
<a name="ln-7570"></a><span class="k">SUBROUTINE </span><span class="n">SetCoilDesFlow</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">CoilDesFlow</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-7571"></a>
<a name="ln-7572"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7573"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-7574"></a>          <span class="c">!       DATE WRITTEN   May 2009</span>
<a name="ln-7575"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7576"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7577"></a>
<a name="ln-7578"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7579"></a>          <span class="c">! This routine is designed to set the design air volume flow rate in the</span>
<a name="ln-7580"></a>          <span class="c">! water coil data structure. Some of the coil types do not have this datum as</span>
<a name="ln-7581"></a>          <span class="c">! an input parameter and it is needed for calculating capacity for output reporting.</span>
<a name="ln-7582"></a>
<a name="ln-7583"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7584"></a>          <span class="c">! na</span>
<a name="ln-7585"></a>
<a name="ln-7586"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7587"></a>          <span class="c">! na</span>
<a name="ln-7588"></a>
<a name="ln-7589"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7590"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-7591"></a>
<a name="ln-7592"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7593"></a>
<a name="ln-7594"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7595"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-7596"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-7597"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-7598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CoilDesFlow</span>  <span class="c">! coil volumetric air flow rate [m3/s]</span>
<a name="ln-7599"></a>
<a name="ln-7600"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7601"></a>          <span class="c">! na</span>
<a name="ln-7602"></a>
<a name="ln-7603"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7604"></a>          <span class="c">! na</span>
<a name="ln-7605"></a>
<a name="ln-7606"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7607"></a>          <span class="c">! na</span>
<a name="ln-7608"></a>
<a name="ln-7609"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7610"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>   <span class="c">! index to coil</span>
<a name="ln-7611"></a>
<a name="ln-7612"></a>   <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-7613"></a>    <span class="k">CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-7614"></a>    <span class="n">GetWaterCoilsInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-7615"></a>  <span class="k">End If</span>
<a name="ln-7616"></a>
<a name="ln-7617"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7618"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7619"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-7620"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7621"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7622"></a><span class="k">        </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">=</span> <span class="n">CoilDesFlow</span>
<a name="ln-7623"></a>      <span class="k">ELSE</span>
<a name="ln-7624"></a><span class="k">        </span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">DesAirVolFlowRate</span> <span class="o">=</span> <span class="n">CoilDesFlow</span>
<a name="ln-7625"></a>      <span class="k">END IF</span>
<a name="ln-7626"></a><span class="k">    ELSE</span>
<a name="ln-7627"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilMaxWaterFlowRate: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7628"></a>                         <span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-7629"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7630"></a>    <span class="n">ENDIF</span>
<a name="ln-7631"></a>  <span class="n">ENDIF</span>
<a name="ln-7632"></a>
<a name="ln-7633"></a>  <span class="k">RETURN</span>
<a name="ln-7634"></a>
<a name="ln-7635"></a><span class="k">END SUBROUTINE </span><span class="n">SetCoilDesFlow</span>
<a name="ln-7636"></a>
<a name="ln-7637"></a><span class="k">SUBROUTINE </span><span class="n">CheckActuatorNode</span><span class="p">(</span><span class="n">ActuatorNodeNum</span><span class="p">,</span> <span class="n">iNodeType</span><span class="p">,</span> <span class="n">NodeNotFound</span><span class="p">)</span>
<a name="ln-7638"></a>
<a name="ln-7639"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7640"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-7641"></a>          <span class="c">!       DATE WRITTEN   January 2009</span>
<a name="ln-7642"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7643"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7644"></a>
<a name="ln-7645"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-7646"></a>          <span class="c">! This subroutine checks that the input actuator node number is matched by</span>
<a name="ln-7647"></a>          <span class="c">! the water inlet node number of some water coil</span>
<a name="ln-7648"></a>
<a name="ln-7649"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7650"></a>          <span class="c">! na</span>
<a name="ln-7651"></a>
<a name="ln-7652"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7653"></a>          <span class="c">! na</span>
<a name="ln-7654"></a>
<a name="ln-7655"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7656"></a>
<a name="ln-7657"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7658"></a>
<a name="ln-7659"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7660"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ActuatorNodeNum</span>   <span class="c">! input actuator node number</span>
<a name="ln-7661"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iNodeType</span>         <span class="c">! Cooling or Heating or 0</span>
<a name="ln-7662"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NodeNotFound</span>      <span class="c">! true if matching water inlet node not found</span>
<a name="ln-7663"></a>
<a name="ln-7664"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7665"></a>          <span class="c">! na</span>
<a name="ln-7666"></a>
<a name="ln-7667"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7668"></a>          <span class="c">! na</span>
<a name="ln-7669"></a>
<a name="ln-7670"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7671"></a>          <span class="c">! na</span>
<a name="ln-7672"></a>
<a name="ln-7673"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7674"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-7675"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-7676"></a>
<a name="ln-7677"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-7678"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7679"></a><span class="k">    CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-7680"></a>    <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7681"></a>  <span class="k">END IF</span>
<a name="ln-7682"></a>
<a name="ln-7683"></a><span class="k">  </span><span class="n">WhichCoil</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7684"></a>  <span class="n">iNodeType</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7685"></a>  <span class="n">NodeNotFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7686"></a>  <span class="k">DO </span><span class="n">CoilNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumWaterCoils</span>
<a name="ln-7687"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span> <span class="o">==</span> <span class="n">ActuatorNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7688"></a><span class="k">      </span><span class="n">WhichCoil</span> <span class="o">=</span> <span class="n">CoilNum</span>
<a name="ln-7689"></a>      <span class="n">iNodeType</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType</span>
<a name="ln-7690"></a>      <span class="n">NodeNotFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7691"></a>    <span class="k">END IF</span>
<a name="ln-7692"></a><span class="k">  END DO</span>
<a name="ln-7693"></a>
<a name="ln-7694"></a><span class="k">  RETURN</span>
<a name="ln-7695"></a>
<a name="ln-7696"></a><span class="k">END SUBROUTINE </span><span class="n">CheckActuatorNode</span>
<a name="ln-7697"></a>
<a name="ln-7698"></a><span class="k">SUBROUTINE </span><span class="n">CheckForSensorAndSetpointNode</span><span class="p">(</span><span class="n">SensorNodeNum</span><span class="p">,</span><span class="n">ControlledVar</span><span class="p">,</span><span class="n">NodeNotFound</span><span class="p">)</span>
<a name="ln-7699"></a>
<a name="ln-7700"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7701"></a>          <span class="c">!       AUTHOR         Bereket Nigusse</span>
<a name="ln-7702"></a>          <span class="c">!       DATE WRITTEN   March 2013</span>
<a name="ln-7703"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7704"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7705"></a>
<a name="ln-7706"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7707"></a>          <span class="c">! This subroutine checks that the sensor node number matches the air outlet node number</span>
<a name="ln-7708"></a>          <span class="c">! of some water coils</span>
<a name="ln-7709"></a>
<a name="ln-7710"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7711"></a>          <span class="c">! na</span>
<a name="ln-7712"></a>
<a name="ln-7713"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7714"></a>          <span class="c">! na</span>
<a name="ln-7715"></a>
<a name="ln-7716"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7717"></a>  <span class="k">USE </span><span class="n">SetPointManager</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">NodeHasSPMCtrlVarType</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">,</span> <span class="n">iCtrlVarType_HumRat</span><span class="p">,</span> <span class="n">iCtrlVarType_MaxHumRat</span>
<a name="ln-7718"></a>  <span class="k">USE </span><span class="n">EMSManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">,</span> <span class="n">iTemperatureSetpoint</span><span class="p">,</span> <span class="n">iHumidityRatioMaxSetpoint</span>
<a name="ln-7719"></a>
<a name="ln-7720"></a>  <span class="c">!USE HVACControllers,     ONLY: iTemperature, iHumidityRatio, iTemperatureAndHumidityRatio</span>
<a name="ln-7721"></a>
<a name="ln-7722"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7723"></a>
<a name="ln-7724"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7725"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SensorNodeNum</span>      <span class="c">! controller sensor node number</span>
<a name="ln-7726"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ControlledVar</span>      <span class="c">! controlled variable type</span>
<a name="ln-7727"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NodeNotFound</span>       <span class="c">! true if matching air outlet node not found</span>
<a name="ln-7728"></a>
<a name="ln-7729"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7730"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;CheckForSensorAndSetpointNode: &#39;</span>
<a name="ln-7731"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iTemperature</span>                 <span class="o">=</span> <span class="mi">1</span>
<a name="ln-7732"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iHumidityRatio</span>               <span class="o">=</span> <span class="mi">2</span>
<a name="ln-7733"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">iTemperatureAndHumidityRatio</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-7734"></a>
<a name="ln-7735"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-7736"></a>          <span class="c">! na</span>
<a name="ln-7737"></a>
<a name="ln-7738"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-7739"></a>          <span class="c">! na</span>
<a name="ln-7740"></a>
<a name="ln-7741"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7742"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>                       <span class="c">! water coil index</span>
<a name="ln-7743"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoilNum</span>                         <span class="c">! counter</span>
<a name="ln-7744"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WaterCoilType</span>         <span class="c">! water coil type</span>
<a name="ln-7745"></a>  <span class="kt">LOGICAL</span>           <span class="kd">::</span> <span class="n">EMSSetpointErrorFlag</span>  <span class="c">! flag true is EMS is used to set node setpoints</span>
<a name="ln-7746"></a>
<a name="ln-7747"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-7748"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7749"></a><span class="k">    CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-7750"></a>    <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7751"></a>  <span class="k">END IF</span>
<a name="ln-7752"></a>
<a name="ln-7753"></a><span class="k">  </span><span class="n">WhichCoil</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7754"></a>  <span class="n">NodeNotFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7755"></a>
<a name="ln-7756"></a>  <span class="k">DO </span><span class="n">CoilNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumWaterCoils</span>
<a name="ln-7757"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">SensorNodeNum</span> <span class="o">/=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">AirOutletNodeNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-7758"></a><span class="k">        </span><span class="n">NodeNotFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7759"></a>        <span class="n">WhichCoil</span> <span class="o">=</span> <span class="n">CoilNum</span>
<a name="ln-7760"></a>        <span class="k">EXIT</span>
<a name="ln-7761"></a><span class="k">  END DO</span>
<a name="ln-7762"></a>  <span class="c">! now if the sensor node is on the water coil air outlet node then check that</span>
<a name="ln-7763"></a>  <span class="c">! a setpoint is also specified on the water coil outlet node</span>
<a name="ln-7764"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">NodeNotFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7765"></a><span class="k">     IF</span> <span class="p">(</span> <span class="n">WhichCoil</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7766"></a><span class="k">        If</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_DetFlatFinCooling</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7767"></a><span class="k">                </span><span class="n">WaterCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span>
<a name="ln-7768"></a>        <span class="n">ElseIf</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_Cooling</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7769"></a><span class="k">                </span><span class="n">WaterCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:Water&#39;</span>
<a name="ln-7770"></a>        <span class="n">ELSEIf</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span> <span class="o">==</span> <span class="n">WaterCoil_SimpleHeating</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7771"></a><span class="k">                </span><span class="n">WaterCoilType</span> <span class="o">=</span> <span class="s1">&#39;Coil:Heating:Water&#39;</span>
<a name="ln-7772"></a>        <span class="n">ENDIF</span>
<a name="ln-7773"></a>        <span class="n">EMSSetpointErrorFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7774"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ControlledVar</span><span class="p">)</span>
<a name="ln-7775"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">iTemperature</span><span class="p">)</span>
<a name="ln-7776"></a>          <span class="k">CALL </span><span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">(</span><span class="n">SensorNodeNum</span><span class="p">,</span><span class="n">iTemperatureSetpoint</span><span class="p">,</span> <span class="n">EMSSetpointErrorFlag</span><span class="p">)</span>
<a name="ln-7777"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">EMSSetpointErrorFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7778"></a><span class="k">            IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">SensorNodeNum</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7779"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;. &#39;</span><span class="p">)</span>
<a name="ln-7780"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..Temperature setpoint not found on coil air outlet node.&#39;</span><span class="p">)</span>
<a name="ln-7781"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..The setpoint may have been placed on a node downstream of the coil&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7782"></a>                                       <span class="s1">&#39; or on an airloop outlet node.&#39;</span><span class="p">)</span>
<a name="ln-7783"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..Specify the setpoint and the sensor on the coil air outlet node when possible.&#39;</span><span class="p">)</span>
<a name="ln-7784"></a>            <span class="k">END IF</span>
<a name="ln-7785"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-7786"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">iHumidityRatio</span><span class="p">)</span>
<a name="ln-7787"></a>          <span class="k">CALL </span><span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">(</span><span class="n">SensorNodeNum</span><span class="p">,</span><span class="n">iHumidityRatioMaxSetpoint</span><span class="p">,</span> <span class="n">EMSSetpointErrorFlag</span><span class="p">)</span>
<a name="ln-7788"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">EMSSetpointErrorFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7789"></a><span class="k">            IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">SensorNodeNum</span><span class="p">,</span> <span class="n">iCtrlVarType_MaxHumRat</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7790"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;. &#39;</span><span class="p">)</span>
<a name="ln-7791"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..Humidity ratio setpoint not found on coil air outlet node.&#39;</span><span class="p">)</span>
<a name="ln-7792"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..The setpoint may have been placed on a node downstream of the coil&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7793"></a>                                       <span class="s1">&#39; or on an airloop outlet node.&#39;</span><span class="p">)</span>
<a name="ln-7794"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..Specify the setpoint and the sensor on the coil air outlet node when possible.&#39;</span><span class="p">)</span>
<a name="ln-7795"></a>            <span class="k">END IF</span>
<a name="ln-7796"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-7797"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">iTemperatureAndHumidityRatio</span><span class="p">)</span>
<a name="ln-7798"></a>          <span class="k">CALL </span><span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">(</span><span class="n">SensorNodeNum</span><span class="p">,</span><span class="n">iTemperatureSetpoint</span><span class="p">,</span> <span class="n">EMSSetpointErrorFlag</span><span class="p">)</span>
<a name="ln-7799"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">EMSSetpointErrorFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7800"></a><span class="k">            IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">SensorNodeNum</span><span class="p">,</span> <span class="n">iCtrlVarType_Temp</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7801"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;. &#39;</span><span class="p">)</span>
<a name="ln-7802"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..Temperature setpoint not found on coil air outlet node.&#39;</span><span class="p">)</span>
<a name="ln-7803"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..The setpoint may have been placed on a node downstream of the coil&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7804"></a>                                       <span class="s1">&#39; or on an airloop outlet node.&#39;</span><span class="p">)</span>
<a name="ln-7805"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..Specify the setpoint and the sensor on the coil air outlet node when possible.&#39;</span><span class="p">)</span>
<a name="ln-7806"></a>            <span class="k">END IF</span>
<a name="ln-7807"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-7808"></a>          <span class="n">EMSSetpointErrorFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7809"></a>          <span class="k">CALL </span><span class="n">CheckIfNodeSetpointManagedByEMS</span><span class="p">(</span><span class="n">SensorNodeNum</span><span class="p">,</span><span class="n">iHumidityRatioMaxSetpoint</span><span class="p">,</span> <span class="n">EMSSetpointErrorFlag</span><span class="p">)</span>
<a name="ln-7810"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">EMSSetpointErrorFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7811"></a><span class="k">            IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">NodeHasSPMCtrlVarType</span><span class="p">(</span><span class="n">SensorNodeNum</span><span class="p">,</span> <span class="n">iCtrlVarType_MaxHumRat</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7812"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;. &#39;</span><span class="p">)</span>
<a name="ln-7813"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..Humidity ratio setpoint not found on coil air outlet node.&#39;</span><span class="p">)</span>
<a name="ln-7814"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..The setpoint may have been placed on a node downstream of the coil&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7815"></a>                                       <span class="s1">&#39; or on an airloop outlet node.&#39;</span><span class="p">)</span>
<a name="ln-7816"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; ..Specify the setpoint and the sensor on the coil air outlet node when possible.&#39;</span><span class="p">)</span>
<a name="ln-7817"></a>            <span class="k">END IF</span>
<a name="ln-7818"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-7819"></a>        <span class="k">END SELECT</span>
<a name="ln-7820"></a>
<a name="ln-7821"></a><span class="k">     </span><span class="n">ENDIF</span>
<a name="ln-7822"></a>  <span class="n">ENDIF</span>
<a name="ln-7823"></a>
<a name="ln-7824"></a>  <span class="k">RETURN</span>
<a name="ln-7825"></a>
<a name="ln-7826"></a><span class="k">END SUBROUTINE </span><span class="n">CheckForSensorAndSetpointNode</span>
<a name="ln-7827"></a>
<a name="ln-7828"></a><span class="k">FUNCTION </span><span class="n">TdbFnHRhPb</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">RH</span><span class="p">,</span><span class="n">PB</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a name="ln-7829"></a>
<a name="ln-7830"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-7831"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-7832"></a>          <span class="c">!       DATE WRITTEN   April 1, 2009</span>
<a name="ln-7833"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7834"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7835"></a>
<a name="ln-7836"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-7837"></a>          <span class="c">! Given the specific enthalpy, relative humidity, and the</span>
<a name="ln-7838"></a>          <span class="c">! barometric pressure, the function returns the dry bulb temperature.</span>
<a name="ln-7839"></a>
<a name="ln-7840"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7841"></a>          <span class="c">! Inverts PsyHFnTdbRhPb</span>
<a name="ln-7842"></a>
<a name="ln-7843"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7844"></a>          <span class="c">! none</span>
<a name="ln-7845"></a>
<a name="ln-7846"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7847"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-7848"></a>
<a name="ln-7849"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7850"></a>
<a name="ln-7851"></a>            <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-7852"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H</span>      <span class="c">! specific enthalpy {J/kg}</span>
<a name="ln-7853"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RH</span>     <span class="c">! relative humidity value (0.0-1.0)</span>
<a name="ln-7854"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PB</span>     <span class="c">! barometric pressure {Pascals}</span>
<a name="ln-7855"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">T</span>      <span class="c">! result=&gt; humidity ratio</span>
<a name="ln-7856"></a>
<a name="ln-7857"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7858"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>           <span class="kd">::</span> <span class="n">itmax</span> <span class="o">=</span><span class="mi">10</span>
<a name="ln-7859"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span>           <span class="kd">::</span> <span class="n">MaxIte</span> <span class="o">=</span> <span class="mi">500</span>        <span class="c">! Maximum number of iterations</span>
<a name="ln-7860"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>         <span class="kd">::</span> <span class="n">Acc</span> <span class="o">=</span>  <span class="mf">1.0d0</span>       <span class="c">! Accuracy of result</span>
<a name="ln-7861"></a>
<a name="ln-7862"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7863"></a>          <span class="c">! na</span>
<a name="ln-7864"></a>
<a name="ln-7865"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7866"></a>          <span class="c">! na</span>
<a name="ln-7867"></a>
<a name="ln-7868"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7869"></a>  <span class="kt">INTEGER</span>                  <span class="kd">::</span> <span class="n">SolFla</span>             <span class="c">! Flag of solver</span>
<a name="ln-7870"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">T0</span>                 <span class="c">! lower bound for Tprov [C]</span>
<a name="ln-7871"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">T1</span>                 <span class="c">! upper bound for Tprov [C]</span>
<a name="ln-7872"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">Tprov</span> <span class="o">=</span><span class="mf">0.0d0</span>         <span class="c">! provisional value of drybulb temperature [C]</span>
<a name="ln-7873"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Par</span>                <span class="c">! Par(1) = desired enthaply H [J/kg]</span>
<a name="ln-7874"></a>                                                 <span class="c">! Par(2) = desired relative humidity (0.0 - 1.0)</span>
<a name="ln-7875"></a>                                                 <span class="c">! Par(3) = barometric pressure [N/m2 (Pascals)]</span>
<a name="ln-7876"></a>
<a name="ln-7877"></a>  <span class="n">T0</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7878"></a>  <span class="n">T1</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">0.0d0</span>
<a name="ln-7879"></a>  <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">H</span>
<a name="ln-7880"></a>  <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rh</span>
<a name="ln-7881"></a>  <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Pb</span>
<a name="ln-7882"></a>  <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">Acc</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">Tprov</span><span class="p">,</span> <span class="n">EnthalpyResidual</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-7883"></a>  <span class="c">! if the numerical inversion failed, issue error messages.</span>
<a name="ln-7884"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7885"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Calculation of drybulb temperature failed in TdbFnHRhPb(H,RH,PB)&#39;</span><span class="p">)</span>
<a name="ln-7886"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   Iteration limit exceeded&#39;</span><span class="p">)</span>
<a name="ln-7887"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   H=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], RH=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RH</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7888"></a>                           <span class="s1">&#39;], PB=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PB</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-7889"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7890"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Calculation of drybulb temperature failed in TdbFnHRhPb(H,RH,PB)&#39;</span><span class="p">)</span>
<a name="ln-7891"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Bad starting values for Tdb&#39;</span><span class="p">)</span>
<a name="ln-7892"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   H=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], RH=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RH</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-7893"></a>                           <span class="s1">&#39;], PB=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PB</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-7894"></a>  <span class="k">END IF</span>
<a name="ln-7895"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7896"></a><span class="k">    </span><span class="n">T</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7897"></a>  <span class="k">ELSE</span>
<a name="ln-7898"></a><span class="k">    </span><span class="n">T</span> <span class="o">=</span> <span class="n">Tprov</span>
<a name="ln-7899"></a>  <span class="k">END IF</span>
<a name="ln-7900"></a>
<a name="ln-7901"></a><span class="k">  RETURN</span>
<a name="ln-7902"></a><span class="k">END FUNCTION </span><span class="n">TdbFnHRhPb</span>
<a name="ln-7903"></a>
<a name="ln-7904"></a><span class="k">FUNCTION </span><span class="n">EnthalpyResidual</span><span class="p">(</span><span class="n">Tprov</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-7905"></a>
<a name="ln-7906"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-7907"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-7908"></a>          <span class="c">!       DATE WRITTEN   April 2009</span>
<a name="ln-7909"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-7910"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-7911"></a>
<a name="ln-7912"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-7913"></a>          <span class="c">! Calculates residual function Hdesired - H(Tdb,Rh,Pb)</span>
<a name="ln-7914"></a>
<a name="ln-7915"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7916"></a>          <span class="c">! Calls PsyHFnTdbRhPb</span>
<a name="ln-7917"></a>
<a name="ln-7918"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7919"></a>
<a name="ln-7920"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7921"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyHFnTdbRhPb</span>
<a name="ln-7922"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7923"></a>
<a name="ln-7924"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7925"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Tprov</span>                      <span class="c">! test value of Tdb [C]</span>
<a name="ln-7926"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! Par(1) = desired enthaply H [J/kg]</span>
<a name="ln-7927"></a>                                                       <span class="c">! Par(2) = desired relative humidity (0.0 - 1.0)</span>
<a name="ln-7928"></a>                                                       <span class="c">! Par(3) = barometric pressure [N/m2 (Pascals)]</span>
<a name="ln-7929"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-7930"></a>
<a name="ln-7931"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7932"></a>          <span class="c">! na</span>
<a name="ln-7933"></a>
<a name="ln-7934"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7935"></a>          <span class="c">! na</span>
<a name="ln-7936"></a>
<a name="ln-7937"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7938"></a>          <span class="c">! na</span>
<a name="ln-7939"></a>
<a name="ln-7940"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7941"></a>
<a name="ln-7942"></a>  <span class="n">Residuum</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">PsyHFnTdbRhPb</span><span class="p">(</span><span class="n">Tprov</span><span class="p">,</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-7943"></a>
<a name="ln-7944"></a>  <span class="k">RETURN</span>
<a name="ln-7945"></a><span class="k">END FUNCTION </span><span class="n">EnthalpyResidual</span>
<a name="ln-7946"></a>
<a name="ln-7947"></a><span class="k">FUNCTION </span><span class="n">EstimateHEXSurfaceArea</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">SurfaceArea</span><span class="p">)</span>
<a name="ln-7948"></a>
<a name="ln-7949"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-7950"></a>          <span class="c">!       AUTHOR         Bereket A Nigusse, FSEC</span>
<a name="ln-7951"></a>          <span class="c">!       DATE WRITTEN   July 2010</span>
<a name="ln-7952"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-7953"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-7954"></a>
<a name="ln-7955"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-7956"></a>          <span class="c">! Splits the UA value of a simple coil:cooling:water heat exchanger model into</span>
<a name="ln-7957"></a>          <span class="c">! &quot;A&quot; and U&quot; values.</span>
<a name="ln-7958"></a>
<a name="ln-7959"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7960"></a>          <span class="c">! A typical design U overall heat transfer coefficient is used to split the &quot;UA&quot; into &quot;A&quot;</span>
<a name="ln-7961"></a>          <span class="c">! and &quot;U&quot; values. Currently a constant U value calculated for a typical cooling coil is</span>
<a name="ln-7962"></a>          <span class="c">! used. The assumptions used to calculate a typical U value are:</span>
<a name="ln-7963"></a>          <span class="c">!     (1) tube side water velocity of 2.0 [m/s]</span>
<a name="ln-7964"></a>          <span class="c">!     (2) inside to outside total surface area ratio (Ai/Ao) =  0.07 [-]</span>
<a name="ln-7965"></a>          <span class="c">!     (3) fins overall efficiency = 0.92 based on aluminum fin, 12 fins per inch, and</span>
<a name="ln-7966"></a>          <span class="c">!         fins area to total outside surafce area ratio of about 90%.</span>
<a name="ln-7967"></a>          <span class="c">!     (4) air side convection coefficient of 140.0 [W/m2C].  Assumes sensible convection</span>
<a name="ln-7968"></a>          <span class="c">!         of 58.0 [W/m2C] and 82.0 [W/m2C] sensible convection equivalent of the mass</span>
<a name="ln-7969"></a>          <span class="c">!         transfer coefficient converted using the approximate relation:</span>
<a name="ln-7970"></a>          <span class="c">!         hequivalent = hmasstransfer/Cpair.</span>
<a name="ln-7971"></a>
<a name="ln-7972"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7973"></a>
<a name="ln-7974"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7975"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7976"></a>
<a name="ln-7977"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7978"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoilNum</span>         <span class="c">! coil number, [-]</span>
<a name="ln-7979"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">SurfaceArea</span>     <span class="c">! Heat exchanger surface area, [m2]</span>
<a name="ln-7980"></a>
<a name="ln-7981"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-7982"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OverallFinEfficiency</span> <span class="o">=</span> <span class="mf">0.92d0</span>  <span class="c">! Assumes aluminum fins, 12 fins per inch, fins</span>
<a name="ln-7983"></a>                                                         <span class="c">! area of about 90% of external surface area Ao.</span>
<a name="ln-7984"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AreaRatio</span> <span class="o">=</span> <span class="mf">0.07d0</span>       <span class="c">! Heat exchanger Inside to Outside surface area ratio</span>
<a name="ln-7985"></a>                                                   <span class="c">! design values range from (Ai/Ao) = 0.06 to 0.08</span>
<a name="ln-7986"></a>
<a name="ln-7987"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7988"></a>          <span class="c">! na</span>
<a name="ln-7989"></a>
<a name="ln-7990"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7991"></a>          <span class="c">! na</span>
<a name="ln-7992"></a>
<a name="ln-7993"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7994"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UOverallHeatTransferCoef</span>      <span class="c">! over all heat transfer coefficient for coil [W/m2C]</span>
<a name="ln-7995"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hAirTubeOutside</span>               <span class="c">! Air side heat transfer coefficient [W/m2C]</span>
<a name="ln-7996"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hWaterTubeInside</span>              <span class="c">! water (tube) side heat transfer coefficient [W/m2C]</span>
<a name="ln-7997"></a>
<a name="ln-7998"></a>  <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilExternal</span> <span class="p">&amp;</span>
<a name="ln-7999"></a>                                 <span class="o">+</span> <span class="mf">1.d0</span><span class="o">/</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilInternal</span><span class="p">)</span>
<a name="ln-8000"></a>
<a name="ln-8001"></a>      <span class="c">! Tube side water convection heat transfer coefficient of the cooling coil is calculated for</span>
<a name="ln-8002"></a>      <span class="c">! inside tube diameter of 0.0122m (~0.5 inch nominal diameter) and water velocity 2.0 m/s:</span>
<a name="ln-8003"></a>  <span class="n">hWaterTubeInside</span> <span class="o">=</span> <span class="mi">142</span><span class="mf">9.d0</span><span class="o">*</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">**</span><span class="mf">0.8d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.0122d0</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2d0</span><span class="p">))</span>
<a name="ln-8004"></a>
<a name="ln-8005"></a>      <span class="c">! Constant value air side heat transfer coefficient is assumed. This coefficient has sensible</span>
<a name="ln-8006"></a>      <span class="c">! (58.d0 [W/m2C]) and latent (82.d0 [W/m2C]) heat transfer coefficient components.</span>
<a name="ln-8007"></a>  <span class="n">hAirTubeOutside</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">8.d0</span> <span class="o">+</span> <span class="mi">8</span><span class="mf">2.d0</span>
<a name="ln-8008"></a>
<a name="ln-8009"></a>      <span class="c">! Estimate the overall heat transfer coefficient, UOverallHeatTransferCoef in [W/(m2C)].</span>
<a name="ln-8010"></a>      <span class="c">! Neglecting tube wall and fouling resistance, the overall U value can be estimated as:</span>
<a name="ln-8011"></a>      <span class="c">! 1/UOverallHeatTransferCoef = 1/(hi*AreaRatio) + 1/(ho*OverallFinEfficiency)</span>
<a name="ln-8012"></a>
<a name="ln-8013"></a>  <span class="n">UOverallHeatTransferCoef</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">/</span><span class="p">(</span><span class="n">hWaterTubeInside</span><span class="o">*</span><span class="n">AreaRatio</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8014"></a>                           <span class="o">+</span> <span class="mf">1.d0</span><span class="o">/</span><span class="p">(</span><span class="n">hAirTubeOutside</span><span class="o">*</span><span class="n">OverallFinEfficiency</span><span class="p">))</span>
<a name="ln-8015"></a>
<a name="ln-8016"></a>      <span class="c">! the heat exchanger surface area is calculated as follows:</span>
<a name="ln-8017"></a>  <span class="n">SurfaceArea</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">UACoilTotal</span><span class="o">/</span><span class="n">UOverallHeatTransferCoef</span>
<a name="ln-8018"></a>
<a name="ln-8019"></a>  <span class="k">RETURN</span>
<a name="ln-8020"></a><span class="k">  END Function </span><span class="n">EstimateHEXSurfaceArea</span>
<a name="ln-8021"></a>
<a name="ln-8022"></a><span class="k">FUNCTION </span><span class="n">GetWaterCoilIndex</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">IndexNum</span><span class="p">)</span>
<a name="ln-8023"></a>
<a name="ln-8024"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8025"></a>          <span class="c">!       AUTHOR         B. Nigusse, FSEC</span>
<a name="ln-8026"></a>          <span class="c">!       DATE WRITTEN   Feb 2012</span>
<a name="ln-8027"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8028"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8029"></a>
<a name="ln-8030"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8031"></a>          <span class="c">! This function looks up the index for the given coil and returns it.  If incorrect coil</span>
<a name="ln-8032"></a>          <span class="c">! type or name is given, errorsfound is returned as true and node number is returned</span>
<a name="ln-8033"></a>          <span class="c">! as zero.</span>
<a name="ln-8034"></a>
<a name="ln-8035"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8036"></a>          <span class="c">! na</span>
<a name="ln-8037"></a>
<a name="ln-8038"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8039"></a>          <span class="c">! na</span>
<a name="ln-8040"></a>
<a name="ln-8041"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8042"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-8043"></a>
<a name="ln-8044"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8045"></a>
<a name="ln-8046"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8047"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-8048"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-8049"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-8050"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">IndexNum</span>     <span class="c">! returned coil index if matched coil</span>
<a name="ln-8051"></a>
<a name="ln-8052"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8053"></a>          <span class="c">! na</span>
<a name="ln-8054"></a>
<a name="ln-8055"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8056"></a>          <span class="c">! na</span>
<a name="ln-8057"></a>
<a name="ln-8058"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8059"></a>          <span class="c">! na</span>
<a name="ln-8060"></a>
<a name="ln-8061"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8062"></a>          <span class="c">! na</span>
<a name="ln-8063"></a>
<a name="ln-8064"></a>  <span class="c">! Obtains and allocates WaterCoil related parameters from input file</span>
<a name="ln-8065"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8066"></a><span class="k">    CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-8067"></a>    <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8068"></a>  <span class="k">END IF</span>
<a name="ln-8069"></a>
<a name="ln-8070"></a><span class="k">  </span><span class="n">IndexNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8071"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATER&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8072"></a><span class="k">    </span><span class="n">IndexNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-8073"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATER&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8074"></a><span class="k">    </span><span class="n">IndexNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-8075"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATER:DETAILEDGEOMETRY&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8076"></a><span class="k">    </span><span class="n">IndexNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-8077"></a>  <span class="k">ELSE</span>
<a name="ln-8078"></a><span class="k">    </span><span class="n">IndexNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8079"></a>  <span class="n">ENDIF</span>
<a name="ln-8080"></a>
<a name="ln-8081"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IndexNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8082"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetWaterCoilIndex: Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8083"></a>                         <span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8084"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8085"></a>  <span class="n">ENDIF</span>
<a name="ln-8086"></a>
<a name="ln-8087"></a>  <span class="k">RETURN</span>
<a name="ln-8088"></a>
<a name="ln-8089"></a><span class="k">END FUNCTION </span><span class="n">GetWaterCoilIndex</span>
<a name="ln-8090"></a>
<a name="ln-8091"></a><span class="k">FUNCTION </span><span class="n">GetWaterCoilCapacity</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">Capacity</span><span class="p">)</span>
<a name="ln-8092"></a>
<a name="ln-8093"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8094"></a>          <span class="c">!       AUTHOR         R. Raustad, FSEC</span>
<a name="ln-8095"></a>          <span class="c">!       DATE WRITTEN   Sep 2013</span>
<a name="ln-8096"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8097"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8098"></a>
<a name="ln-8099"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8100"></a>          <span class="c">! This function looks up the capacity for the given coil and returns it.  If incorrect coil</span>
<a name="ln-8101"></a>          <span class="c">! type or name is given, errorsfound is returned as true and capacity is returned</span>
<a name="ln-8102"></a>          <span class="c">! as zero.</span>
<a name="ln-8103"></a>
<a name="ln-8104"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8105"></a>          <span class="c">! na</span>
<a name="ln-8106"></a>
<a name="ln-8107"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8108"></a>          <span class="c">! na</span>
<a name="ln-8109"></a>
<a name="ln-8110"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8111"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-8112"></a>
<a name="ln-8113"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8114"></a>
<a name="ln-8115"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8116"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-8117"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-8118"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-8119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">Capacity</span>     <span class="c">! returned coil capacity if matched coil</span>
<a name="ln-8120"></a>
<a name="ln-8121"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8122"></a>          <span class="c">! na</span>
<a name="ln-8123"></a>
<a name="ln-8124"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8125"></a>          <span class="c">! na</span>
<a name="ln-8126"></a>
<a name="ln-8127"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8128"></a>          <span class="c">! na</span>
<a name="ln-8129"></a>
<a name="ln-8130"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8131"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IndexNum</span>  <span class="c">! index to water coil</span>
<a name="ln-8132"></a>
<a name="ln-8133"></a>  <span class="c">! Obtains and allocates WaterCoil related parameters from input file</span>
<a name="ln-8134"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8135"></a><span class="k">    CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-8136"></a>    <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8137"></a>  <span class="k">END IF</span>
<a name="ln-8138"></a>
<a name="ln-8139"></a><span class="k">  </span><span class="n">Capacity</span><span class="o">=-</span><span class="mf">1.0d0</span>
<a name="ln-8140"></a>
<a name="ln-8141"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATER&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8142"></a><span class="k">    </span><span class="n">IndexNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-8143"></a>    <span class="n">Capacity</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">IndexNum</span><span class="p">)%</span><span class="n">DesWaterHeatingCoilRate</span>
<a name="ln-8144"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATER&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8145"></a><span class="k">    </span><span class="n">IndexNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-8146"></a>    <span class="n">Capacity</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">IndexNum</span><span class="p">)%</span><span class="n">DesWaterCoolingCoilRate</span>
<a name="ln-8147"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CoilType</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATER:DETAILEDGEOMETRY&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8148"></a><span class="k">    </span><span class="n">IndexNum</span><span class="o">=</span><span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-8149"></a>    <span class="n">Capacity</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">IndexNum</span><span class="p">)%</span><span class="n">DesWaterCoolingCoilRate</span>
<a name="ln-8150"></a>  <span class="k">ELSE</span>
<a name="ln-8151"></a><span class="k">    </span><span class="n">IndexNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8152"></a>  <span class="n">ENDIF</span>
<a name="ln-8153"></a>
<a name="ln-8154"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IndexNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8155"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetWaterCoilCapacity: Could not find CoilType=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8156"></a>                         <span class="s1">&#39;&quot; with Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8157"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8158"></a>  <span class="n">ENDIF</span>
<a name="ln-8159"></a>
<a name="ln-8160"></a>  <span class="k">RETURN</span>
<a name="ln-8161"></a>
<a name="ln-8162"></a><span class="k">END FUNCTION </span><span class="n">GetWaterCoilCapacity</span>
<a name="ln-8163"></a>
<a name="ln-8164"></a><span class="k">SUBROUTINE </span><span class="n">UpdateWaterToAirCoilPlantConnection</span><span class="p">(</span><span class="n">CoilTypeNum</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-8165"></a>                                               <span class="n">CoilName</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-8166"></a>                                               <span class="n">EquipFlowCtrl</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-8167"></a>                                               <span class="n">LoopNum</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-8168"></a>                                               <span class="n">LoopSide</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-8169"></a>                                               <span class="n">CompIndex</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-8170"></a>                                               <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8171"></a>                                               <span class="n">InitLoopEquip</span><span class="p">)</span>
<a name="ln-8172"></a>
<a name="ln-8173"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8174"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-8175"></a>          <span class="c">!       DATE WRITTEN   February 2010</span>
<a name="ln-8176"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8177"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8178"></a>
<a name="ln-8179"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8180"></a>          <span class="c">! update sim routine called from plant</span>
<a name="ln-8181"></a>
<a name="ln-8182"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8183"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-8184"></a>
<a name="ln-8185"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8186"></a>          <span class="c">! na</span>
<a name="ln-8187"></a>
<a name="ln-8188"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8189"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">KickOffSimulation</span>
<a name="ln-8190"></a>  <span class="k">Use </span><span class="n">DataLoopNode</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">Node</span>
<a name="ln-8191"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">ccSimPlantEquipTypes</span><span class="p">,</span> <span class="n">PlantLoop</span>
<a name="ln-8192"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-8193"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-8194"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimAirLoopsFlag</span><span class="p">,</span> <span class="n">SimZoneEquipmentFlag</span>
<a name="ln-8195"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowContinueErrorTimeStamp</span>
<a name="ln-8196"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8197"></a>
<a name="ln-8198"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8199"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoilTypeNum</span>
<a name="ln-8200"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>
<a name="ln-8201"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EquipFlowCtrl</span>       <span class="c">! Flow control mode for the equipment</span>
<a name="ln-8202"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoopNum</span>             <span class="c">! Plant loop index for where called from</span>
<a name="ln-8203"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoopSide</span>            <span class="c">! Plant loop side index for where called from</span>
<a name="ln-8204"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompIndex</span>        <span class="c">! Chiller number pointer</span>
<a name="ln-8205"></a>  <span class="kt">LOGICAL</span> <span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span>   <span class="c">!</span>
<a name="ln-8206"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InitLoopEquip</span>       <span class="c">! If not zero, calculate the max load for operating conditions</span>
<a name="ln-8207"></a>
<a name="ln-8208"></a>
<a name="ln-8209"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8210"></a>          <span class="c">! na</span>
<a name="ln-8211"></a>
<a name="ln-8212"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8213"></a>          <span class="c">! na</span>
<a name="ln-8214"></a>
<a name="ln-8215"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8216"></a>          <span class="c">! na</span>
<a name="ln-8217"></a>
<a name="ln-8218"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8219"></a>
<a name="ln-8220"></a>  <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">CoilNum</span>
<a name="ln-8221"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">DidAnythingChange</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! set to true if conditions changed</span>
<a name="ln-8222"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletNodeNum</span>
<a name="ln-8223"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutletNodeNum</span>
<a name="ln-8224"></a>
<a name="ln-8225"></a>    <span class="c">! Find the correct water coil</span>
<a name="ln-8226"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8227"></a><span class="k">    </span><span class="n">CoilNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-8228"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CoilNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8229"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UpdateWaterToAirCoilPlantConnection: Specified Coil not one of Valid water coils=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">))</span>
<a name="ln-8230"></a>    <span class="n">ENDIF</span>
<a name="ln-8231"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">CoilNum</span>
<a name="ln-8232"></a>  <span class="k">ELSE</span>
<a name="ln-8233"></a><span class="k">    </span><span class="n">CoilNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-8234"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CoilNum</span> <span class="o">&gt;</span> <span class="n">NumWaterCoils</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">CoilNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8235"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UpdateWaterToAirCoilPlantConnection:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8236"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8237"></a>                          <span class="s1">&#39;, Number of Coils=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumWaterCoils</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8238"></a>                          <span class="s1">&#39;, Entered Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">))</span>
<a name="ln-8239"></a>    <span class="n">ENDIF</span>
<a name="ln-8240"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8241"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CoilName</span> <span class="o">/=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8242"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UpdateWaterToAirCoilPlantConnection: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8243"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8244"></a>                            <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Coil Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8245"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8246"></a>      <span class="n">ENDIF</span>
<a name="ln-8247"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CoilTypeNum</span> <span class="o">/=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterCoilType_Num</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8248"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;UpdateWaterToAirCoilPlantConnection: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8249"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8250"></a>                            <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Coil Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-8251"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">ccSimPlantEquipTypes</span><span class="p">(</span><span class="n">CoilTypeNum</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-8252"></a>      <span class="n">ENDIF</span>
<a name="ln-8253"></a>    <span class="n">ENDIF</span>
<a name="ln-8254"></a>  <span class="n">ENDIF</span>
<a name="ln-8255"></a>
<a name="ln-8256"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">InitLoopEquip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8257"></a><span class="k">    RETURN</span>
<a name="ln-8258"></a><span class="k">  END IF</span>
<a name="ln-8259"></a>
<a name="ln-8260"></a><span class="k">  </span><span class="n">DidAnythingChange</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8261"></a>
<a name="ln-8262"></a>  <span class="n">InletNodeNum</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterInletNodeNum</span>
<a name="ln-8263"></a>  <span class="n">OutletNodeNum</span> <span class="o">=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">WaterOutletNodeNum</span>
<a name="ln-8264"></a>
<a name="ln-8265"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span> <span class="n">Temp</span> <span class="o">/=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">InletWaterTemp</span><span class="p">)</span> <span class="n">DidAnythingChange</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8266"></a>
<a name="ln-8267"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">/=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterTemp</span><span class="p">)</span> <span class="n">DidAnythingChange</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8268"></a>
<a name="ln-8269"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8270"></a><span class="k">    </span><span class="n">DidAnythingChange</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8271"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="c">! make sure flows are consistent</span>
<a name="ln-8272"></a>  <span class="n">ENDIF</span>
<a name="ln-8273"></a>
<a name="ln-8274"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">/=</span> <span class="n">WaterCoil</span><span class="p">(</span><span class="n">CoilNum</span><span class="p">)%</span><span class="n">OutletWaterMassFlowRate</span><span class="p">)</span> <span class="n">DidAnythingChange</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8275"></a>
<a name="ln-8276"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DidAnythingChange</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8277"></a>    <span class="c">! set sim flag for this loop</span>
<a name="ln-8278"></a>    <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSide</span><span class="p">)%</span><span class="n">SimLoopSideNeeded</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8279"></a>    <span class="c">!set sim flags for air side users of coils</span>
<a name="ln-8280"></a>
<a name="ln-8281"></a>    <span class="n">SimAirLoopsFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8282"></a>    <span class="n">SimZoneEquipmentFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8283"></a>  <span class="k">ELSE</span> <span class="c">! nothing changed so turn off sim flag</span>
<a name="ln-8284"></a>    <span class="n">PlantLoop</span><span class="p">(</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">LoopSide</span><span class="p">)%</span><span class="n">SimLoopSideNeeded</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8285"></a>  <span class="n">ENDIF</span>
<a name="ln-8286"></a>
<a name="ln-8287"></a>  <span class="k">RETURN</span>
<a name="ln-8288"></a>
<a name="ln-8289"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateWaterToAirCoilPlantConnection</span>
<a name="ln-8290"></a>
<a name="ln-8291"></a><span class="k">FUNCTION </span><span class="n">GetWaterCoilAvailScheduleIndex</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="n">CoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">RESULT</span><span class="p">(</span><span class="n">AvailSchIndex</span><span class="p">)</span>
<a name="ln-8292"></a>
<a name="ln-8293"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8294"></a>          <span class="c">!       AUTHOR         Chandan Sharma, FSEC</span>
<a name="ln-8295"></a>          <span class="c">!       DATE WRITTEN   February 2013</span>
<a name="ln-8296"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8297"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8298"></a>
<a name="ln-8299"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-8300"></a>          <span class="c">! This function looks up the given coil and returns the availability schedule index.  If</span>
<a name="ln-8301"></a>          <span class="c">! incorrect coil type or name is given, errorsfound is returned as true and index is returned</span>
<a name="ln-8302"></a>          <span class="c">! as zero.</span>
<a name="ln-8303"></a>
<a name="ln-8304"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8305"></a>          <span class="c">! na</span>
<a name="ln-8306"></a>
<a name="ln-8307"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8308"></a>          <span class="c">! na</span>
<a name="ln-8309"></a>
<a name="ln-8310"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8311"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span><span class="p">,</span> <span class="n">SameString</span>
<a name="ln-8312"></a>
<a name="ln-8313"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8314"></a>
<a name="ln-8315"></a>          <span class="c">! FUNCTION ARGUMENT DEFINITIONS:</span>
<a name="ln-8316"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilType</span>     <span class="c">! must match coil types in this module</span>
<a name="ln-8317"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>     <span class="c">! must match coil names for the coil type</span>
<a name="ln-8318"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>  <span class="c">! set to true if problem</span>
<a name="ln-8319"></a>  <span class="kt">INTEGER</span>                      <span class="kd">::</span> <span class="n">AvailSchIndex</span>   <span class="c">! returned availability schedule of matched coil</span>
<a name="ln-8320"></a>
<a name="ln-8321"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-8322"></a>          <span class="c">! na</span>
<a name="ln-8323"></a>
<a name="ln-8324"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-8325"></a>          <span class="c">! na</span>
<a name="ln-8326"></a>
<a name="ln-8327"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-8328"></a>          <span class="c">! na</span>
<a name="ln-8329"></a>
<a name="ln-8330"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8331"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WhichCoil</span>
<a name="ln-8332"></a>
<a name="ln-8333"></a>  <span class="c">! Obtains and Allocates HeatingCoil related parameters from input file</span>
<a name="ln-8334"></a>  <span class="c">! Obtains and Allocates DXCoils</span>
<a name="ln-8335"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetWaterCoilsInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8336"></a><span class="k">    CALL </span><span class="n">GetWaterCoilInput</span>
<a name="ln-8337"></a>    <span class="n">GetWaterCoilsInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8338"></a>  <span class="k">END IF</span>
<a name="ln-8339"></a>
<a name="ln-8340"></a><span class="k">  </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8341"></a>  <span class="n">AvailSchIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8342"></a>
<a name="ln-8343"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8344"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8345"></a>      <span class="n">SameString</span><span class="p">(</span><span class="n">CoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:Water:DetailedGeometry&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8346"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">WaterCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumWaterCoils</span><span class="p">)</span>
<a name="ln-8347"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8348"></a><span class="k">      </span><span class="n">AvailSchIndex</span><span class="o">=</span><span class="n">WaterCoil</span><span class="p">(</span><span class="n">WhichCoil</span><span class="p">)%</span><span class="n">SchedPtr</span>
<a name="ln-8349"></a>    <span class="n">ENDIF</span>
<a name="ln-8350"></a>  <span class="k">ELSE</span>
<a name="ln-8351"></a><span class="k">    </span><span class="n">WhichCoil</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8352"></a>  <span class="n">ENDIF</span>
<a name="ln-8353"></a>
<a name="ln-8354"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WhichCoil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8355"></a><span class="k">    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetCoilAvailScheduleIndex: Could not find Coil, Type=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8356"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; Name=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-8357"></a>    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-8358"></a>    <span class="n">AvailSchIndex</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-8359"></a>  <span class="n">ENDIF</span>
<a name="ln-8360"></a>
<a name="ln-8361"></a>  <span class="k">RETURN</span>
<a name="ln-8362"></a>
<a name="ln-8363"></a><span class="k">END FUNCTION </span><span class="n">GetWaterCoilAvailScheduleIndex</span>
<a name="ln-8364"></a>
<a name="ln-8365"></a><span class="c">! End of Coil Utility subroutines</span>
<a name="ln-8366"></a><span class="c">! *****************************************************************************</span>
<a name="ln-8367"></a>
<a name="ln-8368"></a><span class="c">!     NOTICE</span>
<a name="ln-8369"></a><span class="c">!</span>
<a name="ln-8370"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-8371"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-8372"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-8373"></a><span class="c">!</span>
<a name="ln-8374"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-8375"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-8376"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-8377"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-8378"></a><span class="c">!</span>
<a name="ln-8379"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-8380"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-8381"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-8382"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-8383"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-8384"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-8385"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-8386"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-8387"></a><span class="c">!     permit others to do so.</span>
<a name="ln-8388"></a><span class="c">!</span>
<a name="ln-8389"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-8390"></a><span class="c">!</span>
<a name="ln-8391"></a>
<a name="ln-8392"></a><span class="k">End Module </span><span class="n">WaterCoils</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
